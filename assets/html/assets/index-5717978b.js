function n7(r,o){for(var a=0;a<o.length;a++){const c=o[a];if(typeof c!="string"&&!Array.isArray(c)){for(const p in c)if(p!=="default"&&!(p in r)){const _=Object.getOwnPropertyDescriptor(c,p);_&&Object.defineProperty(r,p,_.get?_:{enumerable:!0,get:()=>c[p]})}}}return Object.freeze(Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}))}(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const p of document.querySelectorAll('link[rel="modulepreload"]'))c(p);new MutationObserver(p=>{for(const _ of p)if(_.type==="childList")for(const x of _.addedNodes)x.tagName==="LINK"&&x.rel==="modulepreload"&&c(x)}).observe(document,{childList:!0,subtree:!0});function a(p){const _={};return p.integrity&&(_.integrity=p.integrity),p.referrerPolicy&&(_.referrerPolicy=p.referrerPolicy),p.crossOrigin==="use-credentials"?_.credentials="include":p.crossOrigin==="anonymous"?_.credentials="omit":_.credentials="same-origin",_}function c(p){if(p.ep)return;p.ep=!0;const _=a(p);fetch(p.href,_)}})();var r7=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Yb(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var ZO={exports:{}},Qb={},XO={exports:{}},br={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var yv=Symbol.for("react.element"),i7=Symbol.for("react.portal"),o7=Symbol.for("react.fragment"),s7=Symbol.for("react.strict_mode"),a7=Symbol.for("react.profiler"),l7=Symbol.for("react.provider"),u7=Symbol.for("react.context"),c7=Symbol.for("react.forward_ref"),h7=Symbol.for("react.suspense"),d7=Symbol.for("react.memo"),f7=Symbol.for("react.lazy"),TR=Symbol.iterator;function p7(r){return r===null||typeof r!="object"?null:(r=TR&&r[TR]||r["@@iterator"],typeof r=="function"?r:null)}var KO={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},YO=Object.assign,QO={};function Vg(r,o,a){this.props=r,this.context=o,this.refs=QO,this.updater=a||KO}Vg.prototype.isReactComponent={};Vg.prototype.setState=function(r,o){if(typeof r!="object"&&typeof r!="function"&&r!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,r,o,"setState")};Vg.prototype.forceUpdate=function(r){this.updater.enqueueForceUpdate(this,r,"forceUpdate")};function JO(){}JO.prototype=Vg.prototype;function dA(r,o,a){this.props=r,this.context=o,this.refs=QO,this.updater=a||KO}var fA=dA.prototype=new JO;fA.constructor=dA;YO(fA,Vg.prototype);fA.isPureReactComponent=!0;var CR=Array.isArray,ez=Object.prototype.hasOwnProperty,pA={current:null},tz={key:!0,ref:!0,__self:!0,__source:!0};function nz(r,o,a){var c,p={},_=null,x=null;if(o!=null)for(c in o.ref!==void 0&&(x=o.ref),o.key!==void 0&&(_=""+o.key),o)ez.call(o,c)&&!tz.hasOwnProperty(c)&&(p[c]=o[c]);var T=arguments.length-2;if(T===1)p.children=a;else if(1<T){for(var C=Array(T),P=0;P<T;P++)C[P]=arguments[P+2];p.children=C}if(r&&r.defaultProps)for(c in T=r.defaultProps,T)p[c]===void 0&&(p[c]=T[c]);return{$$typeof:yv,type:r,key:_,ref:x,props:p,_owner:pA.current}}function m7(r,o){return{$$typeof:yv,type:r.type,key:o,ref:r.ref,props:r.props,_owner:r._owner}}function mA(r){return typeof r=="object"&&r!==null&&r.$$typeof===yv}function g7(r){var o={"=":"=0",":":"=2"};return"$"+r.replace(/[=:]/g,function(a){return o[a]})}var AR=/\/+/g;function BE(r,o){return typeof r=="object"&&r!==null&&r.key!=null?g7(""+r.key):o.toString(36)}function Ew(r,o,a,c,p){var _=typeof r;(_==="undefined"||_==="boolean")&&(r=null);var x=!1;if(r===null)x=!0;else switch(_){case"string":case"number":x=!0;break;case"object":switch(r.$$typeof){case yv:case i7:x=!0}}if(x)return x=r,p=p(x),r=c===""?"."+BE(x,0):c,CR(p)?(a="",r!=null&&(a=r.replace(AR,"$&/")+"/"),Ew(p,o,a,"",function(P){return P})):p!=null&&(mA(p)&&(p=m7(p,a+(!p.key||x&&x.key===p.key?"":(""+p.key).replace(AR,"$&/")+"/")+r)),o.push(p)),1;if(x=0,c=c===""?".":c+":",CR(r))for(var T=0;T<r.length;T++){_=r[T];var C=c+BE(_,T);x+=Ew(_,o,a,C,p)}else if(C=p7(r),typeof C=="function")for(r=C.call(r),T=0;!(_=r.next()).done;)_=_.value,C=c+BE(_,T++),x+=Ew(_,o,a,C,p);else if(_==="object")throw o=String(r),Error("Objects are not valid as a React child (found: "+(o==="[object Object]"?"object with keys {"+Object.keys(r).join(", ")+"}":o)+"). If you meant to render a collection of children, use an array instead.");return x}function Ox(r,o,a){if(r==null)return r;var c=[],p=0;return Ew(r,c,"","",function(_){return o.call(a,_,p++)}),c}function y7(r){if(r._status===-1){var o=r._result;o=o(),o.then(function(a){(r._status===0||r._status===-1)&&(r._status=1,r._result=a)},function(a){(r._status===0||r._status===-1)&&(r._status=2,r._result=a)}),r._status===-1&&(r._status=0,r._result=o)}if(r._status===1)return r._result.default;throw r._result}var Ss={current:null},Tw={transition:null},_7={ReactCurrentDispatcher:Ss,ReactCurrentBatchConfig:Tw,ReactCurrentOwner:pA};br.Children={map:Ox,forEach:function(r,o,a){Ox(r,function(){o.apply(this,arguments)},a)},count:function(r){var o=0;return Ox(r,function(){o++}),o},toArray:function(r){return Ox(r,function(o){return o})||[]},only:function(r){if(!mA(r))throw Error("React.Children.only expected to receive a single React element child.");return r}};br.Component=Vg;br.Fragment=o7;br.Profiler=a7;br.PureComponent=dA;br.StrictMode=s7;br.Suspense=h7;br.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=_7;br.cloneElement=function(r,o,a){if(r==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+r+".");var c=YO({},r.props),p=r.key,_=r.ref,x=r._owner;if(o!=null){if(o.ref!==void 0&&(_=o.ref,x=pA.current),o.key!==void 0&&(p=""+o.key),r.type&&r.type.defaultProps)var T=r.type.defaultProps;for(C in o)ez.call(o,C)&&!tz.hasOwnProperty(C)&&(c[C]=o[C]===void 0&&T!==void 0?T[C]:o[C])}var C=arguments.length-2;if(C===1)c.children=a;else if(1<C){T=Array(C);for(var P=0;P<C;P++)T[P]=arguments[P+2];c.children=T}return{$$typeof:yv,type:r.type,key:p,ref:_,props:c,_owner:x}};br.createContext=function(r){return r={$$typeof:u7,_currentValue:r,_currentValue2:r,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},r.Provider={$$typeof:l7,_context:r},r.Consumer=r};br.createElement=nz;br.createFactory=function(r){var o=nz.bind(null,r);return o.type=r,o};br.createRef=function(){return{current:null}};br.forwardRef=function(r){return{$$typeof:c7,render:r}};br.isValidElement=mA;br.lazy=function(r){return{$$typeof:f7,_payload:{_status:-1,_result:r},_init:y7}};br.memo=function(r,o){return{$$typeof:d7,type:r,compare:o===void 0?null:o}};br.startTransition=function(r){var o=Tw.transition;Tw.transition={};try{r()}finally{Tw.transition=o}};br.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};br.useCallback=function(r,o){return Ss.current.useCallback(r,o)};br.useContext=function(r){return Ss.current.useContext(r)};br.useDebugValue=function(){};br.useDeferredValue=function(r){return Ss.current.useDeferredValue(r)};br.useEffect=function(r,o){return Ss.current.useEffect(r,o)};br.useId=function(){return Ss.current.useId()};br.useImperativeHandle=function(r,o,a){return Ss.current.useImperativeHandle(r,o,a)};br.useInsertionEffect=function(r,o){return Ss.current.useInsertionEffect(r,o)};br.useLayoutEffect=function(r,o){return Ss.current.useLayoutEffect(r,o)};br.useMemo=function(r,o){return Ss.current.useMemo(r,o)};br.useReducer=function(r,o,a){return Ss.current.useReducer(r,o,a)};br.useRef=function(r){return Ss.current.useRef(r)};br.useState=function(r){return Ss.current.useState(r)};br.useSyncExternalStore=function(r,o,a){return Ss.current.useSyncExternalStore(r,o,a)};br.useTransition=function(){return Ss.current.useTransition()};br.version="18.2.0";XO.exports=br;var _e=XO.exports;const Xn=Yb(_e),v7=n7({__proto__:null,default:Xn},[_e]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var x7=_e,w7=Symbol.for("react.element"),b7=Symbol.for("react.fragment"),S7=Object.prototype.hasOwnProperty,E7=x7.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,T7={key:!0,ref:!0,__self:!0,__source:!0};function rz(r,o,a){var c,p={},_=null,x=null;a!==void 0&&(_=""+a),o.key!==void 0&&(_=""+o.key),o.ref!==void 0&&(x=o.ref);for(c in o)S7.call(o,c)&&!T7.hasOwnProperty(c)&&(p[c]=o[c]);if(r&&r.defaultProps)for(c in o=r.defaultProps,o)p[c]===void 0&&(p[c]=o[c]);return{$$typeof:w7,type:r,key:_,ref:x,props:p,_owner:E7.current}}Qb.Fragment=b7;Qb.jsx=rz;Qb.jsxs=rz;ZO.exports=Qb;var gA=ZO.exports;const yA=gA.Fragment,st=gA.jsx,ci=gA.jsxs;const C7={type:"logger",log(r){this.output("log",r)},warn(r){this.output("warn",r)},error(r){this.output("error",r)},output(r,o){console&&console[r]&&console[r].apply(console,o)}};class Qw{constructor(o){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.init(o,a)}init(o){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.prefix=a.prefix||"i18next:",this.logger=o||C7,this.options=a,this.debug=a.debug}log(){for(var o=arguments.length,a=new Array(o),c=0;c<o;c++)a[c]=arguments[c];return this.forward(a,"log","",!0)}warn(){for(var o=arguments.length,a=new Array(o),c=0;c<o;c++)a[c]=arguments[c];return this.forward(a,"warn","",!0)}error(){for(var o=arguments.length,a=new Array(o),c=0;c<o;c++)a[c]=arguments[c];return this.forward(a,"error","")}deprecate(){for(var o=arguments.length,a=new Array(o),c=0;c<o;c++)a[c]=arguments[c];return this.forward(a,"warn","WARNING DEPRECATED: ",!0)}forward(o,a,c,p){return p&&!this.debug?null:(typeof o[0]=="string"&&(o[0]=`${c}${this.prefix} ${o[0]}`),this.logger[a](o))}create(o){return new Qw(this.logger,{prefix:`${this.prefix}:${o}:`,...this.options})}clone(o){return o=o||this.options,o.prefix=o.prefix||this.prefix,new Qw(this.logger,o)}}var fu=new Qw;class Jb{constructor(){this.observers={}}on(o,a){return o.split(" ").forEach(c=>{this.observers[c]=this.observers[c]||[],this.observers[c].push(a)}),this}off(o,a){if(this.observers[o]){if(!a){delete this.observers[o];return}this.observers[o]=this.observers[o].filter(c=>c!==a)}}emit(o){for(var a=arguments.length,c=new Array(a>1?a-1:0),p=1;p<a;p++)c[p-1]=arguments[p];this.observers[o]&&[].concat(this.observers[o]).forEach(x=>{x(...c)}),this.observers["*"]&&[].concat(this.observers["*"]).forEach(x=>{x.apply(x,[o,...c])})}}function V_(){let r,o;const a=new Promise((c,p)=>{r=c,o=p});return a.resolve=r,a.reject=o,a}function MR(r){return r==null?"":""+r}function A7(r,o,a){r.forEach(c=>{o[c]&&(a[c]=o[c])})}function _A(r,o,a){function c(x){return x&&x.indexOf("###")>-1?x.replace(/###/g,"."):x}function p(){return!r||typeof r=="string"}const _=typeof o!="string"?[].concat(o):o.split(".");for(;_.length>1;){if(p())return{};const x=c(_.shift());!r[x]&&a&&(r[x]=new a),Object.prototype.hasOwnProperty.call(r,x)?r=r[x]:r={}}return p()?{}:{obj:r,k:c(_.shift())}}function IR(r,o,a){const{obj:c,k:p}=_A(r,o,Object);c[p]=a}function M7(r,o,a,c){const{obj:p,k:_}=_A(r,o,Object);p[_]=p[_]||[],c&&(p[_]=p[_].concat(a)),c||p[_].push(a)}function Jw(r,o){const{obj:a,k:c}=_A(r,o);if(a)return a[c]}function I7(r,o,a){const c=Jw(r,a);return c!==void 0?c:Jw(o,a)}function iz(r,o,a){for(const c in o)c!=="__proto__"&&c!=="constructor"&&(c in r?typeof r[c]=="string"||r[c]instanceof String||typeof o[c]=="string"||o[c]instanceof String?a&&(r[c]=o[c]):iz(r[c],o[c],a):r[c]=o[c]);return r}function $m(r){return r.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}var k7={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};function P7(r){return typeof r=="string"?r.replace(/[&<>"'\/]/g,o=>k7[o]):r}const R7=[" ",",","?","!",";"];function D7(r,o,a){o=o||"",a=a||"";const c=R7.filter(x=>o.indexOf(x)<0&&a.indexOf(x)<0);if(c.length===0)return!0;const p=new RegExp(`(${c.map(x=>x==="?"?"\\?":x).join("|")})`);let _=!p.test(r);if(!_){const x=r.indexOf(a);x>0&&!p.test(r.substring(0,x))&&(_=!0)}return _}function eb(r,o){let a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:".";if(!r)return;if(r[o])return r[o];const c=o.split(a);let p=r;for(let _=0;_<c.length;++_){if(!p||typeof p[c[_]]=="string"&&_+1<c.length)return;if(p[c[_]]===void 0){let x=2,T=c.slice(_,_+x).join(a),C=p[T];for(;C===void 0&&c.length>_+x;)x++,T=c.slice(_,_+x).join(a),C=p[T];if(C===void 0)return;if(C===null)return null;if(o.endsWith(T)){if(typeof C=="string")return C;if(T&&typeof C[T]=="string")return C[T]}const P=c.slice(_+x).join(a);return P?eb(C,P,a):void 0}p=p[c[_]]}return p}function tb(r){return r&&r.indexOf("_")>0?r.replace("_","-"):r}class kR extends Jb{constructor(o){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{ns:["translation"],defaultNS:"translation"};super(),this.data=o||{},this.options=a,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.options.ignoreJSONStructure===void 0&&(this.options.ignoreJSONStructure=!0)}addNamespaces(o){this.options.ns.indexOf(o)<0&&this.options.ns.push(o)}removeNamespaces(o){const a=this.options.ns.indexOf(o);a>-1&&this.options.ns.splice(a,1)}getResource(o,a,c){let p=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};const _=p.keySeparator!==void 0?p.keySeparator:this.options.keySeparator,x=p.ignoreJSONStructure!==void 0?p.ignoreJSONStructure:this.options.ignoreJSONStructure;let T=[o,a];c&&typeof c!="string"&&(T=T.concat(c)),c&&typeof c=="string"&&(T=T.concat(_?c.split(_):c)),o.indexOf(".")>-1&&(T=o.split("."));const C=Jw(this.data,T);return C||!x||typeof c!="string"?C:eb(this.data&&this.data[o]&&this.data[o][a],c,_)}addResource(o,a,c,p){let _=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{silent:!1};const x=_.keySeparator!==void 0?_.keySeparator:this.options.keySeparator;let T=[o,a];c&&(T=T.concat(x?c.split(x):c)),o.indexOf(".")>-1&&(T=o.split("."),p=a,a=T[1]),this.addNamespaces(a),IR(this.data,T,p),_.silent||this.emit("added",o,a,c,p)}addResources(o,a,c){let p=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{silent:!1};for(const _ in c)(typeof c[_]=="string"||Object.prototype.toString.apply(c[_])==="[object Array]")&&this.addResource(o,a,_,c[_],{silent:!0});p.silent||this.emit("added",o,a,c)}addResourceBundle(o,a,c,p,_){let x=arguments.length>5&&arguments[5]!==void 0?arguments[5]:{silent:!1},T=[o,a];o.indexOf(".")>-1&&(T=o.split("."),p=c,c=a,a=T[1]),this.addNamespaces(a);let C=Jw(this.data,T)||{};p?iz(C,c,_):C={...C,...c},IR(this.data,T,C),x.silent||this.emit("added",o,a,c)}removeResourceBundle(o,a){this.hasResourceBundle(o,a)&&delete this.data[o][a],this.removeNamespaces(a),this.emit("removed",o,a)}hasResourceBundle(o,a){return this.getResource(o,a)!==void 0}getResourceBundle(o,a){return a||(a=this.options.defaultNS),this.options.compatibilityAPI==="v1"?{...this.getResource(o,a)}:this.getResource(o,a)}getDataByLanguage(o){return this.data[o]}hasLanguageSomeTranslations(o){const a=this.getDataByLanguage(o);return!!(a&&Object.keys(a)||[]).find(p=>a[p]&&Object.keys(a[p]).length>0)}toJSON(){return this.data}}var oz={processors:{},addPostProcessor(r){this.processors[r.name]=r},handle(r,o,a,c,p){return r.forEach(_=>{this.processors[_]&&(o=this.processors[_].process(o,a,c,p))}),o}};const PR={};class nb extends Jb{constructor(o){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),A7(["resourceStore","languageUtils","pluralResolver","interpolator","backendConnector","i18nFormat","utils"],o,this),this.options=a,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.logger=fu.create("translator")}changeLanguage(o){o&&(this.language=o)}exists(o){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{interpolation:{}};if(o==null)return!1;const c=this.resolve(o,a);return c&&c.res!==void 0}extractFromKey(o,a){let c=a.nsSeparator!==void 0?a.nsSeparator:this.options.nsSeparator;c===void 0&&(c=":");const p=a.keySeparator!==void 0?a.keySeparator:this.options.keySeparator;let _=a.ns||this.options.defaultNS||[];const x=c&&o.indexOf(c)>-1,T=!this.options.userDefinedKeySeparator&&!a.keySeparator&&!this.options.userDefinedNsSeparator&&!a.nsSeparator&&!D7(o,c,p);if(x&&!T){const C=o.match(this.interpolator.nestingRegexp);if(C&&C.length>0)return{key:o,namespaces:_};const P=o.split(c);(c!==p||c===p&&this.options.ns.indexOf(P[0])>-1)&&(_=P.shift()),o=P.join(p)}return typeof _=="string"&&(_=[_]),{key:o,namespaces:_}}translate(o,a,c){if(typeof a!="object"&&this.options.overloadTranslationOptionHandler&&(a=this.options.overloadTranslationOptionHandler(arguments)),typeof a=="object"&&(a={...a}),a||(a={}),o==null)return"";Array.isArray(o)||(o=[String(o)]);const p=a.returnDetails!==void 0?a.returnDetails:this.options.returnDetails,_=a.keySeparator!==void 0?a.keySeparator:this.options.keySeparator,{key:x,namespaces:T}=this.extractFromKey(o[o.length-1],a),C=T[T.length-1],P=a.lng||this.language,O=a.appendNamespaceToCIMode||this.options.appendNamespaceToCIMode;if(P&&P.toLowerCase()==="cimode"){if(O){const W=a.nsSeparator||this.options.nsSeparator;return p?{res:`${C}${W}${x}`,usedKey:x,exactUsedKey:x,usedLng:P,usedNS:C}:`${C}${W}${x}`}return p?{res:x,usedKey:x,exactUsedKey:x,usedLng:P,usedNS:C}:x}const F=this.resolve(o,a);let U=F&&F.res;const Z=F&&F.usedKey||x,$=F&&F.exactUsedKey||x,K=Object.prototype.toString.apply(U),ie=["[object Number]","[object Function]","[object RegExp]"],H=a.joinArrays!==void 0?a.joinArrays:this.options.joinArrays,G=!this.i18nFormat||this.i18nFormat.handleAsObject;if(G&&U&&(typeof U!="string"&&typeof U!="boolean"&&typeof U!="number")&&ie.indexOf(K)<0&&!(typeof H=="string"&&K==="[object Array]")){if(!a.returnObjects&&!this.options.returnObjects){this.options.returnedObjectHandler||this.logger.warn("accessing an object - but returnObjects options is not enabled!");const W=this.options.returnedObjectHandler?this.options.returnedObjectHandler(Z,U,{...a,ns:T}):`key '${x} (${this.language})' returned an object instead of string.`;return p?(F.res=W,F):W}if(_){const W=K==="[object Array]",me=W?[]:{},de=W?$:Z;for(const he in U)if(Object.prototype.hasOwnProperty.call(U,he)){const se=`${de}${_}${he}`;me[he]=this.translate(se,{...a,joinArrays:!1,ns:T}),me[he]===se&&(me[he]=U[he])}U=me}}else if(G&&typeof H=="string"&&K==="[object Array]")U=U.join(H),U&&(U=this.extendTranslation(U,o,a,c));else{let W=!1,me=!1;const de=a.count!==void 0&&typeof a.count!="string",he=nb.hasDefaultValue(a),se=de?this.pluralResolver.getSuffix(P,a.count,a):"",q=a.ordinal&&de?this.pluralResolver.getSuffix(P,a.count,{ordinal:!1}):"",Se=a[`defaultValue${se}`]||a[`defaultValue${q}`]||a.defaultValue;!this.isValidLookup(U)&&he&&(W=!0,U=Se),this.isValidLookup(U)||(me=!0,U=x);const Ue=(a.missingKeyNoValueFallbackToKey||this.options.missingKeyNoValueFallbackToKey)&&me?void 0:U,Be=he&&Se!==U&&this.options.updateMissing;if(me||W||Be){if(this.logger.log(Be?"updateKey":"missingKey",P,C,x,Be?Se:U),_){const dt=this.resolve(x,{...a,keySeparator:!1});dt&&dt.res&&this.logger.warn("Seems the loaded translations were in flat JSON format instead of nested. Either set keySeparator: false on init or make sure your translations are published in nested format.")}let rt=[];const _t=this.languageUtils.getFallbackCodes(this.options.fallbackLng,a.lng||this.language);if(this.options.saveMissingTo==="fallback"&&_t&&_t[0])for(let dt=0;dt<_t.length;dt++)rt.push(_t[dt]);else this.options.saveMissingTo==="all"?rt=this.languageUtils.toResolveHierarchy(a.lng||this.language):rt.push(a.lng||this.language);const zt=(dt,Te,we)=>{const Q=he&&we!==U?we:Ue;this.options.missingKeyHandler?this.options.missingKeyHandler(dt,C,Te,Q,Be,a):this.backendConnector&&this.backendConnector.saveMissing&&this.backendConnector.saveMissing(dt,C,Te,Q,Be,a),this.emit("missingKey",dt,C,Te,U)};this.options.saveMissing&&(this.options.saveMissingPlurals&&de?rt.forEach(dt=>{this.pluralResolver.getSuffixes(dt,a).forEach(Te=>{zt([dt],x+Te,a[`defaultValue${Te}`]||Se)})}):zt(rt,x,Se))}U=this.extendTranslation(U,o,a,F,c),me&&U===x&&this.options.appendNamespaceToMissingKey&&(U=`${C}:${x}`),(me||W)&&this.options.parseMissingKeyHandler&&(this.options.compatibilityAPI!=="v1"?U=this.options.parseMissingKeyHandler(this.options.appendNamespaceToMissingKey?`${C}:${x}`:x,W?U:void 0):U=this.options.parseMissingKeyHandler(U))}return p?(F.res=U,F):U}extendTranslation(o,a,c,p,_){var x=this;if(this.i18nFormat&&this.i18nFormat.parse)o=this.i18nFormat.parse(o,{...this.options.interpolation.defaultVariables,...c},c.lng||this.language||p.usedLng,p.usedNS,p.usedKey,{resolved:p});else if(!c.skipInterpolation){c.interpolation&&this.interpolator.init({...c,interpolation:{...this.options.interpolation,...c.interpolation}});const P=typeof o=="string"&&(c&&c.interpolation&&c.interpolation.skipOnVariables!==void 0?c.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables);let O;if(P){const U=o.match(this.interpolator.nestingRegexp);O=U&&U.length}let F=c.replace&&typeof c.replace!="string"?c.replace:c;if(this.options.interpolation.defaultVariables&&(F={...this.options.interpolation.defaultVariables,...F}),o=this.interpolator.interpolate(o,F,c.lng||this.language,c),P){const U=o.match(this.interpolator.nestingRegexp),Z=U&&U.length;O<Z&&(c.nest=!1)}!c.lng&&this.options.compatibilityAPI!=="v1"&&p&&p.res&&(c.lng=p.usedLng),c.nest!==!1&&(o=this.interpolator.nest(o,function(){for(var U=arguments.length,Z=new Array(U),$=0;$<U;$++)Z[$]=arguments[$];return _&&_[0]===Z[0]&&!c.context?(x.logger.warn(`It seems you are nesting recursively key: ${Z[0]} in key: ${a[0]}`),null):x.translate(...Z,a)},c)),c.interpolation&&this.interpolator.reset()}const T=c.postProcess||this.options.postProcess,C=typeof T=="string"?[T]:T;return o!=null&&C&&C.length&&c.applyPostProcessor!==!1&&(o=oz.handle(C,o,a,this.options&&this.options.postProcessPassResolved?{i18nResolved:p,...c}:c,this)),o}resolve(o){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},c,p,_,x,T;return typeof o=="string"&&(o=[o]),o.forEach(C=>{if(this.isValidLookup(c))return;const P=this.extractFromKey(C,a),O=P.key;p=O;let F=P.namespaces;this.options.fallbackNS&&(F=F.concat(this.options.fallbackNS));const U=a.count!==void 0&&typeof a.count!="string",Z=U&&!a.ordinal&&a.count===0&&this.pluralResolver.shouldUseIntlApi(),$=a.context!==void 0&&(typeof a.context=="string"||typeof a.context=="number")&&a.context!=="",K=a.lngs?a.lngs:this.languageUtils.toResolveHierarchy(a.lng||this.language,a.fallbackLng);F.forEach(ie=>{this.isValidLookup(c)||(T=ie,!PR[`${K[0]}-${ie}`]&&this.utils&&this.utils.hasLoadedNamespace&&!this.utils.hasLoadedNamespace(T)&&(PR[`${K[0]}-${ie}`]=!0,this.logger.warn(`key "${p}" for languages "${K.join(", ")}" won't get resolved as namespace "${T}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")),K.forEach(H=>{if(this.isValidLookup(c))return;x=H;const G=[O];if(this.i18nFormat&&this.i18nFormat.addLookupKeys)this.i18nFormat.addLookupKeys(G,O,H,ie,a);else{let W;U&&(W=this.pluralResolver.getSuffix(H,a.count,a));const me=`${this.options.pluralSeparator}zero`,de=`${this.options.pluralSeparator}ordinal${this.options.pluralSeparator}`;if(U&&(G.push(O+W),a.ordinal&&W.indexOf(de)===0&&G.push(O+W.replace(de,this.options.pluralSeparator)),Z&&G.push(O+me)),$){const he=`${O}${this.options.contextSeparator}${a.context}`;G.push(he),U&&(G.push(he+W),a.ordinal&&W.indexOf(de)===0&&G.push(he+W.replace(de,this.options.pluralSeparator)),Z&&G.push(he+me))}}let ee;for(;ee=G.pop();)this.isValidLookup(c)||(_=ee,c=this.getResource(H,ie,ee,a))}))})}),{res:c,usedKey:p,exactUsedKey:_,usedLng:x,usedNS:T}}isValidLookup(o){return o!==void 0&&!(!this.options.returnNull&&o===null)&&!(!this.options.returnEmptyString&&o==="")}getResource(o,a,c){let p=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};return this.i18nFormat&&this.i18nFormat.getResource?this.i18nFormat.getResource(o,a,c,p):this.resourceStore.getResource(o,a,c,p)}static hasDefaultValue(o){const a="defaultValue";for(const c in o)if(Object.prototype.hasOwnProperty.call(o,c)&&a===c.substring(0,a.length)&&o[c]!==void 0)return!0;return!1}}function NE(r){return r.charAt(0).toUpperCase()+r.slice(1)}class RR{constructor(o){this.options=o,this.supportedLngs=this.options.supportedLngs||!1,this.logger=fu.create("languageUtils")}getScriptPartFromCode(o){if(o=tb(o),!o||o.indexOf("-")<0)return null;const a=o.split("-");return a.length===2||(a.pop(),a[a.length-1].toLowerCase()==="x")?null:this.formatLanguageCode(a.join("-"))}getLanguagePartFromCode(o){if(o=tb(o),!o||o.indexOf("-")<0)return o;const a=o.split("-");return this.formatLanguageCode(a[0])}formatLanguageCode(o){if(typeof o=="string"&&o.indexOf("-")>-1){const a=["hans","hant","latn","cyrl","cans","mong","arab"];let c=o.split("-");return this.options.lowerCaseLng?c=c.map(p=>p.toLowerCase()):c.length===2?(c[0]=c[0].toLowerCase(),c[1]=c[1].toUpperCase(),a.indexOf(c[1].toLowerCase())>-1&&(c[1]=NE(c[1].toLowerCase()))):c.length===3&&(c[0]=c[0].toLowerCase(),c[1].length===2&&(c[1]=c[1].toUpperCase()),c[0]!=="sgn"&&c[2].length===2&&(c[2]=c[2].toUpperCase()),a.indexOf(c[1].toLowerCase())>-1&&(c[1]=NE(c[1].toLowerCase())),a.indexOf(c[2].toLowerCase())>-1&&(c[2]=NE(c[2].toLowerCase()))),c.join("-")}return this.options.cleanCode||this.options.lowerCaseLng?o.toLowerCase():o}isSupportedCode(o){return(this.options.load==="languageOnly"||this.options.nonExplicitSupportedLngs)&&(o=this.getLanguagePartFromCode(o)),!this.supportedLngs||!this.supportedLngs.length||this.supportedLngs.indexOf(o)>-1}getBestMatchFromCodes(o){if(!o)return null;let a;return o.forEach(c=>{if(a)return;const p=this.formatLanguageCode(c);(!this.options.supportedLngs||this.isSupportedCode(p))&&(a=p)}),!a&&this.options.supportedLngs&&o.forEach(c=>{if(a)return;const p=this.getLanguagePartFromCode(c);if(this.isSupportedCode(p))return a=p;a=this.options.supportedLngs.find(_=>{if(_===p)return _;if(!(_.indexOf("-")<0&&p.indexOf("-")<0)&&_.indexOf(p)===0)return _})}),a||(a=this.getFallbackCodes(this.options.fallbackLng)[0]),a}getFallbackCodes(o,a){if(!o)return[];if(typeof o=="function"&&(o=o(a)),typeof o=="string"&&(o=[o]),Object.prototype.toString.apply(o)==="[object Array]")return o;if(!a)return o.default||[];let c=o[a];return c||(c=o[this.getScriptPartFromCode(a)]),c||(c=o[this.formatLanguageCode(a)]),c||(c=o[this.getLanguagePartFromCode(a)]),c||(c=o.default),c||[]}toResolveHierarchy(o,a){const c=this.getFallbackCodes(a||this.options.fallbackLng||[],o),p=[],_=x=>{x&&(this.isSupportedCode(x)?p.push(x):this.logger.warn(`rejecting language code not found in supportedLngs: ${x}`))};return typeof o=="string"&&(o.indexOf("-")>-1||o.indexOf("_")>-1)?(this.options.load!=="languageOnly"&&_(this.formatLanguageCode(o)),this.options.load!=="languageOnly"&&this.options.load!=="currentOnly"&&_(this.getScriptPartFromCode(o)),this.options.load!=="currentOnly"&&_(this.getLanguagePartFromCode(o))):typeof o=="string"&&_(this.formatLanguageCode(o)),c.forEach(x=>{p.indexOf(x)<0&&_(this.formatLanguageCode(x))}),p}}let L7=[{lngs:["ach","ak","am","arn","br","fil","gun","ln","mfe","mg","mi","oc","pt","pt-BR","tg","tl","ti","tr","uz","wa"],nr:[1,2],fc:1},{lngs:["af","an","ast","az","bg","bn","ca","da","de","dev","el","en","eo","es","et","eu","fi","fo","fur","fy","gl","gu","ha","hi","hu","hy","ia","it","kk","kn","ku","lb","mai","ml","mn","mr","nah","nap","nb","ne","nl","nn","no","nso","pa","pap","pms","ps","pt-PT","rm","sco","se","si","so","son","sq","sv","sw","ta","te","tk","ur","yo"],nr:[1,2],fc:2},{lngs:["ay","bo","cgg","fa","ht","id","ja","jbo","ka","km","ko","ky","lo","ms","sah","su","th","tt","ug","vi","wo","zh"],nr:[1],fc:3},{lngs:["be","bs","cnr","dz","hr","ru","sr","uk"],nr:[1,2,5],fc:4},{lngs:["ar"],nr:[0,1,2,3,11,100],fc:5},{lngs:["cs","sk"],nr:[1,2,5],fc:6},{lngs:["csb","pl"],nr:[1,2,5],fc:7},{lngs:["cy"],nr:[1,2,3,8],fc:8},{lngs:["fr"],nr:[1,2],fc:9},{lngs:["ga"],nr:[1,2,3,7,11],fc:10},{lngs:["gd"],nr:[1,2,3,20],fc:11},{lngs:["is"],nr:[1,2],fc:12},{lngs:["jv"],nr:[0,1],fc:13},{lngs:["kw"],nr:[1,2,3,4],fc:14},{lngs:["lt"],nr:[1,2,10],fc:15},{lngs:["lv"],nr:[1,2,0],fc:16},{lngs:["mk"],nr:[1,2],fc:17},{lngs:["mnk"],nr:[0,1,2],fc:18},{lngs:["mt"],nr:[1,2,11,20],fc:19},{lngs:["or"],nr:[2,1],fc:2},{lngs:["ro"],nr:[1,2,20],fc:20},{lngs:["sl"],nr:[5,1,2,3],fc:21},{lngs:["he","iw"],nr:[1,2,20,21],fc:22}],O7={1:function(r){return+(r>1)},2:function(r){return+(r!=1)},3:function(r){return 0},4:function(r){return r%10==1&&r%100!=11?0:r%10>=2&&r%10<=4&&(r%100<10||r%100>=20)?1:2},5:function(r){return r==0?0:r==1?1:r==2?2:r%100>=3&&r%100<=10?3:r%100>=11?4:5},6:function(r){return r==1?0:r>=2&&r<=4?1:2},7:function(r){return r==1?0:r%10>=2&&r%10<=4&&(r%100<10||r%100>=20)?1:2},8:function(r){return r==1?0:r==2?1:r!=8&&r!=11?2:3},9:function(r){return+(r>=2)},10:function(r){return r==1?0:r==2?1:r<7?2:r<11?3:4},11:function(r){return r==1||r==11?0:r==2||r==12?1:r>2&&r<20?2:3},12:function(r){return+(r%10!=1||r%100==11)},13:function(r){return+(r!==0)},14:function(r){return r==1?0:r==2?1:r==3?2:3},15:function(r){return r%10==1&&r%100!=11?0:r%10>=2&&(r%100<10||r%100>=20)?1:2},16:function(r){return r%10==1&&r%100!=11?0:r!==0?1:2},17:function(r){return r==1||r%10==1&&r%100!=11?0:1},18:function(r){return r==0?0:r==1?1:2},19:function(r){return r==1?0:r==0||r%100>1&&r%100<11?1:r%100>10&&r%100<20?2:3},20:function(r){return r==1?0:r==0||r%100>0&&r%100<20?1:2},21:function(r){return r%100==1?1:r%100==2?2:r%100==3||r%100==4?3:0},22:function(r){return r==1?0:r==2?1:(r<0||r>10)&&r%10==0?2:3}};const z7=["v1","v2","v3"],F7=["v4"],DR={zero:0,one:1,two:2,few:3,many:4,other:5};function B7(){const r={};return L7.forEach(o=>{o.lngs.forEach(a=>{r[a]={numbers:o.nr,plurals:O7[o.fc]}})}),r}class N7{constructor(o){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.languageUtils=o,this.options=a,this.logger=fu.create("pluralResolver"),(!this.options.compatibilityJSON||F7.includes(this.options.compatibilityJSON))&&(typeof Intl>"u"||!Intl.PluralRules)&&(this.options.compatibilityJSON="v3",this.logger.error("Your environment seems not to be Intl API compatible, use an Intl.PluralRules polyfill. Will fallback to the compatibilityJSON v3 format handling.")),this.rules=B7()}addRule(o,a){this.rules[o]=a}getRule(o){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(this.shouldUseIntlApi())try{return new Intl.PluralRules(tb(o),{type:a.ordinal?"ordinal":"cardinal"})}catch{return}return this.rules[o]||this.rules[this.languageUtils.getLanguagePartFromCode(o)]}needsPlural(o){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const c=this.getRule(o,a);return this.shouldUseIntlApi()?c&&c.resolvedOptions().pluralCategories.length>1:c&&c.numbers.length>1}getPluralFormsOfKey(o,a){let c=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.getSuffixes(o,c).map(p=>`${a}${p}`)}getSuffixes(o){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const c=this.getRule(o,a);return c?this.shouldUseIntlApi()?c.resolvedOptions().pluralCategories.sort((p,_)=>DR[p]-DR[_]).map(p=>`${this.options.prepend}${a.ordinal?`ordinal${this.options.prepend}`:""}${p}`):c.numbers.map(p=>this.getSuffix(o,p,a)):[]}getSuffix(o,a){let c=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const p=this.getRule(o,c);return p?this.shouldUseIntlApi()?`${this.options.prepend}${c.ordinal?`ordinal${this.options.prepend}`:""}${p.select(a)}`:this.getSuffixRetroCompatible(p,a):(this.logger.warn(`no plural rule found for: ${o}`),"")}getSuffixRetroCompatible(o,a){const c=o.noAbs?o.plurals(a):o.plurals(Math.abs(a));let p=o.numbers[c];this.options.simplifyPluralSuffix&&o.numbers.length===2&&o.numbers[0]===1&&(p===2?p="plural":p===1&&(p=""));const _=()=>this.options.prepend&&p.toString()?this.options.prepend+p.toString():p.toString();return this.options.compatibilityJSON==="v1"?p===1?"":typeof p=="number"?`_plural_${p.toString()}`:_():this.options.compatibilityJSON==="v2"||this.options.simplifyPluralSuffix&&o.numbers.length===2&&o.numbers[0]===1?_():this.options.prepend&&c.toString()?this.options.prepend+c.toString():c.toString()}shouldUseIntlApi(){return!z7.includes(this.options.compatibilityJSON)}}function LR(r,o,a){let c=arguments.length>3&&arguments[3]!==void 0?arguments[3]:".",p=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,_=I7(r,o,a);return!_&&p&&typeof a=="string"&&(_=eb(r,a,c),_===void 0&&(_=eb(o,a,c))),_}class j7{constructor(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.logger=fu.create("interpolator"),this.options=o,this.format=o.interpolation&&o.interpolation.format||(a=>a),this.init(o)}init(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};o.interpolation||(o.interpolation={escapeValue:!0});const a=o.interpolation;this.escape=a.escape!==void 0?a.escape:P7,this.escapeValue=a.escapeValue!==void 0?a.escapeValue:!0,this.useRawValueToEscape=a.useRawValueToEscape!==void 0?a.useRawValueToEscape:!1,this.prefix=a.prefix?$m(a.prefix):a.prefixEscaped||"{{",this.suffix=a.suffix?$m(a.suffix):a.suffixEscaped||"}}",this.formatSeparator=a.formatSeparator?a.formatSeparator:a.formatSeparator||",",this.unescapePrefix=a.unescapeSuffix?"":a.unescapePrefix||"-",this.unescapeSuffix=this.unescapePrefix?"":a.unescapeSuffix||"",this.nestingPrefix=a.nestingPrefix?$m(a.nestingPrefix):a.nestingPrefixEscaped||$m("$t("),this.nestingSuffix=a.nestingSuffix?$m(a.nestingSuffix):a.nestingSuffixEscaped||$m(")"),this.nestingOptionsSeparator=a.nestingOptionsSeparator?a.nestingOptionsSeparator:a.nestingOptionsSeparator||",",this.maxReplaces=a.maxReplaces?a.maxReplaces:1e3,this.alwaysFormat=a.alwaysFormat!==void 0?a.alwaysFormat:!1,this.resetRegExp()}reset(){this.options&&this.init(this.options)}resetRegExp(){const o=`${this.prefix}(.+?)${this.suffix}`;this.regexp=new RegExp(o,"g");const a=`${this.prefix}${this.unescapePrefix}(.+?)${this.unescapeSuffix}${this.suffix}`;this.regexpUnescape=new RegExp(a,"g");const c=`${this.nestingPrefix}(.+?)${this.nestingSuffix}`;this.nestingRegexp=new RegExp(c,"g")}interpolate(o,a,c,p){let _,x,T;const C=this.options&&this.options.interpolation&&this.options.interpolation.defaultVariables||{};function P($){return $.replace(/\$/g,"$$$$")}const O=$=>{if($.indexOf(this.formatSeparator)<0){const G=LR(a,C,$,this.options.keySeparator,this.options.ignoreJSONStructure);return this.alwaysFormat?this.format(G,void 0,c,{...p,...a,interpolationkey:$}):G}const K=$.split(this.formatSeparator),ie=K.shift().trim(),H=K.join(this.formatSeparator).trim();return this.format(LR(a,C,ie,this.options.keySeparator,this.options.ignoreJSONStructure),H,c,{...p,...a,interpolationkey:ie})};this.resetRegExp();const F=p&&p.missingInterpolationHandler||this.options.missingInterpolationHandler,U=p&&p.interpolation&&p.interpolation.skipOnVariables!==void 0?p.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables;return[{regex:this.regexpUnescape,safeValue:$=>P($)},{regex:this.regexp,safeValue:$=>this.escapeValue?P(this.escape($)):P($)}].forEach($=>{for(T=0;_=$.regex.exec(o);){const K=_[1].trim();if(x=O(K),x===void 0)if(typeof F=="function"){const H=F(o,_,p);x=typeof H=="string"?H:""}else if(p&&Object.prototype.hasOwnProperty.call(p,K))x="";else if(U){x=_[0];continue}else this.logger.warn(`missed to pass in variable ${K} for interpolating ${o}`),x="";else typeof x!="string"&&!this.useRawValueToEscape&&(x=MR(x));const ie=$.safeValue(x);if(o=o.replace(_[0],ie),U?($.regex.lastIndex+=x.length,$.regex.lastIndex-=_[0].length):$.regex.lastIndex=0,T++,T>=this.maxReplaces)break}}),o}nest(o,a){let c=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},p,_,x;function T(C,P){const O=this.nestingOptionsSeparator;if(C.indexOf(O)<0)return C;const F=C.split(new RegExp(`${O}[ ]*{`));let U=`{${F[1]}`;C=F[0],U=this.interpolate(U,x);const Z=U.match(/'/g),$=U.match(/"/g);(Z&&Z.length%2===0&&!$||$.length%2!==0)&&(U=U.replace(/'/g,'"'));try{x=JSON.parse(U),P&&(x={...P,...x})}catch(K){return this.logger.warn(`failed parsing options string in nesting for key ${C}`,K),`${C}${O}${U}`}return delete x.defaultValue,C}for(;p=this.nestingRegexp.exec(o);){let C=[];x={...c},x=x.replace&&typeof x.replace!="string"?x.replace:x,x.applyPostProcessor=!1,delete x.defaultValue;let P=!1;if(p[0].indexOf(this.formatSeparator)!==-1&&!/{.*}/.test(p[1])){const O=p[1].split(this.formatSeparator).map(F=>F.trim());p[1]=O.shift(),C=O,P=!0}if(_=a(T.call(this,p[1].trim(),x),x),_&&p[0]===o&&typeof _!="string")return _;typeof _!="string"&&(_=MR(_)),_||(this.logger.warn(`missed to resolve ${p[1]} for nesting ${o}`),_=""),P&&(_=C.reduce((O,F)=>this.format(O,F,c.lng,{...c,interpolationkey:p[1].trim()}),_.trim())),o=o.replace(p[0],_),this.regexp.lastIndex=0}return o}}function U7(r){let o=r.toLowerCase().trim();const a={};if(r.indexOf("(")>-1){const c=r.split("(");o=c[0].toLowerCase().trim();const p=c[1].substring(0,c[1].length-1);o==="currency"&&p.indexOf(":")<0?a.currency||(a.currency=p.trim()):o==="relativetime"&&p.indexOf(":")<0?a.range||(a.range=p.trim()):p.split(";").forEach(x=>{if(!x)return;const[T,...C]=x.split(":"),P=C.join(":").trim().replace(/^'+|'+$/g,"");a[T.trim()]||(a[T.trim()]=P),P==="false"&&(a[T.trim()]=!1),P==="true"&&(a[T.trim()]=!0),isNaN(P)||(a[T.trim()]=parseInt(P,10))})}return{formatName:o,formatOptions:a}}function Gm(r){const o={};return function(c,p,_){const x=p+JSON.stringify(_);let T=o[x];return T||(T=r(tb(p),_),o[x]=T),T(c)}}class V7{constructor(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.logger=fu.create("formatter"),this.options=o,this.formats={number:Gm((a,c)=>{const p=new Intl.NumberFormat(a,{...c});return _=>p.format(_)}),currency:Gm((a,c)=>{const p=new Intl.NumberFormat(a,{...c,style:"currency"});return _=>p.format(_)}),datetime:Gm((a,c)=>{const p=new Intl.DateTimeFormat(a,{...c});return _=>p.format(_)}),relativetime:Gm((a,c)=>{const p=new Intl.RelativeTimeFormat(a,{...c});return _=>p.format(_,c.range||"day")}),list:Gm((a,c)=>{const p=new Intl.ListFormat(a,{...c});return _=>p.format(_)})},this.init(o)}init(o){const c=(arguments.length>1&&arguments[1]!==void 0?arguments[1]:{interpolation:{}}).interpolation;this.formatSeparator=c.formatSeparator?c.formatSeparator:c.formatSeparator||","}add(o,a){this.formats[o.toLowerCase().trim()]=a}addCached(o,a){this.formats[o.toLowerCase().trim()]=Gm(a)}format(o,a,c){let p=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};return a.split(this.formatSeparator).reduce((T,C)=>{const{formatName:P,formatOptions:O}=U7(C);if(this.formats[P]){let F=T;try{const U=p&&p.formatParams&&p.formatParams[p.interpolationkey]||{},Z=U.locale||U.lng||p.locale||p.lng||c;F=this.formats[P](T,Z,{...O,...p,...U})}catch(U){this.logger.warn(U)}return F}else this.logger.warn(`there was no format function for ${P}`);return T},o)}}function $7(r,o){r.pending[o]!==void 0&&(delete r.pending[o],r.pendingCount--)}class G7 extends Jb{constructor(o,a,c){let p=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};super(),this.backend=o,this.store=a,this.services=c,this.languageUtils=c.languageUtils,this.options=p,this.logger=fu.create("backendConnector"),this.waitingReads=[],this.maxParallelReads=p.maxParallelReads||10,this.readingCalls=0,this.maxRetries=p.maxRetries>=0?p.maxRetries:5,this.retryTimeout=p.retryTimeout>=1?p.retryTimeout:350,this.state={},this.queue=[],this.backend&&this.backend.init&&this.backend.init(c,p.backend,p)}queueLoad(o,a,c,p){const _={},x={},T={},C={};return o.forEach(P=>{let O=!0;a.forEach(F=>{const U=`${P}|${F}`;!c.reload&&this.store.hasResourceBundle(P,F)?this.state[U]=2:this.state[U]<0||(this.state[U]===1?x[U]===void 0&&(x[U]=!0):(this.state[U]=1,O=!1,x[U]===void 0&&(x[U]=!0),_[U]===void 0&&(_[U]=!0),C[F]===void 0&&(C[F]=!0)))}),O||(T[P]=!0)}),(Object.keys(_).length||Object.keys(x).length)&&this.queue.push({pending:x,pendingCount:Object.keys(x).length,loaded:{},errors:[],callback:p}),{toLoad:Object.keys(_),pending:Object.keys(x),toLoadLanguages:Object.keys(T),toLoadNamespaces:Object.keys(C)}}loaded(o,a,c){const p=o.split("|"),_=p[0],x=p[1];a&&this.emit("failedLoading",_,x,a),c&&this.store.addResourceBundle(_,x,c),this.state[o]=a?-1:2;const T={};this.queue.forEach(C=>{M7(C.loaded,[_],x),$7(C,o),a&&C.errors.push(a),C.pendingCount===0&&!C.done&&(Object.keys(C.loaded).forEach(P=>{T[P]||(T[P]={});const O=C.loaded[P];O.length&&O.forEach(F=>{T[P][F]===void 0&&(T[P][F]=!0)})}),C.done=!0,C.errors.length?C.callback(C.errors):C.callback())}),this.emit("loaded",T),this.queue=this.queue.filter(C=>!C.done)}read(o,a,c){let p=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,_=arguments.length>4&&arguments[4]!==void 0?arguments[4]:this.retryTimeout,x=arguments.length>5?arguments[5]:void 0;if(!o.length)return x(null,{});if(this.readingCalls>=this.maxParallelReads){this.waitingReads.push({lng:o,ns:a,fcName:c,tried:p,wait:_,callback:x});return}this.readingCalls++;const T=(P,O)=>{if(this.readingCalls--,this.waitingReads.length>0){const F=this.waitingReads.shift();this.read(F.lng,F.ns,F.fcName,F.tried,F.wait,F.callback)}if(P&&O&&p<this.maxRetries){setTimeout(()=>{this.read.call(this,o,a,c,p+1,_*2,x)},_);return}x(P,O)},C=this.backend[c].bind(this.backend);if(C.length===2){try{const P=C(o,a);P&&typeof P.then=="function"?P.then(O=>T(null,O)).catch(T):T(null,P)}catch(P){T(P)}return}return C(o,a,T)}prepareLoading(o,a){let c=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},p=arguments.length>3?arguments[3]:void 0;if(!this.backend)return this.logger.warn("No backend was added via i18next.use. Will not load resources."),p&&p();typeof o=="string"&&(o=this.languageUtils.toResolveHierarchy(o)),typeof a=="string"&&(a=[a]);const _=this.queueLoad(o,a,c,p);if(!_.toLoad.length)return _.pending.length||p(),null;_.toLoad.forEach(x=>{this.loadOne(x)})}load(o,a,c){this.prepareLoading(o,a,{},c)}reload(o,a,c){this.prepareLoading(o,a,{reload:!0},c)}loadOne(o){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";const c=o.split("|"),p=c[0],_=c[1];this.read(p,_,"read",void 0,void 0,(x,T)=>{x&&this.logger.warn(`${a}loading namespace ${_} for language ${p} failed`,x),!x&&T&&this.logger.log(`${a}loaded namespace ${_} for language ${p}`,T),this.loaded(o,x,T)})}saveMissing(o,a,c,p,_){let x=arguments.length>5&&arguments[5]!==void 0?arguments[5]:{},T=arguments.length>6&&arguments[6]!==void 0?arguments[6]:()=>{};if(this.services.utils&&this.services.utils.hasLoadedNamespace&&!this.services.utils.hasLoadedNamespace(a)){this.logger.warn(`did not save key "${c}" as the namespace "${a}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!");return}if(!(c==null||c==="")){if(this.backend&&this.backend.create){const C={...x,isUpdate:_},P=this.backend.create.bind(this.backend);if(P.length<6)try{let O;P.length===5?O=P(o,a,c,p,C):O=P(o,a,c,p),O&&typeof O.then=="function"?O.then(F=>T(null,F)).catch(T):T(null,O)}catch(O){T(O)}else P(o,a,c,p,T,C)}!o||!o[0]||this.store.addResource(o[0],a,c,p)}}}function OR(){return{debug:!1,initImmediate:!0,ns:["translation"],defaultNS:["translation"],fallbackLng:["dev"],fallbackNS:!1,supportedLngs:!1,nonExplicitSupportedLngs:!1,load:"all",preload:!1,simplifyPluralSuffix:!0,keySeparator:".",nsSeparator:":",pluralSeparator:"_",contextSeparator:"_",partialBundledLanguages:!1,saveMissing:!1,updateMissing:!1,saveMissingTo:"fallback",saveMissingPlurals:!0,missingKeyHandler:!1,missingInterpolationHandler:!1,postProcess:!1,postProcessPassResolved:!1,returnNull:!1,returnEmptyString:!0,returnObjects:!1,joinArrays:!1,returnedObjectHandler:!1,parseMissingKeyHandler:!1,appendNamespaceToMissingKey:!1,appendNamespaceToCIMode:!1,overloadTranslationOptionHandler:function(o){let a={};if(typeof o[1]=="object"&&(a=o[1]),typeof o[1]=="string"&&(a.defaultValue=o[1]),typeof o[2]=="string"&&(a.tDescription=o[2]),typeof o[2]=="object"||typeof o[3]=="object"){const c=o[3]||o[2];Object.keys(c).forEach(p=>{a[p]=c[p]})}return a},interpolation:{escapeValue:!0,format:(r,o,a,c)=>r,prefix:"{{",suffix:"}}",formatSeparator:",",unescapePrefix:"-",nestingPrefix:"$t(",nestingSuffix:")",nestingOptionsSeparator:",",maxReplaces:1e3,skipOnVariables:!0}}}function zR(r){return typeof r.ns=="string"&&(r.ns=[r.ns]),typeof r.fallbackLng=="string"&&(r.fallbackLng=[r.fallbackLng]),typeof r.fallbackNS=="string"&&(r.fallbackNS=[r.fallbackNS]),r.supportedLngs&&r.supportedLngs.indexOf("cimode")<0&&(r.supportedLngs=r.supportedLngs.concat(["cimode"])),r}function zx(){}function H7(r){Object.getOwnPropertyNames(Object.getPrototypeOf(r)).forEach(a=>{typeof r[a]=="function"&&(r[a]=r[a].bind(r))})}class q0 extends Jb{constructor(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},a=arguments.length>1?arguments[1]:void 0;if(super(),this.options=zR(o),this.services={},this.logger=fu,this.modules={external:[]},H7(this),a&&!this.isInitialized&&!o.isClone){if(!this.options.initImmediate)return this.init(o,a),this;setTimeout(()=>{this.init(o,a)},0)}}init(){var o=this;let a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},c=arguments.length>1?arguments[1]:void 0;typeof a=="function"&&(c=a,a={}),!a.defaultNS&&a.defaultNS!==!1&&a.ns&&(typeof a.ns=="string"?a.defaultNS=a.ns:a.ns.indexOf("translation")<0&&(a.defaultNS=a.ns[0]));const p=OR();this.options={...p,...this.options,...zR(a)},this.options.compatibilityAPI!=="v1"&&(this.options.interpolation={...p.interpolation,...this.options.interpolation}),a.keySeparator!==void 0&&(this.options.userDefinedKeySeparator=a.keySeparator),a.nsSeparator!==void 0&&(this.options.userDefinedNsSeparator=a.nsSeparator);function _(O){return O?typeof O=="function"?new O:O:null}if(!this.options.isClone){this.modules.logger?fu.init(_(this.modules.logger),this.options):fu.init(null,this.options);let O;this.modules.formatter?O=this.modules.formatter:typeof Intl<"u"&&(O=V7);const F=new RR(this.options);this.store=new kR(this.options.resources,this.options);const U=this.services;U.logger=fu,U.resourceStore=this.store,U.languageUtils=F,U.pluralResolver=new N7(F,{prepend:this.options.pluralSeparator,compatibilityJSON:this.options.compatibilityJSON,simplifyPluralSuffix:this.options.simplifyPluralSuffix}),O&&(!this.options.interpolation.format||this.options.interpolation.format===p.interpolation.format)&&(U.formatter=_(O),U.formatter.init(U,this.options),this.options.interpolation.format=U.formatter.format.bind(U.formatter)),U.interpolator=new j7(this.options),U.utils={hasLoadedNamespace:this.hasLoadedNamespace.bind(this)},U.backendConnector=new G7(_(this.modules.backend),U.resourceStore,U,this.options),U.backendConnector.on("*",function(Z){for(var $=arguments.length,K=new Array($>1?$-1:0),ie=1;ie<$;ie++)K[ie-1]=arguments[ie];o.emit(Z,...K)}),this.modules.languageDetector&&(U.languageDetector=_(this.modules.languageDetector),U.languageDetector.init&&U.languageDetector.init(U,this.options.detection,this.options)),this.modules.i18nFormat&&(U.i18nFormat=_(this.modules.i18nFormat),U.i18nFormat.init&&U.i18nFormat.init(this)),this.translator=new nb(this.services,this.options),this.translator.on("*",function(Z){for(var $=arguments.length,K=new Array($>1?$-1:0),ie=1;ie<$;ie++)K[ie-1]=arguments[ie];o.emit(Z,...K)}),this.modules.external.forEach(Z=>{Z.init&&Z.init(this)})}if(this.format=this.options.interpolation.format,c||(c=zx),this.options.fallbackLng&&!this.services.languageDetector&&!this.options.lng){const O=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);O.length>0&&O[0]!=="dev"&&(this.options.lng=O[0])}!this.services.languageDetector&&!this.options.lng&&this.logger.warn("init: no languageDetector is used and no lng is defined"),["getResource","hasResourceBundle","getResourceBundle","getDataByLanguage"].forEach(O=>{this[O]=function(){return o.store[O](...arguments)}}),["addResource","addResources","addResourceBundle","removeResourceBundle"].forEach(O=>{this[O]=function(){return o.store[O](...arguments),o}});const C=V_(),P=()=>{const O=(F,U)=>{this.isInitialized&&!this.initializedStoreOnce&&this.logger.warn("init: i18next is already initialized. You should call init just once!"),this.isInitialized=!0,this.options.isClone||this.logger.log("initialized",this.options),this.emit("initialized",this.options),C.resolve(U),c(F,U)};if(this.languages&&this.options.compatibilityAPI!=="v1"&&!this.isInitialized)return O(null,this.t.bind(this));this.changeLanguage(this.options.lng,O)};return this.options.resources||!this.options.initImmediate?P():setTimeout(P,0),C}loadResources(o){let c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:zx;const p=typeof o=="string"?o:this.language;if(typeof o=="function"&&(c=o),!this.options.resources||this.options.partialBundledLanguages){if(p&&p.toLowerCase()==="cimode")return c();const _=[],x=T=>{if(!T)return;this.services.languageUtils.toResolveHierarchy(T).forEach(P=>{_.indexOf(P)<0&&_.push(P)})};p?x(p):this.services.languageUtils.getFallbackCodes(this.options.fallbackLng).forEach(C=>x(C)),this.options.preload&&this.options.preload.forEach(T=>x(T)),this.services.backendConnector.load(_,this.options.ns,T=>{!T&&!this.resolvedLanguage&&this.language&&this.setResolvedLanguage(this.language),c(T)})}else c(null)}reloadResources(o,a,c){const p=V_();return o||(o=this.languages),a||(a=this.options.ns),c||(c=zx),this.services.backendConnector.reload(o,a,_=>{p.resolve(),c(_)}),p}use(o){if(!o)throw new Error("You are passing an undefined module! Please check the object you are passing to i18next.use()");if(!o.type)throw new Error("You are passing a wrong module! Please check the object you are passing to i18next.use()");return o.type==="backend"&&(this.modules.backend=o),(o.type==="logger"||o.log&&o.warn&&o.error)&&(this.modules.logger=o),o.type==="languageDetector"&&(this.modules.languageDetector=o),o.type==="i18nFormat"&&(this.modules.i18nFormat=o),o.type==="postProcessor"&&oz.addPostProcessor(o),o.type==="formatter"&&(this.modules.formatter=o),o.type==="3rdParty"&&this.modules.external.push(o),this}setResolvedLanguage(o){if(!(!o||!this.languages)&&!(["cimode","dev"].indexOf(o)>-1))for(let a=0;a<this.languages.length;a++){const c=this.languages[a];if(!(["cimode","dev"].indexOf(c)>-1)&&this.store.hasLanguageSomeTranslations(c)){this.resolvedLanguage=c;break}}}changeLanguage(o,a){var c=this;this.isLanguageChangingTo=o;const p=V_();this.emit("languageChanging",o);const _=C=>{this.language=C,this.languages=this.services.languageUtils.toResolveHierarchy(C),this.resolvedLanguage=void 0,this.setResolvedLanguage(C)},x=(C,P)=>{P?(_(P),this.translator.changeLanguage(P),this.isLanguageChangingTo=void 0,this.emit("languageChanged",P),this.logger.log("languageChanged",P)):this.isLanguageChangingTo=void 0,p.resolve(function(){return c.t(...arguments)}),a&&a(C,function(){return c.t(...arguments)})},T=C=>{!o&&!C&&this.services.languageDetector&&(C=[]);const P=typeof C=="string"?C:this.services.languageUtils.getBestMatchFromCodes(C);P&&(this.language||_(P),this.translator.language||this.translator.changeLanguage(P),this.services.languageDetector&&this.services.languageDetector.cacheUserLanguage&&this.services.languageDetector.cacheUserLanguage(P)),this.loadResources(P,O=>{x(O,P)})};return!o&&this.services.languageDetector&&!this.services.languageDetector.async?T(this.services.languageDetector.detect()):!o&&this.services.languageDetector&&this.services.languageDetector.async?this.services.languageDetector.detect.length===0?this.services.languageDetector.detect().then(T):this.services.languageDetector.detect(T):T(o),p}getFixedT(o,a,c){var p=this;const _=function(x,T){let C;if(typeof T!="object"){for(var P=arguments.length,O=new Array(P>2?P-2:0),F=2;F<P;F++)O[F-2]=arguments[F];C=p.options.overloadTranslationOptionHandler([x,T].concat(O))}else C={...T};C.lng=C.lng||_.lng,C.lngs=C.lngs||_.lngs,C.ns=C.ns||_.ns,C.keyPrefix=C.keyPrefix||c||_.keyPrefix;const U=p.options.keySeparator||".";let Z;return C.keyPrefix&&Array.isArray(x)?Z=x.map($=>`${C.keyPrefix}${U}${$}`):Z=C.keyPrefix?`${C.keyPrefix}${U}${x}`:x,p.t(Z,C)};return typeof o=="string"?_.lng=o:_.lngs=o,_.ns=a,_.keyPrefix=c,_}t(){return this.translator&&this.translator.translate(...arguments)}exists(){return this.translator&&this.translator.exists(...arguments)}setDefaultNamespace(o){this.options.defaultNS=o}hasLoadedNamespace(o){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!this.isInitialized)return this.logger.warn("hasLoadedNamespace: i18next was not initialized",this.languages),!1;if(!this.languages||!this.languages.length)return this.logger.warn("hasLoadedNamespace: i18n.languages were undefined or empty",this.languages),!1;const c=a.lng||this.resolvedLanguage||this.languages[0],p=this.options?this.options.fallbackLng:!1,_=this.languages[this.languages.length-1];if(c.toLowerCase()==="cimode")return!0;const x=(T,C)=>{const P=this.services.backendConnector.state[`${T}|${C}`];return P===-1||P===2};if(a.precheck){const T=a.precheck(this,x);if(T!==void 0)return T}return!!(this.hasResourceBundle(c,o)||!this.services.backendConnector.backend||this.options.resources&&!this.options.partialBundledLanguages||x(c,o)&&(!p||x(_,o)))}loadNamespaces(o,a){const c=V_();return this.options.ns?(typeof o=="string"&&(o=[o]),o.forEach(p=>{this.options.ns.indexOf(p)<0&&this.options.ns.push(p)}),this.loadResources(p=>{c.resolve(),a&&a(p)}),c):(a&&a(),Promise.resolve())}loadLanguages(o,a){const c=V_();typeof o=="string"&&(o=[o]);const p=this.options.preload||[],_=o.filter(x=>p.indexOf(x)<0);return _.length?(this.options.preload=p.concat(_),this.loadResources(x=>{c.resolve(),a&&a(x)}),c):(a&&a(),Promise.resolve())}dir(o){if(o||(o=this.resolvedLanguage||(this.languages&&this.languages.length>0?this.languages[0]:this.language)),!o)return"rtl";const a=["ar","shu","sqr","ssh","xaa","yhd","yud","aao","abh","abv","acm","acq","acw","acx","acy","adf","ads","aeb","aec","afb","ajp","apc","apd","arb","arq","ars","ary","arz","auz","avl","ayh","ayl","ayn","ayp","bbz","pga","he","iw","ps","pbt","pbu","pst","prp","prd","ug","ur","ydd","yds","yih","ji","yi","hbo","men","xmn","fa","jpr","peo","pes","prs","dv","sam","ckb"],c=this.services&&this.services.languageUtils||new RR(OR());return a.indexOf(c.getLanguagePartFromCode(o))>-1||o.toLowerCase().indexOf("-arab")>1?"rtl":"ltr"}static createInstance(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},a=arguments.length>1?arguments[1]:void 0;return new q0(o,a)}cloneInstance(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:zx;const c=o.forkResourceStore;c&&delete o.forkResourceStore;const p={...this.options,...o,isClone:!0},_=new q0(p);return(o.debug!==void 0||o.prefix!==void 0)&&(_.logger=_.logger.clone(o)),["store","services","language"].forEach(T=>{_[T]=this[T]}),_.services={...this.services},_.services.utils={hasLoadedNamespace:_.hasLoadedNamespace.bind(_)},c&&(_.store=new kR(this.store.data,p),_.services.resourceStore=_.store),_.translator=new nb(_.services,p),_.translator.on("*",function(T){for(var C=arguments.length,P=new Array(C>1?C-1:0),O=1;O<C;O++)P[O-1]=arguments[O];_.emit(T,...P)}),_.init(p,a),_.translator.options=p,_.translator.backendConnector.services.utils={hasLoadedNamespace:_.hasLoadedNamespace.bind(_)},_}toJSON(){return{options:this.options,store:this.store,language:this.language,languages:this.languages,resolvedLanguage:this.resolvedLanguage}}}const is=q0.createInstance();is.createInstance=q0.createInstance;is.createInstance;is.dir;is.init;is.loadResources;is.reloadResources;is.use;is.changeLanguage;is.getFixedT;is.t;is.exists;is.setDefaultNamespace;is.hasLoadedNamespace;is.loadNamespaces;is.loadLanguages;function q7(r,o){if(!(r instanceof o))throw new TypeError("Cannot call a class as a function")}function W0(r){"@babel/helpers - typeof";return W0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(o){return typeof o}:function(o){return o&&typeof Symbol=="function"&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},W0(r)}function W7(r,o){if(W0(r)!=="object"||r===null)return r;var a=r[Symbol.toPrimitive];if(a!==void 0){var c=a.call(r,o||"default");if(W0(c)!=="object")return c;throw new TypeError("@@toPrimitive must return a primitive value.")}return(o==="string"?String:Number)(r)}function Z7(r){var o=W7(r,"string");return W0(o)==="symbol"?o:String(o)}function FR(r,o){for(var a=0;a<o.length;a++){var c=o[a];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(r,Z7(c.key),c)}}function X7(r,o,a){return o&&FR(r.prototype,o),a&&FR(r,a),Object.defineProperty(r,"prototype",{writable:!1}),r}var sz=[],K7=sz.forEach,Y7=sz.slice;function Q7(r){return K7.call(Y7.call(arguments,1),function(o){if(o)for(var a in o)r[a]===void 0&&(r[a]=o[a])}),r}var BR=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/,J7=function(o,a,c){var p=c||{};p.path=p.path||"/";var _=encodeURIComponent(a),x="".concat(o,"=").concat(_);if(p.maxAge>0){var T=p.maxAge-0;if(Number.isNaN(T))throw new Error("maxAge should be a Number");x+="; Max-Age=".concat(Math.floor(T))}if(p.domain){if(!BR.test(p.domain))throw new TypeError("option domain is invalid");x+="; Domain=".concat(p.domain)}if(p.path){if(!BR.test(p.path))throw new TypeError("option path is invalid");x+="; Path=".concat(p.path)}if(p.expires){if(typeof p.expires.toUTCString!="function")throw new TypeError("option expires is invalid");x+="; Expires=".concat(p.expires.toUTCString())}if(p.httpOnly&&(x+="; HttpOnly"),p.secure&&(x+="; Secure"),p.sameSite){var C=typeof p.sameSite=="string"?p.sameSite.toLowerCase():p.sameSite;switch(C){case!0:x+="; SameSite=Strict";break;case"lax":x+="; SameSite=Lax";break;case"strict":x+="; SameSite=Strict";break;case"none":x+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}}return x},NR={create:function(o,a,c,p){var _=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{path:"/",sameSite:"strict"};c&&(_.expires=new Date,_.expires.setTime(_.expires.getTime()+c*60*1e3)),p&&(_.domain=p),document.cookie=J7(o,encodeURIComponent(a),_)},read:function(o){for(var a="".concat(o,"="),c=document.cookie.split(";"),p=0;p<c.length;p++){for(var _=c[p];_.charAt(0)===" ";)_=_.substring(1,_.length);if(_.indexOf(a)===0)return _.substring(a.length,_.length)}return null},remove:function(o){this.create(o,"",-1)}},e9={name:"cookie",lookup:function(o){var a;if(o.lookupCookie&&typeof document<"u"){var c=NR.read(o.lookupCookie);c&&(a=c)}return a},cacheUserLanguage:function(o,a){a.lookupCookie&&typeof document<"u"&&NR.create(a.lookupCookie,o,a.cookieMinutes,a.cookieDomain,a.cookieOptions)}},t9={name:"querystring",lookup:function(o){var a;if(typeof window<"u"){var c=window.location.search;!window.location.search&&window.location.hash&&window.location.hash.indexOf("?")>-1&&(c=window.location.hash.substring(window.location.hash.indexOf("?")));for(var p=c.substring(1),_=p.split("&"),x=0;x<_.length;x++){var T=_[x].indexOf("=");if(T>0){var C=_[x].substring(0,T);C===o.lookupQuerystring&&(a=_[x].substring(T+1))}}}return a}},$_=null,jR=function(){if($_!==null)return $_;try{$_=window!=="undefined"&&window.localStorage!==null;var o="i18next.translate.boo";window.localStorage.setItem(o,"foo"),window.localStorage.removeItem(o)}catch{$_=!1}return $_},n9={name:"localStorage",lookup:function(o){var a;if(o.lookupLocalStorage&&jR()){var c=window.localStorage.getItem(o.lookupLocalStorage);c&&(a=c)}return a},cacheUserLanguage:function(o,a){a.lookupLocalStorage&&jR()&&window.localStorage.setItem(a.lookupLocalStorage,o)}},G_=null,UR=function(){if(G_!==null)return G_;try{G_=window!=="undefined"&&window.sessionStorage!==null;var o="i18next.translate.boo";window.sessionStorage.setItem(o,"foo"),window.sessionStorage.removeItem(o)}catch{G_=!1}return G_},r9={name:"sessionStorage",lookup:function(o){var a;if(o.lookupSessionStorage&&UR()){var c=window.sessionStorage.getItem(o.lookupSessionStorage);c&&(a=c)}return a},cacheUserLanguage:function(o,a){a.lookupSessionStorage&&UR()&&window.sessionStorage.setItem(a.lookupSessionStorage,o)}},i9={name:"navigator",lookup:function(o){var a=[];if(typeof navigator<"u"){if(navigator.languages)for(var c=0;c<navigator.languages.length;c++)a.push(navigator.languages[c]);navigator.userLanguage&&a.push(navigator.userLanguage),navigator.language&&a.push(navigator.language)}return a.length>0?a:void 0}},o9={name:"htmlTag",lookup:function(o){var a,c=o.htmlTag||(typeof document<"u"?document.documentElement:null);return c&&typeof c.getAttribute=="function"&&(a=c.getAttribute("lang")),a}},s9={name:"path",lookup:function(o){var a;if(typeof window<"u"){var c=window.location.pathname.match(/\/([a-zA-Z-]*)/g);if(c instanceof Array)if(typeof o.lookupFromPathIndex=="number"){if(typeof c[o.lookupFromPathIndex]!="string")return;a=c[o.lookupFromPathIndex].replace("/","")}else a=c[0].replace("/","")}return a}},a9={name:"subdomain",lookup:function(o){var a=typeof o.lookupFromSubdomainIndex=="number"?o.lookupFromSubdomainIndex+1:1,c=typeof window<"u"&&window.location&&window.location.hostname&&window.location.hostname.match(/^(\w{2,5})\.(([a-z0-9-]{1,63}\.[a-z]{2,6})|localhost)/i);if(c)return c[a]}};function l9(){return{order:["querystring","cookie","localStorage","sessionStorage","navigator","htmlTag"],lookupQuerystring:"lng",lookupCookie:"i18next",lookupLocalStorage:"i18nextLng",lookupSessionStorage:"i18nextLng",caches:["localStorage"],excludeCacheFor:["cimode"],convertDetectedLanguage:function(o){return o}}}var az=function(){function r(o){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};q7(this,r),this.type="languageDetector",this.detectors={},this.init(o,a)}return X7(r,[{key:"init",value:function(a){var c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};this.services=a||{languageUtils:{}},this.options=Q7(c,this.options||{},l9()),typeof this.options.convertDetectedLanguage=="string"&&this.options.convertDetectedLanguage.indexOf("15897")>-1&&(this.options.convertDetectedLanguage=function(_){return _.replace("-","_")}),this.options.lookupFromUrlIndex&&(this.options.lookupFromPathIndex=this.options.lookupFromUrlIndex),this.i18nOptions=p,this.addDetector(e9),this.addDetector(t9),this.addDetector(n9),this.addDetector(r9),this.addDetector(i9),this.addDetector(o9),this.addDetector(s9),this.addDetector(a9)}},{key:"addDetector",value:function(a){this.detectors[a.name]=a}},{key:"detect",value:function(a){var c=this;a||(a=this.options.order);var p=[];return a.forEach(function(_){if(c.detectors[_]){var x=c.detectors[_].lookup(c.options);x&&typeof x=="string"&&(x=[x]),x&&(p=p.concat(x))}}),p=p.map(function(_){return c.options.convertDetectedLanguage(_)}),this.services.languageUtils.getBestMatchFromCodes?p:p.length>0?p[0]:null}},{key:"cacheUserLanguage",value:function(a,c){var p=this;c||(c=this.options.caches),c&&(this.options.excludeCacheFor&&this.options.excludeCacheFor.indexOf(a)>-1||c.forEach(function(_){p.detectors[_]&&p.detectors[_].cacheUserLanguage(a,p.options)}))}}]),r}();az.type="languageDetector";function $i(){return $i=Object.assign?Object.assign.bind():function(r){for(var o=1;o<arguments.length;o++){var a=arguments[o];for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(r[c]=a[c])}return r},$i.apply(this,arguments)}const u9=/&(?:amp|#38|lt|#60|gt|#62|apos|#39|quot|#34|nbsp|#160|copy|#169|reg|#174|hellip|#8230|#x2F|#47);/g,c9={"&amp;":"&","&#38;":"&","&lt;":"<","&#60;":"<","&gt;":">","&#62;":">","&apos;":"'","&#39;":"'","&quot;":'"',"&#34;":'"',"&nbsp;":" ","&#160;":" ","&copy;":"","&#169;":"","&reg;":"","&#174;":"","&hellip;":"","&#8230;":"","&#x2F;":"/","&#47;":"/"},h9=r=>c9[r],d9=r=>r.replace(u9,h9);let VR={bindI18n:"languageChanged",bindI18nStore:"",transEmptyNodeValue:"",transSupportBasicHtmlNodes:!0,transWrapTextNodes:"",transKeepBasicHtmlNodesFor:["br","strong","i","p"],useSuspense:!0,unescape:d9};function f9(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};VR={...VR,...r}}const p9={type:"3rdParty",init(r){f9(r.options.react)}},m9={title:"Hello, World!"},g9=Object.freeze(Object.defineProperty({__proto__:null,main:m9},Symbol.toStringTag,{value:"Module"})),y9={title:" !"},_9=Object.freeze(Object.defineProperty({__proto__:null,main:y9},Symbol.toStringTag,{value:"Module"})),v9={"ko-KR":{..._9},"en-US":{...g9}};is.use(az).use(p9).init({resources:v9,lng:"ko-KR",fallbackLng:{"en-US":["en-US"],default:["ko-KR"]},interpolation:{escapeValue:!1},ns:"main",defaultNS:"main"});class $g{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(o){const a={listener:o};return this.listeners.add(a),this.onSubscribe(),()=>{this.listeners.delete(a),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}}const Z0=typeof window>"u"||"Deno"in window;function Ma(){}function x9(r,o){return typeof r=="function"?r(o):r}function OT(r){return typeof r=="number"&&r>=0&&r!==1/0}function lz(r,o){return Math.max(r+(o||0)-Date.now(),0)}function h0(r,o,a){return _v(r)?typeof o=="function"?{...a,queryKey:r,queryFn:o}:{...o,queryKey:r}:r}function w9(r,o,a){return _v(r)?typeof o=="function"?{...a,mutationKey:r,mutationFn:o}:{...o,mutationKey:r}:typeof r=="function"?{...o,mutationFn:r}:{...r}}function Rh(r,o,a){return _v(r)?[{...o,queryKey:r},a]:[r||{},o]}function $R(r,o){const{type:a="all",exact:c,fetchStatus:p,predicate:_,queryKey:x,stale:T}=r;if(_v(x)){if(c){if(o.queryHash!==vA(x,o.options))return!1}else if(!rb(o.queryKey,x))return!1}if(a!=="all"){const C=o.isActive();if(a==="active"&&!C||a==="inactive"&&C)return!1}return!(typeof T=="boolean"&&o.isStale()!==T||typeof p<"u"&&p!==o.state.fetchStatus||_&&!_(o))}function GR(r,o){const{exact:a,fetching:c,predicate:p,mutationKey:_}=r;if(_v(_)){if(!o.options.mutationKey)return!1;if(a){if(bf(o.options.mutationKey)!==bf(_))return!1}else if(!rb(o.options.mutationKey,_))return!1}return!(typeof c=="boolean"&&o.state.status==="loading"!==c||p&&!p(o))}function vA(r,o){return((o==null?void 0:o.queryKeyHashFn)||bf)(r)}function bf(r){return JSON.stringify(r,(o,a)=>zT(a)?Object.keys(a).sort().reduce((c,p)=>(c[p]=a[p],c),{}):a)}function rb(r,o){return uz(r,o)}function uz(r,o){return r===o?!0:typeof r!=typeof o?!1:r&&o&&typeof r=="object"&&typeof o=="object"?!Object.keys(o).some(a=>!uz(r[a],o[a])):!1}function cz(r,o){if(r===o)return r;const a=HR(r)&&HR(o);if(a||zT(r)&&zT(o)){const c=a?r.length:Object.keys(r).length,p=a?o:Object.keys(o),_=p.length,x=a?[]:{};let T=0;for(let C=0;C<_;C++){const P=a?C:p[C];x[P]=cz(r[P],o[P]),x[P]===r[P]&&T++}return c===_&&T===c?r:x}return o}function ib(r,o){if(r&&!o||o&&!r)return!1;for(const a in r)if(r[a]!==o[a])return!1;return!0}function HR(r){return Array.isArray(r)&&r.length===Object.keys(r).length}function zT(r){if(!qR(r))return!1;const o=r.constructor;if(typeof o>"u")return!0;const a=o.prototype;return!(!qR(a)||!a.hasOwnProperty("isPrototypeOf"))}function qR(r){return Object.prototype.toString.call(r)==="[object Object]"}function _v(r){return Array.isArray(r)}function hz(r){return new Promise(o=>{setTimeout(o,r)})}function WR(r){hz(0).then(r)}function b9(){if(typeof AbortController=="function")return new AbortController}function FT(r,o,a){return a.isDataEqual!=null&&a.isDataEqual(r,o)?r:typeof a.structuralSharing=="function"?a.structuralSharing(r,o):a.structuralSharing!==!1?cz(r,o):o}class S9 extends $g{constructor(){super(),this.setup=o=>{if(!Z0&&window.addEventListener){const a=()=>o();return window.addEventListener("visibilitychange",a,!1),window.addEventListener("focus",a,!1),()=>{window.removeEventListener("visibilitychange",a),window.removeEventListener("focus",a)}}}}onSubscribe(){this.cleanup||this.setEventListener(this.setup)}onUnsubscribe(){if(!this.hasListeners()){var o;(o=this.cleanup)==null||o.call(this),this.cleanup=void 0}}setEventListener(o){var a;this.setup=o,(a=this.cleanup)==null||a.call(this),this.cleanup=o(c=>{typeof c=="boolean"?this.setFocused(c):this.onFocus()})}setFocused(o){this.focused!==o&&(this.focused=o,this.onFocus())}onFocus(){this.listeners.forEach(({listener:o})=>{o()})}isFocused(){return typeof this.focused=="boolean"?this.focused:typeof document>"u"?!0:[void 0,"visible","prerender"].includes(document.visibilityState)}}const ob=new S9,ZR=["online","offline"];class E9 extends $g{constructor(){super(),this.setup=o=>{if(!Z0&&window.addEventListener){const a=()=>o();return ZR.forEach(c=>{window.addEventListener(c,a,!1)}),()=>{ZR.forEach(c=>{window.removeEventListener(c,a)})}}}}onSubscribe(){this.cleanup||this.setEventListener(this.setup)}onUnsubscribe(){if(!this.hasListeners()){var o;(o=this.cleanup)==null||o.call(this),this.cleanup=void 0}}setEventListener(o){var a;this.setup=o,(a=this.cleanup)==null||a.call(this),this.cleanup=o(c=>{typeof c=="boolean"?this.setOnline(c):this.onOnline()})}setOnline(o){this.online!==o&&(this.online=o,this.onOnline())}onOnline(){this.listeners.forEach(({listener:o})=>{o()})}isOnline(){return typeof this.online=="boolean"?this.online:typeof navigator>"u"||typeof navigator.onLine>"u"?!0:navigator.onLine}}const sb=new E9;function T9(r){return Math.min(1e3*2**r,3e4)}function e2(r){return(r??"online")==="online"?sb.isOnline():!0}class dz{constructor(o){this.revert=o==null?void 0:o.revert,this.silent=o==null?void 0:o.silent}}function Cw(r){return r instanceof dz}function fz(r){let o=!1,a=0,c=!1,p,_,x;const T=new Promise((ie,H)=>{_=ie,x=H}),C=ie=>{c||(Z(new dz(ie)),r.abort==null||r.abort())},P=()=>{o=!0},O=()=>{o=!1},F=()=>!ob.isFocused()||r.networkMode!=="always"&&!sb.isOnline(),U=ie=>{c||(c=!0,r.onSuccess==null||r.onSuccess(ie),p==null||p(),_(ie))},Z=ie=>{c||(c=!0,r.onError==null||r.onError(ie),p==null||p(),x(ie))},$=()=>new Promise(ie=>{p=H=>{const G=c||!F();return G&&ie(H),G},r.onPause==null||r.onPause()}).then(()=>{p=void 0,c||r.onContinue==null||r.onContinue()}),K=()=>{if(c)return;let ie;try{ie=r.fn()}catch(H){ie=Promise.reject(H)}Promise.resolve(ie).then(U).catch(H=>{var G,ee;if(c)return;const W=(G=r.retry)!=null?G:3,me=(ee=r.retryDelay)!=null?ee:T9,de=typeof me=="function"?me(a,H):me,he=W===!0||typeof W=="number"&&a<W||typeof W=="function"&&W(a,H);if(o||!he){Z(H);return}a++,r.onFail==null||r.onFail(a,H),hz(de).then(()=>{if(F())return $()}).then(()=>{o?Z(H):K()})})};return e2(r.networkMode)?K():$().then(K),{promise:T,cancel:C,continue:()=>(p==null?void 0:p())?T:Promise.resolve(),cancelRetry:P,continueRetry:O}}const xA=console;function C9(){let r=[],o=0,a=O=>{O()},c=O=>{O()};const p=O=>{let F;o++;try{F=O()}finally{o--,o||T()}return F},_=O=>{o?r.push(O):WR(()=>{a(O)})},x=O=>(...F)=>{_(()=>{O(...F)})},T=()=>{const O=r;r=[],O.length&&WR(()=>{c(()=>{O.forEach(F=>{a(F)})})})};return{batch:p,batchCalls:x,schedule:_,setNotifyFunction:O=>{a=O},setBatchNotifyFunction:O=>{c=O}}}const Hi=C9();class pz{destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),OT(this.cacheTime)&&(this.gcTimeout=setTimeout(()=>{this.optionalRemove()},this.cacheTime))}updateCacheTime(o){this.cacheTime=Math.max(this.cacheTime||0,o??(Z0?1/0:5*60*1e3))}clearGcTimeout(){this.gcTimeout&&(clearTimeout(this.gcTimeout),this.gcTimeout=void 0)}}class A9 extends pz{constructor(o){super(),this.abortSignalConsumed=!1,this.defaultOptions=o.defaultOptions,this.setOptions(o.options),this.observers=[],this.cache=o.cache,this.logger=o.logger||xA,this.queryKey=o.queryKey,this.queryHash=o.queryHash,this.initialState=o.state||M9(this.options),this.state=this.initialState,this.scheduleGc()}get meta(){return this.options.meta}setOptions(o){this.options={...this.defaultOptions,...o},this.updateCacheTime(this.options.cacheTime)}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&this.cache.remove(this)}setData(o,a){const c=FT(this.state.data,o,this.options);return this.dispatch({data:c,type:"success",dataUpdatedAt:a==null?void 0:a.updatedAt,manual:a==null?void 0:a.manual}),c}setState(o,a){this.dispatch({type:"setState",state:o,setStateOptions:a})}cancel(o){var a;const c=this.promise;return(a=this.retryer)==null||a.cancel(o),c?c.then(Ma).catch(Ma):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(this.initialState)}isActive(){return this.observers.some(o=>o.options.enabled!==!1)}isDisabled(){return this.getObserversCount()>0&&!this.isActive()}isStale(){return this.state.isInvalidated||!this.state.dataUpdatedAt||this.observers.some(o=>o.getCurrentResult().isStale)}isStaleByTime(o=0){return this.state.isInvalidated||!this.state.dataUpdatedAt||!lz(this.state.dataUpdatedAt,o)}onFocus(){var o;const a=this.observers.find(c=>c.shouldFetchOnWindowFocus());a&&a.refetch({cancelRefetch:!1}),(o=this.retryer)==null||o.continue()}onOnline(){var o;const a=this.observers.find(c=>c.shouldFetchOnReconnect());a&&a.refetch({cancelRefetch:!1}),(o=this.retryer)==null||o.continue()}addObserver(o){this.observers.includes(o)||(this.observers.push(o),this.clearGcTimeout(),this.cache.notify({type:"observerAdded",query:this,observer:o}))}removeObserver(o){this.observers.includes(o)&&(this.observers=this.observers.filter(a=>a!==o),this.observers.length||(this.retryer&&(this.abortSignalConsumed?this.retryer.cancel({revert:!0}):this.retryer.cancelRetry()),this.scheduleGc()),this.cache.notify({type:"observerRemoved",query:this,observer:o}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||this.dispatch({type:"invalidate"})}fetch(o,a){var c,p;if(this.state.fetchStatus!=="idle"){if(this.state.dataUpdatedAt&&a!=null&&a.cancelRefetch)this.cancel({silent:!0});else if(this.promise){var _;return(_=this.retryer)==null||_.continueRetry(),this.promise}}if(o&&this.setOptions(o),!this.options.queryFn){const Z=this.observers.find($=>$.options.queryFn);Z&&this.setOptions(Z.options)}Array.isArray(this.options.queryKey);const x=b9(),T={queryKey:this.queryKey,pageParam:void 0,meta:this.meta},C=Z=>{Object.defineProperty(Z,"signal",{enumerable:!0,get:()=>{if(x)return this.abortSignalConsumed=!0,x.signal}})};C(T);const P=()=>this.options.queryFn?(this.abortSignalConsumed=!1,this.options.queryFn(T)):Promise.reject("Missing queryFn for queryKey '"+this.options.queryHash+"'"),O={fetchOptions:a,options:this.options,queryKey:this.queryKey,state:this.state,fetchFn:P};if(C(O),(c=this.options.behavior)==null||c.onFetch(O),this.revertState=this.state,this.state.fetchStatus==="idle"||this.state.fetchMeta!==((p=O.fetchOptions)==null?void 0:p.meta)){var F;this.dispatch({type:"fetch",meta:(F=O.fetchOptions)==null?void 0:F.meta})}const U=Z=>{if(Cw(Z)&&Z.silent||this.dispatch({type:"error",error:Z}),!Cw(Z)){var $,K,ie,H;($=(K=this.cache.config).onError)==null||$.call(K,Z,this),(ie=(H=this.cache.config).onSettled)==null||ie.call(H,this.state.data,Z,this)}this.isFetchingOptimistic||this.scheduleGc(),this.isFetchingOptimistic=!1};return this.retryer=fz({fn:O.fetchFn,abort:x==null?void 0:x.abort.bind(x),onSuccess:Z=>{var $,K,ie,H;if(typeof Z>"u"){U(new Error(this.queryHash+" data is undefined"));return}this.setData(Z),($=(K=this.cache.config).onSuccess)==null||$.call(K,Z,this),(ie=(H=this.cache.config).onSettled)==null||ie.call(H,Z,this.state.error,this),this.isFetchingOptimistic||this.scheduleGc(),this.isFetchingOptimistic=!1},onError:U,onFail:(Z,$)=>{this.dispatch({type:"failed",failureCount:Z,error:$})},onPause:()=>{this.dispatch({type:"pause"})},onContinue:()=>{this.dispatch({type:"continue"})},retry:O.options.retry,retryDelay:O.options.retryDelay,networkMode:O.options.networkMode}),this.promise=this.retryer.promise,this.promise}dispatch(o){const a=c=>{var p,_;switch(o.type){case"failed":return{...c,fetchFailureCount:o.failureCount,fetchFailureReason:o.error};case"pause":return{...c,fetchStatus:"paused"};case"continue":return{...c,fetchStatus:"fetching"};case"fetch":return{...c,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:(p=o.meta)!=null?p:null,fetchStatus:e2(this.options.networkMode)?"fetching":"paused",...!c.dataUpdatedAt&&{error:null,status:"loading"}};case"success":return{...c,data:o.data,dataUpdateCount:c.dataUpdateCount+1,dataUpdatedAt:(_=o.dataUpdatedAt)!=null?_:Date.now(),error:null,isInvalidated:!1,status:"success",...!o.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};case"error":const x=o.error;return Cw(x)&&x.revert&&this.revertState?{...this.revertState}:{...c,error:x,errorUpdateCount:c.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:c.fetchFailureCount+1,fetchFailureReason:x,fetchStatus:"idle",status:"error"};case"invalidate":return{...c,isInvalidated:!0};case"setState":return{...c,...o.state}}};this.state=a(this.state),Hi.batch(()=>{this.observers.forEach(c=>{c.onQueryUpdate(o)}),this.cache.notify({query:this,type:"updated",action:o})})}}function M9(r){const o=typeof r.initialData=="function"?r.initialData():r.initialData,a=typeof o<"u",c=a?typeof r.initialDataUpdatedAt=="function"?r.initialDataUpdatedAt():r.initialDataUpdatedAt:0;return{data:o,dataUpdateCount:0,dataUpdatedAt:a?c??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:a?"success":"loading",fetchStatus:"idle"}}class I9 extends $g{constructor(o){super(),this.config=o||{},this.queries=[],this.queriesMap={}}build(o,a,c){var p;const _=a.queryKey,x=(p=a.queryHash)!=null?p:vA(_,a);let T=this.get(x);return T||(T=new A9({cache:this,logger:o.getLogger(),queryKey:_,queryHash:x,options:o.defaultQueryOptions(a),state:c,defaultOptions:o.getQueryDefaults(_)}),this.add(T)),T}add(o){this.queriesMap[o.queryHash]||(this.queriesMap[o.queryHash]=o,this.queries.push(o),this.notify({type:"added",query:o}))}remove(o){const a=this.queriesMap[o.queryHash];a&&(o.destroy(),this.queries=this.queries.filter(c=>c!==o),a===o&&delete this.queriesMap[o.queryHash],this.notify({type:"removed",query:o}))}clear(){Hi.batch(()=>{this.queries.forEach(o=>{this.remove(o)})})}get(o){return this.queriesMap[o]}getAll(){return this.queries}find(o,a){const[c]=Rh(o,a);return typeof c.exact>"u"&&(c.exact=!0),this.queries.find(p=>$R(c,p))}findAll(o,a){const[c]=Rh(o,a);return Object.keys(c).length>0?this.queries.filter(p=>$R(c,p)):this.queries}notify(o){Hi.batch(()=>{this.listeners.forEach(({listener:a})=>{a(o)})})}onFocus(){Hi.batch(()=>{this.queries.forEach(o=>{o.onFocus()})})}onOnline(){Hi.batch(()=>{this.queries.forEach(o=>{o.onOnline()})})}}class k9 extends pz{constructor(o){super(),this.defaultOptions=o.defaultOptions,this.mutationId=o.mutationId,this.mutationCache=o.mutationCache,this.logger=o.logger||xA,this.observers=[],this.state=o.state||mz(),this.setOptions(o.options),this.scheduleGc()}setOptions(o){this.options={...this.defaultOptions,...o},this.updateCacheTime(this.options.cacheTime)}get meta(){return this.options.meta}setState(o){this.dispatch({type:"setState",state:o})}addObserver(o){this.observers.includes(o)||(this.observers.push(o),this.clearGcTimeout(),this.mutationCache.notify({type:"observerAdded",mutation:this,observer:o}))}removeObserver(o){this.observers=this.observers.filter(a=>a!==o),this.scheduleGc(),this.mutationCache.notify({type:"observerRemoved",mutation:this,observer:o})}optionalRemove(){this.observers.length||(this.state.status==="loading"?this.scheduleGc():this.mutationCache.remove(this))}continue(){var o,a;return(o=(a=this.retryer)==null?void 0:a.continue())!=null?o:this.execute()}async execute(){const o=()=>{var he;return this.retryer=fz({fn:()=>this.options.mutationFn?this.options.mutationFn(this.state.variables):Promise.reject("No mutationFn found"),onFail:(se,q)=>{this.dispatch({type:"failed",failureCount:se,error:q})},onPause:()=>{this.dispatch({type:"pause"})},onContinue:()=>{this.dispatch({type:"continue"})},retry:(he=this.options.retry)!=null?he:0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode}),this.retryer.promise},a=this.state.status==="loading";try{var c,p,_,x,T,C,P,O;if(!a){var F,U,Z,$;this.dispatch({type:"loading",variables:this.options.variables}),await((F=(U=this.mutationCache.config).onMutate)==null?void 0:F.call(U,this.state.variables,this));const se=await((Z=($=this.options).onMutate)==null?void 0:Z.call($,this.state.variables));se!==this.state.context&&this.dispatch({type:"loading",context:se,variables:this.state.variables})}const he=await o();return await((c=(p=this.mutationCache.config).onSuccess)==null?void 0:c.call(p,he,this.state.variables,this.state.context,this)),await((_=(x=this.options).onSuccess)==null?void 0:_.call(x,he,this.state.variables,this.state.context)),await((T=(C=this.mutationCache.config).onSettled)==null?void 0:T.call(C,he,null,this.state.variables,this.state.context,this)),await((P=(O=this.options).onSettled)==null?void 0:P.call(O,he,null,this.state.variables,this.state.context)),this.dispatch({type:"success",data:he}),he}catch(he){try{var K,ie,H,G,ee,W,me,de;throw await((K=(ie=this.mutationCache.config).onError)==null?void 0:K.call(ie,he,this.state.variables,this.state.context,this)),await((H=(G=this.options).onError)==null?void 0:H.call(G,he,this.state.variables,this.state.context)),await((ee=(W=this.mutationCache.config).onSettled)==null?void 0:ee.call(W,void 0,he,this.state.variables,this.state.context,this)),await((me=(de=this.options).onSettled)==null?void 0:me.call(de,void 0,he,this.state.variables,this.state.context)),he}finally{this.dispatch({type:"error",error:he})}}}dispatch(o){const a=c=>{switch(o.type){case"failed":return{...c,failureCount:o.failureCount,failureReason:o.error};case"pause":return{...c,isPaused:!0};case"continue":return{...c,isPaused:!1};case"loading":return{...c,context:o.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:!e2(this.options.networkMode),status:"loading",variables:o.variables};case"success":return{...c,data:o.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...c,data:void 0,error:o.error,failureCount:c.failureCount+1,failureReason:o.error,isPaused:!1,status:"error"};case"setState":return{...c,...o.state}}};this.state=a(this.state),Hi.batch(()=>{this.observers.forEach(c=>{c.onMutationUpdate(o)}),this.mutationCache.notify({mutation:this,type:"updated",action:o})})}}function mz(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0}}class P9 extends $g{constructor(o){super(),this.config=o||{},this.mutations=[],this.mutationId=0}build(o,a,c){const p=new k9({mutationCache:this,logger:o.getLogger(),mutationId:++this.mutationId,options:o.defaultMutationOptions(a),state:c,defaultOptions:a.mutationKey?o.getMutationDefaults(a.mutationKey):void 0});return this.add(p),p}add(o){this.mutations.push(o),this.notify({type:"added",mutation:o})}remove(o){this.mutations=this.mutations.filter(a=>a!==o),this.notify({type:"removed",mutation:o})}clear(){Hi.batch(()=>{this.mutations.forEach(o=>{this.remove(o)})})}getAll(){return this.mutations}find(o){return typeof o.exact>"u"&&(o.exact=!0),this.mutations.find(a=>GR(o,a))}findAll(o){return this.mutations.filter(a=>GR(o,a))}notify(o){Hi.batch(()=>{this.listeners.forEach(({listener:a})=>{a(o)})})}resumePausedMutations(){var o;return this.resuming=((o=this.resuming)!=null?o:Promise.resolve()).then(()=>{const a=this.mutations.filter(c=>c.state.isPaused);return Hi.batch(()=>a.reduce((c,p)=>c.then(()=>p.continue().catch(Ma)),Promise.resolve()))}).then(()=>{this.resuming=void 0}),this.resuming}}function R9(){return{onFetch:r=>{r.fetchFn=()=>{var o,a,c,p,_,x;const T=(o=r.fetchOptions)==null||(a=o.meta)==null?void 0:a.refetchPage,C=(c=r.fetchOptions)==null||(p=c.meta)==null?void 0:p.fetchMore,P=C==null?void 0:C.pageParam,O=(C==null?void 0:C.direction)==="forward",F=(C==null?void 0:C.direction)==="backward",U=((_=r.state.data)==null?void 0:_.pages)||[],Z=((x=r.state.data)==null?void 0:x.pageParams)||[];let $=Z,K=!1;const ie=de=>{Object.defineProperty(de,"signal",{enumerable:!0,get:()=>{var he;if((he=r.signal)!=null&&he.aborted)K=!0;else{var se;(se=r.signal)==null||se.addEventListener("abort",()=>{K=!0})}return r.signal}})},H=r.options.queryFn||(()=>Promise.reject("Missing queryFn for queryKey '"+r.options.queryHash+"'")),G=(de,he,se,q)=>($=q?[he,...$]:[...$,he],q?[se,...de]:[...de,se]),ee=(de,he,se,q)=>{if(K)return Promise.reject("Cancelled");if(typeof se>"u"&&!he&&de.length)return Promise.resolve(de);const Se={queryKey:r.queryKey,pageParam:se,meta:r.options.meta};ie(Se);const ze=H(Se);return Promise.resolve(ze).then(Be=>G(de,se,Be,q))};let W;if(!U.length)W=ee([]);else if(O){const de=typeof P<"u",he=de?P:XR(r.options,U);W=ee(U,de,he)}else if(F){const de=typeof P<"u",he=de?P:D9(r.options,U);W=ee(U,de,he,!0)}else{$=[];const de=typeof r.options.getNextPageParam>"u";W=(T&&U[0]?T(U[0],0,U):!0)?ee([],de,Z[0]):Promise.resolve(G([],Z[0],U[0]));for(let se=1;se<U.length;se++)W=W.then(q=>{if(T&&U[se]?T(U[se],se,U):!0){const ze=de?Z[se]:XR(r.options,q);return ee(q,de,ze)}return Promise.resolve(G(q,Z[se],U[se]))})}return W.then(de=>({pages:de,pageParams:$}))}}}}function XR(r,o){return r.getNextPageParam==null?void 0:r.getNextPageParam(o[o.length-1],o)}function D9(r,o){return r.getPreviousPageParam==null?void 0:r.getPreviousPageParam(o[0],o)}class L9{constructor(o={}){this.queryCache=o.queryCache||new I9,this.mutationCache=o.mutationCache||new P9,this.logger=o.logger||xA,this.defaultOptions=o.defaultOptions||{},this.queryDefaults=[],this.mutationDefaults=[],this.mountCount=0}mount(){this.mountCount++,this.mountCount===1&&(this.unsubscribeFocus=ob.subscribe(()=>{ob.isFocused()&&(this.resumePausedMutations(),this.queryCache.onFocus())}),this.unsubscribeOnline=sb.subscribe(()=>{sb.isOnline()&&(this.resumePausedMutations(),this.queryCache.onOnline())}))}unmount(){var o,a;this.mountCount--,this.mountCount===0&&((o=this.unsubscribeFocus)==null||o.call(this),this.unsubscribeFocus=void 0,(a=this.unsubscribeOnline)==null||a.call(this),this.unsubscribeOnline=void 0)}isFetching(o,a){const[c]=Rh(o,a);return c.fetchStatus="fetching",this.queryCache.findAll(c).length}isMutating(o){return this.mutationCache.findAll({...o,fetching:!0}).length}getQueryData(o,a){var c;return(c=this.queryCache.find(o,a))==null?void 0:c.state.data}ensureQueryData(o,a,c){const p=h0(o,a,c),_=this.getQueryData(p.queryKey);return _?Promise.resolve(_):this.fetchQuery(p)}getQueriesData(o){return this.getQueryCache().findAll(o).map(({queryKey:a,state:c})=>{const p=c.data;return[a,p]})}setQueryData(o,a,c){const p=this.queryCache.find(o),_=p==null?void 0:p.state.data,x=x9(a,_);if(typeof x>"u")return;const T=h0(o),C=this.defaultQueryOptions(T);return this.queryCache.build(this,C).setData(x,{...c,manual:!0})}setQueriesData(o,a,c){return Hi.batch(()=>this.getQueryCache().findAll(o).map(({queryKey:p})=>[p,this.setQueryData(p,a,c)]))}getQueryState(o,a){var c;return(c=this.queryCache.find(o,a))==null?void 0:c.state}removeQueries(o,a){const[c]=Rh(o,a),p=this.queryCache;Hi.batch(()=>{p.findAll(c).forEach(_=>{p.remove(_)})})}resetQueries(o,a,c){const[p,_]=Rh(o,a,c),x=this.queryCache,T={type:"active",...p};return Hi.batch(()=>(x.findAll(p).forEach(C=>{C.reset()}),this.refetchQueries(T,_)))}cancelQueries(o,a,c){const[p,_={}]=Rh(o,a,c);typeof _.revert>"u"&&(_.revert=!0);const x=Hi.batch(()=>this.queryCache.findAll(p).map(T=>T.cancel(_)));return Promise.all(x).then(Ma).catch(Ma)}invalidateQueries(o,a,c){const[p,_]=Rh(o,a,c);return Hi.batch(()=>{var x,T;if(this.queryCache.findAll(p).forEach(P=>{P.invalidate()}),p.refetchType==="none")return Promise.resolve();const C={...p,type:(x=(T=p.refetchType)!=null?T:p.type)!=null?x:"active"};return this.refetchQueries(C,_)})}refetchQueries(o,a,c){const[p,_]=Rh(o,a,c),x=Hi.batch(()=>this.queryCache.findAll(p).filter(C=>!C.isDisabled()).map(C=>{var P;return C.fetch(void 0,{..._,cancelRefetch:(P=_==null?void 0:_.cancelRefetch)!=null?P:!0,meta:{refetchPage:p.refetchPage}})}));let T=Promise.all(x).then(Ma);return _!=null&&_.throwOnError||(T=T.catch(Ma)),T}fetchQuery(o,a,c){const p=h0(o,a,c),_=this.defaultQueryOptions(p);typeof _.retry>"u"&&(_.retry=!1);const x=this.queryCache.build(this,_);return x.isStaleByTime(_.staleTime)?x.fetch(_):Promise.resolve(x.state.data)}prefetchQuery(o,a,c){return this.fetchQuery(o,a,c).then(Ma).catch(Ma)}fetchInfiniteQuery(o,a,c){const p=h0(o,a,c);return p.behavior=R9(),this.fetchQuery(p)}prefetchInfiniteQuery(o,a,c){return this.fetchInfiniteQuery(o,a,c).then(Ma).catch(Ma)}resumePausedMutations(){return this.mutationCache.resumePausedMutations()}getQueryCache(){return this.queryCache}getMutationCache(){return this.mutationCache}getLogger(){return this.logger}getDefaultOptions(){return this.defaultOptions}setDefaultOptions(o){this.defaultOptions=o}setQueryDefaults(o,a){const c=this.queryDefaults.find(p=>bf(o)===bf(p.queryKey));c?c.defaultOptions=a:this.queryDefaults.push({queryKey:o,defaultOptions:a})}getQueryDefaults(o){if(!o)return;const a=this.queryDefaults.find(c=>rb(o,c.queryKey));return a==null?void 0:a.defaultOptions}setMutationDefaults(o,a){const c=this.mutationDefaults.find(p=>bf(o)===bf(p.mutationKey));c?c.defaultOptions=a:this.mutationDefaults.push({mutationKey:o,defaultOptions:a})}getMutationDefaults(o){if(!o)return;const a=this.mutationDefaults.find(c=>rb(o,c.mutationKey));return a==null?void 0:a.defaultOptions}defaultQueryOptions(o){if(o!=null&&o._defaulted)return o;const a={...this.defaultOptions.queries,...this.getQueryDefaults(o==null?void 0:o.queryKey),...o,_defaulted:!0};return!a.queryHash&&a.queryKey&&(a.queryHash=vA(a.queryKey,a)),typeof a.refetchOnReconnect>"u"&&(a.refetchOnReconnect=a.networkMode!=="always"),typeof a.useErrorBoundary>"u"&&(a.useErrorBoundary=!!a.suspense),a}defaultMutationOptions(o){return o!=null&&o._defaulted?o:{...this.defaultOptions.mutations,...this.getMutationDefaults(o==null?void 0:o.mutationKey),...o,_defaulted:!0}}clear(){this.queryCache.clear(),this.mutationCache.clear()}}class O9 extends $g{constructor(o,a){super(),this.client=o,this.options=a,this.trackedProps=new Set,this.selectError=null,this.bindMethods(),this.setOptions(a)}bindMethods(){this.remove=this.remove.bind(this),this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(this.currentQuery.addObserver(this),KR(this.currentQuery,this.options)&&this.executeFetch(),this.updateTimers())}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return BT(this.currentQuery,this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return BT(this.currentQuery,this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,this.clearStaleTimeout(),this.clearRefetchInterval(),this.currentQuery.removeObserver(this)}setOptions(o,a){const c=this.options,p=this.currentQuery;if(this.options=this.client.defaultQueryOptions(o),ib(c,this.options)||this.client.getQueryCache().notify({type:"observerOptionsUpdated",query:this.currentQuery,observer:this}),typeof this.options.enabled<"u"&&typeof this.options.enabled!="boolean")throw new Error("Expected enabled to be a boolean");this.options.queryKey||(this.options.queryKey=c.queryKey),this.updateQuery();const _=this.hasListeners();_&&YR(this.currentQuery,p,this.options,c)&&this.executeFetch(),this.updateResult(a),_&&(this.currentQuery!==p||this.options.enabled!==c.enabled||this.options.staleTime!==c.staleTime)&&this.updateStaleTimeout();const x=this.computeRefetchInterval();_&&(this.currentQuery!==p||this.options.enabled!==c.enabled||x!==this.currentRefetchInterval)&&this.updateRefetchInterval(x)}getOptimisticResult(o){const a=this.client.getQueryCache().build(this.client,o),c=this.createResult(a,o);return F9(this,c,o)&&(this.currentResult=c,this.currentResultOptions=this.options,this.currentResultState=this.currentQuery.state),c}getCurrentResult(){return this.currentResult}trackResult(o){const a={};return Object.keys(o).forEach(c=>{Object.defineProperty(a,c,{configurable:!1,enumerable:!0,get:()=>(this.trackedProps.add(c),o[c])})}),a}getCurrentQuery(){return this.currentQuery}remove(){this.client.getQueryCache().remove(this.currentQuery)}refetch({refetchPage:o,...a}={}){return this.fetch({...a,meta:{refetchPage:o}})}fetchOptimistic(o){const a=this.client.defaultQueryOptions(o),c=this.client.getQueryCache().build(this.client,a);return c.isFetchingOptimistic=!0,c.fetch().then(()=>this.createResult(c,a))}fetch(o){var a;return this.executeFetch({...o,cancelRefetch:(a=o.cancelRefetch)!=null?a:!0}).then(()=>(this.updateResult(),this.currentResult))}executeFetch(o){this.updateQuery();let a=this.currentQuery.fetch(this.options,o);return o!=null&&o.throwOnError||(a=a.catch(Ma)),a}updateStaleTimeout(){if(this.clearStaleTimeout(),Z0||this.currentResult.isStale||!OT(this.options.staleTime))return;const a=lz(this.currentResult.dataUpdatedAt,this.options.staleTime)+1;this.staleTimeoutId=setTimeout(()=>{this.currentResult.isStale||this.updateResult()},a)}computeRefetchInterval(){var o;return typeof this.options.refetchInterval=="function"?this.options.refetchInterval(this.currentResult.data,this.currentQuery):(o=this.options.refetchInterval)!=null?o:!1}updateRefetchInterval(o){this.clearRefetchInterval(),this.currentRefetchInterval=o,!(Z0||this.options.enabled===!1||!OT(this.currentRefetchInterval)||this.currentRefetchInterval===0)&&(this.refetchIntervalId=setInterval(()=>{(this.options.refetchIntervalInBackground||ob.isFocused())&&this.executeFetch()},this.currentRefetchInterval))}updateTimers(){this.updateStaleTimeout(),this.updateRefetchInterval(this.computeRefetchInterval())}clearStaleTimeout(){this.staleTimeoutId&&(clearTimeout(this.staleTimeoutId),this.staleTimeoutId=void 0)}clearRefetchInterval(){this.refetchIntervalId&&(clearInterval(this.refetchIntervalId),this.refetchIntervalId=void 0)}createResult(o,a){const c=this.currentQuery,p=this.options,_=this.currentResult,x=this.currentResultState,T=this.currentResultOptions,C=o!==c,P=C?o.state:this.currentQueryInitialState,O=C?this.currentResult:this.previousQueryResult,{state:F}=o;let{dataUpdatedAt:U,error:Z,errorUpdatedAt:$,fetchStatus:K,status:ie}=F,H=!1,G=!1,ee;if(a._optimisticResults){const se=this.hasListeners(),q=!se&&KR(o,a),Se=se&&YR(o,c,a,p);(q||Se)&&(K=e2(o.options.networkMode)?"fetching":"paused",U||(ie="loading")),a._optimisticResults==="isRestoring"&&(K="idle")}if(a.keepPreviousData&&!F.dataUpdatedAt&&O!=null&&O.isSuccess&&ie!=="error")ee=O.data,U=O.dataUpdatedAt,ie=O.status,H=!0;else if(a.select&&typeof F.data<"u")if(_&&F.data===(x==null?void 0:x.data)&&a.select===this.selectFn)ee=this.selectResult;else try{this.selectFn=a.select,ee=a.select(F.data),ee=FT(_==null?void 0:_.data,ee,a),this.selectResult=ee,this.selectError=null}catch(se){this.selectError=se}else ee=F.data;if(typeof a.placeholderData<"u"&&typeof ee>"u"&&ie==="loading"){let se;if(_!=null&&_.isPlaceholderData&&a.placeholderData===(T==null?void 0:T.placeholderData))se=_.data;else if(se=typeof a.placeholderData=="function"?a.placeholderData():a.placeholderData,a.select&&typeof se<"u")try{se=a.select(se),this.selectError=null}catch(q){this.selectError=q}typeof se<"u"&&(ie="success",ee=FT(_==null?void 0:_.data,se,a),G=!0)}this.selectError&&(Z=this.selectError,ee=this.selectResult,$=Date.now(),ie="error");const W=K==="fetching",me=ie==="loading",de=ie==="error";return{status:ie,fetchStatus:K,isLoading:me,isSuccess:ie==="success",isError:de,isInitialLoading:me&&W,data:ee,dataUpdatedAt:U,error:Z,errorUpdatedAt:$,failureCount:F.fetchFailureCount,failureReason:F.fetchFailureReason,errorUpdateCount:F.errorUpdateCount,isFetched:F.dataUpdateCount>0||F.errorUpdateCount>0,isFetchedAfterMount:F.dataUpdateCount>P.dataUpdateCount||F.errorUpdateCount>P.errorUpdateCount,isFetching:W,isRefetching:W&&!me,isLoadingError:de&&F.dataUpdatedAt===0,isPaused:K==="paused",isPlaceholderData:G,isPreviousData:H,isRefetchError:de&&F.dataUpdatedAt!==0,isStale:wA(o,a),refetch:this.refetch,remove:this.remove}}updateResult(o){const a=this.currentResult,c=this.createResult(this.currentQuery,this.options);if(this.currentResultState=this.currentQuery.state,this.currentResultOptions=this.options,ib(c,a))return;this.currentResult=c;const p={cache:!0},_=()=>{if(!a)return!0;const{notifyOnChangeProps:x}=this.options,T=typeof x=="function"?x():x;if(T==="all"||!T&&!this.trackedProps.size)return!0;const C=new Set(T??this.trackedProps);return this.options.useErrorBoundary&&C.add("error"),Object.keys(this.currentResult).some(P=>{const O=P;return this.currentResult[O]!==a[O]&&C.has(O)})};(o==null?void 0:o.listeners)!==!1&&_()&&(p.listeners=!0),this.notify({...p,...o})}updateQuery(){const o=this.client.getQueryCache().build(this.client,this.options);if(o===this.currentQuery)return;const a=this.currentQuery;this.currentQuery=o,this.currentQueryInitialState=o.state,this.previousQueryResult=this.currentResult,this.hasListeners()&&(a==null||a.removeObserver(this),o.addObserver(this))}onQueryUpdate(o){const a={};o.type==="success"?a.onSuccess=!o.manual:o.type==="error"&&!Cw(o.error)&&(a.onError=!0),this.updateResult(a),this.hasListeners()&&this.updateTimers()}notify(o){Hi.batch(()=>{if(o.onSuccess){var a,c,p,_;(a=(c=this.options).onSuccess)==null||a.call(c,this.currentResult.data),(p=(_=this.options).onSettled)==null||p.call(_,this.currentResult.data,null)}else if(o.onError){var x,T,C,P;(x=(T=this.options).onError)==null||x.call(T,this.currentResult.error),(C=(P=this.options).onSettled)==null||C.call(P,void 0,this.currentResult.error)}o.listeners&&this.listeners.forEach(({listener:O})=>{O(this.currentResult)}),o.cache&&this.client.getQueryCache().notify({query:this.currentQuery,type:"observerResultsUpdated"})})}}function z9(r,o){return o.enabled!==!1&&!r.state.dataUpdatedAt&&!(r.state.status==="error"&&o.retryOnMount===!1)}function KR(r,o){return z9(r,o)||r.state.dataUpdatedAt>0&&BT(r,o,o.refetchOnMount)}function BT(r,o,a){if(o.enabled!==!1){const c=typeof a=="function"?a(r):a;return c==="always"||c!==!1&&wA(r,o)}return!1}function YR(r,o,a,c){return a.enabled!==!1&&(r!==o||c.enabled===!1)&&(!a.suspense||r.state.status!=="error")&&wA(r,a)}function wA(r,o){return r.isStaleByTime(o.staleTime)}function F9(r,o,a){return a.keepPreviousData?!1:a.placeholderData!==void 0?o.isPlaceholderData:!ib(r.getCurrentResult(),o)}let B9=class extends $g{constructor(o,a){super(),this.client=o,this.setOptions(a),this.bindMethods(),this.updateResult()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(o){var a;const c=this.options;this.options=this.client.defaultMutationOptions(o),ib(c,this.options)||this.client.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.currentMutation,observer:this}),(a=this.currentMutation)==null||a.setOptions(this.options)}onUnsubscribe(){if(!this.hasListeners()){var o;(o=this.currentMutation)==null||o.removeObserver(this)}}onMutationUpdate(o){this.updateResult();const a={listeners:!0};o.type==="success"?a.onSuccess=!0:o.type==="error"&&(a.onError=!0),this.notify(a)}getCurrentResult(){return this.currentResult}reset(){this.currentMutation=void 0,this.updateResult(),this.notify({listeners:!0})}mutate(o,a){return this.mutateOptions=a,this.currentMutation&&this.currentMutation.removeObserver(this),this.currentMutation=this.client.getMutationCache().build(this.client,{...this.options,variables:typeof o<"u"?o:this.options.variables}),this.currentMutation.addObserver(this),this.currentMutation.execute()}updateResult(){const o=this.currentMutation?this.currentMutation.state:mz(),a={...o,isLoading:o.status==="loading",isSuccess:o.status==="success",isError:o.status==="error",isIdle:o.status==="idle",mutate:this.mutate,reset:this.reset};this.currentResult=a}notify(o){Hi.batch(()=>{if(this.mutateOptions&&this.hasListeners()){if(o.onSuccess){var a,c,p,_;(a=(c=this.mutateOptions).onSuccess)==null||a.call(c,this.currentResult.data,this.currentResult.variables,this.currentResult.context),(p=(_=this.mutateOptions).onSettled)==null||p.call(_,this.currentResult.data,null,this.currentResult.variables,this.currentResult.context)}else if(o.onError){var x,T,C,P;(x=(T=this.mutateOptions).onError)==null||x.call(T,this.currentResult.error,this.currentResult.variables,this.currentResult.context),(C=(P=this.mutateOptions).onSettled)==null||C.call(P,void 0,this.currentResult.error,this.currentResult.variables,this.currentResult.context)}}o.listeners&&this.listeners.forEach(({listener:O})=>{O(this.currentResult)})})}};var gz={exports:{}},na={},yz={exports:{}},_z={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(r){function o(Te,we){var Q=Te.length;Te.push(we);e:for(;0<Q;){var ce=Q-1>>>1,De=Te[ce];if(0<p(De,we))Te[ce]=we,Te[Q]=De,Q=ce;else break e}}function a(Te){return Te.length===0?null:Te[0]}function c(Te){if(Te.length===0)return null;var we=Te[0],Q=Te.pop();if(Q!==we){Te[0]=Q;e:for(var ce=0,De=Te.length,He=De>>>1;ce<He;){var $e=2*(ce+1)-1,xt=Te[$e],ge=$e+1,Pt=Te[ge];if(0>p(xt,Q))ge<De&&0>p(Pt,xt)?(Te[ce]=Pt,Te[ge]=Q,ce=ge):(Te[ce]=xt,Te[$e]=Q,ce=$e);else if(ge<De&&0>p(Pt,Q))Te[ce]=Pt,Te[ge]=Q,ce=ge;else break e}}return we}function p(Te,we){var Q=Te.sortIndex-we.sortIndex;return Q!==0?Q:Te.id-we.id}if(typeof performance=="object"&&typeof performance.now=="function"){var _=performance;r.unstable_now=function(){return _.now()}}else{var x=Date,T=x.now();r.unstable_now=function(){return x.now()-T}}var C=[],P=[],O=1,F=null,U=3,Z=!1,$=!1,K=!1,ie=typeof setTimeout=="function"?setTimeout:null,H=typeof clearTimeout=="function"?clearTimeout:null,G=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function ee(Te){for(var we=a(P);we!==null;){if(we.callback===null)c(P);else if(we.startTime<=Te)c(P),we.sortIndex=we.expirationTime,o(C,we);else break;we=a(P)}}function W(Te){if(K=!1,ee(Te),!$)if(a(C)!==null)$=!0,zt(me);else{var we=a(P);we!==null&&dt(W,we.startTime-Te)}}function me(Te,we){$=!1,K&&(K=!1,H(se),se=-1),Z=!0;var Q=U;try{for(ee(we),F=a(C);F!==null&&(!(F.expirationTime>we)||Te&&!ze());){var ce=F.callback;if(typeof ce=="function"){F.callback=null,U=F.priorityLevel;var De=ce(F.expirationTime<=we);we=r.unstable_now(),typeof De=="function"?F.callback=De:F===a(C)&&c(C),ee(we)}else c(C);F=a(C)}if(F!==null)var He=!0;else{var $e=a(P);$e!==null&&dt(W,$e.startTime-we),He=!1}return He}finally{F=null,U=Q,Z=!1}}var de=!1,he=null,se=-1,q=5,Se=-1;function ze(){return!(r.unstable_now()-Se<q)}function Ue(){if(he!==null){var Te=r.unstable_now();Se=Te;var we=!0;try{we=he(!0,Te)}finally{we?Be():(de=!1,he=null)}}else de=!1}var Be;if(typeof G=="function")Be=function(){G(Ue)};else if(typeof MessageChannel<"u"){var rt=new MessageChannel,_t=rt.port2;rt.port1.onmessage=Ue,Be=function(){_t.postMessage(null)}}else Be=function(){ie(Ue,0)};function zt(Te){he=Te,de||(de=!0,Be())}function dt(Te,we){se=ie(function(){Te(r.unstable_now())},we)}r.unstable_IdlePriority=5,r.unstable_ImmediatePriority=1,r.unstable_LowPriority=4,r.unstable_NormalPriority=3,r.unstable_Profiling=null,r.unstable_UserBlockingPriority=2,r.unstable_cancelCallback=function(Te){Te.callback=null},r.unstable_continueExecution=function(){$||Z||($=!0,zt(me))},r.unstable_forceFrameRate=function(Te){0>Te||125<Te?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):q=0<Te?Math.floor(1e3/Te):5},r.unstable_getCurrentPriorityLevel=function(){return U},r.unstable_getFirstCallbackNode=function(){return a(C)},r.unstable_next=function(Te){switch(U){case 1:case 2:case 3:var we=3;break;default:we=U}var Q=U;U=we;try{return Te()}finally{U=Q}},r.unstable_pauseExecution=function(){},r.unstable_requestPaint=function(){},r.unstable_runWithPriority=function(Te,we){switch(Te){case 1:case 2:case 3:case 4:case 5:break;default:Te=3}var Q=U;U=Te;try{return we()}finally{U=Q}},r.unstable_scheduleCallback=function(Te,we,Q){var ce=r.unstable_now();switch(typeof Q=="object"&&Q!==null?(Q=Q.delay,Q=typeof Q=="number"&&0<Q?ce+Q:ce):Q=ce,Te){case 1:var De=-1;break;case 2:De=250;break;case 5:De=1073741823;break;case 4:De=1e4;break;default:De=5e3}return De=Q+De,Te={id:O++,callback:we,priorityLevel:Te,startTime:Q,expirationTime:De,sortIndex:-1},Q>ce?(Te.sortIndex=Q,o(P,Te),a(C)===null&&Te===a(P)&&(K?(H(se),se=-1):K=!0,dt(W,Q-ce))):(Te.sortIndex=De,o(C,Te),$||Z||($=!0,zt(me))),Te},r.unstable_shouldYield=ze,r.unstable_wrapCallback=function(Te){var we=U;return function(){var Q=U;U=we;try{return Te.apply(this,arguments)}finally{U=Q}}}})(_z);yz.exports=_z;var N9=yz.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vz=_e,ta=N9;function Nt(r){for(var o="https://reactjs.org/docs/error-decoder.html?invariant="+r,a=1;a<arguments.length;a++)o+="&args[]="+encodeURIComponent(arguments[a]);return"Minified React error #"+r+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var xz=new Set,X0={};function Uf(r,o){Tg(r,o),Tg(r+"Capture",o)}function Tg(r,o){for(X0[r]=o,r=0;r<o.length;r++)xz.add(o[r])}var yc=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),NT=Object.prototype.hasOwnProperty,j9=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,QR={},JR={};function U9(r){return NT.call(JR,r)?!0:NT.call(QR,r)?!1:j9.test(r)?JR[r]=!0:(QR[r]=!0,!1)}function V9(r,o,a,c){if(a!==null&&a.type===0)return!1;switch(typeof o){case"function":case"symbol":return!0;case"boolean":return c?!1:a!==null?!a.acceptsBooleans:(r=r.toLowerCase().slice(0,5),r!=="data-"&&r!=="aria-");default:return!1}}function $9(r,o,a,c){if(o===null||typeof o>"u"||V9(r,o,a,c))return!0;if(c)return!1;if(a!==null)switch(a.type){case 3:return!o;case 4:return o===!1;case 5:return isNaN(o);case 6:return isNaN(o)||1>o}return!1}function Es(r,o,a,c,p,_,x){this.acceptsBooleans=o===2||o===3||o===4,this.attributeName=c,this.attributeNamespace=p,this.mustUseProperty=a,this.propertyName=r,this.type=o,this.sanitizeURL=_,this.removeEmptyString=x}var Go={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(r){Go[r]=new Es(r,0,!1,r,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(r){var o=r[0];Go[o]=new Es(o,1,!1,r[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(r){Go[r]=new Es(r,2,!1,r.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(r){Go[r]=new Es(r,2,!1,r,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(r){Go[r]=new Es(r,3,!1,r.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(r){Go[r]=new Es(r,3,!0,r,null,!1,!1)});["capture","download"].forEach(function(r){Go[r]=new Es(r,4,!1,r,null,!1,!1)});["cols","rows","size","span"].forEach(function(r){Go[r]=new Es(r,6,!1,r,null,!1,!1)});["rowSpan","start"].forEach(function(r){Go[r]=new Es(r,5,!1,r.toLowerCase(),null,!1,!1)});var bA=/[\-:]([a-z])/g;function SA(r){return r[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(r){var o=r.replace(bA,SA);Go[o]=new Es(o,1,!1,r,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(r){var o=r.replace(bA,SA);Go[o]=new Es(o,1,!1,r,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(r){var o=r.replace(bA,SA);Go[o]=new Es(o,1,!1,r,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(r){Go[r]=new Es(r,1,!1,r.toLowerCase(),null,!1,!1)});Go.xlinkHref=new Es("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(r){Go[r]=new Es(r,1,!1,r.toLowerCase(),null,!0,!0)});function EA(r,o,a,c){var p=Go.hasOwnProperty(o)?Go[o]:null;(p!==null?p.type!==0:c||!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&($9(o,a,p,c)&&(a=null),c||p===null?U9(o)&&(a===null?r.removeAttribute(o):r.setAttribute(o,""+a)):p.mustUseProperty?r[p.propertyName]=a===null?p.type===3?!1:"":a:(o=p.attributeName,c=p.attributeNamespace,a===null?r.removeAttribute(o):(p=p.type,a=p===3||p===4&&a===!0?"":""+a,c?r.setAttributeNS(c,o,a):r.setAttribute(o,a))))}var wc=vz.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Fx=Symbol.for("react.element"),Jm=Symbol.for("react.portal"),eg=Symbol.for("react.fragment"),TA=Symbol.for("react.strict_mode"),jT=Symbol.for("react.profiler"),wz=Symbol.for("react.provider"),bz=Symbol.for("react.context"),CA=Symbol.for("react.forward_ref"),UT=Symbol.for("react.suspense"),VT=Symbol.for("react.suspense_list"),AA=Symbol.for("react.memo"),Dh=Symbol.for("react.lazy"),Sz=Symbol.for("react.offscreen"),eD=Symbol.iterator;function H_(r){return r===null||typeof r!="object"?null:(r=eD&&r[eD]||r["@@iterator"],typeof r=="function"?r:null)}var Fi=Object.assign,jE;function d0(r){if(jE===void 0)try{throw Error()}catch(a){var o=a.stack.trim().match(/\n( *(at )?)/);jE=o&&o[1]||""}return`
`+jE+r}var UE=!1;function VE(r,o){if(!r||UE)return"";UE=!0;var a=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(o)if(o=function(){throw Error()},Object.defineProperty(o.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(o,[])}catch(P){var c=P}Reflect.construct(r,[],o)}else{try{o.call()}catch(P){c=P}r.call(o.prototype)}else{try{throw Error()}catch(P){c=P}r()}}catch(P){if(P&&c&&typeof P.stack=="string"){for(var p=P.stack.split(`
`),_=c.stack.split(`
`),x=p.length-1,T=_.length-1;1<=x&&0<=T&&p[x]!==_[T];)T--;for(;1<=x&&0<=T;x--,T--)if(p[x]!==_[T]){if(x!==1||T!==1)do if(x--,T--,0>T||p[x]!==_[T]){var C=`
`+p[x].replace(" at new "," at ");return r.displayName&&C.includes("<anonymous>")&&(C=C.replace("<anonymous>",r.displayName)),C}while(1<=x&&0<=T);break}}}finally{UE=!1,Error.prepareStackTrace=a}return(r=r?r.displayName||r.name:"")?d0(r):""}function G9(r){switch(r.tag){case 5:return d0(r.type);case 16:return d0("Lazy");case 13:return d0("Suspense");case 19:return d0("SuspenseList");case 0:case 2:case 15:return r=VE(r.type,!1),r;case 11:return r=VE(r.type.render,!1),r;case 1:return r=VE(r.type,!0),r;default:return""}}function $T(r){if(r==null)return null;if(typeof r=="function")return r.displayName||r.name||null;if(typeof r=="string")return r;switch(r){case eg:return"Fragment";case Jm:return"Portal";case jT:return"Profiler";case TA:return"StrictMode";case UT:return"Suspense";case VT:return"SuspenseList"}if(typeof r=="object")switch(r.$$typeof){case bz:return(r.displayName||"Context")+".Consumer";case wz:return(r._context.displayName||"Context")+".Provider";case CA:var o=r.render;return r=r.displayName,r||(r=o.displayName||o.name||"",r=r!==""?"ForwardRef("+r+")":"ForwardRef"),r;case AA:return o=r.displayName||null,o!==null?o:$T(r.type)||"Memo";case Dh:o=r._payload,r=r._init;try{return $T(r(o))}catch{}}return null}function H9(r){var o=r.type;switch(r.tag){case 24:return"Cache";case 9:return(o.displayName||"Context")+".Consumer";case 10:return(o._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return r=o.render,r=r.displayName||r.name||"",o.displayName||(r!==""?"ForwardRef("+r+")":"ForwardRef");case 7:return"Fragment";case 5:return o;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return $T(o);case 8:return o===TA?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof o=="function")return o.displayName||o.name||null;if(typeof o=="string")return o}return null}function ed(r){switch(typeof r){case"boolean":case"number":case"string":case"undefined":return r;case"object":return r;default:return""}}function Ez(r){var o=r.type;return(r=r.nodeName)&&r.toLowerCase()==="input"&&(o==="checkbox"||o==="radio")}function q9(r){var o=Ez(r)?"checked":"value",a=Object.getOwnPropertyDescriptor(r.constructor.prototype,o),c=""+r[o];if(!r.hasOwnProperty(o)&&typeof a<"u"&&typeof a.get=="function"&&typeof a.set=="function"){var p=a.get,_=a.set;return Object.defineProperty(r,o,{configurable:!0,get:function(){return p.call(this)},set:function(x){c=""+x,_.call(this,x)}}),Object.defineProperty(r,o,{enumerable:a.enumerable}),{getValue:function(){return c},setValue:function(x){c=""+x},stopTracking:function(){r._valueTracker=null,delete r[o]}}}}function Bx(r){r._valueTracker||(r._valueTracker=q9(r))}function Tz(r){if(!r)return!1;var o=r._valueTracker;if(!o)return!0;var a=o.getValue(),c="";return r&&(c=Ez(r)?r.checked?"true":"false":r.value),r=c,r!==a?(o.setValue(r),!0):!1}function ab(r){if(r=r||(typeof document<"u"?document:void 0),typeof r>"u")return null;try{return r.activeElement||r.body}catch{return r.body}}function GT(r,o){var a=o.checked;return Fi({},o,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:a??r._wrapperState.initialChecked})}function tD(r,o){var a=o.defaultValue==null?"":o.defaultValue,c=o.checked!=null?o.checked:o.defaultChecked;a=ed(o.value!=null?o.value:a),r._wrapperState={initialChecked:c,initialValue:a,controlled:o.type==="checkbox"||o.type==="radio"?o.checked!=null:o.value!=null}}function Cz(r,o){o=o.checked,o!=null&&EA(r,"checked",o,!1)}function HT(r,o){Cz(r,o);var a=ed(o.value),c=o.type;if(a!=null)c==="number"?(a===0&&r.value===""||r.value!=a)&&(r.value=""+a):r.value!==""+a&&(r.value=""+a);else if(c==="submit"||c==="reset"){r.removeAttribute("value");return}o.hasOwnProperty("value")?qT(r,o.type,a):o.hasOwnProperty("defaultValue")&&qT(r,o.type,ed(o.defaultValue)),o.checked==null&&o.defaultChecked!=null&&(r.defaultChecked=!!o.defaultChecked)}function nD(r,o,a){if(o.hasOwnProperty("value")||o.hasOwnProperty("defaultValue")){var c=o.type;if(!(c!=="submit"&&c!=="reset"||o.value!==void 0&&o.value!==null))return;o=""+r._wrapperState.initialValue,a||o===r.value||(r.value=o),r.defaultValue=o}a=r.name,a!==""&&(r.name=""),r.defaultChecked=!!r._wrapperState.initialChecked,a!==""&&(r.name=a)}function qT(r,o,a){(o!=="number"||ab(r.ownerDocument)!==r)&&(a==null?r.defaultValue=""+r._wrapperState.initialValue:r.defaultValue!==""+a&&(r.defaultValue=""+a))}var f0=Array.isArray;function mg(r,o,a,c){if(r=r.options,o){o={};for(var p=0;p<a.length;p++)o["$"+a[p]]=!0;for(a=0;a<r.length;a++)p=o.hasOwnProperty("$"+r[a].value),r[a].selected!==p&&(r[a].selected=p),p&&c&&(r[a].defaultSelected=!0)}else{for(a=""+ed(a),o=null,p=0;p<r.length;p++){if(r[p].value===a){r[p].selected=!0,c&&(r[p].defaultSelected=!0);return}o!==null||r[p].disabled||(o=r[p])}o!==null&&(o.selected=!0)}}function WT(r,o){if(o.dangerouslySetInnerHTML!=null)throw Error(Nt(91));return Fi({},o,{value:void 0,defaultValue:void 0,children:""+r._wrapperState.initialValue})}function rD(r,o){var a=o.value;if(a==null){if(a=o.children,o=o.defaultValue,a!=null){if(o!=null)throw Error(Nt(92));if(f0(a)){if(1<a.length)throw Error(Nt(93));a=a[0]}o=a}o==null&&(o=""),a=o}r._wrapperState={initialValue:ed(a)}}function Az(r,o){var a=ed(o.value),c=ed(o.defaultValue);a!=null&&(a=""+a,a!==r.value&&(r.value=a),o.defaultValue==null&&r.defaultValue!==a&&(r.defaultValue=a)),c!=null&&(r.defaultValue=""+c)}function iD(r){var o=r.textContent;o===r._wrapperState.initialValue&&o!==""&&o!==null&&(r.value=o)}function Mz(r){switch(r){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ZT(r,o){return r==null||r==="http://www.w3.org/1999/xhtml"?Mz(o):r==="http://www.w3.org/2000/svg"&&o==="foreignObject"?"http://www.w3.org/1999/xhtml":r}var Nx,Iz=function(r){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(o,a,c,p){MSApp.execUnsafeLocalFunction(function(){return r(o,a,c,p)})}:r}(function(r,o){if(r.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in r)r.innerHTML=o;else{for(Nx=Nx||document.createElement("div"),Nx.innerHTML="<svg>"+o.valueOf().toString()+"</svg>",o=Nx.firstChild;r.firstChild;)r.removeChild(r.firstChild);for(;o.firstChild;)r.appendChild(o.firstChild)}});function K0(r,o){if(o){var a=r.firstChild;if(a&&a===r.lastChild&&a.nodeType===3){a.nodeValue=o;return}}r.textContent=o}var S0={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},W9=["Webkit","ms","Moz","O"];Object.keys(S0).forEach(function(r){W9.forEach(function(o){o=o+r.charAt(0).toUpperCase()+r.substring(1),S0[o]=S0[r]})});function kz(r,o,a){return o==null||typeof o=="boolean"||o===""?"":a||typeof o!="number"||o===0||S0.hasOwnProperty(r)&&S0[r]?(""+o).trim():o+"px"}function Pz(r,o){r=r.style;for(var a in o)if(o.hasOwnProperty(a)){var c=a.indexOf("--")===0,p=kz(a,o[a],c);a==="float"&&(a="cssFloat"),c?r.setProperty(a,p):r[a]=p}}var Z9=Fi({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function XT(r,o){if(o){if(Z9[r]&&(o.children!=null||o.dangerouslySetInnerHTML!=null))throw Error(Nt(137,r));if(o.dangerouslySetInnerHTML!=null){if(o.children!=null)throw Error(Nt(60));if(typeof o.dangerouslySetInnerHTML!="object"||!("__html"in o.dangerouslySetInnerHTML))throw Error(Nt(61))}if(o.style!=null&&typeof o.style!="object")throw Error(Nt(62))}}function KT(r,o){if(r.indexOf("-")===-1)return typeof o.is=="string";switch(r){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var YT=null;function MA(r){return r=r.target||r.srcElement||window,r.correspondingUseElement&&(r=r.correspondingUseElement),r.nodeType===3?r.parentNode:r}var QT=null,gg=null,yg=null;function oD(r){if(r=wv(r)){if(typeof QT!="function")throw Error(Nt(280));var o=r.stateNode;o&&(o=o2(o),QT(r.stateNode,r.type,o))}}function Rz(r){gg?yg?yg.push(r):yg=[r]:gg=r}function Dz(){if(gg){var r=gg,o=yg;if(yg=gg=null,oD(r),o)for(r=0;r<o.length;r++)oD(o[r])}}function Lz(r,o){return r(o)}function Oz(){}var $E=!1;function zz(r,o,a){if($E)return r(o,a);$E=!0;try{return Lz(r,o,a)}finally{$E=!1,(gg!==null||yg!==null)&&(Oz(),Dz())}}function Y0(r,o){var a=r.stateNode;if(a===null)return null;var c=o2(a);if(c===null)return null;a=c[o];e:switch(o){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(c=!c.disabled)||(r=r.type,c=!(r==="button"||r==="input"||r==="select"||r==="textarea")),r=!c;break e;default:r=!1}if(r)return null;if(a&&typeof a!="function")throw Error(Nt(231,o,typeof a));return a}var JT=!1;if(yc)try{var q_={};Object.defineProperty(q_,"passive",{get:function(){JT=!0}}),window.addEventListener("test",q_,q_),window.removeEventListener("test",q_,q_)}catch{JT=!1}function X9(r,o,a,c,p,_,x,T,C){var P=Array.prototype.slice.call(arguments,3);try{o.apply(a,P)}catch(O){this.onError(O)}}var E0=!1,lb=null,ub=!1,eC=null,K9={onError:function(r){E0=!0,lb=r}};function Y9(r,o,a,c,p,_,x,T,C){E0=!1,lb=null,X9.apply(K9,arguments)}function Q9(r,o,a,c,p,_,x,T,C){if(Y9.apply(this,arguments),E0){if(E0){var P=lb;E0=!1,lb=null}else throw Error(Nt(198));ub||(ub=!0,eC=P)}}function Vf(r){var o=r,a=r;if(r.alternate)for(;o.return;)o=o.return;else{r=o;do o=r,o.flags&4098&&(a=o.return),r=o.return;while(r)}return o.tag===3?a:null}function Fz(r){if(r.tag===13){var o=r.memoizedState;if(o===null&&(r=r.alternate,r!==null&&(o=r.memoizedState)),o!==null)return o.dehydrated}return null}function sD(r){if(Vf(r)!==r)throw Error(Nt(188))}function J9(r){var o=r.alternate;if(!o){if(o=Vf(r),o===null)throw Error(Nt(188));return o!==r?null:r}for(var a=r,c=o;;){var p=a.return;if(p===null)break;var _=p.alternate;if(_===null){if(c=p.return,c!==null){a=c;continue}break}if(p.child===_.child){for(_=p.child;_;){if(_===a)return sD(p),r;if(_===c)return sD(p),o;_=_.sibling}throw Error(Nt(188))}if(a.return!==c.return)a=p,c=_;else{for(var x=!1,T=p.child;T;){if(T===a){x=!0,a=p,c=_;break}if(T===c){x=!0,c=p,a=_;break}T=T.sibling}if(!x){for(T=_.child;T;){if(T===a){x=!0,a=_,c=p;break}if(T===c){x=!0,c=_,a=p;break}T=T.sibling}if(!x)throw Error(Nt(189))}}if(a.alternate!==c)throw Error(Nt(190))}if(a.tag!==3)throw Error(Nt(188));return a.stateNode.current===a?r:o}function Bz(r){return r=J9(r),r!==null?Nz(r):null}function Nz(r){if(r.tag===5||r.tag===6)return r;for(r=r.child;r!==null;){var o=Nz(r);if(o!==null)return o;r=r.sibling}return null}var jz=ta.unstable_scheduleCallback,aD=ta.unstable_cancelCallback,e$=ta.unstable_shouldYield,t$=ta.unstable_requestPaint,Ki=ta.unstable_now,n$=ta.unstable_getCurrentPriorityLevel,IA=ta.unstable_ImmediatePriority,Uz=ta.unstable_UserBlockingPriority,cb=ta.unstable_NormalPriority,r$=ta.unstable_LowPriority,Vz=ta.unstable_IdlePriority,t2=null,gu=null;function i$(r){if(gu&&typeof gu.onCommitFiberRoot=="function")try{gu.onCommitFiberRoot(t2,r,void 0,(r.current.flags&128)===128)}catch{}}var Pl=Math.clz32?Math.clz32:a$,o$=Math.log,s$=Math.LN2;function a$(r){return r>>>=0,r===0?32:31-(o$(r)/s$|0)|0}var jx=64,Ux=4194304;function p0(r){switch(r&-r){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return r&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return r}}function hb(r,o){var a=r.pendingLanes;if(a===0)return 0;var c=0,p=r.suspendedLanes,_=r.pingedLanes,x=a&268435455;if(x!==0){var T=x&~p;T!==0?c=p0(T):(_&=x,_!==0&&(c=p0(_)))}else x=a&~p,x!==0?c=p0(x):_!==0&&(c=p0(_));if(c===0)return 0;if(o!==0&&o!==c&&!(o&p)&&(p=c&-c,_=o&-o,p>=_||p===16&&(_&4194240)!==0))return o;if(c&4&&(c|=a&16),o=r.entangledLanes,o!==0)for(r=r.entanglements,o&=c;0<o;)a=31-Pl(o),p=1<<a,c|=r[a],o&=~p;return c}function l$(r,o){switch(r){case 1:case 2:case 4:return o+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function u$(r,o){for(var a=r.suspendedLanes,c=r.pingedLanes,p=r.expirationTimes,_=r.pendingLanes;0<_;){var x=31-Pl(_),T=1<<x,C=p[x];C===-1?(!(T&a)||T&c)&&(p[x]=l$(T,o)):C<=o&&(r.expiredLanes|=T),_&=~T}}function tC(r){return r=r.pendingLanes&-1073741825,r!==0?r:r&1073741824?1073741824:0}function $z(){var r=jx;return jx<<=1,!(jx&4194240)&&(jx=64),r}function GE(r){for(var o=[],a=0;31>a;a++)o.push(r);return o}function vv(r,o,a){r.pendingLanes|=o,o!==536870912&&(r.suspendedLanes=0,r.pingedLanes=0),r=r.eventTimes,o=31-Pl(o),r[o]=a}function c$(r,o){var a=r.pendingLanes&~o;r.pendingLanes=o,r.suspendedLanes=0,r.pingedLanes=0,r.expiredLanes&=o,r.mutableReadLanes&=o,r.entangledLanes&=o,o=r.entanglements;var c=r.eventTimes;for(r=r.expirationTimes;0<a;){var p=31-Pl(a),_=1<<p;o[p]=0,c[p]=-1,r[p]=-1,a&=~_}}function kA(r,o){var a=r.entangledLanes|=o;for(r=r.entanglements;a;){var c=31-Pl(a),p=1<<c;p&o|r[c]&o&&(r[c]|=o),a&=~p}}var Xr=0;function Gz(r){return r&=-r,1<r?4<r?r&268435455?16:536870912:4:1}var Hz,PA,qz,Wz,Zz,nC=!1,Vx=[],Gh=null,Hh=null,qh=null,Q0=new Map,J0=new Map,Oh=[],h$="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function lD(r,o){switch(r){case"focusin":case"focusout":Gh=null;break;case"dragenter":case"dragleave":Hh=null;break;case"mouseover":case"mouseout":qh=null;break;case"pointerover":case"pointerout":Q0.delete(o.pointerId);break;case"gotpointercapture":case"lostpointercapture":J0.delete(o.pointerId)}}function W_(r,o,a,c,p,_){return r===null||r.nativeEvent!==_?(r={blockedOn:o,domEventName:a,eventSystemFlags:c,nativeEvent:_,targetContainers:[p]},o!==null&&(o=wv(o),o!==null&&PA(o)),r):(r.eventSystemFlags|=c,o=r.targetContainers,p!==null&&o.indexOf(p)===-1&&o.push(p),r)}function d$(r,o,a,c,p){switch(o){case"focusin":return Gh=W_(Gh,r,o,a,c,p),!0;case"dragenter":return Hh=W_(Hh,r,o,a,c,p),!0;case"mouseover":return qh=W_(qh,r,o,a,c,p),!0;case"pointerover":var _=p.pointerId;return Q0.set(_,W_(Q0.get(_)||null,r,o,a,c,p)),!0;case"gotpointercapture":return _=p.pointerId,J0.set(_,W_(J0.get(_)||null,r,o,a,c,p)),!0}return!1}function Xz(r){var o=Sf(r.target);if(o!==null){var a=Vf(o);if(a!==null){if(o=a.tag,o===13){if(o=Fz(a),o!==null){r.blockedOn=o,Zz(r.priority,function(){qz(a)});return}}else if(o===3&&a.stateNode.current.memoizedState.isDehydrated){r.blockedOn=a.tag===3?a.stateNode.containerInfo:null;return}}}r.blockedOn=null}function Aw(r){if(r.blockedOn!==null)return!1;for(var o=r.targetContainers;0<o.length;){var a=rC(r.domEventName,r.eventSystemFlags,o[0],r.nativeEvent);if(a===null){a=r.nativeEvent;var c=new a.constructor(a.type,a);YT=c,a.target.dispatchEvent(c),YT=null}else return o=wv(a),o!==null&&PA(o),r.blockedOn=a,!1;o.shift()}return!0}function uD(r,o,a){Aw(r)&&a.delete(o)}function f$(){nC=!1,Gh!==null&&Aw(Gh)&&(Gh=null),Hh!==null&&Aw(Hh)&&(Hh=null),qh!==null&&Aw(qh)&&(qh=null),Q0.forEach(uD),J0.forEach(uD)}function Z_(r,o){r.blockedOn===o&&(r.blockedOn=null,nC||(nC=!0,ta.unstable_scheduleCallback(ta.unstable_NormalPriority,f$)))}function ev(r){function o(p){return Z_(p,r)}if(0<Vx.length){Z_(Vx[0],r);for(var a=1;a<Vx.length;a++){var c=Vx[a];c.blockedOn===r&&(c.blockedOn=null)}}for(Gh!==null&&Z_(Gh,r),Hh!==null&&Z_(Hh,r),qh!==null&&Z_(qh,r),Q0.forEach(o),J0.forEach(o),a=0;a<Oh.length;a++)c=Oh[a],c.blockedOn===r&&(c.blockedOn=null);for(;0<Oh.length&&(a=Oh[0],a.blockedOn===null);)Xz(a),a.blockedOn===null&&Oh.shift()}var _g=wc.ReactCurrentBatchConfig,db=!0;function p$(r,o,a,c){var p=Xr,_=_g.transition;_g.transition=null;try{Xr=1,RA(r,o,a,c)}finally{Xr=p,_g.transition=_}}function m$(r,o,a,c){var p=Xr,_=_g.transition;_g.transition=null;try{Xr=4,RA(r,o,a,c)}finally{Xr=p,_g.transition=_}}function RA(r,o,a,c){if(db){var p=rC(r,o,a,c);if(p===null)eT(r,o,c,fb,a),lD(r,c);else if(d$(p,r,o,a,c))c.stopPropagation();else if(lD(r,c),o&4&&-1<h$.indexOf(r)){for(;p!==null;){var _=wv(p);if(_!==null&&Hz(_),_=rC(r,o,a,c),_===null&&eT(r,o,c,fb,a),_===p)break;p=_}p!==null&&c.stopPropagation()}else eT(r,o,c,null,a)}}var fb=null;function rC(r,o,a,c){if(fb=null,r=MA(c),r=Sf(r),r!==null)if(o=Vf(r),o===null)r=null;else if(a=o.tag,a===13){if(r=Fz(o),r!==null)return r;r=null}else if(a===3){if(o.stateNode.current.memoizedState.isDehydrated)return o.tag===3?o.stateNode.containerInfo:null;r=null}else o!==r&&(r=null);return fb=r,null}function Kz(r){switch(r){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(n$()){case IA:return 1;case Uz:return 4;case cb:case r$:return 16;case Vz:return 536870912;default:return 16}default:return 16}}var jh=null,DA=null,Mw=null;function Yz(){if(Mw)return Mw;var r,o=DA,a=o.length,c,p="value"in jh?jh.value:jh.textContent,_=p.length;for(r=0;r<a&&o[r]===p[r];r++);var x=a-r;for(c=1;c<=x&&o[a-c]===p[_-c];c++);return Mw=p.slice(r,1<c?1-c:void 0)}function Iw(r){var o=r.keyCode;return"charCode"in r?(r=r.charCode,r===0&&o===13&&(r=13)):r=o,r===10&&(r=13),32<=r||r===13?r:0}function $x(){return!0}function cD(){return!1}function ra(r){function o(a,c,p,_,x){this._reactName=a,this._targetInst=p,this.type=c,this.nativeEvent=_,this.target=x,this.currentTarget=null;for(var T in r)r.hasOwnProperty(T)&&(a=r[T],this[T]=a?a(_):_[T]);return this.isDefaultPrevented=(_.defaultPrevented!=null?_.defaultPrevented:_.returnValue===!1)?$x:cD,this.isPropagationStopped=cD,this}return Fi(o.prototype,{preventDefault:function(){this.defaultPrevented=!0;var a=this.nativeEvent;a&&(a.preventDefault?a.preventDefault():typeof a.returnValue!="unknown"&&(a.returnValue=!1),this.isDefaultPrevented=$x)},stopPropagation:function(){var a=this.nativeEvent;a&&(a.stopPropagation?a.stopPropagation():typeof a.cancelBubble!="unknown"&&(a.cancelBubble=!0),this.isPropagationStopped=$x)},persist:function(){},isPersistent:$x}),o}var Gg={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(r){return r.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},LA=ra(Gg),xv=Fi({},Gg,{view:0,detail:0}),g$=ra(xv),HE,qE,X_,n2=Fi({},xv,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:OA,button:0,buttons:0,relatedTarget:function(r){return r.relatedTarget===void 0?r.fromElement===r.srcElement?r.toElement:r.fromElement:r.relatedTarget},movementX:function(r){return"movementX"in r?r.movementX:(r!==X_&&(X_&&r.type==="mousemove"?(HE=r.screenX-X_.screenX,qE=r.screenY-X_.screenY):qE=HE=0,X_=r),HE)},movementY:function(r){return"movementY"in r?r.movementY:qE}}),hD=ra(n2),y$=Fi({},n2,{dataTransfer:0}),_$=ra(y$),v$=Fi({},xv,{relatedTarget:0}),WE=ra(v$),x$=Fi({},Gg,{animationName:0,elapsedTime:0,pseudoElement:0}),w$=ra(x$),b$=Fi({},Gg,{clipboardData:function(r){return"clipboardData"in r?r.clipboardData:window.clipboardData}}),S$=ra(b$),E$=Fi({},Gg,{data:0}),dD=ra(E$),T$={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},C$={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},A$={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function M$(r){var o=this.nativeEvent;return o.getModifierState?o.getModifierState(r):(r=A$[r])?!!o[r]:!1}function OA(){return M$}var I$=Fi({},xv,{key:function(r){if(r.key){var o=T$[r.key]||r.key;if(o!=="Unidentified")return o}return r.type==="keypress"?(r=Iw(r),r===13?"Enter":String.fromCharCode(r)):r.type==="keydown"||r.type==="keyup"?C$[r.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:OA,charCode:function(r){return r.type==="keypress"?Iw(r):0},keyCode:function(r){return r.type==="keydown"||r.type==="keyup"?r.keyCode:0},which:function(r){return r.type==="keypress"?Iw(r):r.type==="keydown"||r.type==="keyup"?r.keyCode:0}}),k$=ra(I$),P$=Fi({},n2,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),fD=ra(P$),R$=Fi({},xv,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:OA}),D$=ra(R$),L$=Fi({},Gg,{propertyName:0,elapsedTime:0,pseudoElement:0}),O$=ra(L$),z$=Fi({},n2,{deltaX:function(r){return"deltaX"in r?r.deltaX:"wheelDeltaX"in r?-r.wheelDeltaX:0},deltaY:function(r){return"deltaY"in r?r.deltaY:"wheelDeltaY"in r?-r.wheelDeltaY:"wheelDelta"in r?-r.wheelDelta:0},deltaZ:0,deltaMode:0}),F$=ra(z$),B$=[9,13,27,32],zA=yc&&"CompositionEvent"in window,T0=null;yc&&"documentMode"in document&&(T0=document.documentMode);var N$=yc&&"TextEvent"in window&&!T0,Qz=yc&&(!zA||T0&&8<T0&&11>=T0),pD=String.fromCharCode(32),mD=!1;function Jz(r,o){switch(r){case"keyup":return B$.indexOf(o.keyCode)!==-1;case"keydown":return o.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function e4(r){return r=r.detail,typeof r=="object"&&"data"in r?r.data:null}var tg=!1;function j$(r,o){switch(r){case"compositionend":return e4(o);case"keypress":return o.which!==32?null:(mD=!0,pD);case"textInput":return r=o.data,r===pD&&mD?null:r;default:return null}}function U$(r,o){if(tg)return r==="compositionend"||!zA&&Jz(r,o)?(r=Yz(),Mw=DA=jh=null,tg=!1,r):null;switch(r){case"paste":return null;case"keypress":if(!(o.ctrlKey||o.altKey||o.metaKey)||o.ctrlKey&&o.altKey){if(o.char&&1<o.char.length)return o.char;if(o.which)return String.fromCharCode(o.which)}return null;case"compositionend":return Qz&&o.locale!=="ko"?null:o.data;default:return null}}var V$={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function gD(r){var o=r&&r.nodeName&&r.nodeName.toLowerCase();return o==="input"?!!V$[r.type]:o==="textarea"}function t4(r,o,a,c){Rz(c),o=pb(o,"onChange"),0<o.length&&(a=new LA("onChange","change",null,a,c),r.push({event:a,listeners:o}))}var C0=null,tv=null;function $$(r){d4(r,0)}function r2(r){var o=ig(r);if(Tz(o))return r}function G$(r,o){if(r==="change")return o}var n4=!1;if(yc){var ZE;if(yc){var XE="oninput"in document;if(!XE){var yD=document.createElement("div");yD.setAttribute("oninput","return;"),XE=typeof yD.oninput=="function"}ZE=XE}else ZE=!1;n4=ZE&&(!document.documentMode||9<document.documentMode)}function _D(){C0&&(C0.detachEvent("onpropertychange",r4),tv=C0=null)}function r4(r){if(r.propertyName==="value"&&r2(tv)){var o=[];t4(o,tv,r,MA(r)),zz($$,o)}}function H$(r,o,a){r==="focusin"?(_D(),C0=o,tv=a,C0.attachEvent("onpropertychange",r4)):r==="focusout"&&_D()}function q$(r){if(r==="selectionchange"||r==="keyup"||r==="keydown")return r2(tv)}function W$(r,o){if(r==="click")return r2(o)}function Z$(r,o){if(r==="input"||r==="change")return r2(o)}function X$(r,o){return r===o&&(r!==0||1/r===1/o)||r!==r&&o!==o}var Dl=typeof Object.is=="function"?Object.is:X$;function nv(r,o){if(Dl(r,o))return!0;if(typeof r!="object"||r===null||typeof o!="object"||o===null)return!1;var a=Object.keys(r),c=Object.keys(o);if(a.length!==c.length)return!1;for(c=0;c<a.length;c++){var p=a[c];if(!NT.call(o,p)||!Dl(r[p],o[p]))return!1}return!0}function vD(r){for(;r&&r.firstChild;)r=r.firstChild;return r}function xD(r,o){var a=vD(r);r=0;for(var c;a;){if(a.nodeType===3){if(c=r+a.textContent.length,r<=o&&c>=o)return{node:a,offset:o-r};r=c}e:{for(;a;){if(a.nextSibling){a=a.nextSibling;break e}a=a.parentNode}a=void 0}a=vD(a)}}function i4(r,o){return r&&o?r===o?!0:r&&r.nodeType===3?!1:o&&o.nodeType===3?i4(r,o.parentNode):"contains"in r?r.contains(o):r.compareDocumentPosition?!!(r.compareDocumentPosition(o)&16):!1:!1}function o4(){for(var r=window,o=ab();o instanceof r.HTMLIFrameElement;){try{var a=typeof o.contentWindow.location.href=="string"}catch{a=!1}if(a)r=o.contentWindow;else break;o=ab(r.document)}return o}function FA(r){var o=r&&r.nodeName&&r.nodeName.toLowerCase();return o&&(o==="input"&&(r.type==="text"||r.type==="search"||r.type==="tel"||r.type==="url"||r.type==="password")||o==="textarea"||r.contentEditable==="true")}function K$(r){var o=o4(),a=r.focusedElem,c=r.selectionRange;if(o!==a&&a&&a.ownerDocument&&i4(a.ownerDocument.documentElement,a)){if(c!==null&&FA(a)){if(o=c.start,r=c.end,r===void 0&&(r=o),"selectionStart"in a)a.selectionStart=o,a.selectionEnd=Math.min(r,a.value.length);else if(r=(o=a.ownerDocument||document)&&o.defaultView||window,r.getSelection){r=r.getSelection();var p=a.textContent.length,_=Math.min(c.start,p);c=c.end===void 0?_:Math.min(c.end,p),!r.extend&&_>c&&(p=c,c=_,_=p),p=xD(a,_);var x=xD(a,c);p&&x&&(r.rangeCount!==1||r.anchorNode!==p.node||r.anchorOffset!==p.offset||r.focusNode!==x.node||r.focusOffset!==x.offset)&&(o=o.createRange(),o.setStart(p.node,p.offset),r.removeAllRanges(),_>c?(r.addRange(o),r.extend(x.node,x.offset)):(o.setEnd(x.node,x.offset),r.addRange(o)))}}for(o=[],r=a;r=r.parentNode;)r.nodeType===1&&o.push({element:r,left:r.scrollLeft,top:r.scrollTop});for(typeof a.focus=="function"&&a.focus(),a=0;a<o.length;a++)r=o[a],r.element.scrollLeft=r.left,r.element.scrollTop=r.top}}var Y$=yc&&"documentMode"in document&&11>=document.documentMode,ng=null,iC=null,A0=null,oC=!1;function wD(r,o,a){var c=a.window===a?a.document:a.nodeType===9?a:a.ownerDocument;oC||ng==null||ng!==ab(c)||(c=ng,"selectionStart"in c&&FA(c)?c={start:c.selectionStart,end:c.selectionEnd}:(c=(c.ownerDocument&&c.ownerDocument.defaultView||window).getSelection(),c={anchorNode:c.anchorNode,anchorOffset:c.anchorOffset,focusNode:c.focusNode,focusOffset:c.focusOffset}),A0&&nv(A0,c)||(A0=c,c=pb(iC,"onSelect"),0<c.length&&(o=new LA("onSelect","select",null,o,a),r.push({event:o,listeners:c}),o.target=ng)))}function Gx(r,o){var a={};return a[r.toLowerCase()]=o.toLowerCase(),a["Webkit"+r]="webkit"+o,a["Moz"+r]="moz"+o,a}var rg={animationend:Gx("Animation","AnimationEnd"),animationiteration:Gx("Animation","AnimationIteration"),animationstart:Gx("Animation","AnimationStart"),transitionend:Gx("Transition","TransitionEnd")},KE={},s4={};yc&&(s4=document.createElement("div").style,"AnimationEvent"in window||(delete rg.animationend.animation,delete rg.animationiteration.animation,delete rg.animationstart.animation),"TransitionEvent"in window||delete rg.transitionend.transition);function i2(r){if(KE[r])return KE[r];if(!rg[r])return r;var o=rg[r],a;for(a in o)if(o.hasOwnProperty(a)&&a in s4)return KE[r]=o[a];return r}var a4=i2("animationend"),l4=i2("animationiteration"),u4=i2("animationstart"),c4=i2("transitionend"),h4=new Map,bD="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function nd(r,o){h4.set(r,o),Uf(o,[r])}for(var YE=0;YE<bD.length;YE++){var QE=bD[YE],Q$=QE.toLowerCase(),J$=QE[0].toUpperCase()+QE.slice(1);nd(Q$,"on"+J$)}nd(a4,"onAnimationEnd");nd(l4,"onAnimationIteration");nd(u4,"onAnimationStart");nd("dblclick","onDoubleClick");nd("focusin","onFocus");nd("focusout","onBlur");nd(c4,"onTransitionEnd");Tg("onMouseEnter",["mouseout","mouseover"]);Tg("onMouseLeave",["mouseout","mouseover"]);Tg("onPointerEnter",["pointerout","pointerover"]);Tg("onPointerLeave",["pointerout","pointerover"]);Uf("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Uf("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Uf("onBeforeInput",["compositionend","keypress","textInput","paste"]);Uf("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Uf("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Uf("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var m0="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),eG=new Set("cancel close invalid load scroll toggle".split(" ").concat(m0));function SD(r,o,a){var c=r.type||"unknown-event";r.currentTarget=a,Q9(c,o,void 0,r),r.currentTarget=null}function d4(r,o){o=(o&4)!==0;for(var a=0;a<r.length;a++){var c=r[a],p=c.event;c=c.listeners;e:{var _=void 0;if(o)for(var x=c.length-1;0<=x;x--){var T=c[x],C=T.instance,P=T.currentTarget;if(T=T.listener,C!==_&&p.isPropagationStopped())break e;SD(p,T,P),_=C}else for(x=0;x<c.length;x++){if(T=c[x],C=T.instance,P=T.currentTarget,T=T.listener,C!==_&&p.isPropagationStopped())break e;SD(p,T,P),_=C}}}if(ub)throw r=eC,ub=!1,eC=null,r}function wi(r,o){var a=o[cC];a===void 0&&(a=o[cC]=new Set);var c=r+"__bubble";a.has(c)||(f4(o,r,2,!1),a.add(c))}function JE(r,o,a){var c=0;o&&(c|=4),f4(a,r,c,o)}var Hx="_reactListening"+Math.random().toString(36).slice(2);function rv(r){if(!r[Hx]){r[Hx]=!0,xz.forEach(function(a){a!=="selectionchange"&&(eG.has(a)||JE(a,!1,r),JE(a,!0,r))});var o=r.nodeType===9?r:r.ownerDocument;o===null||o[Hx]||(o[Hx]=!0,JE("selectionchange",!1,o))}}function f4(r,o,a,c){switch(Kz(o)){case 1:var p=p$;break;case 4:p=m$;break;default:p=RA}a=p.bind(null,o,a,r),p=void 0,!JT||o!=="touchstart"&&o!=="touchmove"&&o!=="wheel"||(p=!0),c?p!==void 0?r.addEventListener(o,a,{capture:!0,passive:p}):r.addEventListener(o,a,!0):p!==void 0?r.addEventListener(o,a,{passive:p}):r.addEventListener(o,a,!1)}function eT(r,o,a,c,p){var _=c;if(!(o&1)&&!(o&2)&&c!==null)e:for(;;){if(c===null)return;var x=c.tag;if(x===3||x===4){var T=c.stateNode.containerInfo;if(T===p||T.nodeType===8&&T.parentNode===p)break;if(x===4)for(x=c.return;x!==null;){var C=x.tag;if((C===3||C===4)&&(C=x.stateNode.containerInfo,C===p||C.nodeType===8&&C.parentNode===p))return;x=x.return}for(;T!==null;){if(x=Sf(T),x===null)return;if(C=x.tag,C===5||C===6){c=_=x;continue e}T=T.parentNode}}c=c.return}zz(function(){var P=_,O=MA(a),F=[];e:{var U=h4.get(r);if(U!==void 0){var Z=LA,$=r;switch(r){case"keypress":if(Iw(a)===0)break e;case"keydown":case"keyup":Z=k$;break;case"focusin":$="focus",Z=WE;break;case"focusout":$="blur",Z=WE;break;case"beforeblur":case"afterblur":Z=WE;break;case"click":if(a.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Z=hD;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Z=_$;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Z=D$;break;case a4:case l4:case u4:Z=w$;break;case c4:Z=O$;break;case"scroll":Z=g$;break;case"wheel":Z=F$;break;case"copy":case"cut":case"paste":Z=S$;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Z=fD}var K=(o&4)!==0,ie=!K&&r==="scroll",H=K?U!==null?U+"Capture":null:U;K=[];for(var G=P,ee;G!==null;){ee=G;var W=ee.stateNode;if(ee.tag===5&&W!==null&&(ee=W,H!==null&&(W=Y0(G,H),W!=null&&K.push(iv(G,W,ee)))),ie)break;G=G.return}0<K.length&&(U=new Z(U,$,null,a,O),F.push({event:U,listeners:K}))}}if(!(o&7)){e:{if(U=r==="mouseover"||r==="pointerover",Z=r==="mouseout"||r==="pointerout",U&&a!==YT&&($=a.relatedTarget||a.fromElement)&&(Sf($)||$[_c]))break e;if((Z||U)&&(U=O.window===O?O:(U=O.ownerDocument)?U.defaultView||U.parentWindow:window,Z?($=a.relatedTarget||a.toElement,Z=P,$=$?Sf($):null,$!==null&&(ie=Vf($),$!==ie||$.tag!==5&&$.tag!==6)&&($=null)):(Z=null,$=P),Z!==$)){if(K=hD,W="onMouseLeave",H="onMouseEnter",G="mouse",(r==="pointerout"||r==="pointerover")&&(K=fD,W="onPointerLeave",H="onPointerEnter",G="pointer"),ie=Z==null?U:ig(Z),ee=$==null?U:ig($),U=new K(W,G+"leave",Z,a,O),U.target=ie,U.relatedTarget=ee,W=null,Sf(O)===P&&(K=new K(H,G+"enter",$,a,O),K.target=ee,K.relatedTarget=ie,W=K),ie=W,Z&&$)t:{for(K=Z,H=$,G=0,ee=K;ee;ee=Hm(ee))G++;for(ee=0,W=H;W;W=Hm(W))ee++;for(;0<G-ee;)K=Hm(K),G--;for(;0<ee-G;)H=Hm(H),ee--;for(;G--;){if(K===H||H!==null&&K===H.alternate)break t;K=Hm(K),H=Hm(H)}K=null}else K=null;Z!==null&&ED(F,U,Z,K,!1),$!==null&&ie!==null&&ED(F,ie,$,K,!0)}}e:{if(U=P?ig(P):window,Z=U.nodeName&&U.nodeName.toLowerCase(),Z==="select"||Z==="input"&&U.type==="file")var me=G$;else if(gD(U))if(n4)me=Z$;else{me=q$;var de=H$}else(Z=U.nodeName)&&Z.toLowerCase()==="input"&&(U.type==="checkbox"||U.type==="radio")&&(me=W$);if(me&&(me=me(r,P))){t4(F,me,a,O);break e}de&&de(r,U,P),r==="focusout"&&(de=U._wrapperState)&&de.controlled&&U.type==="number"&&qT(U,"number",U.value)}switch(de=P?ig(P):window,r){case"focusin":(gD(de)||de.contentEditable==="true")&&(ng=de,iC=P,A0=null);break;case"focusout":A0=iC=ng=null;break;case"mousedown":oC=!0;break;case"contextmenu":case"mouseup":case"dragend":oC=!1,wD(F,a,O);break;case"selectionchange":if(Y$)break;case"keydown":case"keyup":wD(F,a,O)}var he;if(zA)e:{switch(r){case"compositionstart":var se="onCompositionStart";break e;case"compositionend":se="onCompositionEnd";break e;case"compositionupdate":se="onCompositionUpdate";break e}se=void 0}else tg?Jz(r,a)&&(se="onCompositionEnd"):r==="keydown"&&a.keyCode===229&&(se="onCompositionStart");se&&(Qz&&a.locale!=="ko"&&(tg||se!=="onCompositionStart"?se==="onCompositionEnd"&&tg&&(he=Yz()):(jh=O,DA="value"in jh?jh.value:jh.textContent,tg=!0)),de=pb(P,se),0<de.length&&(se=new dD(se,r,null,a,O),F.push({event:se,listeners:de}),he?se.data=he:(he=e4(a),he!==null&&(se.data=he)))),(he=N$?j$(r,a):U$(r,a))&&(P=pb(P,"onBeforeInput"),0<P.length&&(O=new dD("onBeforeInput","beforeinput",null,a,O),F.push({event:O,listeners:P}),O.data=he))}d4(F,o)})}function iv(r,o,a){return{instance:r,listener:o,currentTarget:a}}function pb(r,o){for(var a=o+"Capture",c=[];r!==null;){var p=r,_=p.stateNode;p.tag===5&&_!==null&&(p=_,_=Y0(r,a),_!=null&&c.unshift(iv(r,_,p)),_=Y0(r,o),_!=null&&c.push(iv(r,_,p))),r=r.return}return c}function Hm(r){if(r===null)return null;do r=r.return;while(r&&r.tag!==5);return r||null}function ED(r,o,a,c,p){for(var _=o._reactName,x=[];a!==null&&a!==c;){var T=a,C=T.alternate,P=T.stateNode;if(C!==null&&C===c)break;T.tag===5&&P!==null&&(T=P,p?(C=Y0(a,_),C!=null&&x.unshift(iv(a,C,T))):p||(C=Y0(a,_),C!=null&&x.push(iv(a,C,T)))),a=a.return}x.length!==0&&r.push({event:o,listeners:x})}var tG=/\r\n?/g,nG=/\u0000|\uFFFD/g;function TD(r){return(typeof r=="string"?r:""+r).replace(tG,`
`).replace(nG,"")}function qx(r,o,a){if(o=TD(o),TD(r)!==o&&a)throw Error(Nt(425))}function mb(){}var sC=null,aC=null;function lC(r,o){return r==="textarea"||r==="noscript"||typeof o.children=="string"||typeof o.children=="number"||typeof o.dangerouslySetInnerHTML=="object"&&o.dangerouslySetInnerHTML!==null&&o.dangerouslySetInnerHTML.__html!=null}var uC=typeof setTimeout=="function"?setTimeout:void 0,rG=typeof clearTimeout=="function"?clearTimeout:void 0,CD=typeof Promise=="function"?Promise:void 0,iG=typeof queueMicrotask=="function"?queueMicrotask:typeof CD<"u"?function(r){return CD.resolve(null).then(r).catch(oG)}:uC;function oG(r){setTimeout(function(){throw r})}function tT(r,o){var a=o,c=0;do{var p=a.nextSibling;if(r.removeChild(a),p&&p.nodeType===8)if(a=p.data,a==="/$"){if(c===0){r.removeChild(p),ev(o);return}c--}else a!=="$"&&a!=="$?"&&a!=="$!"||c++;a=p}while(a);ev(o)}function Wh(r){for(;r!=null;r=r.nextSibling){var o=r.nodeType;if(o===1||o===3)break;if(o===8){if(o=r.data,o==="$"||o==="$!"||o==="$?")break;if(o==="/$")return null}}return r}function AD(r){r=r.previousSibling;for(var o=0;r;){if(r.nodeType===8){var a=r.data;if(a==="$"||a==="$!"||a==="$?"){if(o===0)return r;o--}else a==="/$"&&o++}r=r.previousSibling}return null}var Hg=Math.random().toString(36).slice(2),hu="__reactFiber$"+Hg,ov="__reactProps$"+Hg,_c="__reactContainer$"+Hg,cC="__reactEvents$"+Hg,sG="__reactListeners$"+Hg,aG="__reactHandles$"+Hg;function Sf(r){var o=r[hu];if(o)return o;for(var a=r.parentNode;a;){if(o=a[_c]||a[hu]){if(a=o.alternate,o.child!==null||a!==null&&a.child!==null)for(r=AD(r);r!==null;){if(a=r[hu])return a;r=AD(r)}return o}r=a,a=r.parentNode}return null}function wv(r){return r=r[hu]||r[_c],!r||r.tag!==5&&r.tag!==6&&r.tag!==13&&r.tag!==3?null:r}function ig(r){if(r.tag===5||r.tag===6)return r.stateNode;throw Error(Nt(33))}function o2(r){return r[ov]||null}var hC=[],og=-1;function rd(r){return{current:r}}function Si(r){0>og||(r.current=hC[og],hC[og]=null,og--)}function gi(r,o){og++,hC[og]=r.current,r.current=o}var td={},rs=rd(td),Vs=rd(!1),Df=td;function Cg(r,o){var a=r.type.contextTypes;if(!a)return td;var c=r.stateNode;if(c&&c.__reactInternalMemoizedUnmaskedChildContext===o)return c.__reactInternalMemoizedMaskedChildContext;var p={},_;for(_ in a)p[_]=o[_];return c&&(r=r.stateNode,r.__reactInternalMemoizedUnmaskedChildContext=o,r.__reactInternalMemoizedMaskedChildContext=p),p}function $s(r){return r=r.childContextTypes,r!=null}function gb(){Si(Vs),Si(rs)}function MD(r,o,a){if(rs.current!==td)throw Error(Nt(168));gi(rs,o),gi(Vs,a)}function p4(r,o,a){var c=r.stateNode;if(o=o.childContextTypes,typeof c.getChildContext!="function")return a;c=c.getChildContext();for(var p in c)if(!(p in o))throw Error(Nt(108,H9(r)||"Unknown",p));return Fi({},a,c)}function yb(r){return r=(r=r.stateNode)&&r.__reactInternalMemoizedMergedChildContext||td,Df=rs.current,gi(rs,r),gi(Vs,Vs.current),!0}function ID(r,o,a){var c=r.stateNode;if(!c)throw Error(Nt(169));a?(r=p4(r,o,Df),c.__reactInternalMemoizedMergedChildContext=r,Si(Vs),Si(rs),gi(rs,r)):Si(Vs),gi(Vs,a)}var dc=null,s2=!1,nT=!1;function m4(r){dc===null?dc=[r]:dc.push(r)}function lG(r){s2=!0,m4(r)}function id(){if(!nT&&dc!==null){nT=!0;var r=0,o=Xr;try{var a=dc;for(Xr=1;r<a.length;r++){var c=a[r];do c=c(!0);while(c!==null)}dc=null,s2=!1}catch(p){throw dc!==null&&(dc=dc.slice(r+1)),jz(IA,id),p}finally{Xr=o,nT=!1}}return null}var sg=[],ag=0,_b=null,vb=0,Ra=[],Da=0,Lf=null,fc=1,pc="";function _f(r,o){sg[ag++]=vb,sg[ag++]=_b,_b=r,vb=o}function g4(r,o,a){Ra[Da++]=fc,Ra[Da++]=pc,Ra[Da++]=Lf,Lf=r;var c=fc;r=pc;var p=32-Pl(c)-1;c&=~(1<<p),a+=1;var _=32-Pl(o)+p;if(30<_){var x=p-p%5;_=(c&(1<<x)-1).toString(32),c>>=x,p-=x,fc=1<<32-Pl(o)+p|a<<p|c,pc=_+r}else fc=1<<_|a<<p|c,pc=r}function BA(r){r.return!==null&&(_f(r,1),g4(r,1,0))}function NA(r){for(;r===_b;)_b=sg[--ag],sg[ag]=null,vb=sg[--ag],sg[ag]=null;for(;r===Lf;)Lf=Ra[--Da],Ra[Da]=null,pc=Ra[--Da],Ra[Da]=null,fc=Ra[--Da],Ra[Da]=null}var ea=null,Js=null,ki=!1,Cl=null;function y4(r,o){var a=La(5,null,null,0);a.elementType="DELETED",a.stateNode=o,a.return=r,o=r.deletions,o===null?(r.deletions=[a],r.flags|=16):o.push(a)}function kD(r,o){switch(r.tag){case 5:var a=r.type;return o=o.nodeType!==1||a.toLowerCase()!==o.nodeName.toLowerCase()?null:o,o!==null?(r.stateNode=o,ea=r,Js=Wh(o.firstChild),!0):!1;case 6:return o=r.pendingProps===""||o.nodeType!==3?null:o,o!==null?(r.stateNode=o,ea=r,Js=null,!0):!1;case 13:return o=o.nodeType!==8?null:o,o!==null?(a=Lf!==null?{id:fc,overflow:pc}:null,r.memoizedState={dehydrated:o,treeContext:a,retryLane:1073741824},a=La(18,null,null,0),a.stateNode=o,a.return=r,r.child=a,ea=r,Js=null,!0):!1;default:return!1}}function dC(r){return(r.mode&1)!==0&&(r.flags&128)===0}function fC(r){if(ki){var o=Js;if(o){var a=o;if(!kD(r,o)){if(dC(r))throw Error(Nt(418));o=Wh(a.nextSibling);var c=ea;o&&kD(r,o)?y4(c,a):(r.flags=r.flags&-4097|2,ki=!1,ea=r)}}else{if(dC(r))throw Error(Nt(418));r.flags=r.flags&-4097|2,ki=!1,ea=r}}}function PD(r){for(r=r.return;r!==null&&r.tag!==5&&r.tag!==3&&r.tag!==13;)r=r.return;ea=r}function Wx(r){if(r!==ea)return!1;if(!ki)return PD(r),ki=!0,!1;var o;if((o=r.tag!==3)&&!(o=r.tag!==5)&&(o=r.type,o=o!=="head"&&o!=="body"&&!lC(r.type,r.memoizedProps)),o&&(o=Js)){if(dC(r))throw _4(),Error(Nt(418));for(;o;)y4(r,o),o=Wh(o.nextSibling)}if(PD(r),r.tag===13){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(Nt(317));e:{for(r=r.nextSibling,o=0;r;){if(r.nodeType===8){var a=r.data;if(a==="/$"){if(o===0){Js=Wh(r.nextSibling);break e}o--}else a!=="$"&&a!=="$!"&&a!=="$?"||o++}r=r.nextSibling}Js=null}}else Js=ea?Wh(r.stateNode.nextSibling):null;return!0}function _4(){for(var r=Js;r;)r=Wh(r.nextSibling)}function Ag(){Js=ea=null,ki=!1}function jA(r){Cl===null?Cl=[r]:Cl.push(r)}var uG=wc.ReactCurrentBatchConfig;function bl(r,o){if(r&&r.defaultProps){o=Fi({},o),r=r.defaultProps;for(var a in r)o[a]===void 0&&(o[a]=r[a]);return o}return o}var xb=rd(null),wb=null,lg=null,UA=null;function VA(){UA=lg=wb=null}function $A(r){var o=xb.current;Si(xb),r._currentValue=o}function pC(r,o,a){for(;r!==null;){var c=r.alternate;if((r.childLanes&o)!==o?(r.childLanes|=o,c!==null&&(c.childLanes|=o)):c!==null&&(c.childLanes&o)!==o&&(c.childLanes|=o),r===a)break;r=r.return}}function vg(r,o){wb=r,UA=lg=null,r=r.dependencies,r!==null&&r.firstContext!==null&&(r.lanes&o&&(js=!0),r.firstContext=null)}function Fa(r){var o=r._currentValue;if(UA!==r)if(r={context:r,memoizedValue:o,next:null},lg===null){if(wb===null)throw Error(Nt(308));lg=r,wb.dependencies={lanes:0,firstContext:r}}else lg=lg.next=r;return o}var Ef=null;function GA(r){Ef===null?Ef=[r]:Ef.push(r)}function v4(r,o,a,c){var p=o.interleaved;return p===null?(a.next=a,GA(o)):(a.next=p.next,p.next=a),o.interleaved=a,vc(r,c)}function vc(r,o){r.lanes|=o;var a=r.alternate;for(a!==null&&(a.lanes|=o),a=r,r=r.return;r!==null;)r.childLanes|=o,a=r.alternate,a!==null&&(a.childLanes|=o),a=r,r=r.return;return a.tag===3?a.stateNode:null}var Lh=!1;function HA(r){r.updateQueue={baseState:r.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function x4(r,o){r=r.updateQueue,o.updateQueue===r&&(o.updateQueue={baseState:r.baseState,firstBaseUpdate:r.firstBaseUpdate,lastBaseUpdate:r.lastBaseUpdate,shared:r.shared,effects:r.effects})}function mc(r,o){return{eventTime:r,lane:o,tag:0,payload:null,callback:null,next:null}}function Zh(r,o,a){var c=r.updateQueue;if(c===null)return null;if(c=c.shared,Pr&2){var p=c.pending;return p===null?o.next=o:(o.next=p.next,p.next=o),c.pending=o,vc(r,a)}return p=c.interleaved,p===null?(o.next=o,GA(c)):(o.next=p.next,p.next=o),c.interleaved=o,vc(r,a)}function kw(r,o,a){if(o=o.updateQueue,o!==null&&(o=o.shared,(a&4194240)!==0)){var c=o.lanes;c&=r.pendingLanes,a|=c,o.lanes=a,kA(r,a)}}function RD(r,o){var a=r.updateQueue,c=r.alternate;if(c!==null&&(c=c.updateQueue,a===c)){var p=null,_=null;if(a=a.firstBaseUpdate,a!==null){do{var x={eventTime:a.eventTime,lane:a.lane,tag:a.tag,payload:a.payload,callback:a.callback,next:null};_===null?p=_=x:_=_.next=x,a=a.next}while(a!==null);_===null?p=_=o:_=_.next=o}else p=_=o;a={baseState:c.baseState,firstBaseUpdate:p,lastBaseUpdate:_,shared:c.shared,effects:c.effects},r.updateQueue=a;return}r=a.lastBaseUpdate,r===null?a.firstBaseUpdate=o:r.next=o,a.lastBaseUpdate=o}function bb(r,o,a,c){var p=r.updateQueue;Lh=!1;var _=p.firstBaseUpdate,x=p.lastBaseUpdate,T=p.shared.pending;if(T!==null){p.shared.pending=null;var C=T,P=C.next;C.next=null,x===null?_=P:x.next=P,x=C;var O=r.alternate;O!==null&&(O=O.updateQueue,T=O.lastBaseUpdate,T!==x&&(T===null?O.firstBaseUpdate=P:T.next=P,O.lastBaseUpdate=C))}if(_!==null){var F=p.baseState;x=0,O=P=C=null,T=_;do{var U=T.lane,Z=T.eventTime;if((c&U)===U){O!==null&&(O=O.next={eventTime:Z,lane:0,tag:T.tag,payload:T.payload,callback:T.callback,next:null});e:{var $=r,K=T;switch(U=o,Z=a,K.tag){case 1:if($=K.payload,typeof $=="function"){F=$.call(Z,F,U);break e}F=$;break e;case 3:$.flags=$.flags&-65537|128;case 0:if($=K.payload,U=typeof $=="function"?$.call(Z,F,U):$,U==null)break e;F=Fi({},F,U);break e;case 2:Lh=!0}}T.callback!==null&&T.lane!==0&&(r.flags|=64,U=p.effects,U===null?p.effects=[T]:U.push(T))}else Z={eventTime:Z,lane:U,tag:T.tag,payload:T.payload,callback:T.callback,next:null},O===null?(P=O=Z,C=F):O=O.next=Z,x|=U;if(T=T.next,T===null){if(T=p.shared.pending,T===null)break;U=T,T=U.next,U.next=null,p.lastBaseUpdate=U,p.shared.pending=null}}while(1);if(O===null&&(C=F),p.baseState=C,p.firstBaseUpdate=P,p.lastBaseUpdate=O,o=p.shared.interleaved,o!==null){p=o;do x|=p.lane,p=p.next;while(p!==o)}else _===null&&(p.shared.lanes=0);zf|=x,r.lanes=x,r.memoizedState=F}}function DD(r,o,a){if(r=o.effects,o.effects=null,r!==null)for(o=0;o<r.length;o++){var c=r[o],p=c.callback;if(p!==null){if(c.callback=null,c=a,typeof p!="function")throw Error(Nt(191,p));p.call(c)}}}var w4=new vz.Component().refs;function mC(r,o,a,c){o=r.memoizedState,a=a(c,o),a=a==null?o:Fi({},o,a),r.memoizedState=a,r.lanes===0&&(r.updateQueue.baseState=a)}var a2={isMounted:function(r){return(r=r._reactInternals)?Vf(r)===r:!1},enqueueSetState:function(r,o,a){r=r._reactInternals;var c=bs(),p=Kh(r),_=mc(c,p);_.payload=o,a!=null&&(_.callback=a),o=Zh(r,_,p),o!==null&&(Rl(o,r,p,c),kw(o,r,p))},enqueueReplaceState:function(r,o,a){r=r._reactInternals;var c=bs(),p=Kh(r),_=mc(c,p);_.tag=1,_.payload=o,a!=null&&(_.callback=a),o=Zh(r,_,p),o!==null&&(Rl(o,r,p,c),kw(o,r,p))},enqueueForceUpdate:function(r,o){r=r._reactInternals;var a=bs(),c=Kh(r),p=mc(a,c);p.tag=2,o!=null&&(p.callback=o),o=Zh(r,p,c),o!==null&&(Rl(o,r,c,a),kw(o,r,c))}};function LD(r,o,a,c,p,_,x){return r=r.stateNode,typeof r.shouldComponentUpdate=="function"?r.shouldComponentUpdate(c,_,x):o.prototype&&o.prototype.isPureReactComponent?!nv(a,c)||!nv(p,_):!0}function b4(r,o,a){var c=!1,p=td,_=o.contextType;return typeof _=="object"&&_!==null?_=Fa(_):(p=$s(o)?Df:rs.current,c=o.contextTypes,_=(c=c!=null)?Cg(r,p):td),o=new o(a,_),r.memoizedState=o.state!==null&&o.state!==void 0?o.state:null,o.updater=a2,r.stateNode=o,o._reactInternals=r,c&&(r=r.stateNode,r.__reactInternalMemoizedUnmaskedChildContext=p,r.__reactInternalMemoizedMaskedChildContext=_),o}function OD(r,o,a,c){r=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps(a,c),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps(a,c),o.state!==r&&a2.enqueueReplaceState(o,o.state,null)}function gC(r,o,a,c){var p=r.stateNode;p.props=a,p.state=r.memoizedState,p.refs=w4,HA(r);var _=o.contextType;typeof _=="object"&&_!==null?p.context=Fa(_):(_=$s(o)?Df:rs.current,p.context=Cg(r,_)),p.state=r.memoizedState,_=o.getDerivedStateFromProps,typeof _=="function"&&(mC(r,o,_,a),p.state=r.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof p.getSnapshotBeforeUpdate=="function"||typeof p.UNSAFE_componentWillMount!="function"&&typeof p.componentWillMount!="function"||(o=p.state,typeof p.componentWillMount=="function"&&p.componentWillMount(),typeof p.UNSAFE_componentWillMount=="function"&&p.UNSAFE_componentWillMount(),o!==p.state&&a2.enqueueReplaceState(p,p.state,null),bb(r,a,p,c),p.state=r.memoizedState),typeof p.componentDidMount=="function"&&(r.flags|=4194308)}function K_(r,o,a){if(r=a.ref,r!==null&&typeof r!="function"&&typeof r!="object"){if(a._owner){if(a=a._owner,a){if(a.tag!==1)throw Error(Nt(309));var c=a.stateNode}if(!c)throw Error(Nt(147,r));var p=c,_=""+r;return o!==null&&o.ref!==null&&typeof o.ref=="function"&&o.ref._stringRef===_?o.ref:(o=function(x){var T=p.refs;T===w4&&(T=p.refs={}),x===null?delete T[_]:T[_]=x},o._stringRef=_,o)}if(typeof r!="string")throw Error(Nt(284));if(!a._owner)throw Error(Nt(290,r))}return r}function Zx(r,o){throw r=Object.prototype.toString.call(o),Error(Nt(31,r==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":r))}function zD(r){var o=r._init;return o(r._payload)}function S4(r){function o(H,G){if(r){var ee=H.deletions;ee===null?(H.deletions=[G],H.flags|=16):ee.push(G)}}function a(H,G){if(!r)return null;for(;G!==null;)o(H,G),G=G.sibling;return null}function c(H,G){for(H=new Map;G!==null;)G.key!==null?H.set(G.key,G):H.set(G.index,G),G=G.sibling;return H}function p(H,G){return H=Yh(H,G),H.index=0,H.sibling=null,H}function _(H,G,ee){return H.index=ee,r?(ee=H.alternate,ee!==null?(ee=ee.index,ee<G?(H.flags|=2,G):ee):(H.flags|=2,G)):(H.flags|=1048576,G)}function x(H){return r&&H.alternate===null&&(H.flags|=2),H}function T(H,G,ee,W){return G===null||G.tag!==6?(G=uT(ee,H.mode,W),G.return=H,G):(G=p(G,ee),G.return=H,G)}function C(H,G,ee,W){var me=ee.type;return me===eg?O(H,G,ee.props.children,W,ee.key):G!==null&&(G.elementType===me||typeof me=="object"&&me!==null&&me.$$typeof===Dh&&zD(me)===G.type)?(W=p(G,ee.props),W.ref=K_(H,G,ee),W.return=H,W):(W=zw(ee.type,ee.key,ee.props,null,H.mode,W),W.ref=K_(H,G,ee),W.return=H,W)}function P(H,G,ee,W){return G===null||G.tag!==4||G.stateNode.containerInfo!==ee.containerInfo||G.stateNode.implementation!==ee.implementation?(G=cT(ee,H.mode,W),G.return=H,G):(G=p(G,ee.children||[]),G.return=H,G)}function O(H,G,ee,W,me){return G===null||G.tag!==7?(G=Mf(ee,H.mode,W,me),G.return=H,G):(G=p(G,ee),G.return=H,G)}function F(H,G,ee){if(typeof G=="string"&&G!==""||typeof G=="number")return G=uT(""+G,H.mode,ee),G.return=H,G;if(typeof G=="object"&&G!==null){switch(G.$$typeof){case Fx:return ee=zw(G.type,G.key,G.props,null,H.mode,ee),ee.ref=K_(H,null,G),ee.return=H,ee;case Jm:return G=cT(G,H.mode,ee),G.return=H,G;case Dh:var W=G._init;return F(H,W(G._payload),ee)}if(f0(G)||H_(G))return G=Mf(G,H.mode,ee,null),G.return=H,G;Zx(H,G)}return null}function U(H,G,ee,W){var me=G!==null?G.key:null;if(typeof ee=="string"&&ee!==""||typeof ee=="number")return me!==null?null:T(H,G,""+ee,W);if(typeof ee=="object"&&ee!==null){switch(ee.$$typeof){case Fx:return ee.key===me?C(H,G,ee,W):null;case Jm:return ee.key===me?P(H,G,ee,W):null;case Dh:return me=ee._init,U(H,G,me(ee._payload),W)}if(f0(ee)||H_(ee))return me!==null?null:O(H,G,ee,W,null);Zx(H,ee)}return null}function Z(H,G,ee,W,me){if(typeof W=="string"&&W!==""||typeof W=="number")return H=H.get(ee)||null,T(G,H,""+W,me);if(typeof W=="object"&&W!==null){switch(W.$$typeof){case Fx:return H=H.get(W.key===null?ee:W.key)||null,C(G,H,W,me);case Jm:return H=H.get(W.key===null?ee:W.key)||null,P(G,H,W,me);case Dh:var de=W._init;return Z(H,G,ee,de(W._payload),me)}if(f0(W)||H_(W))return H=H.get(ee)||null,O(G,H,W,me,null);Zx(G,W)}return null}function $(H,G,ee,W){for(var me=null,de=null,he=G,se=G=0,q=null;he!==null&&se<ee.length;se++){he.index>se?(q=he,he=null):q=he.sibling;var Se=U(H,he,ee[se],W);if(Se===null){he===null&&(he=q);break}r&&he&&Se.alternate===null&&o(H,he),G=_(Se,G,se),de===null?me=Se:de.sibling=Se,de=Se,he=q}if(se===ee.length)return a(H,he),ki&&_f(H,se),me;if(he===null){for(;se<ee.length;se++)he=F(H,ee[se],W),he!==null&&(G=_(he,G,se),de===null?me=he:de.sibling=he,de=he);return ki&&_f(H,se),me}for(he=c(H,he);se<ee.length;se++)q=Z(he,H,se,ee[se],W),q!==null&&(r&&q.alternate!==null&&he.delete(q.key===null?se:q.key),G=_(q,G,se),de===null?me=q:de.sibling=q,de=q);return r&&he.forEach(function(ze){return o(H,ze)}),ki&&_f(H,se),me}function K(H,G,ee,W){var me=H_(ee);if(typeof me!="function")throw Error(Nt(150));if(ee=me.call(ee),ee==null)throw Error(Nt(151));for(var de=me=null,he=G,se=G=0,q=null,Se=ee.next();he!==null&&!Se.done;se++,Se=ee.next()){he.index>se?(q=he,he=null):q=he.sibling;var ze=U(H,he,Se.value,W);if(ze===null){he===null&&(he=q);break}r&&he&&ze.alternate===null&&o(H,he),G=_(ze,G,se),de===null?me=ze:de.sibling=ze,de=ze,he=q}if(Se.done)return a(H,he),ki&&_f(H,se),me;if(he===null){for(;!Se.done;se++,Se=ee.next())Se=F(H,Se.value,W),Se!==null&&(G=_(Se,G,se),de===null?me=Se:de.sibling=Se,de=Se);return ki&&_f(H,se),me}for(he=c(H,he);!Se.done;se++,Se=ee.next())Se=Z(he,H,se,Se.value,W),Se!==null&&(r&&Se.alternate!==null&&he.delete(Se.key===null?se:Se.key),G=_(Se,G,se),de===null?me=Se:de.sibling=Se,de=Se);return r&&he.forEach(function(Ue){return o(H,Ue)}),ki&&_f(H,se),me}function ie(H,G,ee,W){if(typeof ee=="object"&&ee!==null&&ee.type===eg&&ee.key===null&&(ee=ee.props.children),typeof ee=="object"&&ee!==null){switch(ee.$$typeof){case Fx:e:{for(var me=ee.key,de=G;de!==null;){if(de.key===me){if(me=ee.type,me===eg){if(de.tag===7){a(H,de.sibling),G=p(de,ee.props.children),G.return=H,H=G;break e}}else if(de.elementType===me||typeof me=="object"&&me!==null&&me.$$typeof===Dh&&zD(me)===de.type){a(H,de.sibling),G=p(de,ee.props),G.ref=K_(H,de,ee),G.return=H,H=G;break e}a(H,de);break}else o(H,de);de=de.sibling}ee.type===eg?(G=Mf(ee.props.children,H.mode,W,ee.key),G.return=H,H=G):(W=zw(ee.type,ee.key,ee.props,null,H.mode,W),W.ref=K_(H,G,ee),W.return=H,H=W)}return x(H);case Jm:e:{for(de=ee.key;G!==null;){if(G.key===de)if(G.tag===4&&G.stateNode.containerInfo===ee.containerInfo&&G.stateNode.implementation===ee.implementation){a(H,G.sibling),G=p(G,ee.children||[]),G.return=H,H=G;break e}else{a(H,G);break}else o(H,G);G=G.sibling}G=cT(ee,H.mode,W),G.return=H,H=G}return x(H);case Dh:return de=ee._init,ie(H,G,de(ee._payload),W)}if(f0(ee))return $(H,G,ee,W);if(H_(ee))return K(H,G,ee,W);Zx(H,ee)}return typeof ee=="string"&&ee!==""||typeof ee=="number"?(ee=""+ee,G!==null&&G.tag===6?(a(H,G.sibling),G=p(G,ee),G.return=H,H=G):(a(H,G),G=uT(ee,H.mode,W),G.return=H,H=G),x(H)):a(H,G)}return ie}var Mg=S4(!0),E4=S4(!1),bv={},yu=rd(bv),sv=rd(bv),av=rd(bv);function Tf(r){if(r===bv)throw Error(Nt(174));return r}function qA(r,o){switch(gi(av,o),gi(sv,r),gi(yu,bv),r=o.nodeType,r){case 9:case 11:o=(o=o.documentElement)?o.namespaceURI:ZT(null,"");break;default:r=r===8?o.parentNode:o,o=r.namespaceURI||null,r=r.tagName,o=ZT(o,r)}Si(yu),gi(yu,o)}function Ig(){Si(yu),Si(sv),Si(av)}function T4(r){Tf(av.current);var o=Tf(yu.current),a=ZT(o,r.type);o!==a&&(gi(sv,r),gi(yu,a))}function WA(r){sv.current===r&&(Si(yu),Si(sv))}var Oi=rd(0);function Sb(r){for(var o=r;o!==null;){if(o.tag===13){var a=o.memoizedState;if(a!==null&&(a=a.dehydrated,a===null||a.data==="$?"||a.data==="$!"))return o}else if(o.tag===19&&o.memoizedProps.revealOrder!==void 0){if(o.flags&128)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===r)break;for(;o.sibling===null;){if(o.return===null||o.return===r)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}var rT=[];function ZA(){for(var r=0;r<rT.length;r++)rT[r]._workInProgressVersionPrimary=null;rT.length=0}var Pw=wc.ReactCurrentDispatcher,iT=wc.ReactCurrentBatchConfig,Of=0,zi=null,ho=null,Mo=null,Eb=!1,M0=!1,lv=0,cG=0;function Qo(){throw Error(Nt(321))}function XA(r,o){if(o===null)return!1;for(var a=0;a<o.length&&a<r.length;a++)if(!Dl(r[a],o[a]))return!1;return!0}function KA(r,o,a,c,p,_){if(Of=_,zi=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,Pw.current=r===null||r.memoizedState===null?pG:mG,r=a(c,p),M0){_=0;do{if(M0=!1,lv=0,25<=_)throw Error(Nt(301));_+=1,Mo=ho=null,o.updateQueue=null,Pw.current=gG,r=a(c,p)}while(M0)}if(Pw.current=Tb,o=ho!==null&&ho.next!==null,Of=0,Mo=ho=zi=null,Eb=!1,o)throw Error(Nt(300));return r}function YA(){var r=lv!==0;return lv=0,r}function cu(){var r={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Mo===null?zi.memoizedState=Mo=r:Mo=Mo.next=r,Mo}function Ba(){if(ho===null){var r=zi.alternate;r=r!==null?r.memoizedState:null}else r=ho.next;var o=Mo===null?zi.memoizedState:Mo.next;if(o!==null)Mo=o,ho=r;else{if(r===null)throw Error(Nt(310));ho=r,r={memoizedState:ho.memoizedState,baseState:ho.baseState,baseQueue:ho.baseQueue,queue:ho.queue,next:null},Mo===null?zi.memoizedState=Mo=r:Mo=Mo.next=r}return Mo}function uv(r,o){return typeof o=="function"?o(r):o}function oT(r){var o=Ba(),a=o.queue;if(a===null)throw Error(Nt(311));a.lastRenderedReducer=r;var c=ho,p=c.baseQueue,_=a.pending;if(_!==null){if(p!==null){var x=p.next;p.next=_.next,_.next=x}c.baseQueue=p=_,a.pending=null}if(p!==null){_=p.next,c=c.baseState;var T=x=null,C=null,P=_;do{var O=P.lane;if((Of&O)===O)C!==null&&(C=C.next={lane:0,action:P.action,hasEagerState:P.hasEagerState,eagerState:P.eagerState,next:null}),c=P.hasEagerState?P.eagerState:r(c,P.action);else{var F={lane:O,action:P.action,hasEagerState:P.hasEagerState,eagerState:P.eagerState,next:null};C===null?(T=C=F,x=c):C=C.next=F,zi.lanes|=O,zf|=O}P=P.next}while(P!==null&&P!==_);C===null?x=c:C.next=T,Dl(c,o.memoizedState)||(js=!0),o.memoizedState=c,o.baseState=x,o.baseQueue=C,a.lastRenderedState=c}if(r=a.interleaved,r!==null){p=r;do _=p.lane,zi.lanes|=_,zf|=_,p=p.next;while(p!==r)}else p===null&&(a.lanes=0);return[o.memoizedState,a.dispatch]}function sT(r){var o=Ba(),a=o.queue;if(a===null)throw Error(Nt(311));a.lastRenderedReducer=r;var c=a.dispatch,p=a.pending,_=o.memoizedState;if(p!==null){a.pending=null;var x=p=p.next;do _=r(_,x.action),x=x.next;while(x!==p);Dl(_,o.memoizedState)||(js=!0),o.memoizedState=_,o.baseQueue===null&&(o.baseState=_),a.lastRenderedState=_}return[_,c]}function C4(){}function A4(r,o){var a=zi,c=Ba(),p=o(),_=!Dl(c.memoizedState,p);if(_&&(c.memoizedState=p,js=!0),c=c.queue,QA(k4.bind(null,a,c,r),[r]),c.getSnapshot!==o||_||Mo!==null&&Mo.memoizedState.tag&1){if(a.flags|=2048,cv(9,I4.bind(null,a,c,p,o),void 0,null),Io===null)throw Error(Nt(349));Of&30||M4(a,o,p)}return p}function M4(r,o,a){r.flags|=16384,r={getSnapshot:o,value:a},o=zi.updateQueue,o===null?(o={lastEffect:null,stores:null},zi.updateQueue=o,o.stores=[r]):(a=o.stores,a===null?o.stores=[r]:a.push(r))}function I4(r,o,a,c){o.value=a,o.getSnapshot=c,P4(o)&&R4(r)}function k4(r,o,a){return a(function(){P4(o)&&R4(r)})}function P4(r){var o=r.getSnapshot;r=r.value;try{var a=o();return!Dl(r,a)}catch{return!0}}function R4(r){var o=vc(r,1);o!==null&&Rl(o,r,1,-1)}function FD(r){var o=cu();return typeof r=="function"&&(r=r()),o.memoizedState=o.baseState=r,r={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:uv,lastRenderedState:r},o.queue=r,r=r.dispatch=fG.bind(null,zi,r),[o.memoizedState,r]}function cv(r,o,a,c){return r={tag:r,create:o,destroy:a,deps:c,next:null},o=zi.updateQueue,o===null?(o={lastEffect:null,stores:null},zi.updateQueue=o,o.lastEffect=r.next=r):(a=o.lastEffect,a===null?o.lastEffect=r.next=r:(c=a.next,a.next=r,r.next=c,o.lastEffect=r)),r}function D4(){return Ba().memoizedState}function Rw(r,o,a,c){var p=cu();zi.flags|=r,p.memoizedState=cv(1|o,a,void 0,c===void 0?null:c)}function l2(r,o,a,c){var p=Ba();c=c===void 0?null:c;var _=void 0;if(ho!==null){var x=ho.memoizedState;if(_=x.destroy,c!==null&&XA(c,x.deps)){p.memoizedState=cv(o,a,_,c);return}}zi.flags|=r,p.memoizedState=cv(1|o,a,_,c)}function BD(r,o){return Rw(8390656,8,r,o)}function QA(r,o){return l2(2048,8,r,o)}function L4(r,o){return l2(4,2,r,o)}function O4(r,o){return l2(4,4,r,o)}function z4(r,o){if(typeof o=="function")return r=r(),o(r),function(){o(null)};if(o!=null)return r=r(),o.current=r,function(){o.current=null}}function F4(r,o,a){return a=a!=null?a.concat([r]):null,l2(4,4,z4.bind(null,o,r),a)}function JA(){}function B4(r,o){var a=Ba();o=o===void 0?null:o;var c=a.memoizedState;return c!==null&&o!==null&&XA(o,c[1])?c[0]:(a.memoizedState=[r,o],r)}function N4(r,o){var a=Ba();o=o===void 0?null:o;var c=a.memoizedState;return c!==null&&o!==null&&XA(o,c[1])?c[0]:(r=r(),a.memoizedState=[r,o],r)}function j4(r,o,a){return Of&21?(Dl(a,o)||(a=$z(),zi.lanes|=a,zf|=a,r.baseState=!0),o):(r.baseState&&(r.baseState=!1,js=!0),r.memoizedState=a)}function hG(r,o){var a=Xr;Xr=a!==0&&4>a?a:4,r(!0);var c=iT.transition;iT.transition={};try{r(!1),o()}finally{Xr=a,iT.transition=c}}function U4(){return Ba().memoizedState}function dG(r,o,a){var c=Kh(r);if(a={lane:c,action:a,hasEagerState:!1,eagerState:null,next:null},V4(r))$4(o,a);else if(a=v4(r,o,a,c),a!==null){var p=bs();Rl(a,r,c,p),G4(a,o,c)}}function fG(r,o,a){var c=Kh(r),p={lane:c,action:a,hasEagerState:!1,eagerState:null,next:null};if(V4(r))$4(o,p);else{var _=r.alternate;if(r.lanes===0&&(_===null||_.lanes===0)&&(_=o.lastRenderedReducer,_!==null))try{var x=o.lastRenderedState,T=_(x,a);if(p.hasEagerState=!0,p.eagerState=T,Dl(T,x)){var C=o.interleaved;C===null?(p.next=p,GA(o)):(p.next=C.next,C.next=p),o.interleaved=p;return}}catch{}finally{}a=v4(r,o,p,c),a!==null&&(p=bs(),Rl(a,r,c,p),G4(a,o,c))}}function V4(r){var o=r.alternate;return r===zi||o!==null&&o===zi}function $4(r,o){M0=Eb=!0;var a=r.pending;a===null?o.next=o:(o.next=a.next,a.next=o),r.pending=o}function G4(r,o,a){if(a&4194240){var c=o.lanes;c&=r.pendingLanes,a|=c,o.lanes=a,kA(r,a)}}var Tb={readContext:Fa,useCallback:Qo,useContext:Qo,useEffect:Qo,useImperativeHandle:Qo,useInsertionEffect:Qo,useLayoutEffect:Qo,useMemo:Qo,useReducer:Qo,useRef:Qo,useState:Qo,useDebugValue:Qo,useDeferredValue:Qo,useTransition:Qo,useMutableSource:Qo,useSyncExternalStore:Qo,useId:Qo,unstable_isNewReconciler:!1},pG={readContext:Fa,useCallback:function(r,o){return cu().memoizedState=[r,o===void 0?null:o],r},useContext:Fa,useEffect:BD,useImperativeHandle:function(r,o,a){return a=a!=null?a.concat([r]):null,Rw(4194308,4,z4.bind(null,o,r),a)},useLayoutEffect:function(r,o){return Rw(4194308,4,r,o)},useInsertionEffect:function(r,o){return Rw(4,2,r,o)},useMemo:function(r,o){var a=cu();return o=o===void 0?null:o,r=r(),a.memoizedState=[r,o],r},useReducer:function(r,o,a){var c=cu();return o=a!==void 0?a(o):o,c.memoizedState=c.baseState=o,r={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:r,lastRenderedState:o},c.queue=r,r=r.dispatch=dG.bind(null,zi,r),[c.memoizedState,r]},useRef:function(r){var o=cu();return r={current:r},o.memoizedState=r},useState:FD,useDebugValue:JA,useDeferredValue:function(r){return cu().memoizedState=r},useTransition:function(){var r=FD(!1),o=r[0];return r=hG.bind(null,r[1]),cu().memoizedState=r,[o,r]},useMutableSource:function(){},useSyncExternalStore:function(r,o,a){var c=zi,p=cu();if(ki){if(a===void 0)throw Error(Nt(407));a=a()}else{if(a=o(),Io===null)throw Error(Nt(349));Of&30||M4(c,o,a)}p.memoizedState=a;var _={value:a,getSnapshot:o};return p.queue=_,BD(k4.bind(null,c,_,r),[r]),c.flags|=2048,cv(9,I4.bind(null,c,_,a,o),void 0,null),a},useId:function(){var r=cu(),o=Io.identifierPrefix;if(ki){var a=pc,c=fc;a=(c&~(1<<32-Pl(c)-1)).toString(32)+a,o=":"+o+"R"+a,a=lv++,0<a&&(o+="H"+a.toString(32)),o+=":"}else a=cG++,o=":"+o+"r"+a.toString(32)+":";return r.memoizedState=o},unstable_isNewReconciler:!1},mG={readContext:Fa,useCallback:B4,useContext:Fa,useEffect:QA,useImperativeHandle:F4,useInsertionEffect:L4,useLayoutEffect:O4,useMemo:N4,useReducer:oT,useRef:D4,useState:function(){return oT(uv)},useDebugValue:JA,useDeferredValue:function(r){var o=Ba();return j4(o,ho.memoizedState,r)},useTransition:function(){var r=oT(uv)[0],o=Ba().memoizedState;return[r,o]},useMutableSource:C4,useSyncExternalStore:A4,useId:U4,unstable_isNewReconciler:!1},gG={readContext:Fa,useCallback:B4,useContext:Fa,useEffect:QA,useImperativeHandle:F4,useInsertionEffect:L4,useLayoutEffect:O4,useMemo:N4,useReducer:sT,useRef:D4,useState:function(){return sT(uv)},useDebugValue:JA,useDeferredValue:function(r){var o=Ba();return ho===null?o.memoizedState=r:j4(o,ho.memoizedState,r)},useTransition:function(){var r=sT(uv)[0],o=Ba().memoizedState;return[r,o]},useMutableSource:C4,useSyncExternalStore:A4,useId:U4,unstable_isNewReconciler:!1};function kg(r,o){try{var a="",c=o;do a+=G9(c),c=c.return;while(c);var p=a}catch(_){p=`
Error generating stack: `+_.message+`
`+_.stack}return{value:r,source:o,stack:p,digest:null}}function aT(r,o,a){return{value:r,source:null,stack:a??null,digest:o??null}}function yC(r,o){try{console.error(o.value)}catch(a){setTimeout(function(){throw a})}}var yG=typeof WeakMap=="function"?WeakMap:Map;function H4(r,o,a){a=mc(-1,a),a.tag=3,a.payload={element:null};var c=o.value;return a.callback=function(){Ab||(Ab=!0,AC=c),yC(r,o)},a}function q4(r,o,a){a=mc(-1,a),a.tag=3;var c=r.type.getDerivedStateFromError;if(typeof c=="function"){var p=o.value;a.payload=function(){return c(p)},a.callback=function(){yC(r,o)}}var _=r.stateNode;return _!==null&&typeof _.componentDidCatch=="function"&&(a.callback=function(){yC(r,o),typeof c!="function"&&(Xh===null?Xh=new Set([this]):Xh.add(this));var x=o.stack;this.componentDidCatch(o.value,{componentStack:x!==null?x:""})}),a}function ND(r,o,a){var c=r.pingCache;if(c===null){c=r.pingCache=new yG;var p=new Set;c.set(o,p)}else p=c.get(o),p===void 0&&(p=new Set,c.set(o,p));p.has(a)||(p.add(a),r=PG.bind(null,r,o,a),o.then(r,r))}function jD(r){do{var o;if((o=r.tag===13)&&(o=r.memoizedState,o=o!==null?o.dehydrated!==null:!0),o)return r;r=r.return}while(r!==null);return null}function UD(r,o,a,c,p){return r.mode&1?(r.flags|=65536,r.lanes=p,r):(r===o?r.flags|=65536:(r.flags|=128,a.flags|=131072,a.flags&=-52805,a.tag===1&&(a.alternate===null?a.tag=17:(o=mc(-1,1),o.tag=2,Zh(a,o,1))),a.lanes|=1),r)}var _G=wc.ReactCurrentOwner,js=!1;function xs(r,o,a,c){o.child=r===null?E4(o,null,a,c):Mg(o,r.child,a,c)}function VD(r,o,a,c,p){a=a.render;var _=o.ref;return vg(o,p),c=KA(r,o,a,c,_,p),a=YA(),r!==null&&!js?(o.updateQueue=r.updateQueue,o.flags&=-2053,r.lanes&=~p,xc(r,o,p)):(ki&&a&&BA(o),o.flags|=1,xs(r,o,c,p),o.child)}function $D(r,o,a,c,p){if(r===null){var _=a.type;return typeof _=="function"&&!aM(_)&&_.defaultProps===void 0&&a.compare===null&&a.defaultProps===void 0?(o.tag=15,o.type=_,W4(r,o,_,c,p)):(r=zw(a.type,null,c,o,o.mode,p),r.ref=o.ref,r.return=o,o.child=r)}if(_=r.child,!(r.lanes&p)){var x=_.memoizedProps;if(a=a.compare,a=a!==null?a:nv,a(x,c)&&r.ref===o.ref)return xc(r,o,p)}return o.flags|=1,r=Yh(_,c),r.ref=o.ref,r.return=o,o.child=r}function W4(r,o,a,c,p){if(r!==null){var _=r.memoizedProps;if(nv(_,c)&&r.ref===o.ref)if(js=!1,o.pendingProps=c=_,(r.lanes&p)!==0)r.flags&131072&&(js=!0);else return o.lanes=r.lanes,xc(r,o,p)}return _C(r,o,a,c,p)}function Z4(r,o,a){var c=o.pendingProps,p=c.children,_=r!==null?r.memoizedState:null;if(c.mode==="hidden")if(!(o.mode&1))o.memoizedState={baseLanes:0,cachePool:null,transitions:null},gi(cg,Qs),Qs|=a;else{if(!(a&1073741824))return r=_!==null?_.baseLanes|a:a,o.lanes=o.childLanes=1073741824,o.memoizedState={baseLanes:r,cachePool:null,transitions:null},o.updateQueue=null,gi(cg,Qs),Qs|=r,null;o.memoizedState={baseLanes:0,cachePool:null,transitions:null},c=_!==null?_.baseLanes:a,gi(cg,Qs),Qs|=c}else _!==null?(c=_.baseLanes|a,o.memoizedState=null):c=a,gi(cg,Qs),Qs|=c;return xs(r,o,p,a),o.child}function X4(r,o){var a=o.ref;(r===null&&a!==null||r!==null&&r.ref!==a)&&(o.flags|=512,o.flags|=2097152)}function _C(r,o,a,c,p){var _=$s(a)?Df:rs.current;return _=Cg(o,_),vg(o,p),a=KA(r,o,a,c,_,p),c=YA(),r!==null&&!js?(o.updateQueue=r.updateQueue,o.flags&=-2053,r.lanes&=~p,xc(r,o,p)):(ki&&c&&BA(o),o.flags|=1,xs(r,o,a,p),o.child)}function GD(r,o,a,c,p){if($s(a)){var _=!0;yb(o)}else _=!1;if(vg(o,p),o.stateNode===null)Dw(r,o),b4(o,a,c),gC(o,a,c,p),c=!0;else if(r===null){var x=o.stateNode,T=o.memoizedProps;x.props=T;var C=x.context,P=a.contextType;typeof P=="object"&&P!==null?P=Fa(P):(P=$s(a)?Df:rs.current,P=Cg(o,P));var O=a.getDerivedStateFromProps,F=typeof O=="function"||typeof x.getSnapshotBeforeUpdate=="function";F||typeof x.UNSAFE_componentWillReceiveProps!="function"&&typeof x.componentWillReceiveProps!="function"||(T!==c||C!==P)&&OD(o,x,c,P),Lh=!1;var U=o.memoizedState;x.state=U,bb(o,c,x,p),C=o.memoizedState,T!==c||U!==C||Vs.current||Lh?(typeof O=="function"&&(mC(o,a,O,c),C=o.memoizedState),(T=Lh||LD(o,a,T,c,U,C,P))?(F||typeof x.UNSAFE_componentWillMount!="function"&&typeof x.componentWillMount!="function"||(typeof x.componentWillMount=="function"&&x.componentWillMount(),typeof x.UNSAFE_componentWillMount=="function"&&x.UNSAFE_componentWillMount()),typeof x.componentDidMount=="function"&&(o.flags|=4194308)):(typeof x.componentDidMount=="function"&&(o.flags|=4194308),o.memoizedProps=c,o.memoizedState=C),x.props=c,x.state=C,x.context=P,c=T):(typeof x.componentDidMount=="function"&&(o.flags|=4194308),c=!1)}else{x=o.stateNode,x4(r,o),T=o.memoizedProps,P=o.type===o.elementType?T:bl(o.type,T),x.props=P,F=o.pendingProps,U=x.context,C=a.contextType,typeof C=="object"&&C!==null?C=Fa(C):(C=$s(a)?Df:rs.current,C=Cg(o,C));var Z=a.getDerivedStateFromProps;(O=typeof Z=="function"||typeof x.getSnapshotBeforeUpdate=="function")||typeof x.UNSAFE_componentWillReceiveProps!="function"&&typeof x.componentWillReceiveProps!="function"||(T!==F||U!==C)&&OD(o,x,c,C),Lh=!1,U=o.memoizedState,x.state=U,bb(o,c,x,p);var $=o.memoizedState;T!==F||U!==$||Vs.current||Lh?(typeof Z=="function"&&(mC(o,a,Z,c),$=o.memoizedState),(P=Lh||LD(o,a,P,c,U,$,C)||!1)?(O||typeof x.UNSAFE_componentWillUpdate!="function"&&typeof x.componentWillUpdate!="function"||(typeof x.componentWillUpdate=="function"&&x.componentWillUpdate(c,$,C),typeof x.UNSAFE_componentWillUpdate=="function"&&x.UNSAFE_componentWillUpdate(c,$,C)),typeof x.componentDidUpdate=="function"&&(o.flags|=4),typeof x.getSnapshotBeforeUpdate=="function"&&(o.flags|=1024)):(typeof x.componentDidUpdate!="function"||T===r.memoizedProps&&U===r.memoizedState||(o.flags|=4),typeof x.getSnapshotBeforeUpdate!="function"||T===r.memoizedProps&&U===r.memoizedState||(o.flags|=1024),o.memoizedProps=c,o.memoizedState=$),x.props=c,x.state=$,x.context=C,c=P):(typeof x.componentDidUpdate!="function"||T===r.memoizedProps&&U===r.memoizedState||(o.flags|=4),typeof x.getSnapshotBeforeUpdate!="function"||T===r.memoizedProps&&U===r.memoizedState||(o.flags|=1024),c=!1)}return vC(r,o,a,c,_,p)}function vC(r,o,a,c,p,_){X4(r,o);var x=(o.flags&128)!==0;if(!c&&!x)return p&&ID(o,a,!1),xc(r,o,_);c=o.stateNode,_G.current=o;var T=x&&typeof a.getDerivedStateFromError!="function"?null:c.render();return o.flags|=1,r!==null&&x?(o.child=Mg(o,r.child,null,_),o.child=Mg(o,null,T,_)):xs(r,o,T,_),o.memoizedState=c.state,p&&ID(o,a,!0),o.child}function K4(r){var o=r.stateNode;o.pendingContext?MD(r,o.pendingContext,o.pendingContext!==o.context):o.context&&MD(r,o.context,!1),qA(r,o.containerInfo)}function HD(r,o,a,c,p){return Ag(),jA(p),o.flags|=256,xs(r,o,a,c),o.child}var xC={dehydrated:null,treeContext:null,retryLane:0};function wC(r){return{baseLanes:r,cachePool:null,transitions:null}}function Y4(r,o,a){var c=o.pendingProps,p=Oi.current,_=!1,x=(o.flags&128)!==0,T;if((T=x)||(T=r!==null&&r.memoizedState===null?!1:(p&2)!==0),T?(_=!0,o.flags&=-129):(r===null||r.memoizedState!==null)&&(p|=1),gi(Oi,p&1),r===null)return fC(o),r=o.memoizedState,r!==null&&(r=r.dehydrated,r!==null)?(o.mode&1?r.data==="$!"?o.lanes=8:o.lanes=1073741824:o.lanes=1,null):(x=c.children,r=c.fallback,_?(c=o.mode,_=o.child,x={mode:"hidden",children:x},!(c&1)&&_!==null?(_.childLanes=0,_.pendingProps=x):_=h2(x,c,0,null),r=Mf(r,c,a,null),_.return=o,r.return=o,_.sibling=r,o.child=_,o.child.memoizedState=wC(a),o.memoizedState=xC,r):eM(o,x));if(p=r.memoizedState,p!==null&&(T=p.dehydrated,T!==null))return vG(r,o,x,c,T,p,a);if(_){_=c.fallback,x=o.mode,p=r.child,T=p.sibling;var C={mode:"hidden",children:c.children};return!(x&1)&&o.child!==p?(c=o.child,c.childLanes=0,c.pendingProps=C,o.deletions=null):(c=Yh(p,C),c.subtreeFlags=p.subtreeFlags&14680064),T!==null?_=Yh(T,_):(_=Mf(_,x,a,null),_.flags|=2),_.return=o,c.return=o,c.sibling=_,o.child=c,c=_,_=o.child,x=r.child.memoizedState,x=x===null?wC(a):{baseLanes:x.baseLanes|a,cachePool:null,transitions:x.transitions},_.memoizedState=x,_.childLanes=r.childLanes&~a,o.memoizedState=xC,c}return _=r.child,r=_.sibling,c=Yh(_,{mode:"visible",children:c.children}),!(o.mode&1)&&(c.lanes=a),c.return=o,c.sibling=null,r!==null&&(a=o.deletions,a===null?(o.deletions=[r],o.flags|=16):a.push(r)),o.child=c,o.memoizedState=null,c}function eM(r,o){return o=h2({mode:"visible",children:o},r.mode,0,null),o.return=r,r.child=o}function Xx(r,o,a,c){return c!==null&&jA(c),Mg(o,r.child,null,a),r=eM(o,o.pendingProps.children),r.flags|=2,o.memoizedState=null,r}function vG(r,o,a,c,p,_,x){if(a)return o.flags&256?(o.flags&=-257,c=aT(Error(Nt(422))),Xx(r,o,x,c)):o.memoizedState!==null?(o.child=r.child,o.flags|=128,null):(_=c.fallback,p=o.mode,c=h2({mode:"visible",children:c.children},p,0,null),_=Mf(_,p,x,null),_.flags|=2,c.return=o,_.return=o,c.sibling=_,o.child=c,o.mode&1&&Mg(o,r.child,null,x),o.child.memoizedState=wC(x),o.memoizedState=xC,_);if(!(o.mode&1))return Xx(r,o,x,null);if(p.data==="$!"){if(c=p.nextSibling&&p.nextSibling.dataset,c)var T=c.dgst;return c=T,_=Error(Nt(419)),c=aT(_,c,void 0),Xx(r,o,x,c)}if(T=(x&r.childLanes)!==0,js||T){if(c=Io,c!==null){switch(x&-x){case 4:p=2;break;case 16:p=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:p=32;break;case 536870912:p=268435456;break;default:p=0}p=p&(c.suspendedLanes|x)?0:p,p!==0&&p!==_.retryLane&&(_.retryLane=p,vc(r,p),Rl(c,r,p,-1))}return sM(),c=aT(Error(Nt(421))),Xx(r,o,x,c)}return p.data==="$?"?(o.flags|=128,o.child=r.child,o=RG.bind(null,r),p._reactRetry=o,null):(r=_.treeContext,Js=Wh(p.nextSibling),ea=o,ki=!0,Cl=null,r!==null&&(Ra[Da++]=fc,Ra[Da++]=pc,Ra[Da++]=Lf,fc=r.id,pc=r.overflow,Lf=o),o=eM(o,c.children),o.flags|=4096,o)}function qD(r,o,a){r.lanes|=o;var c=r.alternate;c!==null&&(c.lanes|=o),pC(r.return,o,a)}function lT(r,o,a,c,p){var _=r.memoizedState;_===null?r.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:c,tail:a,tailMode:p}:(_.isBackwards=o,_.rendering=null,_.renderingStartTime=0,_.last=c,_.tail=a,_.tailMode=p)}function Q4(r,o,a){var c=o.pendingProps,p=c.revealOrder,_=c.tail;if(xs(r,o,c.children,a),c=Oi.current,c&2)c=c&1|2,o.flags|=128;else{if(r!==null&&r.flags&128)e:for(r=o.child;r!==null;){if(r.tag===13)r.memoizedState!==null&&qD(r,a,o);else if(r.tag===19)qD(r,a,o);else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===o)break e;for(;r.sibling===null;){if(r.return===null||r.return===o)break e;r=r.return}r.sibling.return=r.return,r=r.sibling}c&=1}if(gi(Oi,c),!(o.mode&1))o.memoizedState=null;else switch(p){case"forwards":for(a=o.child,p=null;a!==null;)r=a.alternate,r!==null&&Sb(r)===null&&(p=a),a=a.sibling;a=p,a===null?(p=o.child,o.child=null):(p=a.sibling,a.sibling=null),lT(o,!1,p,a,_);break;case"backwards":for(a=null,p=o.child,o.child=null;p!==null;){if(r=p.alternate,r!==null&&Sb(r)===null){o.child=p;break}r=p.sibling,p.sibling=a,a=p,p=r}lT(o,!0,a,null,_);break;case"together":lT(o,!1,null,null,void 0);break;default:o.memoizedState=null}return o.child}function Dw(r,o){!(o.mode&1)&&r!==null&&(r.alternate=null,o.alternate=null,o.flags|=2)}function xc(r,o,a){if(r!==null&&(o.dependencies=r.dependencies),zf|=o.lanes,!(a&o.childLanes))return null;if(r!==null&&o.child!==r.child)throw Error(Nt(153));if(o.child!==null){for(r=o.child,a=Yh(r,r.pendingProps),o.child=a,a.return=o;r.sibling!==null;)r=r.sibling,a=a.sibling=Yh(r,r.pendingProps),a.return=o;a.sibling=null}return o.child}function xG(r,o,a){switch(o.tag){case 3:K4(o),Ag();break;case 5:T4(o);break;case 1:$s(o.type)&&yb(o);break;case 4:qA(o,o.stateNode.containerInfo);break;case 10:var c=o.type._context,p=o.memoizedProps.value;gi(xb,c._currentValue),c._currentValue=p;break;case 13:if(c=o.memoizedState,c!==null)return c.dehydrated!==null?(gi(Oi,Oi.current&1),o.flags|=128,null):a&o.child.childLanes?Y4(r,o,a):(gi(Oi,Oi.current&1),r=xc(r,o,a),r!==null?r.sibling:null);gi(Oi,Oi.current&1);break;case 19:if(c=(a&o.childLanes)!==0,r.flags&128){if(c)return Q4(r,o,a);o.flags|=128}if(p=o.memoizedState,p!==null&&(p.rendering=null,p.tail=null,p.lastEffect=null),gi(Oi,Oi.current),c)break;return null;case 22:case 23:return o.lanes=0,Z4(r,o,a)}return xc(r,o,a)}var J4,bC,e5,t5;J4=function(r,o){for(var a=o.child;a!==null;){if(a.tag===5||a.tag===6)r.appendChild(a.stateNode);else if(a.tag!==4&&a.child!==null){a.child.return=a,a=a.child;continue}if(a===o)break;for(;a.sibling===null;){if(a.return===null||a.return===o)return;a=a.return}a.sibling.return=a.return,a=a.sibling}};bC=function(){};e5=function(r,o,a,c){var p=r.memoizedProps;if(p!==c){r=o.stateNode,Tf(yu.current);var _=null;switch(a){case"input":p=GT(r,p),c=GT(r,c),_=[];break;case"select":p=Fi({},p,{value:void 0}),c=Fi({},c,{value:void 0}),_=[];break;case"textarea":p=WT(r,p),c=WT(r,c),_=[];break;default:typeof p.onClick!="function"&&typeof c.onClick=="function"&&(r.onclick=mb)}XT(a,c);var x;a=null;for(P in p)if(!c.hasOwnProperty(P)&&p.hasOwnProperty(P)&&p[P]!=null)if(P==="style"){var T=p[P];for(x in T)T.hasOwnProperty(x)&&(a||(a={}),a[x]="")}else P!=="dangerouslySetInnerHTML"&&P!=="children"&&P!=="suppressContentEditableWarning"&&P!=="suppressHydrationWarning"&&P!=="autoFocus"&&(X0.hasOwnProperty(P)?_||(_=[]):(_=_||[]).push(P,null));for(P in c){var C=c[P];if(T=p!=null?p[P]:void 0,c.hasOwnProperty(P)&&C!==T&&(C!=null||T!=null))if(P==="style")if(T){for(x in T)!T.hasOwnProperty(x)||C&&C.hasOwnProperty(x)||(a||(a={}),a[x]="");for(x in C)C.hasOwnProperty(x)&&T[x]!==C[x]&&(a||(a={}),a[x]=C[x])}else a||(_||(_=[]),_.push(P,a)),a=C;else P==="dangerouslySetInnerHTML"?(C=C?C.__html:void 0,T=T?T.__html:void 0,C!=null&&T!==C&&(_=_||[]).push(P,C)):P==="children"?typeof C!="string"&&typeof C!="number"||(_=_||[]).push(P,""+C):P!=="suppressContentEditableWarning"&&P!=="suppressHydrationWarning"&&(X0.hasOwnProperty(P)?(C!=null&&P==="onScroll"&&wi("scroll",r),_||T===C||(_=[])):(_=_||[]).push(P,C))}a&&(_=_||[]).push("style",a);var P=_;(o.updateQueue=P)&&(o.flags|=4)}};t5=function(r,o,a,c){a!==c&&(o.flags|=4)};function Y_(r,o){if(!ki)switch(r.tailMode){case"hidden":o=r.tail;for(var a=null;o!==null;)o.alternate!==null&&(a=o),o=o.sibling;a===null?r.tail=null:a.sibling=null;break;case"collapsed":a=r.tail;for(var c=null;a!==null;)a.alternate!==null&&(c=a),a=a.sibling;c===null?o||r.tail===null?r.tail=null:r.tail.sibling=null:c.sibling=null}}function Jo(r){var o=r.alternate!==null&&r.alternate.child===r.child,a=0,c=0;if(o)for(var p=r.child;p!==null;)a|=p.lanes|p.childLanes,c|=p.subtreeFlags&14680064,c|=p.flags&14680064,p.return=r,p=p.sibling;else for(p=r.child;p!==null;)a|=p.lanes|p.childLanes,c|=p.subtreeFlags,c|=p.flags,p.return=r,p=p.sibling;return r.subtreeFlags|=c,r.childLanes=a,o}function wG(r,o,a){var c=o.pendingProps;switch(NA(o),o.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Jo(o),null;case 1:return $s(o.type)&&gb(),Jo(o),null;case 3:return c=o.stateNode,Ig(),Si(Vs),Si(rs),ZA(),c.pendingContext&&(c.context=c.pendingContext,c.pendingContext=null),(r===null||r.child===null)&&(Wx(o)?o.flags|=4:r===null||r.memoizedState.isDehydrated&&!(o.flags&256)||(o.flags|=1024,Cl!==null&&(kC(Cl),Cl=null))),bC(r,o),Jo(o),null;case 5:WA(o);var p=Tf(av.current);if(a=o.type,r!==null&&o.stateNode!=null)e5(r,o,a,c,p),r.ref!==o.ref&&(o.flags|=512,o.flags|=2097152);else{if(!c){if(o.stateNode===null)throw Error(Nt(166));return Jo(o),null}if(r=Tf(yu.current),Wx(o)){c=o.stateNode,a=o.type;var _=o.memoizedProps;switch(c[hu]=o,c[ov]=_,r=(o.mode&1)!==0,a){case"dialog":wi("cancel",c),wi("close",c);break;case"iframe":case"object":case"embed":wi("load",c);break;case"video":case"audio":for(p=0;p<m0.length;p++)wi(m0[p],c);break;case"source":wi("error",c);break;case"img":case"image":case"link":wi("error",c),wi("load",c);break;case"details":wi("toggle",c);break;case"input":tD(c,_),wi("invalid",c);break;case"select":c._wrapperState={wasMultiple:!!_.multiple},wi("invalid",c);break;case"textarea":rD(c,_),wi("invalid",c)}XT(a,_),p=null;for(var x in _)if(_.hasOwnProperty(x)){var T=_[x];x==="children"?typeof T=="string"?c.textContent!==T&&(_.suppressHydrationWarning!==!0&&qx(c.textContent,T,r),p=["children",T]):typeof T=="number"&&c.textContent!==""+T&&(_.suppressHydrationWarning!==!0&&qx(c.textContent,T,r),p=["children",""+T]):X0.hasOwnProperty(x)&&T!=null&&x==="onScroll"&&wi("scroll",c)}switch(a){case"input":Bx(c),nD(c,_,!0);break;case"textarea":Bx(c),iD(c);break;case"select":case"option":break;default:typeof _.onClick=="function"&&(c.onclick=mb)}c=p,o.updateQueue=c,c!==null&&(o.flags|=4)}else{x=p.nodeType===9?p:p.ownerDocument,r==="http://www.w3.org/1999/xhtml"&&(r=Mz(a)),r==="http://www.w3.org/1999/xhtml"?a==="script"?(r=x.createElement("div"),r.innerHTML="<script><\/script>",r=r.removeChild(r.firstChild)):typeof c.is=="string"?r=x.createElement(a,{is:c.is}):(r=x.createElement(a),a==="select"&&(x=r,c.multiple?x.multiple=!0:c.size&&(x.size=c.size))):r=x.createElementNS(r,a),r[hu]=o,r[ov]=c,J4(r,o,!1,!1),o.stateNode=r;e:{switch(x=KT(a,c),a){case"dialog":wi("cancel",r),wi("close",r),p=c;break;case"iframe":case"object":case"embed":wi("load",r),p=c;break;case"video":case"audio":for(p=0;p<m0.length;p++)wi(m0[p],r);p=c;break;case"source":wi("error",r),p=c;break;case"img":case"image":case"link":wi("error",r),wi("load",r),p=c;break;case"details":wi("toggle",r),p=c;break;case"input":tD(r,c),p=GT(r,c),wi("invalid",r);break;case"option":p=c;break;case"select":r._wrapperState={wasMultiple:!!c.multiple},p=Fi({},c,{value:void 0}),wi("invalid",r);break;case"textarea":rD(r,c),p=WT(r,c),wi("invalid",r);break;default:p=c}XT(a,p),T=p;for(_ in T)if(T.hasOwnProperty(_)){var C=T[_];_==="style"?Pz(r,C):_==="dangerouslySetInnerHTML"?(C=C?C.__html:void 0,C!=null&&Iz(r,C)):_==="children"?typeof C=="string"?(a!=="textarea"||C!=="")&&K0(r,C):typeof C=="number"&&K0(r,""+C):_!=="suppressContentEditableWarning"&&_!=="suppressHydrationWarning"&&_!=="autoFocus"&&(X0.hasOwnProperty(_)?C!=null&&_==="onScroll"&&wi("scroll",r):C!=null&&EA(r,_,C,x))}switch(a){case"input":Bx(r),nD(r,c,!1);break;case"textarea":Bx(r),iD(r);break;case"option":c.value!=null&&r.setAttribute("value",""+ed(c.value));break;case"select":r.multiple=!!c.multiple,_=c.value,_!=null?mg(r,!!c.multiple,_,!1):c.defaultValue!=null&&mg(r,!!c.multiple,c.defaultValue,!0);break;default:typeof p.onClick=="function"&&(r.onclick=mb)}switch(a){case"button":case"input":case"select":case"textarea":c=!!c.autoFocus;break e;case"img":c=!0;break e;default:c=!1}}c&&(o.flags|=4)}o.ref!==null&&(o.flags|=512,o.flags|=2097152)}return Jo(o),null;case 6:if(r&&o.stateNode!=null)t5(r,o,r.memoizedProps,c);else{if(typeof c!="string"&&o.stateNode===null)throw Error(Nt(166));if(a=Tf(av.current),Tf(yu.current),Wx(o)){if(c=o.stateNode,a=o.memoizedProps,c[hu]=o,(_=c.nodeValue!==a)&&(r=ea,r!==null))switch(r.tag){case 3:qx(c.nodeValue,a,(r.mode&1)!==0);break;case 5:r.memoizedProps.suppressHydrationWarning!==!0&&qx(c.nodeValue,a,(r.mode&1)!==0)}_&&(o.flags|=4)}else c=(a.nodeType===9?a:a.ownerDocument).createTextNode(c),c[hu]=o,o.stateNode=c}return Jo(o),null;case 13:if(Si(Oi),c=o.memoizedState,r===null||r.memoizedState!==null&&r.memoizedState.dehydrated!==null){if(ki&&Js!==null&&o.mode&1&&!(o.flags&128))_4(),Ag(),o.flags|=98560,_=!1;else if(_=Wx(o),c!==null&&c.dehydrated!==null){if(r===null){if(!_)throw Error(Nt(318));if(_=o.memoizedState,_=_!==null?_.dehydrated:null,!_)throw Error(Nt(317));_[hu]=o}else Ag(),!(o.flags&128)&&(o.memoizedState=null),o.flags|=4;Jo(o),_=!1}else Cl!==null&&(kC(Cl),Cl=null),_=!0;if(!_)return o.flags&65536?o:null}return o.flags&128?(o.lanes=a,o):(c=c!==null,c!==(r!==null&&r.memoizedState!==null)&&c&&(o.child.flags|=8192,o.mode&1&&(r===null||Oi.current&1?fo===0&&(fo=3):sM())),o.updateQueue!==null&&(o.flags|=4),Jo(o),null);case 4:return Ig(),bC(r,o),r===null&&rv(o.stateNode.containerInfo),Jo(o),null;case 10:return $A(o.type._context),Jo(o),null;case 17:return $s(o.type)&&gb(),Jo(o),null;case 19:if(Si(Oi),_=o.memoizedState,_===null)return Jo(o),null;if(c=(o.flags&128)!==0,x=_.rendering,x===null)if(c)Y_(_,!1);else{if(fo!==0||r!==null&&r.flags&128)for(r=o.child;r!==null;){if(x=Sb(r),x!==null){for(o.flags|=128,Y_(_,!1),c=x.updateQueue,c!==null&&(o.updateQueue=c,o.flags|=4),o.subtreeFlags=0,c=a,a=o.child;a!==null;)_=a,r=c,_.flags&=14680066,x=_.alternate,x===null?(_.childLanes=0,_.lanes=r,_.child=null,_.subtreeFlags=0,_.memoizedProps=null,_.memoizedState=null,_.updateQueue=null,_.dependencies=null,_.stateNode=null):(_.childLanes=x.childLanes,_.lanes=x.lanes,_.child=x.child,_.subtreeFlags=0,_.deletions=null,_.memoizedProps=x.memoizedProps,_.memoizedState=x.memoizedState,_.updateQueue=x.updateQueue,_.type=x.type,r=x.dependencies,_.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext}),a=a.sibling;return gi(Oi,Oi.current&1|2),o.child}r=r.sibling}_.tail!==null&&Ki()>Pg&&(o.flags|=128,c=!0,Y_(_,!1),o.lanes=4194304)}else{if(!c)if(r=Sb(x),r!==null){if(o.flags|=128,c=!0,a=r.updateQueue,a!==null&&(o.updateQueue=a,o.flags|=4),Y_(_,!0),_.tail===null&&_.tailMode==="hidden"&&!x.alternate&&!ki)return Jo(o),null}else 2*Ki()-_.renderingStartTime>Pg&&a!==1073741824&&(o.flags|=128,c=!0,Y_(_,!1),o.lanes=4194304);_.isBackwards?(x.sibling=o.child,o.child=x):(a=_.last,a!==null?a.sibling=x:o.child=x,_.last=x)}return _.tail!==null?(o=_.tail,_.rendering=o,_.tail=o.sibling,_.renderingStartTime=Ki(),o.sibling=null,a=Oi.current,gi(Oi,c?a&1|2:a&1),o):(Jo(o),null);case 22:case 23:return oM(),c=o.memoizedState!==null,r!==null&&r.memoizedState!==null!==c&&(o.flags|=8192),c&&o.mode&1?Qs&1073741824&&(Jo(o),o.subtreeFlags&6&&(o.flags|=8192)):Jo(o),null;case 24:return null;case 25:return null}throw Error(Nt(156,o.tag))}function bG(r,o){switch(NA(o),o.tag){case 1:return $s(o.type)&&gb(),r=o.flags,r&65536?(o.flags=r&-65537|128,o):null;case 3:return Ig(),Si(Vs),Si(rs),ZA(),r=o.flags,r&65536&&!(r&128)?(o.flags=r&-65537|128,o):null;case 5:return WA(o),null;case 13:if(Si(Oi),r=o.memoizedState,r!==null&&r.dehydrated!==null){if(o.alternate===null)throw Error(Nt(340));Ag()}return r=o.flags,r&65536?(o.flags=r&-65537|128,o):null;case 19:return Si(Oi),null;case 4:return Ig(),null;case 10:return $A(o.type._context),null;case 22:case 23:return oM(),null;case 24:return null;default:return null}}var Kx=!1,ns=!1,SG=typeof WeakSet=="function"?WeakSet:Set,ln=null;function ug(r,o){var a=r.ref;if(a!==null)if(typeof a=="function")try{a(null)}catch(c){Gi(r,o,c)}else a.current=null}function SC(r,o,a){try{a()}catch(c){Gi(r,o,c)}}var WD=!1;function EG(r,o){if(sC=db,r=o4(),FA(r)){if("selectionStart"in r)var a={start:r.selectionStart,end:r.selectionEnd};else e:{a=(a=r.ownerDocument)&&a.defaultView||window;var c=a.getSelection&&a.getSelection();if(c&&c.rangeCount!==0){a=c.anchorNode;var p=c.anchorOffset,_=c.focusNode;c=c.focusOffset;try{a.nodeType,_.nodeType}catch{a=null;break e}var x=0,T=-1,C=-1,P=0,O=0,F=r,U=null;t:for(;;){for(var Z;F!==a||p!==0&&F.nodeType!==3||(T=x+p),F!==_||c!==0&&F.nodeType!==3||(C=x+c),F.nodeType===3&&(x+=F.nodeValue.length),(Z=F.firstChild)!==null;)U=F,F=Z;for(;;){if(F===r)break t;if(U===a&&++P===p&&(T=x),U===_&&++O===c&&(C=x),(Z=F.nextSibling)!==null)break;F=U,U=F.parentNode}F=Z}a=T===-1||C===-1?null:{start:T,end:C}}else a=null}a=a||{start:0,end:0}}else a=null;for(aC={focusedElem:r,selectionRange:a},db=!1,ln=o;ln!==null;)if(o=ln,r=o.child,(o.subtreeFlags&1028)!==0&&r!==null)r.return=o,ln=r;else for(;ln!==null;){o=ln;try{var $=o.alternate;if(o.flags&1024)switch(o.tag){case 0:case 11:case 15:break;case 1:if($!==null){var K=$.memoizedProps,ie=$.memoizedState,H=o.stateNode,G=H.getSnapshotBeforeUpdate(o.elementType===o.type?K:bl(o.type,K),ie);H.__reactInternalSnapshotBeforeUpdate=G}break;case 3:var ee=o.stateNode.containerInfo;ee.nodeType===1?ee.textContent="":ee.nodeType===9&&ee.documentElement&&ee.removeChild(ee.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Nt(163))}}catch(W){Gi(o,o.return,W)}if(r=o.sibling,r!==null){r.return=o.return,ln=r;break}ln=o.return}return $=WD,WD=!1,$}function I0(r,o,a){var c=o.updateQueue;if(c=c!==null?c.lastEffect:null,c!==null){var p=c=c.next;do{if((p.tag&r)===r){var _=p.destroy;p.destroy=void 0,_!==void 0&&SC(o,a,_)}p=p.next}while(p!==c)}}function u2(r,o){if(o=o.updateQueue,o=o!==null?o.lastEffect:null,o!==null){var a=o=o.next;do{if((a.tag&r)===r){var c=a.create;a.destroy=c()}a=a.next}while(a!==o)}}function EC(r){var o=r.ref;if(o!==null){var a=r.stateNode;switch(r.tag){case 5:r=a;break;default:r=a}typeof o=="function"?o(r):o.current=r}}function n5(r){var o=r.alternate;o!==null&&(r.alternate=null,n5(o)),r.child=null,r.deletions=null,r.sibling=null,r.tag===5&&(o=r.stateNode,o!==null&&(delete o[hu],delete o[ov],delete o[cC],delete o[sG],delete o[aG])),r.stateNode=null,r.return=null,r.dependencies=null,r.memoizedProps=null,r.memoizedState=null,r.pendingProps=null,r.stateNode=null,r.updateQueue=null}function r5(r){return r.tag===5||r.tag===3||r.tag===4}function ZD(r){e:for(;;){for(;r.sibling===null;){if(r.return===null||r5(r.return))return null;r=r.return}for(r.sibling.return=r.return,r=r.sibling;r.tag!==5&&r.tag!==6&&r.tag!==18;){if(r.flags&2||r.child===null||r.tag===4)continue e;r.child.return=r,r=r.child}if(!(r.flags&2))return r.stateNode}}function TC(r,o,a){var c=r.tag;if(c===5||c===6)r=r.stateNode,o?a.nodeType===8?a.parentNode.insertBefore(r,o):a.insertBefore(r,o):(a.nodeType===8?(o=a.parentNode,o.insertBefore(r,a)):(o=a,o.appendChild(r)),a=a._reactRootContainer,a!=null||o.onclick!==null||(o.onclick=mb));else if(c!==4&&(r=r.child,r!==null))for(TC(r,o,a),r=r.sibling;r!==null;)TC(r,o,a),r=r.sibling}function CC(r,o,a){var c=r.tag;if(c===5||c===6)r=r.stateNode,o?a.insertBefore(r,o):a.appendChild(r);else if(c!==4&&(r=r.child,r!==null))for(CC(r,o,a),r=r.sibling;r!==null;)CC(r,o,a),r=r.sibling}var jo=null,El=!1;function kh(r,o,a){for(a=a.child;a!==null;)i5(r,o,a),a=a.sibling}function i5(r,o,a){if(gu&&typeof gu.onCommitFiberUnmount=="function")try{gu.onCommitFiberUnmount(t2,a)}catch{}switch(a.tag){case 5:ns||ug(a,o);case 6:var c=jo,p=El;jo=null,kh(r,o,a),jo=c,El=p,jo!==null&&(El?(r=jo,a=a.stateNode,r.nodeType===8?r.parentNode.removeChild(a):r.removeChild(a)):jo.removeChild(a.stateNode));break;case 18:jo!==null&&(El?(r=jo,a=a.stateNode,r.nodeType===8?tT(r.parentNode,a):r.nodeType===1&&tT(r,a),ev(r)):tT(jo,a.stateNode));break;case 4:c=jo,p=El,jo=a.stateNode.containerInfo,El=!0,kh(r,o,a),jo=c,El=p;break;case 0:case 11:case 14:case 15:if(!ns&&(c=a.updateQueue,c!==null&&(c=c.lastEffect,c!==null))){p=c=c.next;do{var _=p,x=_.destroy;_=_.tag,x!==void 0&&(_&2||_&4)&&SC(a,o,x),p=p.next}while(p!==c)}kh(r,o,a);break;case 1:if(!ns&&(ug(a,o),c=a.stateNode,typeof c.componentWillUnmount=="function"))try{c.props=a.memoizedProps,c.state=a.memoizedState,c.componentWillUnmount()}catch(T){Gi(a,o,T)}kh(r,o,a);break;case 21:kh(r,o,a);break;case 22:a.mode&1?(ns=(c=ns)||a.memoizedState!==null,kh(r,o,a),ns=c):kh(r,o,a);break;default:kh(r,o,a)}}function XD(r){var o=r.updateQueue;if(o!==null){r.updateQueue=null;var a=r.stateNode;a===null&&(a=r.stateNode=new SG),o.forEach(function(c){var p=DG.bind(null,r,c);a.has(c)||(a.add(c),c.then(p,p))})}}function wl(r,o){var a=o.deletions;if(a!==null)for(var c=0;c<a.length;c++){var p=a[c];try{var _=r,x=o,T=x;e:for(;T!==null;){switch(T.tag){case 5:jo=T.stateNode,El=!1;break e;case 3:jo=T.stateNode.containerInfo,El=!0;break e;case 4:jo=T.stateNode.containerInfo,El=!0;break e}T=T.return}if(jo===null)throw Error(Nt(160));i5(_,x,p),jo=null,El=!1;var C=p.alternate;C!==null&&(C.return=null),p.return=null}catch(P){Gi(p,o,P)}}if(o.subtreeFlags&12854)for(o=o.child;o!==null;)o5(o,r),o=o.sibling}function o5(r,o){var a=r.alternate,c=r.flags;switch(r.tag){case 0:case 11:case 14:case 15:if(wl(o,r),lu(r),c&4){try{I0(3,r,r.return),u2(3,r)}catch(K){Gi(r,r.return,K)}try{I0(5,r,r.return)}catch(K){Gi(r,r.return,K)}}break;case 1:wl(o,r),lu(r),c&512&&a!==null&&ug(a,a.return);break;case 5:if(wl(o,r),lu(r),c&512&&a!==null&&ug(a,a.return),r.flags&32){var p=r.stateNode;try{K0(p,"")}catch(K){Gi(r,r.return,K)}}if(c&4&&(p=r.stateNode,p!=null)){var _=r.memoizedProps,x=a!==null?a.memoizedProps:_,T=r.type,C=r.updateQueue;if(r.updateQueue=null,C!==null)try{T==="input"&&_.type==="radio"&&_.name!=null&&Cz(p,_),KT(T,x);var P=KT(T,_);for(x=0;x<C.length;x+=2){var O=C[x],F=C[x+1];O==="style"?Pz(p,F):O==="dangerouslySetInnerHTML"?Iz(p,F):O==="children"?K0(p,F):EA(p,O,F,P)}switch(T){case"input":HT(p,_);break;case"textarea":Az(p,_);break;case"select":var U=p._wrapperState.wasMultiple;p._wrapperState.wasMultiple=!!_.multiple;var Z=_.value;Z!=null?mg(p,!!_.multiple,Z,!1):U!==!!_.multiple&&(_.defaultValue!=null?mg(p,!!_.multiple,_.defaultValue,!0):mg(p,!!_.multiple,_.multiple?[]:"",!1))}p[ov]=_}catch(K){Gi(r,r.return,K)}}break;case 6:if(wl(o,r),lu(r),c&4){if(r.stateNode===null)throw Error(Nt(162));p=r.stateNode,_=r.memoizedProps;try{p.nodeValue=_}catch(K){Gi(r,r.return,K)}}break;case 3:if(wl(o,r),lu(r),c&4&&a!==null&&a.memoizedState.isDehydrated)try{ev(o.containerInfo)}catch(K){Gi(r,r.return,K)}break;case 4:wl(o,r),lu(r);break;case 13:wl(o,r),lu(r),p=r.child,p.flags&8192&&(_=p.memoizedState!==null,p.stateNode.isHidden=_,!_||p.alternate!==null&&p.alternate.memoizedState!==null||(rM=Ki())),c&4&&XD(r);break;case 22:if(O=a!==null&&a.memoizedState!==null,r.mode&1?(ns=(P=ns)||O,wl(o,r),ns=P):wl(o,r),lu(r),c&8192){if(P=r.memoizedState!==null,(r.stateNode.isHidden=P)&&!O&&r.mode&1)for(ln=r,O=r.child;O!==null;){for(F=ln=O;ln!==null;){switch(U=ln,Z=U.child,U.tag){case 0:case 11:case 14:case 15:I0(4,U,U.return);break;case 1:ug(U,U.return);var $=U.stateNode;if(typeof $.componentWillUnmount=="function"){c=U,a=U.return;try{o=c,$.props=o.memoizedProps,$.state=o.memoizedState,$.componentWillUnmount()}catch(K){Gi(c,a,K)}}break;case 5:ug(U,U.return);break;case 22:if(U.memoizedState!==null){YD(F);continue}}Z!==null?(Z.return=U,ln=Z):YD(F)}O=O.sibling}e:for(O=null,F=r;;){if(F.tag===5){if(O===null){O=F;try{p=F.stateNode,P?(_=p.style,typeof _.setProperty=="function"?_.setProperty("display","none","important"):_.display="none"):(T=F.stateNode,C=F.memoizedProps.style,x=C!=null&&C.hasOwnProperty("display")?C.display:null,T.style.display=kz("display",x))}catch(K){Gi(r,r.return,K)}}}else if(F.tag===6){if(O===null)try{F.stateNode.nodeValue=P?"":F.memoizedProps}catch(K){Gi(r,r.return,K)}}else if((F.tag!==22&&F.tag!==23||F.memoizedState===null||F===r)&&F.child!==null){F.child.return=F,F=F.child;continue}if(F===r)break e;for(;F.sibling===null;){if(F.return===null||F.return===r)break e;O===F&&(O=null),F=F.return}O===F&&(O=null),F.sibling.return=F.return,F=F.sibling}}break;case 19:wl(o,r),lu(r),c&4&&XD(r);break;case 21:break;default:wl(o,r),lu(r)}}function lu(r){var o=r.flags;if(o&2){try{e:{for(var a=r.return;a!==null;){if(r5(a)){var c=a;break e}a=a.return}throw Error(Nt(160))}switch(c.tag){case 5:var p=c.stateNode;c.flags&32&&(K0(p,""),c.flags&=-33);var _=ZD(r);CC(r,_,p);break;case 3:case 4:var x=c.stateNode.containerInfo,T=ZD(r);TC(r,T,x);break;default:throw Error(Nt(161))}}catch(C){Gi(r,r.return,C)}r.flags&=-3}o&4096&&(r.flags&=-4097)}function TG(r,o,a){ln=r,s5(r)}function s5(r,o,a){for(var c=(r.mode&1)!==0;ln!==null;){var p=ln,_=p.child;if(p.tag===22&&c){var x=p.memoizedState!==null||Kx;if(!x){var T=p.alternate,C=T!==null&&T.memoizedState!==null||ns;T=Kx;var P=ns;if(Kx=x,(ns=C)&&!P)for(ln=p;ln!==null;)x=ln,C=x.child,x.tag===22&&x.memoizedState!==null?QD(p):C!==null?(C.return=x,ln=C):QD(p);for(;_!==null;)ln=_,s5(_),_=_.sibling;ln=p,Kx=T,ns=P}KD(r)}else p.subtreeFlags&8772&&_!==null?(_.return=p,ln=_):KD(r)}}function KD(r){for(;ln!==null;){var o=ln;if(o.flags&8772){var a=o.alternate;try{if(o.flags&8772)switch(o.tag){case 0:case 11:case 15:ns||u2(5,o);break;case 1:var c=o.stateNode;if(o.flags&4&&!ns)if(a===null)c.componentDidMount();else{var p=o.elementType===o.type?a.memoizedProps:bl(o.type,a.memoizedProps);c.componentDidUpdate(p,a.memoizedState,c.__reactInternalSnapshotBeforeUpdate)}var _=o.updateQueue;_!==null&&DD(o,_,c);break;case 3:var x=o.updateQueue;if(x!==null){if(a=null,o.child!==null)switch(o.child.tag){case 5:a=o.child.stateNode;break;case 1:a=o.child.stateNode}DD(o,x,a)}break;case 5:var T=o.stateNode;if(a===null&&o.flags&4){a=T;var C=o.memoizedProps;switch(o.type){case"button":case"input":case"select":case"textarea":C.autoFocus&&a.focus();break;case"img":C.src&&(a.src=C.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(o.memoizedState===null){var P=o.alternate;if(P!==null){var O=P.memoizedState;if(O!==null){var F=O.dehydrated;F!==null&&ev(F)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Nt(163))}ns||o.flags&512&&EC(o)}catch(U){Gi(o,o.return,U)}}if(o===r){ln=null;break}if(a=o.sibling,a!==null){a.return=o.return,ln=a;break}ln=o.return}}function YD(r){for(;ln!==null;){var o=ln;if(o===r){ln=null;break}var a=o.sibling;if(a!==null){a.return=o.return,ln=a;break}ln=o.return}}function QD(r){for(;ln!==null;){var o=ln;try{switch(o.tag){case 0:case 11:case 15:var a=o.return;try{u2(4,o)}catch(C){Gi(o,a,C)}break;case 1:var c=o.stateNode;if(typeof c.componentDidMount=="function"){var p=o.return;try{c.componentDidMount()}catch(C){Gi(o,p,C)}}var _=o.return;try{EC(o)}catch(C){Gi(o,_,C)}break;case 5:var x=o.return;try{EC(o)}catch(C){Gi(o,x,C)}}}catch(C){Gi(o,o.return,C)}if(o===r){ln=null;break}var T=o.sibling;if(T!==null){T.return=o.return,ln=T;break}ln=o.return}}var CG=Math.ceil,Cb=wc.ReactCurrentDispatcher,tM=wc.ReactCurrentOwner,Oa=wc.ReactCurrentBatchConfig,Pr=0,Io=null,so=null,$o=0,Qs=0,cg=rd(0),fo=0,hv=null,zf=0,c2=0,nM=0,k0=null,Ns=null,rM=0,Pg=1/0,hc=null,Ab=!1,AC=null,Xh=null,Yx=!1,Uh=null,Mb=0,P0=0,MC=null,Lw=-1,Ow=0;function bs(){return Pr&6?Ki():Lw!==-1?Lw:Lw=Ki()}function Kh(r){return r.mode&1?Pr&2&&$o!==0?$o&-$o:uG.transition!==null?(Ow===0&&(Ow=$z()),Ow):(r=Xr,r!==0||(r=window.event,r=r===void 0?16:Kz(r.type)),r):1}function Rl(r,o,a,c){if(50<P0)throw P0=0,MC=null,Error(Nt(185));vv(r,a,c),(!(Pr&2)||r!==Io)&&(r===Io&&(!(Pr&2)&&(c2|=a),fo===4&&zh(r,$o)),Gs(r,c),a===1&&Pr===0&&!(o.mode&1)&&(Pg=Ki()+500,s2&&id()))}function Gs(r,o){var a=r.callbackNode;u$(r,o);var c=hb(r,r===Io?$o:0);if(c===0)a!==null&&aD(a),r.callbackNode=null,r.callbackPriority=0;else if(o=c&-c,r.callbackPriority!==o){if(a!=null&&aD(a),o===1)r.tag===0?lG(JD.bind(null,r)):m4(JD.bind(null,r)),iG(function(){!(Pr&6)&&id()}),a=null;else{switch(Gz(c)){case 1:a=IA;break;case 4:a=Uz;break;case 16:a=cb;break;case 536870912:a=Vz;break;default:a=cb}a=p5(a,a5.bind(null,r))}r.callbackPriority=o,r.callbackNode=a}}function a5(r,o){if(Lw=-1,Ow=0,Pr&6)throw Error(Nt(327));var a=r.callbackNode;if(xg()&&r.callbackNode!==a)return null;var c=hb(r,r===Io?$o:0);if(c===0)return null;if(c&30||c&r.expiredLanes||o)o=Ib(r,c);else{o=c;var p=Pr;Pr|=2;var _=u5();(Io!==r||$o!==o)&&(hc=null,Pg=Ki()+500,Af(r,o));do try{IG();break}catch(T){l5(r,T)}while(1);VA(),Cb.current=_,Pr=p,so!==null?o=0:(Io=null,$o=0,o=fo)}if(o!==0){if(o===2&&(p=tC(r),p!==0&&(c=p,o=IC(r,p))),o===1)throw a=hv,Af(r,0),zh(r,c),Gs(r,Ki()),a;if(o===6)zh(r,c);else{if(p=r.current.alternate,!(c&30)&&!AG(p)&&(o=Ib(r,c),o===2&&(_=tC(r),_!==0&&(c=_,o=IC(r,_))),o===1))throw a=hv,Af(r,0),zh(r,c),Gs(r,Ki()),a;switch(r.finishedWork=p,r.finishedLanes=c,o){case 0:case 1:throw Error(Nt(345));case 2:vf(r,Ns,hc);break;case 3:if(zh(r,c),(c&130023424)===c&&(o=rM+500-Ki(),10<o)){if(hb(r,0)!==0)break;if(p=r.suspendedLanes,(p&c)!==c){bs(),r.pingedLanes|=r.suspendedLanes&p;break}r.timeoutHandle=uC(vf.bind(null,r,Ns,hc),o);break}vf(r,Ns,hc);break;case 4:if(zh(r,c),(c&4194240)===c)break;for(o=r.eventTimes,p=-1;0<c;){var x=31-Pl(c);_=1<<x,x=o[x],x>p&&(p=x),c&=~_}if(c=p,c=Ki()-c,c=(120>c?120:480>c?480:1080>c?1080:1920>c?1920:3e3>c?3e3:4320>c?4320:1960*CG(c/1960))-c,10<c){r.timeoutHandle=uC(vf.bind(null,r,Ns,hc),c);break}vf(r,Ns,hc);break;case 5:vf(r,Ns,hc);break;default:throw Error(Nt(329))}}}return Gs(r,Ki()),r.callbackNode===a?a5.bind(null,r):null}function IC(r,o){var a=k0;return r.current.memoizedState.isDehydrated&&(Af(r,o).flags|=256),r=Ib(r,o),r!==2&&(o=Ns,Ns=a,o!==null&&kC(o)),r}function kC(r){Ns===null?Ns=r:Ns.push.apply(Ns,r)}function AG(r){for(var o=r;;){if(o.flags&16384){var a=o.updateQueue;if(a!==null&&(a=a.stores,a!==null))for(var c=0;c<a.length;c++){var p=a[c],_=p.getSnapshot;p=p.value;try{if(!Dl(_(),p))return!1}catch{return!1}}}if(a=o.child,o.subtreeFlags&16384&&a!==null)a.return=o,o=a;else{if(o===r)break;for(;o.sibling===null;){if(o.return===null||o.return===r)return!0;o=o.return}o.sibling.return=o.return,o=o.sibling}}return!0}function zh(r,o){for(o&=~nM,o&=~c2,r.suspendedLanes|=o,r.pingedLanes&=~o,r=r.expirationTimes;0<o;){var a=31-Pl(o),c=1<<a;r[a]=-1,o&=~c}}function JD(r){if(Pr&6)throw Error(Nt(327));xg();var o=hb(r,0);if(!(o&1))return Gs(r,Ki()),null;var a=Ib(r,o);if(r.tag!==0&&a===2){var c=tC(r);c!==0&&(o=c,a=IC(r,c))}if(a===1)throw a=hv,Af(r,0),zh(r,o),Gs(r,Ki()),a;if(a===6)throw Error(Nt(345));return r.finishedWork=r.current.alternate,r.finishedLanes=o,vf(r,Ns,hc),Gs(r,Ki()),null}function iM(r,o){var a=Pr;Pr|=1;try{return r(o)}finally{Pr=a,Pr===0&&(Pg=Ki()+500,s2&&id())}}function Ff(r){Uh!==null&&Uh.tag===0&&!(Pr&6)&&xg();var o=Pr;Pr|=1;var a=Oa.transition,c=Xr;try{if(Oa.transition=null,Xr=1,r)return r()}finally{Xr=c,Oa.transition=a,Pr=o,!(Pr&6)&&id()}}function oM(){Qs=cg.current,Si(cg)}function Af(r,o){r.finishedWork=null,r.finishedLanes=0;var a=r.timeoutHandle;if(a!==-1&&(r.timeoutHandle=-1,rG(a)),so!==null)for(a=so.return;a!==null;){var c=a;switch(NA(c),c.tag){case 1:c=c.type.childContextTypes,c!=null&&gb();break;case 3:Ig(),Si(Vs),Si(rs),ZA();break;case 5:WA(c);break;case 4:Ig();break;case 13:Si(Oi);break;case 19:Si(Oi);break;case 10:$A(c.type._context);break;case 22:case 23:oM()}a=a.return}if(Io=r,so=r=Yh(r.current,null),$o=Qs=o,fo=0,hv=null,nM=c2=zf=0,Ns=k0=null,Ef!==null){for(o=0;o<Ef.length;o++)if(a=Ef[o],c=a.interleaved,c!==null){a.interleaved=null;var p=c.next,_=a.pending;if(_!==null){var x=_.next;_.next=p,c.next=x}a.pending=c}Ef=null}return r}function l5(r,o){do{var a=so;try{if(VA(),Pw.current=Tb,Eb){for(var c=zi.memoizedState;c!==null;){var p=c.queue;p!==null&&(p.pending=null),c=c.next}Eb=!1}if(Of=0,Mo=ho=zi=null,M0=!1,lv=0,tM.current=null,a===null||a.return===null){fo=1,hv=o,so=null;break}e:{var _=r,x=a.return,T=a,C=o;if(o=$o,T.flags|=32768,C!==null&&typeof C=="object"&&typeof C.then=="function"){var P=C,O=T,F=O.tag;if(!(O.mode&1)&&(F===0||F===11||F===15)){var U=O.alternate;U?(O.updateQueue=U.updateQueue,O.memoizedState=U.memoizedState,O.lanes=U.lanes):(O.updateQueue=null,O.memoizedState=null)}var Z=jD(x);if(Z!==null){Z.flags&=-257,UD(Z,x,T,_,o),Z.mode&1&&ND(_,P,o),o=Z,C=P;var $=o.updateQueue;if($===null){var K=new Set;K.add(C),o.updateQueue=K}else $.add(C);break e}else{if(!(o&1)){ND(_,P,o),sM();break e}C=Error(Nt(426))}}else if(ki&&T.mode&1){var ie=jD(x);if(ie!==null){!(ie.flags&65536)&&(ie.flags|=256),UD(ie,x,T,_,o),jA(kg(C,T));break e}}_=C=kg(C,T),fo!==4&&(fo=2),k0===null?k0=[_]:k0.push(_),_=x;do{switch(_.tag){case 3:_.flags|=65536,o&=-o,_.lanes|=o;var H=H4(_,C,o);RD(_,H);break e;case 1:T=C;var G=_.type,ee=_.stateNode;if(!(_.flags&128)&&(typeof G.getDerivedStateFromError=="function"||ee!==null&&typeof ee.componentDidCatch=="function"&&(Xh===null||!Xh.has(ee)))){_.flags|=65536,o&=-o,_.lanes|=o;var W=q4(_,T,o);RD(_,W);break e}}_=_.return}while(_!==null)}h5(a)}catch(me){o=me,so===a&&a!==null&&(so=a=a.return);continue}break}while(1)}function u5(){var r=Cb.current;return Cb.current=Tb,r===null?Tb:r}function sM(){(fo===0||fo===3||fo===2)&&(fo=4),Io===null||!(zf&268435455)&&!(c2&268435455)||zh(Io,$o)}function Ib(r,o){var a=Pr;Pr|=2;var c=u5();(Io!==r||$o!==o)&&(hc=null,Af(r,o));do try{MG();break}catch(p){l5(r,p)}while(1);if(VA(),Pr=a,Cb.current=c,so!==null)throw Error(Nt(261));return Io=null,$o=0,fo}function MG(){for(;so!==null;)c5(so)}function IG(){for(;so!==null&&!e$();)c5(so)}function c5(r){var o=f5(r.alternate,r,Qs);r.memoizedProps=r.pendingProps,o===null?h5(r):so=o,tM.current=null}function h5(r){var o=r;do{var a=o.alternate;if(r=o.return,o.flags&32768){if(a=bG(a,o),a!==null){a.flags&=32767,so=a;return}if(r!==null)r.flags|=32768,r.subtreeFlags=0,r.deletions=null;else{fo=6,so=null;return}}else if(a=wG(a,o,Qs),a!==null){so=a;return}if(o=o.sibling,o!==null){so=o;return}so=o=r}while(o!==null);fo===0&&(fo=5)}function vf(r,o,a){var c=Xr,p=Oa.transition;try{Oa.transition=null,Xr=1,kG(r,o,a,c)}finally{Oa.transition=p,Xr=c}return null}function kG(r,o,a,c){do xg();while(Uh!==null);if(Pr&6)throw Error(Nt(327));a=r.finishedWork;var p=r.finishedLanes;if(a===null)return null;if(r.finishedWork=null,r.finishedLanes=0,a===r.current)throw Error(Nt(177));r.callbackNode=null,r.callbackPriority=0;var _=a.lanes|a.childLanes;if(c$(r,_),r===Io&&(so=Io=null,$o=0),!(a.subtreeFlags&2064)&&!(a.flags&2064)||Yx||(Yx=!0,p5(cb,function(){return xg(),null})),_=(a.flags&15990)!==0,a.subtreeFlags&15990||_){_=Oa.transition,Oa.transition=null;var x=Xr;Xr=1;var T=Pr;Pr|=4,tM.current=null,EG(r,a),o5(a,r),K$(aC),db=!!sC,aC=sC=null,r.current=a,TG(a),t$(),Pr=T,Xr=x,Oa.transition=_}else r.current=a;if(Yx&&(Yx=!1,Uh=r,Mb=p),_=r.pendingLanes,_===0&&(Xh=null),i$(a.stateNode),Gs(r,Ki()),o!==null)for(c=r.onRecoverableError,a=0;a<o.length;a++)p=o[a],c(p.value,{componentStack:p.stack,digest:p.digest});if(Ab)throw Ab=!1,r=AC,AC=null,r;return Mb&1&&r.tag!==0&&xg(),_=r.pendingLanes,_&1?r===MC?P0++:(P0=0,MC=r):P0=0,id(),null}function xg(){if(Uh!==null){var r=Gz(Mb),o=Oa.transition,a=Xr;try{if(Oa.transition=null,Xr=16>r?16:r,Uh===null)var c=!1;else{if(r=Uh,Uh=null,Mb=0,Pr&6)throw Error(Nt(331));var p=Pr;for(Pr|=4,ln=r.current;ln!==null;){var _=ln,x=_.child;if(ln.flags&16){var T=_.deletions;if(T!==null){for(var C=0;C<T.length;C++){var P=T[C];for(ln=P;ln!==null;){var O=ln;switch(O.tag){case 0:case 11:case 15:I0(8,O,_)}var F=O.child;if(F!==null)F.return=O,ln=F;else for(;ln!==null;){O=ln;var U=O.sibling,Z=O.return;if(n5(O),O===P){ln=null;break}if(U!==null){U.return=Z,ln=U;break}ln=Z}}}var $=_.alternate;if($!==null){var K=$.child;if(K!==null){$.child=null;do{var ie=K.sibling;K.sibling=null,K=ie}while(K!==null)}}ln=_}}if(_.subtreeFlags&2064&&x!==null)x.return=_,ln=x;else e:for(;ln!==null;){if(_=ln,_.flags&2048)switch(_.tag){case 0:case 11:case 15:I0(9,_,_.return)}var H=_.sibling;if(H!==null){H.return=_.return,ln=H;break e}ln=_.return}}var G=r.current;for(ln=G;ln!==null;){x=ln;var ee=x.child;if(x.subtreeFlags&2064&&ee!==null)ee.return=x,ln=ee;else e:for(x=G;ln!==null;){if(T=ln,T.flags&2048)try{switch(T.tag){case 0:case 11:case 15:u2(9,T)}}catch(me){Gi(T,T.return,me)}if(T===x){ln=null;break e}var W=T.sibling;if(W!==null){W.return=T.return,ln=W;break e}ln=T.return}}if(Pr=p,id(),gu&&typeof gu.onPostCommitFiberRoot=="function")try{gu.onPostCommitFiberRoot(t2,r)}catch{}c=!0}return c}finally{Xr=a,Oa.transition=o}}return!1}function eL(r,o,a){o=kg(a,o),o=H4(r,o,1),r=Zh(r,o,1),o=bs(),r!==null&&(vv(r,1,o),Gs(r,o))}function Gi(r,o,a){if(r.tag===3)eL(r,r,a);else for(;o!==null;){if(o.tag===3){eL(o,r,a);break}else if(o.tag===1){var c=o.stateNode;if(typeof o.type.getDerivedStateFromError=="function"||typeof c.componentDidCatch=="function"&&(Xh===null||!Xh.has(c))){r=kg(a,r),r=q4(o,r,1),o=Zh(o,r,1),r=bs(),o!==null&&(vv(o,1,r),Gs(o,r));break}}o=o.return}}function PG(r,o,a){var c=r.pingCache;c!==null&&c.delete(o),o=bs(),r.pingedLanes|=r.suspendedLanes&a,Io===r&&($o&a)===a&&(fo===4||fo===3&&($o&130023424)===$o&&500>Ki()-rM?Af(r,0):nM|=a),Gs(r,o)}function d5(r,o){o===0&&(r.mode&1?(o=Ux,Ux<<=1,!(Ux&130023424)&&(Ux=4194304)):o=1);var a=bs();r=vc(r,o),r!==null&&(vv(r,o,a),Gs(r,a))}function RG(r){var o=r.memoizedState,a=0;o!==null&&(a=o.retryLane),d5(r,a)}function DG(r,o){var a=0;switch(r.tag){case 13:var c=r.stateNode,p=r.memoizedState;p!==null&&(a=p.retryLane);break;case 19:c=r.stateNode;break;default:throw Error(Nt(314))}c!==null&&c.delete(o),d5(r,a)}var f5;f5=function(r,o,a){if(r!==null)if(r.memoizedProps!==o.pendingProps||Vs.current)js=!0;else{if(!(r.lanes&a)&&!(o.flags&128))return js=!1,xG(r,o,a);js=!!(r.flags&131072)}else js=!1,ki&&o.flags&1048576&&g4(o,vb,o.index);switch(o.lanes=0,o.tag){case 2:var c=o.type;Dw(r,o),r=o.pendingProps;var p=Cg(o,rs.current);vg(o,a),p=KA(null,o,c,r,p,a);var _=YA();return o.flags|=1,typeof p=="object"&&p!==null&&typeof p.render=="function"&&p.$$typeof===void 0?(o.tag=1,o.memoizedState=null,o.updateQueue=null,$s(c)?(_=!0,yb(o)):_=!1,o.memoizedState=p.state!==null&&p.state!==void 0?p.state:null,HA(o),p.updater=a2,o.stateNode=p,p._reactInternals=o,gC(o,c,r,a),o=vC(null,o,c,!0,_,a)):(o.tag=0,ki&&_&&BA(o),xs(null,o,p,a),o=o.child),o;case 16:c=o.elementType;e:{switch(Dw(r,o),r=o.pendingProps,p=c._init,c=p(c._payload),o.type=c,p=o.tag=OG(c),r=bl(c,r),p){case 0:o=_C(null,o,c,r,a);break e;case 1:o=GD(null,o,c,r,a);break e;case 11:o=VD(null,o,c,r,a);break e;case 14:o=$D(null,o,c,bl(c.type,r),a);break e}throw Error(Nt(306,c,""))}return o;case 0:return c=o.type,p=o.pendingProps,p=o.elementType===c?p:bl(c,p),_C(r,o,c,p,a);case 1:return c=o.type,p=o.pendingProps,p=o.elementType===c?p:bl(c,p),GD(r,o,c,p,a);case 3:e:{if(K4(o),r===null)throw Error(Nt(387));c=o.pendingProps,_=o.memoizedState,p=_.element,x4(r,o),bb(o,c,null,a);var x=o.memoizedState;if(c=x.element,_.isDehydrated)if(_={element:c,isDehydrated:!1,cache:x.cache,pendingSuspenseBoundaries:x.pendingSuspenseBoundaries,transitions:x.transitions},o.updateQueue.baseState=_,o.memoizedState=_,o.flags&256){p=kg(Error(Nt(423)),o),o=HD(r,o,c,a,p);break e}else if(c!==p){p=kg(Error(Nt(424)),o),o=HD(r,o,c,a,p);break e}else for(Js=Wh(o.stateNode.containerInfo.firstChild),ea=o,ki=!0,Cl=null,a=E4(o,null,c,a),o.child=a;a;)a.flags=a.flags&-3|4096,a=a.sibling;else{if(Ag(),c===p){o=xc(r,o,a);break e}xs(r,o,c,a)}o=o.child}return o;case 5:return T4(o),r===null&&fC(o),c=o.type,p=o.pendingProps,_=r!==null?r.memoizedProps:null,x=p.children,lC(c,p)?x=null:_!==null&&lC(c,_)&&(o.flags|=32),X4(r,o),xs(r,o,x,a),o.child;case 6:return r===null&&fC(o),null;case 13:return Y4(r,o,a);case 4:return qA(o,o.stateNode.containerInfo),c=o.pendingProps,r===null?o.child=Mg(o,null,c,a):xs(r,o,c,a),o.child;case 11:return c=o.type,p=o.pendingProps,p=o.elementType===c?p:bl(c,p),VD(r,o,c,p,a);case 7:return xs(r,o,o.pendingProps,a),o.child;case 8:return xs(r,o,o.pendingProps.children,a),o.child;case 12:return xs(r,o,o.pendingProps.children,a),o.child;case 10:e:{if(c=o.type._context,p=o.pendingProps,_=o.memoizedProps,x=p.value,gi(xb,c._currentValue),c._currentValue=x,_!==null)if(Dl(_.value,x)){if(_.children===p.children&&!Vs.current){o=xc(r,o,a);break e}}else for(_=o.child,_!==null&&(_.return=o);_!==null;){var T=_.dependencies;if(T!==null){x=_.child;for(var C=T.firstContext;C!==null;){if(C.context===c){if(_.tag===1){C=mc(-1,a&-a),C.tag=2;var P=_.updateQueue;if(P!==null){P=P.shared;var O=P.pending;O===null?C.next=C:(C.next=O.next,O.next=C),P.pending=C}}_.lanes|=a,C=_.alternate,C!==null&&(C.lanes|=a),pC(_.return,a,o),T.lanes|=a;break}C=C.next}}else if(_.tag===10)x=_.type===o.type?null:_.child;else if(_.tag===18){if(x=_.return,x===null)throw Error(Nt(341));x.lanes|=a,T=x.alternate,T!==null&&(T.lanes|=a),pC(x,a,o),x=_.sibling}else x=_.child;if(x!==null)x.return=_;else for(x=_;x!==null;){if(x===o){x=null;break}if(_=x.sibling,_!==null){_.return=x.return,x=_;break}x=x.return}_=x}xs(r,o,p.children,a),o=o.child}return o;case 9:return p=o.type,c=o.pendingProps.children,vg(o,a),p=Fa(p),c=c(p),o.flags|=1,xs(r,o,c,a),o.child;case 14:return c=o.type,p=bl(c,o.pendingProps),p=bl(c.type,p),$D(r,o,c,p,a);case 15:return W4(r,o,o.type,o.pendingProps,a);case 17:return c=o.type,p=o.pendingProps,p=o.elementType===c?p:bl(c,p),Dw(r,o),o.tag=1,$s(c)?(r=!0,yb(o)):r=!1,vg(o,a),b4(o,c,p),gC(o,c,p,a),vC(null,o,c,!0,r,a);case 19:return Q4(r,o,a);case 22:return Z4(r,o,a)}throw Error(Nt(156,o.tag))};function p5(r,o){return jz(r,o)}function LG(r,o,a,c){this.tag=r,this.key=a,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=c,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function La(r,o,a,c){return new LG(r,o,a,c)}function aM(r){return r=r.prototype,!(!r||!r.isReactComponent)}function OG(r){if(typeof r=="function")return aM(r)?1:0;if(r!=null){if(r=r.$$typeof,r===CA)return 11;if(r===AA)return 14}return 2}function Yh(r,o){var a=r.alternate;return a===null?(a=La(r.tag,o,r.key,r.mode),a.elementType=r.elementType,a.type=r.type,a.stateNode=r.stateNode,a.alternate=r,r.alternate=a):(a.pendingProps=o,a.type=r.type,a.flags=0,a.subtreeFlags=0,a.deletions=null),a.flags=r.flags&14680064,a.childLanes=r.childLanes,a.lanes=r.lanes,a.child=r.child,a.memoizedProps=r.memoizedProps,a.memoizedState=r.memoizedState,a.updateQueue=r.updateQueue,o=r.dependencies,a.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},a.sibling=r.sibling,a.index=r.index,a.ref=r.ref,a}function zw(r,o,a,c,p,_){var x=2;if(c=r,typeof r=="function")aM(r)&&(x=1);else if(typeof r=="string")x=5;else e:switch(r){case eg:return Mf(a.children,p,_,o);case TA:x=8,p|=8;break;case jT:return r=La(12,a,o,p|2),r.elementType=jT,r.lanes=_,r;case UT:return r=La(13,a,o,p),r.elementType=UT,r.lanes=_,r;case VT:return r=La(19,a,o,p),r.elementType=VT,r.lanes=_,r;case Sz:return h2(a,p,_,o);default:if(typeof r=="object"&&r!==null)switch(r.$$typeof){case wz:x=10;break e;case bz:x=9;break e;case CA:x=11;break e;case AA:x=14;break e;case Dh:x=16,c=null;break e}throw Error(Nt(130,r==null?r:typeof r,""))}return o=La(x,a,o,p),o.elementType=r,o.type=c,o.lanes=_,o}function Mf(r,o,a,c){return r=La(7,r,c,o),r.lanes=a,r}function h2(r,o,a,c){return r=La(22,r,c,o),r.elementType=Sz,r.lanes=a,r.stateNode={isHidden:!1},r}function uT(r,o,a){return r=La(6,r,null,o),r.lanes=a,r}function cT(r,o,a){return o=La(4,r.children!==null?r.children:[],r.key,o),o.lanes=a,o.stateNode={containerInfo:r.containerInfo,pendingChildren:null,implementation:r.implementation},o}function zG(r,o,a,c,p){this.tag=o,this.containerInfo=r,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=GE(0),this.expirationTimes=GE(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=GE(0),this.identifierPrefix=c,this.onRecoverableError=p,this.mutableSourceEagerHydrationData=null}function lM(r,o,a,c,p,_,x,T,C){return r=new zG(r,o,a,T,C),o===1?(o=1,_===!0&&(o|=8)):o=0,_=La(3,null,null,o),r.current=_,_.stateNode=r,_.memoizedState={element:c,isDehydrated:a,cache:null,transitions:null,pendingSuspenseBoundaries:null},HA(_),r}function FG(r,o,a){var c=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Jm,key:c==null?null:""+c,children:r,containerInfo:o,implementation:a}}function m5(r){if(!r)return td;r=r._reactInternals;e:{if(Vf(r)!==r||r.tag!==1)throw Error(Nt(170));var o=r;do{switch(o.tag){case 3:o=o.stateNode.context;break e;case 1:if($s(o.type)){o=o.stateNode.__reactInternalMemoizedMergedChildContext;break e}}o=o.return}while(o!==null);throw Error(Nt(171))}if(r.tag===1){var a=r.type;if($s(a))return p4(r,a,o)}return o}function g5(r,o,a,c,p,_,x,T,C){return r=lM(a,c,!0,r,p,_,x,T,C),r.context=m5(null),a=r.current,c=bs(),p=Kh(a),_=mc(c,p),_.callback=o??null,Zh(a,_,p),r.current.lanes=p,vv(r,p,c),Gs(r,c),r}function d2(r,o,a,c){var p=o.current,_=bs(),x=Kh(p);return a=m5(a),o.context===null?o.context=a:o.pendingContext=a,o=mc(_,x),o.payload={element:r},c=c===void 0?null:c,c!==null&&(o.callback=c),r=Zh(p,o,x),r!==null&&(Rl(r,p,x,_),kw(r,p,x)),x}function kb(r){if(r=r.current,!r.child)return null;switch(r.child.tag){case 5:return r.child.stateNode;default:return r.child.stateNode}}function tL(r,o){if(r=r.memoizedState,r!==null&&r.dehydrated!==null){var a=r.retryLane;r.retryLane=a!==0&&a<o?a:o}}function uM(r,o){tL(r,o),(r=r.alternate)&&tL(r,o)}function BG(){return null}var y5=typeof reportError=="function"?reportError:function(r){console.error(r)};function cM(r){this._internalRoot=r}f2.prototype.render=cM.prototype.render=function(r){var o=this._internalRoot;if(o===null)throw Error(Nt(409));d2(r,o,null,null)};f2.prototype.unmount=cM.prototype.unmount=function(){var r=this._internalRoot;if(r!==null){this._internalRoot=null;var o=r.containerInfo;Ff(function(){d2(null,r,null,null)}),o[_c]=null}};function f2(r){this._internalRoot=r}f2.prototype.unstable_scheduleHydration=function(r){if(r){var o=Wz();r={blockedOn:null,target:r,priority:o};for(var a=0;a<Oh.length&&o!==0&&o<Oh[a].priority;a++);Oh.splice(a,0,r),a===0&&Xz(r)}};function hM(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11)}function p2(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11&&(r.nodeType!==8||r.nodeValue!==" react-mount-point-unstable "))}function nL(){}function NG(r,o,a,c,p){if(p){if(typeof c=="function"){var _=c;c=function(){var P=kb(x);_.call(P)}}var x=g5(o,c,r,0,null,!1,!1,"",nL);return r._reactRootContainer=x,r[_c]=x.current,rv(r.nodeType===8?r.parentNode:r),Ff(),x}for(;p=r.lastChild;)r.removeChild(p);if(typeof c=="function"){var T=c;c=function(){var P=kb(C);T.call(P)}}var C=lM(r,0,!1,null,null,!1,!1,"",nL);return r._reactRootContainer=C,r[_c]=C.current,rv(r.nodeType===8?r.parentNode:r),Ff(function(){d2(o,C,a,c)}),C}function m2(r,o,a,c,p){var _=a._reactRootContainer;if(_){var x=_;if(typeof p=="function"){var T=p;p=function(){var C=kb(x);T.call(C)}}d2(o,x,r,p)}else x=NG(a,o,r,p,c);return kb(x)}Hz=function(r){switch(r.tag){case 3:var o=r.stateNode;if(o.current.memoizedState.isDehydrated){var a=p0(o.pendingLanes);a!==0&&(kA(o,a|1),Gs(o,Ki()),!(Pr&6)&&(Pg=Ki()+500,id()))}break;case 13:Ff(function(){var c=vc(r,1);if(c!==null){var p=bs();Rl(c,r,1,p)}}),uM(r,1)}};PA=function(r){if(r.tag===13){var o=vc(r,134217728);if(o!==null){var a=bs();Rl(o,r,134217728,a)}uM(r,134217728)}};qz=function(r){if(r.tag===13){var o=Kh(r),a=vc(r,o);if(a!==null){var c=bs();Rl(a,r,o,c)}uM(r,o)}};Wz=function(){return Xr};Zz=function(r,o){var a=Xr;try{return Xr=r,o()}finally{Xr=a}};QT=function(r,o,a){switch(o){case"input":if(HT(r,a),o=a.name,a.type==="radio"&&o!=null){for(a=r;a.parentNode;)a=a.parentNode;for(a=a.querySelectorAll("input[name="+JSON.stringify(""+o)+'][type="radio"]'),o=0;o<a.length;o++){var c=a[o];if(c!==r&&c.form===r.form){var p=o2(c);if(!p)throw Error(Nt(90));Tz(c),HT(c,p)}}}break;case"textarea":Az(r,a);break;case"select":o=a.value,o!=null&&mg(r,!!a.multiple,o,!1)}};Lz=iM;Oz=Ff;var jG={usingClientEntryPoint:!1,Events:[wv,ig,o2,Rz,Dz,iM]},Q_={findFiberByHostInstance:Sf,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},UG={bundleType:Q_.bundleType,version:Q_.version,rendererPackageName:Q_.rendererPackageName,rendererConfig:Q_.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:wc.ReactCurrentDispatcher,findHostInstanceByFiber:function(r){return r=Bz(r),r===null?null:r.stateNode},findFiberByHostInstance:Q_.findFiberByHostInstance||BG,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Qx=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Qx.isDisabled&&Qx.supportsFiber)try{t2=Qx.inject(UG),gu=Qx}catch{}}na.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=jG;na.createPortal=function(r,o){var a=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!hM(o))throw Error(Nt(200));return FG(r,o,null,a)};na.createRoot=function(r,o){if(!hM(r))throw Error(Nt(299));var a=!1,c="",p=y5;return o!=null&&(o.unstable_strictMode===!0&&(a=!0),o.identifierPrefix!==void 0&&(c=o.identifierPrefix),o.onRecoverableError!==void 0&&(p=o.onRecoverableError)),o=lM(r,1,!1,null,null,a,!1,c,p),r[_c]=o.current,rv(r.nodeType===8?r.parentNode:r),new cM(o)};na.findDOMNode=function(r){if(r==null)return null;if(r.nodeType===1)return r;var o=r._reactInternals;if(o===void 0)throw typeof r.render=="function"?Error(Nt(188)):(r=Object.keys(r).join(","),Error(Nt(268,r)));return r=Bz(o),r=r===null?null:r.stateNode,r};na.flushSync=function(r){return Ff(r)};na.hydrate=function(r,o,a){if(!p2(o))throw Error(Nt(200));return m2(null,r,o,!0,a)};na.hydrateRoot=function(r,o,a){if(!hM(r))throw Error(Nt(405));var c=a!=null&&a.hydratedSources||null,p=!1,_="",x=y5;if(a!=null&&(a.unstable_strictMode===!0&&(p=!0),a.identifierPrefix!==void 0&&(_=a.identifierPrefix),a.onRecoverableError!==void 0&&(x=a.onRecoverableError)),o=g5(o,null,r,1,a??null,p,!1,_,x),r[_c]=o.current,rv(r),c)for(r=0;r<c.length;r++)a=c[r],p=a._getVersion,p=p(a._source),o.mutableSourceEagerHydrationData==null?o.mutableSourceEagerHydrationData=[a,p]:o.mutableSourceEagerHydrationData.push(a,p);return new f2(o)};na.render=function(r,o,a){if(!p2(o))throw Error(Nt(200));return m2(null,r,o,!1,a)};na.unmountComponentAtNode=function(r){if(!p2(r))throw Error(Nt(40));return r._reactRootContainer?(Ff(function(){m2(null,null,r,!1,function(){r._reactRootContainer=null,r[_c]=null})}),!0):!1};na.unstable_batchedUpdates=iM;na.unstable_renderSubtreeIntoContainer=function(r,o,a,c){if(!p2(a))throw Error(Nt(200));if(r==null||r._reactInternals===void 0)throw Error(Nt(38));return m2(r,o,a,!1,c)};na.version="18.2.0-next-9e3b772b8-20220608";function _5(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(_5)}catch(r){console.error(r)}}_5(),gz.exports=na;var v5=gz.exports,x5={exports:{}},w5={};/**
 * @license React
 * use-sync-external-store-shim.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Rg=_e;function VG(r,o){return r===o&&(r!==0||1/r===1/o)||r!==r&&o!==o}var $G=typeof Object.is=="function"?Object.is:VG,GG=Rg.useState,HG=Rg.useEffect,qG=Rg.useLayoutEffect,WG=Rg.useDebugValue;function ZG(r,o){var a=o(),c=GG({inst:{value:a,getSnapshot:o}}),p=c[0].inst,_=c[1];return qG(function(){p.value=a,p.getSnapshot=o,hT(p)&&_({inst:p})},[r,a,o]),HG(function(){return hT(p)&&_({inst:p}),r(function(){hT(p)&&_({inst:p})})},[r]),WG(a),a}function hT(r){var o=r.getSnapshot;r=r.value;try{var a=o();return!$G(r,a)}catch{return!0}}function XG(r,o){return o()}var KG=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?XG:ZG;w5.useSyncExternalStore=Rg.useSyncExternalStore!==void 0?Rg.useSyncExternalStore:KG;x5.exports=w5;var YG=x5.exports;const b5=YG.useSyncExternalStore,rL=_e.createContext(void 0),S5=_e.createContext(!1);function E5(r,o){return r||(o&&typeof window<"u"?(window.ReactQueryClientContext||(window.ReactQueryClientContext=rL),window.ReactQueryClientContext):rL)}const dM=({context:r}={})=>{const o=_e.useContext(E5(r,_e.useContext(S5)));if(!o)throw new Error("No QueryClient set, use QueryClientProvider to set one");return o},QG=({client:r,children:o,context:a,contextSharing:c=!1})=>{_e.useEffect(()=>(r.mount(),()=>{r.unmount()}),[r]);const p=E5(a,c);return _e.createElement(S5.Provider,{value:!a&&c},_e.createElement(p.Provider,{value:r},o))},T5=_e.createContext(!1),JG=()=>_e.useContext(T5);T5.Provider;function eH(){let r=!1;return{clearReset:()=>{r=!1},reset:()=>{r=!0},isReset:()=>r}}const tH=_e.createContext(eH()),nH=()=>_e.useContext(tH);function C5(r,o){return typeof r=="function"?r(...o):!!r}const rH=(r,o)=>{(r.suspense||r.useErrorBoundary)&&(o.isReset()||(r.retryOnMount=!1))},iH=r=>{_e.useEffect(()=>{r.clearReset()},[r])},oH=({result:r,errorResetBoundary:o,useErrorBoundary:a,query:c})=>r.isError&&!o.isReset()&&!r.isFetching&&C5(a,[r.error,c]),sH=r=>{r.suspense&&typeof r.staleTime!="number"&&(r.staleTime=1e3)},aH=(r,o)=>r.isLoading&&r.isFetching&&!o,lH=(r,o,a)=>(r==null?void 0:r.suspense)&&aH(o,a),uH=(r,o,a)=>o.fetchOptimistic(r).then(({data:c})=>{r.onSuccess==null||r.onSuccess(c),r.onSettled==null||r.onSettled(c,null)}).catch(c=>{a.clearReset(),r.onError==null||r.onError(c),r.onSettled==null||r.onSettled(void 0,c)});function cH(r,o){const a=dM({context:r.context}),c=JG(),p=nH(),_=a.defaultQueryOptions(r);_._optimisticResults=c?"isRestoring":"optimistic",_.onError&&(_.onError=Hi.batchCalls(_.onError)),_.onSuccess&&(_.onSuccess=Hi.batchCalls(_.onSuccess)),_.onSettled&&(_.onSettled=Hi.batchCalls(_.onSettled)),sH(_),rH(_,p),iH(p);const[x]=_e.useState(()=>new o(a,_)),T=x.getOptimisticResult(_);if(b5(_e.useCallback(C=>{const P=c?()=>{}:x.subscribe(Hi.batchCalls(C));return x.updateResult(),P},[x,c]),()=>x.getCurrentResult(),()=>x.getCurrentResult()),_e.useEffect(()=>{x.setOptions(_,{listeners:!1})},[_,x]),lH(_,T,c))throw uH(_,x,p);if(oH({result:T,errorResetBoundary:p,useErrorBoundary:_.useErrorBoundary,query:x.getCurrentQuery()}))throw T.error;return _.notifyOnChangeProps?T:x.trackResult(T)}function fM(r,o,a){const c=h0(r,o,a);return cH(c,O9)}function hH(r,o,a){const c=w9(r,o,a),p=dM({context:c.context}),[_]=_e.useState(()=>new B9(p,c));_e.useEffect(()=>{_.setOptions(c)},[_,c]);const x=b5(_e.useCallback(C=>_.subscribe(Hi.batchCalls(C)),[_]),()=>_.getCurrentResult(),()=>_.getCurrentResult()),T=_e.useCallback((C,P)=>{_.mutate(C,P).catch(dH)},[_]);if(x.error&&C5(_.options.useErrorBoundary,[x.error]))throw x.error;return{...x,mutate:T,mutateAsync:x.mutate}}function dH(){}var PC={},g0,iL=v5;g0=PC.createRoot=iL.createRoot,PC.hydrateRoot=iL.hydrateRoot;var A5={},M5={exports:{}};(function(r){var o=function(a){var c=Object.prototype,p=c.hasOwnProperty,_=Object.defineProperty||function(we,Q,ce){we[Q]=ce.value},x,T=typeof Symbol=="function"?Symbol:{},C=T.iterator||"@@iterator",P=T.asyncIterator||"@@asyncIterator",O=T.toStringTag||"@@toStringTag";function F(we,Q,ce){return Object.defineProperty(we,Q,{value:ce,enumerable:!0,configurable:!0,writable:!0}),we[Q]}try{F({},"")}catch{F=function(Q,ce,De){return Q[ce]=De}}function U(we,Q,ce,De){var He=Q&&Q.prototype instanceof ee?Q:ee,$e=Object.create(He.prototype),xt=new zt(De||[]);return _($e,"_invoke",{value:Ue(we,ce,xt)}),$e}a.wrap=U;function Z(we,Q,ce){try{return{type:"normal",arg:we.call(Q,ce)}}catch(De){return{type:"throw",arg:De}}}var $="suspendedStart",K="suspendedYield",ie="executing",H="completed",G={};function ee(){}function W(){}function me(){}var de={};F(de,C,function(){return this});var he=Object.getPrototypeOf,se=he&&he(he(dt([])));se&&se!==c&&p.call(se,C)&&(de=se);var q=me.prototype=ee.prototype=Object.create(de);W.prototype=me,_(q,"constructor",{value:me,configurable:!0}),_(me,"constructor",{value:W,configurable:!0}),W.displayName=F(me,O,"GeneratorFunction");function Se(we){["next","throw","return"].forEach(function(Q){F(we,Q,function(ce){return this._invoke(Q,ce)})})}a.isGeneratorFunction=function(we){var Q=typeof we=="function"&&we.constructor;return Q?Q===W||(Q.displayName||Q.name)==="GeneratorFunction":!1},a.mark=function(we){return Object.setPrototypeOf?Object.setPrototypeOf(we,me):(we.__proto__=me,F(we,O,"GeneratorFunction")),we.prototype=Object.create(q),we},a.awrap=function(we){return{__await:we}};function ze(we,Q){function ce($e,xt,ge,Pt){var ot=Z(we[$e],we,xt);if(ot.type==="throw")Pt(ot.arg);else{var Dn=ot.arg,$n=Dn.value;return $n&&typeof $n=="object"&&p.call($n,"__await")?Q.resolve($n.__await).then(function(Ln){ce("next",Ln,ge,Pt)},function(Ln){ce("throw",Ln,ge,Pt)}):Q.resolve($n).then(function(Ln){Dn.value=Ln,ge(Dn)},function(Ln){return ce("throw",Ln,ge,Pt)})}}var De;function He($e,xt){function ge(){return new Q(function(Pt,ot){ce($e,xt,Pt,ot)})}return De=De?De.then(ge,ge):ge()}_(this,"_invoke",{value:He})}Se(ze.prototype),F(ze.prototype,P,function(){return this}),a.AsyncIterator=ze,a.async=function(we,Q,ce,De,He){He===void 0&&(He=Promise);var $e=new ze(U(we,Q,ce,De),He);return a.isGeneratorFunction(Q)?$e:$e.next().then(function(xt){return xt.done?xt.value:$e.next()})};function Ue(we,Q,ce){var De=$;return function($e,xt){if(De===ie)throw new Error("Generator is already running");if(De===H){if($e==="throw")throw xt;return Te()}for(ce.method=$e,ce.arg=xt;;){var ge=ce.delegate;if(ge){var Pt=Be(ge,ce);if(Pt){if(Pt===G)continue;return Pt}}if(ce.method==="next")ce.sent=ce._sent=ce.arg;else if(ce.method==="throw"){if(De===$)throw De=H,ce.arg;ce.dispatchException(ce.arg)}else ce.method==="return"&&ce.abrupt("return",ce.arg);De=ie;var ot=Z(we,Q,ce);if(ot.type==="normal"){if(De=ce.done?H:K,ot.arg===G)continue;return{value:ot.arg,done:ce.done}}else ot.type==="throw"&&(De=H,ce.method="throw",ce.arg=ot.arg)}}}function Be(we,Q){var ce=Q.method,De=we.iterator[ce];if(De===x)return Q.delegate=null,ce==="throw"&&we.iterator.return&&(Q.method="return",Q.arg=x,Be(we,Q),Q.method==="throw")||ce!=="return"&&(Q.method="throw",Q.arg=new TypeError("The iterator does not provide a '"+ce+"' method")),G;var He=Z(De,we.iterator,Q.arg);if(He.type==="throw")return Q.method="throw",Q.arg=He.arg,Q.delegate=null,G;var $e=He.arg;if(!$e)return Q.method="throw",Q.arg=new TypeError("iterator result is not an object"),Q.delegate=null,G;if($e.done)Q[we.resultName]=$e.value,Q.next=we.nextLoc,Q.method!=="return"&&(Q.method="next",Q.arg=x);else return $e;return Q.delegate=null,G}Se(q),F(q,O,"Generator"),F(q,C,function(){return this}),F(q,"toString",function(){return"[object Generator]"});function rt(we){var Q={tryLoc:we[0]};1 in we&&(Q.catchLoc=we[1]),2 in we&&(Q.finallyLoc=we[2],Q.afterLoc=we[3]),this.tryEntries.push(Q)}function _t(we){var Q=we.completion||{};Q.type="normal",delete Q.arg,we.completion=Q}function zt(we){this.tryEntries=[{tryLoc:"root"}],we.forEach(rt,this),this.reset(!0)}a.keys=function(we){var Q=Object(we),ce=[];for(var De in Q)ce.push(De);return ce.reverse(),function He(){for(;ce.length;){var $e=ce.pop();if($e in Q)return He.value=$e,He.done=!1,He}return He.done=!0,He}};function dt(we){if(we){var Q=we[C];if(Q)return Q.call(we);if(typeof we.next=="function")return we;if(!isNaN(we.length)){var ce=-1,De=function He(){for(;++ce<we.length;)if(p.call(we,ce))return He.value=we[ce],He.done=!1,He;return He.value=x,He.done=!0,He};return De.next=De}}return{next:Te}}a.values=dt;function Te(){return{value:x,done:!0}}return zt.prototype={constructor:zt,reset:function(we){if(this.prev=0,this.next=0,this.sent=this._sent=x,this.done=!1,this.delegate=null,this.method="next",this.arg=x,this.tryEntries.forEach(_t),!we)for(var Q in this)Q.charAt(0)==="t"&&p.call(this,Q)&&!isNaN(+Q.slice(1))&&(this[Q]=x)},stop:function(){this.done=!0;var we=this.tryEntries[0],Q=we.completion;if(Q.type==="throw")throw Q.arg;return this.rval},dispatchException:function(we){if(this.done)throw we;var Q=this;function ce(Pt,ot){return $e.type="throw",$e.arg=we,Q.next=Pt,ot&&(Q.method="next",Q.arg=x),!!ot}for(var De=this.tryEntries.length-1;De>=0;--De){var He=this.tryEntries[De],$e=He.completion;if(He.tryLoc==="root")return ce("end");if(He.tryLoc<=this.prev){var xt=p.call(He,"catchLoc"),ge=p.call(He,"finallyLoc");if(xt&&ge){if(this.prev<He.catchLoc)return ce(He.catchLoc,!0);if(this.prev<He.finallyLoc)return ce(He.finallyLoc)}else if(xt){if(this.prev<He.catchLoc)return ce(He.catchLoc,!0)}else if(ge){if(this.prev<He.finallyLoc)return ce(He.finallyLoc)}else throw new Error("try statement without catch or finally")}}},abrupt:function(we,Q){for(var ce=this.tryEntries.length-1;ce>=0;--ce){var De=this.tryEntries[ce];if(De.tryLoc<=this.prev&&p.call(De,"finallyLoc")&&this.prev<De.finallyLoc){var He=De;break}}He&&(we==="break"||we==="continue")&&He.tryLoc<=Q&&Q<=He.finallyLoc&&(He=null);var $e=He?He.completion:{};return $e.type=we,$e.arg=Q,He?(this.method="next",this.next=He.finallyLoc,G):this.complete($e)},complete:function(we,Q){if(we.type==="throw")throw we.arg;return we.type==="break"||we.type==="continue"?this.next=we.arg:we.type==="return"?(this.rval=this.arg=we.arg,this.method="return",this.next="end"):we.type==="normal"&&Q&&(this.next=Q),G},finish:function(we){for(var Q=this.tryEntries.length-1;Q>=0;--Q){var ce=this.tryEntries[Q];if(ce.finallyLoc===we)return this.complete(ce.completion,ce.afterLoc),_t(ce),G}},catch:function(we){for(var Q=this.tryEntries.length-1;Q>=0;--Q){var ce=this.tryEntries[Q];if(ce.tryLoc===we){var De=ce.completion;if(De.type==="throw"){var He=De.arg;_t(ce)}return He}}throw new Error("illegal catch attempt")},delegateYield:function(we,Q,ce){return this.delegate={iterator:dt(we),resultName:Q,nextLoc:ce},this.method==="next"&&(this.arg=x),G}},a}(r.exports);try{regeneratorRuntime=o}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=o:Function("r","regeneratorRuntime = r")(o)}})(M5);var fH=M5.exports;(function(r){var o=fH;function a($,K,ie,H,G,ee,W){try{var me=$[ee](W),de=me.value}catch(he){return void ie(he)}me.done?K(de):Promise.resolve(de).then(H,G)}function c($){return function(){var K=this,ie=arguments;return new Promise(function(H,G){var ee=$.apply(K,ie);function W(de){a(ee,H,G,W,me,"next",de)}function me(de){a(ee,H,G,W,me,"throw",de)}W(void 0)})}}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var p=!1,_=null,x="en",T=null,C=null,P="https://maps.googleapis.com/maps/api/geocode/json";function O($){var K=arguments.length>1&&arguments[1]!==void 0&&arguments[1];p&&(K?console.warn($):console.log($))}function F($){return U.apply(this,arguments)}function U(){return(U=c(o.mark(function $(K){var ie,H;return o.wrap(function(G){for(;;)switch(G.prev=G.next){case 0:return G.next=2,fetch(K).catch(function(){return Promise.reject(new Error("Error fetching data"))});case 2:return ie=G.sent,G.next=5,ie.json().catch(function(){return O("Error parsing server response"),Promise.reject(new Error("Error parsing server response"))});case 5:if((H=G.sent).status!=="OK"){G.next=9;break}return O(H),G.abrupt("return",H);case 9:return O("".concat(H.error_message,`.
Server returned status code `).concat(H.status),!0),G.abrupt("return",Promise.reject(new Error("".concat(H.error_message,`.
Server returned status code `).concat(H.status))));case 11:case"end":return G.stop()}},$)}))).apply(this,arguments)}var Z={setApiKey:function($){_=$},setLanguage:function($){x=$},setRegion:function($){T=$},setLocationType:function($){C=$},enableDebug:function(){var $=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0];p=$},fromLatLng:function($,K,ie,H,G,ee){return c(o.mark(function W(){var me,de;return o.wrap(function(he){for(;;)switch(he.prev=he.next){case 0:if($&&K){he.next=3;break}return O("Provided coordinates are invalid",!0),he.abrupt("return",Promise.reject(new Error("Provided coordinates are invalid")));case 3:return me="".concat($,",").concat(K),de="".concat(P,"?latlng=").concat(encodeURIComponent(me)),(ie||_)&&(de+="&key=".concat(_=ie||_)),(H||x)&&(de+="&language=".concat(x=H||x)),(G||T)&&(T=G||T,de+="&region=".concat(encodeURIComponent(T))),(ee||C)&&(C=ee||C,de+="&location_type=".concat(encodeURIComponent(C))),he.abrupt("return",F(de));case 9:case"end":return he.stop()}},W)}))()},fromAddress:function($,K,ie,H){return c(o.mark(function G(){var ee;return o.wrap(function(W){for(;;)switch(W.prev=W.next){case 0:if($){W.next=3;break}return O("Provided address is invalid",!0),W.abrupt("return",Promise.reject(new Error("Provided address is invalid")));case 3:return ee="".concat(P,"?address=").concat(encodeURIComponent($)),(K||_)&&(ee+="&key=".concat(_=K||_)),(ie||x)&&(ee+="&language=".concat(x=ie||x)),(H||T)&&(T=H||T,ee+="&region=".concat(encodeURIComponent(T))),W.abrupt("return",F(ee));case 8:case"end":return W.stop()}},G)}))()}};r.default=Z})(A5);const Sv=Yb(A5);/**
 * @remix-run/router v1.8.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Ii(){return Ii=Object.assign?Object.assign.bind():function(r){for(var o=1;o<arguments.length;o++){var a=arguments[o];for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(r[c]=a[c])}return r},Ii.apply(this,arguments)}var oo;(function(r){r.Pop="POP",r.Push="PUSH",r.Replace="REPLACE"})(oo||(oo={}));const oL="popstate";function pH(r){r===void 0&&(r={});function o(c,p){let{pathname:_,search:x,hash:T}=c.location;return dv("",{pathname:_,search:x,hash:T},p.state&&p.state.usr||null,p.state&&p.state.key||"default")}function a(c,p){return typeof p=="string"?p:Ev(p)}return gH(o,a,null,r)}function _r(r,o){if(r===!1||r===null||typeof r>"u")throw new Error(o)}function Dg(r,o){if(!r){typeof console<"u"&&console.warn(o);try{throw new Error(o)}catch{}}}function mH(){return Math.random().toString(36).substr(2,8)}function sL(r,o){return{usr:r.state,key:r.key,idx:o}}function dv(r,o,a,c){return a===void 0&&(a=null),Ii({pathname:typeof r=="string"?r:r.pathname,search:"",hash:""},typeof o=="string"?bc(o):o,{state:a,key:o&&o.key||c||mH()})}function Ev(r){let{pathname:o="/",search:a="",hash:c=""}=r;return a&&a!=="?"&&(o+=a.charAt(0)==="?"?a:"?"+a),c&&c!=="#"&&(o+=c.charAt(0)==="#"?c:"#"+c),o}function bc(r){let o={};if(r){let a=r.indexOf("#");a>=0&&(o.hash=r.substr(a),r=r.substr(0,a));let c=r.indexOf("?");c>=0&&(o.search=r.substr(c),r=r.substr(0,c)),r&&(o.pathname=r)}return o}function gH(r,o,a,c){c===void 0&&(c={});let{window:p=document.defaultView,v5Compat:_=!1}=c,x=p.history,T=oo.Pop,C=null,P=O();P==null&&(P=0,x.replaceState(Ii({},x.state,{idx:P}),""));function O(){return(x.state||{idx:null}).idx}function F(){T=oo.Pop;let ie=O(),H=ie==null?null:ie-P;P=ie,C&&C({action:T,location:K.location,delta:H})}function U(ie,H){T=oo.Push;let G=dv(K.location,ie,H);a&&a(G,ie),P=O()+1;let ee=sL(G,P),W=K.createHref(G);try{x.pushState(ee,"",W)}catch(me){if(me instanceof DOMException&&me.name==="DataCloneError")throw me;p.location.assign(W)}_&&C&&C({action:T,location:K.location,delta:1})}function Z(ie,H){T=oo.Replace;let G=dv(K.location,ie,H);a&&a(G,ie),P=O();let ee=sL(G,P),W=K.createHref(G);x.replaceState(ee,"",W),_&&C&&C({action:T,location:K.location,delta:0})}function $(ie){let H=p.location.origin!=="null"?p.location.origin:p.location.href,G=typeof ie=="string"?ie:Ev(ie);return _r(H,"No window.location.(origin|href) available to create URL for href: "+G),new URL(G,H)}let K={get action(){return T},get location(){return r(p,x)},listen(ie){if(C)throw new Error("A history only accepts one active listener");return p.addEventListener(oL,F),C=ie,()=>{p.removeEventListener(oL,F),C=null}},createHref(ie){return o(p,ie)},createURL:$,encodeLocation(ie){let H=$(ie);return{pathname:H.pathname,search:H.search,hash:H.hash}},push:U,replace:Z,go(ie){return x.go(ie)}};return K}var Zi;(function(r){r.data="data",r.deferred="deferred",r.redirect="redirect",r.error="error"})(Zi||(Zi={}));const yH=new Set(["lazy","caseSensitive","path","id","index","children"]);function _H(r){return r.index===!0}function RC(r,o,a,c){return a===void 0&&(a=[]),c===void 0&&(c={}),r.map((p,_)=>{let x=[...a,_],T=typeof p.id=="string"?p.id:x.join("-");if(_r(p.index!==!0||!p.children,"Cannot specify children on an index route"),_r(!c[T],'Found a route id collision on id "'+T+`".  Route id's must be globally unique within Data Router usages`),_H(p)){let C=Ii({},p,o(p),{id:T});return c[T]=C,C}else{let C=Ii({},p,o(p),{id:T,children:void 0});return c[T]=C,p.children&&(C.children=RC(p.children,o,x,c)),C}})}function hg(r,o,a){a===void 0&&(a="/");let c=typeof o=="string"?bc(o):o,p=Tv(c.pathname||"/",a);if(p==null)return null;let _=I5(r);vH(_);let x=null;for(let T=0;x==null&&T<_.length;++T)x=MH(_[T],PH(p));return x}function I5(r,o,a,c){o===void 0&&(o=[]),a===void 0&&(a=[]),c===void 0&&(c="");let p=(_,x,T)=>{let C={relativePath:T===void 0?_.path||"":T,caseSensitive:_.caseSensitive===!0,childrenIndex:x,route:_};C.relativePath.startsWith("/")&&(_r(C.relativePath.startsWith(c),'Absolute route path "'+C.relativePath+'" nested under path '+('"'+c+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),C.relativePath=C.relativePath.slice(c.length));let P=If([c,C.relativePath]),O=a.concat(C);_.children&&_.children.length>0&&(_r(_.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+P+'".')),I5(_.children,o,O,P)),!(_.path==null&&!_.index)&&o.push({path:P,score:CH(P,_.index),routesMeta:O})};return r.forEach((_,x)=>{var T;if(_.path===""||!((T=_.path)!=null&&T.includes("?")))p(_,x);else for(let C of k5(_.path))p(_,x,C)}),o}function k5(r){let o=r.split("/");if(o.length===0)return[];let[a,...c]=o,p=a.endsWith("?"),_=a.replace(/\?$/,"");if(c.length===0)return p?[_,""]:[_];let x=k5(c.join("/")),T=[];return T.push(...x.map(C=>C===""?_:[_,C].join("/"))),p&&T.push(...x),T.map(C=>r.startsWith("/")&&C===""?"/":C)}function vH(r){r.sort((o,a)=>o.score!==a.score?a.score-o.score:AH(o.routesMeta.map(c=>c.childrenIndex),a.routesMeta.map(c=>c.childrenIndex)))}const xH=/^:\w+$/,wH=3,bH=2,SH=1,EH=10,TH=-2,aL=r=>r==="*";function CH(r,o){let a=r.split("/"),c=a.length;return a.some(aL)&&(c+=TH),o&&(c+=bH),a.filter(p=>!aL(p)).reduce((p,_)=>p+(xH.test(_)?wH:_===""?SH:EH),c)}function AH(r,o){return r.length===o.length&&r.slice(0,-1).every((c,p)=>c===o[p])?r[r.length-1]-o[o.length-1]:0}function MH(r,o){let{routesMeta:a}=r,c={},p="/",_=[];for(let x=0;x<a.length;++x){let T=a[x],C=x===a.length-1,P=p==="/"?o:o.slice(p.length)||"/",O=IH({path:T.relativePath,caseSensitive:T.caseSensitive,end:C},P);if(!O)return null;Object.assign(c,O.params);let F=T.route;_.push({params:c,pathname:If([p,O.pathname]),pathnameBase:zH(If([p,O.pathnameBase])),route:F}),O.pathnameBase!=="/"&&(p=If([p,O.pathnameBase]))}return _}function IH(r,o){typeof r=="string"&&(r={path:r,caseSensitive:!1,end:!0});let[a,c]=kH(r.path,r.caseSensitive,r.end),p=o.match(a);if(!p)return null;let _=p[0],x=_.replace(/(.)\/+$/,"$1"),T=p.slice(1);return{params:c.reduce((P,O,F)=>{if(O==="*"){let U=T[F]||"";x=_.slice(0,_.length-U.length).replace(/(.)\/+$/,"$1")}return P[O]=RH(T[F]||"",O),P},{}),pathname:_,pathnameBase:x,pattern:r}}function kH(r,o,a){o===void 0&&(o=!1),a===void 0&&(a=!0),Dg(r==="*"||!r.endsWith("*")||r.endsWith("/*"),'Route path "'+r+'" will be treated as if it were '+('"'+r.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+r.replace(/\*$/,"/*")+'".'));let c=[],p="^"+r.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^$?{}|()[\]]/g,"\\$&").replace(/\/:(\w+)/g,(x,T)=>(c.push(T),"/([^\\/]+)"));return r.endsWith("*")?(c.push("*"),p+=r==="*"||r==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):a?p+="\\/*$":r!==""&&r!=="/"&&(p+="(?:(?=\\/|$))"),[new RegExp(p,o?void 0:"i"),c]}function PH(r){try{return decodeURI(r)}catch(o){return Dg(!1,'The URL path "'+r+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+o+").")),r}}function RH(r,o){try{return decodeURIComponent(r)}catch(a){return Dg(!1,'The value for the URL param "'+o+'" will not be decoded because'+(' the string "'+r+'" is a malformed URL segment. This is probably')+(" due to a bad percent encoding ("+a+").")),r}}function Tv(r,o){if(o==="/")return r;if(!r.toLowerCase().startsWith(o.toLowerCase()))return null;let a=o.endsWith("/")?o.length-1:o.length,c=r.charAt(a);return c&&c!=="/"?null:r.slice(a)||"/"}function DH(r,o){o===void 0&&(o="/");let{pathname:a,search:c="",hash:p=""}=typeof r=="string"?bc(r):r;return{pathname:a?a.startsWith("/")?a:LH(a,o):o,search:FH(c),hash:BH(p)}}function LH(r,o){let a=o.replace(/\/+$/,"").split("/");return r.split("/").forEach(p=>{p===".."?a.length>1&&a.pop():p!=="."&&a.push(p)}),a.length>1?a.join("/"):"/"}function dT(r,o,a,c){return"Cannot include a '"+r+"' character in a manually specified "+("`to."+o+"` field ["+JSON.stringify(c)+"].  Please separate it out to the ")+("`to."+a+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function P5(r){return r.filter((o,a)=>a===0||o.route.path&&o.route.path.length>0)}function OH(r,o,a,c){c===void 0&&(c=!1);let p;typeof r=="string"?p=bc(r):(p=Ii({},r),_r(!p.pathname||!p.pathname.includes("?"),dT("?","pathname","search",p)),_r(!p.pathname||!p.pathname.includes("#"),dT("#","pathname","hash",p)),_r(!p.search||!p.search.includes("#"),dT("#","search","hash",p)));let _=r===""||p.pathname==="",x=_?"/":p.pathname,T;if(c||x==null)T=a;else{let F=o.length-1;if(x.startsWith("..")){let U=x.split("/");for(;U[0]==="..";)U.shift(),F-=1;p.pathname=U.join("/")}T=F>=0?o[F]:"/"}let C=DH(p,T),P=x&&x!=="/"&&x.endsWith("/"),O=(_||x===".")&&a.endsWith("/");return!C.pathname.endsWith("/")&&(P||O)&&(C.pathname+="/"),C}const If=r=>r.join("/").replace(/\/\/+/g,"/"),zH=r=>r.replace(/\/+$/,"").replace(/^\/*/,"/"),FH=r=>!r||r==="?"?"":r.startsWith("?")?r:"?"+r,BH=r=>!r||r==="#"?"":r.startsWith("#")?r:"#"+r;class pM{constructor(o,a,c,p){p===void 0&&(p=!1),this.status=o,this.statusText=a||"",this.internal=p,c instanceof Error?(this.data=c.toString(),this.error=c):this.data=c}}function R5(r){return r!=null&&typeof r.status=="number"&&typeof r.statusText=="string"&&typeof r.internal=="boolean"&&"data"in r}const D5=["post","put","patch","delete"],NH=new Set(D5),jH=["get",...D5],UH=new Set(jH),VH=new Set([301,302,303,307,308]),$H=new Set([307,308]),fT={state:"idle",location:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},GH={state:"idle",data:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},J_={state:"unblocked",proceed:void 0,reset:void 0,location:void 0},L5=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,HH=r=>({hasErrorBoundary:!!r.hasErrorBoundary});function qH(r){const o=r.window?r.window:typeof window<"u"?window:void 0,a=typeof o<"u"&&typeof o.document<"u"&&typeof o.document.createElement<"u",c=!a;_r(r.routes.length>0,"You must provide a non-empty routes array to createRouter");let p;if(r.mapRouteProperties)p=r.mapRouteProperties;else if(r.detectErrorBoundary){let Xe=r.detectErrorBoundary;p=be=>({hasErrorBoundary:Xe(be)})}else p=HH;let _={},x=RC(r.routes,p,void 0,_),T,C=r.basename||"/",P=Ii({v7_normalizeFormMethod:!1,v7_prependBasename:!1},r.future),O=null,F=new Set,U=null,Z=null,$=null,K=r.hydrationData!=null,ie=hg(x,r.history.location,C),H=null;if(ie==null){let Xe=Ia(404,{pathname:r.history.location.pathname}),{matches:be,route:Ke}=mL(x);ie=be,H={[Ke.id]:Xe}}let G=!ie.some(Xe=>Xe.route.lazy)&&(!ie.some(Xe=>Xe.route.loader)||r.hydrationData!=null),ee,W={historyAction:r.history.action,location:r.history.location,matches:ie,initialized:G,navigation:fT,restoreScrollPosition:r.hydrationData!=null?!1:null,preventScrollReset:!1,revalidation:"idle",loaderData:r.hydrationData&&r.hydrationData.loaderData||{},actionData:r.hydrationData&&r.hydrationData.actionData||null,errors:r.hydrationData&&r.hydrationData.errors||H,fetchers:new Map,blockers:new Map},me=oo.Pop,de=!1,he,se=!1,q=!1,Se=[],ze=[],Ue=new Map,Be=0,rt=-1,_t=new Map,zt=new Set,dt=new Map,Te=new Map,we=new Map,Q=!1;function ce(){return O=r.history.listen(Xe=>{let{action:be,location:Ke,delta:nt}=Xe;if(Q){Q=!1;return}Dg(we.size===0||nt!=null,"You are trying to use a blocker on a POP navigation to a location that was not created by @remix-run/router. This will fail silently in production. This can happen if you are navigating outside the router via `window.history.pushState`/`window.location.hash` instead of using router navigation APIs.  This can also happen if you are using createHashRouter and the user manually changes the URL.");let Vt=Wt({currentLocation:W.location,nextLocation:Ke,historyAction:be});if(Vt&&nt!=null){Q=!0,r.history.go(nt*-1),Rt(Vt,{state:"blocked",location:Ke,proceed(){Rt(Vt,{state:"proceeding",proceed:void 0,reset:void 0,location:Ke}),r.history.go(nt)},reset(){let Ht=new Map(W.blockers);Ht.set(Vt,J_),$e({blockers:Ht})}});return}return ot(be,Ke)}),W.initialized||ot(oo.Pop,W.location),ee}function De(){O&&O(),F.clear(),he&&he.abort(),W.fetchers.forEach((Xe,be)=>ye(be)),W.blockers.forEach((Xe,be)=>wt(be))}function He(Xe){return F.add(Xe),()=>F.delete(Xe)}function $e(Xe){W=Ii({},W,Xe),F.forEach(be=>be(W))}function xt(Xe,be){var Ke,nt;let Vt=W.actionData!=null&&W.navigation.formMethod!=null&&Tl(W.navigation.formMethod)&&W.navigation.state==="loading"&&((Ke=Xe.state)==null?void 0:Ke._isRedirect)!==!0,Ht;be.actionData?Object.keys(be.actionData).length>0?Ht=be.actionData:Ht=null:Vt?Ht=W.actionData:Ht=null;let $t=be.loaderData?pL(W.loaderData,be.loaderData,be.matches||[],be.errors):W.loaderData,jt=W.blockers;jt.size>0&&(jt=new Map(jt),jt.forEach((Oe,Ie)=>jt.set(Ie,J_)));let Lt=de===!0||W.navigation.formMethod!=null&&Tl(W.navigation.formMethod)&&((nt=Xe.state)==null?void 0:nt._isRedirect)!==!0;T&&(x=T,T=void 0),se||me===oo.Pop||(me===oo.Push?r.history.push(Xe,Xe.state):me===oo.Replace&&r.history.replace(Xe,Xe.state)),$e(Ii({},be,{actionData:Ht,loaderData:$t,historyAction:me,location:Xe,initialized:!0,navigation:fT,revalidation:"idle",restoreScrollPosition:nr(Xe,be.matches||W.matches),preventScrollReset:Lt,blockers:jt})),me=oo.Pop,de=!1,se=!1,q=!1,Se=[],ze=[]}async function ge(Xe,be){if(typeof Xe=="number"){r.history.go(Xe);return}let Ke=DC(W.location,W.matches,C,P.v7_prependBasename,Xe,be==null?void 0:be.fromRouteId,be==null?void 0:be.relative),{path:nt,submission:Vt,error:Ht}=lL(P.v7_normalizeFormMethod,!1,Ke,be),$t=W.location,jt=dv(W.location,nt,be&&be.state);jt=Ii({},jt,r.history.encodeLocation(jt));let Lt=be&&be.replace!=null?be.replace:void 0,Oe=oo.Push;Lt===!0?Oe=oo.Replace:Lt===!1||Vt!=null&&Tl(Vt.formMethod)&&Vt.formAction===W.location.pathname+W.location.search&&(Oe=oo.Replace);let Ie=be&&"preventScrollReset"in be?be.preventScrollReset===!0:void 0,je=Wt({currentLocation:$t,nextLocation:jt,historyAction:Oe});if(je){Rt(je,{state:"blocked",location:jt,proceed(){Rt(je,{state:"proceeding",proceed:void 0,reset:void 0,location:jt}),ge(Xe,be)},reset(){let Qe=new Map(W.blockers);Qe.set(je,J_),$e({blockers:Qe})}});return}return await ot(Oe,jt,{submission:Vt,pendingError:Ht,preventScrollReset:Ie,replace:be&&be.replace})}function Pt(){if(te(),$e({revalidation:"loading"}),W.navigation.state!=="submitting"){if(W.navigation.state==="idle"){ot(W.historyAction,W.location,{startUninterruptedRevalidation:!0});return}ot(me||W.historyAction,W.navigation.location,{overrideNavigation:W.navigation})}}async function ot(Xe,be,Ke){he&&he.abort(),he=null,me=Xe,se=(Ke&&Ke.startUninterruptedRevalidation)===!0,pr(W.location,W.matches),de=(Ke&&Ke.preventScrollReset)===!0;let nt=T||x,Vt=Ke&&Ke.overrideNavigation,Ht=hg(nt,be,C);if(!Ht){let Qe=Ia(404,{pathname:be.pathname}),{matches:tt,route:ht}=mL(nt);cn(),xt(be,{matches:tt,loaderData:{},errors:{[ht.id]:Qe}});return}if(W.initialized&&!q&&YH(W.location,be)&&!(Ke&&Ke.submission&&Tl(Ke.submission.formMethod))){xt(be,{matches:Ht});return}he=new AbortController;let $t=t0(r.history,be,he.signal,Ke&&Ke.submission),jt,Lt;if(Ke&&Ke.pendingError)Lt={[dg(Ht).route.id]:Ke.pendingError};else if(Ke&&Ke.submission&&Tl(Ke.submission.formMethod)){let Qe=await Dn($t,be,Ke.submission,Ht,{replace:Ke.replace});if(Qe.shortCircuited)return;jt=Qe.pendingActionData,Lt=Qe.pendingActionError,Vt=Jx(be,Ke.submission),$t=new Request($t.url,{signal:$t.signal})}let{shortCircuited:Oe,loaderData:Ie,errors:je}=await $n($t,be,Ht,Vt,Ke&&Ke.submission,Ke&&Ke.fetcherSubmission,Ke&&Ke.replace,jt,Lt);Oe||(he=null,xt(be,Ii({matches:Ht},jt?{actionData:jt}:{},{loaderData:Ie,errors:je})))}async function Dn(Xe,be,Ke,nt,Vt){Vt===void 0&&(Vt={}),te();let Ht=nq(be,Ke);$e({navigation:Ht});let $t,jt=OC(nt,be);if(!jt.route.action&&!jt.route.lazy)$t={type:Zi.error,error:Ia(405,{method:Xe.method,pathname:be.pathname,routeId:jt.route.id})};else if($t=await e0("action",Xe,jt,nt,_,p,C),Xe.signal.aborted)return{shortCircuited:!0};if(wg($t)){let Lt;return Vt&&Vt.replace!=null?Lt=Vt.replace:Lt=$t.location===W.location.pathname+W.location.search,await bn(W,$t,{submission:Ke,replace:Lt}),{shortCircuited:!0}}if(R0($t)){let Lt=dg(nt,jt.route.id);return(Vt&&Vt.replace)!==!0&&(me=oo.Push),{pendingActionData:{},pendingActionError:{[Lt.route.id]:$t.error}}}if(Cf($t))throw Ia(400,{type:"defer-action"});return{pendingActionData:{[jt.route.id]:$t.data}}}async function $n(Xe,be,Ke,nt,Vt,Ht,$t,jt,Lt){let Oe=nt||Jx(be,Vt),Ie=Vt||Ht||_L(Oe),je=T||x,[Qe,tt]=uL(r.history,W,Ke,Ie,be,q,Se,ze,dt,zt,je,C,jt,Lt);if(cn(pn=>!(Ke&&Ke.some(rr=>rr.route.id===pn))||Qe&&Qe.some(rr=>rr.route.id===pn)),rt=++Be,Qe.length===0&&tt.length===0){let pn=bt();return xt(be,Ii({matches:Ke,loaderData:{},errors:Lt||null},jt?{actionData:jt}:{},pn?{fetchers:new Map(W.fetchers)}:{})),{shortCircuited:!0}}if(!se){tt.forEach(rr=>{let Rr=W.fetchers.get(rr.key),Yr=n0(void 0,Rr?Rr.data:void 0);W.fetchers.set(rr.key,Yr)});let pn=jt||W.actionData;$e(Ii({navigation:Oe},pn?Object.keys(pn).length===0?{actionData:null}:{actionData:pn}:{},tt.length>0?{fetchers:new Map(W.fetchers)}:{}))}tt.forEach(pn=>{Ue.has(pn.key)&&We(pn.key),pn.controller&&Ue.set(pn.key,pn.controller)});let ht=()=>tt.forEach(pn=>We(pn.key));he&&he.signal.addEventListener("abort",ht);let{results:at,loaderResults:ut,fetcherResults:Et}=await et(W.matches,Ke,Qe,tt,Xe);if(Xe.signal.aborted)return{shortCircuited:!0};he&&he.signal.removeEventListener("abort",ht),tt.forEach(pn=>Ue.delete(pn.key));let it=gL(at);if(it){if(it.idx>=Qe.length){let pn=tt[it.idx-Qe.length].key;zt.add(pn)}return await bn(W,it.result,{replace:$t}),{shortCircuited:!0}}let{loaderData:Yt,errors:xn}=fL(W,Ke,Qe,ut,Lt,tt,Et,Te);Te.forEach((pn,rr)=>{pn.subscribe(Rr=>{(Rr||pn.done)&&Te.delete(rr)})});let Ot=bt(),qn=St(rt),Wn=Ot||qn||tt.length>0;return Ii({loaderData:Yt,errors:xn},Wn?{fetchers:new Map(W.fetchers)}:{})}function Ln(Xe){return W.fetchers.get(Xe)||GH}function vn(Xe,be,Ke,nt){if(c)throw new Error("router.fetch() was called during the server render, but it shouldn't be. You are likely calling a useFetcher() method in the body of your component. Try moving it to a useEffect or a callback.");Ue.has(Xe)&&We(Xe);let Vt=T||x,Ht=DC(W.location,W.matches,C,P.v7_prependBasename,Ke,be,nt==null?void 0:nt.relative),$t=hg(Vt,Ht,C);if(!$t){ue(Xe,be,Ia(404,{pathname:Ht}));return}let{path:jt,submission:Lt,error:Oe}=lL(P.v7_normalizeFormMethod,!0,Ht,nt);if(Oe){ue(Xe,be,Oe);return}let Ie=OC($t,jt);if(de=(nt&&nt.preventScrollReset)===!0,Lt&&Tl(Lt.formMethod)){On(Xe,be,jt,Ie,$t,Lt);return}dt.set(Xe,{routeId:be,path:jt}),Br(Xe,be,jt,Ie,$t,Lt)}async function On(Xe,be,Ke,nt,Vt,Ht){if(te(),dt.delete(Xe),!nt.route.action&&!nt.route.lazy){let ar=Ia(405,{method:Ht.formMethod,pathname:Ke,routeId:be});ue(Xe,be,ar);return}let $t=W.fetchers.get(Xe),jt=rq(Ht,$t);W.fetchers.set(Xe,jt),$e({fetchers:new Map(W.fetchers)});let Lt=new AbortController,Oe=t0(r.history,Ke,Lt.signal,Ht);Ue.set(Xe,Lt);let Ie=Be,je=await e0("action",Oe,nt,Vt,_,p,C);if(Oe.signal.aborted){Ue.get(Xe)===Lt&&Ue.delete(Xe);return}if(wg(je))if(Ue.delete(Xe),rt>Ie){let ar=Ym(void 0);W.fetchers.set(Xe,ar),$e({fetchers:new Map(W.fetchers)});return}else{zt.add(Xe);let ar=n0(Ht);return W.fetchers.set(Xe,ar),$e({fetchers:new Map(W.fetchers)}),bn(W,je,{submission:Ht,isFetchActionRedirect:!0})}if(R0(je)){ue(Xe,be,je.error);return}if(Cf(je))throw Ia(400,{type:"defer-action"});let Qe=W.navigation.location||W.location,tt=t0(r.history,Qe,Lt.signal),ht=T||x,at=W.navigation.state!=="idle"?hg(ht,W.navigation.location,C):W.matches;_r(at,"Didn't find any matches after fetcher action");let ut=++Be;_t.set(Xe,ut);let Et=n0(Ht,je.data);W.fetchers.set(Xe,Et);let[it,Yt]=uL(r.history,W,at,Ht,Qe,q,Se,ze,dt,zt,ht,C,{[nt.route.id]:je.data},void 0);Yt.filter(ar=>ar.key!==Xe).forEach(ar=>{let Dr=ar.key,Qr=W.fetchers.get(Dr),Po=n0(void 0,Qr?Qr.data:void 0);W.fetchers.set(Dr,Po),Ue.has(Dr)&&We(Dr),ar.controller&&Ue.set(Dr,ar.controller)}),$e({fetchers:new Map(W.fetchers)});let xn=()=>Yt.forEach(ar=>We(ar.key));Lt.signal.addEventListener("abort",xn);let{results:Ot,loaderResults:qn,fetcherResults:Wn}=await et(W.matches,at,it,Yt,tt);if(Lt.signal.aborted)return;Lt.signal.removeEventListener("abort",xn),_t.delete(Xe),Ue.delete(Xe),Yt.forEach(ar=>Ue.delete(ar.key));let pn=gL(Ot);if(pn){if(pn.idx>=it.length){let ar=Yt[pn.idx-it.length].key;zt.add(ar)}return bn(W,pn.result)}let{loaderData:rr,errors:Rr}=fL(W,W.matches,it,qn,void 0,Yt,Wn,Te);if(W.fetchers.has(Xe)){let ar=Ym(je.data);W.fetchers.set(Xe,ar)}let Yr=St(ut);W.navigation.state==="loading"&&ut>rt?(_r(me,"Expected pending action"),he&&he.abort(),xt(W.navigation.location,{matches:at,loaderData:rr,errors:Rr,fetchers:new Map(W.fetchers)})):($e(Ii({errors:Rr,loaderData:pL(W.loaderData,rr,at,Rr)},Yr||Yt.length>0?{fetchers:new Map(W.fetchers)}:{})),q=!1)}async function Br(Xe,be,Ke,nt,Vt,Ht){let $t=W.fetchers.get(Xe),jt=n0(Ht,$t?$t.data:void 0);W.fetchers.set(Xe,jt),$e({fetchers:new Map(W.fetchers)});let Lt=new AbortController,Oe=t0(r.history,Ke,Lt.signal);Ue.set(Xe,Lt);let Ie=Be,je=await e0("loader",Oe,nt,Vt,_,p,C);if(Cf(je)&&(je=await F5(je,Oe.signal,!0)||je),Ue.get(Xe)===Lt&&Ue.delete(Xe),Oe.signal.aborted)return;if(wg(je))if(rt>Ie){let tt=Ym(void 0);W.fetchers.set(Xe,tt),$e({fetchers:new Map(W.fetchers)});return}else{zt.add(Xe),await bn(W,je);return}if(R0(je)){let tt=dg(W.matches,be);W.fetchers.delete(Xe),$e({fetchers:new Map(W.fetchers),errors:{[tt.route.id]:je.error}});return}_r(!Cf(je),"Unhandled fetcher deferred data");let Qe=Ym(je.data);W.fetchers.set(Xe,Qe),$e({fetchers:new Map(W.fetchers)})}async function bn(Xe,be,Ke){let{submission:nt,replace:Vt,isFetchActionRedirect:Ht}=Ke===void 0?{}:Ke;be.revalidate&&(q=!0);let $t=dv(Xe.location,be.location,Ii({_isRedirect:!0},Ht?{_isFetchActionRedirect:!0}:{}));if(_r($t,"Expected a location on the redirect navigation"),a){let Oe=!1;if(be.reloadDocument)Oe=!0;else if(L5.test(be.location)){const Ie=r.history.createURL(be.location);Oe=Ie.origin!==o.location.origin||Tv(Ie.pathname,C)==null}if(Oe){Vt?o.location.replace(be.location):o.location.assign(be.location);return}}he=null;let jt=Vt===!0?oo.Replace:oo.Push,Lt=nt||_L(Xe.navigation);if($H.has(be.status)&&Lt&&Tl(Lt.formMethod))await ot(jt,$t,{submission:Ii({},Lt,{formAction:be.location}),preventScrollReset:de});else if(Ht)await ot(jt,$t,{overrideNavigation:Jx($t),fetcherSubmission:Lt,preventScrollReset:de});else{let Oe=Jx($t,Lt);await ot(jt,$t,{overrideNavigation:Oe,preventScrollReset:de})}}async function et(Xe,be,Ke,nt,Vt){let Ht=await Promise.all([...Ke.map(Lt=>e0("loader",Vt,Lt,be,_,p,C)),...nt.map(Lt=>Lt.matches&&Lt.match&&Lt.controller?e0("loader",t0(r.history,Lt.path,Lt.controller.signal),Lt.match,Lt.matches,_,p,C):{type:Zi.error,error:Ia(404,{pathname:Lt.path})})]),$t=Ht.slice(0,Ke.length),jt=Ht.slice(Ke.length);return await Promise.all([yL(Xe,Ke,$t,$t.map(()=>Vt.signal),!1,W.loaderData),yL(Xe,nt.map(Lt=>Lt.match),jt,nt.map(Lt=>Lt.controller?Lt.controller.signal:null),!0)]),{results:Ht,loaderResults:$t,fetcherResults:jt}}function te(){q=!0,Se.push(...cn()),dt.forEach((Xe,be)=>{Ue.has(be)&&(ze.push(be),We(be))})}function ue(Xe,be,Ke){let nt=dg(W.matches,be);ye(Xe),$e({errors:{[nt.route.id]:Ke},fetchers:new Map(W.fetchers)})}function ye(Xe){let be=W.fetchers.get(Xe);Ue.has(Xe)&&!(be&&be.state==="loading"&&_t.has(Xe))&&We(Xe),dt.delete(Xe),_t.delete(Xe),zt.delete(Xe),W.fetchers.delete(Xe)}function We(Xe){let be=Ue.get(Xe);_r(be,"Expected fetch controller: "+Xe),be.abort(),Ue.delete(Xe)}function Je(Xe){for(let be of Xe){let Ke=Ln(be),nt=Ym(Ke.data);W.fetchers.set(be,nt)}}function bt(){let Xe=[],be=!1;for(let Ke of zt){let nt=W.fetchers.get(Ke);_r(nt,"Expected fetcher: "+Ke),nt.state==="loading"&&(zt.delete(Ke),Xe.push(Ke),be=!0)}return Je(Xe),be}function St(Xe){let be=[];for(let[Ke,nt]of _t)if(nt<Xe){let Vt=W.fetchers.get(Ke);_r(Vt,"Expected fetcher: "+Ke),Vt.state==="loading"&&(We(Ke),_t.delete(Ke),be.push(Ke))}return Je(be),be.length>0}function Ne(Xe,be){let Ke=W.blockers.get(Xe)||J_;return we.get(Xe)!==be&&we.set(Xe,be),Ke}function wt(Xe){W.blockers.delete(Xe),we.delete(Xe)}function Rt(Xe,be){let Ke=W.blockers.get(Xe)||J_;_r(Ke.state==="unblocked"&&be.state==="blocked"||Ke.state==="blocked"&&be.state==="blocked"||Ke.state==="blocked"&&be.state==="proceeding"||Ke.state==="blocked"&&be.state==="unblocked"||Ke.state==="proceeding"&&be.state==="unblocked","Invalid blocker state transition: "+Ke.state+" -> "+be.state);let nt=new Map(W.blockers);nt.set(Xe,be),$e({blockers:nt})}function Wt(Xe){let{currentLocation:be,nextLocation:Ke,historyAction:nt}=Xe;if(we.size===0)return;we.size>1&&Dg(!1,"A router only supports one blocker at a time");let Vt=Array.from(we.entries()),[Ht,$t]=Vt[Vt.length-1],jt=W.blockers.get(Ht);if(!(jt&&jt.state==="proceeding")&&$t({currentLocation:be,nextLocation:Ke,historyAction:nt}))return Ht}function cn(Xe){let be=[];return Te.forEach((Ke,nt)=>{(!Xe||Xe(nt))&&(Ke.cancel(),be.push(nt),Te.delete(nt))}),be}function Yn(Xe,be,Ke){if(U=Xe,$=be,Z=Ke||null,!K&&W.navigation===fT){K=!0;let nt=nr(W.location,W.matches);nt!=null&&$e({restoreScrollPosition:nt})}return()=>{U=null,$=null,Z=null}}function hr(Xe,be){return Z&&Z(Xe,be.map(nt=>tq(nt,W.loaderData)))||Xe.key}function pr(Xe,be){if(U&&$){let Ke=hr(Xe,be);U[Ke]=$()}}function nr(Xe,be){if(U){let Ke=hr(Xe,be),nt=U[Ke];if(typeof nt=="number")return nt}return null}function dr(Xe){_={},T=RC(Xe,p,void 0,_)}return ee={get basename(){return C},get state(){return W},get routes(){return x},initialize:ce,subscribe:He,enableScrollRestoration:Yn,navigate:ge,fetch:vn,revalidate:Pt,createHref:Xe=>r.history.createHref(Xe),encodeLocation:Xe=>r.history.encodeLocation(Xe),getFetcher:Ln,deleteFetcher:ye,dispose:De,getBlocker:Ne,deleteBlocker:wt,_internalFetchControllers:Ue,_internalActiveDeferreds:Te,_internalSetRoutes:dr},ee}function WH(r){return r!=null&&("formData"in r&&r.formData!=null||"body"in r&&r.body!==void 0)}function DC(r,o,a,c,p,_,x){let T,C;if(_!=null&&x!=="path"){T=[];for(let O of o)if(T.push(O),O.route.id===_){C=O;break}}else T=o,C=o[o.length-1];let P=OH(p||".",P5(T).map(O=>O.pathnameBase),Tv(r.pathname,a)||r.pathname,x==="path");return p==null&&(P.search=r.search,P.hash=r.hash),(p==null||p===""||p===".")&&C&&C.route.index&&!mM(P.search)&&(P.search=P.search?P.search.replace(/^\?/,"?index&"):"?index"),c&&a!=="/"&&(P.pathname=P.pathname==="/"?a:If([a,P.pathname])),Ev(P)}function lL(r,o,a,c){if(!c||!WH(c))return{path:a};if(c.formMethod&&!eq(c.formMethod))return{path:a,error:Ia(405,{method:c.formMethod})};let p=()=>({path:a,error:Ia(400,{type:"invalid-body"})}),_=c.formMethod||"get",x=r?_.toUpperCase():_.toLowerCase(),T=z5(a);if(c.body!==void 0){if(c.formEncType==="text/plain"){if(!Tl(x))return p();let U=typeof c.body=="string"?c.body:c.body instanceof FormData||c.body instanceof URLSearchParams?Array.from(c.body.entries()).reduce((Z,$)=>{let[K,ie]=$;return""+Z+K+"="+ie+`
`},""):String(c.body);return{path:a,submission:{formMethod:x,formAction:T,formEncType:c.formEncType,formData:void 0,json:void 0,text:U}}}else if(c.formEncType==="application/json"){if(!Tl(x))return p();try{let U=typeof c.body=="string"?JSON.parse(c.body):c.body;return{path:a,submission:{formMethod:x,formAction:T,formEncType:c.formEncType,formData:void 0,json:U,text:void 0}}}catch{return p()}}}_r(typeof FormData=="function","FormData is not available in this environment");let C,P;if(c.formData)C=LC(c.formData),P=c.formData;else if(c.body instanceof FormData)C=LC(c.body),P=c.body;else if(c.body instanceof URLSearchParams)C=c.body,P=dL(C);else if(c.body==null)C=new URLSearchParams,P=new FormData;else try{C=new URLSearchParams(c.body),P=dL(C)}catch{return p()}let O={formMethod:x,formAction:T,formEncType:c&&c.formEncType||"application/x-www-form-urlencoded",formData:P,json:void 0,text:void 0};if(Tl(O.formMethod))return{path:a,submission:O};let F=bc(a);return o&&F.search&&mM(F.search)&&C.append("index",""),F.search="?"+C,{path:Ev(F),submission:O}}function ZH(r,o){let a=r;if(o){let c=r.findIndex(p=>p.route.id===o);c>=0&&(a=r.slice(0,c))}return a}function uL(r,o,a,c,p,_,x,T,C,P,O,F,U,Z){let $=Z?Object.values(Z)[0]:U?Object.values(U)[0]:void 0,K=r.createURL(o.location),ie=r.createURL(p),H=Z?Object.keys(Z)[0]:void 0,ee=ZH(a,H).filter((me,de)=>{if(me.route.lazy)return!0;if(me.route.loader==null)return!1;if(XH(o.loaderData,o.matches[de],me)||x.some(q=>q===me.route.id))return!0;let he=o.matches[de],se=me;return cL(me,Ii({currentUrl:K,currentParams:he.params,nextUrl:ie,nextParams:se.params},c,{actionResult:$,defaultShouldRevalidate:_||K.pathname+K.search===ie.pathname+ie.search||K.search!==ie.search||O5(he,se)}))}),W=[];return C.forEach((me,de)=>{if(!a.some(ze=>ze.route.id===me.routeId))return;let he=hg(O,me.path,F);if(!he){W.push({key:de,routeId:me.routeId,path:me.path,matches:null,match:null,controller:null});return}let se=o.fetchers.get(de),q=OC(he,me.path),Se=!1;P.has(de)?Se=!1:T.includes(de)?Se=!0:se&&se.state!=="idle"&&se.data===void 0?Se=_:Se=cL(q,Ii({currentUrl:K,currentParams:o.matches[o.matches.length-1].params,nextUrl:ie,nextParams:a[a.length-1].params},c,{actionResult:$,defaultShouldRevalidate:_})),Se&&W.push({key:de,routeId:me.routeId,path:me.path,matches:he,match:q,controller:new AbortController})}),[ee,W]}function XH(r,o,a){let c=!o||a.route.id!==o.route.id,p=r[a.route.id]===void 0;return c||p}function O5(r,o){let a=r.route.path;return r.pathname!==o.pathname||a!=null&&a.endsWith("*")&&r.params["*"]!==o.params["*"]}function cL(r,o){if(r.route.shouldRevalidate){let a=r.route.shouldRevalidate(o);if(typeof a=="boolean")return a}return o.defaultShouldRevalidate}async function hL(r,o,a){if(!r.lazy)return;let c=await r.lazy();if(!r.lazy)return;let p=a[r.id];_r(p,"No route found in manifest");let _={};for(let x in c){let C=p[x]!==void 0&&x!=="hasErrorBoundary";Dg(!C,'Route "'+p.id+'" has a static property "'+x+'" defined but its lazy function is also returning a value for this property. '+('The lazy route property "'+x+'" will be ignored.')),!C&&!yH.has(x)&&(_[x]=c[x])}Object.assign(p,_),Object.assign(p,Ii({},o(p),{lazy:void 0}))}async function e0(r,o,a,c,p,_,x,T){T===void 0&&(T={});let C,P,O,F=$=>{let K,ie=new Promise((H,G)=>K=G);return O=()=>K(),o.signal.addEventListener("abort",O),Promise.race([$({request:o,params:a.params,context:T.requestContext}),ie])};try{let $=a.route[r];if(a.route.lazy)if($)P=(await Promise.all([F($),hL(a.route,_,p)]))[0];else if(await hL(a.route,_,p),$=a.route[r],$)P=await F($);else if(r==="action"){let K=new URL(o.url),ie=K.pathname+K.search;throw Ia(405,{method:o.method,pathname:ie,routeId:a.route.id})}else return{type:Zi.data,data:void 0};else if($)P=await F($);else{let K=new URL(o.url),ie=K.pathname+K.search;throw Ia(404,{pathname:ie})}_r(P!==void 0,"You defined "+(r==="action"?"an action":"a loader")+" for route "+('"'+a.route.id+"\" but didn't return anything from your `"+r+"` ")+"function. Please return a value or `null`.")}catch($){C=Zi.error,P=$}finally{O&&o.signal.removeEventListener("abort",O)}if(JH(P)){let $=P.status;if(VH.has($)){let H=P.headers.get("Location");if(_r(H,"Redirects returned/thrown from loaders/actions must have a Location header"),!L5.test(H))H=DC(new URL(o.url),c.slice(0,c.indexOf(a)+1),x,!0,H);else if(!T.isStaticRequest){let G=new URL(o.url),ee=H.startsWith("//")?new URL(G.protocol+H):new URL(H),W=Tv(ee.pathname,x)!=null;ee.origin===G.origin&&W&&(H=ee.pathname+ee.search+ee.hash)}if(T.isStaticRequest)throw P.headers.set("Location",H),P;return{type:Zi.redirect,status:$,location:H,revalidate:P.headers.get("X-Remix-Revalidate")!==null,reloadDocument:P.headers.get("X-Remix-Reload-Document")!==null}}if(T.isRouteRequest)throw{type:C===Zi.error?Zi.error:Zi.data,response:P};let K,ie=P.headers.get("Content-Type");return ie&&/\bapplication\/json\b/.test(ie)?K=await P.json():K=await P.text(),C===Zi.error?{type:C,error:new pM($,P.statusText,K),headers:P.headers}:{type:Zi.data,data:K,statusCode:P.status,headers:P.headers}}if(C===Zi.error)return{type:C,error:P};if(QH(P)){var U,Z;return{type:Zi.deferred,deferredData:P,statusCode:(U=P.init)==null?void 0:U.status,headers:((Z=P.init)==null?void 0:Z.headers)&&new Headers(P.init.headers)}}return{type:Zi.data,data:P}}function t0(r,o,a,c){let p=r.createURL(z5(o)).toString(),_={signal:a};if(c&&Tl(c.formMethod)){let{formMethod:x,formEncType:T}=c;_.method=x.toUpperCase(),T==="application/json"?(_.headers=new Headers({"Content-Type":T}),_.body=JSON.stringify(c.json)):T==="text/plain"?_.body=c.text:T==="application/x-www-form-urlencoded"&&c.formData?_.body=LC(c.formData):_.body=c.formData}return new Request(p,_)}function LC(r){let o=new URLSearchParams;for(let[a,c]of r.entries())o.append(a,typeof c=="string"?c:c.name);return o}function dL(r){let o=new FormData;for(let[a,c]of r.entries())o.append(a,c);return o}function KH(r,o,a,c,p){let _={},x=null,T,C=!1,P={};return a.forEach((O,F)=>{let U=o[F].route.id;if(_r(!wg(O),"Cannot handle redirect results in processLoaderData"),R0(O)){let Z=dg(r,U),$=O.error;c&&($=Object.values(c)[0],c=void 0),x=x||{},x[Z.route.id]==null&&(x[Z.route.id]=$),_[U]=void 0,C||(C=!0,T=R5(O.error)?O.error.status:500),O.headers&&(P[U]=O.headers)}else Cf(O)?(p.set(U,O.deferredData),_[U]=O.deferredData.data):_[U]=O.data,O.statusCode!=null&&O.statusCode!==200&&!C&&(T=O.statusCode),O.headers&&(P[U]=O.headers)}),c&&(x=c,_[Object.keys(c)[0]]=void 0),{loaderData:_,errors:x,statusCode:T||200,loaderHeaders:P}}function fL(r,o,a,c,p,_,x,T){let{loaderData:C,errors:P}=KH(o,a,c,p,T);for(let O=0;O<_.length;O++){let{key:F,match:U,controller:Z}=_[O];_r(x!==void 0&&x[O]!==void 0,"Did not find corresponding fetcher result");let $=x[O];if(!(Z&&Z.signal.aborted))if(R0($)){let K=dg(r.matches,U==null?void 0:U.route.id);P&&P[K.route.id]||(P=Ii({},P,{[K.route.id]:$.error})),r.fetchers.delete(F)}else if(wg($))_r(!1,"Unhandled fetcher revalidation redirect");else if(Cf($))_r(!1,"Unhandled fetcher deferred data");else{let K=Ym($.data);r.fetchers.set(F,K)}}return{loaderData:C,errors:P}}function pL(r,o,a,c){let p=Ii({},o);for(let _ of a){let x=_.route.id;if(o.hasOwnProperty(x)?o[x]!==void 0&&(p[x]=o[x]):r[x]!==void 0&&_.route.loader&&(p[x]=r[x]),c&&c.hasOwnProperty(x))break}return p}function dg(r,o){return(o?r.slice(0,r.findIndex(c=>c.route.id===o)+1):[...r]).reverse().find(c=>c.route.hasErrorBoundary===!0)||r[0]}function mL(r){let o=r.find(a=>a.index||!a.path||a.path==="/")||{id:"__shim-error-route__"};return{matches:[{params:{},pathname:"",pathnameBase:"",route:o}],route:o}}function Ia(r,o){let{pathname:a,routeId:c,method:p,type:_}=o===void 0?{}:o,x="Unknown Server Error",T="Unknown @remix-run/router error";return r===400?(x="Bad Request",p&&a&&c?T="You made a "+p+' request to "'+a+'" but '+('did not provide a `loader` for route "'+c+'", ')+"so there is no way to handle the request.":_==="defer-action"?T="defer() is not supported in actions":_==="invalid-body"&&(T="Unable to encode submission body")):r===403?(x="Forbidden",T='Route "'+c+'" does not match URL "'+a+'"'):r===404?(x="Not Found",T='No route matches URL "'+a+'"'):r===405&&(x="Method Not Allowed",p&&a&&c?T="You made a "+p.toUpperCase()+' request to "'+a+'" but '+('did not provide an `action` for route "'+c+'", ')+"so there is no way to handle the request.":p&&(T='Invalid request method "'+p.toUpperCase()+'"')),new pM(r||500,x,new Error(T),!0)}function gL(r){for(let o=r.length-1;o>=0;o--){let a=r[o];if(wg(a))return{result:a,idx:o}}}function z5(r){let o=typeof r=="string"?bc(r):r;return Ev(Ii({},o,{hash:""}))}function YH(r,o){return r.pathname!==o.pathname||r.search!==o.search?!1:r.hash===""?o.hash!=="":r.hash===o.hash?!0:o.hash!==""}function Cf(r){return r.type===Zi.deferred}function R0(r){return r.type===Zi.error}function wg(r){return(r&&r.type)===Zi.redirect}function QH(r){let o=r;return o&&typeof o=="object"&&typeof o.data=="object"&&typeof o.subscribe=="function"&&typeof o.cancel=="function"&&typeof o.resolveData=="function"}function JH(r){return r!=null&&typeof r.status=="number"&&typeof r.statusText=="string"&&typeof r.headers=="object"&&typeof r.body<"u"}function eq(r){return UH.has(r.toLowerCase())}function Tl(r){return NH.has(r.toLowerCase())}async function yL(r,o,a,c,p,_){for(let x=0;x<a.length;x++){let T=a[x],C=o[x];if(!C)continue;let P=r.find(F=>F.route.id===C.route.id),O=P!=null&&!O5(P,C)&&(_&&_[C.route.id])!==void 0;if(Cf(T)&&(p||O)){let F=c[x];_r(F,"Expected an AbortSignal for revalidating fetcher deferred result"),await F5(T,F,p).then(U=>{U&&(a[x]=U||a[x])})}}}async function F5(r,o,a){if(a===void 0&&(a=!1),!await r.deferredData.resolveData(o)){if(a)try{return{type:Zi.data,data:r.deferredData.unwrappedData}}catch(p){return{type:Zi.error,error:p}}return{type:Zi.data,data:r.deferredData.data}}}function mM(r){return new URLSearchParams(r).getAll("index").some(o=>o==="")}function tq(r,o){let{route:a,pathname:c,params:p}=r;return{id:a.id,pathname:c,params:p,data:o[a.id],handle:a.handle}}function OC(r,o){let a=typeof o=="string"?bc(o).search:o.search;if(r[r.length-1].route.index&&mM(a||""))return r[r.length-1];let c=P5(r);return c[c.length-1]}function _L(r){let{formMethod:o,formAction:a,formEncType:c,text:p,formData:_,json:x}=r;if(!(!o||!a||!c)){if(p!=null)return{formMethod:o,formAction:a,formEncType:c,formData:void 0,json:void 0,text:p};if(_!=null)return{formMethod:o,formAction:a,formEncType:c,formData:_,json:void 0,text:void 0};if(x!==void 0)return{formMethod:o,formAction:a,formEncType:c,formData:void 0,json:x,text:void 0}}}function Jx(r,o){return o?{state:"loading",location:r,formMethod:o.formMethod,formAction:o.formAction,formEncType:o.formEncType,formData:o.formData,json:o.json,text:o.text}:{state:"loading",location:r,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0}}function nq(r,o){return{state:"submitting",location:r,formMethod:o.formMethod,formAction:o.formAction,formEncType:o.formEncType,formData:o.formData,json:o.json,text:o.text}}function n0(r,o){return r?{state:"loading",formMethod:r.formMethod,formAction:r.formAction,formEncType:r.formEncType,formData:r.formData,json:r.json,text:r.text,data:o," _hasFetcherDoneAnything ":!0}:{state:"loading",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:o," _hasFetcherDoneAnything ":!0}}function rq(r,o){return{state:"submitting",formMethod:r.formMethod,formAction:r.formAction,formEncType:r.formEncType,formData:r.formData,json:r.json,text:r.text,data:o?o.data:void 0," _hasFetcherDoneAnything ":!0}}function Ym(r){return{state:"idle",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:r," _hasFetcherDoneAnything ":!0}}/**
 * React Router v6.15.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function zC(){return zC=Object.assign?Object.assign.bind():function(r){for(var o=1;o<arguments.length;o++){var a=arguments[o];for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(r[c]=a[c])}return r},zC.apply(this,arguments)}const B5=_e.createContext(null),N5=_e.createContext(null),j5=_e.createContext(null),g2=_e.createContext(null),Cv=_e.createContext({outlet:null,matches:[],isDataRoute:!1}),U5=_e.createContext(null);function gM(){return _e.useContext(g2)!=null}function iq(){return gM()||_r(!1),_e.useContext(g2).location}const oq=_e.createContext(null);function sq(r){let o=_e.useContext(Cv).outlet;return o&&_e.createElement(oq.Provider,{value:r},o)}function aq(r,o,a){gM()||_r(!1);let{navigator:c}=_e.useContext(j5),{matches:p}=_e.useContext(Cv),_=p[p.length-1],x=_?_.params:{};_&&_.pathname;let T=_?_.pathnameBase:"/";_&&_.route;let C=iq(),P;if(o){var O;let K=typeof o=="string"?bc(o):o;T==="/"||(O=K.pathname)!=null&&O.startsWith(T)||_r(!1),P=K}else P=C;let F=P.pathname||"/",U=T==="/"?F:F.slice(T.length)||"/",Z=hg(r,{pathname:U}),$=dq(Z&&Z.map(K=>Object.assign({},K,{params:Object.assign({},x,K.params),pathname:If([T,c.encodeLocation?c.encodeLocation(K.pathname).pathname:K.pathname]),pathnameBase:K.pathnameBase==="/"?T:If([T,c.encodeLocation?c.encodeLocation(K.pathnameBase).pathname:K.pathnameBase])})),p,a);return o&&$?_e.createElement(g2.Provider,{value:{location:zC({pathname:"/",search:"",hash:"",state:null,key:"default"},P),navigationType:oo.Pop}},$):$}function lq(){let r=gq(),o=R5(r)?r.status+" "+r.statusText:r instanceof Error?r.message:JSON.stringify(r),a=r instanceof Error?r.stack:null,p={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"},_=null;return _e.createElement(_e.Fragment,null,_e.createElement("h2",null,"Unexpected Application Error!"),_e.createElement("h3",{style:{fontStyle:"italic"}},o),a?_e.createElement("pre",{style:p},a):null,_)}const uq=_e.createElement(lq,null);class cq extends _e.Component{constructor(o){super(o),this.state={location:o.location,revalidation:o.revalidation,error:o.error}}static getDerivedStateFromError(o){return{error:o}}static getDerivedStateFromProps(o,a){return a.location!==o.location||a.revalidation!=="idle"&&o.revalidation==="idle"?{error:o.error,location:o.location,revalidation:o.revalidation}:{error:o.error||a.error,location:a.location,revalidation:o.revalidation||a.revalidation}}componentDidCatch(o,a){console.error("React Router caught the following error during render",o,a)}render(){return this.state.error?_e.createElement(Cv.Provider,{value:this.props.routeContext},_e.createElement(U5.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function hq(r){let{routeContext:o,match:a,children:c}=r,p=_e.useContext(B5);return p&&p.static&&p.staticContext&&(a.route.errorElement||a.route.ErrorBoundary)&&(p.staticContext._deepestRenderedBoundaryId=a.route.id),_e.createElement(Cv.Provider,{value:o},c)}function dq(r,o,a){var c;if(o===void 0&&(o=[]),a===void 0&&(a=null),r==null){var p;if((p=a)!=null&&p.errors)r=a.matches;else return null}let _=r,x=(c=a)==null?void 0:c.errors;if(x!=null){let T=_.findIndex(C=>C.route.id&&(x==null?void 0:x[C.route.id]));T>=0||_r(!1),_=_.slice(0,Math.min(_.length,T+1))}return _.reduceRight((T,C,P)=>{let O=C.route.id?x==null?void 0:x[C.route.id]:null,F=null;a&&(F=C.route.errorElement||uq);let U=o.concat(_.slice(0,P+1)),Z=()=>{let $;return O?$=F:C.route.Component?$=_e.createElement(C.route.Component,null):C.route.element?$=C.route.element:$=T,_e.createElement(hq,{match:C,routeContext:{outlet:T,matches:U,isDataRoute:a!=null},children:$})};return a&&(C.route.ErrorBoundary||C.route.errorElement||P===0)?_e.createElement(cq,{location:a.location,revalidation:a.revalidation,component:F,error:O,children:Z(),routeContext:{outlet:null,matches:U,isDataRoute:!0}}):Z()},null)}var FC=function(r){return r.UseBlocker="useBlocker",r.UseLoaderData="useLoaderData",r.UseActionData="useActionData",r.UseRouteError="useRouteError",r.UseNavigation="useNavigation",r.UseRouteLoaderData="useRouteLoaderData",r.UseMatches="useMatches",r.UseRevalidator="useRevalidator",r.UseNavigateStable="useNavigate",r.UseRouteId="useRouteId",r}(FC||{});function fq(r){let o=_e.useContext(N5);return o||_r(!1),o}function pq(r){let o=_e.useContext(Cv);return o||_r(!1),o}function mq(r){let o=pq(),a=o.matches[o.matches.length-1];return a.route.id||_r(!1),a.route.id}function gq(){var r;let o=_e.useContext(U5),a=fq(FC.UseRouteError),c=mq(FC.UseRouteError);return o||((r=a.errors)==null?void 0:r[c])}const yq="startTransition",vL=v7[yq];function _q(r){let{fallbackElement:o,router:a,future:c}=r,[p,_]=_e.useState(a.state),{v7_startTransition:x}=c||{},T=_e.useCallback(F=>{x&&vL?vL(()=>_(F)):_(F)},[_,x]);_e.useLayoutEffect(()=>a.subscribe(T),[a,T]);let C=_e.useMemo(()=>({createHref:a.createHref,encodeLocation:a.encodeLocation,go:F=>a.navigate(F),push:(F,U,Z)=>a.navigate(F,{state:U,preventScrollReset:Z==null?void 0:Z.preventScrollReset}),replace:(F,U,Z)=>a.navigate(F,{replace:!0,state:U,preventScrollReset:Z==null?void 0:Z.preventScrollReset})}),[a]),P=a.basename||"/",O=_e.useMemo(()=>({router:a,navigator:C,static:!1,basename:P}),[a,C,P]);return _e.createElement(_e.Fragment,null,_e.createElement(B5.Provider,{value:O},_e.createElement(N5.Provider,{value:p},_e.createElement(wq,{basename:P,location:p.location,navigationType:p.historyAction,navigator:C},p.initialized?_e.createElement(vq,{routes:a.routes,state:p}):o))),null)}function vq(r){let{routes:o,state:a}=r;return aq(o,void 0,a)}function xq(r){return sq(r.context)}function y0(r){_r(!1)}function wq(r){let{basename:o="/",children:a=null,location:c,navigationType:p=oo.Pop,navigator:_,static:x=!1}=r;gM()&&_r(!1);let T=o.replace(/^\/*/,"/"),C=_e.useMemo(()=>({basename:T,navigator:_,static:x}),[T,_,x]);typeof c=="string"&&(c=bc(c));let{pathname:P="/",search:O="",hash:F="",state:U=null,key:Z="default"}=c,$=_e.useMemo(()=>{let K=Tv(P,T);return K==null?null:{location:{pathname:K,search:O,hash:F,state:U,key:Z},navigationType:p}},[T,P,O,F,U,Z,p]);return $==null?null:_e.createElement(j5.Provider,{value:C},_e.createElement(g2.Provider,{children:a,value:$}))}new Promise(()=>{});function BC(r,o){o===void 0&&(o=[]);let a=[];return _e.Children.forEach(r,(c,p)=>{if(!_e.isValidElement(c))return;let _=[...o,p];if(c.type===_e.Fragment){a.push.apply(a,BC(c.props.children,_));return}c.type!==y0&&_r(!1),!c.props.index||!c.props.children||_r(!1);let x={id:c.props.id||_.join("-"),caseSensitive:c.props.caseSensitive,element:c.props.element,Component:c.props.Component,index:c.props.index,path:c.props.path,loader:c.props.loader,action:c.props.action,errorElement:c.props.errorElement,ErrorBoundary:c.props.ErrorBoundary,hasErrorBoundary:c.props.ErrorBoundary!=null||c.props.errorElement!=null,shouldRevalidate:c.props.shouldRevalidate,handle:c.props.handle,lazy:c.props.lazy};c.props.children&&(x.children=BC(c.props.children,_)),a.push(x)}),a}function bq(r){let o={hasErrorBoundary:r.ErrorBoundary!=null||r.errorElement!=null};return r.Component&&Object.assign(o,{element:_e.createElement(r.Component),Component:void 0}),r.ErrorBoundary&&Object.assign(o,{errorElement:_e.createElement(r.ErrorBoundary),ErrorBoundary:void 0}),o}/**
 * React Router DOM v6.15.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Pb(){return Pb=Object.assign?Object.assign.bind():function(r){for(var o=1;o<arguments.length;o++){var a=arguments[o];for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(r[c]=a[c])}return r},Pb.apply(this,arguments)}function Sq(r,o){return qH({basename:o==null?void 0:o.basename,future:Pb({},o==null?void 0:o.future,{v7_prependBasename:!0}),history:pH({window:o==null?void 0:o.window}),hydrationData:(o==null?void 0:o.hydrationData)||Eq(),routes:r,mapRouteProperties:bq}).initialize()}function Eq(){var r;let o=(r=window)==null?void 0:r.__staticRouterHydrationData;return o&&o.errors&&(o=Pb({},o,{errors:Tq(o.errors)})),o}function Tq(r){if(!r)return null;let o=Object.entries(r),a={};for(let[c,p]of o)if(p&&p.__type==="RouteErrorResponse")a[c]=new pM(p.status,p.statusText,p.data,p.internal===!0);else if(p&&p.__type==="Error"){if(p.__subType){let _=window[p.__subType];if(typeof _=="function")try{let x=new _(p.message);x.stack="",a[c]=x}catch{}}if(a[c]==null){let _=new Error(p.message);_.stack="",a[c]=_}}else a[c]=p;return a}var xL;(function(r){r.UseScrollRestoration="useScrollRestoration",r.UseSubmit="useSubmit",r.UseSubmitFetcher="useSubmitFetcher",r.UseFetcher="useFetcher"})(xL||(xL={}));var wL;(function(r){r.UseFetchers="useFetchers",r.UseScrollRestoration="useScrollRestoration"})(wL||(wL={}));var V5={exports:{}},Kr={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ko=typeof Symbol=="function"&&Symbol.for,yM=ko?Symbol.for("react.element"):60103,_M=ko?Symbol.for("react.portal"):60106,y2=ko?Symbol.for("react.fragment"):60107,_2=ko?Symbol.for("react.strict_mode"):60108,v2=ko?Symbol.for("react.profiler"):60114,x2=ko?Symbol.for("react.provider"):60109,w2=ko?Symbol.for("react.context"):60110,vM=ko?Symbol.for("react.async_mode"):60111,b2=ko?Symbol.for("react.concurrent_mode"):60111,S2=ko?Symbol.for("react.forward_ref"):60112,E2=ko?Symbol.for("react.suspense"):60113,Cq=ko?Symbol.for("react.suspense_list"):60120,T2=ko?Symbol.for("react.memo"):60115,C2=ko?Symbol.for("react.lazy"):60116,Aq=ko?Symbol.for("react.block"):60121,Mq=ko?Symbol.for("react.fundamental"):60117,Iq=ko?Symbol.for("react.responder"):60118,kq=ko?Symbol.for("react.scope"):60119;function ia(r){if(typeof r=="object"&&r!==null){var o=r.$$typeof;switch(o){case yM:switch(r=r.type,r){case vM:case b2:case y2:case v2:case _2:case E2:return r;default:switch(r=r&&r.$$typeof,r){case w2:case S2:case C2:case T2:case x2:return r;default:return o}}case _M:return o}}}function $5(r){return ia(r)===b2}Kr.AsyncMode=vM;Kr.ConcurrentMode=b2;Kr.ContextConsumer=w2;Kr.ContextProvider=x2;Kr.Element=yM;Kr.ForwardRef=S2;Kr.Fragment=y2;Kr.Lazy=C2;Kr.Memo=T2;Kr.Portal=_M;Kr.Profiler=v2;Kr.StrictMode=_2;Kr.Suspense=E2;Kr.isAsyncMode=function(r){return $5(r)||ia(r)===vM};Kr.isConcurrentMode=$5;Kr.isContextConsumer=function(r){return ia(r)===w2};Kr.isContextProvider=function(r){return ia(r)===x2};Kr.isElement=function(r){return typeof r=="object"&&r!==null&&r.$$typeof===yM};Kr.isForwardRef=function(r){return ia(r)===S2};Kr.isFragment=function(r){return ia(r)===y2};Kr.isLazy=function(r){return ia(r)===C2};Kr.isMemo=function(r){return ia(r)===T2};Kr.isPortal=function(r){return ia(r)===_M};Kr.isProfiler=function(r){return ia(r)===v2};Kr.isStrictMode=function(r){return ia(r)===_2};Kr.isSuspense=function(r){return ia(r)===E2};Kr.isValidElementType=function(r){return typeof r=="string"||typeof r=="function"||r===y2||r===b2||r===v2||r===_2||r===E2||r===Cq||typeof r=="object"&&r!==null&&(r.$$typeof===C2||r.$$typeof===T2||r.$$typeof===x2||r.$$typeof===w2||r.$$typeof===S2||r.$$typeof===Mq||r.$$typeof===Iq||r.$$typeof===kq||r.$$typeof===Aq)};Kr.typeOf=ia;V5.exports=Kr;var xM=V5.exports;function Pq(r){function o(De,He,$e,xt,ge){for(var Pt=0,ot=0,Dn=0,$n=0,Ln,vn,On=0,Br=0,bn,et=bn=Ln=0,te=0,ue=0,ye=0,We=0,Je=$e.length,bt=Je-1,St,Ne="",wt="",Rt="",Wt="",cn;te<Je;){if(vn=$e.charCodeAt(te),te===bt&&ot+$n+Dn+Pt!==0&&(ot!==0&&(vn=ot===47?10:47),$n=Dn=Pt=0,Je++,bt++),ot+$n+Dn+Pt===0){if(te===bt&&(0<ue&&(Ne=Ne.replace(U,"")),0<Ne.trim().length)){switch(vn){case 32:case 9:case 59:case 13:case 10:break;default:Ne+=$e.charAt(te)}vn=59}switch(vn){case 123:for(Ne=Ne.trim(),Ln=Ne.charCodeAt(0),bn=1,We=++te;te<Je;){switch(vn=$e.charCodeAt(te)){case 123:bn++;break;case 125:bn--;break;case 47:switch(vn=$e.charCodeAt(te+1)){case 42:case 47:e:{for(et=te+1;et<bt;++et)switch($e.charCodeAt(et)){case 47:if(vn===42&&$e.charCodeAt(et-1)===42&&te+2!==et){te=et+1;break e}break;case 10:if(vn===47){te=et+1;break e}}te=et}}break;case 91:vn++;case 40:vn++;case 34:case 39:for(;te++<bt&&$e.charCodeAt(te)!==vn;);}if(bn===0)break;te++}switch(bn=$e.substring(We,te),Ln===0&&(Ln=(Ne=Ne.replace(F,"").trim()).charCodeAt(0)),Ln){case 64:switch(0<ue&&(Ne=Ne.replace(U,"")),vn=Ne.charCodeAt(1),vn){case 100:case 109:case 115:case 45:ue=He;break;default:ue=zt}if(bn=o(He,ue,bn,vn,ge+1),We=bn.length,0<Te&&(ue=a(zt,Ne,ye),cn=T(3,bn,ue,He,Be,Ue,We,vn,ge,xt),Ne=ue.join(""),cn!==void 0&&(We=(bn=cn.trim()).length)===0&&(vn=0,bn="")),0<We)switch(vn){case 115:Ne=Ne.replace(de,x);case 100:case 109:case 45:bn=Ne+"{"+bn+"}";break;case 107:Ne=Ne.replace(G,"$1 $2"),bn=Ne+"{"+bn+"}",bn=_t===1||_t===2&&_("@"+bn,3)?"@-webkit-"+bn+"@"+bn:"@"+bn;break;default:bn=Ne+bn,xt===112&&(bn=(wt+=bn,""))}else bn="";break;default:bn=o(He,a(He,Ne,ye),bn,xt,ge+1)}Rt+=bn,bn=ye=ue=et=Ln=0,Ne="",vn=$e.charCodeAt(++te);break;case 125:case 59:if(Ne=(0<ue?Ne.replace(U,""):Ne).trim(),1<(We=Ne.length))switch(et===0&&(Ln=Ne.charCodeAt(0),Ln===45||96<Ln&&123>Ln)&&(We=(Ne=Ne.replace(" ",":")).length),0<Te&&(cn=T(1,Ne,He,De,Be,Ue,wt.length,xt,ge,xt))!==void 0&&(We=(Ne=cn.trim()).length)===0&&(Ne="\0\0"),Ln=Ne.charCodeAt(0),vn=Ne.charCodeAt(1),Ln){case 0:break;case 64:if(vn===105||vn===99){Wt+=Ne+$e.charAt(te);break}default:Ne.charCodeAt(We-1)!==58&&(wt+=p(Ne,Ln,vn,Ne.charCodeAt(2)))}ye=ue=et=Ln=0,Ne="",vn=$e.charCodeAt(++te)}}switch(vn){case 13:case 10:ot===47?ot=0:1+Ln===0&&xt!==107&&0<Ne.length&&(ue=1,Ne+="\0"),0<Te*Q&&T(0,Ne,He,De,Be,Ue,wt.length,xt,ge,xt),Ue=1,Be++;break;case 59:case 125:if(ot+$n+Dn+Pt===0){Ue++;break}default:switch(Ue++,St=$e.charAt(te),vn){case 9:case 32:if($n+Pt+ot===0)switch(On){case 44:case 58:case 9:case 32:St="";break;default:vn!==32&&(St=" ")}break;case 0:St="\\0";break;case 12:St="\\f";break;case 11:St="\\v";break;case 38:$n+ot+Pt===0&&(ue=ye=1,St="\f"+St);break;case 108:if($n+ot+Pt+rt===0&&0<et)switch(te-et){case 2:On===112&&$e.charCodeAt(te-3)===58&&(rt=On);case 8:Br===111&&(rt=Br)}break;case 58:$n+ot+Pt===0&&(et=te);break;case 44:ot+Dn+$n+Pt===0&&(ue=1,St+="\r");break;case 34:case 39:ot===0&&($n=$n===vn?0:$n===0?vn:$n);break;case 91:$n+ot+Dn===0&&Pt++;break;case 93:$n+ot+Dn===0&&Pt--;break;case 41:$n+ot+Pt===0&&Dn--;break;case 40:if($n+ot+Pt===0){if(Ln===0)switch(2*On+3*Br){case 533:break;default:Ln=1}Dn++}break;case 64:ot+Dn+$n+Pt+et+bn===0&&(bn=1);break;case 42:case 47:if(!(0<$n+Pt+Dn))switch(ot){case 0:switch(2*vn+3*$e.charCodeAt(te+1)){case 235:ot=47;break;case 220:We=te,ot=42}break;case 42:vn===47&&On===42&&We+2!==te&&($e.charCodeAt(We+2)===33&&(wt+=$e.substring(We,te+1)),St="",ot=0)}}ot===0&&(Ne+=St)}Br=On,On=vn,te++}if(We=wt.length,0<We){if(ue=He,0<Te&&(cn=T(2,wt,ue,De,Be,Ue,We,xt,ge,xt),cn!==void 0&&(wt=cn).length===0))return Wt+wt+Rt;if(wt=ue.join(",")+"{"+wt+"}",_t*rt!==0){switch(_t!==2||_(wt,2)||(rt=0),rt){case 111:wt=wt.replace(W,":-moz-$1")+wt;break;case 112:wt=wt.replace(ee,"::-webkit-input-$1")+wt.replace(ee,"::-moz-$1")+wt.replace(ee,":-ms-input-$1")+wt}rt=0}}return Wt+wt+Rt}function a(De,He,$e){var xt=He.trim().split(ie);He=xt;var ge=xt.length,Pt=De.length;switch(Pt){case 0:case 1:var ot=0;for(De=Pt===0?"":De[0]+" ";ot<ge;++ot)He[ot]=c(De,He[ot],$e).trim();break;default:var Dn=ot=0;for(He=[];ot<ge;++ot)for(var $n=0;$n<Pt;++$n)He[Dn++]=c(De[$n]+" ",xt[ot],$e).trim()}return He}function c(De,He,$e){var xt=He.charCodeAt(0);switch(33>xt&&(xt=(He=He.trim()).charCodeAt(0)),xt){case 38:return He.replace(H,"$1"+De.trim());case 58:return De.trim()+He.replace(H,"$1"+De.trim());default:if(0<1*$e&&0<He.indexOf("\f"))return He.replace(H,(De.charCodeAt(0)===58?"":"$1")+De.trim())}return De+He}function p(De,He,$e,xt){var ge=De+";",Pt=2*He+3*$e+4*xt;if(Pt===944){De=ge.indexOf(":",9)+1;var ot=ge.substring(De,ge.length-1).trim();return ot=ge.substring(0,De).trim()+ot+";",_t===1||_t===2&&_(ot,1)?"-webkit-"+ot+ot:ot}if(_t===0||_t===2&&!_(ge,1))return ge;switch(Pt){case 1015:return ge.charCodeAt(10)===97?"-webkit-"+ge+ge:ge;case 951:return ge.charCodeAt(3)===116?"-webkit-"+ge+ge:ge;case 963:return ge.charCodeAt(5)===110?"-webkit-"+ge+ge:ge;case 1009:if(ge.charCodeAt(4)!==100)break;case 969:case 942:return"-webkit-"+ge+ge;case 978:return"-webkit-"+ge+"-moz-"+ge+ge;case 1019:case 983:return"-webkit-"+ge+"-moz-"+ge+"-ms-"+ge+ge;case 883:if(ge.charCodeAt(8)===45)return"-webkit-"+ge+ge;if(0<ge.indexOf("image-set(",11))return ge.replace(ze,"$1-webkit-$2")+ge;break;case 932:if(ge.charCodeAt(4)===45)switch(ge.charCodeAt(5)){case 103:return"-webkit-box-"+ge.replace("-grow","")+"-webkit-"+ge+"-ms-"+ge.replace("grow","positive")+ge;case 115:return"-webkit-"+ge+"-ms-"+ge.replace("shrink","negative")+ge;case 98:return"-webkit-"+ge+"-ms-"+ge.replace("basis","preferred-size")+ge}return"-webkit-"+ge+"-ms-"+ge+ge;case 964:return"-webkit-"+ge+"-ms-flex-"+ge+ge;case 1023:if(ge.charCodeAt(8)!==99)break;return ot=ge.substring(ge.indexOf(":",15)).replace("flex-","").replace("space-between","justify"),"-webkit-box-pack"+ot+"-webkit-"+ge+"-ms-flex-pack"+ot+ge;case 1005:return $.test(ge)?ge.replace(Z,":-webkit-")+ge.replace(Z,":-moz-")+ge:ge;case 1e3:switch(ot=ge.substring(13).trim(),He=ot.indexOf("-")+1,ot.charCodeAt(0)+ot.charCodeAt(He)){case 226:ot=ge.replace(me,"tb");break;case 232:ot=ge.replace(me,"tb-rl");break;case 220:ot=ge.replace(me,"lr");break;default:return ge}return"-webkit-"+ge+"-ms-"+ot+ge;case 1017:if(ge.indexOf("sticky",9)===-1)break;case 975:switch(He=(ge=De).length-10,ot=(ge.charCodeAt(He)===33?ge.substring(0,He):ge).substring(De.indexOf(":",7)+1).trim(),Pt=ot.charCodeAt(0)+(ot.charCodeAt(7)|0)){case 203:if(111>ot.charCodeAt(8))break;case 115:ge=ge.replace(ot,"-webkit-"+ot)+";"+ge;break;case 207:case 102:ge=ge.replace(ot,"-webkit-"+(102<Pt?"inline-":"")+"box")+";"+ge.replace(ot,"-webkit-"+ot)+";"+ge.replace(ot,"-ms-"+ot+"box")+";"+ge}return ge+";";case 938:if(ge.charCodeAt(5)===45)switch(ge.charCodeAt(6)){case 105:return ot=ge.replace("-items",""),"-webkit-"+ge+"-webkit-box-"+ot+"-ms-flex-"+ot+ge;case 115:return"-webkit-"+ge+"-ms-flex-item-"+ge.replace(se,"")+ge;default:return"-webkit-"+ge+"-ms-flex-line-pack"+ge.replace("align-content","").replace(se,"")+ge}break;case 973:case 989:if(ge.charCodeAt(3)!==45||ge.charCodeAt(4)===122)break;case 931:case 953:if(Se.test(De)===!0)return(ot=De.substring(De.indexOf(":")+1)).charCodeAt(0)===115?p(De.replace("stretch","fill-available"),He,$e,xt).replace(":fill-available",":stretch"):ge.replace(ot,"-webkit-"+ot)+ge.replace(ot,"-moz-"+ot.replace("fill-",""))+ge;break;case 962:if(ge="-webkit-"+ge+(ge.charCodeAt(5)===102?"-ms-"+ge:"")+ge,$e+xt===211&&ge.charCodeAt(13)===105&&0<ge.indexOf("transform",10))return ge.substring(0,ge.indexOf(";",27)+1).replace(K,"$1-webkit-$2")+ge}return ge}function _(De,He){var $e=De.indexOf(He===1?":":"{"),xt=De.substring(0,He!==3?$e:10);return $e=De.substring($e+1,De.length-1),we(He!==2?xt:xt.replace(q,"$1"),$e,He)}function x(De,He){var $e=p(He,He.charCodeAt(0),He.charCodeAt(1),He.charCodeAt(2));return $e!==He+";"?$e.replace(he," or ($1)").substring(4):"("+He+")"}function T(De,He,$e,xt,ge,Pt,ot,Dn,$n,Ln){for(var vn=0,On=He,Br;vn<Te;++vn)switch(Br=dt[vn].call(O,De,On,$e,xt,ge,Pt,ot,Dn,$n,Ln)){case void 0:case!1:case!0:case null:break;default:On=Br}if(On!==He)return On}function C(De){switch(De){case void 0:case null:Te=dt.length=0;break;default:if(typeof De=="function")dt[Te++]=De;else if(typeof De=="object")for(var He=0,$e=De.length;He<$e;++He)C(De[He]);else Q=!!De|0}return C}function P(De){return De=De.prefix,De!==void 0&&(we=null,De?typeof De!="function"?_t=1:(_t=2,we=De):_t=0),P}function O(De,He){var $e=De;if(33>$e.charCodeAt(0)&&($e=$e.trim()),ce=$e,$e=[ce],0<Te){var xt=T(-1,He,$e,$e,Be,Ue,0,0,0,0);xt!==void 0&&typeof xt=="string"&&(He=xt)}var ge=o(zt,$e,He,0,0);return 0<Te&&(xt=T(-2,ge,$e,$e,Be,Ue,ge.length,0,0,0),xt!==void 0&&(ge=xt)),ce="",rt=0,Ue=Be=1,ge}var F=/^\0+/g,U=/[\0\r\f]/g,Z=/: */g,$=/zoo|gra/,K=/([,: ])(transform)/g,ie=/,\r+?/g,H=/([\t\r\n ])*\f?&/g,G=/@(k\w+)\s*(\S*)\s*/,ee=/::(place)/g,W=/:(read-only)/g,me=/[svh]\w+-[tblr]{2}/,de=/\(\s*(.*)\s*\)/g,he=/([\s\S]*?);/g,se=/-self|flex-/g,q=/[^]*?(:[rp][el]a[\w-]+)[^]*/,Se=/stretch|:\s*\w+\-(?:conte|avail)/,ze=/([^-])(image-set\()/,Ue=1,Be=1,rt=0,_t=1,zt=[],dt=[],Te=0,we=null,Q=0,ce="";return O.use=C,O.set=P,r!==void 0&&P(r),O}var Rq={animationIterationCount:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1};function Dq(r){var o=Object.create(null);return function(a){return o[a]===void 0&&(o[a]=r(a)),o[a]}}var Lq=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|download|draggable|encType|enterKeyHint|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,bL=Dq(function(r){return Lq.test(r)||r.charCodeAt(0)===111&&r.charCodeAt(1)===110&&r.charCodeAt(2)<91}),wM=xM,Oq={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},zq={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},Fq={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},G5={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},bM={};bM[wM.ForwardRef]=Fq;bM[wM.Memo]=G5;function SL(r){return wM.isMemo(r)?G5:bM[r.$$typeof]||Oq}var Bq=Object.defineProperty,Nq=Object.getOwnPropertyNames,EL=Object.getOwnPropertySymbols,jq=Object.getOwnPropertyDescriptor,Uq=Object.getPrototypeOf,TL=Object.prototype;function H5(r,o,a){if(typeof o!="string"){if(TL){var c=Uq(o);c&&c!==TL&&H5(r,c,a)}var p=Nq(o);EL&&(p=p.concat(EL(o)));for(var _=SL(r),x=SL(o),T=0;T<p.length;++T){var C=p[T];if(!zq[C]&&!(a&&a[C])&&!(x&&x[C])&&!(_&&_[C])){var P=jq(o,C);try{Bq(r,C,P)}catch{}}}}return r}var Vq=H5;const $q=Yb(Vq);function pu(){return(pu=Object.assign||function(r){for(var o=1;o<arguments.length;o++){var a=arguments[o];for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(r[c]=a[c])}return r}).apply(this,arguments)}var CL=function(r,o){for(var a=[r[0]],c=0,p=o.length;c<p;c+=1)a.push(o[c],r[c+1]);return a},NC=function(r){return r!==null&&typeof r=="object"&&(r.toString?r.toString():Object.prototype.toString.call(r))==="[object Object]"&&!xM.typeOf(r)},Rb=Object.freeze([]),Qh=Object.freeze({});function Lg(r){return typeof r=="function"}function AL(r){return r.displayName||r.name||"Component"}function SM(r){return r&&typeof r.styledComponentId=="string"}var Og=typeof process<"u"&&process.env!==void 0&&({}.REACT_APP_SC_ATTR||{}.SC_ATTR)||"data-styled",EM=typeof window<"u"&&"HTMLElement"in window,Gq=!!(typeof SC_DISABLE_SPEEDY=="boolean"?SC_DISABLE_SPEEDY:typeof process<"u"&&process.env!==void 0&&({}.REACT_APP_SC_DISABLE_SPEEDY!==void 0&&{}.REACT_APP_SC_DISABLE_SPEEDY!==""?{}.REACT_APP_SC_DISABLE_SPEEDY!=="false"&&{}.REACT_APP_SC_DISABLE_SPEEDY:{}.SC_DISABLE_SPEEDY!==void 0&&{}.SC_DISABLE_SPEEDY!==""&&{}.SC_DISABLE_SPEEDY!=="false"&&{}.SC_DISABLE_SPEEDY));function Bf(r){for(var o=arguments.length,a=new Array(o>1?o-1:0),c=1;c<o;c++)a[c-1]=arguments[c];throw new Error("An error occurred. See https://git.io/JUIaE#"+r+" for more information."+(a.length>0?" Args: "+a.join(", "):""))}var Hq=function(){function r(a){this.groupSizes=new Uint32Array(512),this.length=512,this.tag=a}var o=r.prototype;return o.indexOfGroup=function(a){for(var c=0,p=0;p<a;p++)c+=this.groupSizes[p];return c},o.insertRules=function(a,c){if(a>=this.groupSizes.length){for(var p=this.groupSizes,_=p.length,x=_;a>=x;)(x<<=1)<0&&Bf(16,""+a);this.groupSizes=new Uint32Array(x),this.groupSizes.set(p),this.length=x;for(var T=_;T<x;T++)this.groupSizes[T]=0}for(var C=this.indexOfGroup(a+1),P=0,O=c.length;P<O;P++)this.tag.insertRule(C,c[P])&&(this.groupSizes[a]++,C++)},o.clearGroup=function(a){if(a<this.length){var c=this.groupSizes[a],p=this.indexOfGroup(a),_=p+c;this.groupSizes[a]=0;for(var x=p;x<_;x++)this.tag.deleteRule(p)}},o.getGroup=function(a){var c="";if(a>=this.length||this.groupSizes[a]===0)return c;for(var p=this.groupSizes[a],_=this.indexOfGroup(a),x=_+p,T=_;T<x;T++)c+=this.tag.getRule(T)+`/*!sc*/
`;return c},r}(),Fw=new Map,Db=new Map,D0=1,ew=function(r){if(Fw.has(r))return Fw.get(r);for(;Db.has(D0);)D0++;var o=D0++;return Fw.set(r,o),Db.set(o,r),o},qq=function(r){return Db.get(r)},Wq=function(r,o){o>=D0&&(D0=o+1),Fw.set(r,o),Db.set(o,r)},Zq="style["+Og+'][data-styled-version="5.3.11"]',Xq=new RegExp("^"+Og+'\\.g(\\d+)\\[id="([\\w\\d-]+)"\\].*?"([^"]*)'),Kq=function(r,o,a){for(var c,p=a.split(","),_=0,x=p.length;_<x;_++)(c=p[_])&&r.registerName(o,c)},Yq=function(r,o){for(var a=(o.textContent||"").split(`/*!sc*/
`),c=[],p=0,_=a.length;p<_;p++){var x=a[p].trim();if(x){var T=x.match(Xq);if(T){var C=0|parseInt(T[1],10),P=T[2];C!==0&&(Wq(P,C),Kq(r,P,T[3]),r.getTag().insertRules(C,c)),c.length=0}else c.push(x)}}},Qq=function(){return typeof __webpack_nonce__<"u"?__webpack_nonce__:null},q5=function(r){var o=document.head,a=r||o,c=document.createElement("style"),p=function(T){for(var C=T.childNodes,P=C.length;P>=0;P--){var O=C[P];if(O&&O.nodeType===1&&O.hasAttribute(Og))return O}}(a),_=p!==void 0?p.nextSibling:null;c.setAttribute(Og,"active"),c.setAttribute("data-styled-version","5.3.11");var x=Qq();return x&&c.setAttribute("nonce",x),a.insertBefore(c,_),c},Jq=function(){function r(a){var c=this.element=q5(a);c.appendChild(document.createTextNode("")),this.sheet=function(p){if(p.sheet)return p.sheet;for(var _=document.styleSheets,x=0,T=_.length;x<T;x++){var C=_[x];if(C.ownerNode===p)return C}Bf(17)}(c),this.length=0}var o=r.prototype;return o.insertRule=function(a,c){try{return this.sheet.insertRule(c,a),this.length++,!0}catch{return!1}},o.deleteRule=function(a){this.sheet.deleteRule(a),this.length--},o.getRule=function(a){var c=this.sheet.cssRules[a];return c!==void 0&&typeof c.cssText=="string"?c.cssText:""},r}(),eW=function(){function r(a){var c=this.element=q5(a);this.nodes=c.childNodes,this.length=0}var o=r.prototype;return o.insertRule=function(a,c){if(a<=this.length&&a>=0){var p=document.createTextNode(c),_=this.nodes[a];return this.element.insertBefore(p,_||null),this.length++,!0}return!1},o.deleteRule=function(a){this.element.removeChild(this.nodes[a]),this.length--},o.getRule=function(a){return a<this.length?this.nodes[a].textContent:""},r}(),tW=function(){function r(a){this.rules=[],this.length=0}var o=r.prototype;return o.insertRule=function(a,c){return a<=this.length&&(this.rules.splice(a,0,c),this.length++,!0)},o.deleteRule=function(a){this.rules.splice(a,1),this.length--},o.getRule=function(a){return a<this.length?this.rules[a]:""},r}(),ML=EM,nW={isServer:!EM,useCSSOMInjection:!Gq},W5=function(){function r(a,c,p){a===void 0&&(a=Qh),c===void 0&&(c={}),this.options=pu({},nW,{},a),this.gs=c,this.names=new Map(p),this.server=!!a.isServer,!this.server&&EM&&ML&&(ML=!1,function(_){for(var x=document.querySelectorAll(Zq),T=0,C=x.length;T<C;T++){var P=x[T];P&&P.getAttribute(Og)!=="active"&&(Yq(_,P),P.parentNode&&P.parentNode.removeChild(P))}}(this))}r.registerId=function(a){return ew(a)};var o=r.prototype;return o.reconstructWithOptions=function(a,c){return c===void 0&&(c=!0),new r(pu({},this.options,{},a),this.gs,c&&this.names||void 0)},o.allocateGSInstance=function(a){return this.gs[a]=(this.gs[a]||0)+1},o.getTag=function(){return this.tag||(this.tag=(p=(c=this.options).isServer,_=c.useCSSOMInjection,x=c.target,a=p?new tW(x):_?new Jq(x):new eW(x),new Hq(a)));var a,c,p,_,x},o.hasNameForId=function(a,c){return this.names.has(a)&&this.names.get(a).has(c)},o.registerName=function(a,c){if(ew(a),this.names.has(a))this.names.get(a).add(c);else{var p=new Set;p.add(c),this.names.set(a,p)}},o.insertRules=function(a,c,p){this.registerName(a,c),this.getTag().insertRules(ew(a),p)},o.clearNames=function(a){this.names.has(a)&&this.names.get(a).clear()},o.clearRules=function(a){this.getTag().clearGroup(ew(a)),this.clearNames(a)},o.clearTag=function(){this.tag=void 0},o.toString=function(){return function(a){for(var c=a.getTag(),p=c.length,_="",x=0;x<p;x++){var T=qq(x);if(T!==void 0){var C=a.names.get(T),P=c.getGroup(x);if(C&&P&&C.size){var O=Og+".g"+x+'[id="'+T+'"]',F="";C!==void 0&&C.forEach(function(U){U.length>0&&(F+=U+",")}),_+=""+P+O+'{content:"'+F+`"}/*!sc*/
`}}}return _}(this)},r}(),rW=/(a)(d)/gi,IL=function(r){return String.fromCharCode(r+(r>25?39:97))};function jC(r){var o,a="";for(o=Math.abs(r);o>52;o=o/52|0)a=IL(o%52)+a;return(IL(o%52)+a).replace(rW,"$1-$2")}var fg=function(r,o){for(var a=o.length;a;)r=33*r^o.charCodeAt(--a);return r},Z5=function(r){return fg(5381,r)};function iW(r){for(var o=0;o<r.length;o+=1){var a=r[o];if(Lg(a)&&!SM(a))return!1}return!0}var oW=Z5("5.3.11"),sW=function(){function r(o,a,c){this.rules=o,this.staticRulesId="",this.isStatic=(c===void 0||c.isStatic)&&iW(o),this.componentId=a,this.baseHash=fg(oW,a),this.baseStyle=c,W5.registerId(a)}return r.prototype.generateAndInjectStyles=function(o,a,c){var p=this.componentId,_=[];if(this.baseStyle&&_.push(this.baseStyle.generateAndInjectStyles(o,a,c)),this.isStatic&&!c.hash)if(this.staticRulesId&&a.hasNameForId(p,this.staticRulesId))_.push(this.staticRulesId);else{var x=zg(this.rules,o,a,c).join(""),T=jC(fg(this.baseHash,x)>>>0);if(!a.hasNameForId(p,T)){var C=c(x,"."+T,void 0,p);a.insertRules(p,T,C)}_.push(T),this.staticRulesId=T}else{for(var P=this.rules.length,O=fg(this.baseHash,c.hash),F="",U=0;U<P;U++){var Z=this.rules[U];if(typeof Z=="string")F+=Z;else if(Z){var $=zg(Z,o,a,c),K=Array.isArray($)?$.join(""):$;O=fg(O,K+U),F+=K}}if(F){var ie=jC(O>>>0);if(!a.hasNameForId(p,ie)){var H=c(F,"."+ie,void 0,p);a.insertRules(p,ie,H)}_.push(ie)}}return _.join(" ")},r}(),aW=/^\s*\/\/.*$/gm,lW=[":","[",".","#"];function uW(r){var o,a,c,p,_=r===void 0?Qh:r,x=_.options,T=x===void 0?Qh:x,C=_.plugins,P=C===void 0?Rb:C,O=new Pq(T),F=[],U=function(K){function ie(H){if(H)try{K(H+"}")}catch{}}return function(H,G,ee,W,me,de,he,se,q,Se){switch(H){case 1:if(q===0&&G.charCodeAt(0)===64)return K(G+";"),"";break;case 2:if(se===0)return G+"/*|*/";break;case 3:switch(se){case 102:case 112:return K(ee[0]+G),"";default:return G+(Se===0?"/*|*/":"")}case-2:G.split("/*|*/}").forEach(ie)}}}(function(K){F.push(K)}),Z=function(K,ie,H){return ie===0&&lW.indexOf(H[a.length])!==-1||H.match(p)?K:"."+o};function $(K,ie,H,G){G===void 0&&(G="&");var ee=K.replace(aW,""),W=ie&&H?H+" "+ie+" { "+ee+" }":ee;return o=G,a=ie,c=new RegExp("\\"+a+"\\b","g"),p=new RegExp("(\\"+a+"\\b){2,}"),O(H||!ie?"":ie,W)}return O.use([].concat(P,[function(K,ie,H){K===2&&H.length&&H[0].lastIndexOf(a)>0&&(H[0]=H[0].replace(c,Z))},U,function(K){if(K===-2){var ie=F;return F=[],ie}}])),$.hash=P.length?P.reduce(function(K,ie){return ie.name||Bf(15),fg(K,ie.name)},5381).toString():"",$}var X5=Xn.createContext();X5.Consumer;var K5=Xn.createContext(),cW=(K5.Consumer,new W5),UC=uW();function hW(){return _e.useContext(X5)||cW}function dW(){return _e.useContext(K5)||UC}var Y5=function(){function r(o,a){var c=this;this.inject=function(p,_){_===void 0&&(_=UC);var x=c.name+_.hash;p.hasNameForId(c.id,x)||p.insertRules(c.id,x,_(c.rules,x,"@keyframes"))},this.toString=function(){return Bf(12,String(c.name))},this.name=o,this.id="sc-keyframes-"+o,this.rules=a}return r.prototype.getName=function(o){return o===void 0&&(o=UC),this.name+o.hash},r}(),fW=/([A-Z])/,pW=/([A-Z])/g,mW=/^ms-/,gW=function(r){return"-"+r.toLowerCase()};function kL(r){return fW.test(r)?r.replace(pW,gW).replace(mW,"-ms-"):r}var PL=function(r){return r==null||r===!1||r===""};function zg(r,o,a,c){if(Array.isArray(r)){for(var p,_=[],x=0,T=r.length;x<T;x+=1)(p=zg(r[x],o,a,c))!==""&&(Array.isArray(p)?_.push.apply(_,p):_.push(p));return _}if(PL(r))return"";if(SM(r))return"."+r.styledComponentId;if(Lg(r)){if(typeof(P=r)!="function"||P.prototype&&P.prototype.isReactComponent||!o)return r;var C=r(o);return zg(C,o,a,c)}var P;return r instanceof Y5?a?(r.inject(a,c),r.getName(c)):r:NC(r)?function O(F,U){var Z,$,K=[];for(var ie in F)F.hasOwnProperty(ie)&&!PL(F[ie])&&(Array.isArray(F[ie])&&F[ie].isCss||Lg(F[ie])?K.push(kL(ie)+":",F[ie],";"):NC(F[ie])?K.push.apply(K,O(F[ie],ie)):K.push(kL(ie)+": "+(Z=ie,($=F[ie])==null||typeof $=="boolean"||$===""?"":typeof $!="number"||$===0||Z in Rq||Z.startsWith("--")?String($).trim():$+"px")+";"));return U?[U+" {"].concat(K,["}"]):K}(r):r.toString()}var RL=function(r){return Array.isArray(r)&&(r.isCss=!0),r};function Jh(r){for(var o=arguments.length,a=new Array(o>1?o-1:0),c=1;c<o;c++)a[c-1]=arguments[c];return Lg(r)||NC(r)?RL(zg(CL(Rb,[r].concat(a)))):a.length===0&&r.length===1&&typeof r[0]=="string"?r:RL(zg(CL(r,a)))}var yW=function(r,o,a){return a===void 0&&(a=Qh),r.theme!==a.theme&&r.theme||o||a.theme},_W=/[!"#$%&'()*+,./:;<=>?@[\\\]^`{|}~-]+/g,vW=/(^-|-$)/g;function pT(r){return r.replace(_W,"-").replace(vW,"")}var Q5=function(r){return jC(Z5(r)>>>0)};function tw(r){return typeof r=="string"&&!0}var VC=function(r){return typeof r=="function"||typeof r=="object"&&r!==null&&!Array.isArray(r)},xW=function(r){return r!=="__proto__"&&r!=="constructor"&&r!=="prototype"};function wW(r,o,a){var c=r[a];VC(o)&&VC(c)?J5(c,o):r[a]=o}function J5(r){for(var o=arguments.length,a=new Array(o>1?o-1:0),c=1;c<o;c++)a[c-1]=arguments[c];for(var p=0,_=a;p<_.length;p++){var x=_[p];if(VC(x))for(var T in x)xW(T)&&wW(r,x[T],T)}return r}var Lb=Xn.createContext();Lb.Consumer;function bW(r){var o=_e.useContext(Lb),a=_e.useMemo(function(){return function(c,p){if(!c)return Bf(14);if(Lg(c)){var _=c(p);return _}return Array.isArray(c)||typeof c!="object"?Bf(8):p?pu({},p,{},c):c}(r.theme,o)},[r.theme,o]);return r.children?Xn.createElement(Lb.Provider,{value:a},r.children):null}var mT={};function eF(r,o,a){var c=SM(r),p=!tw(r),_=o.attrs,x=_===void 0?Rb:_,T=o.componentId,C=T===void 0?function(G,ee){var W=typeof G!="string"?"sc":pT(G);mT[W]=(mT[W]||0)+1;var me=W+"-"+Q5("5.3.11"+W+mT[W]);return ee?ee+"-"+me:me}(o.displayName,o.parentComponentId):T,P=o.displayName,O=P===void 0?function(G){return tw(G)?"styled."+G:"Styled("+AL(G)+")"}(r):P,F=o.displayName&&o.componentId?pT(o.displayName)+"-"+o.componentId:o.componentId||C,U=c&&r.attrs?Array.prototype.concat(r.attrs,x).filter(Boolean):x,Z=o.shouldForwardProp;c&&r.shouldForwardProp&&(Z=o.shouldForwardProp?function(G,ee,W){return r.shouldForwardProp(G,ee,W)&&o.shouldForwardProp(G,ee,W)}:r.shouldForwardProp);var $,K=new sW(a,F,c?r.componentStyle:void 0),ie=K.isStatic&&x.length===0,H=function(G,ee){return function(W,me,de,he){var se=W.attrs,q=W.componentStyle,Se=W.defaultProps,ze=W.foldedComponentIds,Ue=W.shouldForwardProp,Be=W.styledComponentId,rt=W.target,_t=function(xt,ge,Pt){xt===void 0&&(xt=Qh);var ot=pu({},ge,{theme:xt}),Dn={};return Pt.forEach(function($n){var Ln,vn,On,Br=$n;for(Ln in Lg(Br)&&(Br=Br(ot)),Br)ot[Ln]=Dn[Ln]=Ln==="className"?(vn=Dn[Ln],On=Br[Ln],vn&&On?vn+" "+On:vn||On):Br[Ln]}),[ot,Dn]}(yW(me,_e.useContext(Lb),Se)||Qh,me,se),zt=_t[0],dt=_t[1],Te=function(xt,ge,Pt,ot){var Dn=hW(),$n=dW(),Ln=ge?xt.generateAndInjectStyles(Qh,Dn,$n):xt.generateAndInjectStyles(Pt,Dn,$n);return Ln}(q,he,zt),we=de,Q=dt.$as||me.$as||dt.as||me.as||rt,ce=tw(Q),De=dt!==me?pu({},me,{},dt):me,He={};for(var $e in De)$e[0]!=="$"&&$e!=="as"&&($e==="forwardedAs"?He.as=De[$e]:(Ue?Ue($e,bL,Q):!ce||bL($e))&&(He[$e]=De[$e]));return me.style&&dt.style!==me.style&&(He.style=pu({},me.style,{},dt.style)),He.className=Array.prototype.concat(ze,Be,Te!==Be?Te:null,me.className,dt.className).filter(Boolean).join(" "),He.ref=we,_e.createElement(Q,He)}($,G,ee,ie)};return H.displayName=O,($=Xn.forwardRef(H)).attrs=U,$.componentStyle=K,$.displayName=O,$.shouldForwardProp=Z,$.foldedComponentIds=c?Array.prototype.concat(r.foldedComponentIds,r.styledComponentId):Rb,$.styledComponentId=F,$.target=c?r.target:r,$.withComponent=function(G){var ee=o.componentId,W=function(de,he){if(de==null)return{};var se,q,Se={},ze=Object.keys(de);for(q=0;q<ze.length;q++)se=ze[q],he.indexOf(se)>=0||(Se[se]=de[se]);return Se}(o,["componentId"]),me=ee&&ee+"-"+(tw(G)?G:pT(AL(G)));return eF(G,pu({},W,{attrs:U,componentId:me}),a)},Object.defineProperty($,"defaultProps",{get:function(){return this._foldedDefaultProps},set:function(G){this._foldedDefaultProps=c?J5({},r.defaultProps,G):G}}),Object.defineProperty($,"toString",{value:function(){return"."+$.styledComponentId}}),p&&$q($,r,{attrs:!0,componentStyle:!0,displayName:!0,foldedComponentIds:!0,shouldForwardProp:!0,styledComponentId:!0,target:!0,withComponent:!0}),$}var $C=function(r){return function o(a,c,p){if(p===void 0&&(p=Qh),!xM.isValidElementType(c))return Bf(1,String(c));var _=function(){return a(c,p,Jh.apply(void 0,arguments))};return _.withConfig=function(x){return o(a,c,pu({},p,{},x))},_.attrs=function(x){return o(a,c,pu({},p,{attrs:Array.prototype.concat(p.attrs,x).filter(Boolean)}))},_}(eF,r)};["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","marker","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","textPath","tspan"].forEach(function(r){$C[r]=$C(r)});function tF(r){for(var o=arguments.length,a=new Array(o>1?o-1:0),c=1;c<o;c++)a[c-1]=arguments[c];var p=Jh.apply(void 0,[r].concat(a)).join(""),_=Q5(p);return new Y5(_,p)}const Tr=$C,mu=Tr.button`
  width: ${({width:r})=>r||null};
  height: ${({height:r})=>r||null};
  margin: 0;
  padding: 0;
  border: ${({border:r})=>r||"none"};
  border-radius: ${({borderRadius:r})=>r||null};
  pointer-events: ${({disabled:r})=>r?"none":"auto"};
  background: none;
  background-color: ${({backgroundColor:r})=>r??"none"};

  :hover {
    cursor: pointer;
  }
`;Tr(mu)`
  background-color: ${({theme:r,backgroundColor:o})=>o??r.primary};

  &:hover {
    background-color: ${({theme:r,hoverBackgroundColor:o})=>o??r.secondary};
  }

  transition: transform ease-in 0.1s;

  &:active {
    transform: scale(0.95);
  }

  ${({size:r})=>{switch(r){case"small":return Jh`
          font-size: 0.75rem;
          padding: 5px 8px;
          border-radius: 6px;
        `;case"medium":default:return Jh`
          font-size: 1rem;
          padding: 8px 12px;
          border-radius: 8px;
        `;case"large":return Jh`
          font-size: 1.25rem;
          padding: 10px 16px;
          border-radius: 10px;
        `}}}
`;function SW(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var nF={exports:{}},gr={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var DL;function EW(){if(DL)return gr;DL=1;var r=Symbol.for("react.element"),o=Symbol.for("react.portal"),a=Symbol.for("react.fragment"),c=Symbol.for("react.strict_mode"),p=Symbol.for("react.profiler"),_=Symbol.for("react.provider"),x=Symbol.for("react.context"),T=Symbol.for("react.forward_ref"),C=Symbol.for("react.suspense"),P=Symbol.for("react.memo"),O=Symbol.for("react.lazy"),F=Symbol.iterator;function U(Q){return Q===null||typeof Q!="object"?null:(Q=F&&Q[F]||Q["@@iterator"],typeof Q=="function"?Q:null)}var Z={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},$=Object.assign,K={};function ie(Q,ce,De){this.props=Q,this.context=ce,this.refs=K,this.updater=De||Z}ie.prototype.isReactComponent={},ie.prototype.setState=function(Q,ce){if(typeof Q!="object"&&typeof Q!="function"&&Q!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,Q,ce,"setState")},ie.prototype.forceUpdate=function(Q){this.updater.enqueueForceUpdate(this,Q,"forceUpdate")};function H(){}H.prototype=ie.prototype;function G(Q,ce,De){this.props=Q,this.context=ce,this.refs=K,this.updater=De||Z}var ee=G.prototype=new H;ee.constructor=G,$(ee,ie.prototype),ee.isPureReactComponent=!0;var W=Array.isArray,me=Object.prototype.hasOwnProperty,de={current:null},he={key:!0,ref:!0,__self:!0,__source:!0};function se(Q,ce,De){var He,$e={},xt=null,ge=null;if(ce!=null)for(He in ce.ref!==void 0&&(ge=ce.ref),ce.key!==void 0&&(xt=""+ce.key),ce)me.call(ce,He)&&!he.hasOwnProperty(He)&&($e[He]=ce[He]);var Pt=arguments.length-2;if(Pt===1)$e.children=De;else if(1<Pt){for(var ot=Array(Pt),Dn=0;Dn<Pt;Dn++)ot[Dn]=arguments[Dn+2];$e.children=ot}if(Q&&Q.defaultProps)for(He in Pt=Q.defaultProps,Pt)$e[He]===void 0&&($e[He]=Pt[He]);return{$$typeof:r,type:Q,key:xt,ref:ge,props:$e,_owner:de.current}}function q(Q,ce){return{$$typeof:r,type:Q.type,key:ce,ref:Q.ref,props:Q.props,_owner:Q._owner}}function Se(Q){return typeof Q=="object"&&Q!==null&&Q.$$typeof===r}function ze(Q){var ce={"=":"=0",":":"=2"};return"$"+Q.replace(/[=:]/g,function(De){return ce[De]})}var Ue=/\/+/g;function Be(Q,ce){return typeof Q=="object"&&Q!==null&&Q.key!=null?ze(""+Q.key):ce.toString(36)}function rt(Q,ce,De,He,$e){var xt=typeof Q;(xt==="undefined"||xt==="boolean")&&(Q=null);var ge=!1;if(Q===null)ge=!0;else switch(xt){case"string":case"number":ge=!0;break;case"object":switch(Q.$$typeof){case r:case o:ge=!0}}if(ge)return ge=Q,$e=$e(ge),Q=He===""?"."+Be(ge,0):He,W($e)?(De="",Q!=null&&(De=Q.replace(Ue,"$&/")+"/"),rt($e,ce,De,"",function(Dn){return Dn})):$e!=null&&(Se($e)&&($e=q($e,De+(!$e.key||ge&&ge.key===$e.key?"":(""+$e.key).replace(Ue,"$&/")+"/")+Q)),ce.push($e)),1;if(ge=0,He=He===""?".":He+":",W(Q))for(var Pt=0;Pt<Q.length;Pt++){xt=Q[Pt];var ot=He+Be(xt,Pt);ge+=rt(xt,ce,De,ot,$e)}else if(ot=U(Q),typeof ot=="function")for(Q=ot.call(Q),Pt=0;!(xt=Q.next()).done;)xt=xt.value,ot=He+Be(xt,Pt++),ge+=rt(xt,ce,De,ot,$e);else if(xt==="object")throw ce=String(Q),Error("Objects are not valid as a React child (found: "+(ce==="[object Object]"?"object with keys {"+Object.keys(Q).join(", ")+"}":ce)+"). If you meant to render a collection of children, use an array instead.");return ge}function _t(Q,ce,De){if(Q==null)return Q;var He=[],$e=0;return rt(Q,He,"","",function(xt){return ce.call(De,xt,$e++)}),He}function zt(Q){if(Q._status===-1){var ce=Q._result;ce=ce(),ce.then(function(De){(Q._status===0||Q._status===-1)&&(Q._status=1,Q._result=De)},function(De){(Q._status===0||Q._status===-1)&&(Q._status=2,Q._result=De)}),Q._status===-1&&(Q._status=0,Q._result=ce)}if(Q._status===1)return Q._result.default;throw Q._result}var dt={current:null},Te={transition:null},we={ReactCurrentDispatcher:dt,ReactCurrentBatchConfig:Te,ReactCurrentOwner:de};return gr.Children={map:_t,forEach:function(Q,ce,De){_t(Q,function(){ce.apply(this,arguments)},De)},count:function(Q){var ce=0;return _t(Q,function(){ce++}),ce},toArray:function(Q){return _t(Q,function(ce){return ce})||[]},only:function(Q){if(!Se(Q))throw Error("React.Children.only expected to receive a single React element child.");return Q}},gr.Component=ie,gr.Fragment=a,gr.Profiler=p,gr.PureComponent=G,gr.StrictMode=c,gr.Suspense=C,gr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=we,gr.cloneElement=function(Q,ce,De){if(Q==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+Q+".");var He=$({},Q.props),$e=Q.key,xt=Q.ref,ge=Q._owner;if(ce!=null){if(ce.ref!==void 0&&(xt=ce.ref,ge=de.current),ce.key!==void 0&&($e=""+ce.key),Q.type&&Q.type.defaultProps)var Pt=Q.type.defaultProps;for(ot in ce)me.call(ce,ot)&&!he.hasOwnProperty(ot)&&(He[ot]=ce[ot]===void 0&&Pt!==void 0?Pt[ot]:ce[ot])}var ot=arguments.length-2;if(ot===1)He.children=De;else if(1<ot){Pt=Array(ot);for(var Dn=0;Dn<ot;Dn++)Pt[Dn]=arguments[Dn+2];He.children=Pt}return{$$typeof:r,type:Q.type,key:$e,ref:xt,props:He,_owner:ge}},gr.createContext=function(Q){return Q={$$typeof:x,_currentValue:Q,_currentValue2:Q,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},Q.Provider={$$typeof:_,_context:Q},Q.Consumer=Q},gr.createElement=se,gr.createFactory=function(Q){var ce=se.bind(null,Q);return ce.type=Q,ce},gr.createRef=function(){return{current:null}},gr.forwardRef=function(Q){return{$$typeof:T,render:Q}},gr.isValidElement=Se,gr.lazy=function(Q){return{$$typeof:O,_payload:{_status:-1,_result:Q},_init:zt}},gr.memo=function(Q,ce){return{$$typeof:P,type:Q,compare:ce===void 0?null:ce}},gr.startTransition=function(Q){var ce=Te.transition;Te.transition={};try{Q()}finally{Te.transition=ce}},gr.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")},gr.useCallback=function(Q,ce){return dt.current.useCallback(Q,ce)},gr.useContext=function(Q){return dt.current.useContext(Q)},gr.useDebugValue=function(){},gr.useDeferredValue=function(Q){return dt.current.useDeferredValue(Q)},gr.useEffect=function(Q,ce){return dt.current.useEffect(Q,ce)},gr.useId=function(){return dt.current.useId()},gr.useImperativeHandle=function(Q,ce,De){return dt.current.useImperativeHandle(Q,ce,De)},gr.useInsertionEffect=function(Q,ce){return dt.current.useInsertionEffect(Q,ce)},gr.useLayoutEffect=function(Q,ce){return dt.current.useLayoutEffect(Q,ce)},gr.useMemo=function(Q,ce){return dt.current.useMemo(Q,ce)},gr.useReducer=function(Q,ce,De){return dt.current.useReducer(Q,ce,De)},gr.useRef=function(Q){return dt.current.useRef(Q)},gr.useState=function(Q){return dt.current.useState(Q)},gr.useSyncExternalStore=function(Q,ce,De){return dt.current.useSyncExternalStore(Q,ce,De)},gr.useTransition=function(){return dt.current.useTransition()},gr.version="18.2.0",gr}nF.exports=EW();var A2=nF.exports,LL=SW(A2);const rF={primary:"#0F6292",secondary:"#FF8282",primaryLight:"#FFECEC",primaryText:"#4C4C4C",secondaryText:"#959595",CONTENT_AREA_DESKTOP:"75%",CONTENT_AREA_MOBILE:"calc(100% - 50px)"},TW=A2.createContext(rF),CW=({theme:r,children:o})=>{const a={...rF,...r};return LL.createElement(TW.Provider,{value:a},LL.createElement(bW,{theme:a},o))},Fg=Tr.div`
  height: ${({diameter:r})=>r};
  width: ${({diameter:r})=>r};
  border-radius: 50%;
  background-color: ${({theme:r,backgroundColor:o})=>o??r.primary};

  display: flex;
  justify-content: center;
  align-items: center;
`;Tr.div`
  background-color: black;
  opacity: 0.15;

  ${r=>r.vertical?Jh`
          width: 1px;
          height: 100%;
        `:Jh`
          width: 100%;
          height: 1px;
        `};
`;const du=Tr.div`
  width: ${({width:r})=>r||"100%"};
  height: ${({height:r})=>r||"100%"};
  flex-grow: 1;
`;Tr.div`
  width: 25px;
  height: 25px;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;

  gap: 3px;

  border-radius: 3px;
`;const qg=Tr.section`
  z-index: ${({zIndex:r})=>r};
  display: flex;
  flex-direction: column;
  flex-wrap: nowrap;
  justify-content: center;
  align-items: center;
  width: 100%;
  background-color: ${({backgroundColor:r})=>r||void 0};
`,TM=Tr.div`
  width: ${({theme:r,width:o})=>o||r.CONTENT_AREA_DESKTOP};
  max-width: 1240px;

  @media screen and (max-width: 768px) {
    width: ${({theme:r,width:o})=>o||r.CONTENT_AREA_MOBILE};
  }
`,Vo=Tr.p`
  display: ${({display:r})=>r||"block"};
  word-break: keep-all;
  margin: 0;
  text-align: ${({textAlign:r})=>r||"inherit"};
  color: ${({color:r})=>r||"inherit"};
  font-family: ${({font:r})=>r??"inherit"};
  font-size: ${({size:r})=>r??"1rem"};
  font-weight: ${({weight:r})=>r??"inherit"};
  line-height: ${({lineHeight:r,size:o})=>r??`calc(1.5 * ${o??"1rem"})`};
  text-decoration: ${({textDecoration:r})=>r||void 0};
  letter-spacing: ${({letterSpacing:r})=>r||"-0.5px"};
  -webkit-text-stroke: ${({stroke:r})=>r||void 0};
  text-shadow: ${({textShadow:r})=>r||void 0};
`;Tr(TM)`
  border: ${({border:r})=>r??void 0};
  background-color: ${({backgroundColor:r})=>r??"white"};
  padding: ${({padding:r})=>r??"20px"};
  border-radius: 15px;
  box-shadow: 0 0 10px 0 rgba(0, 0, 0, 0.1);
`;const Xi=Tr.div`
  display: flex;
  flex-direction: ${({flexDirection:r})=>r||"row"};
  flex-wrap: wrap;
  justify-content: ${({justifyContent:r})=>r||"flex-start"};
  align-items: ${({alignItems:r})=>r||"normal"};
  gap: ${({gap:r})=>r||null};

  ${({wrap:r})=>r?`flex-wrap: ${r};`:null}

  ${({width:r})=>r?`width: ${r};`:null}
  ${({height:r})=>r?`height: ${r};`:null}
  
  ${({flex:r})=>r?`flex: ${r};`:null}
`;Tr.div`
  display: grid;
  width: ${({width:r})=>r||void 0};
  height: ${({height:r})=>r||void 0};
  grid-template-columns: ${({gridTemplateColumns:r})=>r||"1fr"};
  grid-template-rows: ${({gridTemplateRows:r})=>r||"1fr"};
  justify-content: ${({justifyContent:r})=>r||"normal"};
  align-items: ${({alignItems:r})=>r||"normal"};
  place-items: ${({placeItems:r})=>r||"normal"};
  gap: ${({gap:r})=>r||void 0};

  ::-webkit-scrollbar {
    color: transparent;
  }
`;const AW=tF`
  from {
    transform: translateY(200px);
  }
  to {
    transform: translateY(0px);
  }
`;Tr.div`
  display: flex;
  flex-direction: column;
  align-items: center;

  position: relative;
  background-color: white;
  padding: 25px 45px;
  border-radius: 8px;

  ${r=>r.animation?Jh`
          animation-duration: 0.2s;
          animation-timing-function: ease-out;
          animation-name: ${AW};
          animation-fill-mode: forwards;
        `:""}
`;A2.createContext({onClose:()=>{}});Tr.div`
  display: flex;
  justify-content: space-between;
  width: 100%;
  gap: 10px;

  flex-direction: ${r=>r.direction??"row"};
`;Tr.button`
  position: absolute;
  top: 0;
  right: 0;
  padding: 10px;
  margin: 0;
  border: none;
  background-color: transparent;
  cursor: pointer;
`;Tr.img`
  width: 12px;
  height: 12px;
`;var Bs={},gT={exports:{}},yT={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var OL;function MW(){return OL||(OL=1,function(r){function o(Te,we){var Q=Te.length;Te.push(we);e:for(;0<Q;){var ce=Q-1>>>1,De=Te[ce];if(0<p(De,we))Te[ce]=we,Te[Q]=De,Q=ce;else break e}}function a(Te){return Te.length===0?null:Te[0]}function c(Te){if(Te.length===0)return null;var we=Te[0],Q=Te.pop();if(Q!==we){Te[0]=Q;e:for(var ce=0,De=Te.length,He=De>>>1;ce<He;){var $e=2*(ce+1)-1,xt=Te[$e],ge=$e+1,Pt=Te[ge];if(0>p(xt,Q))ge<De&&0>p(Pt,xt)?(Te[ce]=Pt,Te[ge]=Q,ce=ge):(Te[ce]=xt,Te[$e]=Q,ce=$e);else if(ge<De&&0>p(Pt,Q))Te[ce]=Pt,Te[ge]=Q,ce=ge;else break e}}return we}function p(Te,we){var Q=Te.sortIndex-we.sortIndex;return Q!==0?Q:Te.id-we.id}if(typeof performance=="object"&&typeof performance.now=="function"){var _=performance;r.unstable_now=function(){return _.now()}}else{var x=Date,T=x.now();r.unstable_now=function(){return x.now()-T}}var C=[],P=[],O=1,F=null,U=3,Z=!1,$=!1,K=!1,ie=typeof setTimeout=="function"?setTimeout:null,H=typeof clearTimeout=="function"?clearTimeout:null,G=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function ee(Te){for(var we=a(P);we!==null;){if(we.callback===null)c(P);else if(we.startTime<=Te)c(P),we.sortIndex=we.expirationTime,o(C,we);else break;we=a(P)}}function W(Te){if(K=!1,ee(Te),!$)if(a(C)!==null)$=!0,zt(me);else{var we=a(P);we!==null&&dt(W,we.startTime-Te)}}function me(Te,we){$=!1,K&&(K=!1,H(se),se=-1),Z=!0;var Q=U;try{for(ee(we),F=a(C);F!==null&&(!(F.expirationTime>we)||Te&&!ze());){var ce=F.callback;if(typeof ce=="function"){F.callback=null,U=F.priorityLevel;var De=ce(F.expirationTime<=we);we=r.unstable_now(),typeof De=="function"?F.callback=De:F===a(C)&&c(C),ee(we)}else c(C);F=a(C)}if(F!==null)var He=!0;else{var $e=a(P);$e!==null&&dt(W,$e.startTime-we),He=!1}return He}finally{F=null,U=Q,Z=!1}}var de=!1,he=null,se=-1,q=5,Se=-1;function ze(){return!(r.unstable_now()-Se<q)}function Ue(){if(he!==null){var Te=r.unstable_now();Se=Te;var we=!0;try{we=he(!0,Te)}finally{we?Be():(de=!1,he=null)}}else de=!1}var Be;if(typeof G=="function")Be=function(){G(Ue)};else if(typeof MessageChannel<"u"){var rt=new MessageChannel,_t=rt.port2;rt.port1.onmessage=Ue,Be=function(){_t.postMessage(null)}}else Be=function(){ie(Ue,0)};function zt(Te){he=Te,de||(de=!0,Be())}function dt(Te,we){se=ie(function(){Te(r.unstable_now())},we)}r.unstable_IdlePriority=5,r.unstable_ImmediatePriority=1,r.unstable_LowPriority=4,r.unstable_NormalPriority=3,r.unstable_Profiling=null,r.unstable_UserBlockingPriority=2,r.unstable_cancelCallback=function(Te){Te.callback=null},r.unstable_continueExecution=function(){$||Z||($=!0,zt(me))},r.unstable_forceFrameRate=function(Te){0>Te||125<Te?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):q=0<Te?Math.floor(1e3/Te):5},r.unstable_getCurrentPriorityLevel=function(){return U},r.unstable_getFirstCallbackNode=function(){return a(C)},r.unstable_next=function(Te){switch(U){case 1:case 2:case 3:var we=3;break;default:we=U}var Q=U;U=we;try{return Te()}finally{U=Q}},r.unstable_pauseExecution=function(){},r.unstable_requestPaint=function(){},r.unstable_runWithPriority=function(Te,we){switch(Te){case 1:case 2:case 3:case 4:case 5:break;default:Te=3}var Q=U;U=Te;try{return we()}finally{U=Q}},r.unstable_scheduleCallback=function(Te,we,Q){var ce=r.unstable_now();switch(typeof Q=="object"&&Q!==null?(Q=Q.delay,Q=typeof Q=="number"&&0<Q?ce+Q:ce):Q=ce,Te){case 1:var De=-1;break;case 2:De=250;break;case 5:De=1073741823;break;case 4:De=1e4;break;default:De=5e3}return De=Q+De,Te={id:O++,callback:we,priorityLevel:Te,startTime:Q,expirationTime:De,sortIndex:-1},Q>ce?(Te.sortIndex=Q,o(P,Te),a(C)===null&&Te===a(P)&&(K?(H(se),se=-1):K=!0,dt(W,Q-ce))):(Te.sortIndex=De,o(C,Te),$||Z||($=!0,zt(me))),Te},r.unstable_shouldYield=ze,r.unstable_wrapCallback=function(Te){var we=U;return function(){var Q=U;U=we;try{return Te.apply(this,arguments)}finally{U=Q}}}}(yT)),yT}var zL;function IW(){return zL||(zL=1,gT.exports=MW()),gT.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var FL;function kW(){if(FL)return Bs;FL=1;var r=A2,o=IW();function a(d){for(var g="https://reactjs.org/docs/error-decoder.html?invariant="+d,b=1;b<arguments.length;b++)g+="&args[]="+encodeURIComponent(arguments[b]);return"Minified React error #"+d+"; visit "+g+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var c=new Set,p={};function _(d,g){x(d,g),x(d+"Capture",g)}function x(d,g){for(p[d]=g,d=0;d<g.length;d++)c.add(g[d])}var T=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),C=Object.prototype.hasOwnProperty,P=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,O={},F={};function U(d){return C.call(F,d)?!0:C.call(O,d)?!1:P.test(d)?F[d]=!0:(O[d]=!0,!1)}function Z(d,g,b,I){if(b!==null&&b.type===0)return!1;switch(typeof g){case"function":case"symbol":return!0;case"boolean":return I?!1:b!==null?!b.acceptsBooleans:(d=d.toLowerCase().slice(0,5),d!=="data-"&&d!=="aria-");default:return!1}}function $(d,g,b,I){if(g===null||typeof g>"u"||Z(d,g,b,I))return!0;if(I)return!1;if(b!==null)switch(b.type){case 3:return!g;case 4:return g===!1;case 5:return isNaN(g);case 6:return isNaN(g)||1>g}return!1}function K(d,g,b,I,D,N,X){this.acceptsBooleans=g===2||g===3||g===4,this.attributeName=I,this.attributeNamespace=D,this.mustUseProperty=b,this.propertyName=d,this.type=g,this.sanitizeURL=N,this.removeEmptyString=X}var ie={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(d){ie[d]=new K(d,0,!1,d,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(d){var g=d[0];ie[g]=new K(g,1,!1,d[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(d){ie[d]=new K(d,2,!1,d.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(d){ie[d]=new K(d,2,!1,d,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(d){ie[d]=new K(d,3,!1,d.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(d){ie[d]=new K(d,3,!0,d,null,!1,!1)}),["capture","download"].forEach(function(d){ie[d]=new K(d,4,!1,d,null,!1,!1)}),["cols","rows","size","span"].forEach(function(d){ie[d]=new K(d,6,!1,d,null,!1,!1)}),["rowSpan","start"].forEach(function(d){ie[d]=new K(d,5,!1,d.toLowerCase(),null,!1,!1)});var H=/[\-:]([a-z])/g;function G(d){return d[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(d){var g=d.replace(H,G);ie[g]=new K(g,1,!1,d,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(d){var g=d.replace(H,G);ie[g]=new K(g,1,!1,d,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(d){var g=d.replace(H,G);ie[g]=new K(g,1,!1,d,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(d){ie[d]=new K(d,1,!1,d.toLowerCase(),null,!1,!1)}),ie.xlinkHref=new K("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(d){ie[d]=new K(d,1,!1,d.toLowerCase(),null,!0,!0)});function ee(d,g,b,I){var D=ie.hasOwnProperty(g)?ie[g]:null;(D!==null?D.type!==0:I||!(2<g.length)||g[0]!=="o"&&g[0]!=="O"||g[1]!=="n"&&g[1]!=="N")&&($(g,b,D,I)&&(b=null),I||D===null?U(g)&&(b===null?d.removeAttribute(g):d.setAttribute(g,""+b)):D.mustUseProperty?d[D.propertyName]=b===null?D.type===3?!1:"":b:(g=D.attributeName,I=D.attributeNamespace,b===null?d.removeAttribute(g):(D=D.type,b=D===3||D===4&&b===!0?"":""+b,I?d.setAttributeNS(I,g,b):d.setAttribute(g,b))))}var W=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,me=Symbol.for("react.element"),de=Symbol.for("react.portal"),he=Symbol.for("react.fragment"),se=Symbol.for("react.strict_mode"),q=Symbol.for("react.profiler"),Se=Symbol.for("react.provider"),ze=Symbol.for("react.context"),Ue=Symbol.for("react.forward_ref"),Be=Symbol.for("react.suspense"),rt=Symbol.for("react.suspense_list"),_t=Symbol.for("react.memo"),zt=Symbol.for("react.lazy"),dt=Symbol.for("react.offscreen"),Te=Symbol.iterator;function we(d){return d===null||typeof d!="object"?null:(d=Te&&d[Te]||d["@@iterator"],typeof d=="function"?d:null)}var Q=Object.assign,ce;function De(d){if(ce===void 0)try{throw Error()}catch(b){var g=b.stack.trim().match(/\n( *(at )?)/);ce=g&&g[1]||""}return`
`+ce+d}var He=!1;function $e(d,g){if(!d||He)return"";He=!0;var b=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(g)if(g=function(){throw Error()},Object.defineProperty(g.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(g,[])}catch(Ye){var I=Ye}Reflect.construct(d,[],g)}else{try{g.call()}catch(Ye){I=Ye}d.call(g.prototype)}else{try{throw Error()}catch(Ye){I=Ye}d()}}catch(Ye){if(Ye&&I&&typeof Ye.stack=="string"){for(var D=Ye.stack.split(`
`),N=I.stack.split(`
`),X=D.length-1,ve=N.length-1;1<=X&&0<=ve&&D[X]!==N[ve];)ve--;for(;1<=X&&0<=ve;X--,ve--)if(D[X]!==N[ve]){if(X!==1||ve!==1)do if(X--,ve--,0>ve||D[X]!==N[ve]){var Ce=`
`+D[X].replace(" at new "," at ");return d.displayName&&Ce.includes("<anonymous>")&&(Ce=Ce.replace("<anonymous>",d.displayName)),Ce}while(1<=X&&0<=ve);break}}}finally{He=!1,Error.prepareStackTrace=b}return(d=d?d.displayName||d.name:"")?De(d):""}function xt(d){switch(d.tag){case 5:return De(d.type);case 16:return De("Lazy");case 13:return De("Suspense");case 19:return De("SuspenseList");case 0:case 2:case 15:return d=$e(d.type,!1),d;case 11:return d=$e(d.type.render,!1),d;case 1:return d=$e(d.type,!0),d;default:return""}}function ge(d){if(d==null)return null;if(typeof d=="function")return d.displayName||d.name||null;if(typeof d=="string")return d;switch(d){case he:return"Fragment";case de:return"Portal";case q:return"Profiler";case se:return"StrictMode";case Be:return"Suspense";case rt:return"SuspenseList"}if(typeof d=="object")switch(d.$$typeof){case ze:return(d.displayName||"Context")+".Consumer";case Se:return(d._context.displayName||"Context")+".Provider";case Ue:var g=d.render;return d=d.displayName,d||(d=g.displayName||g.name||"",d=d!==""?"ForwardRef("+d+")":"ForwardRef"),d;case _t:return g=d.displayName||null,g!==null?g:ge(d.type)||"Memo";case zt:g=d._payload,d=d._init;try{return ge(d(g))}catch{}}return null}function Pt(d){var g=d.type;switch(d.tag){case 24:return"Cache";case 9:return(g.displayName||"Context")+".Consumer";case 10:return(g._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return d=g.render,d=d.displayName||d.name||"",g.displayName||(d!==""?"ForwardRef("+d+")":"ForwardRef");case 7:return"Fragment";case 5:return g;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return ge(g);case 8:return g===se?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof g=="function")return g.displayName||g.name||null;if(typeof g=="string")return g}return null}function ot(d){switch(typeof d){case"boolean":case"number":case"string":case"undefined":return d;case"object":return d;default:return""}}function Dn(d){var g=d.type;return(d=d.nodeName)&&d.toLowerCase()==="input"&&(g==="checkbox"||g==="radio")}function $n(d){var g=Dn(d)?"checked":"value",b=Object.getOwnPropertyDescriptor(d.constructor.prototype,g),I=""+d[g];if(!d.hasOwnProperty(g)&&typeof b<"u"&&typeof b.get=="function"&&typeof b.set=="function"){var D=b.get,N=b.set;return Object.defineProperty(d,g,{configurable:!0,get:function(){return D.call(this)},set:function(X){I=""+X,N.call(this,X)}}),Object.defineProperty(d,g,{enumerable:b.enumerable}),{getValue:function(){return I},setValue:function(X){I=""+X},stopTracking:function(){d._valueTracker=null,delete d[g]}}}}function Ln(d){d._valueTracker||(d._valueTracker=$n(d))}function vn(d){if(!d)return!1;var g=d._valueTracker;if(!g)return!0;var b=g.getValue(),I="";return d&&(I=Dn(d)?d.checked?"true":"false":d.value),d=I,d!==b?(g.setValue(d),!0):!1}function On(d){if(d=d||(typeof document<"u"?document:void 0),typeof d>"u")return null;try{return d.activeElement||d.body}catch{return d.body}}function Br(d,g){var b=g.checked;return Q({},g,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:b??d._wrapperState.initialChecked})}function bn(d,g){var b=g.defaultValue==null?"":g.defaultValue,I=g.checked!=null?g.checked:g.defaultChecked;b=ot(g.value!=null?g.value:b),d._wrapperState={initialChecked:I,initialValue:b,controlled:g.type==="checkbox"||g.type==="radio"?g.checked!=null:g.value!=null}}function et(d,g){g=g.checked,g!=null&&ee(d,"checked",g,!1)}function te(d,g){et(d,g);var b=ot(g.value),I=g.type;if(b!=null)I==="number"?(b===0&&d.value===""||d.value!=b)&&(d.value=""+b):d.value!==""+b&&(d.value=""+b);else if(I==="submit"||I==="reset"){d.removeAttribute("value");return}g.hasOwnProperty("value")?ye(d,g.type,b):g.hasOwnProperty("defaultValue")&&ye(d,g.type,ot(g.defaultValue)),g.checked==null&&g.defaultChecked!=null&&(d.defaultChecked=!!g.defaultChecked)}function ue(d,g,b){if(g.hasOwnProperty("value")||g.hasOwnProperty("defaultValue")){var I=g.type;if(!(I!=="submit"&&I!=="reset"||g.value!==void 0&&g.value!==null))return;g=""+d._wrapperState.initialValue,b||g===d.value||(d.value=g),d.defaultValue=g}b=d.name,b!==""&&(d.name=""),d.defaultChecked=!!d._wrapperState.initialChecked,b!==""&&(d.name=b)}function ye(d,g,b){(g!=="number"||On(d.ownerDocument)!==d)&&(b==null?d.defaultValue=""+d._wrapperState.initialValue:d.defaultValue!==""+b&&(d.defaultValue=""+b))}var We=Array.isArray;function Je(d,g,b,I){if(d=d.options,g){g={};for(var D=0;D<b.length;D++)g["$"+b[D]]=!0;for(b=0;b<d.length;b++)D=g.hasOwnProperty("$"+d[b].value),d[b].selected!==D&&(d[b].selected=D),D&&I&&(d[b].defaultSelected=!0)}else{for(b=""+ot(b),g=null,D=0;D<d.length;D++){if(d[D].value===b){d[D].selected=!0,I&&(d[D].defaultSelected=!0);return}g!==null||d[D].disabled||(g=d[D])}g!==null&&(g.selected=!0)}}function bt(d,g){if(g.dangerouslySetInnerHTML!=null)throw Error(a(91));return Q({},g,{value:void 0,defaultValue:void 0,children:""+d._wrapperState.initialValue})}function St(d,g){var b=g.value;if(b==null){if(b=g.children,g=g.defaultValue,b!=null){if(g!=null)throw Error(a(92));if(We(b)){if(1<b.length)throw Error(a(93));b=b[0]}g=b}g==null&&(g=""),b=g}d._wrapperState={initialValue:ot(b)}}function Ne(d,g){var b=ot(g.value),I=ot(g.defaultValue);b!=null&&(b=""+b,b!==d.value&&(d.value=b),g.defaultValue==null&&d.defaultValue!==b&&(d.defaultValue=b)),I!=null&&(d.defaultValue=""+I)}function wt(d){var g=d.textContent;g===d._wrapperState.initialValue&&g!==""&&g!==null&&(d.value=g)}function Rt(d){switch(d){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Wt(d,g){return d==null||d==="http://www.w3.org/1999/xhtml"?Rt(g):d==="http://www.w3.org/2000/svg"&&g==="foreignObject"?"http://www.w3.org/1999/xhtml":d}var cn,Yn=function(d){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(g,b,I,D){MSApp.execUnsafeLocalFunction(function(){return d(g,b,I,D)})}:d}(function(d,g){if(d.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in d)d.innerHTML=g;else{for(cn=cn||document.createElement("div"),cn.innerHTML="<svg>"+g.valueOf().toString()+"</svg>",g=cn.firstChild;d.firstChild;)d.removeChild(d.firstChild);for(;g.firstChild;)d.appendChild(g.firstChild)}});function hr(d,g){if(g){var b=d.firstChild;if(b&&b===d.lastChild&&b.nodeType===3){b.nodeValue=g;return}}d.textContent=g}var pr={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},nr=["Webkit","ms","Moz","O"];Object.keys(pr).forEach(function(d){nr.forEach(function(g){g=g+d.charAt(0).toUpperCase()+d.substring(1),pr[g]=pr[d]})});function dr(d,g,b){return g==null||typeof g=="boolean"||g===""?"":b||typeof g!="number"||g===0||pr.hasOwnProperty(d)&&pr[d]?(""+g).trim():g+"px"}function Xe(d,g){d=d.style;for(var b in g)if(g.hasOwnProperty(b)){var I=b.indexOf("--")===0,D=dr(b,g[b],I);b==="float"&&(b="cssFloat"),I?d.setProperty(b,D):d[b]=D}}var be=Q({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Ke(d,g){if(g){if(be[d]&&(g.children!=null||g.dangerouslySetInnerHTML!=null))throw Error(a(137,d));if(g.dangerouslySetInnerHTML!=null){if(g.children!=null)throw Error(a(60));if(typeof g.dangerouslySetInnerHTML!="object"||!("__html"in g.dangerouslySetInnerHTML))throw Error(a(61))}if(g.style!=null&&typeof g.style!="object")throw Error(a(62))}}function nt(d,g){if(d.indexOf("-")===-1)return typeof g.is=="string";switch(d){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Vt=null;function Ht(d){return d=d.target||d.srcElement||window,d.correspondingUseElement&&(d=d.correspondingUseElement),d.nodeType===3?d.parentNode:d}var $t=null,jt=null,Lt=null;function Oe(d){if(d=kd(d)){if(typeof $t!="function")throw Error(a(280));var g=d.stateNode;g&&(g=xp(g),$t(d.stateNode,d.type,g))}}function Ie(d){jt?Lt?Lt.push(d):Lt=[d]:jt=d}function je(){if(jt){var d=jt,g=Lt;if(Lt=jt=null,Oe(d),g)for(d=0;d<g.length;d++)Oe(g[d])}}function Qe(d,g){return d(g)}function tt(){}var ht=!1;function at(d,g,b){if(ht)return d(g,b);ht=!0;try{return Qe(d,g,b)}finally{ht=!1,(jt!==null||Lt!==null)&&(tt(),je())}}function ut(d,g){var b=d.stateNode;if(b===null)return null;var I=xp(b);if(I===null)return null;b=I[g];e:switch(g){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(I=!I.disabled)||(d=d.type,I=!(d==="button"||d==="input"||d==="select"||d==="textarea")),d=!I;break e;default:d=!1}if(d)return null;if(b&&typeof b!="function")throw Error(a(231,g,typeof b));return b}var Et=!1;if(T)try{var it={};Object.defineProperty(it,"passive",{get:function(){Et=!0}}),window.addEventListener("test",it,it),window.removeEventListener("test",it,it)}catch{Et=!1}function Yt(d,g,b,I,D,N,X,ve,Ce){var Ye=Array.prototype.slice.call(arguments,3);try{g.apply(b,Ye)}catch(At){this.onError(At)}}var xn=!1,Ot=null,qn=!1,Wn=null,pn={onError:function(d){xn=!0,Ot=d}};function rr(d,g,b,I,D,N,X,ve,Ce){xn=!1,Ot=null,Yt.apply(pn,arguments)}function Rr(d,g,b,I,D,N,X,ve,Ce){if(rr.apply(this,arguments),xn){if(xn){var Ye=Ot;xn=!1,Ot=null}else throw Error(a(198));qn||(qn=!0,Wn=Ye)}}function Yr(d){var g=d,b=d;if(d.alternate)for(;g.return;)g=g.return;else{d=g;do g=d,g.flags&4098&&(b=g.return),d=g.return;while(d)}return g.tag===3?b:null}function ar(d){if(d.tag===13){var g=d.memoizedState;if(g===null&&(d=d.alternate,d!==null&&(g=d.memoizedState)),g!==null)return g.dehydrated}return null}function Dr(d){if(Yr(d)!==d)throw Error(a(188))}function Qr(d){var g=d.alternate;if(!g){if(g=Yr(d),g===null)throw Error(a(188));return g!==d?null:d}for(var b=d,I=g;;){var D=b.return;if(D===null)break;var N=D.alternate;if(N===null){if(I=D.return,I!==null){b=I;continue}break}if(D.child===N.child){for(N=D.child;N;){if(N===b)return Dr(D),d;if(N===I)return Dr(D),g;N=N.sibling}throw Error(a(188))}if(b.return!==I.return)b=D,I=N;else{for(var X=!1,ve=D.child;ve;){if(ve===b){X=!0,b=D,I=N;break}if(ve===I){X=!0,I=D,b=N;break}ve=ve.sibling}if(!X){for(ve=N.child;ve;){if(ve===b){X=!0,b=N,I=D;break}if(ve===I){X=!0,I=N,b=D;break}ve=ve.sibling}if(!X)throw Error(a(189))}}if(b.alternate!==I)throw Error(a(190))}if(b.tag!==3)throw Error(a(188));return b.stateNode.current===b?d:g}function Po(d){return d=Qr(d),d!==null?oa(d):null}function oa(d){if(d.tag===5||d.tag===6)return d;for(d=d.child;d!==null;){var g=oa(d);if(g!==null)return g;d=d.sibling}return null}var Ho=o.unstable_scheduleCallback,Ll=o.unstable_cancelCallback,Sc=o.unstable_shouldYield,od=o.unstable_requestPaint,oi=o.unstable_now,sd=o.unstable_getCurrentPriorityLevel,Ol=o.unstable_ImmediatePriority,Ec=o.unstable_UserBlockingPriority,$f=o.unstable_NormalPriority,Gf=o.unstable_LowPriority,Xg=o.unstable_IdlePriority,vu=null,Hs=null;function j2(d){if(Hs&&typeof Hs.onCommitFiberRoot=="function")try{Hs.onCommitFiberRoot(vu,d,void 0,(d.current.flags&128)===128)}catch{}}var qs=Math.clz32?Math.clz32:Kg,Rv=Math.log,Dv=Math.LN2;function Kg(d){return d>>>=0,d===0?32:31-(Rv(d)/Dv|0)|0}var Tc=64,xu=4194304;function wu(d){switch(d&-d){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return d&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return d&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return d}}function bu(d,g){var b=d.pendingLanes;if(b===0)return 0;var I=0,D=d.suspendedLanes,N=d.pingedLanes,X=b&268435455;if(X!==0){var ve=X&~D;ve!==0?I=wu(ve):(N&=X,N!==0&&(I=wu(N)))}else X=b&~D,X!==0?I=wu(X):N!==0&&(I=wu(N));if(I===0)return 0;if(g!==0&&g!==I&&!(g&D)&&(D=I&-I,N=g&-g,D>=N||D===16&&(N&4194240)!==0))return g;if(I&4&&(I|=b&16),g=d.entangledLanes,g!==0)for(d=d.entanglements,g&=I;0<g;)b=31-qs(g),D=1<<b,I|=d[b],g&=~D;return I}function Su(d,g){switch(d){case 1:case 2:case 4:return g+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return g+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function mn(d,g){for(var b=d.suspendedLanes,I=d.pingedLanes,D=d.expirationTimes,N=d.pendingLanes;0<N;){var X=31-qs(N),ve=1<<X,Ce=D[X];Ce===-1?(!(ve&b)||ve&I)&&(D[X]=Su(ve,g)):Ce<=g&&(d.expiredLanes|=ve),N&=~ve}}function lr(d){return d=d.pendingLanes&-1073741825,d!==0?d:d&1073741824?1073741824:0}function sa(){var d=Tc;return Tc<<=1,!(Tc&4194240)&&(Tc=64),d}function Na(d){for(var g=[],b=0;31>b;b++)g.push(d);return g}function ja(d,g,b){d.pendingLanes|=g,g!==536870912&&(d.suspendedLanes=0,d.pingedLanes=0),d=d.eventTimes,g=31-qs(g),d[g]=b}function Lv(d,g){var b=d.pendingLanes&~g;d.pendingLanes=g,d.suspendedLanes=0,d.pingedLanes=0,d.expiredLanes&=g,d.mutableReadLanes&=g,d.entangledLanes&=g,g=d.entanglements;var I=d.eventTimes;for(d=d.expirationTimes;0<b;){var D=31-qs(b),N=1<<D;g[D]=0,I[D]=-1,d[D]=-1,b&=~N}}function Hf(d,g){var b=d.entangledLanes|=g;for(d=d.entanglements;b;){var I=31-qs(b),D=1<<I;D&g|d[I]&g&&(d[I]|=g),b&=~D}}var Lr=0;function qf(d){return d&=-d,1<d?4<d?d&268435455?16:536870912:4:1}var Wf,Eu,ad,Yg,Qg,Zf=!1,Cc=[],ct=null,en=null,Cr=null,ke=new Map,os=new Map,Ct=[],Bi="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function aa(d,g){switch(d){case"focusin":case"focusout":ct=null;break;case"dragenter":case"dragleave":en=null;break;case"mouseover":case"mouseout":Cr=null;break;case"pointerover":case"pointerout":ke.delete(g.pointerId);break;case"gotpointercapture":case"lostpointercapture":os.delete(g.pointerId)}}function ld(d,g,b,I,D,N){return d===null||d.nativeEvent!==N?(d={blockedOn:g,domEventName:b,eventSystemFlags:I,nativeEvent:N,targetContainers:[D]},g!==null&&(g=kd(g),g!==null&&Eu(g)),d):(d.eventSystemFlags|=I,g=d.targetContainers,D!==null&&g.indexOf(D)===-1&&g.push(D),d)}function la(d,g,b,I,D){switch(g){case"focusin":return ct=ld(ct,d,g,b,I,D),!0;case"dragenter":return en=ld(en,d,g,b,I,D),!0;case"mouseover":return Cr=ld(Cr,d,g,b,I,D),!0;case"pointerover":var N=D.pointerId;return ke.set(N,ld(ke.get(N)||null,d,g,b,I,D)),!0;case"gotpointercapture":return N=D.pointerId,os.set(N,ld(os.get(N)||null,d,g,b,I,D)),!0}return!1}function Xf(d){var g=Ka(d.target);if(g!==null){var b=Yr(g);if(b!==null){if(g=b.tag,g===13){if(g=ar(b),g!==null){d.blockedOn=g,Qg(d.priority,function(){ad(b)});return}}else if(g===3&&b.stateNode.current.memoizedState.isDehydrated){d.blockedOn=b.tag===3?b.stateNode.containerInfo:null;return}}}d.blockedOn=null}function Kf(d){if(d.blockedOn!==null)return!1;for(var g=d.targetContainers;0<g.length;){var b=po(d.domEventName,d.eventSystemFlags,g[0],d.nativeEvent);if(b===null){b=d.nativeEvent;var I=new b.constructor(b.type,b);Vt=I,b.target.dispatchEvent(I),Vt=null}else return g=kd(b),g!==null&&Eu(g),d.blockedOn=b,!1;g.shift()}return!0}function Tu(d,g,b){Kf(d)&&b.delete(g)}function It(){Zf=!1,ct!==null&&Kf(ct)&&(ct=null),en!==null&&Kf(en)&&(en=null),Cr!==null&&Kf(Cr)&&(Cr=null),ke.forEach(Tu),os.forEach(Tu)}function Bn(d,g){d.blockedOn===g&&(d.blockedOn=null,Zf||(Zf=!0,o.unstable_scheduleCallback(o.unstable_NormalPriority,It)))}function Gn(d){function g(D){return Bn(D,d)}if(0<Cc.length){Bn(Cc[0],d);for(var b=1;b<Cc.length;b++){var I=Cc[b];I.blockedOn===d&&(I.blockedOn=null)}}for(ct!==null&&Bn(ct,d),en!==null&&Bn(en,d),Cr!==null&&Bn(Cr,d),ke.forEach(g),os.forEach(g),b=0;b<Ct.length;b++)I=Ct[b],I.blockedOn===d&&(I.blockedOn=null);for(;0<Ct.length&&(b=Ct[0],b.blockedOn===null);)Xf(b),b.blockedOn===null&&Ct.shift()}var lo=W.ReactCurrentBatchConfig,Ua=!0;function Zn(d,g,b,I){var D=Lr,N=lo.transition;lo.transition=null;try{Lr=1,Cu(d,g,b,I)}finally{Lr=D,lo.transition=N}}function Yf(d,g,b,I){var D=Lr,N=lo.transition;lo.transition=null;try{Lr=4,Cu(d,g,b,I)}finally{Lr=D,lo.transition=N}}function Cu(d,g,b,I){if(Ua){var D=po(d,g,b,I);if(D===null)my(d,g,I,zl,b),aa(d,I);else if(la(D,d,g,b,I))I.stopPropagation();else if(aa(d,I),g&4&&-1<Bi.indexOf(d)){for(;D!==null;){var N=kd(D);if(N!==null&&Wf(N),N=po(d,g,b,I),N===null&&my(d,g,I,zl,b),N===D)break;D=N}D!==null&&I.stopPropagation()}else my(d,g,I,null,b)}}var zl=null;function po(d,g,b,I){if(zl=null,d=Ht(I),d=Ka(d),d!==null)if(g=Yr(d),g===null)d=null;else if(b=g.tag,b===13){if(d=ar(g),d!==null)return d;d=null}else if(b===3){if(g.stateNode.current.memoizedState.isDehydrated)return g.tag===3?g.stateNode.containerInfo:null;d=null}else g!==d&&(d=null);return zl=d,null}function si(d){switch(d){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(sd()){case Ol:return 1;case Ec:return 4;case $f:case Gf:return 16;case Xg:return 536870912;default:return 16}default:return 16}}var Fl=null,Au=null,Ac=null;function Mc(){if(Ac)return Ac;var d,g=Au,b=g.length,I,D="value"in Fl?Fl.value:Fl.textContent,N=D.length;for(d=0;d<b&&g[d]===D[d];d++);var X=b-d;for(I=1;I<=X&&g[b-I]===D[N-I];I++);return Ac=D.slice(d,1<I?1-I:void 0)}function Ic(d){var g=d.keyCode;return"charCode"in d?(d=d.charCode,d===0&&g===13&&(d=13)):d=g,d===10&&(d=13),32<=d||d===13?d:0}function ud(){return!0}function cd(){return!1}function Ro(d){function g(b,I,D,N,X){this._reactName=b,this._targetInst=D,this.type=I,this.nativeEvent=N,this.target=X,this.currentTarget=null;for(var ve in d)d.hasOwnProperty(ve)&&(b=d[ve],this[ve]=b?b(N):N[ve]);return this.isDefaultPrevented=(N.defaultPrevented!=null?N.defaultPrevented:N.returnValue===!1)?ud:cd,this.isPropagationStopped=cd,this}return Q(g.prototype,{preventDefault:function(){this.defaultPrevented=!0;var b=this.nativeEvent;b&&(b.preventDefault?b.preventDefault():typeof b.returnValue!="unknown"&&(b.returnValue=!1),this.isDefaultPrevented=ud)},stopPropagation:function(){var b=this.nativeEvent;b&&(b.stopPropagation?b.stopPropagation():typeof b.cancelBubble!="unknown"&&(b.cancelBubble=!0),this.isPropagationStopped=ud)},persist:function(){},isPersistent:ud}),g}var Va={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(d){return d.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},hd=Ro(Va),Qi=Q({},Va,{view:0,detail:0}),wn=Ro(Qi),dd,fd,Ji,Do=Q({},Qi,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ga,button:0,buttons:0,relatedTarget:function(d){return d.relatedTarget===void 0?d.fromElement===d.srcElement?d.toElement:d.fromElement:d.relatedTarget},movementX:function(d){return"movementX"in d?d.movementX:(d!==Ji&&(Ji&&d.type==="mousemove"?(dd=d.screenX-Ji.screenX,fd=d.screenY-Ji.screenY):fd=dd=0,Ji=d),dd)},movementY:function(d){return"movementY"in d?d.movementY:fd}}),Jg=Ro(Do),kc=Q({},Do,{dataTransfer:0}),Pi=Ro(kc),pd=Q({},Qi,{relatedTarget:0}),md=Ro(pd),gd=Q({},Va,{animationName:0,elapsedTime:0,pseudoElement:0}),Ni=Ro(gd),ey=Q({},Va,{clipboardData:function(d){return"clipboardData"in d?d.clipboardData:window.clipboardData}}),ty=Ro(ey),$a=Q({},Va,{data:0}),Pc=Ro($a),yd={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Qn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},U2={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function ny(d){var g=this.nativeEvent;return g.getModifierState?g.getModifierState(d):(d=U2[d])?!!g[d]:!1}function Ga(){return ny}var V2=Q({},Qi,{key:function(d){if(d.key){var g=yd[d.key]||d.key;if(g!=="Unidentified")return g}return d.type==="keypress"?(d=Ic(d),d===13?"Enter":String.fromCharCode(d)):d.type==="keydown"||d.type==="keyup"?Qn[d.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ga,charCode:function(d){return d.type==="keypress"?Ic(d):0},keyCode:function(d){return d.type==="keydown"||d.type==="keyup"?d.keyCode:0},which:function(d){return d.type==="keypress"?Ic(d):d.type==="keydown"||d.type==="keyup"?d.keyCode:0}}),Ov=Ro(V2),Rc=Q({},Do,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Ws=Ro(Rc),Qf=Q({},Qi,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ga}),zv=Ro(Qf),$2=Q({},Va,{propertyName:0,elapsedTime:0,pseudoElement:0}),G2=Ro($2),_d=Q({},Do,{deltaX:function(d){return"deltaX"in d?d.deltaX:"wheelDeltaX"in d?-d.wheelDeltaX:0},deltaY:function(d){return"deltaY"in d?d.deltaY:"wheelDeltaY"in d?-d.wheelDeltaY:"wheelDelta"in d?-d.wheelDelta:0},deltaZ:0,deltaMode:0}),vd=Ro(_d),H2=[9,13,27,32],Bl=T&&"CompositionEvent"in window,Dc=null;T&&"documentMode"in document&&(Dc=document.documentMode);var Jf=T&&"TextEvent"in window&&!Dc,Ha=T&&(!Bl||Dc&&8<Dc&&11>=Dc),Fv=String.fromCharCode(32),Bv=!1;function Nv(d,g){switch(d){case"keyup":return H2.indexOf(g.keyCode)!==-1;case"keydown":return g.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function ry(d){return d=d.detail,typeof d=="object"&&"data"in d?d.data:null}var Lc=!1;function iy(d,g){switch(d){case"compositionend":return ry(g);case"keypress":return g.which!==32?null:(Bv=!0,Fv);case"textInput":return d=g.data,d===Fv&&Bv?null:d;default:return null}}function jv(d,g){if(Lc)return d==="compositionend"||!Bl&&Nv(d,g)?(d=Mc(),Ac=Au=Fl=null,Lc=!1,d):null;switch(d){case"paste":return null;case"keypress":if(!(g.ctrlKey||g.altKey||g.metaKey)||g.ctrlKey&&g.altKey){if(g.char&&1<g.char.length)return g.char;if(g.which)return String.fromCharCode(g.which)}return null;case"compositionend":return Ha&&g.locale!=="ko"?null:g.data;default:return null}}var Uv={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function oy(d){var g=d&&d.nodeName&&d.nodeName.toLowerCase();return g==="input"?!!Uv[d.type]:g==="textarea"}function sy(d,g,b,I){Ie(I),g=mp(g,"onChange"),0<g.length&&(b=new hd("onChange","change",null,b,I),d.push({event:b,listeners:g}))}var qa=null,Mu=null;function Vv(d){Ed(d,0)}function Oc(d){var g=Ya(d);if(vn(g))return d}function $v(d,g){if(d==="change")return g}var ep=!1;if(T){var Ge;if(T){var tp="oninput"in document;if(!tp){var np=document.createElement("div");np.setAttribute("oninput","return;"),tp=typeof np.oninput=="function"}Ge=tp}else Ge=!1;ep=Ge&&(!document.documentMode||9<document.documentMode)}function rp(){qa&&(qa.detachEvent("onpropertychange",ay),Mu=qa=null)}function ay(d){if(d.propertyName==="value"&&Oc(Mu)){var g=[];sy(g,Mu,d,Ht(d)),at(Vv,g)}}function ip(d,g,b){d==="focusin"?(rp(),qa=g,Mu=b,qa.attachEvent("onpropertychange",ay)):d==="focusout"&&rp()}function Wa(d){if(d==="selectionchange"||d==="keyup"||d==="keydown")return Oc(Mu)}function ly(d,g){if(d==="click")return Oc(g)}function Iu(d,g){if(d==="input"||d==="change")return Oc(g)}function op(d,g){return d===g&&(d!==0||1/d===1/g)||d!==d&&g!==g}var mo=typeof Object.is=="function"?Object.is:op;function ku(d,g){if(mo(d,g))return!0;if(typeof d!="object"||d===null||typeof g!="object"||g===null)return!1;var b=Object.keys(d),I=Object.keys(g);if(b.length!==I.length)return!1;for(I=0;I<b.length;I++){var D=b[I];if(!C.call(g,D)||!mo(d[D],g[D]))return!1}return!0}function Gv(d){for(;d&&d.firstChild;)d=d.firstChild;return d}function uy(d,g){var b=Gv(d);d=0;for(var I;b;){if(b.nodeType===3){if(I=d+b.textContent.length,d<=g&&I>=g)return{node:b,offset:g-d};d=I}e:{for(;b;){if(b.nextSibling){b=b.nextSibling;break e}b=b.parentNode}b=void 0}b=Gv(b)}}function cy(d,g){return d&&g?d===g?!0:d&&d.nodeType===3?!1:g&&g.nodeType===3?cy(d,g.parentNode):"contains"in d?d.contains(g):d.compareDocumentPosition?!!(d.compareDocumentPosition(g)&16):!1:!1}function sp(){for(var d=window,g=On();g instanceof d.HTMLIFrameElement;){try{var b=typeof g.contentWindow.location.href=="string"}catch{b=!1}if(b)d=g.contentWindow;else break;g=On(d.document)}return g}function hy(d){var g=d&&d.nodeName&&d.nodeName.toLowerCase();return g&&(g==="input"&&(d.type==="text"||d.type==="search"||d.type==="tel"||d.type==="url"||d.type==="password")||g==="textarea"||d.contentEditable==="true")}function q2(d){var g=sp(),b=d.focusedElem,I=d.selectionRange;if(g!==b&&b&&b.ownerDocument&&cy(b.ownerDocument.documentElement,b)){if(I!==null&&hy(b)){if(g=I.start,d=I.end,d===void 0&&(d=g),"selectionStart"in b)b.selectionStart=g,b.selectionEnd=Math.min(d,b.value.length);else if(d=(g=b.ownerDocument||document)&&g.defaultView||window,d.getSelection){d=d.getSelection();var D=b.textContent.length,N=Math.min(I.start,D);I=I.end===void 0?N:Math.min(I.end,D),!d.extend&&N>I&&(D=I,I=N,N=D),D=uy(b,N);var X=uy(b,I);D&&X&&(d.rangeCount!==1||d.anchorNode!==D.node||d.anchorOffset!==D.offset||d.focusNode!==X.node||d.focusOffset!==X.offset)&&(g=g.createRange(),g.setStart(D.node,D.offset),d.removeAllRanges(),N>I?(d.addRange(g),d.extend(X.node,X.offset)):(g.setEnd(X.node,X.offset),d.addRange(g)))}}for(g=[],d=b;d=d.parentNode;)d.nodeType===1&&g.push({element:d,left:d.scrollLeft,top:d.scrollTop});for(typeof b.focus=="function"&&b.focus(),b=0;b<g.length;b++)d=g[b],d.element.scrollLeft=d.left,d.element.scrollTop=d.top}}var W2=T&&"documentMode"in document&&11>=document.documentMode,zc=null,ap=null,xd=null,Fc=!1;function Hv(d,g,b){var I=b.window===b?b.document:b.nodeType===9?b:b.ownerDocument;Fc||zc==null||zc!==On(I)||(I=zc,"selectionStart"in I&&hy(I)?I={start:I.selectionStart,end:I.selectionEnd}:(I=(I.ownerDocument&&I.ownerDocument.defaultView||window).getSelection(),I={anchorNode:I.anchorNode,anchorOffset:I.anchorOffset,focusNode:I.focusNode,focusOffset:I.focusOffset}),xd&&ku(xd,I)||(xd=I,I=mp(ap,"onSelect"),0<I.length&&(g=new hd("onSelect","select",null,g,b),d.push({event:g,listeners:I}),g.target=zc)))}function wd(d,g){var b={};return b[d.toLowerCase()]=g.toLowerCase(),b["Webkit"+d]="webkit"+g,b["Moz"+d]="moz"+g,b}var Nl={animationend:wd("Animation","AnimationEnd"),animationiteration:wd("Animation","AnimationIteration"),animationstart:wd("Animation","AnimationStart"),transitionend:wd("Transition","TransitionEnd")},Bc={},lp={};T&&(lp=document.createElement("div").style,"AnimationEvent"in window||(delete Nl.animationend.animation,delete Nl.animationiteration.animation,delete Nl.animationstart.animation),"TransitionEvent"in window||delete Nl.transitionend.transition);function jl(d){if(Bc[d])return Bc[d];if(!Nl[d])return d;var g=Nl[d],b;for(b in g)if(g.hasOwnProperty(b)&&b in lp)return Bc[d]=g[b];return d}var up=jl("animationend"),Nc=jl("animationiteration"),bd=jl("animationstart"),cp=jl("transitionend"),Ul=new Map,hp="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Za(d,g){Ul.set(d,g),_(g,[d])}for(var Sd=0;Sd<hp.length;Sd++){var dp=hp[Sd],dy=dp.toLowerCase(),fp=dp[0].toUpperCase()+dp.slice(1);Za(dy,"on"+fp)}Za(up,"onAnimationEnd"),Za(Nc,"onAnimationIteration"),Za(bd,"onAnimationStart"),Za("dblclick","onDoubleClick"),Za("focusin","onFocus"),Za("focusout","onBlur"),Za(cp,"onTransitionEnd"),x("onMouseEnter",["mouseout","mouseover"]),x("onMouseLeave",["mouseout","mouseover"]),x("onPointerEnter",["pointerout","pointerover"]),x("onPointerLeave",["pointerout","pointerover"]),_("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),_("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),_("onBeforeInput",["compositionend","keypress","textInput","paste"]),_("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),_("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),_("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Pu="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),fy=new Set("cancel close invalid load scroll toggle".split(" ").concat(Pu));function nn(d,g,b){var I=d.type||"unknown-event";d.currentTarget=b,Rr(I,g,void 0,d),d.currentTarget=null}function Ed(d,g){g=(g&4)!==0;for(var b=0;b<d.length;b++){var I=d[b],D=I.event;I=I.listeners;e:{var N=void 0;if(g)for(var X=I.length-1;0<=X;X--){var ve=I[X],Ce=ve.instance,Ye=ve.currentTarget;if(ve=ve.listener,Ce!==N&&D.isPropagationStopped())break e;nn(D,ve,Ye),N=Ce}else for(X=0;X<I.length;X++){if(ve=I[X],Ce=ve.instance,Ye=ve.currentTarget,ve=ve.listener,Ce!==N&&D.isPropagationStopped())break e;nn(D,ve,Ye),N=Ce}}}if(qn)throw d=Wn,qn=!1,Wn=null,d}function Jr(d,g){var b=g[wy];b===void 0&&(b=g[wy]=new Set);var I=d+"__bubble";b.has(I)||(py(g,d,2,!1),b.add(I))}function pp(d,g,b){var I=0;g&&(I|=4),py(b,d,I,g)}var Td="_reactListening"+Math.random().toString(36).slice(2);function ua(d){if(!d[Td]){d[Td]=!0,c.forEach(function(b){b!=="selectionchange"&&(fy.has(b)||pp(b,!1,d),pp(b,!0,d))});var g=d.nodeType===9?d:d.ownerDocument;g===null||g[Td]||(g[Td]=!0,pp("selectionchange",!1,g))}}function py(d,g,b,I){switch(si(g)){case 1:var D=Zn;break;case 4:D=Yf;break;default:D=Cu}b=D.bind(null,g,b,d),D=void 0,!Et||g!=="touchstart"&&g!=="touchmove"&&g!=="wheel"||(D=!0),I?D!==void 0?d.addEventListener(g,b,{capture:!0,passive:D}):d.addEventListener(g,b,!0):D!==void 0?d.addEventListener(g,b,{passive:D}):d.addEventListener(g,b,!1)}function my(d,g,b,I,D){var N=I;if(!(g&1)&&!(g&2)&&I!==null)e:for(;;){if(I===null)return;var X=I.tag;if(X===3||X===4){var ve=I.stateNode.containerInfo;if(ve===D||ve.nodeType===8&&ve.parentNode===D)break;if(X===4)for(X=I.return;X!==null;){var Ce=X.tag;if((Ce===3||Ce===4)&&(Ce=X.stateNode.containerInfo,Ce===D||Ce.nodeType===8&&Ce.parentNode===D))return;X=X.return}for(;ve!==null;){if(X=Ka(ve),X===null)return;if(Ce=X.tag,Ce===5||Ce===6){I=N=X;continue e}ve=ve.parentNode}}I=I.return}at(function(){var Ye=N,At=Ht(b),Dt=[];e:{var Tt=Ul.get(d);if(Tt!==void 0){var Jt=hd,on=d;switch(d){case"keypress":if(Ic(b)===0)break e;case"keydown":case"keyup":Jt=Ov;break;case"focusin":on="focus",Jt=md;break;case"focusout":on="blur",Jt=md;break;case"beforeblur":case"afterblur":Jt=md;break;case"click":if(b.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Jt=Jg;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Jt=Pi;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Jt=zv;break;case up:case Nc:case bd:Jt=Ni;break;case cp:Jt=G2;break;case"scroll":Jt=wn;break;case"wheel":Jt=vd;break;case"copy":case"cut":case"paste":Jt=ty;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Jt=Ws}var un=(g&4)!==0,Ti=!un&&d==="scroll",Ze=un?Tt!==null?Tt+"Capture":null:Tt;un=[];for(var Fe=Ye,Re;Fe!==null;){Re=Fe;var Bt=Re.stateNode;if(Re.tag===5&&Bt!==null&&(Re=Bt,Ze!==null&&(Bt=ut(Fe,Ze),Bt!=null&&un.push(Cd(Fe,Bt,Re)))),Ti)break;Fe=Fe.return}0<un.length&&(Tt=new Jt(Tt,on,null,b,At),Dt.push({event:Tt,listeners:un}))}}if(!(g&7)){e:{if(Tt=d==="mouseover"||d==="pointerover",Jt=d==="mouseout"||d==="pointerout",Tt&&b!==Vt&&(on=b.relatedTarget||b.fromElement)&&(Ka(on)||on[Cs]))break e;if((Jt||Tt)&&(Tt=At.window===At?At:(Tt=At.ownerDocument)?Tt.defaultView||Tt.parentWindow:window,Jt?(on=b.relatedTarget||b.toElement,Jt=Ye,on=on?Ka(on):null,on!==null&&(Ti=Yr(on),on!==Ti||on.tag!==5&&on.tag!==6)&&(on=null)):(Jt=null,on=Ye),Jt!==on)){if(un=Jg,Bt="onMouseLeave",Ze="onMouseEnter",Fe="mouse",(d==="pointerout"||d==="pointerover")&&(un=Ws,Bt="onPointerLeave",Ze="onPointerEnter",Fe="pointer"),Ti=Jt==null?Tt:Ya(Jt),Re=on==null?Tt:Ya(on),Tt=new un(Bt,Fe+"leave",Jt,b,At),Tt.target=Ti,Tt.relatedTarget=Re,Bt=null,Ka(At)===Ye&&(un=new un(Ze,Fe+"enter",on,b,At),un.target=Re,un.relatedTarget=Ti,Bt=un),Ti=Bt,Jt&&on)t:{for(un=Jt,Ze=on,Fe=0,Re=un;Re;Re=Vl(Re))Fe++;for(Re=0,Bt=Ze;Bt;Bt=Vl(Bt))Re++;for(;0<Fe-Re;)un=Vl(un),Fe--;for(;0<Re-Fe;)Ze=Vl(Ze),Re--;for(;Fe--;){if(un===Ze||Ze!==null&&un===Ze.alternate)break t;un=Vl(un),Ze=Vl(Ze)}un=null}else un=null;Jt!==null&&gp(Dt,Tt,Jt,un,!1),on!==null&&Ti!==null&&gp(Dt,Ti,on,un,!0)}}e:{if(Tt=Ye?Ya(Ye):window,Jt=Tt.nodeName&&Tt.nodeName.toLowerCase(),Jt==="select"||Jt==="input"&&Tt.type==="file")var rn=$v;else if(oy(Tt))if(ep)rn=Iu;else{rn=Wa;var Tn=ip}else(Jt=Tt.nodeName)&&Jt.toLowerCase()==="input"&&(Tt.type==="checkbox"||Tt.type==="radio")&&(rn=ly);if(rn&&(rn=rn(d,Ye))){sy(Dt,rn,b,At);break e}Tn&&Tn(d,Tt,Ye),d==="focusout"&&(Tn=Tt._wrapperState)&&Tn.controlled&&Tt.type==="number"&&ye(Tt,"number",Tt.value)}switch(Tn=Ye?Ya(Ye):window,d){case"focusin":(oy(Tn)||Tn.contentEditable==="true")&&(zc=Tn,ap=Ye,xd=null);break;case"focusout":xd=ap=zc=null;break;case"mousedown":Fc=!0;break;case"contextmenu":case"mouseup":case"dragend":Fc=!1,Hv(Dt,b,At);break;case"selectionchange":if(W2)break;case"keydown":case"keyup":Hv(Dt,b,At)}var Cn;if(Bl)e:{switch(d){case"compositionstart":var jn="onCompositionStart";break e;case"compositionend":jn="onCompositionEnd";break e;case"compositionupdate":jn="onCompositionUpdate";break e}jn=void 0}else Lc?Nv(d,b)&&(jn="onCompositionEnd"):d==="keydown"&&b.keyCode===229&&(jn="onCompositionStart");jn&&(Ha&&b.locale!=="ko"&&(Lc||jn!=="onCompositionStart"?jn==="onCompositionEnd"&&Lc&&(Cn=Mc()):(Fl=At,Au="value"in Fl?Fl.value:Fl.textContent,Lc=!0)),Tn=mp(Ye,jn),0<Tn.length&&(jn=new Pc(jn,d,null,b,At),Dt.push({event:jn,listeners:Tn}),Cn?jn.data=Cn:(Cn=ry(b),Cn!==null&&(jn.data=Cn)))),(Cn=Jf?iy(d,b):jv(d,b))&&(Ye=mp(Ye,"onBeforeInput"),0<Ye.length&&(At=new Pc("onBeforeInput","beforeinput",null,b,At),Dt.push({event:At,listeners:Ye}),At.data=Cn))}Ed(Dt,g)})}function Cd(d,g,b){return{instance:d,listener:g,currentTarget:b}}function mp(d,g){for(var b=g+"Capture",I=[];d!==null;){var D=d,N=D.stateNode;D.tag===5&&N!==null&&(D=N,N=ut(d,b),N!=null&&I.unshift(Cd(d,N,D)),N=ut(d,g),N!=null&&I.push(Cd(d,N,D))),d=d.return}return I}function Vl(d){if(d===null)return null;do d=d.return;while(d&&d.tag!==5);return d||null}function gp(d,g,b,I,D){for(var N=g._reactName,X=[];b!==null&&b!==I;){var ve=b,Ce=ve.alternate,Ye=ve.stateNode;if(Ce!==null&&Ce===I)break;ve.tag===5&&Ye!==null&&(ve=Ye,D?(Ce=ut(b,N),Ce!=null&&X.unshift(Cd(b,Ce,ve))):D||(Ce=ut(b,N),Ce!=null&&X.push(Cd(b,Ce,ve)))),b=b.return}X.length!==0&&d.push({event:g,listeners:X})}var gy=/\r\n?/g,yy=/\u0000|\uFFFD/g;function _y(d){return(typeof d=="string"?d:""+d).replace(gy,`
`).replace(yy,"")}function Ad(d,g,b){if(g=_y(g),_y(d)!==g&&b)throw Error(a(425))}function yp(){}var Ru=null,Du=null;function _p(d,g){return d==="textarea"||d==="noscript"||typeof g.children=="string"||typeof g.children=="number"||typeof g.dangerouslySetInnerHTML=="object"&&g.dangerouslySetInnerHTML!==null&&g.dangerouslySetInnerHTML.__html!=null}var jc=typeof setTimeout=="function"?setTimeout:void 0,vy=typeof clearTimeout=="function"?clearTimeout:void 0,Zs=typeof Promise=="function"?Promise:void 0,xy=typeof queueMicrotask=="function"?queueMicrotask:typeof Zs<"u"?function(d){return Zs.resolve(null).then(d).catch(qv)}:jc;function qv(d){setTimeout(function(){throw d})}function Md(d,g){var b=g,I=0;do{var D=b.nextSibling;if(d.removeChild(b),D&&D.nodeType===8)if(b=D.data,b==="/$"){if(I===0){d.removeChild(D),Gn(g);return}I--}else b!=="$"&&b!=="$?"&&b!=="$!"||I++;b=D}while(b);Gn(g)}function Xa(d){for(;d!=null;d=d.nextSibling){var g=d.nodeType;if(g===1||g===3)break;if(g===8){if(g=d.data,g==="$"||g==="$!"||g==="$?")break;if(g==="/$")return null}}return d}function vp(d){d=d.previousSibling;for(var g=0;d;){if(d.nodeType===8){var b=d.data;if(b==="$"||b==="$!"||b==="$?"){if(g===0)return d;g--}else b==="/$"&&g++}d=d.previousSibling}return null}var Uc=Math.random().toString(36).slice(2),Ts="__reactFiber$"+Uc,Id="__reactProps$"+Uc,Cs="__reactContainer$"+Uc,wy="__reactEvents$"+Uc,by="__reactListeners$"+Uc,Z2="__reactHandles$"+Uc;function Ka(d){var g=d[Ts];if(g)return g;for(var b=d.parentNode;b;){if(g=b[Cs]||b[Ts]){if(b=g.alternate,g.child!==null||b!==null&&b.child!==null)for(d=vp(d);d!==null;){if(b=d[Ts])return b;d=vp(d)}return g}d=b,b=d.parentNode}return null}function kd(d){return d=d[Ts]||d[Cs],!d||d.tag!==5&&d.tag!==6&&d.tag!==13&&d.tag!==3?null:d}function Ya(d){if(d.tag===5||d.tag===6)return d.stateNode;throw Error(a(33))}function xp(d){return d[Id]||null}var wp=[],Lu=-1;function ss(d){return{current:d}}function ai(d){0>Lu||(d.current=wp[Lu],wp[Lu]=null,Lu--)}function ei(d,g){Lu++,wp[Lu]=d.current,d.current=g}var $l={},go=ss($l),qo=ss(!1),Ou=$l;function Gl(d,g){var b=d.type.contextTypes;if(!b)return $l;var I=d.stateNode;if(I&&I.__reactInternalMemoizedUnmaskedChildContext===g)return I.__reactInternalMemoizedMaskedChildContext;var D={},N;for(N in b)D[N]=g[N];return I&&(d=d.stateNode,d.__reactInternalMemoizedUnmaskedChildContext=g,d.__reactInternalMemoizedMaskedChildContext=D),D}function yo(d){return d=d.childContextTypes,d!=null}function Vc(){ai(qo),ai(go)}function Sy(d,g,b){if(go.current!==$l)throw Error(a(168));ei(go,g),ei(qo,b)}function Ey(d,g,b){var I=d.stateNode;if(g=g.childContextTypes,typeof I.getChildContext!="function")return b;I=I.getChildContext();for(var D in I)if(!(D in g))throw Error(a(108,Pt(d)||"Unknown",D));return Q({},b,I)}function Pd(d){return d=(d=d.stateNode)&&d.__reactInternalMemoizedMergedChildContext||$l,Ou=go.current,ei(go,d),ei(qo,qo.current),!0}function Ty(d,g,b){var I=d.stateNode;if(!I)throw Error(a(169));b?(d=Ey(d,g,Ou),I.__reactInternalMemoizedMergedChildContext=d,ai(qo),ai(go),ei(go,d)):ai(qo),ei(qo,b)}var Xs=null,Rd=!1,Qa=!1;function $c(d){Xs===null?Xs=[d]:Xs.push(d)}function Wv(d){Rd=!0,$c(d)}function Wo(){if(!Qa&&Xs!==null){Qa=!0;var d=0,g=Lr;try{var b=Xs;for(Lr=1;d<b.length;d++){var I=b[d];do I=I(!0);while(I!==null)}Xs=null,Rd=!1}catch(D){throw Xs!==null&&(Xs=Xs.slice(d+1)),Ho(Ol,Wo),D}finally{Lr=g,Qa=!1}}return null}var zu=[],As=0,Dd=null,Gc=0,Zo=[],Lo=0,Fu=null,ca=1,as="";function Bu(d,g){zu[As++]=Gc,zu[As++]=Dd,Dd=d,Gc=g}function Zv(d,g,b){Zo[Lo++]=ca,Zo[Lo++]=as,Zo[Lo++]=Fu,Fu=d;var I=ca;d=as;var D=32-qs(I)-1;I&=~(1<<D),b+=1;var N=32-qs(g)+D;if(30<N){var X=D-D%5;N=(I&(1<<X)-1).toString(32),I>>=X,D-=X,ca=1<<32-qs(g)+D|b<<D|I,as=N+d}else ca=1<<N|b<<D|I,as=d}function bp(d){d.return!==null&&(Bu(d,1),Zv(d,1,0))}function Cy(d){for(;d===Dd;)Dd=zu[--As],zu[As]=null,Gc=zu[--As],zu[As]=null;for(;d===Fu;)Fu=Zo[--Lo],Zo[Lo]=null,as=Zo[--Lo],Zo[Lo]=null,ca=Zo[--Lo],Zo[Lo]=null}var Oo=null,_o=null,Ar=!1,ls=null;function Ld(d,g){var b=ms(5,null,null,0);b.elementType="DELETED",b.stateNode=g,b.return=d,g=d.deletions,g===null?(d.deletions=[b],d.flags|=16):g.push(b)}function Sp(d,g){switch(d.tag){case 5:var b=d.type;return g=g.nodeType!==1||b.toLowerCase()!==g.nodeName.toLowerCase()?null:g,g!==null?(d.stateNode=g,Oo=d,_o=Xa(g.firstChild),!0):!1;case 6:return g=d.pendingProps===""||g.nodeType!==3?null:g,g!==null?(d.stateNode=g,Oo=d,_o=null,!0):!1;case 13:return g=g.nodeType!==8?null:g,g!==null?(b=Fu!==null?{id:ca,overflow:as}:null,d.memoizedState={dehydrated:g,treeContext:b,retryLane:1073741824},b=ms(18,null,null,0),b.stateNode=g,b.return=d,d.child=b,Oo=d,_o=null,!0):!1;default:return!1}}function Hc(d){return(d.mode&1)!==0&&(d.flags&128)===0}function qc(d){if(Ar){var g=_o;if(g){var b=g;if(!Sp(d,g)){if(Hc(d))throw Error(a(418));g=Xa(b.nextSibling);var I=Oo;g&&Sp(d,g)?Ld(I,b):(d.flags=d.flags&-4097|2,Ar=!1,Oo=d)}}else{if(Hc(d))throw Error(a(418));d.flags=d.flags&-4097|2,Ar=!1,Oo=d}}}function us(d){for(d=d.return;d!==null&&d.tag!==5&&d.tag!==3&&d.tag!==13;)d=d.return;Oo=d}function Od(d){if(d!==Oo)return!1;if(!Ar)return us(d),Ar=!0,!1;var g;if((g=d.tag!==3)&&!(g=d.tag!==5)&&(g=d.type,g=g!=="head"&&g!=="body"&&!_p(d.type,d.memoizedProps)),g&&(g=_o)){if(Hc(d))throw Ay(),Error(a(418));for(;g;)Ld(d,g),g=Xa(g.nextSibling)}if(us(d),d.tag===13){if(d=d.memoizedState,d=d!==null?d.dehydrated:null,!d)throw Error(a(317));e:{for(d=d.nextSibling,g=0;d;){if(d.nodeType===8){var b=d.data;if(b==="/$"){if(g===0){_o=Xa(d.nextSibling);break e}g--}else b!=="$"&&b!=="$!"&&b!=="$?"||g++}d=d.nextSibling}_o=null}}else _o=Oo?Xa(d.stateNode.nextSibling):null;return!0}function Ay(){for(var d=_o;d;)d=Xa(d.nextSibling)}function Nu(){_o=Oo=null,Ar=!1}function Ja(d){ls===null?ls=[d]:ls.push(d)}var Xv=W.ReactCurrentBatchConfig;function Xo(d,g){if(d&&d.defaultProps){g=Q({},g),d=d.defaultProps;for(var b in d)g[b]===void 0&&(g[b]=d[b]);return g}return g}var Wc=ss(null),ju=null,Uu=null,Ep=null;function Hl(){Ep=Uu=ju=null}function My(d){var g=Wc.current;ai(Wc),d._currentValue=g}function Iy(d,g,b){for(;d!==null;){var I=d.alternate;if((d.childLanes&g)!==g?(d.childLanes|=g,I!==null&&(I.childLanes|=g)):I!==null&&(I.childLanes&g)!==g&&(I.childLanes|=g),d===b)break;d=d.return}}function Vu(d,g){ju=d,Ep=Uu=null,d=d.dependencies,d!==null&&d.firstContext!==null&&(d.lanes&g&&(wo=!0),d.firstContext=null)}function zo(d){var g=d._currentValue;if(Ep!==d)if(d={context:d,memoizedValue:g,next:null},Uu===null){if(ju===null)throw Error(a(308));Uu=d,ju.dependencies={lanes:0,firstContext:d}}else Uu=Uu.next=d;return g}var el=null;function Tp(d){el===null?el=[d]:el.push(d)}function ky(d,g,b,I){var D=g.interleaved;return D===null?(b.next=b,Tp(g)):(b.next=D.next,D.next=b),g.interleaved=b,Ms(d,I)}function Ms(d,g){d.lanes|=g;var b=d.alternate;for(b!==null&&(b.lanes|=g),b=d,d=d.return;d!==null;)d.childLanes|=g,b=d.alternate,b!==null&&(b.childLanes|=g),b=d,d=d.return;return b.tag===3?b.stateNode:null}var ha=!1;function Cp(d){d.updateQueue={baseState:d.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Py(d,g){d=d.updateQueue,g.updateQueue===d&&(g.updateQueue={baseState:d.baseState,firstBaseUpdate:d.firstBaseUpdate,lastBaseUpdate:d.lastBaseUpdate,shared:d.shared,effects:d.effects})}function da(d,g){return{eventTime:d,lane:g,tag:0,payload:null,callback:null,next:null}}function tl(d,g,b){var I=d.updateQueue;if(I===null)return null;if(I=I.shared,Hn&2){var D=I.pending;return D===null?g.next=g:(g.next=D.next,D.next=g),I.pending=g,Ms(d,b)}return D=I.interleaved,D===null?(g.next=g,Tp(I)):(g.next=D.next,D.next=g),I.interleaved=g,Ms(d,b)}function zd(d,g,b){if(g=g.updateQueue,g!==null&&(g=g.shared,(b&4194240)!==0)){var I=g.lanes;I&=d.pendingLanes,b|=I,g.lanes=b,Hf(d,b)}}function $u(d,g){var b=d.updateQueue,I=d.alternate;if(I!==null&&(I=I.updateQueue,b===I)){var D=null,N=null;if(b=b.firstBaseUpdate,b!==null){do{var X={eventTime:b.eventTime,lane:b.lane,tag:b.tag,payload:b.payload,callback:b.callback,next:null};N===null?D=N=X:N=N.next=X,b=b.next}while(b!==null);N===null?D=N=g:N=N.next=g}else D=N=g;b={baseState:I.baseState,firstBaseUpdate:D,lastBaseUpdate:N,shared:I.shared,effects:I.effects},d.updateQueue=b;return}d=b.lastBaseUpdate,d===null?b.firstBaseUpdate=g:d.next=g,b.lastBaseUpdate=g}function Fd(d,g,b,I){var D=d.updateQueue;ha=!1;var N=D.firstBaseUpdate,X=D.lastBaseUpdate,ve=D.shared.pending;if(ve!==null){D.shared.pending=null;var Ce=ve,Ye=Ce.next;Ce.next=null,X===null?N=Ye:X.next=Ye,X=Ce;var At=d.alternate;At!==null&&(At=At.updateQueue,ve=At.lastBaseUpdate,ve!==X&&(ve===null?At.firstBaseUpdate=Ye:ve.next=Ye,At.lastBaseUpdate=Ce))}if(N!==null){var Dt=D.baseState;X=0,At=Ye=Ce=null,ve=N;do{var Tt=ve.lane,Jt=ve.eventTime;if((I&Tt)===Tt){At!==null&&(At=At.next={eventTime:Jt,lane:0,tag:ve.tag,payload:ve.payload,callback:ve.callback,next:null});e:{var on=d,un=ve;switch(Tt=g,Jt=b,un.tag){case 1:if(on=un.payload,typeof on=="function"){Dt=on.call(Jt,Dt,Tt);break e}Dt=on;break e;case 3:on.flags=on.flags&-65537|128;case 0:if(on=un.payload,Tt=typeof on=="function"?on.call(Jt,Dt,Tt):on,Tt==null)break e;Dt=Q({},Dt,Tt);break e;case 2:ha=!0}}ve.callback!==null&&ve.lane!==0&&(d.flags|=64,Tt=D.effects,Tt===null?D.effects=[ve]:Tt.push(ve))}else Jt={eventTime:Jt,lane:Tt,tag:ve.tag,payload:ve.payload,callback:ve.callback,next:null},At===null?(Ye=At=Jt,Ce=Dt):At=At.next=Jt,X|=Tt;if(ve=ve.next,ve===null){if(ve=D.shared.pending,ve===null)break;Tt=ve,ve=Tt.next,Tt.next=null,D.lastBaseUpdate=Tt,D.shared.pending=null}}while(1);if(At===null&&(Ce=Dt),D.baseState=Ce,D.firstBaseUpdate=Ye,D.lastBaseUpdate=At,g=D.shared.interleaved,g!==null){D=g;do X|=D.lane,D=D.next;while(D!==g)}else N===null&&(D.shared.lanes=0);Kl|=X,d.lanes=X,d.memoizedState=Dt}}function Ry(d,g,b){if(d=g.effects,g.effects=null,d!==null)for(g=0;g<d.length;g++){var I=d[g],D=I.callback;if(D!==null){if(I.callback=null,I=b,typeof D!="function")throw Error(a(191,D));D.call(I)}}}var Kv=new r.Component().refs;function Ap(d,g,b,I){g=d.memoizedState,b=b(I,g),b=b==null?g:Q({},g,b),d.memoizedState=b,d.lanes===0&&(d.updateQueue.baseState=b)}var Bd={isMounted:function(d){return(d=d._reactInternals)?Yr(d)===d:!1},enqueueSetState:function(d,g,b){d=d._reactInternals;var I=Co(),D=cl(d),N=da(I,D);N.payload=g,b!=null&&(N.callback=b),g=tl(d,N,D),g!==null&&(Ps(g,d,D,I),zd(g,d,D))},enqueueReplaceState:function(d,g,b){d=d._reactInternals;var I=Co(),D=cl(d),N=da(I,D);N.tag=1,N.payload=g,b!=null&&(N.callback=b),g=tl(d,N,D),g!==null&&(Ps(g,d,D,I),zd(g,d,D))},enqueueForceUpdate:function(d,g){d=d._reactInternals;var b=Co(),I=cl(d),D=da(b,I);D.tag=2,g!=null&&(D.callback=g),g=tl(d,D,I),g!==null&&(Ps(g,d,I,b),zd(g,d,I))}};function Dy(d,g,b,I,D,N,X){return d=d.stateNode,typeof d.shouldComponentUpdate=="function"?d.shouldComponentUpdate(I,N,X):g.prototype&&g.prototype.isPureReactComponent?!ku(b,I)||!ku(D,N):!0}function Ly(d,g,b){var I=!1,D=$l,N=g.contextType;return typeof N=="object"&&N!==null?N=zo(N):(D=yo(g)?Ou:go.current,I=g.contextTypes,N=(I=I!=null)?Gl(d,D):$l),g=new g(b,N),d.memoizedState=g.state!==null&&g.state!==void 0?g.state:null,g.updater=Bd,d.stateNode=g,g._reactInternals=d,I&&(d=d.stateNode,d.__reactInternalMemoizedUnmaskedChildContext=D,d.__reactInternalMemoizedMaskedChildContext=N),g}function Oy(d,g,b,I){d=g.state,typeof g.componentWillReceiveProps=="function"&&g.componentWillReceiveProps(b,I),typeof g.UNSAFE_componentWillReceiveProps=="function"&&g.UNSAFE_componentWillReceiveProps(b,I),g.state!==d&&Bd.enqueueReplaceState(g,g.state,null)}function Mp(d,g,b,I){var D=d.stateNode;D.props=b,D.state=d.memoizedState,D.refs=Kv,Cp(d);var N=g.contextType;typeof N=="object"&&N!==null?D.context=zo(N):(N=yo(g)?Ou:go.current,D.context=Gl(d,N)),D.state=d.memoizedState,N=g.getDerivedStateFromProps,typeof N=="function"&&(Ap(d,g,N,b),D.state=d.memoizedState),typeof g.getDerivedStateFromProps=="function"||typeof D.getSnapshotBeforeUpdate=="function"||typeof D.UNSAFE_componentWillMount!="function"&&typeof D.componentWillMount!="function"||(g=D.state,typeof D.componentWillMount=="function"&&D.componentWillMount(),typeof D.UNSAFE_componentWillMount=="function"&&D.UNSAFE_componentWillMount(),g!==D.state&&Bd.enqueueReplaceState(D,D.state,null),Fd(d,b,D,I),D.state=d.memoizedState),typeof D.componentDidMount=="function"&&(d.flags|=4194308)}function yi(d,g,b){if(d=b.ref,d!==null&&typeof d!="function"&&typeof d!="object"){if(b._owner){if(b=b._owner,b){if(b.tag!==1)throw Error(a(309));var I=b.stateNode}if(!I)throw Error(a(147,d));var D=I,N=""+d;return g!==null&&g.ref!==null&&typeof g.ref=="function"&&g.ref._stringRef===N?g.ref:(g=function(X){var ve=D.refs;ve===Kv&&(ve=D.refs={}),X===null?delete ve[N]:ve[N]=X},g._stringRef=N,g)}if(typeof d!="string")throw Error(a(284));if(!b._owner)throw Error(a(290,d))}return d}function Ip(d,g){throw d=Object.prototype.toString.call(g),Error(a(31,d==="[object Object]"?"object with keys {"+Object.keys(g).join(", ")+"}":d))}function zy(d){var g=d._init;return g(d._payload)}function Gu(d){function g(Ze,Fe){if(d){var Re=Ze.deletions;Re===null?(Ze.deletions=[Fe],Ze.flags|=16):Re.push(Fe)}}function b(Ze,Fe){if(!d)return null;for(;Fe!==null;)g(Ze,Fe),Fe=Fe.sibling;return null}function I(Ze,Fe){for(Ze=new Map;Fe!==null;)Fe.key!==null?Ze.set(Fe.key,Fe):Ze.set(Fe.index,Fe),Fe=Fe.sibling;return Ze}function D(Ze,Fe){return Ze=dl(Ze,Fe),Ze.index=0,Ze.sibling=null,Ze}function N(Ze,Fe,Re){return Ze.index=Re,d?(Re=Ze.alternate,Re!==null?(Re=Re.index,Re<Fe?(Ze.flags|=2,Fe):Re):(Ze.flags|=2,Fe)):(Ze.flags|=1048576,Fe)}function X(Ze){return d&&Ze.alternate===null&&(Ze.flags|=2),Ze}function ve(Ze,Fe,Re,Bt){return Fe===null||Fe.tag!==6?(Fe=om(Re,Ze.mode,Bt),Fe.return=Ze,Fe):(Fe=D(Fe,Re),Fe.return=Ze,Fe)}function Ce(Ze,Fe,Re,Bt){var rn=Re.type;return rn===he?At(Ze,Fe,Re.props.children,Bt,Re.key):Fe!==null&&(Fe.elementType===rn||typeof rn=="object"&&rn!==null&&rn.$$typeof===zt&&zy(rn)===Fe.type)?(Bt=D(Fe,Re.props),Bt.ref=yi(Ze,Fe,Re),Bt.return=Ze,Bt):(Bt=rf(Re.type,Re.key,Re.props,null,Ze.mode,Bt),Bt.ref=yi(Ze,Fe,Re),Bt.return=Ze,Bt)}function Ye(Ze,Fe,Re,Bt){return Fe===null||Fe.tag!==4||Fe.stateNode.containerInfo!==Re.containerInfo||Fe.stateNode.implementation!==Re.implementation?(Fe=n_(Re,Ze.mode,Bt),Fe.return=Ze,Fe):(Fe=D(Fe,Re.children||[]),Fe.return=Ze,Fe)}function At(Ze,Fe,Re,Bt,rn){return Fe===null||Fe.tag!==7?(Fe=eu(Re,Ze.mode,Bt,rn),Fe.return=Ze,Fe):(Fe=D(Fe,Re),Fe.return=Ze,Fe)}function Dt(Ze,Fe,Re){if(typeof Fe=="string"&&Fe!==""||typeof Fe=="number")return Fe=om(""+Fe,Ze.mode,Re),Fe.return=Ze,Fe;if(typeof Fe=="object"&&Fe!==null){switch(Fe.$$typeof){case me:return Re=rf(Fe.type,Fe.key,Fe.props,null,Ze.mode,Re),Re.ref=yi(Ze,null,Fe),Re.return=Ze,Re;case de:return Fe=n_(Fe,Ze.mode,Re),Fe.return=Ze,Fe;case zt:var Bt=Fe._init;return Dt(Ze,Bt(Fe._payload),Re)}if(We(Fe)||we(Fe))return Fe=eu(Fe,Ze.mode,Re,null),Fe.return=Ze,Fe;Ip(Ze,Fe)}return null}function Tt(Ze,Fe,Re,Bt){var rn=Fe!==null?Fe.key:null;if(typeof Re=="string"&&Re!==""||typeof Re=="number")return rn!==null?null:ve(Ze,Fe,""+Re,Bt);if(typeof Re=="object"&&Re!==null){switch(Re.$$typeof){case me:return Re.key===rn?Ce(Ze,Fe,Re,Bt):null;case de:return Re.key===rn?Ye(Ze,Fe,Re,Bt):null;case zt:return rn=Re._init,Tt(Ze,Fe,rn(Re._payload),Bt)}if(We(Re)||we(Re))return rn!==null?null:At(Ze,Fe,Re,Bt,null);Ip(Ze,Re)}return null}function Jt(Ze,Fe,Re,Bt,rn){if(typeof Bt=="string"&&Bt!==""||typeof Bt=="number")return Ze=Ze.get(Re)||null,ve(Fe,Ze,""+Bt,rn);if(typeof Bt=="object"&&Bt!==null){switch(Bt.$$typeof){case me:return Ze=Ze.get(Bt.key===null?Re:Bt.key)||null,Ce(Fe,Ze,Bt,rn);case de:return Ze=Ze.get(Bt.key===null?Re:Bt.key)||null,Ye(Fe,Ze,Bt,rn);case zt:var Tn=Bt._init;return Jt(Ze,Fe,Re,Tn(Bt._payload),rn)}if(We(Bt)||we(Bt))return Ze=Ze.get(Re)||null,At(Fe,Ze,Bt,rn,null);Ip(Fe,Bt)}return null}function on(Ze,Fe,Re,Bt){for(var rn=null,Tn=null,Cn=Fe,jn=Fe=0,qi=null;Cn!==null&&jn<Re.length;jn++){Cn.index>jn?(qi=Cn,Cn=null):qi=Cn.sibling;var Sr=Tt(Ze,Cn,Re[jn],Bt);if(Sr===null){Cn===null&&(Cn=qi);break}d&&Cn&&Sr.alternate===null&&g(Ze,Cn),Fe=N(Sr,Fe,jn),Tn===null?rn=Sr:Tn.sibling=Sr,Tn=Sr,Cn=qi}if(jn===Re.length)return b(Ze,Cn),Ar&&Bu(Ze,jn),rn;if(Cn===null){for(;jn<Re.length;jn++)Cn=Dt(Ze,Re[jn],Bt),Cn!==null&&(Fe=N(Cn,Fe,jn),Tn===null?rn=Cn:Tn.sibling=Cn,Tn=Cn);return Ar&&Bu(Ze,jn),rn}for(Cn=I(Ze,Cn);jn<Re.length;jn++)qi=Jt(Cn,Ze,jn,Re[jn],Bt),qi!==null&&(d&&qi.alternate!==null&&Cn.delete(qi.key===null?jn:qi.key),Fe=N(qi,Fe,jn),Tn===null?rn=qi:Tn.sibling=qi,Tn=qi);return d&&Cn.forEach(function(pl){return g(Ze,pl)}),Ar&&Bu(Ze,jn),rn}function un(Ze,Fe,Re,Bt){var rn=we(Re);if(typeof rn!="function")throw Error(a(150));if(Re=rn.call(Re),Re==null)throw Error(a(151));for(var Tn=rn=null,Cn=Fe,jn=Fe=0,qi=null,Sr=Re.next();Cn!==null&&!Sr.done;jn++,Sr=Re.next()){Cn.index>jn?(qi=Cn,Cn=null):qi=Cn.sibling;var pl=Tt(Ze,Cn,Sr.value,Bt);if(pl===null){Cn===null&&(Cn=qi);break}d&&Cn&&pl.alternate===null&&g(Ze,Cn),Fe=N(pl,Fe,jn),Tn===null?rn=pl:Tn.sibling=pl,Tn=pl,Cn=qi}if(Sr.done)return b(Ze,Cn),Ar&&Bu(Ze,jn),rn;if(Cn===null){for(;!Sr.done;jn++,Sr=Re.next())Sr=Dt(Ze,Sr.value,Bt),Sr!==null&&(Fe=N(Sr,Fe,jn),Tn===null?rn=Sr:Tn.sibling=Sr,Tn=Sr);return Ar&&Bu(Ze,jn),rn}for(Cn=I(Ze,Cn);!Sr.done;jn++,Sr=Re.next())Sr=Jt(Cn,Ze,jn,Sr.value,Bt),Sr!==null&&(d&&Sr.alternate!==null&&Cn.delete(Sr.key===null?jn:Sr.key),Fe=N(Sr,Fe,jn),Tn===null?rn=Sr:Tn.sibling=Sr,Tn=Sr);return d&&Cn.forEach(function(x1){return g(Ze,x1)}),Ar&&Bu(Ze,jn),rn}function Ti(Ze,Fe,Re,Bt){if(typeof Re=="object"&&Re!==null&&Re.type===he&&Re.key===null&&(Re=Re.props.children),typeof Re=="object"&&Re!==null){switch(Re.$$typeof){case me:e:{for(var rn=Re.key,Tn=Fe;Tn!==null;){if(Tn.key===rn){if(rn=Re.type,rn===he){if(Tn.tag===7){b(Ze,Tn.sibling),Fe=D(Tn,Re.props.children),Fe.return=Ze,Ze=Fe;break e}}else if(Tn.elementType===rn||typeof rn=="object"&&rn!==null&&rn.$$typeof===zt&&zy(rn)===Tn.type){b(Ze,Tn.sibling),Fe=D(Tn,Re.props),Fe.ref=yi(Ze,Tn,Re),Fe.return=Ze,Ze=Fe;break e}b(Ze,Tn);break}else g(Ze,Tn);Tn=Tn.sibling}Re.type===he?(Fe=eu(Re.props.children,Ze.mode,Bt,Re.key),Fe.return=Ze,Ze=Fe):(Bt=rf(Re.type,Re.key,Re.props,null,Ze.mode,Bt),Bt.ref=yi(Ze,Fe,Re),Bt.return=Ze,Ze=Bt)}return X(Ze);case de:e:{for(Tn=Re.key;Fe!==null;){if(Fe.key===Tn)if(Fe.tag===4&&Fe.stateNode.containerInfo===Re.containerInfo&&Fe.stateNode.implementation===Re.implementation){b(Ze,Fe.sibling),Fe=D(Fe,Re.children||[]),Fe.return=Ze,Ze=Fe;break e}else{b(Ze,Fe);break}else g(Ze,Fe);Fe=Fe.sibling}Fe=n_(Re,Ze.mode,Bt),Fe.return=Ze,Ze=Fe}return X(Ze);case zt:return Tn=Re._init,Ti(Ze,Fe,Tn(Re._payload),Bt)}if(We(Re))return on(Ze,Fe,Re,Bt);if(we(Re))return un(Ze,Fe,Re,Bt);Ip(Ze,Re)}return typeof Re=="string"&&Re!==""||typeof Re=="number"?(Re=""+Re,Fe!==null&&Fe.tag===6?(b(Ze,Fe.sibling),Fe=D(Fe,Re),Fe.return=Ze,Ze=Fe):(b(Ze,Fe),Fe=om(Re,Ze.mode,Bt),Fe.return=Ze,Ze=Fe),X(Ze)):b(Ze,Fe)}return Ti}var Zc=Gu(!0),Yv=Gu(!1),Nd={},fa=ss(Nd),jd=ss(Nd),Ud=ss(Nd);function nl(d){if(d===Nd)throw Error(a(174));return d}function Fy(d,g){switch(ei(Ud,g),ei(jd,d),ei(fa,Nd),d=g.nodeType,d){case 9:case 11:g=(g=g.documentElement)?g.namespaceURI:Wt(null,"");break;default:d=d===8?g.parentNode:g,g=d.namespaceURI||null,d=d.tagName,g=Wt(g,d)}ai(fa),ei(fa,g)}function Xc(){ai(fa),ai(jd),ai(Ud)}function Qv(d){nl(Ud.current);var g=nl(fa.current),b=Wt(g,d.type);g!==b&&(ei(jd,d),ei(fa,b))}function cs(d){jd.current===d&&(ai(fa),ai(jd))}var ti=ss(0);function kp(d){for(var g=d;g!==null;){if(g.tag===13){var b=g.memoizedState;if(b!==null&&(b=b.dehydrated,b===null||b.data==="$?"||b.data==="$!"))return g}else if(g.tag===19&&g.memoizedProps.revealOrder!==void 0){if(g.flags&128)return g}else if(g.child!==null){g.child.return=g,g=g.child;continue}if(g===d)break;for(;g.sibling===null;){if(g.return===null||g.return===d)return null;g=g.return}g.sibling.return=g.return,g=g.sibling}return null}var pa=[];function Is(){for(var d=0;d<pa.length;d++)pa[d]._workInProgressVersionPrimary=null;pa.length=0}var rl=W.ReactCurrentDispatcher,Kc=W.ReactCurrentBatchConfig,kt=0,hi=null,ji=null,_i=null,il=!1,Ft=!1,Hu=0,X2=0;function vo(){throw Error(a(321))}function Vd(d,g){if(g===null)return!1;for(var b=0;b<g.length&&b<d.length;b++)if(!mo(d[b],g[b]))return!1;return!0}function Pp(d,g,b,I,D,N){if(kt=N,hi=g,g.memoizedState=null,g.updateQueue=null,g.lanes=0,rl.current=d===null||d.memoizedState===null?ql:Vy,d=b(I,D),Ft){N=0;do{if(Ft=!1,Hu=0,25<=N)throw Error(a(301));N+=1,_i=ji=null,g.updateQueue=null,rl.current=Wl,d=b(I,D)}while(Ft)}if(rl.current=Xu,g=ji!==null&&ji.next!==null,kt=0,_i=ji=hi=null,il=!1,g)throw Error(a(300));return d}function Rp(){var d=Hu!==0;return Hu=0,d}function ma(){var d={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return _i===null?hi.memoizedState=_i=d:_i=_i.next=d,_i}function ks(){if(ji===null){var d=hi.alternate;d=d!==null?d.memoizedState:null}else d=ji.next;var g=_i===null?hi.memoizedState:_i.next;if(g!==null)_i=g,ji=d;else{if(d===null)throw Error(a(310));ji=d,d={memoizedState:ji.memoizedState,baseState:ji.baseState,baseQueue:ji.baseQueue,queue:ji.queue,next:null},_i===null?hi.memoizedState=_i=d:_i=_i.next=d}return _i}function qu(d,g){return typeof g=="function"?g(d):g}function $d(d){var g=ks(),b=g.queue;if(b===null)throw Error(a(311));b.lastRenderedReducer=d;var I=ji,D=I.baseQueue,N=b.pending;if(N!==null){if(D!==null){var X=D.next;D.next=N.next,N.next=X}I.baseQueue=D=N,b.pending=null}if(D!==null){N=D.next,I=I.baseState;var ve=X=null,Ce=null,Ye=N;do{var At=Ye.lane;if((kt&At)===At)Ce!==null&&(Ce=Ce.next={lane:0,action:Ye.action,hasEagerState:Ye.hasEagerState,eagerState:Ye.eagerState,next:null}),I=Ye.hasEagerState?Ye.eagerState:d(I,Ye.action);else{var Dt={lane:At,action:Ye.action,hasEagerState:Ye.hasEagerState,eagerState:Ye.eagerState,next:null};Ce===null?(ve=Ce=Dt,X=I):Ce=Ce.next=Dt,hi.lanes|=At,Kl|=At}Ye=Ye.next}while(Ye!==null&&Ye!==N);Ce===null?X=I:Ce.next=ve,mo(I,g.memoizedState)||(wo=!0),g.memoizedState=I,g.baseState=X,g.baseQueue=Ce,b.lastRenderedState=I}if(d=b.interleaved,d!==null){D=d;do N=D.lane,hi.lanes|=N,Kl|=N,D=D.next;while(D!==d)}else D===null&&(b.lanes=0);return[g.memoizedState,b.dispatch]}function Gd(d){var g=ks(),b=g.queue;if(b===null)throw Error(a(311));b.lastRenderedReducer=d;var I=b.dispatch,D=b.pending,N=g.memoizedState;if(D!==null){b.pending=null;var X=D=D.next;do N=d(N,X.action),X=X.next;while(X!==D);mo(N,g.memoizedState)||(wo=!0),g.memoizedState=N,g.baseQueue===null&&(g.baseState=N),b.lastRenderedState=N}return[N,I]}function Dp(){}function Fo(d,g){var b=hi,I=ks(),D=g(),N=!mo(I.memoizedState,D);if(N&&(I.memoizedState=D,wo=!0),I=I.queue,Fp(Lp.bind(null,b,I,d),[d]),I.getSnapshot!==g||N||_i!==null&&_i.memoizedState.tag&1){if(b.flags|=2048,xo(9,By.bind(null,b,I,D,g),void 0,null),no===null)throw Error(a(349));kt&30||ol(b,g,D)}return D}function ol(d,g,b){d.flags|=16384,d={getSnapshot:g,value:b},g=hi.updateQueue,g===null?(g={lastEffect:null,stores:null},hi.updateQueue=g,g.stores=[d]):(b=g.stores,b===null?g.stores=[d]:b.push(d))}function By(d,g,b,I){g.value=b,g.getSnapshot=I,Op(g)&&zp(d)}function Lp(d,g,b){return b(function(){Op(g)&&zp(d)})}function Op(d){var g=d.getSnapshot;d=d.value;try{var b=g();return!mo(d,b)}catch{return!0}}function zp(d){var g=Ms(d,1);g!==null&&Ps(g,d,1,-1)}function Ny(d){var g=ma();return typeof d=="function"&&(d=d()),g.memoizedState=g.baseState=d,d={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:qu,lastRenderedState:d},g.queue=d,d=d.dispatch=Ur.bind(null,hi,d),[g.memoizedState,d]}function xo(d,g,b,I){return d={tag:d,create:g,destroy:b,deps:I,next:null},g=hi.updateQueue,g===null?(g={lastEffect:null,stores:null},hi.updateQueue=g,g.lastEffect=d.next=d):(b=g.lastEffect,b===null?g.lastEffect=d.next=d:(I=b.next,b.next=d,d.next=I,g.lastEffect=d)),d}function Nr(){return ks().memoizedState}function Wu(d,g,b,I){var D=ma();hi.flags|=d,D.memoizedState=xo(1|g,b,void 0,I===void 0?null:I)}function Yc(d,g,b,I){var D=ks();I=I===void 0?null:I;var N=void 0;if(ji!==null){var X=ji.memoizedState;if(N=X.destroy,I!==null&&Vd(I,X.deps)){D.memoizedState=xo(g,b,N,I);return}}hi.flags|=d,D.memoizedState=xo(1|g,b,N,I)}function Qc(d,g){return Wu(8390656,8,d,g)}function Fp(d,g){return Yc(2048,8,d,g)}function jy(d,g){return Yc(4,2,d,g)}function Jv(d,g){return Yc(4,4,d,g)}function Zu(d,g){if(typeof g=="function")return d=d(),g(d),function(){g(null)};if(g!=null)return d=d(),g.current=d,function(){g.current=null}}function Hd(d,g,b){return b=b!=null?b.concat([d]):null,Yc(4,4,Zu.bind(null,g,d),b)}function gt(){}function qt(d,g){var b=ks();g=g===void 0?null:g;var I=b.memoizedState;return I!==null&&g!==null&&Vd(g,I[1])?I[0]:(b.memoizedState=[d,g],d)}function Jc(d,g){var b=ks();g=g===void 0?null:g;var I=b.memoizedState;return I!==null&&g!==null&&Vd(g,I[1])?I[0]:(d=d(),b.memoizedState=[d,g],d)}function jr(d,g,b){return kt&21?(mo(b,g)||(b=sa(),hi.lanes|=b,Kl|=b,d.baseState=!0),g):(d.baseState&&(d.baseState=!1,wo=!0),d.memoizedState=b)}function e1(d,g){var b=Lr;Lr=b!==0&&4>b?b:4,d(!0);var I=Kc.transition;Kc.transition={};try{d(!1),g()}finally{Lr=b,Kc.transition=I}}function t1(){return ks().memoizedState}function Bp(d,g,b){var I=cl(d);if(b={lane:I,action:b,hasEagerState:!1,eagerState:null,next:null},Kn(d))Uy(g,b);else if(b=ky(d,g,b,I),b!==null){var D=Co();Ps(b,d,I,D),Bo(b,g,I)}}function Ur(d,g,b){var I=cl(d),D={lane:I,action:b,hasEagerState:!1,eagerState:null,next:null};if(Kn(d))Uy(g,D);else{var N=d.alternate;if(d.lanes===0&&(N===null||N.lanes===0)&&(N=g.lastRenderedReducer,N!==null))try{var X=g.lastRenderedState,ve=N(X,b);if(D.hasEagerState=!0,D.eagerState=ve,mo(ve,X)){var Ce=g.interleaved;Ce===null?(D.next=D,Tp(g)):(D.next=Ce.next,Ce.next=D),g.interleaved=D;return}}catch{}finally{}b=ky(d,g,D,I),b!==null&&(D=Co(),Ps(b,d,I,D),Bo(b,g,I))}}function Kn(d){var g=d.alternate;return d===hi||g!==null&&g===hi}function Uy(d,g){Ft=il=!0;var b=d.pending;b===null?g.next=g:(g.next=b.next,b.next=g),d.pending=g}function Bo(d,g,b){if(b&4194240){var I=g.lanes;I&=d.pendingLanes,b|=I,g.lanes=b,Hf(d,b)}}var Xu={readContext:zo,useCallback:vo,useContext:vo,useEffect:vo,useImperativeHandle:vo,useInsertionEffect:vo,useLayoutEffect:vo,useMemo:vo,useReducer:vo,useRef:vo,useState:vo,useDebugValue:vo,useDeferredValue:vo,useTransition:vo,useMutableSource:vo,useSyncExternalStore:vo,useId:vo,unstable_isNewReconciler:!1},ql={readContext:zo,useCallback:function(d,g){return ma().memoizedState=[d,g===void 0?null:g],d},useContext:zo,useEffect:Qc,useImperativeHandle:function(d,g,b){return b=b!=null?b.concat([d]):null,Wu(4194308,4,Zu.bind(null,g,d),b)},useLayoutEffect:function(d,g){return Wu(4194308,4,d,g)},useInsertionEffect:function(d,g){return Wu(4,2,d,g)},useMemo:function(d,g){var b=ma();return g=g===void 0?null:g,d=d(),b.memoizedState=[d,g],d},useReducer:function(d,g,b){var I=ma();return g=b!==void 0?b(g):g,I.memoizedState=I.baseState=g,d={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:d,lastRenderedState:g},I.queue=d,d=d.dispatch=Bp.bind(null,hi,d),[I.memoizedState,d]},useRef:function(d){var g=ma();return d={current:d},g.memoizedState=d},useState:Ny,useDebugValue:gt,useDeferredValue:function(d){return ma().memoizedState=d},useTransition:function(){var d=Ny(!1),g=d[0];return d=e1.bind(null,d[1]),ma().memoizedState=d,[g,d]},useMutableSource:function(){},useSyncExternalStore:function(d,g,b){var I=hi,D=ma();if(Ar){if(b===void 0)throw Error(a(407));b=b()}else{if(b=g(),no===null)throw Error(a(349));kt&30||ol(I,g,b)}D.memoizedState=b;var N={value:b,getSnapshot:g};return D.queue=N,Qc(Lp.bind(null,I,N,d),[d]),I.flags|=2048,xo(9,By.bind(null,I,N,b,g),void 0,null),b},useId:function(){var d=ma(),g=no.identifierPrefix;if(Ar){var b=as,I=ca;b=(I&~(1<<32-qs(I)-1)).toString(32)+b,g=":"+g+"R"+b,b=Hu++,0<b&&(g+="H"+b.toString(32)),g+=":"}else b=X2++,g=":"+g+"r"+b.toString(32)+":";return d.memoizedState=g},unstable_isNewReconciler:!1},Vy={readContext:zo,useCallback:qt,useContext:zo,useEffect:Fp,useImperativeHandle:Hd,useInsertionEffect:jy,useLayoutEffect:Jv,useMemo:Jc,useReducer:$d,useRef:Nr,useState:function(){return $d(qu)},useDebugValue:gt,useDeferredValue:function(d){var g=ks();return jr(g,ji.memoizedState,d)},useTransition:function(){var d=$d(qu)[0],g=ks().memoizedState;return[d,g]},useMutableSource:Dp,useSyncExternalStore:Fo,useId:t1,unstable_isNewReconciler:!1},Wl={readContext:zo,useCallback:qt,useContext:zo,useEffect:Fp,useImperativeHandle:Hd,useInsertionEffect:jy,useLayoutEffect:Jv,useMemo:Jc,useReducer:Gd,useRef:Nr,useState:function(){return Gd(qu)},useDebugValue:gt,useDeferredValue:function(d){var g=ks();return ji===null?g.memoizedState=d:jr(g,ji.memoizedState,d)},useTransition:function(){var d=Gd(qu)[0],g=ks().memoizedState;return[d,g]},useMutableSource:Dp,useSyncExternalStore:Fo,useId:t1,unstable_isNewReconciler:!1};function hs(d,g){try{var b="",I=g;do b+=xt(I),I=I.return;while(I);var D=b}catch(N){D=`
Error generating stack: `+N.message+`
`+N.stack}return{value:d,source:g,stack:D,digest:null}}function eh(d,g,b){return{value:d,source:null,stack:b??null,digest:g??null}}function th(d,g){try{console.error(g.value)}catch(b){setTimeout(function(){throw b})}}var $y=typeof WeakMap=="function"?WeakMap:Map;function Np(d,g,b){b=da(-1,b),b.tag=3,b.payload={element:null};var I=g.value;return b.callback=function(){ef||(ef=!0,Mr=I),th(d,g)},b}function jp(d,g,b){b=da(-1,b),b.tag=3;var I=d.type.getDerivedStateFromError;if(typeof I=="function"){var D=g.value;b.payload=function(){return I(D)},b.callback=function(){th(d,g)}}var N=d.stateNode;return N!==null&&typeof N.componentDidCatch=="function"&&(b.callback=function(){th(d,g),typeof I!="function"&&(ba===null?ba=new Set([this]):ba.add(this));var X=g.stack;this.componentDidCatch(g.value,{componentStack:X!==null?X:""})}),b}function sl(d,g,b){var I=d.pingCache;if(I===null){I=d.pingCache=new $y;var D=new Set;I.set(g,D)}else D=I.get(g),D===void 0&&(D=new Set,I.set(g,D));D.has(b)||(D.add(b),d=p1.bind(null,d,g,b),g.then(d,d))}function Up(d){do{var g;if((g=d.tag===13)&&(g=d.memoizedState,g=g!==null?g.dehydrated!==null:!0),g)return d;d=d.return}while(d!==null);return null}function qd(d,g,b,I,D){return d.mode&1?(d.flags|=65536,d.lanes=D,d):(d===g?d.flags|=65536:(d.flags|=128,b.flags|=131072,b.flags&=-52805,b.tag===1&&(b.alternate===null?b.tag=17:(g=da(-1,1),g.tag=2,tl(b,g,1))),b.lanes|=1),d)}var Gy=W.ReactCurrentOwner,wo=!1;function Ei(d,g,b,I){g.child=d===null?Yv(g,null,b,I):Zc(g,d.child,b,I)}function di(d,g,b,I,D){b=b.render;var N=g.ref;return Vu(g,D),I=Pp(d,g,b,I,N,D),b=Rp(),d!==null&&!wo?(g.updateQueue=d.updateQueue,g.flags&=-2053,d.lanes&=~D,ga(d,g,D)):(Ar&&b&&bp(g),g.flags|=1,Ei(d,g,I,D),g.child)}function Vp(d,g,b,I,D){if(d===null){var N=b.type;return typeof N=="function"&&!im(N)&&N.defaultProps===void 0&&b.compare===null&&b.defaultProps===void 0?(g.tag=15,g.type=N,$p(d,g,N,I,D)):(d=rf(b.type,null,I,g,g.mode,D),d.ref=g.ref,d.return=g,g.child=d)}if(N=d.child,!(d.lanes&D)){var X=N.memoizedProps;if(b=b.compare,b=b!==null?b:ku,b(X,I)&&d.ref===g.ref)return ga(d,g,D)}return g.flags|=1,d=dl(N,I),d.ref=g.ref,d.return=g,g.child=d}function $p(d,g,b,I,D){if(d!==null){var N=d.memoizedProps;if(ku(N,I)&&d.ref===g.ref)if(wo=!1,g.pendingProps=I=N,(d.lanes&D)!==0)d.flags&131072&&(wo=!0);else return g.lanes=d.lanes,ga(d,g,D)}return Zd(d,g,b,I,D)}function Wd(d,g,b){var I=g.pendingProps,D=I.children,N=d!==null?d.memoizedState:null;if(I.mode==="hidden")if(!(g.mode&1))g.memoizedState={baseLanes:0,cachePool:null,transitions:null},ei(ni,li),li|=b;else{if(!(b&1073741824))return d=N!==null?N.baseLanes|b:b,g.lanes=g.childLanes=1073741824,g.memoizedState={baseLanes:d,cachePool:null,transitions:null},g.updateQueue=null,ei(ni,li),li|=d,null;g.memoizedState={baseLanes:0,cachePool:null,transitions:null},I=N!==null?N.baseLanes:b,ei(ni,li),li|=I}else N!==null?(I=N.baseLanes|b,g.memoizedState=null):I=b,ei(ni,li),li|=I;return Ei(d,g,D,b),g.child}function nh(d,g){var b=g.ref;(d===null&&b!==null||d!==null&&d.ref!==b)&&(g.flags|=512,g.flags|=2097152)}function Zd(d,g,b,I,D){var N=yo(b)?Ou:go.current;return N=Gl(g,N),Vu(g,D),b=Pp(d,g,b,I,N,D),I=Rp(),d!==null&&!wo?(g.updateQueue=d.updateQueue,g.flags&=-2053,d.lanes&=~D,ga(d,g,D)):(Ar&&I&&bp(g),g.flags|=1,Ei(d,g,b,D),g.child)}function Gp(d,g,b,I,D){if(yo(b)){var N=!0;Pd(g)}else N=!1;if(Vu(g,D),g.stateNode===null)Qd(d,g),Ly(g,b,I),Mp(g,b,I,D),I=!0;else if(d===null){var X=g.stateNode,ve=g.memoizedProps;X.props=ve;var Ce=X.context,Ye=b.contextType;typeof Ye=="object"&&Ye!==null?Ye=zo(Ye):(Ye=yo(b)?Ou:go.current,Ye=Gl(g,Ye));var At=b.getDerivedStateFromProps,Dt=typeof At=="function"||typeof X.getSnapshotBeforeUpdate=="function";Dt||typeof X.UNSAFE_componentWillReceiveProps!="function"&&typeof X.componentWillReceiveProps!="function"||(ve!==I||Ce!==Ye)&&Oy(g,X,I,Ye),ha=!1;var Tt=g.memoizedState;X.state=Tt,Fd(g,I,X,D),Ce=g.memoizedState,ve!==I||Tt!==Ce||qo.current||ha?(typeof At=="function"&&(Ap(g,b,At,I),Ce=g.memoizedState),(ve=ha||Dy(g,b,ve,I,Tt,Ce,Ye))?(Dt||typeof X.UNSAFE_componentWillMount!="function"&&typeof X.componentWillMount!="function"||(typeof X.componentWillMount=="function"&&X.componentWillMount(),typeof X.UNSAFE_componentWillMount=="function"&&X.UNSAFE_componentWillMount()),typeof X.componentDidMount=="function"&&(g.flags|=4194308)):(typeof X.componentDidMount=="function"&&(g.flags|=4194308),g.memoizedProps=I,g.memoizedState=Ce),X.props=I,X.state=Ce,X.context=Ye,I=ve):(typeof X.componentDidMount=="function"&&(g.flags|=4194308),I=!1)}else{X=g.stateNode,Py(d,g),ve=g.memoizedProps,Ye=g.type===g.elementType?ve:Xo(g.type,ve),X.props=Ye,Dt=g.pendingProps,Tt=X.context,Ce=b.contextType,typeof Ce=="object"&&Ce!==null?Ce=zo(Ce):(Ce=yo(b)?Ou:go.current,Ce=Gl(g,Ce));var Jt=b.getDerivedStateFromProps;(At=typeof Jt=="function"||typeof X.getSnapshotBeforeUpdate=="function")||typeof X.UNSAFE_componentWillReceiveProps!="function"&&typeof X.componentWillReceiveProps!="function"||(ve!==Dt||Tt!==Ce)&&Oy(g,X,I,Ce),ha=!1,Tt=g.memoizedState,X.state=Tt,Fd(g,I,X,D);var on=g.memoizedState;ve!==Dt||Tt!==on||qo.current||ha?(typeof Jt=="function"&&(Ap(g,b,Jt,I),on=g.memoizedState),(Ye=ha||Dy(g,b,Ye,I,Tt,on,Ce)||!1)?(At||typeof X.UNSAFE_componentWillUpdate!="function"&&typeof X.componentWillUpdate!="function"||(typeof X.componentWillUpdate=="function"&&X.componentWillUpdate(I,on,Ce),typeof X.UNSAFE_componentWillUpdate=="function"&&X.UNSAFE_componentWillUpdate(I,on,Ce)),typeof X.componentDidUpdate=="function"&&(g.flags|=4),typeof X.getSnapshotBeforeUpdate=="function"&&(g.flags|=1024)):(typeof X.componentDidUpdate!="function"||ve===d.memoizedProps&&Tt===d.memoizedState||(g.flags|=4),typeof X.getSnapshotBeforeUpdate!="function"||ve===d.memoizedProps&&Tt===d.memoizedState||(g.flags|=1024),g.memoizedProps=I,g.memoizedState=on),X.props=I,X.state=on,X.context=Ce,I=Ye):(typeof X.componentDidUpdate!="function"||ve===d.memoizedProps&&Tt===d.memoizedState||(g.flags|=4),typeof X.getSnapshotBeforeUpdate!="function"||ve===d.memoizedProps&&Tt===d.memoizedState||(g.flags|=1024),I=!1)}return Ku(d,g,b,I,N,D)}function Ku(d,g,b,I,D,N){nh(d,g);var X=(g.flags&128)!==0;if(!I&&!X)return D&&Ty(g,b,!1),ga(d,g,N);I=g.stateNode,Gy.current=g;var ve=X&&typeof b.getDerivedStateFromError!="function"?null:I.render();return g.flags|=1,d!==null&&X?(g.child=Zc(g,d.child,null,N),g.child=Zc(g,null,ve,N)):Ei(d,g,ve,N),g.memoizedState=I.state,D&&Ty(g,b,!0),g.child}function rh(d){var g=d.stateNode;g.pendingContext?Sy(d,g.pendingContext,g.pendingContext!==g.context):g.context&&Sy(d,g.context,!1),Fy(d,g.containerInfo)}function Hp(d,g,b,I,D){return Nu(),Ja(D),g.flags|=256,Ei(d,g,b,I),g.child}var ih={dehydrated:null,treeContext:null,retryLane:0};function Xd(d){return{baseLanes:d,cachePool:null,transitions:null}}function Hy(d,g,b){var I=g.pendingProps,D=ti.current,N=!1,X=(g.flags&128)!==0,ve;if((ve=X)||(ve=d!==null&&d.memoizedState===null?!1:(D&2)!==0),ve?(N=!0,g.flags&=-129):(d===null||d.memoizedState!==null)&&(D|=1),ei(ti,D&1),d===null)return qc(g),d=g.memoizedState,d!==null&&(d=d.dehydrated,d!==null)?(g.mode&1?d.data==="$!"?g.lanes=8:g.lanes=1073741824:g.lanes=1,null):(X=I.children,d=I.fallback,N?(I=g.mode,N=g.child,X={mode:"hidden",children:X},!(I&1)&&N!==null?(N.childLanes=0,N.pendingProps=X):N=of(X,I,0,null),d=eu(d,I,b,null),N.return=g,d.return=g,N.sibling=d,g.child=N,g.child.memoizedState=Xd(b),g.memoizedState=ih,d):Kd(g,X));if(D=d.memoizedState,D!==null&&(ve=D.dehydrated,ve!==null))return n1(d,g,X,I,ve,D,b);if(N){N=I.fallback,X=g.mode,D=d.child,ve=D.sibling;var Ce={mode:"hidden",children:I.children};return!(X&1)&&g.child!==D?(I=g.child,I.childLanes=0,I.pendingProps=Ce,g.deletions=null):(I=dl(D,Ce),I.subtreeFlags=D.subtreeFlags&14680064),ve!==null?N=dl(ve,N):(N=eu(N,X,b,null),N.flags|=2),N.return=g,I.return=g,I.sibling=N,g.child=I,I=N,N=g.child,X=d.child.memoizedState,X=X===null?Xd(b):{baseLanes:X.baseLanes|b,cachePool:null,transitions:X.transitions},N.memoizedState=X,N.childLanes=d.childLanes&~b,g.memoizedState=ih,I}return N=d.child,d=N.sibling,I=dl(N,{mode:"visible",children:I.children}),!(g.mode&1)&&(I.lanes=b),I.return=g,I.sibling=null,d!==null&&(b=g.deletions,b===null?(g.deletions=[d],g.flags|=16):b.push(d)),g.child=I,g.memoizedState=null,I}function Kd(d,g){return g=of({mode:"visible",children:g},d.mode,0,null),g.return=d,d.child=g}function Yd(d,g,b,I){return I!==null&&Ja(I),Zc(g,d.child,null,b),d=Kd(g,g.pendingProps.children),d.flags|=2,g.memoizedState=null,d}function n1(d,g,b,I,D,N,X){if(b)return g.flags&256?(g.flags&=-257,I=eh(Error(a(422))),Yd(d,g,X,I)):g.memoizedState!==null?(g.child=d.child,g.flags|=128,null):(N=I.fallback,D=g.mode,I=of({mode:"visible",children:I.children},D,0,null),N=eu(N,D,X,null),N.flags|=2,I.return=g,N.return=g,I.sibling=N,g.child=I,g.mode&1&&Zc(g,d.child,null,X),g.child.memoizedState=Xd(X),g.memoizedState=ih,N);if(!(g.mode&1))return Yd(d,g,X,null);if(D.data==="$!"){if(I=D.nextSibling&&D.nextSibling.dataset,I)var ve=I.dgst;return I=ve,N=Error(a(419)),I=eh(N,I,void 0),Yd(d,g,X,I)}if(ve=(X&d.childLanes)!==0,wo||ve){if(I=no,I!==null){switch(X&-X){case 4:D=2;break;case 16:D=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:D=32;break;case 536870912:D=268435456;break;default:D=0}D=D&(I.suspendedLanes|X)?0:D,D!==0&&D!==N.retryLane&&(N.retryLane=D,Ms(d,D),Ps(I,d,D,-1))}return nf(),I=eh(Error(a(421))),Yd(d,g,X,I)}return D.data==="$?"?(g.flags|=128,g.child=d.child,g=Y2.bind(null,d),D._reactRetry=g,null):(d=N.treeContext,_o=Xa(D.nextSibling),Oo=g,Ar=!0,ls=null,d!==null&&(Zo[Lo++]=ca,Zo[Lo++]=as,Zo[Lo++]=Fu,ca=d.id,as=d.overflow,Fu=g),g=Kd(g,I.children),g.flags|=4096,g)}function qy(d,g,b){d.lanes|=g;var I=d.alternate;I!==null&&(I.lanes|=g),Iy(d.return,g,b)}function qp(d,g,b,I,D){var N=d.memoizedState;N===null?d.memoizedState={isBackwards:g,rendering:null,renderingStartTime:0,last:I,tail:b,tailMode:D}:(N.isBackwards=g,N.rendering=null,N.renderingStartTime=0,N.last=I,N.tail=b,N.tailMode=D)}function Wy(d,g,b){var I=g.pendingProps,D=I.revealOrder,N=I.tail;if(Ei(d,g,I.children,b),I=ti.current,I&2)I=I&1|2,g.flags|=128;else{if(d!==null&&d.flags&128)e:for(d=g.child;d!==null;){if(d.tag===13)d.memoizedState!==null&&qy(d,b,g);else if(d.tag===19)qy(d,b,g);else if(d.child!==null){d.child.return=d,d=d.child;continue}if(d===g)break e;for(;d.sibling===null;){if(d.return===null||d.return===g)break e;d=d.return}d.sibling.return=d.return,d=d.sibling}I&=1}if(ei(ti,I),!(g.mode&1))g.memoizedState=null;else switch(D){case"forwards":for(b=g.child,D=null;b!==null;)d=b.alternate,d!==null&&kp(d)===null&&(D=b),b=b.sibling;b=D,b===null?(D=g.child,g.child=null):(D=b.sibling,b.sibling=null),qp(g,!1,D,b,N);break;case"backwards":for(b=null,D=g.child,g.child=null;D!==null;){if(d=D.alternate,d!==null&&kp(d)===null){g.child=D;break}d=D.sibling,D.sibling=b,b=D,D=d}qp(g,!0,b,null,N);break;case"together":qp(g,!1,null,null,void 0);break;default:g.memoizedState=null}return g.child}function Qd(d,g){!(g.mode&1)&&d!==null&&(d.alternate=null,g.alternate=null,g.flags|=2)}function ga(d,g,b){if(d!==null&&(g.dependencies=d.dependencies),Kl|=g.lanes,!(b&g.childLanes))return null;if(d!==null&&g.child!==d.child)throw Error(a(153));if(g.child!==null){for(d=g.child,b=dl(d,d.pendingProps),g.child=b,b.return=g;d.sibling!==null;)d=d.sibling,b=b.sibling=dl(d,d.pendingProps),b.return=g;b.sibling=null}return g.child}function r1(d,g,b){switch(g.tag){case 3:rh(g),Nu();break;case 5:Qv(g);break;case 1:yo(g.type)&&Pd(g);break;case 4:Fy(g,g.stateNode.containerInfo);break;case 10:var I=g.type._context,D=g.memoizedProps.value;ei(Wc,I._currentValue),I._currentValue=D;break;case 13:if(I=g.memoizedState,I!==null)return I.dehydrated!==null?(ei(ti,ti.current&1),g.flags|=128,null):b&g.child.childLanes?Hy(d,g,b):(ei(ti,ti.current&1),d=ga(d,g,b),d!==null?d.sibling:null);ei(ti,ti.current&1);break;case 19:if(I=(b&g.childLanes)!==0,d.flags&128){if(I)return Wy(d,g,b);g.flags|=128}if(D=g.memoizedState,D!==null&&(D.rendering=null,D.tail=null,D.lastEffect=null),ei(ti,ti.current),I)break;return null;case 22:case 23:return g.lanes=0,Wd(d,g,b)}return ga(d,g,b)}var Zy,Xy,i1,Jd;Zy=function(d,g){for(var b=g.child;b!==null;){if(b.tag===5||b.tag===6)d.appendChild(b.stateNode);else if(b.tag!==4&&b.child!==null){b.child.return=b,b=b.child;continue}if(b===g)break;for(;b.sibling===null;){if(b.return===null||b.return===g)return;b=b.return}b.sibling.return=b.return,b=b.sibling}},Xy=function(){},i1=function(d,g,b,I){var D=d.memoizedProps;if(D!==I){d=g.stateNode,nl(fa.current);var N=null;switch(b){case"input":D=Br(d,D),I=Br(d,I),N=[];break;case"select":D=Q({},D,{value:void 0}),I=Q({},I,{value:void 0}),N=[];break;case"textarea":D=bt(d,D),I=bt(d,I),N=[];break;default:typeof D.onClick!="function"&&typeof I.onClick=="function"&&(d.onclick=yp)}Ke(b,I);var X;b=null;for(Ye in D)if(!I.hasOwnProperty(Ye)&&D.hasOwnProperty(Ye)&&D[Ye]!=null)if(Ye==="style"){var ve=D[Ye];for(X in ve)ve.hasOwnProperty(X)&&(b||(b={}),b[X]="")}else Ye!=="dangerouslySetInnerHTML"&&Ye!=="children"&&Ye!=="suppressContentEditableWarning"&&Ye!=="suppressHydrationWarning"&&Ye!=="autoFocus"&&(p.hasOwnProperty(Ye)?N||(N=[]):(N=N||[]).push(Ye,null));for(Ye in I){var Ce=I[Ye];if(ve=D!=null?D[Ye]:void 0,I.hasOwnProperty(Ye)&&Ce!==ve&&(Ce!=null||ve!=null))if(Ye==="style")if(ve){for(X in ve)!ve.hasOwnProperty(X)||Ce&&Ce.hasOwnProperty(X)||(b||(b={}),b[X]="");for(X in Ce)Ce.hasOwnProperty(X)&&ve[X]!==Ce[X]&&(b||(b={}),b[X]=Ce[X])}else b||(N||(N=[]),N.push(Ye,b)),b=Ce;else Ye==="dangerouslySetInnerHTML"?(Ce=Ce?Ce.__html:void 0,ve=ve?ve.__html:void 0,Ce!=null&&ve!==Ce&&(N=N||[]).push(Ye,Ce)):Ye==="children"?typeof Ce!="string"&&typeof Ce!="number"||(N=N||[]).push(Ye,""+Ce):Ye!=="suppressContentEditableWarning"&&Ye!=="suppressHydrationWarning"&&(p.hasOwnProperty(Ye)?(Ce!=null&&Ye==="onScroll"&&Jr("scroll",d),N||ve===Ce||(N=[])):(N=N||[]).push(Ye,Ce))}b&&(N=N||[]).push("style",b);var Ye=N;(g.updateQueue=Ye)&&(g.flags|=4)}},Jd=function(d,g,b,I){b!==I&&(g.flags|=4)};function oh(d,g){if(!Ar)switch(d.tailMode){case"hidden":g=d.tail;for(var b=null;g!==null;)g.alternate!==null&&(b=g),g=g.sibling;b===null?d.tail=null:b.sibling=null;break;case"collapsed":b=d.tail;for(var I=null;b!==null;)b.alternate!==null&&(I=b),b=b.sibling;I===null?g||d.tail===null?d.tail=null:d.tail.sibling=null:I.sibling=null}}function bo(d){var g=d.alternate!==null&&d.alternate.child===d.child,b=0,I=0;if(g)for(var D=d.child;D!==null;)b|=D.lanes|D.childLanes,I|=D.subtreeFlags&14680064,I|=D.flags&14680064,D.return=d,D=D.sibling;else for(D=d.child;D!==null;)b|=D.lanes|D.childLanes,I|=D.subtreeFlags,I|=D.flags,D.return=d,D=D.sibling;return d.subtreeFlags|=I,d.childLanes=b,g}function o1(d,g,b){var I=g.pendingProps;switch(Cy(g),g.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return bo(g),null;case 1:return yo(g.type)&&Vc(),bo(g),null;case 3:return I=g.stateNode,Xc(),ai(qo),ai(go),Is(),I.pendingContext&&(I.context=I.pendingContext,I.pendingContext=null),(d===null||d.child===null)&&(Od(g)?g.flags|=4:d===null||d.memoizedState.isDehydrated&&!(g.flags&256)||(g.flags|=1024,ls!==null&&(em(ls),ls=null))),Xy(d,g),bo(g),null;case 5:cs(g);var D=nl(Ud.current);if(b=g.type,d!==null&&g.stateNode!=null)i1(d,g,b,I,D),d.ref!==g.ref&&(g.flags|=512,g.flags|=2097152);else{if(!I){if(g.stateNode===null)throw Error(a(166));return bo(g),null}if(d=nl(fa.current),Od(g)){I=g.stateNode,b=g.type;var N=g.memoizedProps;switch(I[Ts]=g,I[Id]=N,d=(g.mode&1)!==0,b){case"dialog":Jr("cancel",I),Jr("close",I);break;case"iframe":case"object":case"embed":Jr("load",I);break;case"video":case"audio":for(D=0;D<Pu.length;D++)Jr(Pu[D],I);break;case"source":Jr("error",I);break;case"img":case"image":case"link":Jr("error",I),Jr("load",I);break;case"details":Jr("toggle",I);break;case"input":bn(I,N),Jr("invalid",I);break;case"select":I._wrapperState={wasMultiple:!!N.multiple},Jr("invalid",I);break;case"textarea":St(I,N),Jr("invalid",I)}Ke(b,N),D=null;for(var X in N)if(N.hasOwnProperty(X)){var ve=N[X];X==="children"?typeof ve=="string"?I.textContent!==ve&&(N.suppressHydrationWarning!==!0&&Ad(I.textContent,ve,d),D=["children",ve]):typeof ve=="number"&&I.textContent!==""+ve&&(N.suppressHydrationWarning!==!0&&Ad(I.textContent,ve,d),D=["children",""+ve]):p.hasOwnProperty(X)&&ve!=null&&X==="onScroll"&&Jr("scroll",I)}switch(b){case"input":Ln(I),ue(I,N,!0);break;case"textarea":Ln(I),wt(I);break;case"select":case"option":break;default:typeof N.onClick=="function"&&(I.onclick=yp)}I=D,g.updateQueue=I,I!==null&&(g.flags|=4)}else{X=D.nodeType===9?D:D.ownerDocument,d==="http://www.w3.org/1999/xhtml"&&(d=Rt(b)),d==="http://www.w3.org/1999/xhtml"?b==="script"?(d=X.createElement("div"),d.innerHTML="<script><\/script>",d=d.removeChild(d.firstChild)):typeof I.is=="string"?d=X.createElement(b,{is:I.is}):(d=X.createElement(b),b==="select"&&(X=d,I.multiple?X.multiple=!0:I.size&&(X.size=I.size))):d=X.createElementNS(d,b),d[Ts]=g,d[Id]=I,Zy(d,g,!1,!1),g.stateNode=d;e:{switch(X=nt(b,I),b){case"dialog":Jr("cancel",d),Jr("close",d),D=I;break;case"iframe":case"object":case"embed":Jr("load",d),D=I;break;case"video":case"audio":for(D=0;D<Pu.length;D++)Jr(Pu[D],d);D=I;break;case"source":Jr("error",d),D=I;break;case"img":case"image":case"link":Jr("error",d),Jr("load",d),D=I;break;case"details":Jr("toggle",d),D=I;break;case"input":bn(d,I),D=Br(d,I),Jr("invalid",d);break;case"option":D=I;break;case"select":d._wrapperState={wasMultiple:!!I.multiple},D=Q({},I,{value:void 0}),Jr("invalid",d);break;case"textarea":St(d,I),D=bt(d,I),Jr("invalid",d);break;default:D=I}Ke(b,D),ve=D;for(N in ve)if(ve.hasOwnProperty(N)){var Ce=ve[N];N==="style"?Xe(d,Ce):N==="dangerouslySetInnerHTML"?(Ce=Ce?Ce.__html:void 0,Ce!=null&&Yn(d,Ce)):N==="children"?typeof Ce=="string"?(b!=="textarea"||Ce!=="")&&hr(d,Ce):typeof Ce=="number"&&hr(d,""+Ce):N!=="suppressContentEditableWarning"&&N!=="suppressHydrationWarning"&&N!=="autoFocus"&&(p.hasOwnProperty(N)?Ce!=null&&N==="onScroll"&&Jr("scroll",d):Ce!=null&&ee(d,N,Ce,X))}switch(b){case"input":Ln(d),ue(d,I,!1);break;case"textarea":Ln(d),wt(d);break;case"option":I.value!=null&&d.setAttribute("value",""+ot(I.value));break;case"select":d.multiple=!!I.multiple,N=I.value,N!=null?Je(d,!!I.multiple,N,!1):I.defaultValue!=null&&Je(d,!!I.multiple,I.defaultValue,!0);break;default:typeof D.onClick=="function"&&(d.onclick=yp)}switch(b){case"button":case"input":case"select":case"textarea":I=!!I.autoFocus;break e;case"img":I=!0;break e;default:I=!1}}I&&(g.flags|=4)}g.ref!==null&&(g.flags|=512,g.flags|=2097152)}return bo(g),null;case 6:if(d&&g.stateNode!=null)Jd(d,g,d.memoizedProps,I);else{if(typeof I!="string"&&g.stateNode===null)throw Error(a(166));if(b=nl(Ud.current),nl(fa.current),Od(g)){if(I=g.stateNode,b=g.memoizedProps,I[Ts]=g,(N=I.nodeValue!==b)&&(d=Oo,d!==null))switch(d.tag){case 3:Ad(I.nodeValue,b,(d.mode&1)!==0);break;case 5:d.memoizedProps.suppressHydrationWarning!==!0&&Ad(I.nodeValue,b,(d.mode&1)!==0)}N&&(g.flags|=4)}else I=(b.nodeType===9?b:b.ownerDocument).createTextNode(I),I[Ts]=g,g.stateNode=I}return bo(g),null;case 13:if(ai(ti),I=g.memoizedState,d===null||d.memoizedState!==null&&d.memoizedState.dehydrated!==null){if(Ar&&_o!==null&&g.mode&1&&!(g.flags&128))Ay(),Nu(),g.flags|=98560,N=!1;else if(N=Od(g),I!==null&&I.dehydrated!==null){if(d===null){if(!N)throw Error(a(318));if(N=g.memoizedState,N=N!==null?N.dehydrated:null,!N)throw Error(a(317));N[Ts]=g}else Nu(),!(g.flags&128)&&(g.memoizedState=null),g.flags|=4;bo(g),N=!1}else ls!==null&&(em(ls),ls=null),N=!0;if(!N)return g.flags&65536?g:null}return g.flags&128?(g.lanes=b,g):(I=I!==null,I!==(d!==null&&d.memoizedState!==null)&&I&&(g.child.flags|=8192,g.mode&1&&(d===null||ti.current&1?Jn===0&&(Jn=3):nf())),g.updateQueue!==null&&(g.flags|=4),bo(g),null);case 4:return Xc(),Xy(d,g),d===null&&ua(g.stateNode.containerInfo),bo(g),null;case 10:return My(g.type._context),bo(g),null;case 17:return yo(g.type)&&Vc(),bo(g),null;case 19:if(ai(ti),N=g.memoizedState,N===null)return bo(g),null;if(I=(g.flags&128)!==0,X=N.rendering,X===null)if(I)oh(N,!1);else{if(Jn!==0||d!==null&&d.flags&128)for(d=g.child;d!==null;){if(X=kp(d),X!==null){for(g.flags|=128,oh(N,!1),I=X.updateQueue,I!==null&&(g.updateQueue=I,g.flags|=4),g.subtreeFlags=0,I=b,b=g.child;b!==null;)N=b,d=I,N.flags&=14680066,X=N.alternate,X===null?(N.childLanes=0,N.lanes=d,N.child=null,N.subtreeFlags=0,N.memoizedProps=null,N.memoizedState=null,N.updateQueue=null,N.dependencies=null,N.stateNode=null):(N.childLanes=X.childLanes,N.lanes=X.lanes,N.child=X.child,N.subtreeFlags=0,N.deletions=null,N.memoizedProps=X.memoizedProps,N.memoizedState=X.memoizedState,N.updateQueue=X.updateQueue,N.type=X.type,d=X.dependencies,N.dependencies=d===null?null:{lanes:d.lanes,firstContext:d.firstContext}),b=b.sibling;return ei(ti,ti.current&1|2),g.child}d=d.sibling}N.tail!==null&&oi()>Qu&&(g.flags|=128,I=!0,oh(N,!1),g.lanes=4194304)}else{if(!I)if(d=kp(X),d!==null){if(g.flags|=128,I=!0,b=d.updateQueue,b!==null&&(g.updateQueue=b,g.flags|=4),oh(N,!0),N.tail===null&&N.tailMode==="hidden"&&!X.alternate&&!Ar)return bo(g),null}else 2*oi()-N.renderingStartTime>Qu&&b!==1073741824&&(g.flags|=128,I=!0,oh(N,!1),g.lanes=4194304);N.isBackwards?(X.sibling=g.child,g.child=X):(b=N.last,b!==null?b.sibling=X:g.child=X,N.last=X)}return N.tail!==null?(g=N.tail,N.rendering=g,N.tail=g.sibling,N.renderingStartTime=oi(),g.sibling=null,b=ti.current,ei(ti,I?b&1|2:b&1),g):(bo(g),null);case 22:case 23:return nm(),I=g.memoizedState!==null,d!==null&&d.memoizedState!==null!==I&&(g.flags|=8192),I&&g.mode&1?li&1073741824&&(bo(g),g.subtreeFlags&6&&(g.flags|=8192)):bo(g),null;case 24:return null;case 25:return null}throw Error(a(156,g.tag))}function s1(d,g){switch(Cy(g),g.tag){case 1:return yo(g.type)&&Vc(),d=g.flags,d&65536?(g.flags=d&-65537|128,g):null;case 3:return Xc(),ai(qo),ai(go),Is(),d=g.flags,d&65536&&!(d&128)?(g.flags=d&-65537|128,g):null;case 5:return cs(g),null;case 13:if(ai(ti),d=g.memoizedState,d!==null&&d.dehydrated!==null){if(g.alternate===null)throw Error(a(340));Nu()}return d=g.flags,d&65536?(g.flags=d&-65537|128,g):null;case 19:return ai(ti),null;case 4:return Xc(),null;case 10:return My(g.type._context),null;case 22:case 23:return nm(),null;case 24:return null;default:return null}}var Wp=!1,eo=!1,Zp=typeof WeakSet=="function"?WeakSet:Set,tn=null;function Zl(d,g){var b=d.ref;if(b!==null)if(typeof b=="function")try{b(null)}catch(I){vi(d,g,I)}else b.current=null}function sh(d,g,b){try{b()}catch(I){vi(d,g,I)}}var ya=!1;function Sn(d,g){if(Ru=Ua,d=sp(),hy(d)){if("selectionStart"in d)var b={start:d.selectionStart,end:d.selectionEnd};else e:{b=(b=d.ownerDocument)&&b.defaultView||window;var I=b.getSelection&&b.getSelection();if(I&&I.rangeCount!==0){b=I.anchorNode;var D=I.anchorOffset,N=I.focusNode;I=I.focusOffset;try{b.nodeType,N.nodeType}catch{b=null;break e}var X=0,ve=-1,Ce=-1,Ye=0,At=0,Dt=d,Tt=null;t:for(;;){for(var Jt;Dt!==b||D!==0&&Dt.nodeType!==3||(ve=X+D),Dt!==N||I!==0&&Dt.nodeType!==3||(Ce=X+I),Dt.nodeType===3&&(X+=Dt.nodeValue.length),(Jt=Dt.firstChild)!==null;)Tt=Dt,Dt=Jt;for(;;){if(Dt===d)break t;if(Tt===b&&++Ye===D&&(ve=X),Tt===N&&++At===I&&(Ce=X),(Jt=Dt.nextSibling)!==null)break;Dt=Tt,Tt=Dt.parentNode}Dt=Jt}b=ve===-1||Ce===-1?null:{start:ve,end:Ce}}else b=null}b=b||{start:0,end:0}}else b=null;for(Du={focusedElem:d,selectionRange:b},Ua=!1,tn=g;tn!==null;)if(g=tn,d=g.child,(g.subtreeFlags&1028)!==0&&d!==null)d.return=g,tn=d;else for(;tn!==null;){g=tn;try{var on=g.alternate;if(g.flags&1024)switch(g.tag){case 0:case 11:case 15:break;case 1:if(on!==null){var un=on.memoizedProps,Ti=on.memoizedState,Ze=g.stateNode,Fe=Ze.getSnapshotBeforeUpdate(g.elementType===g.type?un:Xo(g.type,un),Ti);Ze.__reactInternalSnapshotBeforeUpdate=Fe}break;case 3:var Re=g.stateNode.containerInfo;Re.nodeType===1?Re.textContent="":Re.nodeType===9&&Re.documentElement&&Re.removeChild(Re.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(a(163))}}catch(Bt){vi(g,g.return,Bt)}if(d=g.sibling,d!==null){d.return=g.return,tn=d;break}tn=g.return}return on=ya,ya=!1,on}function pt(d,g,b){var I=g.updateQueue;if(I=I!==null?I.lastEffect:null,I!==null){var D=I=I.next;do{if((D.tag&d)===d){var N=D.destroy;D.destroy=void 0,N!==void 0&&sh(g,b,N)}D=D.next}while(D!==I)}}function En(d,g){if(g=g.updateQueue,g=g!==null?g.lastEffect:null,g!==null){var b=g=g.next;do{if((b.tag&d)===d){var I=b.create;b.destroy=I()}b=b.next}while(b!==g)}}function fn(d){var g=d.ref;if(g!==null){var b=d.stateNode;switch(d.tag){case 5:d=b;break;default:d=b}typeof g=="function"?g(d):g.current=d}}function Ko(d){var g=d.alternate;g!==null&&(d.alternate=null,Ko(g)),d.child=null,d.deletions=null,d.sibling=null,d.tag===5&&(g=d.stateNode,g!==null&&(delete g[Ts],delete g[Id],delete g[wy],delete g[by],delete g[Z2])),d.stateNode=null,d.return=null,d.dependencies=null,d.memoizedProps=null,d.memoizedState=null,d.pendingProps=null,d.stateNode=null,d.updateQueue=null}function Yu(d){return d.tag===5||d.tag===3||d.tag===4}function a1(d){e:for(;;){for(;d.sibling===null;){if(d.return===null||Yu(d.return))return null;d=d.return}for(d.sibling.return=d.return,d=d.sibling;d.tag!==5&&d.tag!==6&&d.tag!==18;){if(d.flags&2||d.child===null||d.tag===4)continue e;d.child.return=d,d=d.child}if(!(d.flags&2))return d.stateNode}}function gn(d,g,b){var I=d.tag;if(I===5||I===6)d=d.stateNode,g?b.nodeType===8?b.parentNode.insertBefore(d,g):b.insertBefore(d,g):(b.nodeType===8?(g=b.parentNode,g.insertBefore(d,b)):(g=b,g.appendChild(d)),b=b._reactRootContainer,b!=null||g.onclick!==null||(g.onclick=yp));else if(I!==4&&(d=d.child,d!==null))for(gn(d,g,b),d=d.sibling;d!==null;)gn(d,g,b),d=d.sibling}function Ky(d,g,b){var I=d.tag;if(I===5||I===6)d=d.stateNode,g?b.insertBefore(d,g):b.appendChild(d);else if(I!==4&&(d=d.child,d!==null))for(Ky(d,g,b),d=d.sibling;d!==null;)Ky(d,g,b),d=d.sibling}var to=null,Ks=!1;function _a(d,g,b){for(b=b.child;b!==null;)Xp(d,g,b),b=b.sibling}function Xp(d,g,b){if(Hs&&typeof Hs.onCommitFiberUnmount=="function")try{Hs.onCommitFiberUnmount(vu,b)}catch{}switch(b.tag){case 5:eo||Zl(b,g);case 6:var I=to,D=Ks;to=null,_a(d,g,b),to=I,Ks=D,to!==null&&(Ks?(d=to,b=b.stateNode,d.nodeType===8?d.parentNode.removeChild(b):d.removeChild(b)):to.removeChild(b.stateNode));break;case 18:to!==null&&(Ks?(d=to,b=b.stateNode,d.nodeType===8?Md(d.parentNode,b):d.nodeType===1&&Md(d,b),Gn(d)):Md(to,b.stateNode));break;case 4:I=to,D=Ks,to=b.stateNode.containerInfo,Ks=!0,_a(d,g,b),to=I,Ks=D;break;case 0:case 11:case 14:case 15:if(!eo&&(I=b.updateQueue,I!==null&&(I=I.lastEffect,I!==null))){D=I=I.next;do{var N=D,X=N.destroy;N=N.tag,X!==void 0&&(N&2||N&4)&&sh(b,g,X),D=D.next}while(D!==I)}_a(d,g,b);break;case 1:if(!eo&&(Zl(b,g),I=b.stateNode,typeof I.componentWillUnmount=="function"))try{I.props=b.memoizedProps,I.state=b.memoizedState,I.componentWillUnmount()}catch(ve){vi(b,g,ve)}_a(d,g,b);break;case 21:_a(d,g,b);break;case 22:b.mode&1?(eo=(I=eo)||b.memoizedState!==null,_a(d,g,b),eo=I):_a(d,g,b);break;default:_a(d,g,b)}}function ah(d){var g=d.updateQueue;if(g!==null){d.updateQueue=null;var b=d.stateNode;b===null&&(b=d.stateNode=new Zp),g.forEach(function(I){var D=kn.bind(null,d,I);b.has(I)||(b.add(I),I.then(D,D))})}}function So(d,g){var b=g.deletions;if(b!==null)for(var I=0;I<b.length;I++){var D=b[I];try{var N=d,X=g,ve=X;e:for(;ve!==null;){switch(ve.tag){case 5:to=ve.stateNode,Ks=!1;break e;case 3:to=ve.stateNode.containerInfo,Ks=!0;break e;case 4:to=ve.stateNode.containerInfo,Ks=!0;break e}ve=ve.return}if(to===null)throw Error(a(160));Xp(N,X,D),to=null,Ks=!1;var Ce=D.alternate;Ce!==null&&(Ce.return=null),D.return=null}catch(Ye){vi(D,g,Ye)}}if(g.subtreeFlags&12854)for(g=g.child;g!==null;)va(g,d),g=g.sibling}function va(d,g){var b=d.alternate,I=d.flags;switch(d.tag){case 0:case 11:case 14:case 15:if(So(g,d),Ui(d),I&4){try{pt(3,d,d.return),En(3,d)}catch(un){vi(d,d.return,un)}try{pt(5,d,d.return)}catch(un){vi(d,d.return,un)}}break;case 1:So(g,d),Ui(d),I&512&&b!==null&&Zl(b,b.return);break;case 5:if(So(g,d),Ui(d),I&512&&b!==null&&Zl(b,b.return),d.flags&32){var D=d.stateNode;try{hr(D,"")}catch(un){vi(d,d.return,un)}}if(I&4&&(D=d.stateNode,D!=null)){var N=d.memoizedProps,X=b!==null?b.memoizedProps:N,ve=d.type,Ce=d.updateQueue;if(d.updateQueue=null,Ce!==null)try{ve==="input"&&N.type==="radio"&&N.name!=null&&et(D,N),nt(ve,X);var Ye=nt(ve,N);for(X=0;X<Ce.length;X+=2){var At=Ce[X],Dt=Ce[X+1];At==="style"?Xe(D,Dt):At==="dangerouslySetInnerHTML"?Yn(D,Dt):At==="children"?hr(D,Dt):ee(D,At,Dt,Ye)}switch(ve){case"input":te(D,N);break;case"textarea":Ne(D,N);break;case"select":var Tt=D._wrapperState.wasMultiple;D._wrapperState.wasMultiple=!!N.multiple;var Jt=N.value;Jt!=null?Je(D,!!N.multiple,Jt,!1):Tt!==!!N.multiple&&(N.defaultValue!=null?Je(D,!!N.multiple,N.defaultValue,!0):Je(D,!!N.multiple,N.multiple?[]:"",!1))}D[Id]=N}catch(un){vi(d,d.return,un)}}break;case 6:if(So(g,d),Ui(d),I&4){if(d.stateNode===null)throw Error(a(162));D=d.stateNode,N=d.memoizedProps;try{D.nodeValue=N}catch(un){vi(d,d.return,un)}}break;case 3:if(So(g,d),Ui(d),I&4&&b!==null&&b.memoizedState.isDehydrated)try{Gn(g.containerInfo)}catch(un){vi(d,d.return,un)}break;case 4:So(g,d),Ui(d);break;case 13:So(g,d),Ui(d),D=d.child,D.flags&8192&&(N=D.memoizedState!==null,D.stateNode.isHidden=N,!N||D.alternate!==null&&D.alternate.memoizedState!==null||(xa=oi())),I&4&&ah(d);break;case 22:if(At=b!==null&&b.memoizedState!==null,d.mode&1?(eo=(Ye=eo)||At,So(g,d),eo=Ye):So(g,d),Ui(d),I&8192){if(Ye=d.memoizedState!==null,(d.stateNode.isHidden=Ye)&&!At&&d.mode&1)for(tn=d,At=d.child;At!==null;){for(Dt=tn=At;tn!==null;){switch(Tt=tn,Jt=Tt.child,Tt.tag){case 0:case 11:case 14:case 15:pt(4,Tt,Tt.return);break;case 1:Zl(Tt,Tt.return);var on=Tt.stateNode;if(typeof on.componentWillUnmount=="function"){I=Tt,b=Tt.return;try{g=I,on.props=g.memoizedProps,on.state=g.memoizedState,on.componentWillUnmount()}catch(un){vi(I,b,un)}}break;case 5:Zl(Tt,Tt.return);break;case 22:if(Tt.memoizedState!==null){l1(Dt);continue}}Jt!==null?(Jt.return=Tt,tn=Jt):l1(Dt)}At=At.sibling}e:for(At=null,Dt=d;;){if(Dt.tag===5){if(At===null){At=Dt;try{D=Dt.stateNode,Ye?(N=D.style,typeof N.setProperty=="function"?N.setProperty("display","none","important"):N.display="none"):(ve=Dt.stateNode,Ce=Dt.memoizedProps.style,X=Ce!=null&&Ce.hasOwnProperty("display")?Ce.display:null,ve.style.display=dr("display",X))}catch(un){vi(d,d.return,un)}}}else if(Dt.tag===6){if(At===null)try{Dt.stateNode.nodeValue=Ye?"":Dt.memoizedProps}catch(un){vi(d,d.return,un)}}else if((Dt.tag!==22&&Dt.tag!==23||Dt.memoizedState===null||Dt===d)&&Dt.child!==null){Dt.child.return=Dt,Dt=Dt.child;continue}if(Dt===d)break e;for(;Dt.sibling===null;){if(Dt.return===null||Dt.return===d)break e;At===Dt&&(At=null),Dt=Dt.return}At===Dt&&(At=null),Dt.sibling.return=Dt.return,Dt=Dt.sibling}}break;case 19:So(g,d),Ui(d),I&4&&ah(d);break;case 21:break;default:So(g,d),Ui(d)}}function Ui(d){var g=d.flags;if(g&2){try{e:{for(var b=d.return;b!==null;){if(Yu(b)){var I=b;break e}b=b.return}throw Error(a(160))}switch(I.tag){case 5:var D=I.stateNode;I.flags&32&&(hr(D,""),I.flags&=-33);var N=a1(d);Ky(d,N,D);break;case 3:case 4:var X=I.stateNode.containerInfo,ve=a1(d);gn(d,ve,X);break;default:throw Error(a(161))}}catch(Ce){vi(d,d.return,Ce)}d.flags&=-3}g&4096&&(d.flags&=-4097)}function Xl(d,g,b){tn=d,al(d)}function al(d,g,b){for(var I=(d.mode&1)!==0;tn!==null;){var D=tn,N=D.child;if(D.tag===22&&I){var X=D.memoizedState!==null||Wp;if(!X){var ve=D.alternate,Ce=ve!==null&&ve.memoizedState!==null||eo;ve=Wp;var Ye=eo;if(Wp=X,(eo=Ce)&&!Ye)for(tn=D;tn!==null;)X=tn,Ce=X.child,X.tag===22&&X.memoizedState!==null?u1(D):Ce!==null?(Ce.return=X,tn=Ce):u1(D);for(;N!==null;)tn=N,al(N),N=N.sibling;tn=D,Wp=ve,eo=Ye}ll(d)}else D.subtreeFlags&8772&&N!==null?(N.return=D,tn=N):ll(d)}}function ll(d){for(;tn!==null;){var g=tn;if(g.flags&8772){var b=g.alternate;try{if(g.flags&8772)switch(g.tag){case 0:case 11:case 15:eo||En(5,g);break;case 1:var I=g.stateNode;if(g.flags&4&&!eo)if(b===null)I.componentDidMount();else{var D=g.elementType===g.type?b.memoizedProps:Xo(g.type,b.memoizedProps);I.componentDidUpdate(D,b.memoizedState,I.__reactInternalSnapshotBeforeUpdate)}var N=g.updateQueue;N!==null&&Ry(g,N,I);break;case 3:var X=g.updateQueue;if(X!==null){if(b=null,g.child!==null)switch(g.child.tag){case 5:b=g.child.stateNode;break;case 1:b=g.child.stateNode}Ry(g,X,b)}break;case 5:var ve=g.stateNode;if(b===null&&g.flags&4){b=ve;var Ce=g.memoizedProps;switch(g.type){case"button":case"input":case"select":case"textarea":Ce.autoFocus&&b.focus();break;case"img":Ce.src&&(b.src=Ce.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(g.memoizedState===null){var Ye=g.alternate;if(Ye!==null){var At=Ye.memoizedState;if(At!==null){var Dt=At.dehydrated;Dt!==null&&Gn(Dt)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(a(163))}eo||g.flags&512&&fn(g)}catch(Tt){vi(g,g.return,Tt)}}if(g===d){tn=null;break}if(b=g.sibling,b!==null){b.return=g.return,tn=b;break}tn=g.return}}function l1(d){for(;tn!==null;){var g=tn;if(g===d){tn=null;break}var b=g.sibling;if(b!==null){b.return=g.return,tn=b;break}tn=g.return}}function u1(d){for(;tn!==null;){var g=tn;try{switch(g.tag){case 0:case 11:case 15:var b=g.return;try{En(4,g)}catch(Ce){vi(g,b,Ce)}break;case 1:var I=g.stateNode;if(typeof I.componentDidMount=="function"){var D=g.return;try{I.componentDidMount()}catch(Ce){vi(g,D,Ce)}}var N=g.return;try{fn(g)}catch(Ce){vi(g,N,Ce)}break;case 5:var X=g.return;try{fn(g)}catch(Ce){vi(g,X,Ce)}}}catch(Ce){vi(g,g.return,Ce)}if(g===d){tn=null;break}var ve=g.sibling;if(ve!==null){ve.return=g.return,tn=ve;break}tn=g.return}}var K2=Math.ceil,Kp=W.ReactCurrentDispatcher,Yp=W.ReactCurrentOwner,ds=W.ReactCurrentBatchConfig,Hn=0,no=null,Vi=null,In=0,li=0,ni=ss(0),Jn=0,lh=null,Kl=0,Qp=0,Yy=0,vr=null,Eo=null,xa=0,Qu=1/0,wa=null,ef=!1,Mr=null,ba=null,fs=!1,ul=null,tf=0,uh=0,er=null,ch=-1,To=0;function Co(){return Hn&6?oi():ch!==-1?ch:ch=oi()}function cl(d){return d.mode&1?Hn&2&&In!==0?In&-In:Xv.transition!==null?(To===0&&(To=sa()),To):(d=Lr,d!==0||(d=window.event,d=d===void 0?16:si(d.type)),d):1}function Ps(d,g,b,I){if(50<uh)throw uh=0,er=null,Error(a(185));ja(d,b,I),(!(Hn&2)||d!==no)&&(d===no&&(!(Hn&2)&&(Qp|=b),Jn===4&&hl(d,In)),Qt(d,I),b===1&&Hn===0&&!(g.mode&1)&&(Qu=oi()+500,Rd&&Wo()))}function Qt(d,g){var b=d.callbackNode;mn(d,g);var I=bu(d,d===no?In:0);if(I===0)b!==null&&Ll(b),d.callbackNode=null,d.callbackPriority=0;else if(g=I&-I,d.callbackPriority!==g){if(b!=null&&Ll(b),g===1)d.tag===0?Wv(Qy.bind(null,d)):$c(Qy.bind(null,d)),xy(function(){!(Hn&6)&&Wo()}),b=null;else{switch(qf(I)){case 1:b=Ol;break;case 4:b=Ec;break;case 16:b=$f;break;case 536870912:b=Xg;break;default:b=$f}b=ps(b,Jp.bind(null,d))}d.callbackPriority=g,d.callbackNode=b}}function Jp(d,g){if(ch=-1,To=0,Hn&6)throw Error(a(327));var b=d.callbackNode;if(Ju()&&d.callbackNode!==b)return null;var I=bu(d,d===no?In:0);if(I===0)return null;if(I&30||I&d.expiredLanes||g)g=Rs(d,I);else{g=I;var D=Hn;Hn|=2;var N=yn();(no!==d||In!==g)&&(wa=null,Qu=oi()+500,Ql(d,g));do try{d1();break}catch(ve){hn(d,ve)}while(1);Hl(),Kp.current=N,Hn=D,Vi!==null?g=0:(no=null,In=0,g=Jn)}if(g!==0){if(g===2&&(D=lr(d),D!==0&&(I=D,g=Vr(d,D))),g===1)throw b=lh,Ql(d,0),hl(d,I),Qt(d,oi()),b;if(g===6)hl(d,I);else{if(D=d.current.alternate,!(I&30)&&!c1(D)&&(g=Rs(d,I),g===2&&(N=lr(d),N!==0&&(I=N,g=Vr(d,N))),g===1))throw b=lh,Ql(d,0),hl(d,I),Qt(d,oi()),b;switch(d.finishedWork=D,d.finishedLanes=I,g){case 0:case 1:throw Error(a(345));case 2:Jl(d,Eo,wa);break;case 3:if(hl(d,I),(I&130023424)===I&&(g=xa+500-oi(),10<g)){if(bu(d,0)!==0)break;if(D=d.suspendedLanes,(D&I)!==I){Co(),d.pingedLanes|=d.suspendedLanes&D;break}d.timeoutHandle=jc(Jl.bind(null,d,Eo,wa),g);break}Jl(d,Eo,wa);break;case 4:if(hl(d,I),(I&4194240)===I)break;for(g=d.eventTimes,D=-1;0<I;){var X=31-qs(I);N=1<<X,X=g[X],X>D&&(D=X),I&=~N}if(I=D,I=oi()-I,I=(120>I?120:480>I?480:1080>I?1080:1920>I?1920:3e3>I?3e3:4320>I?4320:1960*K2(I/1960))-I,10<I){d.timeoutHandle=jc(Jl.bind(null,d,Eo,wa),I);break}Jl(d,Eo,wa);break;case 5:Jl(d,Eo,wa);break;default:throw Error(a(329))}}}return Qt(d,oi()),d.callbackNode===b?Jp.bind(null,d):null}function Vr(d,g){var b=vr;return d.current.memoizedState.isDehydrated&&(Ql(d,g).flags|=256),d=Rs(d,g),d!==2&&(g=Eo,Eo=b,g!==null&&em(g)),d}function em(d){Eo===null?Eo=d:Eo.push.apply(Eo,d)}function c1(d){for(var g=d;;){if(g.flags&16384){var b=g.updateQueue;if(b!==null&&(b=b.stores,b!==null))for(var I=0;I<b.length;I++){var D=b[I],N=D.getSnapshot;D=D.value;try{if(!mo(N(),D))return!1}catch{return!1}}}if(b=g.child,g.subtreeFlags&16384&&b!==null)b.return=g,g=b;else{if(g===d)break;for(;g.sibling===null;){if(g.return===null||g.return===d)return!0;g=g.return}g.sibling.return=g.return,g=g.sibling}}return!0}function hl(d,g){for(g&=~Yy,g&=~Qp,d.suspendedLanes|=g,d.pingedLanes&=~g,d=d.expirationTimes;0<g;){var b=31-qs(g),I=1<<b;d[b]=-1,g&=~I}}function Qy(d){if(Hn&6)throw Error(a(327));Ju();var g=bu(d,0);if(!(g&1))return Qt(d,oi()),null;var b=Rs(d,g);if(d.tag!==0&&b===2){var I=lr(d);I!==0&&(g=I,b=Vr(d,I))}if(b===1)throw b=lh,Ql(d,0),hl(d,g),Qt(d,oi()),b;if(b===6)throw Error(a(345));return d.finishedWork=d.current.alternate,d.finishedLanes=g,Jl(d,Eo,wa),Qt(d,oi()),null}function tm(d,g){var b=Hn;Hn|=1;try{return d(g)}finally{Hn=b,Hn===0&&(Qu=oi()+500,Rd&&Wo())}}function Yl(d){ul!==null&&ul.tag===0&&!(Hn&6)&&Ju();var g=Hn;Hn|=1;var b=ds.transition,I=Lr;try{if(ds.transition=null,Lr=1,d)return d()}finally{Lr=I,ds.transition=b,Hn=g,!(Hn&6)&&Wo()}}function nm(){li=ni.current,ai(ni)}function Ql(d,g){d.finishedWork=null,d.finishedLanes=0;var b=d.timeoutHandle;if(b!==-1&&(d.timeoutHandle=-1,vy(b)),Vi!==null)for(b=Vi.return;b!==null;){var I=b;switch(Cy(I),I.tag){case 1:I=I.type.childContextTypes,I!=null&&Vc();break;case 3:Xc(),ai(qo),ai(go),Is();break;case 5:cs(I);break;case 4:Xc();break;case 13:ai(ti);break;case 19:ai(ti);break;case 10:My(I.type._context);break;case 22:case 23:nm()}b=b.return}if(no=d,Vi=d=dl(d.current,null),In=li=g,Jn=0,lh=null,Yy=Qp=Kl=0,Eo=vr=null,el!==null){for(g=0;g<el.length;g++)if(b=el[g],I=b.interleaved,I!==null){b.interleaved=null;var D=I.next,N=b.pending;if(N!==null){var X=N.next;N.next=D,I.next=X}b.pending=I}el=null}return d}function hn(d,g){do{var b=Vi;try{if(Hl(),rl.current=Xu,il){for(var I=hi.memoizedState;I!==null;){var D=I.queue;D!==null&&(D.pending=null),I=I.next}il=!1}if(kt=0,_i=ji=hi=null,Ft=!1,Hu=0,Yp.current=null,b===null||b.return===null){Jn=1,lh=g,Vi=null;break}e:{var N=d,X=b.return,ve=b,Ce=g;if(g=In,ve.flags|=32768,Ce!==null&&typeof Ce=="object"&&typeof Ce.then=="function"){var Ye=Ce,At=ve,Dt=At.tag;if(!(At.mode&1)&&(Dt===0||Dt===11||Dt===15)){var Tt=At.alternate;Tt?(At.updateQueue=Tt.updateQueue,At.memoizedState=Tt.memoizedState,At.lanes=Tt.lanes):(At.updateQueue=null,At.memoizedState=null)}var Jt=Up(X);if(Jt!==null){Jt.flags&=-257,qd(Jt,X,ve,N,g),Jt.mode&1&&sl(N,Ye,g),g=Jt,Ce=Ye;var on=g.updateQueue;if(on===null){var un=new Set;un.add(Ce),g.updateQueue=un}else on.add(Ce);break e}else{if(!(g&1)){sl(N,Ye,g),nf();break e}Ce=Error(a(426))}}else if(Ar&&ve.mode&1){var Ti=Up(X);if(Ti!==null){!(Ti.flags&65536)&&(Ti.flags|=256),qd(Ti,X,ve,N,g),Ja(hs(Ce,ve));break e}}N=Ce=hs(Ce,ve),Jn!==4&&(Jn=2),vr===null?vr=[N]:vr.push(N),N=X;do{switch(N.tag){case 3:N.flags|=65536,g&=-g,N.lanes|=g;var Ze=Np(N,Ce,g);$u(N,Ze);break e;case 1:ve=Ce;var Fe=N.type,Re=N.stateNode;if(!(N.flags&128)&&(typeof Fe.getDerivedStateFromError=="function"||Re!==null&&typeof Re.componentDidCatch=="function"&&(ba===null||!ba.has(Re)))){N.flags|=65536,g&=-g,N.lanes|=g;var Bt=jp(N,ve,g);$u(N,Bt);break e}}N=N.return}while(N!==null)}e_(b)}catch(rn){g=rn,Vi===b&&b!==null&&(Vi=b=b.return);continue}break}while(1)}function yn(){var d=Kp.current;return Kp.current=Xu,d===null?Xu:d}function nf(){(Jn===0||Jn===3||Jn===2)&&(Jn=4),no===null||!(Kl&268435455)&&!(Qp&268435455)||hl(no,In)}function Rs(d,g){var b=Hn;Hn|=2;var I=yn();(no!==d||In!==g)&&(wa=null,Ql(d,g));do try{h1();break}catch(D){hn(d,D)}while(1);if(Hl(),Hn=b,Kp.current=I,Vi!==null)throw Error(a(261));return no=null,In=0,Jn}function h1(){for(;Vi!==null;)Jy(Vi)}function d1(){for(;Vi!==null&&!Sc();)Jy(Vi)}function Jy(d){var g=rm(d.alternate,d,li);d.memoizedProps=d.pendingProps,g===null?e_(d):Vi=g,Yp.current=null}function e_(d){var g=d;do{var b=g.alternate;if(d=g.return,g.flags&32768){if(b=s1(b,g),b!==null){b.flags&=32767,Vi=b;return}if(d!==null)d.flags|=32768,d.subtreeFlags=0,d.deletions=null;else{Jn=6,Vi=null;return}}else if(b=o1(b,g,li),b!==null){Vi=b;return}if(g=g.sibling,g!==null){Vi=g;return}Vi=g=d}while(g!==null);Jn===0&&(Jn=5)}function Jl(d,g,b){var I=Lr,D=ds.transition;try{ds.transition=null,Lr=1,f1(d,g,b,I)}finally{ds.transition=D,Lr=I}return null}function f1(d,g,b,I){do Ju();while(ul!==null);if(Hn&6)throw Error(a(327));b=d.finishedWork;var D=d.finishedLanes;if(b===null)return null;if(d.finishedWork=null,d.finishedLanes=0,b===d.current)throw Error(a(177));d.callbackNode=null,d.callbackPriority=0;var N=b.lanes|b.childLanes;if(Lv(d,N),d===no&&(Vi=no=null,In=0),!(b.subtreeFlags&2064)&&!(b.flags&2064)||fs||(fs=!0,ps($f,function(){return Ju(),null})),N=(b.flags&15990)!==0,b.subtreeFlags&15990||N){N=ds.transition,ds.transition=null;var X=Lr;Lr=1;var ve=Hn;Hn|=4,Yp.current=null,Sn(d,b),va(b,d),q2(Du),Ua=!!Ru,Du=Ru=null,d.current=b,Xl(b),od(),Hn=ve,Lr=X,ds.transition=N}else d.current=b;if(fs&&(fs=!1,ul=d,tf=D),N=d.pendingLanes,N===0&&(ba=null),j2(b.stateNode),Qt(d,oi()),g!==null)for(I=d.onRecoverableError,b=0;b<g.length;b++)D=g[b],I(D.value,{componentStack:D.stack,digest:D.digest});if(ef)throw ef=!1,d=Mr,Mr=null,d;return tf&1&&d.tag!==0&&Ju(),N=d.pendingLanes,N&1?d===er?uh++:(uh=0,er=d):uh=0,Wo(),null}function Ju(){if(ul!==null){var d=qf(tf),g=ds.transition,b=Lr;try{if(ds.transition=null,Lr=16>d?16:d,ul===null)var I=!1;else{if(d=ul,ul=null,tf=0,Hn&6)throw Error(a(331));var D=Hn;for(Hn|=4,tn=d.current;tn!==null;){var N=tn,X=N.child;if(tn.flags&16){var ve=N.deletions;if(ve!==null){for(var Ce=0;Ce<ve.length;Ce++){var Ye=ve[Ce];for(tn=Ye;tn!==null;){var At=tn;switch(At.tag){case 0:case 11:case 15:pt(8,At,N)}var Dt=At.child;if(Dt!==null)Dt.return=At,tn=Dt;else for(;tn!==null;){At=tn;var Tt=At.sibling,Jt=At.return;if(Ko(At),At===Ye){tn=null;break}if(Tt!==null){Tt.return=Jt,tn=Tt;break}tn=Jt}}}var on=N.alternate;if(on!==null){var un=on.child;if(un!==null){on.child=null;do{var Ti=un.sibling;un.sibling=null,un=Ti}while(un!==null)}}tn=N}}if(N.subtreeFlags&2064&&X!==null)X.return=N,tn=X;else e:for(;tn!==null;){if(N=tn,N.flags&2048)switch(N.tag){case 0:case 11:case 15:pt(9,N,N.return)}var Ze=N.sibling;if(Ze!==null){Ze.return=N.return,tn=Ze;break e}tn=N.return}}var Fe=d.current;for(tn=Fe;tn!==null;){X=tn;var Re=X.child;if(X.subtreeFlags&2064&&Re!==null)Re.return=X,tn=Re;else e:for(X=Fe;tn!==null;){if(ve=tn,ve.flags&2048)try{switch(ve.tag){case 0:case 11:case 15:En(9,ve)}}catch(rn){vi(ve,ve.return,rn)}if(ve===X){tn=null;break e}var Bt=ve.sibling;if(Bt!==null){Bt.return=ve.return,tn=Bt;break e}tn=ve.return}}if(Hn=D,Wo(),Hs&&typeof Hs.onPostCommitFiberRoot=="function")try{Hs.onPostCommitFiberRoot(vu,d)}catch{}I=!0}return I}finally{Lr=b,ds.transition=g}}return!1}function t_(d,g,b){g=hs(b,g),g=Np(d,g,1),d=tl(d,g,1),g=Co(),d!==null&&(ja(d,1,g),Qt(d,g))}function vi(d,g,b){if(d.tag===3)t_(d,d,b);else for(;g!==null;){if(g.tag===3){t_(g,d,b);break}else if(g.tag===1){var I=g.stateNode;if(typeof g.type.getDerivedStateFromError=="function"||typeof I.componentDidCatch=="function"&&(ba===null||!ba.has(I))){d=hs(b,d),d=jp(g,d,1),g=tl(g,d,1),d=Co(),g!==null&&(ja(g,1,d),Qt(g,d));break}}g=g.return}}function p1(d,g,b){var I=d.pingCache;I!==null&&I.delete(g),g=Co(),d.pingedLanes|=d.suspendedLanes&b,no===d&&(In&b)===b&&(Jn===4||Jn===3&&(In&130023424)===In&&500>oi()-xa?Ql(d,0):Yy|=b),Qt(d,g)}function Sa(d,g){g===0&&(d.mode&1?(g=xu,xu<<=1,!(xu&130023424)&&(xu=4194304)):g=1);var b=Co();d=Ms(d,g),d!==null&&(ja(d,g,b),Qt(d,b))}function Y2(d){var g=d.memoizedState,b=0;g!==null&&(b=g.retryLane),Sa(d,b)}function kn(d,g){var b=0;switch(d.tag){case 13:var I=d.stateNode,D=d.memoizedState;D!==null&&(b=D.retryLane);break;case 19:I=d.stateNode;break;default:throw Error(a(314))}I!==null&&I.delete(g),Sa(d,b)}var rm;rm=function(d,g,b){if(d!==null)if(d.memoizedProps!==g.pendingProps||qo.current)wo=!0;else{if(!(d.lanes&b)&&!(g.flags&128))return wo=!1,r1(d,g,b);wo=!!(d.flags&131072)}else wo=!1,Ar&&g.flags&1048576&&Zv(g,Gc,g.index);switch(g.lanes=0,g.tag){case 2:var I=g.type;Qd(d,g),d=g.pendingProps;var D=Gl(g,go.current);Vu(g,b),D=Pp(null,g,I,d,D,b);var N=Rp();return g.flags|=1,typeof D=="object"&&D!==null&&typeof D.render=="function"&&D.$$typeof===void 0?(g.tag=1,g.memoizedState=null,g.updateQueue=null,yo(I)?(N=!0,Pd(g)):N=!1,g.memoizedState=D.state!==null&&D.state!==void 0?D.state:null,Cp(g),D.updater=Bd,g.stateNode=D,D._reactInternals=g,Mp(g,I,d,b),g=Ku(null,g,I,!0,N,b)):(g.tag=0,Ar&&N&&bp(g),Ei(null,g,D,b),g=g.child),g;case 16:I=g.elementType;e:{switch(Qd(d,g),d=g.pendingProps,D=I._init,I=D(I._payload),g.type=I,D=g.tag=g1(I),d=Xo(I,d),D){case 0:g=Zd(null,g,I,d,b);break e;case 1:g=Gp(null,g,I,d,b);break e;case 11:g=di(null,g,I,d,b);break e;case 14:g=Vp(null,g,I,Xo(I.type,d),b);break e}throw Error(a(306,I,""))}return g;case 0:return I=g.type,D=g.pendingProps,D=g.elementType===I?D:Xo(I,D),Zd(d,g,I,D,b);case 1:return I=g.type,D=g.pendingProps,D=g.elementType===I?D:Xo(I,D),Gp(d,g,I,D,b);case 3:e:{if(rh(g),d===null)throw Error(a(387));I=g.pendingProps,N=g.memoizedState,D=N.element,Py(d,g),Fd(g,I,null,b);var X=g.memoizedState;if(I=X.element,N.isDehydrated)if(N={element:I,isDehydrated:!1,cache:X.cache,pendingSuspenseBoundaries:X.pendingSuspenseBoundaries,transitions:X.transitions},g.updateQueue.baseState=N,g.memoizedState=N,g.flags&256){D=hs(Error(a(423)),g),g=Hp(d,g,I,b,D);break e}else if(I!==D){D=hs(Error(a(424)),g),g=Hp(d,g,I,b,D);break e}else for(_o=Xa(g.stateNode.containerInfo.firstChild),Oo=g,Ar=!0,ls=null,b=Yv(g,null,I,b),g.child=b;b;)b.flags=b.flags&-3|4096,b=b.sibling;else{if(Nu(),I===D){g=ga(d,g,b);break e}Ei(d,g,I,b)}g=g.child}return g;case 5:return Qv(g),d===null&&qc(g),I=g.type,D=g.pendingProps,N=d!==null?d.memoizedProps:null,X=D.children,_p(I,D)?X=null:N!==null&&_p(I,N)&&(g.flags|=32),nh(d,g),Ei(d,g,X,b),g.child;case 6:return d===null&&qc(g),null;case 13:return Hy(d,g,b);case 4:return Fy(g,g.stateNode.containerInfo),I=g.pendingProps,d===null?g.child=Zc(g,null,I,b):Ei(d,g,I,b),g.child;case 11:return I=g.type,D=g.pendingProps,D=g.elementType===I?D:Xo(I,D),di(d,g,I,D,b);case 7:return Ei(d,g,g.pendingProps,b),g.child;case 8:return Ei(d,g,g.pendingProps.children,b),g.child;case 12:return Ei(d,g,g.pendingProps.children,b),g.child;case 10:e:{if(I=g.type._context,D=g.pendingProps,N=g.memoizedProps,X=D.value,ei(Wc,I._currentValue),I._currentValue=X,N!==null)if(mo(N.value,X)){if(N.children===D.children&&!qo.current){g=ga(d,g,b);break e}}else for(N=g.child,N!==null&&(N.return=g);N!==null;){var ve=N.dependencies;if(ve!==null){X=N.child;for(var Ce=ve.firstContext;Ce!==null;){if(Ce.context===I){if(N.tag===1){Ce=da(-1,b&-b),Ce.tag=2;var Ye=N.updateQueue;if(Ye!==null){Ye=Ye.shared;var At=Ye.pending;At===null?Ce.next=Ce:(Ce.next=At.next,At.next=Ce),Ye.pending=Ce}}N.lanes|=b,Ce=N.alternate,Ce!==null&&(Ce.lanes|=b),Iy(N.return,b,g),ve.lanes|=b;break}Ce=Ce.next}}else if(N.tag===10)X=N.type===g.type?null:N.child;else if(N.tag===18){if(X=N.return,X===null)throw Error(a(341));X.lanes|=b,ve=X.alternate,ve!==null&&(ve.lanes|=b),Iy(X,b,g),X=N.sibling}else X=N.child;if(X!==null)X.return=N;else for(X=N;X!==null;){if(X===g){X=null;break}if(N=X.sibling,N!==null){N.return=X.return,X=N;break}X=X.return}N=X}Ei(d,g,D.children,b),g=g.child}return g;case 9:return D=g.type,I=g.pendingProps.children,Vu(g,b),D=zo(D),I=I(D),g.flags|=1,Ei(d,g,I,b),g.child;case 14:return I=g.type,D=Xo(I,g.pendingProps),D=Xo(I.type,D),Vp(d,g,I,D,b);case 15:return $p(d,g,g.type,g.pendingProps,b);case 17:return I=g.type,D=g.pendingProps,D=g.elementType===I?D:Xo(I,D),Qd(d,g),g.tag=1,yo(I)?(d=!0,Pd(g)):d=!1,Vu(g,b),Ly(g,I,D),Mp(g,I,D,b),Ku(null,g,I,!0,d,b);case 19:return Wy(d,g,b);case 22:return Wd(d,g,b)}throw Error(a(156,g.tag))};function ps(d,g){return Ho(d,g)}function m1(d,g,b,I){this.tag=d,this.key=b,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=g,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=I,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ms(d,g,b,I){return new m1(d,g,b,I)}function im(d){return d=d.prototype,!(!d||!d.isReactComponent)}function g1(d){if(typeof d=="function")return im(d)?1:0;if(d!=null){if(d=d.$$typeof,d===Ue)return 11;if(d===_t)return 14}return 2}function dl(d,g){var b=d.alternate;return b===null?(b=ms(d.tag,g,d.key,d.mode),b.elementType=d.elementType,b.type=d.type,b.stateNode=d.stateNode,b.alternate=d,d.alternate=b):(b.pendingProps=g,b.type=d.type,b.flags=0,b.subtreeFlags=0,b.deletions=null),b.flags=d.flags&14680064,b.childLanes=d.childLanes,b.lanes=d.lanes,b.child=d.child,b.memoizedProps=d.memoizedProps,b.memoizedState=d.memoizedState,b.updateQueue=d.updateQueue,g=d.dependencies,b.dependencies=g===null?null:{lanes:g.lanes,firstContext:g.firstContext},b.sibling=d.sibling,b.index=d.index,b.ref=d.ref,b}function rf(d,g,b,I,D,N){var X=2;if(I=d,typeof d=="function")im(d)&&(X=1);else if(typeof d=="string")X=5;else e:switch(d){case he:return eu(b.children,D,N,g);case se:X=8,D|=8;break;case q:return d=ms(12,b,g,D|2),d.elementType=q,d.lanes=N,d;case Be:return d=ms(13,b,g,D),d.elementType=Be,d.lanes=N,d;case rt:return d=ms(19,b,g,D),d.elementType=rt,d.lanes=N,d;case dt:return of(b,D,N,g);default:if(typeof d=="object"&&d!==null)switch(d.$$typeof){case Se:X=10;break e;case ze:X=9;break e;case Ue:X=11;break e;case _t:X=14;break e;case zt:X=16,I=null;break e}throw Error(a(130,d==null?d:typeof d,""))}return g=ms(X,b,g,D),g.elementType=d,g.type=I,g.lanes=N,g}function eu(d,g,b,I){return d=ms(7,d,I,g),d.lanes=b,d}function of(d,g,b,I){return d=ms(22,d,I,g),d.elementType=dt,d.lanes=b,d.stateNode={isHidden:!1},d}function om(d,g,b){return d=ms(6,d,null,g),d.lanes=b,d}function n_(d,g,b){return g=ms(4,d.children!==null?d.children:[],d.key,g),g.lanes=b,g.stateNode={containerInfo:d.containerInfo,pendingChildren:null,implementation:d.implementation},g}function r_(d,g,b,I,D){this.tag=g,this.containerInfo=d,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Na(0),this.expirationTimes=Na(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Na(0),this.identifierPrefix=I,this.onRecoverableError=D,this.mutableSourceEagerHydrationData=null}function fl(d,g,b,I,D,N,X,ve,Ce){return d=new r_(d,g,b,ve,Ce),g===1?(g=1,N===!0&&(g|=8)):g=0,N=ms(3,null,null,g),d.current=N,N.stateNode=d,N.memoizedState={element:I,isDehydrated:b,cache:null,transitions:null,pendingSuspenseBoundaries:null},Cp(N),d}function Q2(d,g,b){var I=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:de,key:I==null?null:""+I,children:d,containerInfo:g,implementation:b}}function Ea(d){if(!d)return $l;d=d._reactInternals;e:{if(Yr(d)!==d||d.tag!==1)throw Error(a(170));var g=d;do{switch(g.tag){case 3:g=g.stateNode.context;break e;case 1:if(yo(g.type)){g=g.stateNode.__reactInternalMemoizedMergedChildContext;break e}}g=g.return}while(g!==null);throw Error(a(171))}if(d.tag===1){var b=d.type;if(yo(b))return Ey(d,b,g)}return g}function Yo(d,g,b,I,D,N,X,ve,Ce){return d=fl(b,I,!0,d,D,N,X,ve,Ce),d.context=Ea(null),b=d.current,I=Co(),D=cl(b),N=da(I,D),N.callback=g??null,tl(b,N,D),d.current.lanes=D,ja(d,D,I),Qt(d,I),d}function sf(d,g,b,I){var D=g.current,N=Co(),X=cl(D);return b=Ea(b),g.context===null?g.context=b:g.pendingContext=b,g=da(N,X),g.payload={element:d},I=I===void 0?null:I,I!==null&&(g.callback=I),d=tl(D,g,X),d!==null&&(Ps(d,D,X,N),zd(d,D,X)),X}function ec(d){if(d=d.current,!d.child)return null;switch(d.child.tag){case 5:return d.child.stateNode;default:return d.child.stateNode}}function sm(d,g){if(d=d.memoizedState,d!==null&&d.dehydrated!==null){var b=d.retryLane;d.retryLane=b!==0&&b<g?b:g}}function am(d,g){sm(d,g),(d=d.alternate)&&sm(d,g)}function y1(){return null}var i_=typeof reportError=="function"?reportError:function(d){console.error(d)};function lm(d){this._internalRoot=d}tc.prototype.render=lm.prototype.render=function(d){var g=this._internalRoot;if(g===null)throw Error(a(409));sf(d,g,null,null)},tc.prototype.unmount=lm.prototype.unmount=function(){var d=this._internalRoot;if(d!==null){this._internalRoot=null;var g=d.containerInfo;Yl(function(){sf(null,d,null,null)}),g[Cs]=null}};function tc(d){this._internalRoot=d}tc.prototype.unstable_scheduleHydration=function(d){if(d){var g=Yg();d={blockedOn:null,target:d,priority:g};for(var b=0;b<Ct.length&&g!==0&&g<Ct[b].priority;b++);Ct.splice(b,0,d),b===0&&Xf(d)}};function um(d){return!(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11)}function af(d){return!(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11&&(d.nodeType!==8||d.nodeValue!==" react-mount-point-unstable "))}function o_(){}function _1(d,g,b,I,D){if(D){if(typeof I=="function"){var N=I;I=function(){var Ye=ec(X);N.call(Ye)}}var X=Yo(g,I,d,0,null,!1,!1,"",o_);return d._reactRootContainer=X,d[Cs]=X.current,ua(d.nodeType===8?d.parentNode:d),Yl(),X}for(;D=d.lastChild;)d.removeChild(D);if(typeof I=="function"){var ve=I;I=function(){var Ye=ec(Ce);ve.call(Ye)}}var Ce=fl(d,0,!1,null,null,!1,!1,"",o_);return d._reactRootContainer=Ce,d[Cs]=Ce.current,ua(d.nodeType===8?d.parentNode:d),Yl(function(){sf(g,Ce,b,I)}),Ce}function lf(d,g,b,I,D){var N=b._reactRootContainer;if(N){var X=N;if(typeof D=="function"){var ve=D;D=function(){var Ce=ec(X);ve.call(Ce)}}sf(g,X,d,D)}else X=_1(b,g,d,D,I);return ec(X)}Wf=function(d){switch(d.tag){case 3:var g=d.stateNode;if(g.current.memoizedState.isDehydrated){var b=wu(g.pendingLanes);b!==0&&(Hf(g,b|1),Qt(g,oi()),!(Hn&6)&&(Qu=oi()+500,Wo()))}break;case 13:Yl(function(){var I=Ms(d,1);if(I!==null){var D=Co();Ps(I,d,1,D)}}),am(d,1)}},Eu=function(d){if(d.tag===13){var g=Ms(d,134217728);if(g!==null){var b=Co();Ps(g,d,134217728,b)}am(d,134217728)}},ad=function(d){if(d.tag===13){var g=cl(d),b=Ms(d,g);if(b!==null){var I=Co();Ps(b,d,g,I)}am(d,g)}},Yg=function(){return Lr},Qg=function(d,g){var b=Lr;try{return Lr=d,g()}finally{Lr=b}},$t=function(d,g,b){switch(g){case"input":if(te(d,b),g=b.name,b.type==="radio"&&g!=null){for(b=d;b.parentNode;)b=b.parentNode;for(b=b.querySelectorAll("input[name="+JSON.stringify(""+g)+'][type="radio"]'),g=0;g<b.length;g++){var I=b[g];if(I!==d&&I.form===d.form){var D=xp(I);if(!D)throw Error(a(90));vn(I),te(I,D)}}}break;case"textarea":Ne(d,b);break;case"select":g=b.value,g!=null&&Je(d,!!b.multiple,g,!1)}},Qe=tm,tt=Yl;var s_={usingClientEntryPoint:!1,Events:[kd,Ya,xp,Ie,je,tm]},No={findFiberByHostInstance:Ka,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},v1={bundleType:No.bundleType,version:No.version,rendererPackageName:No.rendererPackageName,rendererConfig:No.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:W.ReactCurrentDispatcher,findHostInstanceByFiber:function(d){return d=Po(d),d===null?null:d.stateNode},findFiberByHostInstance:No.findFiberByHostInstance||y1,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var uf=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!uf.isDisabled&&uf.supportsFiber)try{vu=uf.inject(v1),Hs=uf}catch{}}return Bs.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=s_,Bs.createPortal=function(d,g){var b=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!um(g))throw Error(a(200));return Q2(d,g,null,b)},Bs.createRoot=function(d,g){if(!um(d))throw Error(a(299));var b=!1,I="",D=i_;return g!=null&&(g.unstable_strictMode===!0&&(b=!0),g.identifierPrefix!==void 0&&(I=g.identifierPrefix),g.onRecoverableError!==void 0&&(D=g.onRecoverableError)),g=fl(d,1,!1,null,null,b,!1,I,D),d[Cs]=g.current,ua(d.nodeType===8?d.parentNode:d),new lm(g)},Bs.findDOMNode=function(d){if(d==null)return null;if(d.nodeType===1)return d;var g=d._reactInternals;if(g===void 0)throw typeof d.render=="function"?Error(a(188)):(d=Object.keys(d).join(","),Error(a(268,d)));return d=Po(g),d=d===null?null:d.stateNode,d},Bs.flushSync=function(d){return Yl(d)},Bs.hydrate=function(d,g,b){if(!af(g))throw Error(a(200));return lf(null,d,g,!0,b)},Bs.hydrateRoot=function(d,g,b){if(!um(d))throw Error(a(405));var I=b!=null&&b.hydratedSources||null,D=!1,N="",X=i_;if(b!=null&&(b.unstable_strictMode===!0&&(D=!0),b.identifierPrefix!==void 0&&(N=b.identifierPrefix),b.onRecoverableError!==void 0&&(X=b.onRecoverableError)),g=Yo(g,null,d,1,b??null,D,!1,N,X),d[Cs]=g.current,ua(d),I)for(d=0;d<I.length;d++)b=I[d],D=b._getVersion,D=D(b._source),g.mutableSourceEagerHydrationData==null?g.mutableSourceEagerHydrationData=[b,D]:g.mutableSourceEagerHydrationData.push(b,D);return new tc(g)},Bs.render=function(d,g,b){if(!af(g))throw Error(a(200));return lf(null,d,g,!1,b)},Bs.unmountComponentAtNode=function(d){if(!af(d))throw Error(a(40));return d._reactRootContainer?(Yl(function(){lf(null,null,d,!1,function(){d._reactRootContainer=null,d[Cs]=null})}),!0):!1},Bs.unstable_batchedUpdates=tm,Bs.unstable_renderSubtreeIntoContainer=function(d,g,b,I){if(!af(b))throw Error(a(200));if(d==null||d._reactInternals===void 0)throw Error(a(38));return lf(d,g,b,!1,I)},Bs.version="18.2.0-next-9e3b772b8-20220608",Bs}function iF(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(iF)}catch(r){console.error(r)}}iF(),kW();const PW=tF`
  from {
    opacity: 0
  }
  to {
    opacity: 1
  }
`;Tr.div`
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;

  display: flex;
  justify-content: center;
  align-items: center;

  z-index: 10;

  background-color: rgba(0, 0, 0, 0.28);

  animation-duration: 0.25s;
  animation-timing-function: ease-out;
  animation-name: ${PW};
  animation-fill-mode: forwards;
`;Tr.div`
  height: ${({isSpread:r})=>r?"100%":"0px"};
  overflow: hidden;

  //transition: height 0.3s ease-in-out;
`;Tr.input`
  height: ${({height:r})=>r||"auto"};
  width: ${({width:r})=>r||"auto"};
  line-height: normal;
  padding: ${({padding:r})=>r||"0.5rem"};
  font-family: inherit;
  border: 1px solid #999;
  border-radius: 5px;
  outline-style: none;
  -webkit-appearance: none;
  -moz-appearance: none;
  appearance: none;
`;Tr.input`
  font-size: 1rem;
  padding: 10px 10px 10px 5px;

  display: block;
  width: calc(100% - 15px);
  border: none;
  border-bottom: 1px solid #757575;

  &:focus {
    outline: none;
  }
`;Tr.label`
  color: #999;
  font-size: 1rem;
  font-weight: normal;
  position: absolute;
  pointer-events: none;
  left: 5px;
  top: 10px;
  transition: 0.2s ease all;

  /* active state */
  input:focus ~ &,
  input:not(:placeholder-shown) ~ & {
    top: -20px;
    font-size: 0.875rem;
    color: ${({theme:r})=>r.primary};
  }
`;Tr.span`
  position: relative;
  display: block;
  width: 100%;
  &:before,
  &:after {
    content: "";
    height: 2px;
    width: 0;
    bottom: 1px;
    position: absolute;
    background: ${({theme:r})=>r.primary};
    transition: 0.2s ease all;
  }
  &:before {
    left: 50%;
  }
  &:after {
    right: 50%;
  }

  /* active state */
  input:focus ~ &:before,
  input:focus ~ &:after {
    width: 50%;
  }
`;Tr.div`
  position: relative;
  margin-top: 5px;
`;Tr.label`
  display: flex;
  align-items: center;
  cursor: pointer;
`;Tr.input.attrs({type:"radio"})`
  vertical-align: middle;
  appearance: none;
  border: 2px solid gray;
  border-radius: 50%;
  width: 1.25em;
  height: 1.25em;
  margin-right: 0.75em;

  :checked {
    border: 0.4em solid ${({theme:r})=>r.primary};
  }

  :focus-visible {
    outline-offset: 2px;
    outline: 2px dotted ${({theme:r})=>r.primary};
  }

  :hover {
    box-shadow: 0 0 0 4px lightgray;
    cursor: pointer;
  }

  :disabled {
    background-color: lightgray;
    box-shadow: none;
    opacity: 0.7;
    cursor: not-allowed;
  }
`;Tr.textarea``;Tr(Xi)`
  padding: 2px 5px;
  border-radius: 8px;
  background-color: ${({theme:r})=>r.primary};
`;Tr.span`
  color: ${({theme:r,color:o})=>o??r.primary};
  font-size: ${({size:r})=>r??"inherit"};
  font-weight: ${({weight:r})=>r??"inherit"};
`;Tr.span`
  background-image: ${({theme:r,color:o})=>o?`linear-gradient(${o}, ${o})`:`linear-gradient(${r.primary}, ${r.primary})`};
  background-position: bottom;
  background-size: ${({size:r})=>r??"100% 57%"};
  background-repeat: no-repeat;
`;function oF(r){var o,a,c="";if(typeof r=="string"||typeof r=="number")c+=r;else if(typeof r=="object")if(Array.isArray(r))for(o=0;o<r.length;o++)r[o]&&(a=oF(r[o]))&&(c&&(c+=" "),c+=a);else for(o in r)r[o]&&(c&&(c+=" "),c+=o);return c}function Vh(){for(var r,o,a=0,c="";a<arguments.length;)(r=arguments[a++])&&(o=oF(r))&&(c&&(c+=" "),c+=o);return c}const L0=r=>typeof r=="number"&&!isNaN(r),Nf=r=>typeof r=="string",Us=r=>typeof r=="function",Bw=r=>Nf(r)||Us(r)?r:null,_T=r=>_e.isValidElement(r)||Nf(r)||Us(r)||L0(r);function RW(r,o,a){a===void 0&&(a=300);const{scrollHeight:c,style:p}=r;requestAnimationFrame(()=>{p.minHeight="initial",p.height=c+"px",p.transition=`all ${a}ms`,requestAnimationFrame(()=>{p.height="0",p.padding="0",p.margin="0",setTimeout(o,a)})})}function M2(r){let{enter:o,exit:a,appendPosition:c=!1,collapse:p=!0,collapseDuration:_=300}=r;return function(x){let{children:T,position:C,preventExitTransition:P,done:O,nodeRef:F,isIn:U}=x;const Z=c?`${o}--${C}`:o,$=c?`${a}--${C}`:a,K=_e.useRef(0);return _e.useLayoutEffect(()=>{const ie=F.current,H=Z.split(" "),G=ee=>{ee.target===F.current&&(ie.dispatchEvent(new Event("d")),ie.removeEventListener("animationend",G),ie.removeEventListener("animationcancel",G),K.current===0&&ee.type!=="animationcancel"&&ie.classList.remove(...H))};ie.classList.add(...H),ie.addEventListener("animationend",G),ie.addEventListener("animationcancel",G)},[]),_e.useEffect(()=>{const ie=F.current,H=()=>{ie.removeEventListener("animationend",H),p?RW(ie,O,_):O()};U||(P?H():(K.current=1,ie.className+=` ${$}`,ie.addEventListener("animationend",H)))},[U]),Xn.createElement(Xn.Fragment,null,T)}}function BL(r,o){return r!=null?{content:r.content,containerId:r.props.containerId,id:r.props.toastId,theme:r.props.theme,type:r.props.type,data:r.props.data||{},isLoading:r.props.isLoading,icon:r.props.icon,status:o}:{}}const Pa={list:new Map,emitQueue:new Map,on(r,o){return this.list.has(r)||this.list.set(r,[]),this.list.get(r).push(o),this},off(r,o){if(o){const a=this.list.get(r).filter(c=>c!==o);return this.list.set(r,a),this}return this.list.delete(r),this},cancelEmit(r){const o=this.emitQueue.get(r);return o&&(o.forEach(clearTimeout),this.emitQueue.delete(r)),this},emit(r){this.list.has(r)&&this.list.get(r).forEach(o=>{const a=setTimeout(()=>{o(...[].slice.call(arguments,1))},0);this.emitQueue.has(r)||this.emitQueue.set(r,[]),this.emitQueue.get(r).push(a)})}},nw=r=>{let{theme:o,type:a,...c}=r;return Xn.createElement("svg",{viewBox:"0 0 24 24",width:"100%",height:"100%",fill:o==="colored"?"currentColor":`var(--toastify-icon-color-${a})`,...c})},vT={info:function(r){return Xn.createElement(nw,{...r},Xn.createElement("path",{d:"M12 0a12 12 0 1012 12A12.013 12.013 0 0012 0zm.25 5a1.5 1.5 0 11-1.5 1.5 1.5 1.5 0 011.5-1.5zm2.25 13.5h-4a1 1 0 010-2h.75a.25.25 0 00.25-.25v-4.5a.25.25 0 00-.25-.25h-.75a1 1 0 010-2h1a2 2 0 012 2v4.75a.25.25 0 00.25.25h.75a1 1 0 110 2z"}))},warning:function(r){return Xn.createElement(nw,{...r},Xn.createElement("path",{d:"M23.32 17.191L15.438 2.184C14.728.833 13.416 0 11.996 0c-1.42 0-2.733.833-3.443 2.184L.533 17.448a4.744 4.744 0 000 4.368C1.243 23.167 2.555 24 3.975 24h16.05C22.22 24 24 22.044 24 19.632c0-.904-.251-1.746-.68-2.44zm-9.622 1.46c0 1.033-.724 1.823-1.698 1.823s-1.698-.79-1.698-1.822v-.043c0-1.028.724-1.822 1.698-1.822s1.698.79 1.698 1.822v.043zm.039-12.285l-.84 8.06c-.057.581-.408.943-.897.943-.49 0-.84-.367-.896-.942l-.84-8.065c-.057-.624.25-1.095.779-1.095h1.91c.528.005.84.476.784 1.1z"}))},success:function(r){return Xn.createElement(nw,{...r},Xn.createElement("path",{d:"M12 0a12 12 0 1012 12A12.014 12.014 0 0012 0zm6.927 8.2l-6.845 9.289a1.011 1.011 0 01-1.43.188l-4.888-3.908a1 1 0 111.25-1.562l4.076 3.261 6.227-8.451a1 1 0 111.61 1.183z"}))},error:function(r){return Xn.createElement(nw,{...r},Xn.createElement("path",{d:"M11.983 0a12.206 12.206 0 00-8.51 3.653A11.8 11.8 0 000 12.207 11.779 11.779 0 0011.8 24h.214A12.111 12.111 0 0024 11.791 11.766 11.766 0 0011.983 0zM10.5 16.542a1.476 1.476 0 011.449-1.53h.027a1.527 1.527 0 011.523 1.47 1.475 1.475 0 01-1.449 1.53h-.027a1.529 1.529 0 01-1.523-1.47zM11 12.5v-6a1 1 0 012 0v6a1 1 0 11-2 0z"}))},spinner:function(){return Xn.createElement("div",{className:"Toastify__spinner"})}};function DW(r){const[,o]=_e.useReducer(Z=>Z+1,0),[a,c]=_e.useState([]),p=_e.useRef(null),_=_e.useRef(new Map).current,x=Z=>a.indexOf(Z)!==-1,T=_e.useRef({toastKey:1,displayedToast:0,count:0,queue:[],props:r,containerId:null,isToastActive:x,getToast:Z=>_.get(Z)}).current;function C(Z){let{containerId:$}=Z;const{limit:K}=T.props;!K||$&&T.containerId!==$||(T.count-=T.queue.length,T.queue=[])}function P(Z){c($=>Z==null?[]:$.filter(K=>K!==Z))}function O(){const{toastContent:Z,toastProps:$,staleId:K}=T.queue.shift();U(Z,$,K)}function F(Z,$){let{delay:K,staleId:ie,...H}=$;if(!_T(Z)||function(Ue){return!p.current||T.props.enableMultiContainer&&Ue.containerId!==T.props.containerId||_.has(Ue.toastId)&&Ue.updateId==null}(H))return;const{toastId:G,updateId:ee,data:W}=H,{props:me}=T,de=()=>P(G),he=ee==null;he&&T.count++;const se={...me,style:me.toastStyle,key:T.toastKey++,...Object.fromEntries(Object.entries(H).filter(Ue=>{let[Be,rt]=Ue;return rt!=null})),toastId:G,updateId:ee,data:W,closeToast:de,isIn:!1,className:Bw(H.className||me.toastClassName),bodyClassName:Bw(H.bodyClassName||me.bodyClassName),progressClassName:Bw(H.progressClassName||me.progressClassName),autoClose:!H.isLoading&&(q=H.autoClose,Se=me.autoClose,q===!1||L0(q)&&q>0?q:Se),deleteToast(){const Ue=BL(_.get(G),"removed");_.delete(G),Pa.emit(4,Ue);const Be=T.queue.length;if(T.count=G==null?T.count-T.displayedToast:T.count-1,T.count<0&&(T.count=0),Be>0){const rt=G==null?T.props.limit:1;if(Be===1||rt===1)T.displayedToast++,O();else{const _t=rt>Be?Be:rt;T.displayedToast=_t;for(let zt=0;zt<_t;zt++)O()}}else o()}};var q,Se;se.iconOut=function(Ue){let{theme:Be,type:rt,isLoading:_t,icon:zt}=Ue,dt=null;const Te={theme:Be,type:rt};return zt===!1||(Us(zt)?dt=zt(Te):_e.isValidElement(zt)?dt=_e.cloneElement(zt,Te):Nf(zt)||L0(zt)?dt=zt:_t?dt=vT.spinner():(we=>we in vT)(rt)&&(dt=vT[rt](Te))),dt}(se),Us(H.onOpen)&&(se.onOpen=H.onOpen),Us(H.onClose)&&(se.onClose=H.onClose),se.closeButton=me.closeButton,H.closeButton===!1||_T(H.closeButton)?se.closeButton=H.closeButton:H.closeButton===!0&&(se.closeButton=!_T(me.closeButton)||me.closeButton);let ze=Z;_e.isValidElement(Z)&&!Nf(Z.type)?ze=_e.cloneElement(Z,{closeToast:de,toastProps:se,data:W}):Us(Z)&&(ze=Z({closeToast:de,toastProps:se,data:W})),me.limit&&me.limit>0&&T.count>me.limit&&he?T.queue.push({toastContent:ze,toastProps:se,staleId:ie}):L0(K)?setTimeout(()=>{U(ze,se,ie)},K):U(ze,se,ie)}function U(Z,$,K){const{toastId:ie}=$;K&&_.delete(K);const H={content:Z,props:$};_.set(ie,H),c(G=>[...G,ie].filter(ee=>ee!==K)),Pa.emit(4,BL(H,H.props.updateId==null?"added":"updated"))}return _e.useEffect(()=>(T.containerId=r.containerId,Pa.cancelEmit(3).on(0,F).on(1,Z=>p.current&&P(Z)).on(5,C).emit(2,T),()=>{_.clear(),Pa.emit(3,T)}),[]),_e.useEffect(()=>{T.props=r,T.isToastActive=x,T.displayedToast=a.length}),{getToastToRender:function(Z){const $=new Map,K=Array.from(_.values());return r.newestOnTop&&K.reverse(),K.forEach(ie=>{const{position:H}=ie.props;$.has(H)||$.set(H,[]),$.get(H).push(ie)}),Array.from($,ie=>Z(ie[0],ie[1]))},containerRef:p,isToastActive:x}}function NL(r){return r.targetTouches&&r.targetTouches.length>=1?r.targetTouches[0].clientX:r.clientX}function jL(r){return r.targetTouches&&r.targetTouches.length>=1?r.targetTouches[0].clientY:r.clientY}function LW(r){const[o,a]=_e.useState(!1),[c,p]=_e.useState(!1),_=_e.useRef(null),x=_e.useRef({start:0,x:0,y:0,delta:0,removalDistance:0,canCloseOnClick:!0,canDrag:!1,boundingRect:null,didMove:!1}).current,T=_e.useRef(r),{autoClose:C,pauseOnHover:P,closeToast:O,onClick:F,closeOnClick:U}=r;function Z(W){if(r.draggable){W.nativeEvent.type==="touchstart"&&W.nativeEvent.preventDefault(),x.didMove=!1,document.addEventListener("mousemove",H),document.addEventListener("mouseup",G),document.addEventListener("touchmove",H),document.addEventListener("touchend",G);const me=_.current;x.canCloseOnClick=!0,x.canDrag=!0,x.boundingRect=me.getBoundingClientRect(),me.style.transition="",x.x=NL(W.nativeEvent),x.y=jL(W.nativeEvent),r.draggableDirection==="x"?(x.start=x.x,x.removalDistance=me.offsetWidth*(r.draggablePercent/100)):(x.start=x.y,x.removalDistance=me.offsetHeight*(r.draggablePercent===80?1.5*r.draggablePercent:r.draggablePercent/100))}}function $(W){if(x.boundingRect){const{top:me,bottom:de,left:he,right:se}=x.boundingRect;W.nativeEvent.type!=="touchend"&&r.pauseOnHover&&x.x>=he&&x.x<=se&&x.y>=me&&x.y<=de?ie():K()}}function K(){a(!0)}function ie(){a(!1)}function H(W){const me=_.current;x.canDrag&&me&&(x.didMove=!0,o&&ie(),x.x=NL(W),x.y=jL(W),x.delta=r.draggableDirection==="x"?x.x-x.start:x.y-x.start,x.start!==x.x&&(x.canCloseOnClick=!1),me.style.transform=`translate${r.draggableDirection}(${x.delta}px)`,me.style.opacity=""+(1-Math.abs(x.delta/x.removalDistance)))}function G(){document.removeEventListener("mousemove",H),document.removeEventListener("mouseup",G),document.removeEventListener("touchmove",H),document.removeEventListener("touchend",G);const W=_.current;if(x.canDrag&&x.didMove&&W){if(x.canDrag=!1,Math.abs(x.delta)>x.removalDistance)return p(!0),void r.closeToast();W.style.transition="transform 0.2s, opacity 0.2s",W.style.transform=`translate${r.draggableDirection}(0)`,W.style.opacity="1"}}_e.useEffect(()=>{T.current=r}),_e.useEffect(()=>(_.current&&_.current.addEventListener("d",K,{once:!0}),Us(r.onOpen)&&r.onOpen(_e.isValidElement(r.children)&&r.children.props),()=>{const W=T.current;Us(W.onClose)&&W.onClose(_e.isValidElement(W.children)&&W.children.props)}),[]),_e.useEffect(()=>(r.pauseOnFocusLoss&&(document.hasFocus()||ie(),window.addEventListener("focus",K),window.addEventListener("blur",ie)),()=>{r.pauseOnFocusLoss&&(window.removeEventListener("focus",K),window.removeEventListener("blur",ie))}),[r.pauseOnFocusLoss]);const ee={onMouseDown:Z,onTouchStart:Z,onMouseUp:$,onTouchEnd:$};return C&&P&&(ee.onMouseEnter=ie,ee.onMouseLeave=K),U&&(ee.onClick=W=>{F&&F(W),x.canCloseOnClick&&O()}),{playToast:K,pauseToast:ie,isRunning:o,preventExitTransition:c,toastRef:_,eventHandlers:ee}}function sF(r){let{closeToast:o,theme:a,ariaLabel:c="close"}=r;return Xn.createElement("button",{className:`Toastify__close-button Toastify__close-button--${a}`,type:"button",onClick:p=>{p.stopPropagation(),o(p)},"aria-label":c},Xn.createElement("svg",{"aria-hidden":"true",viewBox:"0 0 14 16"},Xn.createElement("path",{fillRule:"evenodd",d:"M7.71 8.23l3.75 3.75-1.48 1.48-3.75-3.75-3.75 3.75L1 11.98l3.75-3.75L1 4.48 2.48 3l3.75 3.75L9.98 3l1.48 1.48-3.75 3.75z"})))}function OW(r){let{delay:o,isRunning:a,closeToast:c,type:p="default",hide:_,className:x,style:T,controlledProgress:C,progress:P,rtl:O,isIn:F,theme:U}=r;const Z=_||C&&P===0,$={...T,animationDuration:`${o}ms`,animationPlayState:a?"running":"paused",opacity:Z?0:1};C&&($.transform=`scaleX(${P})`);const K=Vh("Toastify__progress-bar",C?"Toastify__progress-bar--controlled":"Toastify__progress-bar--animated",`Toastify__progress-bar-theme--${U}`,`Toastify__progress-bar--${p}`,{"Toastify__progress-bar--rtl":O}),ie=Us(x)?x({rtl:O,type:p,defaultClassName:K}):Vh(K,x);return Xn.createElement("div",{role:"progressbar","aria-hidden":Z?"true":"false","aria-label":"notification timer",className:ie,style:$,[C&&P>=1?"onTransitionEnd":"onAnimationEnd"]:C&&P<1?null:()=>{F&&c()}})}const zW=r=>{const{isRunning:o,preventExitTransition:a,toastRef:c,eventHandlers:p}=LW(r),{closeButton:_,children:x,autoClose:T,onClick:C,type:P,hideProgressBar:O,closeToast:F,transition:U,position:Z,className:$,style:K,bodyClassName:ie,bodyStyle:H,progressClassName:G,progressStyle:ee,updateId:W,role:me,progress:de,rtl:he,toastId:se,deleteToast:q,isIn:Se,isLoading:ze,iconOut:Ue,closeOnClick:Be,theme:rt}=r,_t=Vh("Toastify__toast",`Toastify__toast-theme--${rt}`,`Toastify__toast--${P}`,{"Toastify__toast--rtl":he},{"Toastify__toast--close-on-click":Be}),zt=Us($)?$({rtl:he,position:Z,type:P,defaultClassName:_t}):Vh(_t,$),dt=!!de||!T,Te={closeToast:F,type:P,theme:rt};let we=null;return _===!1||(we=Us(_)?_(Te):_e.isValidElement(_)?_e.cloneElement(_,Te):sF(Te)),Xn.createElement(U,{isIn:Se,done:q,position:Z,preventExitTransition:a,nodeRef:c},Xn.createElement("div",{id:se,onClick:C,className:zt,...p,style:K,ref:c},Xn.createElement("div",{...Se&&{role:me},className:Us(ie)?ie({type:P}):Vh("Toastify__toast-body",ie),style:H},Ue!=null&&Xn.createElement("div",{className:Vh("Toastify__toast-icon",{"Toastify--animate-icon Toastify__zoom-enter":!ze})},Ue),Xn.createElement("div",null,x)),we,Xn.createElement(OW,{...W&&!dt?{key:`pb-${W}`}:{},rtl:he,theme:rt,delay:T,isRunning:o,isIn:Se,closeToast:F,hide:O,type:P,style:ee,className:G,controlledProgress:dt,progress:de||0})))},I2=function(r,o){return o===void 0&&(o=!1),{enter:`Toastify--animate Toastify__${r}-enter`,exit:`Toastify--animate Toastify__${r}-exit`,appendPosition:o}},FW=M2(I2("bounce",!0));M2(I2("slide",!0));M2(I2("zoom"));M2(I2("flip"));const GC=_e.forwardRef((r,o)=>{const{getToastToRender:a,containerRef:c,isToastActive:p}=DW(r),{className:_,style:x,rtl:T,containerId:C}=r;function P(O){const F=Vh("Toastify__toast-container",`Toastify__toast-container--${O}`,{"Toastify__toast-container--rtl":T});return Us(_)?_({position:O,rtl:T,defaultClassName:F}):Vh(F,Bw(_))}return _e.useEffect(()=>{o&&(o.current=c.current)},[]),Xn.createElement("div",{ref:c,className:"Toastify",id:C},a((O,F)=>{const U=F.length?{...x}:{...x,pointerEvents:"none"};return Xn.createElement("div",{className:P(O),style:U,key:`container-${O}`},F.map((Z,$)=>{let{content:K,props:ie}=Z;return Xn.createElement(zW,{...ie,isIn:p(ie.toastId),style:{...ie.style,"--nth":$+1,"--len":F.length},key:`toast-${ie.key}`},K)}))}))});GC.displayName="ToastContainer",GC.defaultProps={position:"top-right",transition:FW,autoClose:5e3,closeButton:sF,pauseOnHover:!0,pauseOnFocusLoss:!0,closeOnClick:!0,draggable:!0,draggablePercent:80,draggableDirection:"x",role:"alert",theme:"light"};let xT,xf=new Map,_0=[],BW=1;function aF(){return""+BW++}function NW(r){return r&&(Nf(r.toastId)||L0(r.toastId))?r.toastId:aF()}function O0(r,o){return xf.size>0?Pa.emit(0,r,o):_0.push({content:r,options:o}),o.toastId}function Ob(r,o){return{...o,type:o&&o.type||r,toastId:NW(o)}}function rw(r){return(o,a)=>O0(o,Ob(r,a))}function mi(r,o){return O0(r,Ob("default",o))}mi.loading=(r,o)=>O0(r,Ob("default",{isLoading:!0,autoClose:!1,closeOnClick:!1,closeButton:!1,draggable:!1,...o})),mi.promise=function(r,o,a){let c,{pending:p,error:_,success:x}=o;p&&(c=Nf(p)?mi.loading(p,a):mi.loading(p.render,{...a,...p}));const T={isLoading:null,autoClose:null,closeOnClick:null,closeButton:null,draggable:null},C=(O,F,U)=>{if(F==null)return void mi.dismiss(c);const Z={type:O,...T,...a,data:U},$=Nf(F)?{render:F}:F;return c?mi.update(c,{...Z,...$}):mi($.render,{...Z,...$}),U},P=Us(r)?r():r;return P.then(O=>C("success",x,O)).catch(O=>C("error",_,O)),P},mi.success=rw("success"),mi.info=rw("info"),mi.error=rw("error"),mi.warning=rw("warning"),mi.warn=mi.warning,mi.dark=(r,o)=>O0(r,Ob("default",{theme:"dark",...o})),mi.dismiss=r=>{xf.size>0?Pa.emit(1,r):_0=_0.filter(o=>r!=null&&o.options.toastId!==r)},mi.clearWaitingQueue=function(r){return r===void 0&&(r={}),Pa.emit(5,r)},mi.isActive=r=>{let o=!1;return xf.forEach(a=>{a.isToastActive&&a.isToastActive(r)&&(o=!0)}),o},mi.update=function(r,o){o===void 0&&(o={}),setTimeout(()=>{const a=function(c,p){let{containerId:_}=p;const x=xf.get(_||xT);return x&&x.getToast(c)}(r,o);if(a){const{props:c,content:p}=a,_={delay:100,...c,...o,toastId:o.toastId||r,updateId:aF()};_.toastId!==r&&(_.staleId=r);const x=_.render||p;delete _.render,O0(x,_)}},0)},mi.done=r=>{mi.update(r,{progress:1})},mi.onChange=r=>(Pa.on(4,r),()=>{Pa.off(4,r)}),mi.POSITION={TOP_LEFT:"top-left",TOP_RIGHT:"top-right",TOP_CENTER:"top-center",BOTTOM_LEFT:"bottom-left",BOTTOM_RIGHT:"bottom-right",BOTTOM_CENTER:"bottom-center"},mi.TYPE={INFO:"info",SUCCESS:"success",WARNING:"warning",ERROR:"error",DEFAULT:"default"},Pa.on(2,r=>{xT=r.containerId||r,xf.set(xT,r),_0.forEach(o=>{Pa.emit(0,o.content,o.options)}),_0=[]}).on(3,r=>{xf.delete(r.containerId||r),xf.size===0&&Pa.off(0).off(1).off(5)});let jW=0;function lF(r,o){const a=`atom${++jW}`,c={toString:()=>a};return typeof r=="function"?c.read=r:(c.init=r,c.read=p=>p(c),c.write=(p,_,x)=>_(c,typeof x=="function"?x(p(c)):x)),o&&(c.write=o),c}const UL=r=>"init"in r,VL=r=>!!r.write,zb=new WeakMap,UW=(r,o)=>{zb.set(r,o),r.catch(()=>{}).finally(()=>zb.delete(r))},$L=(r,o)=>{const a=zb.get(r);a&&(zb.delete(r),a(o))},GL=(r,o)=>{r.status="fulfilled",r.value=o},HL=(r,o)=>{r.status="rejected",r.reason=o},VW=r=>typeof(r==null?void 0:r.then)=="function",iw=(r,o)=>"v"in r&&"v"in o&&Object.is(r.v,o.v),qL=(r,o)=>"e"in r&&"e"in o&&Object.is(r.e,o.e),r0=r=>"v"in r&&r.v instanceof Promise,$W=(r,o)=>"v"in r&&"v"in o&&r.v.orig&&r.v.orig===o.v.orig,ow=r=>{if("e"in r)throw r.e;return r.v},GW=()=>{const r=new WeakMap,o=new WeakMap,a=new Map;let c,p;const _=se=>r.get(se),x=(se,q)=>{const Se=r.get(se);if(r.set(se,q),a.has(se)||a.set(se,Se),Se&&r0(Se)){const ze="v"in q?q.v instanceof Promise?q.v:Promise.resolve(q.v):Promise.reject(q.e);$L(Se.v,ze)}},T=(se,q,Se)=>{const ze=new Map;let Ue=!1;Se.forEach((Be,rt)=>{!Be&&rt===se&&(Be=q),Be&&(ze.set(rt,Be),q.d.get(rt)!==Be&&(Ue=!0))}),(Ue||q.d.size!==ze.size)&&(q.d=ze)},C=(se,q,Se)=>{const ze=_(se),Ue={d:(ze==null?void 0:ze.d)||new Map,v:q};if(Se&&T(se,Ue,Se),ze&&iw(ze,Ue)&&ze.d===Ue.d)return ze;if(ze&&r0(ze)&&r0(Ue)&&$W(ze,Ue)){if(ze.d===Ue.d)return ze;Ue.v=ze.v}return x(se,Ue),Ue},P=(se,q,Se,ze)=>{if(VW(q)){let Ue;const Be=new Promise((rt,_t)=>{let zt=!1;q.then(dt=>{if(!zt){zt=!0;const Te=_(se),we=C(se,Be,Se);GL(Be,dt),rt(dt),o.has(se)&&(Te==null?void 0:Te.d)!==we.d&&me(se,we,Te==null?void 0:Te.d)}},dt=>{if(!zt){zt=!0;const Te=_(se),we=C(se,Be,Se);HL(Be,dt),_t(dt),o.has(se)&&(Te==null?void 0:Te.d)!==we.d&&me(se,we,Te==null?void 0:Te.d)}}),Ue=dt=>{zt||(zt=!0,dt.then(Te=>GL(Be,Te),Te=>HL(Be,Te)),rt(dt))}});return Be.orig=q,Be.status="pending",UW(Be,rt=>{rt&&Ue(rt),ze==null||ze()}),C(se,Be,Se)}return C(se,q,Se)},O=(se,q,Se)=>{const ze=_(se),Ue={d:(ze==null?void 0:ze.d)||new Map,e:q};return Se&&T(se,Ue,Se),ze&&qL(ze,Ue)&&ze.d===Ue.d?ze:(x(se,Ue),Ue)},F=(se,q)=>{const Se=_(se);if(!q&&Se&&(o.has(se)||Array.from(Se.d).every(([dt,Te])=>dt===se||F(dt)===Te)))return Se;const ze=new Map;let Ue=!0;const Be=dt=>{if(dt===se){const we=_(dt);if(we)return ze.set(dt,we),ow(we);if(UL(dt))return ze.set(dt,void 0),dt.init;throw new Error("no atom init")}const Te=F(dt);return ze.set(dt,Te),ow(Te)};let rt,_t;const zt={get signal(){return rt||(rt=new AbortController),rt.signal},get setSelf(){return!_t&&VL(se)&&(_t=(...dt)=>{if(!Ue)return G(se,...dt)}),_t}};try{const dt=se.read(Be,zt);return P(se,dt,ze,()=>rt==null?void 0:rt.abort())}catch(dt){return O(se,dt,ze)}finally{Ue=!1}},U=se=>ow(F(se)),Z=se=>{let q=o.get(se);return q||(q=ee(se)),q},$=(se,q)=>!q.l.size&&(!q.t.size||q.t.size===1&&q.t.has(se)),K=se=>{const q=o.get(se);q&&$(se,q)&&W(se)},ie=se=>{if(!se.size)return;const q=new Map,Se=new WeakMap,ze=Be=>{const rt=o.get(Be);rt==null||rt.t.forEach(_t=>{_t!==Be&&(q.set(_t,(q.get(_t)||new Set).add(Be)),Se.set(_t,(Se.get(_t)||0)+1),ze(_t))})};se.forEach(ze);const Ue=Be=>{const rt=o.get(Be);rt==null||rt.t.forEach(_t=>{var zt;if(_t!==Be){let dt=Se.get(_t);if(dt&&Se.set(_t,--dt),!dt){let Te=!!((zt=q.get(_t))!=null&&zt.size);if(Te){const we=_(_t),Q=F(_t,!0);Te=!we||!iw(we,Q)}Te||q.forEach(we=>we.delete(_t))}Ue(_t)}})};se.forEach(Ue),se.clear()},H=(se,q,...Se)=>{let ze=!0;const Ue=_t=>ow(F(_t)),Be=(_t,...zt)=>{let dt;if(_t===q){if(!UL(_t))throw new Error("atom not writable");const Te=_(_t),we=P(_t,zt[0]);(!Te||!iw(Te,we))&&se.add(_t)}else dt=H(se,_t,...zt);if(!ze){ie(se);const Te=de()}return dt},rt=q.write(Ue,Be,...Se);return ze=!1,rt},G=(se,...q)=>{const Se=new Set,ze=H(Se,se,...q);ie(Se);const Ue=de();return ze},ee=(se,q,Se)=>{var ze;const Ue=Se||[];(ze=_(se))==null||ze.d.forEach((rt,_t)=>{const zt=o.get(_t);zt?zt.t.add(se):_t!==se&&ee(_t,se,Ue)}),F(se);const Be={t:new Set(q&&[q]),l:new Set};if(o.set(se,Be),VL(se)&&se.onMount){const{onMount:rt}=se;Ue.push(()=>{const _t=rt((...zt)=>G(se,...zt));_t&&(Be.u=_t)})}return Se||Ue.forEach(rt=>rt()),Be},W=se=>{var q;const Se=(q=o.get(se))==null?void 0:q.u;Se&&Se(),o.delete(se);const ze=_(se);ze&&(r0(ze)&&$L(ze.v),ze.d.forEach((Ue,Be)=>{if(Be!==se){const rt=o.get(Be);rt&&(rt.t.delete(se),$(Be,rt)&&W(Be))}}))},me=(se,q,Se)=>{const ze=new Set(q.d.keys());Se==null||Se.forEach((Ue,Be)=>{if(ze.has(Be)){ze.delete(Be);return}const rt=o.get(Be);rt&&(rt.t.delete(se),$(Be,rt)&&W(Be))}),ze.forEach(Ue=>{const Be=o.get(Ue);Be?Be.t.add(se):o.has(se)&&ee(Ue,se)})},de=()=>{let se;for(;a.size;){const q=Array.from(a);a.clear(),q.forEach(([Se,ze])=>{const Ue=_(Se);if(Ue){const Be=o.get(Se);Be&&Ue.d!==(ze==null?void 0:ze.d)&&me(Se,Ue,ze==null?void 0:ze.d),Be&&!(ze&&!r0(ze)&&(iw(ze,Ue)||qL(ze,Ue)))&&Be.l.forEach(rt=>rt())}})}};return{get:U,set:G,sub:(se,q)=>{const Se=Z(se),ze=de(),Ue=Se.l;return Ue.add(q),()=>{Ue.delete(q),K(se)}}}};let wT;const HW=()=>(wT||(wT=GW()),wT),qW=_e.createContext(void 0),uF=r=>{const o=_e.useContext(qW);return(r==null?void 0:r.store)||o||HW()},WW=r=>typeof(r==null?void 0:r.then)=="function",ZW=Xn.use||(r=>{if(r.status==="pending")throw r;if(r.status==="fulfilled")return r.value;throw r.status==="rejected"?r.reason:(r.status="pending",r.then(o=>{r.status="fulfilled",r.value=o},o=>{r.status="rejected",r.reason=o}),r)});function XW(r,o){const a=uF(o),[[c,p,_],x]=_e.useReducer(P=>{const O=a.get(r);return Object.is(P[0],O)&&P[1]===a&&P[2]===r?P:[O,a,r]},void 0,()=>[a.get(r),a,r]);let T=c;(p!==a||_!==r)&&(x(),T=a.get(r));const C=o==null?void 0:o.delay;return _e.useEffect(()=>{const P=a.sub(r,()=>{if(typeof C=="number"){setTimeout(x,C);return}x()});return x(),P},[a,r,C]),_e.useDebugValue(T),WW(T)?ZW(T):T}function KW(r,o){const a=uF(o);return _e.useCallback((...p)=>a.set(r,...p),[a,r])}function CM(r,o){return[XW(r,o),KW(r,o)]}lF(null);const AM=lF(null),YW=()=>{const[r,o]=CM(AM),[a,c]=_e.useState();return _e.useEffect(()=>(navigator.geolocation.getCurrentPosition(p=>{console.log("watchId",p),o(p)},p=>c(p),{enableHighAccuracy:!0,maximumAge:1e3}),()=>{}),[o]),{location:r,error:a}},dn={primary:"#6EAA2D",secondary:"#276800",black:"#333333",white:"#FFFFFF",background:"#C7E9C0",threat:"#D43A18",threatBg:"#FFC1B4",caution:"#FFCC00",cautionBg:"#F4C200",cautionLightBg:"#FFE57E",cautionText:"#856A00",deselected:"#ECECEC",secondaryText:"#888888",police:"#0076A9"},QW=({})=>(YW(),ci(CW,{theme:{...dn},children:[st(xq,{}),st(GC,{})]})),JW=r=>{const o=r.location.match(/POINT\((\d+\.\d+) (\d+\.\d+)\)/);if(!o)throw new Error(`Invalid location: ${r.location}`);const[,a,c]=o;return{...r,location:{latitude:parseFloat(c),longitude:parseFloat(a)},acc:r.acc.map(p=>Number(p.trim())),detectedAt:new Date(r.detectedAt)}};function cF(r,o){return function(){return r.apply(o,arguments)}}const{toString:eZ}=Object.prototype,{getPrototypeOf:MM}=Object,k2=(r=>o=>{const a=eZ.call(o);return r[a]||(r[a]=a.slice(8,-1).toLowerCase())})(Object.create(null)),_u=r=>(r=r.toLowerCase(),o=>k2(o)===r),P2=r=>o=>typeof o===r,{isArray:Wg}=Array,fv=P2("undefined");function tZ(r){return r!==null&&!fv(r)&&r.constructor!==null&&!fv(r.constructor)&&za(r.constructor.isBuffer)&&r.constructor.isBuffer(r)}const hF=_u("ArrayBuffer");function nZ(r){let o;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?o=ArrayBuffer.isView(r):o=r&&r.buffer&&hF(r.buffer),o}const rZ=P2("string"),za=P2("function"),dF=P2("number"),R2=r=>r!==null&&typeof r=="object",iZ=r=>r===!0||r===!1,Nw=r=>{if(k2(r)!=="object")return!1;const o=MM(r);return(o===null||o===Object.prototype||Object.getPrototypeOf(o)===null)&&!(Symbol.toStringTag in r)&&!(Symbol.iterator in r)},oZ=_u("Date"),sZ=_u("File"),aZ=_u("Blob"),lZ=_u("FileList"),uZ=r=>R2(r)&&za(r.pipe),cZ=r=>{let o;return r&&(typeof FormData=="function"&&r instanceof FormData||za(r.append)&&((o=k2(r))==="formdata"||o==="object"&&za(r.toString)&&r.toString()==="[object FormData]"))},hZ=_u("URLSearchParams"),dZ=r=>r.trim?r.trim():r.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Av(r,o,{allOwnKeys:a=!1}={}){if(r===null||typeof r>"u")return;let c,p;if(typeof r!="object"&&(r=[r]),Wg(r))for(c=0,p=r.length;c<p;c++)o.call(null,r[c],c,r);else{const _=a?Object.getOwnPropertyNames(r):Object.keys(r),x=_.length;let T;for(c=0;c<x;c++)T=_[c],o.call(null,r[T],T,r)}}function fF(r,o){o=o.toLowerCase();const a=Object.keys(r);let c=a.length,p;for(;c-- >0;)if(p=a[c],o===p.toLowerCase())return p;return null}const pF=(()=>typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global)(),mF=r=>!fv(r)&&r!==pF;function HC(){const{caseless:r}=mF(this)&&this||{},o={},a=(c,p)=>{const _=r&&fF(o,p)||p;Nw(o[_])&&Nw(c)?o[_]=HC(o[_],c):Nw(c)?o[_]=HC({},c):Wg(c)?o[_]=c.slice():o[_]=c};for(let c=0,p=arguments.length;c<p;c++)arguments[c]&&Av(arguments[c],a);return o}const fZ=(r,o,a,{allOwnKeys:c}={})=>(Av(o,(p,_)=>{a&&za(p)?r[_]=cF(p,a):r[_]=p},{allOwnKeys:c}),r),pZ=r=>(r.charCodeAt(0)===65279&&(r=r.slice(1)),r),mZ=(r,o,a,c)=>{r.prototype=Object.create(o.prototype,c),r.prototype.constructor=r,Object.defineProperty(r,"super",{value:o.prototype}),a&&Object.assign(r.prototype,a)},gZ=(r,o,a,c)=>{let p,_,x;const T={};if(o=o||{},r==null)return o;do{for(p=Object.getOwnPropertyNames(r),_=p.length;_-- >0;)x=p[_],(!c||c(x,r,o))&&!T[x]&&(o[x]=r[x],T[x]=!0);r=a!==!1&&MM(r)}while(r&&(!a||a(r,o))&&r!==Object.prototype);return o},yZ=(r,o,a)=>{r=String(r),(a===void 0||a>r.length)&&(a=r.length),a-=o.length;const c=r.indexOf(o,a);return c!==-1&&c===a},_Z=r=>{if(!r)return null;if(Wg(r))return r;let o=r.length;if(!dF(o))return null;const a=new Array(o);for(;o-- >0;)a[o]=r[o];return a},vZ=(r=>o=>r&&o instanceof r)(typeof Uint8Array<"u"&&MM(Uint8Array)),xZ=(r,o)=>{const c=(r&&r[Symbol.iterator]).call(r);let p;for(;(p=c.next())&&!p.done;){const _=p.value;o.call(r,_[0],_[1])}},wZ=(r,o)=>{let a;const c=[];for(;(a=r.exec(o))!==null;)c.push(a);return c},bZ=_u("HTMLFormElement"),SZ=r=>r.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(a,c,p){return c.toUpperCase()+p}),WL=(({hasOwnProperty:r})=>(o,a)=>r.call(o,a))(Object.prototype),EZ=_u("RegExp"),gF=(r,o)=>{const a=Object.getOwnPropertyDescriptors(r),c={};Av(a,(p,_)=>{let x;(x=o(p,_,r))!==!1&&(c[_]=x||p)}),Object.defineProperties(r,c)},TZ=r=>{gF(r,(o,a)=>{if(za(r)&&["arguments","caller","callee"].indexOf(a)!==-1)return!1;const c=r[a];if(za(c)){if(o.enumerable=!1,"writable"in o){o.writable=!1;return}o.set||(o.set=()=>{throw Error("Can not rewrite read-only method '"+a+"'")})}})},CZ=(r,o)=>{const a={},c=p=>{p.forEach(_=>{a[_]=!0})};return Wg(r)?c(r):c(String(r).split(o)),a},AZ=()=>{},MZ=(r,o)=>(r=+r,Number.isFinite(r)?r:o),bT="abcdefghijklmnopqrstuvwxyz",ZL="0123456789",yF={DIGIT:ZL,ALPHA:bT,ALPHA_DIGIT:bT+bT.toUpperCase()+ZL},IZ=(r=16,o=yF.ALPHA_DIGIT)=>{let a="";const{length:c}=o;for(;r--;)a+=o[Math.random()*c|0];return a};function kZ(r){return!!(r&&za(r.append)&&r[Symbol.toStringTag]==="FormData"&&r[Symbol.iterator])}const PZ=r=>{const o=new Array(10),a=(c,p)=>{if(R2(c)){if(o.indexOf(c)>=0)return;if(!("toJSON"in c)){o[p]=c;const _=Wg(c)?[]:{};return Av(c,(x,T)=>{const C=a(x,p+1);!fv(C)&&(_[T]=C)}),o[p]=void 0,_}}return c};return a(r,0)},RZ=_u("AsyncFunction"),DZ=r=>r&&(R2(r)||za(r))&&za(r.then)&&za(r.catch),vt={isArray:Wg,isArrayBuffer:hF,isBuffer:tZ,isFormData:cZ,isArrayBufferView:nZ,isString:rZ,isNumber:dF,isBoolean:iZ,isObject:R2,isPlainObject:Nw,isUndefined:fv,isDate:oZ,isFile:sZ,isBlob:aZ,isRegExp:EZ,isFunction:za,isStream:uZ,isURLSearchParams:hZ,isTypedArray:vZ,isFileList:lZ,forEach:Av,merge:HC,extend:fZ,trim:dZ,stripBOM:pZ,inherits:mZ,toFlatObject:gZ,kindOf:k2,kindOfTest:_u,endsWith:yZ,toArray:_Z,forEachEntry:xZ,matchAll:wZ,isHTMLForm:bZ,hasOwnProperty:WL,hasOwnProp:WL,reduceDescriptors:gF,freezeMethods:TZ,toObjectSet:CZ,toCamelCase:SZ,noop:AZ,toFiniteNumber:MZ,findKey:fF,global:pF,isContextDefined:mF,ALPHABET:yF,generateString:IZ,isSpecCompliantForm:kZ,toJSONObject:PZ,isAsyncFn:RZ,isThenable:DZ};function kr(r,o,a,c,p){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=r,this.name="AxiosError",o&&(this.code=o),a&&(this.config=a),c&&(this.request=c),p&&(this.response=p)}vt.inherits(kr,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:vt.toJSONObject(this.config),code:this.code,status:this.response&&this.response.status?this.response.status:null}}});const _F=kr.prototype,vF={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(r=>{vF[r]={value:r}});Object.defineProperties(kr,vF);Object.defineProperty(_F,"isAxiosError",{value:!0});kr.from=(r,o,a,c,p,_)=>{const x=Object.create(_F);return vt.toFlatObject(r,x,function(C){return C!==Error.prototype},T=>T!=="isAxiosError"),kr.call(x,r.message,o,a,c,p),x.cause=r,x.name=r.name,_&&Object.assign(x,_),x};const LZ=null;function qC(r){return vt.isPlainObject(r)||vt.isArray(r)}function xF(r){return vt.endsWith(r,"[]")?r.slice(0,-2):r}function XL(r,o,a){return r?r.concat(o).map(function(p,_){return p=xF(p),!a&&_?"["+p+"]":p}).join(a?".":""):o}function OZ(r){return vt.isArray(r)&&!r.some(qC)}const zZ=vt.toFlatObject(vt,{},null,function(o){return/^is[A-Z]/.test(o)});function D2(r,o,a){if(!vt.isObject(r))throw new TypeError("target must be an object");o=o||new FormData,a=vt.toFlatObject(a,{metaTokens:!0,dots:!1,indexes:!1},!1,function(K,ie){return!vt.isUndefined(ie[K])});const c=a.metaTokens,p=a.visitor||O,_=a.dots,x=a.indexes,C=(a.Blob||typeof Blob<"u"&&Blob)&&vt.isSpecCompliantForm(o);if(!vt.isFunction(p))throw new TypeError("visitor must be a function");function P($){if($===null)return"";if(vt.isDate($))return $.toISOString();if(!C&&vt.isBlob($))throw new kr("Blob is not supported. Use a Buffer instead.");return vt.isArrayBuffer($)||vt.isTypedArray($)?C&&typeof Blob=="function"?new Blob([$]):Buffer.from($):$}function O($,K,ie){let H=$;if($&&!ie&&typeof $=="object"){if(vt.endsWith(K,"{}"))K=c?K:K.slice(0,-2),$=JSON.stringify($);else if(vt.isArray($)&&OZ($)||(vt.isFileList($)||vt.endsWith(K,"[]"))&&(H=vt.toArray($)))return K=xF(K),H.forEach(function(ee,W){!(vt.isUndefined(ee)||ee===null)&&o.append(x===!0?XL([K],W,_):x===null?K:K+"[]",P(ee))}),!1}return qC($)?!0:(o.append(XL(ie,K,_),P($)),!1)}const F=[],U=Object.assign(zZ,{defaultVisitor:O,convertValue:P,isVisitable:qC});function Z($,K){if(!vt.isUndefined($)){if(F.indexOf($)!==-1)throw Error("Circular reference detected in "+K.join("."));F.push($),vt.forEach($,function(H,G){(!(vt.isUndefined(H)||H===null)&&p.call(o,H,vt.isString(G)?G.trim():G,K,U))===!0&&Z(H,K?K.concat(G):[G])}),F.pop()}}if(!vt.isObject(r))throw new TypeError("data must be an object");return Z(r),o}function KL(r){const o={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(r).replace(/[!'()~]|%20|%00/g,function(c){return o[c]})}function IM(r,o){this._pairs=[],r&&D2(r,this,o)}const wF=IM.prototype;wF.append=function(o,a){this._pairs.push([o,a])};wF.toString=function(o){const a=o?function(c){return o.call(this,c,KL)}:KL;return this._pairs.map(function(p){return a(p[0])+"="+a(p[1])},"").join("&")};function FZ(r){return encodeURIComponent(r).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function bF(r,o,a){if(!o)return r;const c=a&&a.encode||FZ,p=a&&a.serialize;let _;if(p?_=p(o,a):_=vt.isURLSearchParams(o)?o.toString():new IM(o,a).toString(c),_){const x=r.indexOf("#");x!==-1&&(r=r.slice(0,x)),r+=(r.indexOf("?")===-1?"?":"&")+_}return r}class BZ{constructor(){this.handlers=[]}use(o,a,c){return this.handlers.push({fulfilled:o,rejected:a,synchronous:c?c.synchronous:!1,runWhen:c?c.runWhen:null}),this.handlers.length-1}eject(o){this.handlers[o]&&(this.handlers[o]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(o){vt.forEach(this.handlers,function(c){c!==null&&o(c)})}}const YL=BZ,SF={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},NZ=typeof URLSearchParams<"u"?URLSearchParams:IM,jZ=typeof FormData<"u"?FormData:null,UZ=typeof Blob<"u"?Blob:null,VZ=(()=>{let r;return typeof navigator<"u"&&((r=navigator.product)==="ReactNative"||r==="NativeScript"||r==="NS")?!1:typeof window<"u"&&typeof document<"u"})(),$Z=(()=>typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function")(),Il={isBrowser:!0,classes:{URLSearchParams:NZ,FormData:jZ,Blob:UZ},isStandardBrowserEnv:VZ,isStandardBrowserWebWorkerEnv:$Z,protocols:["http","https","file","blob","url","data"]};function GZ(r,o){return D2(r,new Il.classes.URLSearchParams,Object.assign({visitor:function(a,c,p,_){return Il.isNode&&vt.isBuffer(a)?(this.append(c,a.toString("base64")),!1):_.defaultVisitor.apply(this,arguments)}},o))}function HZ(r){return vt.matchAll(/\w+|\[(\w*)]/g,r).map(o=>o[0]==="[]"?"":o[1]||o[0])}function qZ(r){const o={},a=Object.keys(r);let c;const p=a.length;let _;for(c=0;c<p;c++)_=a[c],o[_]=r[_];return o}function EF(r){function o(a,c,p,_){let x=a[_++];const T=Number.isFinite(+x),C=_>=a.length;return x=!x&&vt.isArray(p)?p.length:x,C?(vt.hasOwnProp(p,x)?p[x]=[p[x],c]:p[x]=c,!T):((!p[x]||!vt.isObject(p[x]))&&(p[x]=[]),o(a,c,p[x],_)&&vt.isArray(p[x])&&(p[x]=qZ(p[x])),!T)}if(vt.isFormData(r)&&vt.isFunction(r.entries)){const a={};return vt.forEachEntry(r,(c,p)=>{o(HZ(c),p,a,0)}),a}return null}function WZ(r,o,a){if(vt.isString(r))try{return(o||JSON.parse)(r),vt.trim(r)}catch(c){if(c.name!=="SyntaxError")throw c}return(a||JSON.stringify)(r)}const kM={transitional:SF,adapter:Il.isNode?"http":"xhr",transformRequest:[function(o,a){const c=a.getContentType()||"",p=c.indexOf("application/json")>-1,_=vt.isObject(o);if(_&&vt.isHTMLForm(o)&&(o=new FormData(o)),vt.isFormData(o))return p&&p?JSON.stringify(EF(o)):o;if(vt.isArrayBuffer(o)||vt.isBuffer(o)||vt.isStream(o)||vt.isFile(o)||vt.isBlob(o))return o;if(vt.isArrayBufferView(o))return o.buffer;if(vt.isURLSearchParams(o))return a.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),o.toString();let T;if(_){if(c.indexOf("application/x-www-form-urlencoded")>-1)return GZ(o,this.formSerializer).toString();if((T=vt.isFileList(o))||c.indexOf("multipart/form-data")>-1){const C=this.env&&this.env.FormData;return D2(T?{"files[]":o}:o,C&&new C,this.formSerializer)}}return _||p?(a.setContentType("application/json",!1),WZ(o)):o}],transformResponse:[function(o){const a=this.transitional||kM.transitional,c=a&&a.forcedJSONParsing,p=this.responseType==="json";if(o&&vt.isString(o)&&(c&&!this.responseType||p)){const x=!(a&&a.silentJSONParsing)&&p;try{return JSON.parse(o)}catch(T){if(x)throw T.name==="SyntaxError"?kr.from(T,kr.ERR_BAD_RESPONSE,this,null,this.response):T}}return o}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Il.classes.FormData,Blob:Il.classes.Blob},validateStatus:function(o){return o>=200&&o<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};vt.forEach(["delete","get","head","post","put","patch"],r=>{kM.headers[r]={}});const PM=kM,ZZ=vt.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),XZ=r=>{const o={};let a,c,p;return r&&r.split(`
`).forEach(function(x){p=x.indexOf(":"),a=x.substring(0,p).trim().toLowerCase(),c=x.substring(p+1).trim(),!(!a||o[a]&&ZZ[a])&&(a==="set-cookie"?o[a]?o[a].push(c):o[a]=[c]:o[a]=o[a]?o[a]+", "+c:c)}),o},QL=Symbol("internals");function i0(r){return r&&String(r).trim().toLowerCase()}function jw(r){return r===!1||r==null?r:vt.isArray(r)?r.map(jw):String(r)}function KZ(r){const o=Object.create(null),a=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let c;for(;c=a.exec(r);)o[c[1]]=c[2];return o}const YZ=r=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(r.trim());function ST(r,o,a,c,p){if(vt.isFunction(c))return c.call(this,o,a);if(p&&(o=a),!!vt.isString(o)){if(vt.isString(c))return o.indexOf(c)!==-1;if(vt.isRegExp(c))return c.test(o)}}function QZ(r){return r.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(o,a,c)=>a.toUpperCase()+c)}function JZ(r,o){const a=vt.toCamelCase(" "+o);["get","set","has"].forEach(c=>{Object.defineProperty(r,c+a,{value:function(p,_,x){return this[c].call(this,o,p,_,x)},configurable:!0})})}class L2{constructor(o){o&&this.set(o)}set(o,a,c){const p=this;function _(T,C,P){const O=i0(C);if(!O)throw new Error("header name must be a non-empty string");const F=vt.findKey(p,O);(!F||p[F]===void 0||P===!0||P===void 0&&p[F]!==!1)&&(p[F||C]=jw(T))}const x=(T,C)=>vt.forEach(T,(P,O)=>_(P,O,C));return vt.isPlainObject(o)||o instanceof this.constructor?x(o,a):vt.isString(o)&&(o=o.trim())&&!YZ(o)?x(XZ(o),a):o!=null&&_(a,o,c),this}get(o,a){if(o=i0(o),o){const c=vt.findKey(this,o);if(c){const p=this[c];if(!a)return p;if(a===!0)return KZ(p);if(vt.isFunction(a))return a.call(this,p,c);if(vt.isRegExp(a))return a.exec(p);throw new TypeError("parser must be boolean|regexp|function")}}}has(o,a){if(o=i0(o),o){const c=vt.findKey(this,o);return!!(c&&this[c]!==void 0&&(!a||ST(this,this[c],c,a)))}return!1}delete(o,a){const c=this;let p=!1;function _(x){if(x=i0(x),x){const T=vt.findKey(c,x);T&&(!a||ST(c,c[T],T,a))&&(delete c[T],p=!0)}}return vt.isArray(o)?o.forEach(_):_(o),p}clear(o){const a=Object.keys(this);let c=a.length,p=!1;for(;c--;){const _=a[c];(!o||ST(this,this[_],_,o,!0))&&(delete this[_],p=!0)}return p}normalize(o){const a=this,c={};return vt.forEach(this,(p,_)=>{const x=vt.findKey(c,_);if(x){a[x]=jw(p),delete a[_];return}const T=o?QZ(_):String(_).trim();T!==_&&delete a[_],a[T]=jw(p),c[T]=!0}),this}concat(...o){return this.constructor.concat(this,...o)}toJSON(o){const a=Object.create(null);return vt.forEach(this,(c,p)=>{c!=null&&c!==!1&&(a[p]=o&&vt.isArray(c)?c.join(", "):c)}),a}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([o,a])=>o+": "+a).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(o){return o instanceof this?o:new this(o)}static concat(o,...a){const c=new this(o);return a.forEach(p=>c.set(p)),c}static accessor(o){const c=(this[QL]=this[QL]={accessors:{}}).accessors,p=this.prototype;function _(x){const T=i0(x);c[T]||(JZ(p,x),c[T]=!0)}return vt.isArray(o)?o.forEach(_):_(o),this}}L2.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);vt.reduceDescriptors(L2.prototype,({value:r},o)=>{let a=o[0].toUpperCase()+o.slice(1);return{get:()=>r,set(c){this[a]=c}}});vt.freezeMethods(L2);const gc=L2;function ET(r,o){const a=this||PM,c=o||a,p=gc.from(c.headers);let _=c.data;return vt.forEach(r,function(T){_=T.call(a,_,p.normalize(),o?o.status:void 0)}),p.normalize(),_}function TF(r){return!!(r&&r.__CANCEL__)}function Mv(r,o,a){kr.call(this,r??"canceled",kr.ERR_CANCELED,o,a),this.name="CanceledError"}vt.inherits(Mv,kr,{__CANCEL__:!0});function eX(r,o,a){const c=a.config.validateStatus;!a.status||!c||c(a.status)?r(a):o(new kr("Request failed with status code "+a.status,[kr.ERR_BAD_REQUEST,kr.ERR_BAD_RESPONSE][Math.floor(a.status/100)-4],a.config,a.request,a))}const tX=Il.isStandardBrowserEnv?function(){return{write:function(a,c,p,_,x,T){const C=[];C.push(a+"="+encodeURIComponent(c)),vt.isNumber(p)&&C.push("expires="+new Date(p).toGMTString()),vt.isString(_)&&C.push("path="+_),vt.isString(x)&&C.push("domain="+x),T===!0&&C.push("secure"),document.cookie=C.join("; ")},read:function(a){const c=document.cookie.match(new RegExp("(^|;\\s*)("+a+")=([^;]*)"));return c?decodeURIComponent(c[3]):null},remove:function(a){this.write(a,"",Date.now()-864e5)}}}():function(){return{write:function(){},read:function(){return null},remove:function(){}}}();function nX(r){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(r)}function rX(r,o){return o?r.replace(/\/+$/,"")+"/"+o.replace(/^\/+/,""):r}function CF(r,o){return r&&!nX(o)?rX(r,o):o}const iX=Il.isStandardBrowserEnv?function(){const o=/(msie|trident)/i.test(navigator.userAgent),a=document.createElement("a");let c;function p(_){let x=_;return o&&(a.setAttribute("href",x),x=a.href),a.setAttribute("href",x),{href:a.href,protocol:a.protocol?a.protocol.replace(/:$/,""):"",host:a.host,search:a.search?a.search.replace(/^\?/,""):"",hash:a.hash?a.hash.replace(/^#/,""):"",hostname:a.hostname,port:a.port,pathname:a.pathname.charAt(0)==="/"?a.pathname:"/"+a.pathname}}return c=p(window.location.href),function(x){const T=vt.isString(x)?p(x):x;return T.protocol===c.protocol&&T.host===c.host}}():function(){return function(){return!0}}();function oX(r){const o=/^([-+\w]{1,25})(:?\/\/|:)/.exec(r);return o&&o[1]||""}function sX(r,o){r=r||10;const a=new Array(r),c=new Array(r);let p=0,_=0,x;return o=o!==void 0?o:1e3,function(C){const P=Date.now(),O=c[_];x||(x=P),a[p]=C,c[p]=P;let F=_,U=0;for(;F!==p;)U+=a[F++],F=F%r;if(p=(p+1)%r,p===_&&(_=(_+1)%r),P-x<o)return;const Z=O&&P-O;return Z?Math.round(U*1e3/Z):void 0}}function JL(r,o){let a=0;const c=sX(50,250);return p=>{const _=p.loaded,x=p.lengthComputable?p.total:void 0,T=_-a,C=c(T),P=_<=x;a=_;const O={loaded:_,total:x,progress:x?_/x:void 0,bytes:T,rate:C||void 0,estimated:C&&x&&P?(x-_)/C:void 0,event:p};O[o?"download":"upload"]=!0,r(O)}}const aX=typeof XMLHttpRequest<"u",lX=aX&&function(r){return new Promise(function(a,c){let p=r.data;const _=gc.from(r.headers).normalize(),x=r.responseType;let T;function C(){r.cancelToken&&r.cancelToken.unsubscribe(T),r.signal&&r.signal.removeEventListener("abort",T)}vt.isFormData(p)&&(Il.isStandardBrowserEnv||Il.isStandardBrowserWebWorkerEnv?_.setContentType(!1):_.setContentType("multipart/form-data;",!1));let P=new XMLHttpRequest;if(r.auth){const Z=r.auth.username||"",$=r.auth.password?unescape(encodeURIComponent(r.auth.password)):"";_.set("Authorization","Basic "+btoa(Z+":"+$))}const O=CF(r.baseURL,r.url);P.open(r.method.toUpperCase(),bF(O,r.params,r.paramsSerializer),!0),P.timeout=r.timeout;function F(){if(!P)return;const Z=gc.from("getAllResponseHeaders"in P&&P.getAllResponseHeaders()),K={data:!x||x==="text"||x==="json"?P.responseText:P.response,status:P.status,statusText:P.statusText,headers:Z,config:r,request:P};eX(function(H){a(H),C()},function(H){c(H),C()},K),P=null}if("onloadend"in P?P.onloadend=F:P.onreadystatechange=function(){!P||P.readyState!==4||P.status===0&&!(P.responseURL&&P.responseURL.indexOf("file:")===0)||setTimeout(F)},P.onabort=function(){P&&(c(new kr("Request aborted",kr.ECONNABORTED,r,P)),P=null)},P.onerror=function(){c(new kr("Network Error",kr.ERR_NETWORK,r,P)),P=null},P.ontimeout=function(){let $=r.timeout?"timeout of "+r.timeout+"ms exceeded":"timeout exceeded";const K=r.transitional||SF;r.timeoutErrorMessage&&($=r.timeoutErrorMessage),c(new kr($,K.clarifyTimeoutError?kr.ETIMEDOUT:kr.ECONNABORTED,r,P)),P=null},Il.isStandardBrowserEnv){const Z=(r.withCredentials||iX(O))&&r.xsrfCookieName&&tX.read(r.xsrfCookieName);Z&&_.set(r.xsrfHeaderName,Z)}p===void 0&&_.setContentType(null),"setRequestHeader"in P&&vt.forEach(_.toJSON(),function($,K){P.setRequestHeader(K,$)}),vt.isUndefined(r.withCredentials)||(P.withCredentials=!!r.withCredentials),x&&x!=="json"&&(P.responseType=r.responseType),typeof r.onDownloadProgress=="function"&&P.addEventListener("progress",JL(r.onDownloadProgress,!0)),typeof r.onUploadProgress=="function"&&P.upload&&P.upload.addEventListener("progress",JL(r.onUploadProgress)),(r.cancelToken||r.signal)&&(T=Z=>{P&&(c(!Z||Z.type?new Mv(null,r,P):Z),P.abort(),P=null)},r.cancelToken&&r.cancelToken.subscribe(T),r.signal&&(r.signal.aborted?T():r.signal.addEventListener("abort",T)));const U=oX(O);if(U&&Il.protocols.indexOf(U)===-1){c(new kr("Unsupported protocol "+U+":",kr.ERR_BAD_REQUEST,r));return}P.send(p||null)})},Uw={http:LZ,xhr:lX};vt.forEach(Uw,(r,o)=>{if(r){try{Object.defineProperty(r,"name",{value:o})}catch{}Object.defineProperty(r,"adapterName",{value:o})}});const AF={getAdapter:r=>{r=vt.isArray(r)?r:[r];const{length:o}=r;let a,c;for(let p=0;p<o&&(a=r[p],!(c=vt.isString(a)?Uw[a.toLowerCase()]:a));p++);if(!c)throw c===!1?new kr(`Adapter ${a} is not supported by the environment`,"ERR_NOT_SUPPORT"):new Error(vt.hasOwnProp(Uw,a)?`Adapter '${a}' is not available in the build`:`Unknown adapter '${a}'`);if(!vt.isFunction(c))throw new TypeError("adapter is not a function");return c},adapters:Uw};function TT(r){if(r.cancelToken&&r.cancelToken.throwIfRequested(),r.signal&&r.signal.aborted)throw new Mv(null,r)}function eO(r){return TT(r),r.headers=gc.from(r.headers),r.data=ET.call(r,r.transformRequest),["post","put","patch"].indexOf(r.method)!==-1&&r.headers.setContentType("application/x-www-form-urlencoded",!1),AF.getAdapter(r.adapter||PM.adapter)(r).then(function(c){return TT(r),c.data=ET.call(r,r.transformResponse,c),c.headers=gc.from(c.headers),c},function(c){return TF(c)||(TT(r),c&&c.response&&(c.response.data=ET.call(r,r.transformResponse,c.response),c.response.headers=gc.from(c.response.headers))),Promise.reject(c)})}const tO=r=>r instanceof gc?r.toJSON():r;function Bg(r,o){o=o||{};const a={};function c(P,O,F){return vt.isPlainObject(P)&&vt.isPlainObject(O)?vt.merge.call({caseless:F},P,O):vt.isPlainObject(O)?vt.merge({},O):vt.isArray(O)?O.slice():O}function p(P,O,F){if(vt.isUndefined(O)){if(!vt.isUndefined(P))return c(void 0,P,F)}else return c(P,O,F)}function _(P,O){if(!vt.isUndefined(O))return c(void 0,O)}function x(P,O){if(vt.isUndefined(O)){if(!vt.isUndefined(P))return c(void 0,P)}else return c(void 0,O)}function T(P,O,F){if(F in o)return c(P,O);if(F in r)return c(void 0,P)}const C={url:_,method:_,data:_,baseURL:x,transformRequest:x,transformResponse:x,paramsSerializer:x,timeout:x,timeoutMessage:x,withCredentials:x,adapter:x,responseType:x,xsrfCookieName:x,xsrfHeaderName:x,onUploadProgress:x,onDownloadProgress:x,decompress:x,maxContentLength:x,maxBodyLength:x,beforeRedirect:x,transport:x,httpAgent:x,httpsAgent:x,cancelToken:x,socketPath:x,responseEncoding:x,validateStatus:T,headers:(P,O)=>p(tO(P),tO(O),!0)};return vt.forEach(Object.keys(Object.assign({},r,o)),function(O){const F=C[O]||p,U=F(r[O],o[O],O);vt.isUndefined(U)&&F!==T||(a[O]=U)}),a}const MF="1.5.0",RM={};["object","boolean","number","function","string","symbol"].forEach((r,o)=>{RM[r]=function(c){return typeof c===r||"a"+(o<1?"n ":" ")+r}});const nO={};RM.transitional=function(o,a,c){function p(_,x){return"[Axios v"+MF+"] Transitional option '"+_+"'"+x+(c?". "+c:"")}return(_,x,T)=>{if(o===!1)throw new kr(p(x," has been removed"+(a?" in "+a:"")),kr.ERR_DEPRECATED);return a&&!nO[x]&&(nO[x]=!0,console.warn(p(x," has been deprecated since v"+a+" and will be removed in the near future"))),o?o(_,x,T):!0}};function uX(r,o,a){if(typeof r!="object")throw new kr("options must be an object",kr.ERR_BAD_OPTION_VALUE);const c=Object.keys(r);let p=c.length;for(;p-- >0;){const _=c[p],x=o[_];if(x){const T=r[_],C=T===void 0||x(T,_,r);if(C!==!0)throw new kr("option "+_+" must be "+C,kr.ERR_BAD_OPTION_VALUE);continue}if(a!==!0)throw new kr("Unknown option "+_,kr.ERR_BAD_OPTION)}}const WC={assertOptions:uX,validators:RM},Ph=WC.validators;class Fb{constructor(o){this.defaults=o,this.interceptors={request:new YL,response:new YL}}request(o,a){typeof o=="string"?(a=a||{},a.url=o):a=o||{},a=Bg(this.defaults,a);const{transitional:c,paramsSerializer:p,headers:_}=a;c!==void 0&&WC.assertOptions(c,{silentJSONParsing:Ph.transitional(Ph.boolean),forcedJSONParsing:Ph.transitional(Ph.boolean),clarifyTimeoutError:Ph.transitional(Ph.boolean)},!1),p!=null&&(vt.isFunction(p)?a.paramsSerializer={serialize:p}:WC.assertOptions(p,{encode:Ph.function,serialize:Ph.function},!0)),a.method=(a.method||this.defaults.method||"get").toLowerCase();let x=_&&vt.merge(_.common,_[a.method]);_&&vt.forEach(["delete","get","head","post","put","patch","common"],$=>{delete _[$]}),a.headers=gc.concat(x,_);const T=[];let C=!0;this.interceptors.request.forEach(function(K){typeof K.runWhen=="function"&&K.runWhen(a)===!1||(C=C&&K.synchronous,T.unshift(K.fulfilled,K.rejected))});const P=[];this.interceptors.response.forEach(function(K){P.push(K.fulfilled,K.rejected)});let O,F=0,U;if(!C){const $=[eO.bind(this),void 0];for($.unshift.apply($,T),$.push.apply($,P),U=$.length,O=Promise.resolve(a);F<U;)O=O.then($[F++],$[F++]);return O}U=T.length;let Z=a;for(F=0;F<U;){const $=T[F++],K=T[F++];try{Z=$(Z)}catch(ie){K.call(this,ie);break}}try{O=eO.call(this,Z)}catch($){return Promise.reject($)}for(F=0,U=P.length;F<U;)O=O.then(P[F++],P[F++]);return O}getUri(o){o=Bg(this.defaults,o);const a=CF(o.baseURL,o.url);return bF(a,o.params,o.paramsSerializer)}}vt.forEach(["delete","get","head","options"],function(o){Fb.prototype[o]=function(a,c){return this.request(Bg(c||{},{method:o,url:a,data:(c||{}).data}))}});vt.forEach(["post","put","patch"],function(o){function a(c){return function(_,x,T){return this.request(Bg(T||{},{method:o,headers:c?{"Content-Type":"multipart/form-data"}:{},url:_,data:x}))}}Fb.prototype[o]=a(),Fb.prototype[o+"Form"]=a(!0)});const Vw=Fb;class DM{constructor(o){if(typeof o!="function")throw new TypeError("executor must be a function.");let a;this.promise=new Promise(function(_){a=_});const c=this;this.promise.then(p=>{if(!c._listeners)return;let _=c._listeners.length;for(;_-- >0;)c._listeners[_](p);c._listeners=null}),this.promise.then=p=>{let _;const x=new Promise(T=>{c.subscribe(T),_=T}).then(p);return x.cancel=function(){c.unsubscribe(_)},x},o(function(_,x,T){c.reason||(c.reason=new Mv(_,x,T),a(c.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(o){if(this.reason){o(this.reason);return}this._listeners?this._listeners.push(o):this._listeners=[o]}unsubscribe(o){if(!this._listeners)return;const a=this._listeners.indexOf(o);a!==-1&&this._listeners.splice(a,1)}static source(){let o;return{token:new DM(function(p){o=p}),cancel:o}}}const cX=DM;function hX(r){return function(a){return r.apply(null,a)}}function dX(r){return vt.isObject(r)&&r.isAxiosError===!0}const ZC={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(ZC).forEach(([r,o])=>{ZC[o]=r});const fX=ZC;function IF(r){const o=new Vw(r),a=cF(Vw.prototype.request,o);return vt.extend(a,Vw.prototype,o,{allOwnKeys:!0}),vt.extend(a,o,null,{allOwnKeys:!0}),a.create=function(p){return IF(Bg(r,p))},a}const ao=IF(PM);ao.Axios=Vw;ao.CanceledError=Mv;ao.CancelToken=cX;ao.isCancel=TF;ao.VERSION=MF;ao.toFormData=D2;ao.AxiosError=kr;ao.Cancel=ao.CanceledError;ao.all=function(o){return Promise.all(o)};ao.spread=hX;ao.isAxiosError=dX;ao.mergeConfig=Bg;ao.AxiosHeaders=gc;ao.formToJSON=r=>EF(vt.isHTMLForm(r)?new FormData(r):r);ao.getAdapter=AF.getAdapter;ao.HttpStatusCode=fX;ao.default=ao;const pX=ao,O2=pX.create();O2.interceptors.request.use(r=>r,r=>Promise.reject(r));O2.interceptors.response.use(r=>r,r=>Promise.reject(r));const mX=async(r,o)=>await O2.get("https://61.252.59.44"+r,{params:o}),gX=async(r,o)=>await O2.post("https://61.252.59.44"+r,o),yX=async({queryKey:r})=>{const{data:o}=await mX("/threat");return o.map(a=>JW(a))},_X=async r=>{const{latitude:o,longitude:a,capturedAt:c,image:p}=r,_=new FormData,x=`(${a},${o})_${c.toISOString()}`,T=new File([p],x,{type:p.type});_.append("image",T);const{data:C}=await gX("/report",_);return C};const Yi=({})=>{},vX=({size:r="20px",color:o="white"})=>st("svg",{width:r,height:r,viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:st("g",{id:"Iconly/Bold/Danger",children:st("g",{id:"Danger",children:st("path",{id:"Danger_2",fillRule:"evenodd",clipRule:"evenodd",d:"M12.0643 3.70174L18.1216 14.2143C18.255 14.5281 18.3133 14.7833 18.3299 15.0484C18.3633 15.6677 18.1466 16.2696 17.7217 16.7329C17.2968 17.1945 16.7219 17.467 16.097 17.5H3.89905C3.64076 17.4843 3.38247 17.4257 3.14084 17.3349C1.93271 16.8477 1.34948 15.4769 1.84106 14.2887L7.94003 3.69431C8.14833 3.3219 8.46494 3.00068 8.85654 2.79424C9.98969 2.16585 11.4311 2.57872 12.0643 3.70174ZM10.7229 10.6298C10.7229 11.0261 10.398 11.3573 9.99802 11.3573C9.59809 11.3573 9.26481 11.0261 9.26481 10.6298V8.29373C9.26481 7.89654 9.59809 7.57533 9.99802 7.57533C10.398 7.57533 10.7229 7.89654 10.7229 8.29373V10.6298ZM9.99802 14.1813C9.59809 14.1813 9.26481 13.8502 9.26481 13.4547C9.26481 13.0575 9.59809 12.7272 9.99802 12.7272C10.398 12.7272 10.7229 13.05 10.7229 13.4456C10.7229 13.8502 10.398 14.1813 9.99802 14.1813Z",fill:o})})})}),xX=({size:r="20px",color:o=dn.secondary})=>st("svg",{width:r,height:r,viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:st("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M9.7734 18.2614C9.86569 18.3096 9.96888 18.3341 10.0721 18.3333C10.1753 18.3325 10.2776 18.3071 10.3707 18.2581L13.344 16.6687C14.1871 16.2193 14.8474 15.7167 15.3625 15.1316C16.4825 13.8568 17.0941 12.2298 17.0832 10.5522L17.0479 5.01831C17.0446 4.38092 16.6259 3.81217 16.0068 3.60542L10.4756 1.74963C10.1425 1.63686 9.7776 1.63931 9.45041 1.75535L3.94019 3.67733C3.32441 3.89225 2.91332 4.46508 2.91668 5.10329L2.95191 10.6331C2.96282 12.3132 3.59539 13.9328 4.73384 15.1945C5.25399 15.7715 5.92011 16.2667 6.77248 16.7088L9.7734 18.2614ZM8.9863 11.7574C9.11046 11.8767 9.27154 11.9356 9.43262 11.9339C9.5937 11.9331 9.75393 11.8727 9.87642 11.7517L13.1257 8.5484C13.3698 8.30734 13.3673 7.92 13.1206 7.6822C12.8731 7.44441 12.4746 7.44604 12.2305 7.68711L9.42339 10.454L8.27403 9.34923C8.02654 9.11143 7.62888 9.11389 7.3839 9.35495C7.13977 9.59602 7.14229 9.98335 7.38978 10.2212L8.9863 11.7574Z",fill:o})}),wX=({size:r="20px",color:o="white"})=>st("svg",{width:r,height:r,viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:st("g",{id:"Iconly/Bold/Shield Fail",children:st("g",{id:"Shield Fail",children:st("path",{id:"Shield Fail_2",fillRule:"evenodd",clipRule:"evenodd",d:"M16.0012 3.60722C16.6219 3.81151 17.0413 4.38434 17.0413 5.02173L17.0832 10.5531C17.0916 12.2283 16.4793 13.8544 15.3554 15.13C14.8438 15.7184 14.1812 16.2169 13.3424 16.6663L10.3649 18.2598C10.2726 18.3088 10.172 18.3333 10.0714 18.3333C9.9707 18.3333 9.86167 18.3088 9.76941 18.2598L6.76673 16.7072C5.91961 16.2659 5.25701 15.7756 4.73699 15.1954C3.59631 13.937 2.95887 12.3108 2.95048 10.6356L2.91693 5.10263C2.90855 4.46524 3.32791 3.89404 3.94019 3.68076L9.45069 1.75307C9.77779 1.63785 10.1385 1.63785 10.4739 1.75307L16.0012 3.60722ZM12.0172 11.7388C12.2605 11.5018 12.2605 11.1096 12.0172 10.8726L10.8849 9.76863L12.0172 8.66628C12.2605 8.4293 12.2605 8.04523 12.0172 7.79927C11.774 7.56229 11.3714 7.56229 11.1282 7.79927L9.99587 8.90325L8.86357 7.79927C8.62034 7.56229 8.22613 7.56229 7.97451 7.79927C7.73128 8.04523 7.73128 8.4293 7.97451 8.66628L9.10681 9.76863L7.97451 10.8726C7.73128 11.1096 7.73128 11.5018 7.97451 11.7388C8.10032 11.8614 8.25968 11.9178 8.41904 11.9178C8.58679 11.9178 8.74615 11.8614 8.86357 11.7388L9.99587 10.6356L11.1282 11.7388C11.254 11.8614 11.4133 11.9178 11.5727 11.9178C11.732 11.9178 11.8998 11.8614 12.0172 11.7388Z",fill:o})})})}),bX=({size:r="44px",color:o="white"})=>st("svg",{width:r,height:r,viewBox:"0 0 44 44",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:st("g",{id:"Iconly/Bold/Camera",children:st("g",{id:"Camera",children:st("path",{id:"Camera_2",fillRule:"evenodd",clipRule:"evenodd",d:"M31.9734 11.4334C32.0467 11.5616 32.175 11.6532 32.34 11.6532C36.74 11.6532 40.3334 15.2425 40.3334 19.6376V30.5155C40.3334 34.9107 36.74 38.5 32.34 38.5H11.66C7.24169 38.5 3.66669 34.9107 3.66669 30.5155V19.6376C3.66669 15.2425 7.24169 11.6532 11.66 11.6532C11.8067 11.6532 11.9534 11.5799 12.0084 11.4334L12.1184 11.2137C12.1816 11.0806 12.2464 10.9439 12.3123 10.8052C12.7813 9.81734 13.3002 8.72445 13.6217 8.08213C14.465 6.43396 15.895 5.51831 17.6734 5.5H26.3084C28.0867 5.51831 29.535 6.43396 30.3784 8.08213C30.6671 8.65898 31.107 9.58816 31.531 10.4837C31.6185 10.6686 31.7053 10.852 31.79 11.0305L31.9734 11.4334ZM30.635 18.4656C30.635 19.3812 31.3684 20.1138 32.285 20.1138C33.2017 20.1138 33.9534 19.3812 33.9534 18.4656C33.9534 17.5499 33.2017 16.7991 32.285 16.7991C31.3684 16.7991 30.635 17.5499 30.635 18.4656ZM18.8284 21.3041C19.69 20.4434 20.8084 19.9856 22 19.9856C23.1917 19.9856 24.31 20.4434 25.1534 21.2858C25.9967 22.1282 26.455 23.2453 26.455 24.4356C26.4367 26.8896 24.4567 28.8857 22 28.8857C20.8084 28.8857 19.69 28.4279 18.8467 27.5855C18.0034 26.7431 17.545 25.626 17.545 24.4356V24.4173C17.5267 23.2636 17.985 22.1465 18.8284 21.3041ZM27.0784 29.5266C25.7767 30.8269 23.98 31.6326 22 31.6326C20.075 31.6326 18.2784 30.8818 16.9034 29.5266C15.5467 28.1532 14.795 26.3585 14.795 24.4356C14.7767 22.5311 15.5284 20.7364 16.885 19.3629C18.26 17.9895 20.075 17.2386 22 17.2386C23.925 17.2386 25.74 17.9895 27.0967 19.3446C28.4534 20.7181 29.205 22.5311 29.205 24.4356C29.1867 26.4317 28.38 28.2264 27.0784 29.5266Z",fill:o})})})}),SX=({size:r="20px",color:o=dn.primary})=>st("svg",{width:r,height:r,viewBox:"0 0 22 22",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:st("path",{d:"M11 7C8.79 7 7 8.79 7 11C7 13.21 8.79 15 11 15C13.21 15 15 13.21 15 11C15 8.79 13.21 7 11 7ZM19.94 10C19.48 5.83 16.17 2.52 12 2.06V0H10V2.06C5.83 2.52 2.52 5.83 2.06 10H0V12H2.06C2.52 16.17 5.83 19.48 10 19.94V22H12V19.94C16.17 19.48 19.48 16.17 19.94 12H22V10H19.94ZM11 18C7.13 18 4 14.87 4 11C4 7.13 7.13 4 11 4C14.87 4 18 7.13 18 11C18 14.87 14.87 18 11 18Z",fill:o})}),EX=()=>ci("svg",{width:"25",height:"39",viewBox:"0 0 25 39",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[st("circle",{cx:"12.5001",cy:"12.2955",r:"11.3636",fill:"#108ED5"}),st("path",{d:"M12.5 39L1.67469 15.9886L23.3253 15.9886L12.5 39Z",fill:"#108ED5"}),st("circle",{cx:"12.4999",cy:"12.2955",r:"5.68182",fill:"white"})]}),TX=({size:r="20px",color:o="#252525"})=>st("svg",{height:r,viewBox:"0 0 19 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:st("path",{d:"M12.3503 16L6.65028 10L12.3503 4",stroke:o})});Yi.Safe=xX;Yi.Caution=vX;Yi.Threat=wX;Yi.Camera=bX;Yi.Location=SX;Yi.MyLocation=EX;Yi.RightArrow=TX;var tr=(r=>(r.SAFE="SAFE",r.CAUTION="CAUTION",r.THREAT="THREAT",r.NONE="NONE",r))(tr||{}),CX=AX()?_e.useLayoutEffect:_e.useEffect;function AX(){return!!(typeof window<"u"&&window.document&&window.document.createElement)}function MX(){var r=_e.useState(Object.create(null)),o=r[1];return _e.useCallback(function(){o(Object.create(null))},[])}var IX=function(o){var a=o.children,c=o.type,p=c===void 0?"reach-portal":c,_=_e.useRef(null),x=_e.useRef(null),T=MX();return CX(function(){if(_.current){var C=_.current.ownerDocument;return x.current=C==null?void 0:C.createElement(p),C.body.appendChild(x.current),T(),function(){x.current&&x.current.ownerDocument&&x.current.ownerDocument.body.removeChild(x.current)}}},[p,T]),x.current?v5.createPortal(a,x.current):_e.createElement("span",{ref:_})};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Kt=function(){return Kt=Object.assign||function(o){for(var a,c=1,p=arguments.length;c<p;c++){a=arguments[c];for(var _ in a)Object.prototype.hasOwnProperty.call(a,_)&&(o[_]=a[_])}return o},Kt.apply(this,arguments)};function LM(r,o){var a={};for(var c in r)Object.prototype.hasOwnProperty.call(r,c)&&o.indexOf(c)<0&&(a[c]=r[c]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var p=0,c=Object.getOwnPropertySymbols(r);p<c.length;p++)o.indexOf(c[p])<0&&Object.prototype.propertyIsEnumerable.call(r,c[p])&&(a[c[p]]=r[c[p]]);return a}function Er(r){var o=typeof Symbol=="function"&&Symbol.iterator,a=o&&r[o],c=0;if(a)return a.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&c>=r.length&&(r=void 0),{value:r&&r[c++],done:!r}}};throw new TypeError(o?"Object is not iterable.":"Symbol.iterator is not defined.")}function Fr(r,o){var a=typeof Symbol=="function"&&r[Symbol.iterator];if(!a)return r;var c=a.call(r),p,_=[],x;try{for(;(o===void 0||o-- >0)&&!(p=c.next()).done;)_.push(p.value)}catch(T){x={error:T}}finally{try{p&&!p.done&&(a=c.return)&&a.call(c)}finally{if(x)throw x.error}}return _}function bi(r,o,a){if(a||arguments.length===2)for(var c=0,p=o.length,_;c<p;c++)(_||!(c in o))&&(_||(_=Array.prototype.slice.call(o,0,c)),_[c]=o[c]);return r.concat(_||Array.prototype.slice.call(o))}var ii;(function(r){r.Start="xstate.start",r.Stop="xstate.stop",r.Raise="xstate.raise",r.Send="xstate.send",r.Cancel="xstate.cancel",r.NullEvent="",r.Assign="xstate.assign",r.After="xstate.after",r.DoneState="done.state",r.DoneInvoke="done.invoke",r.Log="xstate.log",r.Init="xstate.init",r.Invoke="xstate.invoke",r.ErrorExecution="error.execution",r.ErrorCommunication="error.communication",r.ErrorPlatform="error.platform",r.ErrorCustom="xstate.error",r.Update="xstate.update",r.Pure="xstate.pure",r.Choose="xstate.choose"})(ii||(ii={}));var Ng;(function(r){r.Parent="#_parent",r.Internal="#_internal"})(Ng||(Ng={}));var XC=ii.Start,OM=ii.Stop,Iv=ii.Raise,z2=ii.Send,kF=ii.Cancel,kX=ii.NullEvent,zM=ii.Assign;ii.After;ii.DoneState;var PF=ii.Log,PX=ii.Init,KC=ii.Invoke;ii.ErrorExecution;var rO=ii.ErrorPlatform,RX=ii.ErrorCustom,RF=ii.Update,DX=ii.Choose,LX=ii.Pure,DF=".",iO={},YC="xstate.guard",OX="",sw;function FM(r,o,a){a===void 0&&(a=DF);var c=z0(r,a),p=z0(o,a);return Wr(p)?Wr(c)?p===c:!1:Wr(c)?c in p:Object.keys(c).every(function(_){return _ in p?FM(c[_],p[_]):!1})}function LF(r){try{return Wr(r)||typeof r=="number"?"".concat(r):r.type}catch{throw new Error("Events must be strings or objects with a string event.type property.")}}function QC(r,o){try{return Zg(r)?r:r.toString().split(o)}catch{throw new Error("'".concat(r,"' is not a valid state path."))}}function zX(r){return typeof r=="object"&&"value"in r&&"context"in r&&"event"in r&&"_event"in r}function z0(r,o){if(zX(r))return r.value;if(Zg(r))return Bb(r);if(typeof r!="string")return r;var a=QC(r,o);return Bb(a)}function Bb(r){if(r.length===1)return r[0];for(var o={},a=o,c=0;c<r.length-1;c++)c===r.length-2?a[r[c]]=r[c+1]:(a[r[c]]={},a=a[r[c]]);return o}function v0(r,o){for(var a={},c=Object.keys(r),p=0;p<c.length;p++){var _=c[p];a[_]=o(r[_],_,r,p)}return a}function oO(r,o,a){var c,p,_={};try{for(var x=Er(Object.keys(r)),T=x.next();!T.done;T=x.next()){var C=T.value,P=r[C];a(P)&&(_[C]=o(P,C,r))}}catch(O){c={error:O}}finally{try{T&&!T.done&&(p=x.return)&&p.call(x)}finally{if(c)throw c.error}}return _}var FX=function(r){return function(o){var a,c,p=o;try{for(var _=Er(r),x=_.next();!x.done;x=_.next()){var T=x.value;p=p[T]}}catch(C){a={error:C}}finally{try{x&&!x.done&&(c=_.return)&&c.call(_)}finally{if(a)throw a.error}}return p}};function BX(r,o){return function(a){var c,p,_=a;try{for(var x=Er(r),T=x.next();!T.done;T=x.next()){var C=T.value;_=_[o][C]}}catch(P){c={error:P}}finally{try{T&&!T.done&&(p=x.return)&&p.call(x)}finally{if(c)throw c.error}}return _}}function $w(r){if(!r)return[[]];if(Wr(r))return[[r]];var o=Li(Object.keys(r).map(function(a){var c=r[a];return typeof c!="string"&&(!c||!Object.keys(c).length)?[[a]]:$w(r[a]).map(function(p){return[a].concat(p)})}));return o}function Li(r){var o;return(o=[]).concat.apply(o,bi([],Fr(r),!1))}function OF(r){return Zg(r)?r:[r]}function Sl(r){return r===void 0?[]:OF(r)}function Nb(r,o,a){var c,p;if(Hr(r))return r(o,a.data);var _={};try{for(var x=Er(Object.keys(r)),T=x.next();!T.done;T=x.next()){var C=T.value,P=r[C];Hr(P)?_[C]=P(o,a.data):_[C]=P}}catch(O){c={error:O}}finally{try{T&&!T.done&&(p=x.return)&&p.call(x)}finally{if(c)throw c.error}}return _}function NX(r){return/^(done|error)\./.test(r)}function sO(r){return!!(r instanceof Promise||r!==null&&(Hr(r)||typeof r=="object")&&Hr(r.then))}function jX(r){return r!==null&&typeof r=="object"&&"transition"in r&&typeof r.transition=="function"}function UX(r,o){var a,c,p=Fr([[],[]],2),_=p[0],x=p[1];try{for(var T=Er(r),C=T.next();!C.done;C=T.next()){var P=C.value;o(P)?_.push(P):x.push(P)}}catch(O){a={error:O}}finally{try{C&&!C.done&&(c=T.return)&&c.call(T)}finally{if(a)throw a.error}}return[_,x]}function zF(r,o){return v0(r.states,function(a,c){if(a){var p=(Wr(o)?void 0:o[c])||(a?a.current:void 0);if(p)return{current:p,states:zF(a,p)}}})}function VX(r,o){return{current:o,states:zF(r,o)}}function aO(r,o,a,c){var p=r&&a.reduce(function(_,x){var T,C,P=x.assignment,O={state:c,action:x,_event:o},F={};if(Hr(P))F=P(_,o.data,O);else try{for(var U=Er(Object.keys(P)),Z=U.next();!Z.done;Z=U.next()){var $=Z.value,K=P[$];F[$]=Hr(K)?K(_,o.data,O):K}}catch(ie){T={error:ie}}finally{try{Z&&!Z.done&&(C=U.return)&&C.call(U)}finally{if(T)throw T.error}}return Object.assign({},_,F)},r);return p}var $X=function(){};function Zg(r){return Array.isArray(r)}function Hr(r){return typeof r=="function"}function Wr(r){return typeof r=="string"}function FF(r,o){if(r)return Wr(r)?{type:YC,name:r,predicate:o?o[r]:void 0}:Hr(r)?{type:YC,name:r.name,predicate:r}:r}function GX(r){try{return"subscribe"in r&&Hr(r.subscribe)}catch{return!1}}var Fh=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}();sw={},sw[Fh]=function(){return this},sw[Symbol.observable]=function(){return this};function jg(r){return!!r&&"__xstatenode"in r}function HX(r){return!!r&&typeof r.send=="function"}function F2(r,o){return Wr(r)||typeof r=="number"?Kt({type:r},o):r}function Uo(r,o){if(!Wr(r)&&"$$type"in r&&r.$$type==="scxml")return r;var a=F2(r);return Kt({name:a.type,data:a,$$type:"scxml",type:"external"},o)}function qm(r,o){var a=OF(o).map(function(c){return typeof c>"u"||typeof c=="string"||jg(c)?{target:c,event:r}:Kt(Kt({},c),{event:r})});return a}function qX(r){if(!(r===void 0||r===OX))return Sl(r)}function BF(r,o,a,c,p){var _=r.options.guards,x={state:p,cond:o,_event:c};if(o.type===YC)return((_==null?void 0:_[o.name])||o.predicate)(a,c.data,x);var T=_==null?void 0:_[o.type];if(!T)throw new Error("Guard '".concat(o.type,"' is not implemented on machine '").concat(r.id,"'."));return T(a,c.data,x)}function NF(r){return typeof r=="string"?{type:r}:r}function Gw(r,o,a){var c=function(){},p=typeof r=="object",_=p?r:null;return{next:((p?r.next:r)||c).bind(_),error:((p?r.error:o)||c).bind(_),complete:((p?r.complete:a)||c).bind(_)}}function aw(r,o){return"".concat(r,":invocation[").concat(o,"]")}function JC(r){return(r.type===Iv||r.type===z2&&r.to===Ng.Internal)&&typeof r.delay!="number"}var bg=Uo({type:PX});function eA(r,o){return o&&o[r]||void 0}function pv(r,o){var a;if(Wr(r)||typeof r=="number"){var c=eA(r,o);Hr(c)?a={type:r,exec:c}:c?a=c:a={type:r,exec:void 0}}else if(Hr(r))a={type:r.name||r.toString(),exec:r};else{var c=eA(r.type,o);if(Hr(c))a=Kt(Kt({},r),{exec:c});else if(c){var p=c.type||r.type;a=Kt(Kt(Kt({},c),r),{type:p})}else a=r}return a}var Bh=function(r,o){if(!r)return[];var a=Zg(r)?r:[r];return a.map(function(c){return pv(c,o)})};function BM(r){var o=pv(r);return Kt(Kt({id:Wr(r)?r:o.id},o),{type:o.type})}function WX(r,o){return{type:Iv,event:typeof r=="function"?r:F2(r),delay:o?o.delay:void 0,id:o==null?void 0:o.id}}function ZX(r,o,a,c){var p={_event:a},_=Uo(Hr(r.event)?r.event(o,a.data,p):r.event),x;if(Wr(r.delay)){var T=c&&c[r.delay];x=Hr(T)?T(o,a.data,p):T}else x=Hr(r.delay)?r.delay(o,a.data,p):r.delay;return Kt(Kt({},r),{type:Iv,_event:_,delay:x})}function XX(r,o){return{to:o?o.to:void 0,type:z2,event:Hr(r)?r:F2(r),delay:o?o.delay:void 0,id:o&&o.id!==void 0?o.id:Hr(r)?r.name:LF(r)}}function KX(r,o,a,c){var p={_event:a},_=Uo(Hr(r.event)?r.event(o,a.data,p):r.event),x;if(Wr(r.delay)){var T=c&&c[r.delay];x=Hr(T)?T(o,a.data,p):T}else x=Hr(r.delay)?r.delay(o,a.data,p):r.delay;var C=Hr(r.to)?r.to(o,a.data,p):r.to;return Kt(Kt({},r),{to:C,_event:_,event:_.data,delay:x})}var YX=function(r,o,a){return Kt(Kt({},r),{value:Wr(r.expr)?r.expr:r.expr(o,a.data,{_event:a})})},QX=function(r){return{type:kF,sendId:r}};function JX(r){var o=BM(r);return{type:ii.Start,activity:o,exec:void 0}}function eK(r){var o=Hr(r)?r:BM(r);return{type:ii.Stop,activity:o,exec:void 0}}function tK(r,o,a){var c=Hr(r.activity)?r.activity(o,a.data):r.activity,p=typeof c=="string"?{id:c}:c,_={type:ii.Stop,activity:p};return _}var nK=function(r){return{type:zM,assignment:r}};function rK(r,o){var a=o?"#".concat(o):"";return"".concat(ii.After,"(").concat(r,")").concat(a)}function lw(r,o){var a="".concat(ii.DoneState,".").concat(r),c={type:a,data:o};return c.toString=function(){return a},c}function Hw(r,o){var a="".concat(ii.DoneInvoke,".").concat(r),c={type:a,data:o};return c.toString=function(){return a},c}function x0(r,o){var a="".concat(ii.ErrorPlatform,".").concat(r),c={type:a,data:o};return c.toString=function(){return a},c}var iK=function(r){var o,a,c=[];try{for(var p=Er(r),_=p.next();!_.done;_=p.next())for(var x=_.value,T=0;T<x.actions.length;){if(x.actions[T].type===zM){c.push(x.actions[T]),x.actions.splice(T,1);continue}T++}}catch(C){o={error:C}}finally{try{_&&!_.done&&(a=p.return)&&a.call(p)}finally{if(o)throw o.error}}return c};function jb(r,o,a,c,p,_,x){x===void 0&&(x=!1);var T=x?[]:iK(p),C=T.length?aO(a,c,T,o):a,P=x?[a]:void 0,O=[];function F($,K){var ie;switch(K.type){case Iv:{var H=ZX(K,C,c,r.options.delays);return _&&typeof H.delay=="number"&&_(H,C,c),H}case z2:var G=KX(K,C,c,r.options.delays);return _&&G.to!==Ng.Internal&&($==="entry"?O.push(G):_(G,C,c)),G;case PF:{var ee=YX(K,C,c);return _==null||_(ee,C,c),ee}case DX:{var W=K,me=(ie=W.conds.find(function(zt){var dt=FF(zt.cond,r.options.guards);return!dt||BF(r,dt,C,c,_?void 0:o)}))===null||ie===void 0?void 0:ie.actions;if(!me)return[];var de=Fr(jb(r,o,C,c,[{type:$,actions:Bh(Sl(me),r.options.actions)}],_,x),2),he=de[0],se=de[1];return C=se,P==null||P.push(C),he}case LX:{var me=K.get(C,c.data);if(!me)return[];var q=Fr(jb(r,o,C,c,[{type:$,actions:Bh(Sl(me),r.options.actions)}],_,x),2),Se=q[0],ze=q[1];return C=ze,P==null||P.push(C),Se}case OM:{var ee=tK(K,C,c);return _==null||_(ee,a,c),ee}case zM:{C=aO(C,c,[K],_?void 0:o),P==null||P.push(C);break}default:var Ue=pv(K,r.options.actions),Be=Ue.exec;if(_)_(Ue,C,c);else if(Be&&P){var rt=P.length-1,_t=Kt(Kt({},Ue),{exec:function(zt){for(var dt=[],Te=1;Te<arguments.length;Te++)dt[Te-1]=arguments[Te];Be.apply(void 0,bi([P[rt]],Fr(dt),!1))}});Ue=_t}return Ue}}function U($){var K,ie,H=[];try{for(var G=Er($.actions),ee=G.next();!ee.done;ee=G.next()){var W=ee.value,me=F($.type,W);me&&(H=H.concat(me))}}catch(de){K={error:de}}finally{try{ee&&!ee.done&&(ie=G.return)&&ie.call(G)}finally{if(K)throw K.error}}return O.forEach(function(de){_(de,C,c)}),O.length=0,H}var Z=Li(p.map(U));return[Z,C]}var lO=[],Qm=function(r,o){lO.push(r);var a=o(r);return lO.pop(),a};function jF(r){var o;return o={id:r,send:function(){},subscribe:function(){return{unsubscribe:function(){}}},getSnapshot:function(){},toJSON:function(){return{id:r}}},o[Fh]=function(){return this},o}function oK(r,o,a,c){var p,_=NF(r.src),x=(p=o==null?void 0:o.options.services)===null||p===void 0?void 0:p[_.type],T=r.data?Nb(r.data,a,c):void 0,C=x?UF(x,r.id,T):jF(r.id);return C.meta=r,C}function UF(r,o,a){var c=jF(o);if(c.deferred=!0,jg(r)){var p=c.state=Qm(void 0,function(){return(a?r.withContext(a):r).initialState});c.getSnapshot=function(){return p}}return c}function sK(r){try{return typeof r.send=="function"}catch{return!1}}function aK(r){return sK(r)&&"id"in r}function lK(r){var o;return Kt((o={subscribe:function(){return{unsubscribe:function(){}}},id:"anonymous",getSnapshot:function(){}},o[Fh]=function(){return this},o),r)}var Ub=function(r){return r.type==="atomic"||r.type==="final"};function VF(r){return Object.keys(r.states).map(function(o){return r.states[o]})}function mv(r){return VF(r).filter(function(o){return o.type!=="history"})}function $F(r){var o=[r];return Ub(r)?o:o.concat(Li(mv(r).map($F)))}function w0(r,o){var a,c,p,_,x,T,C,P,O=new Set(r),F=tA(O),U=new Set(o);try{for(var Z=Er(U),$=Z.next();!$.done;$=Z.next())for(var K=$.value,ie=K.parent;ie&&!U.has(ie);)U.add(ie),ie=ie.parent}catch(q){a={error:q}}finally{try{$&&!$.done&&(c=Z.return)&&c.call(Z)}finally{if(a)throw a.error}}var H=tA(U);try{for(var G=Er(U),ee=G.next();!ee.done;ee=G.next()){var K=ee.value;if(K.type==="compound"&&(!H.get(K)||!H.get(K).length))F.get(K)?F.get(K).forEach(function(Se){return U.add(Se)}):K.initialStateNodes.forEach(function(Se){return U.add(Se)});else if(K.type==="parallel")try{for(var W=(x=void 0,Er(mv(K))),me=W.next();!me.done;me=W.next()){var de=me.value;U.has(de)||(U.add(de),F.get(de)?F.get(de).forEach(function(Se){return U.add(Se)}):de.initialStateNodes.forEach(function(Se){return U.add(Se)}))}}catch(Se){x={error:Se}}finally{try{me&&!me.done&&(T=W.return)&&T.call(W)}finally{if(x)throw x.error}}}}catch(q){p={error:q}}finally{try{ee&&!ee.done&&(_=G.return)&&_.call(G)}finally{if(p)throw p.error}}try{for(var he=Er(U),se=he.next();!se.done;se=he.next())for(var K=se.value,ie=K.parent;ie&&!U.has(ie);)U.add(ie),ie=ie.parent}catch(q){C={error:q}}finally{try{se&&!se.done&&(P=he.return)&&P.call(he)}finally{if(C)throw C.error}}return U}function GF(r,o){var a=o.get(r);if(!a)return{};if(r.type==="compound"){var c=a[0];if(c){if(Ub(c))return c.key}else return{}}var p={};return a.forEach(function(_){p[_.key]=GF(_,o)}),p}function tA(r){var o,a,c=new Map;try{for(var p=Er(r),_=p.next();!_.done;_=p.next()){var x=_.value;c.has(x)||c.set(x,[]),x.parent&&(c.has(x.parent)||c.set(x.parent,[]),c.get(x.parent).push(x))}}catch(T){o={error:T}}finally{try{_&&!_.done&&(a=p.return)&&a.call(p)}finally{if(o)throw o.error}}return c}function uK(r,o){var a=w0([r],o);return GF(r,tA(a))}function b0(r,o){return Array.isArray(r)?r.some(function(a){return a===o}):r instanceof Set?r.has(o):!1}function cK(r){return bi([],Fr(new Set(Li(bi([],Fr(r.map(function(o){return o.ownEvents})),!1)))),!1)}function qw(r,o){return o.type==="compound"?mv(o).some(function(a){return a.type==="final"&&b0(r,a)}):o.type==="parallel"?mv(o).every(function(a){return qw(r,a)}):!1}function hK(r){return r===void 0&&(r=[]),r.reduce(function(o,a){return a.meta!==void 0&&(o[a.id]=a.meta),o},{})}function uO(r){return new Set(Li(r.map(function(o){return o.tags})))}function HF(r,o){if(r===o)return!0;if(r===void 0||o===void 0)return!1;if(Wr(r)||Wr(o))return r===o;var a=Object.keys(r),c=Object.keys(o);return a.length===c.length&&a.every(function(p){return HF(r[p],o[p])})}function dK(r){return typeof r!="object"||r===null?!1:"value"in r&&"_event"in r}function fK(r,o){var a=r.exec,c=Kt(Kt({},r),{exec:a!==void 0?function(){return a(o.context,o.event,{action:r,state:o,_event:o._event})}:void 0});return c}var ka=function(){function r(o){var a=this,c;this.actions=[],this.activities=iO,this.meta={},this.events=[],this.value=o.value,this.context=o.context,this._event=o._event,this._sessionid=o._sessionid,this.event=this._event.data,this.historyValue=o.historyValue,this.history=o.history,this.actions=o.actions||[],this.activities=o.activities||iO,this.meta=hK(o.configuration),this.events=o.events||[],this.matches=this.matches.bind(this),this.toStrings=this.toStrings.bind(this),this.configuration=o.configuration,this.transitions=o.transitions,this.children=o.children,this.done=!!o.done,this.tags=(c=Array.isArray(o.tags)?new Set(o.tags):o.tags)!==null&&c!==void 0?c:new Set,this.machine=o.machine,Object.defineProperty(this,"nextEvents",{get:function(){return cK(a.configuration)}})}return r.from=function(o,a){if(o instanceof r)return o.context!==a?new r({value:o.value,context:a,_event:o._event,_sessionid:null,historyValue:o.historyValue,history:o.history,actions:[],activities:o.activities,meta:{},events:[],configuration:[],transitions:[],children:{}}):o;var c=bg;return new r({value:o,context:a,_event:c,_sessionid:null,historyValue:void 0,history:void 0,actions:[],activities:void 0,meta:void 0,events:[],configuration:[],transitions:[],children:{}})},r.create=function(o){return new r(o)},r.inert=function(o,a){if(o instanceof r){if(!o.actions.length)return o;var c=bg;return new r({value:o.value,context:a,_event:c,_sessionid:null,historyValue:o.historyValue,history:o.history,activities:o.activities,configuration:o.configuration,transitions:[],children:{}})}return r.from(o,a)},r.prototype.toStrings=function(o,a){var c=this;if(o===void 0&&(o=this.value),a===void 0&&(a="."),Wr(o))return[o];var p=Object.keys(o);return p.concat.apply(p,bi([],Fr(p.map(function(_){return c.toStrings(o[_],a).map(function(x){return _+a+x})})),!1))},r.prototype.toJSON=function(){var o=this;o.configuration,o.transitions;var a=o.tags;o.machine;var c=LM(o,["configuration","transitions","tags","machine"]);return Kt(Kt({},c),{tags:Array.from(a)})},r.prototype.matches=function(o){return FM(o,this.value)},r.prototype.hasTag=function(o){return this.tags.has(o)},r.prototype.can=function(o){var a;$X(!!this.machine);var c=(a=this.machine)===null||a===void 0?void 0:a.getTransitionData(this,o);return!!(c!=null&&c.transitions.length)&&c.transitions.some(function(p){return p.target!==void 0||p.actions.length})},r}(),pK={deferEvents:!1},cO=function(){function r(o){this.processingEvent=!1,this.queue=[],this.initialized=!1,this.options=Kt(Kt({},pK),o)}return r.prototype.initialize=function(o){if(this.initialized=!0,o){if(!this.options.deferEvents){this.schedule(o);return}this.process(o)}this.flushEvents()},r.prototype.schedule=function(o){if(!this.initialized||this.processingEvent){this.queue.push(o);return}if(this.queue.length!==0)throw new Error("Event queue should be empty when it is not processing events");this.process(o),this.flushEvents()},r.prototype.clear=function(){this.queue=[]},r.prototype.flushEvents=function(){for(var o=this.queue.shift();o;)this.process(o),o=this.queue.shift()},r.prototype.process=function(o){this.processingEvent=!0;try{o()}catch(a){throw this.clear(),a}finally{this.processingEvent=!1}},r}(),CT=new Map,mK=0,o0={bookId:function(){return"x:".concat(mK++)},register:function(r,o){return CT.set(r,o),r},get:function(r){return CT.get(r)},free:function(r){CT.delete(r)}};function NM(){if(typeof globalThis<"u")return globalThis;if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global}function gK(){var r=NM();if(r&&"__xstate__"in r)return r.__xstate__}function yK(r){if(NM()){var o=gK();o&&o.register(r)}}function _K(r,o){o===void 0&&(o={});var a=r.initialState,c=new Set,p=[],_=!1,x=function(){if(!_){for(_=!0;p.length>0;){var P=p.shift();a=r.transition(a,P,C),c.forEach(function(O){return O.next(a)})}_=!1}},T=lK({id:o.id,send:function(P){p.push(P),x()},getSnapshot:function(){return a},subscribe:function(P,O,F){var U=Gw(P,O,F);return c.add(U),U.next(a),{unsubscribe:function(){c.delete(U)}}}}),C={parent:o.parent,self:T,id:o.id||"anonymous",observers:c};return a=r.start?r.start(C):a,T}var vK={sync:!1,autoForward:!1},Ao;(function(r){r[r.NotStarted=0]="NotStarted",r[r.Running=1]="Running",r[r.Stopped=2]="Stopped"})(Ao||(Ao={}));var xK=function(){function r(o,a){a===void 0&&(a=r.defaultOptions);var c=this;this.machine=o,this.delayedEventsMap={},this.listeners=new Set,this.contextListeners=new Set,this.stopListeners=new Set,this.doneListeners=new Set,this.eventListeners=new Set,this.sendListeners=new Set,this.initialized=!1,this.status=Ao.NotStarted,this.children=new Map,this.forwardTo=new Set,this._outgoingQueue=[],this.init=this.start,this.send=function(O,F){if(Zg(O))return c.batch(O),c.state;var U=Uo(F2(O,F));if(c.status===Ao.Stopped)return c.state;if(c.status!==Ao.Running&&!c.options.deferEvents)throw new Error('Event "'.concat(U.name,'" was sent to uninitialized service "').concat(c.machine.id,`". Make sure .start() is called for this service, or set { deferEvents: true } in the service options.
Event: `).concat(JSON.stringify(U.data)));return c.scheduler.schedule(function(){c.forward(U);var Z=c._nextState(U);c.update(Z,U)}),c._state},this.sendTo=function(O,F,U){var Z=c.parent&&(F===Ng.Parent||c.parent.id===F),$=Z?c.parent:Wr(F)?F===Ng.Internal?c:c.children.get(F)||o0.get(F):HX(F)?F:void 0;if(!$){if(!Z)throw new Error("Unable to send event to child '".concat(F,"' from service '").concat(c.id,"'."));return}if("machine"in $){if(c.status!==Ao.Stopped||c.parent!==$||c.state.done){var K=Kt(Kt({},O),{name:O.name===RX?"".concat(x0(c.id)):O.name,origin:c.sessionId});!U&&c.machine.config.predictableActionArguments?c._outgoingQueue.push([$,K]):$.send(K)}}else!U&&c.machine.config.predictableActionArguments?c._outgoingQueue.push([$,O.data]):$.send(O.data)},this._exec=function(O,F,U,Z){Z===void 0&&(Z=c.machine.options.actions);var $=O.exec||eA(O.type,Z),K=Hr($)?$:$?$.exec:O.exec;if(K)try{return K(F,U.data,c.machine.config.predictableActionArguments?{action:O,_event:U}:{action:O,state:c.state,_event:U})}catch(rt){throw c.parent&&c.parent.send({type:"xstate.error",data:rt}),rt}switch(O.type){case Iv:{var ie=O;c.defer(ie);break}case z2:var H=O;if(typeof H.delay=="number"){c.defer(H);return}else H.to?c.sendTo(H._event,H.to,U===bg):c.send(H._event);break;case kF:c.cancel(O.sendId);break;case XC:{if(c.status!==Ao.Running)return;var G=O.activity;if(!c.machine.config.predictableActionArguments&&!c.state.activities[G.id||G.type])break;if(G.type===ii.Invoke){var ee=NF(G.src),W=c.machine.options.services?c.machine.options.services[ee.type]:void 0,me=G.id,de=G.data,he="autoForward"in G?G.autoForward:!!G.forward;if(!W)return;var se=de?Nb(de,F,U):void 0;if(typeof W=="string")return;var q=Hr(W)?W(F,U.data,{data:se,src:ee,meta:G.meta}):W;if(!q)return;var Se=void 0;jg(q)&&(q=se?q.withContext(se):q,Se={autoForward:he}),c.spawn(q,me,Se)}else c.spawnActivity(G);break}case OM:{c.stopChild(O.activity.id);break}case PF:var ze=O,Ue=ze.label,Be=ze.value;Ue?c.logger(Ue,Be):c.logger(Be);break}};var p=Kt(Kt({},r.defaultOptions),a),_=p.clock,x=p.logger,T=p.parent,C=p.id,P=C!==void 0?C:o.id;this.id=P,this.logger=x,this.clock=_,this.parent=T,this.options=p,this.scheduler=new cO({deferEvents:this.options.deferEvents}),this.sessionId=o0.bookId()}return Object.defineProperty(r.prototype,"initialState",{get:function(){var o=this;return this._initialState?this._initialState:Qm(this,function(){return o._initialState=o.machine.initialState,o._initialState})},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"state",{get:function(){return this._state},enumerable:!1,configurable:!0}),r.prototype.execute=function(o,a){var c,p;try{for(var _=Er(o.actions),x=_.next();!x.done;x=_.next()){var T=x.value;this.exec(T,o,a)}}catch(C){c={error:C}}finally{try{x&&!x.done&&(p=_.return)&&p.call(_)}finally{if(c)throw c.error}}},r.prototype.update=function(o,a){var c,p,_,x,T,C,P,O,F=this;if(o._sessionid=this.sessionId,this._state=o,(!this.machine.config.predictableActionArguments||a===bg)&&this.options.execute)this.execute(this.state);else for(var U=void 0;U=this._outgoingQueue.shift();)U[0].send(U[1]);if(this.children.forEach(function(q){F.state.children[q.id]=q}),this.devTools&&this.devTools.send(a.data,o),o.event)try{for(var Z=Er(this.eventListeners),$=Z.next();!$.done;$=Z.next()){var K=$.value;K(o.event)}}catch(q){c={error:q}}finally{try{$&&!$.done&&(p=Z.return)&&p.call(Z)}finally{if(c)throw c.error}}try{for(var ie=Er(this.listeners),H=ie.next();!H.done;H=ie.next()){var K=H.value;K(o,o.event)}}catch(q){_={error:q}}finally{try{H&&!H.done&&(x=ie.return)&&x.call(ie)}finally{if(_)throw _.error}}try{for(var G=Er(this.contextListeners),ee=G.next();!ee.done;ee=G.next()){var W=ee.value;W(this.state.context,this.state.history?this.state.history.context:void 0)}}catch(q){T={error:q}}finally{try{ee&&!ee.done&&(C=G.return)&&C.call(G)}finally{if(T)throw T.error}}if(this.state.done){var me=o.configuration.find(function(q){return q.type==="final"&&q.parent===F.machine}),de=me&&me.doneData?Nb(me.doneData,o.context,a):void 0;this._doneEvent=Hw(this.id,de);try{for(var he=Er(this.doneListeners),se=he.next();!se.done;se=he.next()){var K=se.value;K(this._doneEvent)}}catch(q){P={error:q}}finally{try{se&&!se.done&&(O=he.return)&&O.call(he)}finally{if(P)throw P.error}}this._stop(),this._stopChildren(),o0.free(this.sessionId)}},r.prototype.onTransition=function(o){return this.listeners.add(o),this.status===Ao.Running&&o(this.state,this.state.event),this},r.prototype.subscribe=function(o,a,c){var p=this,_=Gw(o,a,c);this.listeners.add(_.next),this.status!==Ao.NotStarted&&_.next(this.state);var x=function(){p.doneListeners.delete(x),p.stopListeners.delete(x),_.complete()};return this.status===Ao.Stopped?_.complete():(this.onDone(x),this.onStop(x)),{unsubscribe:function(){p.listeners.delete(_.next),p.doneListeners.delete(x),p.stopListeners.delete(x)}}},r.prototype.onEvent=function(o){return this.eventListeners.add(o),this},r.prototype.onSend=function(o){return this.sendListeners.add(o),this},r.prototype.onChange=function(o){return this.contextListeners.add(o),this},r.prototype.onStop=function(o){return this.stopListeners.add(o),this},r.prototype.onDone=function(o){return this.status===Ao.Stopped&&this._doneEvent?o(this._doneEvent):this.doneListeners.add(o),this},r.prototype.off=function(o){return this.listeners.delete(o),this.eventListeners.delete(o),this.sendListeners.delete(o),this.stopListeners.delete(o),this.doneListeners.delete(o),this.contextListeners.delete(o),this},r.prototype.start=function(o){var a=this;if(this.status===Ao.Running)return this;this.machine._init(),o0.register(this.sessionId,this),this.initialized=!0,this.status=Ao.Running;var c=o===void 0?this.initialState:Qm(this,function(){return dK(o)?a.machine.resolveState(o):a.machine.resolveState(ka.from(o,a.machine.context))});return this.options.devTools&&this.attachDev(),this.scheduler.initialize(function(){a.update(c,bg)}),this},r.prototype._stopChildren=function(){this.children.forEach(function(o){Hr(o.stop)&&o.stop()}),this.children.clear()},r.prototype._stop=function(){var o,a,c,p,_,x,T,C,P,O;try{for(var F=Er(this.listeners),U=F.next();!U.done;U=F.next()){var Z=U.value;this.listeners.delete(Z)}}catch(he){o={error:he}}finally{try{U&&!U.done&&(a=F.return)&&a.call(F)}finally{if(o)throw o.error}}try{for(var $=Er(this.stopListeners),K=$.next();!K.done;K=$.next()){var Z=K.value;Z(),this.stopListeners.delete(Z)}}catch(he){c={error:he}}finally{try{K&&!K.done&&(p=$.return)&&p.call($)}finally{if(c)throw c.error}}try{for(var ie=Er(this.contextListeners),H=ie.next();!H.done;H=ie.next()){var Z=H.value;this.contextListeners.delete(Z)}}catch(he){_={error:he}}finally{try{H&&!H.done&&(x=ie.return)&&x.call(ie)}finally{if(_)throw _.error}}try{for(var G=Er(this.doneListeners),ee=G.next();!ee.done;ee=G.next()){var Z=ee.value;this.doneListeners.delete(Z)}}catch(he){T={error:he}}finally{try{ee&&!ee.done&&(C=G.return)&&C.call(G)}finally{if(T)throw T.error}}if(!this.initialized)return this;this.initialized=!1,this.status=Ao.Stopped,this._initialState=void 0;try{for(var W=Er(Object.keys(this.delayedEventsMap)),me=W.next();!me.done;me=W.next()){var de=me.value;this.clock.clearTimeout(this.delayedEventsMap[de])}}catch(he){P={error:he}}finally{try{me&&!me.done&&(O=W.return)&&O.call(W)}finally{if(P)throw P.error}}this.scheduler.clear(),this.scheduler=new cO({deferEvents:this.options.deferEvents})},r.prototype.stop=function(){var o=this,a=this.scheduler;return this._stop(),a.schedule(function(){var c=Uo({type:"xstate.stop"}),p=Qm(o,function(){var _=Li(bi([],Fr(o.state.configuration),!1).sort(function(O,F){return F.order-O.order}).map(function(O){return Bh(O.onExit,o.machine.options.actions)})),x=Fr(jb(o.machine,o.state,o.state.context,c,[{type:"exit",actions:_}],o.machine.config.predictableActionArguments?o._exec:void 0,o.machine.config.predictableActionArguments||o.machine.config.preserveActionOrder),2),T=x[0],C=x[1],P=new ka({value:o.state.value,context:C,_event:c,_sessionid:o.sessionId,historyValue:void 0,history:o.state,actions:T.filter(function(O){return!JC(O)}),activities:{},events:[],configuration:[],transitions:[],children:{},done:o.state.done,tags:o.state.tags,machine:o.machine});return P.changed=!0,P});o.update(p,c),o._stopChildren(),o0.free(o.sessionId)}),this},r.prototype.batch=function(o){var a=this;if(!(this.status===Ao.NotStarted&&this.options.deferEvents)){if(this.status!==Ao.Running)throw new Error("".concat(o.length,' event(s) were sent to uninitialized service "').concat(this.machine.id,'". Make sure .start() is called for this service, or set { deferEvents: true } in the service options.'))}if(o.length){var c=!!this.machine.config.predictableActionArguments&&this._exec;this.scheduler.schedule(function(){var p,_,x=a.state,T=!1,C=[],P=function(Z){var $=Uo(Z);a.forward($),x=Qm(a,function(){return a.machine.transition(x,$,void 0,c||void 0)}),C.push.apply(C,bi([],Fr(a.machine.config.predictableActionArguments?x.actions:x.actions.map(function(K){return fK(K,x)})),!1)),T=T||!!x.changed};try{for(var O=Er(o),F=O.next();!F.done;F=O.next()){var U=F.value;P(U)}}catch(Z){p={error:Z}}finally{try{F&&!F.done&&(_=O.return)&&_.call(O)}finally{if(p)throw p.error}}x.changed=T,x.actions=C,a.update(x,Uo(o[o.length-1]))})}},r.prototype.sender=function(o){return this.send.bind(this,o)},r.prototype._nextState=function(o,a){var c=this;a===void 0&&(a=!!this.machine.config.predictableActionArguments&&this._exec);var p=Uo(o);if(p.name.indexOf(rO)===0&&!this.state.nextEvents.some(function(x){return x.indexOf(rO)===0}))throw p.data.data;var _=Qm(this,function(){return c.machine.transition(c.state,p,void 0,a||void 0)});return _},r.prototype.nextState=function(o){return this._nextState(o,!1)},r.prototype.forward=function(o){var a,c;try{for(var p=Er(this.forwardTo),_=p.next();!_.done;_=p.next()){var x=_.value,T=this.children.get(x);if(!T)throw new Error("Unable to forward event '".concat(o,"' from interpreter '").concat(this.id,"' to nonexistant child '").concat(x,"'."));T.send(o)}}catch(C){a={error:C}}finally{try{_&&!_.done&&(c=p.return)&&c.call(p)}finally{if(a)throw a.error}}},r.prototype.defer=function(o){var a=this,c=this.clock.setTimeout(function(){"to"in o&&o.to?a.sendTo(o._event,o.to,!0):a.send(o._event)},o.delay);o.id&&(this.delayedEventsMap[o.id]=c)},r.prototype.cancel=function(o){this.clock.clearTimeout(this.delayedEventsMap[o]),delete this.delayedEventsMap[o]},r.prototype.exec=function(o,a,c){c===void 0&&(c=this.machine.options.actions),this._exec(o,a.context,a._event,c)},r.prototype.removeChild=function(o){var a;this.children.delete(o),this.forwardTo.delete(o),(a=this.state)===null||a===void 0||delete a.children[o]},r.prototype.stopChild=function(o){var a=this.children.get(o);a&&(this.removeChild(o),Hr(a.stop)&&a.stop())},r.prototype.spawn=function(o,a,c){if(this.status!==Ao.Running)return UF(o,a);if(sO(o))return this.spawnPromise(Promise.resolve(o),a);if(Hr(o))return this.spawnCallback(o,a);if(aK(o))return this.spawnActor(o,a);if(GX(o))return this.spawnObservable(o,a);if(jg(o))return this.spawnMachine(o,Kt(Kt({},c),{id:a}));if(jX(o))return this.spawnBehavior(o,a);throw new Error('Unable to spawn entity "'.concat(a,'" of type "').concat(typeof o,'".'))},r.prototype.spawnMachine=function(o,a){var c=this;a===void 0&&(a={});var p=new r(o,Kt(Kt({},this.options),{parent:this,id:a.id||o.id})),_=Kt(Kt({},vK),a);_.sync&&p.onTransition(function(T){c.send(RF,{state:T,id:p.id})});var x=p;return this.children.set(p.id,x),_.autoForward&&this.forwardTo.add(p.id),p.onDone(function(T){c.removeChild(p.id),c.send(Uo(T,{origin:p.id}))}).start(),x},r.prototype.spawnBehavior=function(o,a){var c=_K(o,{id:a,parent:this});return this.children.set(a,c),c},r.prototype.spawnPromise=function(o,a){var c,p=this,_=!1,x;o.then(function(C){_||(x=C,p.removeChild(a),p.send(Uo(Hw(a,C),{origin:a})))},function(C){if(!_){p.removeChild(a);var P=x0(a,C);try{p.send(Uo(P,{origin:a}))}catch{p.devTools&&p.devTools.send(P,p.state),p.machine.strict&&p.stop()}}});var T=(c={id:a,send:function(){},subscribe:function(C,P,O){var F=Gw(C,P,O),U=!1;return o.then(function(Z){U||(F.next(Z),!U&&F.complete())},function(Z){U||F.error(Z)}),{unsubscribe:function(){return U=!0}}},stop:function(){_=!0},toJSON:function(){return{id:a}},getSnapshot:function(){return x}},c[Fh]=function(){return this},c);return this.children.set(a,T),T},r.prototype.spawnCallback=function(o,a){var c,p=this,_=!1,x=new Set,T=new Set,C,P=function(U){C=U,T.forEach(function(Z){return Z(U)}),!_&&p.send(Uo(U,{origin:a}))},O;try{O=o(P,function(U){x.add(U)})}catch(U){this.send(x0(a,U))}if(sO(O))return this.spawnPromise(O,a);var F=(c={id:a,send:function(U){return x.forEach(function(Z){return Z(U)})},subscribe:function(U){var Z=Gw(U);return T.add(Z.next),{unsubscribe:function(){T.delete(Z.next)}}},stop:function(){_=!0,Hr(O)&&O()},toJSON:function(){return{id:a}},getSnapshot:function(){return C}},c[Fh]=function(){return this},c);return this.children.set(a,F),F},r.prototype.spawnObservable=function(o,a){var c,p=this,_,x=o.subscribe(function(C){_=C,p.send(Uo(C,{origin:a}))},function(C){p.removeChild(a),p.send(Uo(x0(a,C),{origin:a}))},function(){p.removeChild(a),p.send(Uo(Hw(a),{origin:a}))}),T=(c={id:a,send:function(){},subscribe:function(C,P,O){return o.subscribe(C,P,O)},stop:function(){return x.unsubscribe()},getSnapshot:function(){return _},toJSON:function(){return{id:a}}},c[Fh]=function(){return this},c);return this.children.set(a,T),T},r.prototype.spawnActor=function(o,a){return this.children.set(a,o),o},r.prototype.spawnActivity=function(o){var a=this.machine.options&&this.machine.options.activities?this.machine.options.activities[o.type]:void 0;if(a){var c=a(this.state.context,o);this.spawnEffect(o.id,c)}},r.prototype.spawnEffect=function(o,a){var c;this.children.set(o,(c={id:o,send:function(){},subscribe:function(){return{unsubscribe:function(){}}},stop:a||void 0,getSnapshot:function(){},toJSON:function(){return{id:o}}},c[Fh]=function(){return this},c))},r.prototype.attachDev=function(){var o=NM();if(this.options.devTools&&o){if(o.__REDUX_DEVTOOLS_EXTENSION__){var a=typeof this.options.devTools=="object"?this.options.devTools:void 0;this.devTools=o.__REDUX_DEVTOOLS_EXTENSION__.connect(Kt(Kt({name:this.id,autoPause:!0,stateSanitizer:function(c){return{value:c.value,context:c.context,actions:c.actions}}},a),{features:Kt({jump:!1,skip:!1},a?a.features:void 0)}),this.machine),this.devTools.init(this.state)}yK(this)}},r.prototype.toJSON=function(){return{id:this.id}},r.prototype[Fh]=function(){return this},r.prototype.getSnapshot=function(){return this.status===Ao.NotStarted?this.initialState:this._state},r.defaultOptions={execute:!0,deferEvents:!0,clock:{setTimeout:function(o,a){return setTimeout(o,a)},clearTimeout:function(o){return clearTimeout(o)}},logger:console.log.bind(console),devTools:!1},r.interpret=qF,r}();function qF(r,o){var a=new xK(r,o);return a}function wK(r){if(typeof r=="string"){var o={type:r};return o.toString=function(){return r},o}return r}function uw(r){return Kt(Kt({type:KC},r),{toJSON:function(){r.onDone,r.onError;var o=LM(r,["onDone","onError"]);return Kt(Kt({},o),{type:KC,src:wK(r.src)})}})}var cw="",nA="#",AT="*",Wm={},Zm=function(r){return r[0]===nA},bK=function(){return{actions:{},guards:{},services:{},activities:{},delays:{}}},SK=function(){function r(o,a,c,p){c===void 0&&(c="context"in o?o.context:void 0);var _=this,x;this.config=o,this._context=c,this.order=-1,this.__xstatenode=!0,this.__cache={events:void 0,relativeValue:new Map,initialStateValue:void 0,initialState:void 0,on:void 0,transitions:void 0,candidates:{},delayedTransitions:void 0},this.idMap={},this.tags=[],this.options=Object.assign(bK(),a),this.parent=p==null?void 0:p.parent,this.key=this.config.key||(p==null?void 0:p.key)||this.config.id||"(machine)",this.machine=this.parent?this.parent.machine:this,this.path=this.parent?this.parent.path.concat(this.key):[],this.delimiter=this.config.delimiter||(this.parent?this.parent.delimiter:DF),this.id=this.config.id||bi([this.machine.key],Fr(this.path),!1).join(this.delimiter),this.version=this.parent?this.parent.version:this.config.version,this.type=this.config.type||(this.config.parallel?"parallel":this.config.states&&Object.keys(this.config.states).length?"compound":this.config.history?"history":"atomic"),this.schema=this.parent?this.machine.schema:(x=this.config.schema)!==null&&x!==void 0?x:{},this.description=this.config.description,this.initial=this.config.initial,this.states=this.config.states?v0(this.config.states,function(P,O){var F,U=new r(P,{},void 0,{parent:_,key:O});return Object.assign(_.idMap,Kt((F={},F[U.id]=U,F),U.idMap)),U}):Wm;var T=0;function C(P){var O,F;P.order=T++;try{for(var U=Er(VF(P)),Z=U.next();!Z.done;Z=U.next()){var $=Z.value;C($)}}catch(K){O={error:K}}finally{try{Z&&!Z.done&&(F=U.return)&&F.call(U)}finally{if(O)throw O.error}}}C(this),this.history=this.config.history===!0?"shallow":this.config.history||!1,this._transient=!!this.config.always||(this.config.on?Array.isArray(this.config.on)?this.config.on.some(function(P){var O=P.event;return O===cw}):cw in this.config.on:!1),this.strict=!!this.config.strict,this.onEntry=Sl(this.config.entry||this.config.onEntry).map(function(P){return pv(P)}),this.onExit=Sl(this.config.exit||this.config.onExit).map(function(P){return pv(P)}),this.meta=this.config.meta,this.doneData=this.type==="final"?this.config.data:void 0,this.invoke=Sl(this.config.invoke).map(function(P,O){var F,U;if(jg(P)){var Z=aw(_.id,O);return _.machine.options.services=Kt((F={},F[Z]=P,F),_.machine.options.services),uw({src:Z,id:Z})}else if(Wr(P.src)){var Z=P.id||aw(_.id,O);return uw(Kt(Kt({},P),{id:Z,src:P.src}))}else if(jg(P.src)||Hr(P.src)){var Z=P.id||aw(_.id,O);return _.machine.options.services=Kt((U={},U[Z]=P.src,U),_.machine.options.services),uw(Kt(Kt({id:Z},P),{src:Z}))}else{var $=P.src;return uw(Kt(Kt({id:aw(_.id,O)},P),{src:$}))}}),this.activities=Sl(this.config.activities).concat(this.invoke).map(function(P){return BM(P)}),this.transition=this.transition.bind(this),this.tags=Sl(this.config.tags)}return r.prototype._init=function(){this.__cache.transitions||$F(this).forEach(function(o){return o.on})},r.prototype.withConfig=function(o,a){var c=this.options,p=c.actions,_=c.activities,x=c.guards,T=c.services,C=c.delays;return new r(this.config,{actions:Kt(Kt({},p),o.actions),activities:Kt(Kt({},_),o.activities),guards:Kt(Kt({},x),o.guards),services:Kt(Kt({},T),o.services),delays:Kt(Kt({},C),o.delays)},a??this.context)},r.prototype.withContext=function(o){return new r(this.config,this.options,o)},Object.defineProperty(r.prototype,"context",{get:function(){return Hr(this._context)?this._context():this._context},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"definition",{get:function(){return{id:this.id,key:this.key,version:this.version,context:this.context,type:this.type,initial:this.initial,history:this.history,states:v0(this.states,function(o){return o.definition}),on:this.on,transitions:this.transitions,entry:this.onEntry,exit:this.onExit,activities:this.activities||[],meta:this.meta,order:this.order||-1,data:this.doneData,invoke:this.invoke,description:this.description,tags:this.tags}},enumerable:!1,configurable:!0}),r.prototype.toJSON=function(){return this.definition},Object.defineProperty(r.prototype,"on",{get:function(){if(this.__cache.on)return this.__cache.on;var o=this.transitions;return this.__cache.on=o.reduce(function(a,c){return a[c.eventType]=a[c.eventType]||[],a[c.eventType].push(c),a},{})},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"after",{get:function(){return this.__cache.delayedTransitions||(this.__cache.delayedTransitions=this.getDelayedTransitions(),this.__cache.delayedTransitions)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"transitions",{get:function(){return this.__cache.transitions||(this.__cache.transitions=this.formatTransitions(),this.__cache.transitions)},enumerable:!1,configurable:!0}),r.prototype.getCandidates=function(o){if(this.__cache.candidates[o])return this.__cache.candidates[o];var a=o===cw,c=this.transitions.filter(function(p){var _=p.eventType===o;return a?_:_||p.eventType===AT});return this.__cache.candidates[o]=c,c},r.prototype.getDelayedTransitions=function(){var o=this,a=this.config.after;if(!a)return[];var c=function(_,x){var T=Hr(_)?"".concat(o.id,":delay[").concat(x,"]"):_,C=rK(T,o.id);return o.onEntry.push(XX(C,{delay:_})),o.onExit.push(QX(C)),C},p=Zg(a)?a.map(function(_,x){var T=c(_.delay,x);return Kt(Kt({},_),{event:T})}):Li(Object.keys(a).map(function(_,x){var T=a[_],C=Wr(T)?{target:T}:T,P=isNaN(+_)?_:+_,O=c(P,x);return Sl(C).map(function(F){return Kt(Kt({},F),{event:O,delay:P})})}));return p.map(function(_){var x=_.delay;return Kt(Kt({},o.formatTransition(_)),{delay:x})})},r.prototype.getStateNodes=function(o){var a,c=this;if(!o)return[];var p=o instanceof ka?o.value:z0(o,this.delimiter);if(Wr(p)){var _=this.getStateNode(p).initial;return _!==void 0?this.getStateNodes((a={},a[p]=_,a)):[this,this.states[p]]}var x=Object.keys(p),T=[this];return T.push.apply(T,bi([],Fr(Li(x.map(function(C){return c.getStateNode(C).getStateNodes(p[C])}))),!1)),T},r.prototype.handles=function(o){var a=LF(o);return this.events.includes(a)},r.prototype.resolveState=function(o){var a=o instanceof ka?o:ka.create(o),c=Array.from(w0([],this.getStateNodes(a.value)));return new ka(Kt(Kt({},a),{value:this.resolve(a.value),configuration:c,done:qw(c,this),tags:uO(c),machine:this.machine}))},r.prototype.transitionLeafNode=function(o,a,c){var p=this.getStateNode(o),_=p.next(a,c);return!_||!_.transitions.length?this.next(a,c):_},r.prototype.transitionCompoundNode=function(o,a,c){var p=Object.keys(o),_=this.getStateNode(p[0]),x=_._transition(o[p[0]],a,c);return!x||!x.transitions.length?this.next(a,c):x},r.prototype.transitionParallelNode=function(o,a,c){var p,_,x={};try{for(var T=Er(Object.keys(o)),C=T.next();!C.done;C=T.next()){var P=C.value,O=o[P];if(O){var F=this.getStateNode(P),U=F._transition(O,a,c);U&&(x[P]=U)}}}catch(H){p={error:H}}finally{try{C&&!C.done&&(_=T.return)&&_.call(T)}finally{if(p)throw p.error}}var Z=Object.keys(x).map(function(H){return x[H]}),$=Li(Z.map(function(H){return H.transitions})),K=Z.some(function(H){return H.transitions.length>0});if(!K)return this.next(a,c);var ie=Li(Object.keys(x).map(function(H){return x[H].configuration}));return{transitions:$,exitSet:Li(Z.map(function(H){return H.exitSet})),configuration:ie,source:a,actions:Li(Object.keys(x).map(function(H){return x[H].actions}))}},r.prototype._transition=function(o,a,c){return Wr(o)?this.transitionLeafNode(o,a,c):Object.keys(o).length===1?this.transitionCompoundNode(o,a,c):this.transitionParallelNode(o,a,c)},r.prototype.getTransitionData=function(o,a){return this._transition(o.value,o,Uo(a))},r.prototype.next=function(o,a){var c,p,_=this,x=a.name,T=[],C=[],P;try{for(var O=Er(this.getCandidates(x)),F=O.next();!F.done;F=O.next()){var U=F.value,Z=U.cond,$=U.in,K=o.context,ie=$?Wr($)&&Zm($)?o.matches(z0(this.getStateNodeById($).path,this.delimiter)):FM(z0($,this.delimiter),FX(this.path.slice(0,-2))(o.value)):!0,H=!1;try{H=!Z||BF(this.machine,Z,K,a,o)}catch(W){throw new Error("Unable to evaluate guard '".concat(Z.name||Z.type,"' in transition for event '").concat(x,"' in state node '").concat(this.id,`':
`).concat(W.message))}if(H&&ie){U.target!==void 0&&(C=U.target),T.push.apply(T,bi([],Fr(U.actions),!1)),P=U;break}}}catch(W){c={error:W}}finally{try{F&&!F.done&&(p=O.return)&&p.call(O)}finally{if(c)throw c.error}}if(P){if(!C.length)return{transitions:[P],exitSet:[],configuration:o.value?[this]:[],source:o,actions:T};var G=Li(C.map(function(W){return _.getRelativeStateNodes(W,o.historyValue)})),ee=!!P.internal;return{transitions:[P],exitSet:ee?[]:Li(C.map(function(W){return _.getPotentiallyReenteringNodes(W)})),configuration:G,source:o,actions:T}}},r.prototype.getPotentiallyReenteringNodes=function(o){if(this.order<o.order)return[this];for(var a=[],c=this,p=o;c&&c!==p;)a.push(c),c=c.parent;return c!==p?[]:(a.push(p),a)},r.prototype.getActions=function(o,a,c,p,_,x,T){var C,P,O,F,U=this,Z=x?w0([],this.getStateNodes(x.value)):[],$=new Set;try{for(var K=Er(Array.from(o).sort(function(ze,Ue){return ze.order-Ue.order})),ie=K.next();!ie.done;ie=K.next()){var H=ie.value;(!b0(Z,H)||b0(c.exitSet,H)||H.parent&&$.has(H.parent))&&$.add(H)}}catch(ze){C={error:ze}}finally{try{ie&&!ie.done&&(P=K.return)&&P.call(K)}finally{if(C)throw C.error}}try{for(var G=Er(Z),ee=G.next();!ee.done;ee=G.next()){var H=ee.value;(!b0(o,H)||b0(c.exitSet,H.parent))&&c.exitSet.push(H)}}catch(ze){O={error:ze}}finally{try{ee&&!ee.done&&(F=G.return)&&F.call(G)}finally{if(O)throw O.error}}c.exitSet.sort(function(ze,Ue){return Ue.order-ze.order});var W=Array.from($).sort(function(ze,Ue){return ze.order-Ue.order}),me=new Set(c.exitSet),de=Li(W.map(function(ze){var Ue=[];if(ze.type!=="final")return Ue;var Be=ze.parent;if(!Be.parent)return Ue;Ue.push(lw(ze.id,ze.doneData),lw(Be.id,ze.doneData?Nb(ze.doneData,p,_):void 0));var rt=Be.parent;return rt.type==="parallel"&&mv(rt).every(function(_t){return qw(c.configuration,_t)})&&Ue.push(lw(rt.id)),Ue})),he=W.map(function(ze){var Ue=ze.onEntry,Be=ze.activities.map(function(rt){return JX(rt)});return{type:"entry",actions:Bh(T?bi(bi([],Fr(Ue),!1),Fr(Be),!1):bi(bi([],Fr(Be),!1),Fr(Ue),!1),U.machine.options.actions)}}).concat({type:"state_done",actions:de.map(function(ze){return WX(ze)})}),se=Array.from(me).map(function(ze){return{type:"exit",actions:Bh(bi(bi([],Fr(ze.onExit),!1),Fr(ze.activities.map(function(Ue){return eK(Ue)})),!1),U.machine.options.actions)}}),q=se.concat({type:"transition",actions:Bh(c.actions,this.machine.options.actions)}).concat(he);if(a){var Se=Bh(Li(bi([],Fr(o),!1).sort(function(ze,Ue){return Ue.order-ze.order}).map(function(ze){return ze.onExit})),this.machine.options.actions).filter(function(ze){return!JC(ze)});return q.concat({type:"stop",actions:Se})}return q},r.prototype.transition=function(o,a,c,p){o===void 0&&(o=this.initialState);var _=Uo(a),x;if(o instanceof ka)x=c===void 0?o:this.resolveState(ka.from(o,c));else{var T=Wr(o)?this.resolve(Bb(this.getResolvedPath(o))):this.resolve(o),C=c??this.machine.context;x=this.resolveState(ka.from(T,C))}if(this.strict&&!this.events.includes(_.name)&&!NX(_.name))throw new Error("Machine '".concat(this.id,"' does not accept event '").concat(_.name,"'"));var P=this._transition(x.value,x,_)||{transitions:[],configuration:[],exitSet:[],source:x,actions:[]},O=w0([],this.getStateNodes(x.value)),F=P.configuration.length?w0(O,P.configuration):O;return P.configuration=bi([],Fr(F),!1),this.resolveTransition(P,x,x.context,p,_)},r.prototype.resolveRaisedTransition=function(o,a,c,p){var _,x=o.actions;return o=this.transition(o,a,void 0,p),o._event=c,o.event=c.data,(_=o.actions).unshift.apply(_,bi([],Fr(x),!1)),o},r.prototype.resolveTransition=function(o,a,c,p,_){var x,T,C,P,O=this;_===void 0&&(_=bg);var F=o.configuration,U=!a||o.transitions.length>0,Z=U?o.configuration:a?a.configuration:[],$=qw(Z,this),K=U?uK(this.machine,F):void 0,ie=a?a.historyValue?a.historyValue:o.source?this.machine.historyValue(a.value):void 0:void 0,H=this.getActions(new Set(Z),$,o,c,_,a,p),G=a?Kt({},a.activities):{};try{for(var ee=Er(H),W=ee.next();!W.done;W=ee.next()){var me=W.value;try{for(var de=(C=void 0,Er(me.actions)),he=de.next();!he.done;he=de.next()){var se=he.value;se.type===XC?G[se.activity.id||se.activity.type]=se:se.type===OM&&(G[se.activity.id||se.activity.type]=!1)}}catch($e){C={error:$e}}finally{try{he&&!he.done&&(P=de.return)&&P.call(de)}finally{if(C)throw C.error}}}}catch($e){x={error:$e}}finally{try{W&&!W.done&&(T=ee.return)&&T.call(ee)}finally{if(x)throw x.error}}var q=Fr(jb(this,a,c,_,H,p,this.machine.config.predictableActionArguments||this.machine.config.preserveActionOrder),2),Se=q[0],ze=q[1],Ue=Fr(UX(Se,JC),2),Be=Ue[0],rt=Ue[1],_t=Se.filter(function($e){var xt;return $e.type===XC&&((xt=$e.activity)===null||xt===void 0?void 0:xt.type)===KC}),zt=_t.reduce(function($e,xt){return $e[xt.activity.id]=oK(xt.activity,O.machine,ze,_),$e},a?Kt({},a.children):{}),dt=new ka({value:K||a.value,context:ze,_event:_,_sessionid:a?a._sessionid:null,historyValue:K?ie?VX(ie,K):void 0:a?a.historyValue:void 0,history:!K||o.source?a:void 0,actions:K?rt:[],activities:K?G:a?a.activities:{},events:[],configuration:Z,transitions:o.transitions,children:zt,done:$,tags:uO(Z),machine:this}),Te=c!==ze;dt.changed=_.name===RF||Te;var we=dt.history;we&&delete we.history;var Q=!$&&(this._transient||F.some(function($e){return $e._transient}));if(!U&&(!Q||_.name===cw))return dt;var ce=dt;if(!$)for(Q&&(ce=this.resolveRaisedTransition(ce,{type:kX},_,p));Be.length;){var De=Be.shift();ce=this.resolveRaisedTransition(ce,De._event,_,p)}var He=ce.changed||(we?!!ce.actions.length||Te||typeof we.value!=typeof ce.value||!HF(ce.value,we.value):void 0);return ce.changed=He,ce.history=we,ce},r.prototype.getStateNode=function(o){if(Zm(o))return this.machine.getStateNodeById(o);if(!this.states)throw new Error("Unable to retrieve child state '".concat(o,"' from '").concat(this.id,"'; no child states exist."));var a=this.states[o];if(!a)throw new Error("Child state '".concat(o,"' does not exist on '").concat(this.id,"'"));return a},r.prototype.getStateNodeById=function(o){var a=Zm(o)?o.slice(nA.length):o;if(a===this.id)return this;var c=this.machine.idMap[a];if(!c)throw new Error("Child state node '#".concat(a,"' does not exist on machine '").concat(this.id,"'"));return c},r.prototype.getStateNodeByPath=function(o){if(typeof o=="string"&&Zm(o))try{return this.getStateNodeById(o.slice(1))}catch{}for(var a=QC(o,this.delimiter).slice(),c=this;a.length;){var p=a.shift();if(!p.length)break;c=c.getStateNode(p)}return c},r.prototype.resolve=function(o){var a,c=this;if(!o)return this.initialStateValue||Wm;switch(this.type){case"parallel":return v0(this.initialStateValue,function(_,x){return _?c.getStateNode(x).resolve(o[x]||_):Wm});case"compound":if(Wr(o)){var p=this.getStateNode(o);return p.type==="parallel"||p.type==="compound"?(a={},a[o]=p.initialStateValue,a):o}return Object.keys(o).length?v0(o,function(_,x){return _?c.getStateNode(x).resolve(_):Wm}):this.initialStateValue||{};default:return o||Wm}},r.prototype.getResolvedPath=function(o){if(Zm(o)){var a=this.machine.idMap[o.slice(nA.length)];if(!a)throw new Error("Unable to find state node '".concat(o,"'"));return a.path}return QC(o,this.delimiter)},Object.defineProperty(r.prototype,"initialStateValue",{get:function(){var o;if(this.__cache.initialStateValue)return this.__cache.initialStateValue;var a;if(this.type==="parallel")a=oO(this.states,function(c){return c.initialStateValue||Wm},function(c){return c.type!=="history"});else if(this.initial!==void 0){if(!this.states[this.initial])throw new Error("Initial state '".concat(this.initial,"' not found on '").concat(this.key,"'"));a=Ub(this.states[this.initial])?this.initial:(o={},o[this.initial]=this.states[this.initial].initialStateValue,o)}else a={};return this.__cache.initialStateValue=a,this.__cache.initialStateValue},enumerable:!1,configurable:!0}),r.prototype.getInitialState=function(o,a){this._init();var c=this.getStateNodes(o);return this.resolveTransition({configuration:c,exitSet:[],transitions:[],source:void 0,actions:[]},void 0,a??this.machine.context,void 0)},Object.defineProperty(r.prototype,"initialState",{get:function(){var o=this.initialStateValue;if(!o)throw new Error("Cannot retrieve initial state from simple state '".concat(this.id,"'."));return this.getInitialState(o)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"target",{get:function(){var o;if(this.type==="history"){var a=this.config;Wr(a.target)?o=Zm(a.target)?Bb(this.machine.getStateNodeById(a.target).path.slice(this.path.length-1)):a.target:o=a.target}return o},enumerable:!1,configurable:!0}),r.prototype.getRelativeStateNodes=function(o,a,c){return c===void 0&&(c=!0),c?o.type==="history"?o.resolveHistory(a):o.initialStateNodes:[o]},Object.defineProperty(r.prototype,"initialStateNodes",{get:function(){var o=this;if(Ub(this))return[this];if(this.type==="compound"&&!this.initial)return[this];var a=$w(this.initialStateValue);return Li(a.map(function(c){return o.getFromRelativePath(c)}))},enumerable:!1,configurable:!0}),r.prototype.getFromRelativePath=function(o){if(!o.length)return[this];var a=Fr(o),c=a[0],p=a.slice(1);if(!this.states)throw new Error("Cannot retrieve subPath '".concat(c,"' from node with no states"));var _=this.getStateNode(c);if(_.type==="history")return _.resolveHistory();if(!this.states[c])throw new Error("Child state '".concat(c,"' does not exist on '").concat(this.id,"'"));return this.states[c].getFromRelativePath(p)},r.prototype.historyValue=function(o){if(Object.keys(this.states).length)return{current:o||this.initialStateValue,states:oO(this.states,function(a,c){if(!o)return a.historyValue();var p=Wr(o)?void 0:o[c];return a.historyValue(p||a.initialStateValue)},function(a){return!a.history})}},r.prototype.resolveHistory=function(o){var a=this;if(this.type!=="history")return[this];var c=this.parent;if(!o){var p=this.target;return p?Li($w(p).map(function(x){return c.getFromRelativePath(x)})):c.initialStateNodes}var _=BX(c.path,"states")(o).current;return Wr(_)?[c.getStateNode(_)]:Li($w(_).map(function(x){return a.history==="deep"?c.getFromRelativePath(x):[c.states[x[0]]]}))},Object.defineProperty(r.prototype,"stateIds",{get:function(){var o=this,a=Li(Object.keys(this.states).map(function(c){return o.states[c].stateIds}));return[this.id].concat(a)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"events",{get:function(){var o,a,c,p;if(this.__cache.events)return this.__cache.events;var _=this.states,x=new Set(this.ownEvents);if(_)try{for(var T=Er(Object.keys(_)),C=T.next();!C.done;C=T.next()){var P=C.value,O=_[P];if(O.states)try{for(var F=(c=void 0,Er(O.events)),U=F.next();!U.done;U=F.next()){var Z=U.value;x.add("".concat(Z))}}catch($){c={error:$}}finally{try{U&&!U.done&&(p=F.return)&&p.call(F)}finally{if(c)throw c.error}}}}catch($){o={error:$}}finally{try{C&&!C.done&&(a=T.return)&&a.call(T)}finally{if(o)throw o.error}}return this.__cache.events=Array.from(x)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"ownEvents",{get:function(){var o=new Set(this.transitions.filter(function(a){return!(!a.target&&!a.actions.length&&a.internal)}).map(function(a){return a.eventType}));return Array.from(o)},enumerable:!1,configurable:!0}),r.prototype.resolveTarget=function(o){var a=this;if(o!==void 0)return o.map(function(c){if(!Wr(c))return c;var p=c[0]===a.delimiter;if(p&&!a.parent)return a.getStateNodeByPath(c.slice(1));var _=p?a.key+c:c;if(a.parent)try{var x=a.parent.getStateNodeByPath(_);return x}catch(T){throw new Error("Invalid transition definition for state node '".concat(a.id,`':
`).concat(T.message))}else return a.getStateNodeByPath(_)})},r.prototype.formatTransition=function(o){var a=this,c=qX(o.target),p="internal"in o?o.internal:c?c.some(function(C){return Wr(C)&&C[0]===a.delimiter}):!0,_=this.machine.options.guards,x=this.resolveTarget(c),T=Kt(Kt({},o),{actions:Bh(Sl(o.actions)),cond:FF(o.cond,_),target:x,source:this,internal:p,eventType:o.event,toJSON:function(){return Kt(Kt({},T),{target:T.target?T.target.map(function(C){return"#".concat(C.id)}):void 0,source:"#".concat(a.id)})}});return T},r.prototype.formatTransitions=function(){var o,a,c=this,p;if(!this.config.on)p=[];else if(Array.isArray(this.config.on))p=this.config.on;else{var _=this.config.on,x=AT,T=_[x],C=T===void 0?[]:T,P=LM(_,[typeof x=="symbol"?x:x+""]);p=Li(Object.keys(P).map(function(G){var ee=qm(G,P[G]);return ee}).concat(qm(AT,C)))}var O=this.config.always?qm("",this.config.always):[],F=this.config.onDone?qm(String(lw(this.id)),this.config.onDone):[],U=Li(this.invoke.map(function(G){var ee=[];return G.onDone&&ee.push.apply(ee,bi([],Fr(qm(String(Hw(G.id)),G.onDone)),!1)),G.onError&&ee.push.apply(ee,bi([],Fr(qm(String(x0(G.id)),G.onError)),!1)),ee})),Z=this.after,$=Li(bi(bi(bi(bi([],Fr(F),!1),Fr(U),!1),Fr(p),!1),Fr(O),!1).map(function(G){return Sl(G).map(function(ee){return c.formatTransition(ee)})}));try{for(var K=Er(Z),ie=K.next();!ie.done;ie=K.next()){var H=ie.value;$.push(H)}}catch(G){o={error:G}}finally{try{ie&&!ie.done&&(a=K.return)&&a.call(K)}finally{if(o)throw o.error}}return $},r}();function EK(r,o,a){return a===void 0&&(a=r.context),new SK(r,o,a)}var TK=nK,rA;(function(r){r[r.Effect=1]="Effect",r[r.LayoutEffect=2]="LayoutEffect"})(rA||(rA={}));var F0=_e.useLayoutEffect;function hO(r){var o=_e.useRef();return o.current||(o.current={v:r()}),o.current.v}var CK=globalThis&&globalThis.__read||function(r,o){var a=typeof Symbol=="function"&&r[Symbol.iterator];if(!a)return r;var c=a.call(r),p,_=[],x;try{for(;(o===void 0||o-- >0)&&!(p=c.next()).done;)_.push(p.value)}catch(T){x={error:T}}finally{try{p&&!p.done&&(a=c.return)&&a.call(c)}finally{if(x)throw x.error}}return _},AK=globalThis&&globalThis.__values||function(r){var o=typeof Symbol=="function"&&Symbol.iterator,a=o&&r[o],c=0;if(a)return a.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&c>=r.length&&(r=void 0),{value:r&&r[c++],done:!r}}};throw new TypeError(o?"Object is not iterable.":"Symbol.iterator is not defined.")};function MK(r,o){var a,c,p=CK([[],[]],2),_=p[0],x=p[1];try{for(var T=AK(r),C=T.next();!C.done;C=T.next()){var P=C.value;o(P)?_.push(P):x.push(P)}}catch(O){a={error:O}}finally{try{C&&!C.done&&(c=T.return)&&c.call(T)}finally{if(a)throw a.error}}return[_,x]}var s0=globalThis&&globalThis.__read||function(r,o){var a=typeof Symbol=="function"&&r[Symbol.iterator];if(!a)return r;var c=a.call(r),p,_=[],x;try{for(;(o===void 0||o-- >0)&&!(p=c.next()).done;)_.push(p.value)}catch(T){x={error:T}}finally{try{p&&!p.done&&(a=c.return)&&a.call(c)}finally{if(x)throw x.error}}return _},dO=globalThis&&globalThis.__spreadArray||function(r,o,a){if(a||arguments.length===2)for(var c=0,p=o.length,_;c<p;c++)(_||!(c in o))&&(_||(_=Array.prototype.slice.call(o,0,c)),_[c]=o[c]);return r.concat(_||Array.prototype.slice.call(o))};function fO(r,o){var a=r.exec,c=a(o.context,o._event.data,{action:r,state:o,_event:o._event});c()}function IK(r){var o=_e.useRef([]),a=_e.useRef([]);F0(function(){var c=r.subscribe(function(p){var _,x;if(p.actions.length){var T=p.actions.filter(function(F){return typeof F.exec=="function"&&"__effect"in F.exec}),C=s0(MK(T,function(F){return F.exec.__effect===rA.Effect}),2),P=C[0],O=C[1];(_=o.current).push.apply(_,dO([],s0(P.map(function(F){return[F,p]})),!1)),(x=a.current).push.apply(x,dO([],s0(O.map(function(F){return[F,p]})),!1))}});return function(){c.unsubscribe()}},[]),F0(function(){for(;a.current.length;){var c=s0(a.current.shift(),2),p=c[0],_=c[1];fO(p,_)}}),_e.useEffect(function(){for(;o.current.length;){var c=s0(o.current.shift(),2),p=c[0],_=c[1];fO(p,_)}})}var B0=globalThis&&globalThis.__assign||function(){return B0=Object.assign||function(r){for(var o,a=1,c=arguments.length;a<c;a++){o=arguments[a];for(var p in o)Object.prototype.hasOwnProperty.call(o,p)&&(r[p]=o[p])}return r},B0.apply(this,arguments)},kK=globalThis&&globalThis.__rest||function(r,o){var a={};for(var c in r)Object.prototype.hasOwnProperty.call(r,c)&&o.indexOf(c)<0&&(a[c]=r[c]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var p=0,c=Object.getOwnPropertySymbols(r);p<c.length;p++)o.indexOf(c[p])<0&&Object.prototype.propertyIsEnumerable.call(r,c[p])&&(a[c[p]]=r[c[p]]);return a};globalThis&&globalThis.__read;function PK(r,o,a){if(typeof r=="object")return r;var c=function(){};return{next:r,error:o||c,complete:a||c}}function RK(r,o,a){o===void 0&&(o={});var c=hO(function(){return typeof r=="function"?r():r}),p=o.context,_=o.guards,x=o.actions,T=o.activities,C=o.services,P=o.delays,O=o.state,F=kK(o,["context","guards","actions","activities","services","delays","state"]),U=hO(function(){var Z={context:p,guards:_,actions:x,activities:T,services:C,delays:P},$=c.withConfig(Z,function(){return B0(B0({},c.context),p)});return qF($,B0({deferEvents:!0},F))});return F0(function(){var Z;return a&&(Z=U.subscribe(PK(a))),function(){Z==null||Z.unsubscribe()}},[a]),F0(function(){return U.start(O?ka.create(O):void 0),function(){U.stop()}},[]),F0(function(){Object.assign(U.machine.options.actions,x),Object.assign(U.machine.options.guards,_),Object.assign(U.machine.options.activities,T),Object.assign(U.machine.options.services,C),Object.assign(U.machine.options.delays,P)},[x,_,T,C,P]),IK(U),U}var DK=globalThis&&globalThis.__read||function(r,o){var a=typeof Symbol=="function"&&r[Symbol.iterator];if(!a)return r;var c=a.call(r),p,_=[],x;try{for(;(o===void 0||o-- >0)&&!(p=c.next()).done;)_.push(p.value)}catch(T){x={error:T}}finally{try{p&&!p.done&&(a=c.return)&&a.call(c)}finally{if(x)throw x.error}}return _};globalThis&&globalThis.__spreadArray;function LK(r,o){o===void 0&&(o={});var a=_e.useCallback(function(T){var C=T.changed===void 0&&Object.keys(T.children).length;(T.changed||C)&&x(T)},[]),c=RK(r,o,a),p=DK(_e.useState(function(){var T=c.machine.initialState;return o.state?ka.create(o.state):T}),2),_=p[0],x=p[1];return[_,c.send,c]}function Sg(r,o){if(r==null)return{};var a={},c=Object.keys(r),p,_;for(_=0;_<c.length;_++)p=c[_],!(o.indexOf(p)>=0)&&(a[p]=r[p]);return a}const yr={arr:Array.isArray,obj:r=>Object.prototype.toString.call(r)==="[object Object]",fun:r=>typeof r=="function",str:r=>typeof r=="string",num:r=>typeof r=="number",und:r=>r===void 0,nul:r=>r===null,set:r=>r instanceof Set,map:r=>r instanceof Map,equ(r,o){if(typeof r!=typeof o)return!1;if(yr.str(r)||yr.num(r))return r===o;if(yr.obj(r)&&yr.obj(o)&&Object.keys(r).length+Object.keys(o).length===0)return!0;let a;for(a in r)if(!(a in o))return!1;for(a in o)if(r[a]!==o[a])return!1;return yr.und(a)?r===o:!0}};function OK(r,o){return o===void 0&&(o=!0),a=>(yr.arr(a)?a:Object.keys(a)).reduce((c,p)=>{const _=o?p[0].toLowerCase()+p.substring(1):p;return c[_]=r(_),c},r)}function zK(){const r=_e.useState(!1),o=r[1];return _e.useCallback(()=>o(c=>!c),[])}function yf(r,o){return yr.und(r)||yr.nul(r)?o:r}function hw(r){return yr.und(r)?[]:yr.arr(r)?r:[r]}function pg(r){for(var o=arguments.length,a=new Array(o>1?o-1:0),c=1;c<o;c++)a[c-1]=arguments[c];return yr.fun(r)?r(...a):r}function FK(r){return r.to,r.from,r.config,r.onStart,r.onRest,r.onFrame,r.children,r.reset,r.reverse,r.force,r.immediate,r.delay,r.attach,r.destroyed,r.interpolateTo,r.ref,r.lazy,Sg(r,["to","from","config","onStart","onRest","onFrame","children","reset","reverse","force","immediate","delay","attach","destroyed","interpolateTo","ref","lazy"])}function MT(r){const o=FK(r);if(yr.und(o))return $i({to:o},r);const a=Object.keys(r).reduce((c,p)=>yr.und(o[p])?$i({},c,{[p]:r[p]}):c,{});return $i({to:o},a)}function BK(r,o){return o&&(yr.fun(o)?o(r):yr.obj(o)&&(o.current=r)),r}class Al{constructor(){this.payload=void 0,this.children=[]}getAnimatedValue(){return this.getValue()}getPayload(){return this.payload||this}attach(){}detach(){}getChildren(){return this.children}addChild(o){this.children.length===0&&this.attach(),this.children.push(o)}removeChild(o){const a=this.children.indexOf(o);this.children.splice(a,1),this.children.length===0&&this.detach()}}class iA extends Al{constructor(){super(...arguments),this.payload=[],this.attach=()=>this.payload.forEach(o=>o instanceof Al&&o.addChild(this)),this.detach=()=>this.payload.forEach(o=>o instanceof Al&&o.removeChild(this))}}class WF extends Al{constructor(){super(...arguments),this.payload={},this.attach=()=>Object.values(this.payload).forEach(o=>o instanceof Al&&o.addChild(this)),this.detach=()=>Object.values(this.payload).forEach(o=>o instanceof Al&&o.removeChild(this))}getValue(o){o===void 0&&(o=!1);const a={};for(const c in this.payload){const p=this.payload[c];o&&!(p instanceof Al)||(a[c]=p instanceof Al?p[o?"getAnimatedValue":"getValue"]():p)}return a}getAnimatedValue(){return this.getValue(!0)}}let jM;function NK(r,o){jM={fn:r,transform:o}}let ZF;function jK(r){ZF=r}let XF=r=>typeof window<"u"?window.requestAnimationFrame(r):-1,Vb;function UK(r){Vb=r}let KF=()=>Date.now(),VK=r=>r.current,YF;function $K(r){YF=r}class GK extends WF{constructor(o,a){super(),this.update=void 0,this.payload=o.style?$i({},o,{style:YF(o.style)}):o,this.update=a,this.attach()}}const HK=r=>yr.fun(r)&&!(r.prototype instanceof Xn.Component),qK=r=>_e.forwardRef((a,c)=>{const p=zK(),_=_e.useRef(!0),x=_e.useRef(null),T=_e.useRef(null),C=_e.useCallback(U=>{const Z=x.current,$=()=>{let K=!1;T.current&&(K=jM.fn(T.current,x.current.getAnimatedValue())),(!T.current||K===!1)&&p()};x.current=new GK(U,$),Z&&Z.detach()},[]);_e.useEffect(()=>()=>{_.current=!1,x.current&&x.current.detach()},[]),_e.useImperativeHandle(c,()=>VK(T)),C(a);const P=x.current.getValue();P.scrollTop,P.scrollLeft;const O=Sg(P,["scrollTop","scrollLeft"]),F=HK(r)?void 0:U=>T.current=BK(U,c);return Xn.createElement(r,$i({},O,{ref:F}))});let N0=!1;const kf=new Set,QF=()=>{if(!N0)return!1;let r=KF();for(let o of kf){let a=!1;for(let c=0;c<o.configs.length;c++){let p=o.configs[c],_,x;for(let T=0;T<p.animatedValues.length;T++){let C=p.animatedValues[T];if(C.done)continue;let P=p.fromValues[T],O=p.toValues[T],F=C.lastPosition,U=O instanceof Al,Z=Array.isArray(p.initialVelocity)?p.initialVelocity[T]:p.initialVelocity;if(U&&(O=O.getValue()),p.immediate){C.setValue(O),C.done=!0;continue}if(typeof P=="string"||typeof O=="string"){C.setValue(O),C.done=!0;continue}if(p.duration!==void 0)F=P+p.easing((r-C.startTime)/p.duration)*(O-P),_=r>=C.startTime+p.duration;else if(p.decay)F=P+Z/(1-.998)*(1-Math.exp(-(1-.998)*(r-C.startTime))),_=Math.abs(C.lastPosition-F)<.1,_&&(O=F);else{x=C.lastTime!==void 0?C.lastTime:r,Z=C.lastVelocity!==void 0?C.lastVelocity:p.initialVelocity,r>x+64&&(x=r);let $=Math.floor(r-x);for(let G=0;G<$;++G){let ee=-p.tension*(F-O),W=-p.friction*Z,me=(ee+W)/p.mass;Z=Z+me*1/1e3,F=F+Z*1/1e3}let K=p.clamp&&p.tension!==0?P<O?F>O:F<O:!1,ie=Math.abs(Z)<=p.precision,H=p.tension!==0?Math.abs(O-F)<=p.precision:!0;_=K||ie&&H,C.lastVelocity=Z,C.lastTime=r}U&&!p.toValues[T].done&&(_=!1),_?(C.value!==O&&(F=O),C.done=!0):a=!0,C.setValue(F),C.lastPosition=F}o.props.onFrame&&(o.values[p.name]=p.interpolation.getValue())}o.props.onFrame&&o.props.onFrame(o.values),a||(kf.delete(o),o.stop(!0))}return kf.size?XF(QF):N0=!1,N0},WK=r=>{kf.has(r)||kf.add(r),N0||(N0=!0,XF(QF))},ZK=r=>{kf.has(r)&&kf.delete(r)};function $b(r,o,a){if(typeof r=="function")return r;if(Array.isArray(r))return $b({range:r,output:o,extrapolate:a});if(Vb&&typeof r.output[0]=="string")return Vb(r);const c=r,p=c.output,_=c.range||[0,1],x=c.extrapolateLeft||c.extrapolate||"extend",T=c.extrapolateRight||c.extrapolate||"extend",C=c.easing||(P=>P);return P=>{const O=KK(P,_);return XK(P,_[O],_[O+1],p[O],p[O+1],C,x,T,c.map)}}function XK(r,o,a,c,p,_,x,T,C){let P=C?C(r):r;if(P<o){if(x==="identity")return P;x==="clamp"&&(P=o)}if(P>a){if(T==="identity")return P;T==="clamp"&&(P=a)}return c===p?c:o===a?r<=o?c:p:(o===-1/0?P=-P:a===1/0?P=P-o:P=(P-o)/(a-o),P=_(P),c===-1/0?P=-P:p===1/0?P=P+c:P=P*(p-c)+c,P)}function KK(r,o){for(var a=1;a<o.length-1&&!(o[a]>=r);++a);return a-1}class Ug extends iA{constructor(o,a,c,p){super(),this.calc=void 0,this.payload=o instanceof iA&&!(o instanceof Ug)?o.getPayload():Array.isArray(o)?o:[o],this.calc=$b(a,c,p)}getValue(){return this.calc(...this.payload.map(o=>o.getValue()))}updateConfig(o,a,c){this.calc=$b(o,a,c)}interpolate(o,a,c){return new Ug(this,o,a,c)}}const Xm=(r,o,a)=>r&&new Ug(r,o,a),YK={default:{tension:170,friction:26},gentle:{tension:120,friction:14},wobbly:{tension:180,friction:12},stiff:{tension:210,friction:20},slow:{tension:280,friction:60},molasses:{tension:280,friction:120}};function JF(r,o){"update"in r?o.add(r):r.getChildren().forEach(a=>JF(a,o))}class oA extends Al{constructor(o){var a;super(),a=this,this.animatedStyles=new Set,this.value=void 0,this.startPosition=void 0,this.lastPosition=void 0,this.lastVelocity=void 0,this.startTime=void 0,this.lastTime=void 0,this.done=!1,this.setValue=function(c,p){p===void 0&&(p=!0),a.value=c,p&&a.flush()},this.value=o,this.startPosition=o,this.lastPosition=o}flush(){this.animatedStyles.size===0&&JF(this,this.animatedStyles),this.animatedStyles.forEach(o=>o.update())}clearStyles(){this.animatedStyles.clear()}getValue(){return this.value}interpolate(o,a,c){return new Ug(this,o,a,c)}}class QK extends iA{constructor(o){super(),this.payload=o.map(a=>new oA(a))}setValue(o,a){a===void 0&&(a=!0),Array.isArray(o)?o.length===this.payload.length&&o.forEach((c,p)=>this.payload[p].setValue(c,a)):this.payload.forEach(c=>c.setValue(o,a))}getValue(){return this.payload.map(o=>o.getValue())}interpolate(o,a){return new Ug(this,o,a)}}let JK=0,eY=class{constructor(){this.id=void 0,this.idle=!0,this.hasChanged=!1,this.guid=0,this.local=0,this.props={},this.merged={},this.animations={},this.interpolations={},this.values={},this.configs=[],this.listeners=[],this.queue=[],this.localQueue=void 0,this.getValues=()=>this.interpolations,this.id=JK++}update(o){if(!o)return this;const a=MT(o),c=a.delay,p=c===void 0?0:c,_=a.to,x=Sg(a,["delay","to"]);if(yr.arr(_)||yr.fun(_))this.queue.push($i({},x,{delay:p,to:_}));else if(_){let T={};Object.entries(_).forEach(C=>{let P=C[0],O=C[1];const F=$i({to:{[P]:O},delay:pg(p,P)},x),U=T[F.delay]&&T[F.delay].to;T[F.delay]=$i({},T[F.delay],F,{to:$i({},U,F.to)})}),this.queue=Object.values(T)}return this.queue=this.queue.sort((T,C)=>T.delay-C.delay),this.diff(x),this}start(o){if(this.queue.length){this.idle=!1,this.localQueue&&this.localQueue.forEach(p=>{let _=p.from,x=_===void 0?{}:_,T=p.to,C=T===void 0?{}:T;yr.obj(x)&&(this.merged=$i({},x,this.merged)),yr.obj(C)&&(this.merged=$i({},this.merged,C))});const a=this.local=++this.guid,c=this.localQueue=this.queue;this.queue=[],c.forEach((p,_)=>{let x=p.delay,T=Sg(p,["delay"]);const C=O=>{_===c.length-1&&a===this.guid&&O&&(this.idle=!0,this.props.onRest&&this.props.onRest(this.merged)),o&&o()};let P=yr.arr(T.to)||yr.fun(T.to);x?setTimeout(()=>{a===this.guid&&(P?this.runAsync(T,C):this.diff(T).start(C))},x):P?this.runAsync(T,C):this.diff(T).start(C)})}else yr.fun(o)&&this.listeners.push(o),this.props.onStart&&this.props.onStart(),WK(this);return this}stop(o){return this.listeners.forEach(a=>a(o)),this.listeners=[],this}pause(o){return this.stop(!0),o&&ZK(this),this}runAsync(o,a){var c=this;o.delay;let p=Sg(o,["delay"]);const _=this.local;let x=Promise.resolve(void 0);if(yr.arr(p.to))for(let T=0;T<p.to.length;T++){const C=T,P=$i({},p,MT(p.to[C]));yr.arr(P.config)&&(P.config=P.config[C]),x=x.then(()=>{if(_===this.guid)return new Promise(O=>this.diff(P).start(O))})}else if(yr.fun(p.to)){let T=0,C;x=x.then(()=>p.to(P=>{const O=$i({},p,MT(P));if(yr.arr(O.config)&&(O.config=O.config[T]),T++,_===this.guid)return C=new Promise(F=>this.diff(O).start(F))},function(P){return P===void 0&&(P=!0),c.stop(P)}).then(()=>C))}x.then(a)}diff(o){this.props=$i({},this.props,o);let a=this.props,c=a.from,p=c===void 0?{}:c,_=a.to,x=_===void 0?{}:_,T=a.config,C=T===void 0?{}:T,P=a.reverse,O=a.attach,F=a.reset,U=a.immediate;if(P){var Z=[x,p];p=Z[0],x=Z[1]}this.merged=$i({},p,this.merged,x),this.hasChanged=!1;let $=O&&O(this);if(this.animations=Object.entries(this.merged).reduce((K,ie)=>{let H=ie[0],G=ie[1],ee=K[H]||{};const W=yr.num(G),me=yr.str(G)&&!G.startsWith("#")&&!/\d/.test(G)&&!ZF[G],de=yr.arr(G),he=!W&&!de&&!me;let se=yr.und(p[H])?G:p[H],q=W||de||me?G:1,Se=pg(C,H);$&&(q=$.animations[H].parent);let ze=ee.parent,Ue=ee.interpolation,Be=hw($?q.getPayload():q),rt,_t=G;he&&(_t=Vb({range:[0,1],output:[G,G]})(1));let zt=Ue&&Ue.getValue();const Te=!yr.und(ze)&&ee.animatedValues.some(De=>!De.done),we=!yr.equ(_t,zt),Q=!yr.equ(_t,ee.previous),ce=!yr.equ(Se,ee.config);if(F||Q&&we||ce){if(W||me)ze=Ue=ee.parent||new oA(se);else if(de)ze=Ue=ee.parent||new QK(se);else if(he){let De=ee.interpolation&&ee.interpolation.calc(ee.parent.value);De=De!==void 0&&!F?De:se,ee.parent?(ze=ee.parent,ze.setValue(0,!1)):ze=new oA(0);const He={output:[De,G]};ee.interpolation?(Ue=ee.interpolation,ee.interpolation.updateConfig(He)):Ue=ze.interpolate(He)}return Be=hw($?q.getPayload():q),rt=hw(ze.getPayload()),F&&!he&&ze.setValue(se,!1),this.hasChanged=!0,rt.forEach(De=>{De.startPosition=De.value,De.lastPosition=De.value,De.lastVelocity=Te?De.lastVelocity:void 0,De.lastTime=Te?De.lastTime:void 0,De.startTime=KF(),De.done=!1,De.animatedStyles.clear()}),pg(U,H)&&ze.setValue(he?q:G,!1),$i({},K,{[H]:$i({},ee,{name:H,parent:ze,interpolation:Ue,animatedValues:rt,toValues:Be,previous:_t,config:Se,fromValues:hw(ze.getValue()),immediate:pg(U,H),initialVelocity:yf(Se.velocity,0),clamp:yf(Se.clamp,!1),precision:yf(Se.precision,.01),tension:yf(Se.tension,170),friction:yf(Se.friction,26),mass:yf(Se.mass,1),duration:Se.duration,easing:yf(Se.easing,De=>De),decay:Se.decay})})}else return we?K:(he&&(ze.setValue(1,!1),Ue.updateConfig({output:[_t,_t]})),ze.done=!0,this.hasChanged=!0,$i({},K,{[H]:$i({},K[H],{previous:_t})}))},this.animations),this.hasChanged){this.configs=Object.values(this.animations),this.values={},this.interpolations={};for(let K in this.animations)this.interpolations[K]=this.animations[K].interpolation,this.values[K]=this.animations[K].interpolation.getValue()}return this}destroy(){this.stop(),this.props={},this.merged={},this.animations={},this.interpolations={},this.values={},this.configs=[],this.local=0}};const tY=(r,o)=>{const a=_e.useRef(!1),c=_e.useRef(),p=yr.fun(o),_=_e.useMemo(()=>{c.current&&(c.current.map(F=>F.destroy()),c.current=void 0);let O;return[new Array(r).fill().map((F,U)=>{const Z=new eY,$=p?pg(o,U,Z):o[U];return U===0&&(O=$.ref),Z.update($),O||Z.start(),Z}),O]},[r]),x=_[0],T=_[1];c.current=x,_e.useImperativeHandle(T,()=>({start:()=>Promise.all(c.current.map(O=>new Promise(F=>O.start(F)))),stop:O=>c.current.forEach(F=>F.stop(O)),get controllers(){return c.current}}));const C=_e.useMemo(()=>O=>c.current.map((F,U)=>{F.update(p?pg(O,U,F):O[U]),T||F.start()}),[r]);_e.useEffect(()=>{a.current?p||C(o):T||c.current.forEach(O=>O.start())}),_e.useEffect(()=>(a.current=!0,()=>c.current.forEach(O=>O.destroy())),[]);const P=c.current.map(O=>O.getValues());return p?[P,C,O=>c.current.forEach(F=>F.pause(O))]:P},nY=r=>{const o=yr.fun(r),a=tY(1,o?r:[r]),c=a[0],p=a[1],_=a[2];return o?[c[0],p,_]:c};class rY extends WF{constructor(o){o===void 0&&(o={}),super(),o.transform&&!(o.transform instanceof Al)&&(o=jM.transform(o)),this.payload=o}}const Gb={transparent:0,aliceblue:4042850303,antiquewhite:4209760255,aqua:16777215,aquamarine:2147472639,azure:4043309055,beige:4126530815,bisque:4293182719,black:255,blanchedalmond:4293643775,blue:65535,blueviolet:2318131967,brown:2771004159,burlywood:3736635391,burntsienna:3934150143,cadetblue:1604231423,chartreuse:2147418367,chocolate:3530104575,coral:4286533887,cornflowerblue:1687547391,cornsilk:4294499583,crimson:3692313855,cyan:16777215,darkblue:35839,darkcyan:9145343,darkgoldenrod:3095792639,darkgray:2846468607,darkgreen:6553855,darkgrey:2846468607,darkkhaki:3182914559,darkmagenta:2332068863,darkolivegreen:1433087999,darkorange:4287365375,darkorchid:2570243327,darkred:2332033279,darksalmon:3918953215,darkseagreen:2411499519,darkslateblue:1211993087,darkslategray:793726975,darkslategrey:793726975,darkturquoise:13554175,darkviolet:2483082239,deeppink:4279538687,deepskyblue:12582911,dimgray:1768516095,dimgrey:1768516095,dodgerblue:512819199,firebrick:2988581631,floralwhite:4294635775,forestgreen:579543807,fuchsia:4278255615,gainsboro:3705462015,ghostwhite:4177068031,gold:4292280575,goldenrod:3668254975,gray:2155905279,green:8388863,greenyellow:2919182335,grey:2155905279,honeydew:4043305215,hotpink:4285117695,indianred:3445382399,indigo:1258324735,ivory:4294963455,khaki:4041641215,lavender:3873897215,lavenderblush:4293981695,lawngreen:2096890111,lemonchiffon:4294626815,lightblue:2916673279,lightcoral:4034953471,lightcyan:3774873599,lightgoldenrodyellow:4210742015,lightgray:3553874943,lightgreen:2431553791,lightgrey:3553874943,lightpink:4290167295,lightsalmon:4288707327,lightseagreen:548580095,lightskyblue:2278488831,lightslategray:2005441023,lightslategrey:2005441023,lightsteelblue:2965692159,lightyellow:4294959359,lime:16711935,limegreen:852308735,linen:4210091775,magenta:4278255615,maroon:2147483903,mediumaquamarine:1724754687,mediumblue:52735,mediumorchid:3126187007,mediumpurple:2473647103,mediumseagreen:1018393087,mediumslateblue:2070474495,mediumspringgreen:16423679,mediumturquoise:1221709055,mediumvioletred:3340076543,midnightblue:421097727,mintcream:4127193855,mistyrose:4293190143,moccasin:4293178879,navajowhite:4292783615,navy:33023,oldlace:4260751103,olive:2155872511,olivedrab:1804477439,orange:4289003775,orangered:4282712319,orchid:3664828159,palegoldenrod:4008225535,palegreen:2566625535,paleturquoise:2951671551,palevioletred:3681588223,papayawhip:4293907967,peachpuff:4292524543,peru:3448061951,pink:4290825215,plum:3718307327,powderblue:2967529215,purple:2147516671,rebeccapurple:1714657791,red:4278190335,rosybrown:3163525119,royalblue:1097458175,saddlebrown:2336560127,salmon:4202722047,sandybrown:4104413439,seagreen:780883967,seashell:4294307583,sienna:2689740287,silver:3233857791,skyblue:2278484991,slateblue:1784335871,slategray:1887473919,slategrey:1887473919,snow:4294638335,springgreen:16744447,steelblue:1182971135,tan:3535047935,teal:8421631,thistle:3636451583,tomato:4284696575,turquoise:1088475391,violet:4001558271,wheat:4125012991,white:4294967295,whitesmoke:4126537215,yellow:4294902015,yellowgreen:2597139199},kl="[-+]?\\d*\\.?\\d+",Hb=kl+"%";function B2(){for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return"\\(\\s*("+o.join(")\\s*,\\s*(")+")\\s*\\)"}const iY=new RegExp("rgb"+B2(kl,kl,kl)),oY=new RegExp("rgba"+B2(kl,kl,kl,kl)),sY=new RegExp("hsl"+B2(kl,Hb,Hb)),aY=new RegExp("hsla"+B2(kl,Hb,Hb,kl)),lY=/^#([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,uY=/^#([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,cY=/^#([0-9a-fA-F]{6})$/,hY=/^#([0-9a-fA-F]{8})$/;function dY(r){let o;return typeof r=="number"?r>>>0===r&&r>=0&&r<=4294967295?r:null:(o=cY.exec(r))?parseInt(o[1]+"ff",16)>>>0:Gb.hasOwnProperty(r)?Gb[r]:(o=iY.exec(r))?(Km(o[1])<<24|Km(o[2])<<16|Km(o[3])<<8|255)>>>0:(o=oY.exec(r))?(Km(o[1])<<24|Km(o[2])<<16|Km(o[3])<<8|gO(o[4]))>>>0:(o=lY.exec(r))?parseInt(o[1]+o[1]+o[2]+o[2]+o[3]+o[3]+"ff",16)>>>0:(o=hY.exec(r))?parseInt(o[1],16)>>>0:(o=uY.exec(r))?parseInt(o[1]+o[1]+o[2]+o[2]+o[3]+o[3]+o[4]+o[4],16)>>>0:(o=sY.exec(r))?(pO(mO(o[1]),dw(o[2]),dw(o[3]))|255)>>>0:(o=aY.exec(r))?(pO(mO(o[1]),dw(o[2]),dw(o[3]))|gO(o[4]))>>>0:null}function IT(r,o,a){return a<0&&(a+=1),a>1&&(a-=1),a<1/6?r+(o-r)*6*a:a<1/2?o:a<2/3?r+(o-r)*(2/3-a)*6:r}function pO(r,o,a){const c=a<.5?a*(1+o):a+o-a*o,p=2*a-c,_=IT(p,c,r+1/3),x=IT(p,c,r),T=IT(p,c,r-1/3);return Math.round(_*255)<<24|Math.round(x*255)<<16|Math.round(T*255)<<8}function Km(r){const o=parseInt(r,10);return o<0?0:o>255?255:o}function mO(r){return(parseFloat(r)%360+360)%360/360}function gO(r){const o=parseFloat(r);return o<0?0:o>1?255:Math.round(o*255)}function dw(r){const o=parseFloat(r);return o<0?0:o>100?1:o/100}function yO(r){let o=dY(r);if(o===null)return r;o=o||0;let a=(o&4278190080)>>>24,c=(o&16711680)>>>16,p=(o&65280)>>>8,_=(o&255)/255;return`rgba(${a}, ${c}, ${p}, ${_})`}const fw=/[+\-]?(?:0|[1-9]\d*)(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,fY=/(#(?:[0-9a-f]{2}){2,4}|(#[0-9a-f]{3})|(rgb|hsl)a?\((-?\d+%?[,\s]+){2,3}\s*[\d\.]+%?\))/gi,pY=new RegExp(`(${Object.keys(Gb).join("|")})`,"g"),mY=r=>{const o=r.output.map(p=>p.replace(fY,yO)).map(p=>p.replace(pY,yO)),a=o[0].match(fw).map(()=>[]);o.forEach(p=>{p.match(fw).forEach((_,x)=>a[x].push(+_))});const c=o[0].match(fw).map((p,_)=>$b($i({},r,{output:a[_]})));return p=>{let _=0;return o[0].replace(fw,()=>c[_++](p)).replace(/rgba\(([0-9\.-]+), ([0-9\.-]+), ([0-9\.-]+), ([0-9\.-]+)\)/gi,(x,T,C,P,O)=>`rgba(${Math.round(T)}, ${Math.round(C)}, ${Math.round(P)}, ${O})`)}};let j0={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0};const gY=(r,o)=>r+o.charAt(0).toUpperCase()+o.substring(1),yY=["Webkit","Ms","Moz","O"];j0=Object.keys(j0).reduce((r,o)=>(yY.forEach(a=>r[gY(a,o)]=r[o]),r),j0);function _Y(r,o,a){return o==null||typeof o=="boolean"||o===""?"":!a&&typeof o=="number"&&o!==0&&!(j0.hasOwnProperty(r)&&j0[r])?o+"px":(""+o).trim()}const _O={};$K(r=>new rY(r));UK(mY);jK(Gb);NK((r,o)=>{if(r.nodeType&&r.setAttribute!==void 0){const p=o.style,_=o.children,x=o.scrollTop,T=o.scrollLeft,C=Sg(o,["style","children","scrollTop","scrollLeft"]),P=r.nodeName==="filter"||r.parentNode&&r.parentNode.nodeName==="filter";x!==void 0&&(r.scrollTop=x),T!==void 0&&(r.scrollLeft=T),_!==void 0&&(r.textContent=_);for(let O in p)if(p.hasOwnProperty(O)){var a=O.indexOf("--")===0,c=_Y(O,p[O],a);O==="float"&&(O="cssFloat"),a?r.style.setProperty(O,c):r.style[O]=c}for(let O in C){const F=P?O:_O[O]||(_O[O]=O.replace(/([A-Z])/g,U=>"-"+U.toLowerCase()));typeof r.getAttribute(F)<"u"&&r.setAttribute(F,C[O])}return}else return!1},r=>r);const vY=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"],xY=OK(qK,!1),wY=xY(vY);function vO(r,o){return r.map(function(a,c){return a+o[c]})}function eB(r,o){return r.map(function(a,c){return a-o[c]})}function sA(r){return Math.hypot.apply(Math,r)}function bY(r,o,a){var c=sA(o),p=c===0?0:1/c,_=a===0?0:1/a,x=_*c,T=o.map(function(O){return _*O}),C=o.map(function(O){return p*O}),P=sA(r);return{velocities:T,velocity:x,distance:P,direction:C}}function aA(r){return Math.sign?Math.sign(r):+(r>0)-+(r<0)||+r}function SY(r,o,a){return Math.max(o,Math.min(r,a))}function EY(r,o){return Math.pow(r,o*5)}function xO(r,o,a){return o===0||Math.abs(o)===1/0?EY(r,a):r*o*a/(o+a*r)}function U0(r,o,a,c){return c===void 0&&(c=.15),c===0?SY(r,o,a):r<o?-xO(o-r,a-o,c)+o:r>a?+xO(r-a,a-o,c)+a:r}function wO(r,o){for(var a=0;a<o.length;a++){var c=o[a];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(r,c.key,c)}}function TY(r,o,a){return o&&wO(r.prototype,o),a&&wO(r,a),r}function ws(){return ws=Object.assign||function(r){for(var o=1;o<arguments.length;o++){var a=arguments[o];for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(r[c]=a[c])}return r},ws.apply(this,arguments)}function tB(r,o){r.prototype=Object.create(o.prototype),r.prototype.constructor=r,r.__proto__=o}function CY(r,o){if(r==null)return{};var a={},c=Object.keys(r),p,_;for(_=0;_<c.length;_++)p=c[_],!(o.indexOf(p)>=0)&&(a[p]=r[p]);return a}function pw(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function AY(r,o){if(r){if(typeof r=="string")return bO(r,o);var a=Object.prototype.toString.call(r).slice(8,-1);if(a==="Object"&&r.constructor&&(a=r.constructor.name),a==="Map"||a==="Set")return Array.from(r);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return bO(r,o)}}function bO(r,o){(o==null||o>r.length)&&(o=r.length);for(var a=0,c=new Array(o);a<o;a++)c[a]=r[a];return c}function N2(r,o){var a;if(typeof Symbol>"u"||r[Symbol.iterator]==null){if(Array.isArray(r)||(a=AY(r))||o&&r&&typeof r.length=="number"){a&&(r=a);var c=0;return function(){return c>=r.length?{done:!0}:{done:!1,value:r[c++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}return a=r[Symbol.iterator](),a.next.bind(a)}function nB(){}function rB(){for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return o.length===0?nB:o.length===1?o[0]:function(){for(var c,p=N2(o),_;!(_=p()).done;){var x=_.value;c=x.apply(this,arguments)||c}return c}}function Nh(r,o){if(r===void 0){if(o===void 0)throw new Error("Must define fallback value if undefined is expected");r=o}return Array.isArray(r)?r:[r,r]}function mw(r){if(typeof r=="function"){for(var o=arguments.length,a=new Array(o>1?o-1:0),c=1;c<o;c++)a[c-1]=arguments[c];return r.apply(void 0,a)}else return r}function UM(r,o){r===void 0&&(r={});for(var a={},c=0,p=Object.entries(o);c<p.length;c++){var _=p[c],x=_[0],T=_[1];switch(typeof T){case"function":a[x]=T.call(a,r[x],x,r);break;case"object":a[x]=UM(r[x],T);break;case"boolean":T&&(a[x]=r[x]);break}}return a}var MY=180,IY=.15,kY=.5,PY=60,RY={threshold:function(o){return o===void 0&&(o=0),Nh(o)},rubberband:function(o){switch(o===void 0&&(o=0),o){case!0:return Nh(IY);case!1:return Nh(0);default:return Nh(o)}},enabled:function(o){return o===void 0&&(o=!0),o},triggerAllEvents:function(o){return o===void 0&&(o=!1),o},initial:function(o){return o===void 0&&(o=0),typeof o=="function"?o:Nh(o)}},iB=ws({},RY,{axis:!0,lockDirection:function(o){return o===void 0&&(o=!1),o},bounds:function(o){if(o===void 0&&(o={}),typeof o=="function")return function(F){return iB.bounds(o(F))};var a=o,c=a.left,p=c===void 0?-1/0:c,_=a.right,x=_===void 0?1/0:_,T=a.top,C=T===void 0?-1/0:T,P=a.bottom,O=P===void 0?1/0:P;return[[p,x],[C,O]]}}),DY=typeof window<"u"&&window.document&&window.document.createElement,LY={enabled:function(o){return o===void 0&&(o=!0),o},domTarget:!0,window:function(r){function o(a){return r.apply(this,arguments)}return o.toString=function(){return r.toString()},o}(function(r){return r===void 0&&(r=DY?window:void 0),r}),eventOptions:function(o){var a=o===void 0?{}:o,c=a.passive,p=c===void 0?!0:c,_=a.capture,x=_===void 0?!1:_;return{passive:p,capture:x}}},OY=ws({},iB,{threshold:function(o,a,c){var p=c.filterTaps,_=p===void 0?!1:p,x=c.lockDirection,T=x===void 0?!1:x,C=c.axis,P=C===void 0?void 0:C,O=Nh(o,_?3:T||P?1:0);return this.filterTaps=_||O[0]+O[1]>0,O},swipeVelocity:function(o){return o===void 0&&(o=kY),Nh(o)},swipeDistance:function(o){return o===void 0&&(o=PY),Nh(o)},delay:function(o){switch(o===void 0&&(o=0),o){case!0:return MY;case!1:return 0;default:return o}}});function zY(r){return r===void 0&&(r={}),UM(r,LY)}function FY(r){return r===void 0&&(r={}),UM(r,OY)}function BY(r){var o=r.domTarget,a=r.eventOptions,c=r.window,p=r.enabled,_=CY(r,["domTarget","eventOptions","window","enabled"]),x=zY({domTarget:o,eventOptions:a,window:c,enabled:p});return x.drag=FY(_),x}function a0(r){return ws({_active:!1,_blocked:!1,_intentional:[!1,!1],_movement:[0,0],_initial:[0,0],_bounds:[[-1/0,1/0],[-1/0,1/0]],_lastEventType:void 0,event:void 0,intentional:!1,values:[0,0],velocities:[0,0],delta:[0,0],movement:[0,0],offset:[0,0],lastOffset:[0,0],direction:[0,0],initial:[0,0],previous:[0,0],first:!1,last:!1,active:!1,timeStamp:0,startTime:0,elapsedTime:0,cancel:nB,canceled:!1,memo:void 0,args:void 0},r)}function oB(){var r={hovering:!1,scrolling:!1,wheeling:!1,dragging:!1,moving:!1,pinching:!1,touches:0,buttons:0,down:!1,shiftKey:!1,altKey:!1,metaKey:!1,ctrlKey:!1},o=a0({axis:void 0,xy:[0,0],vxvy:[0,0],velocity:0,distance:0,_isTap:!0,_delayedEvent:!1,_pointerId:void 0,tap:!1,swipe:[0,0]}),a=a0({da:[0,0],vdva:[0,0],origin:void 0,turns:0}),c=a0({axis:void 0,xy:[0,0],vxvy:[0,0],velocity:0,distance:0}),p=a0({axis:void 0,xy:[0,0],vxvy:[0,0],velocity:0,distance:0}),_=a0({axis:void 0,xy:[0,0],vxvy:[0,0],velocity:0,distance:0});return{shared:r,drag:o,pinch:a,wheel:c,move:p,scroll:_}}var wf=new Map,NY=function(){function r(a,c){var p=this;c===void 0&&(c=[]),this.controller=a,this.args=c,this.debounced=!0,this.setTimeout=function(_,x){var T;x===void 0&&(x=140),clearTimeout(p.controller.timeouts[p.stateKey]);for(var C=arguments.length,P=new Array(C>2?C-2:0),O=2;O<C;O++)P[O-2]=arguments[O];p.controller.timeouts[p.stateKey]=(T=window).setTimeout.apply(T,[_,x].concat(P))},this.clearTimeout=function(){clearTimeout(p.controller.timeouts[p.stateKey])},this.fireGestureHandler=function(_){if(_===void 0&&(_=!1),p.state._blocked)return p.debounced||(p.state._active=!1,p.clean()),null;if(!_&&!p.state.intentional&&!p.config.triggerAllEvents)return null;if(p.state.intentional){var x=p.state.active,T=p.state._active;p.state.active=T,p.state.first=T&&!x,p.state.last=x&&!T,p.controller.state.shared[p.ingKey]=T}var C=ws({},p.controller.state.shared,p.state,p.mapStateValues(p.state)),P=p.handler(C);return p.state.memo=P!==void 0?P:p.state.memo,p.state._active||p.clean(),C}}var o=r.prototype;return o.updateSharedState=function(c){Object.assign(this.controller.state.shared,c)},o.updateGestureState=function(c){Object.assign(this.state,c)},o.checkIntentionality=function(c,p){return{_intentional:c,_blocked:!1}},o.getMovement=function(c){var p=this.config,_=p.initial,x=p.bounds,T=p.rubberband,C=p.threshold,P=this.state,O=P._bounds,F=P._initial,U=P._active,Z=P._intentional,$=P.lastOffset,K=P.movement,ie=this.getInternalMovement(c,this.state),H=Z[0]===!1?SO(ie[0],C[0]):Z[0],G=Z[1]===!1?SO(ie[1],C[1]):Z[1],ee=this.checkIntentionality([H,G],ie);if(ee._blocked)return ws({},ee,{_movement:ie,delta:[0,0]});var W=ee._intentional,me=ie,de,he;if(W[0]!==!1&&Z[0]===!1&&(he=mw(_,this.state),de=mw(x,this.state),F[0]=he[0],O[0]=de[0]),W[1]!==!1&&Z[1]===!1){var se,q;he=(se=he)!=null?se:mw(_,this.state),de=(q=de)!=null?q:mw(x,this.state),F[1]=he[1],O[1]=de[1]}var Se=[W[0]!==!1?ie[0]-W[0]:F[0],W[1]!==!1?ie[1]-W[1]:F[1]],ze=vO(Se,$),Ue=U?T:[0,0];return Se=EO(O,vO(Se,F),Ue),ws({},ee,{intentional:W[0]!==!1||W[1]!==!1,_initial:F,_movement:me,movement:Se,values:c,offset:EO(O,ze,Ue),delta:eB(Se,K)})},o.clean=function(){this.clearTimeout()},TY(r,[{key:"config",get:function(){return this.controller.config[this.stateKey]}},{key:"enabled",get:function(){return this.controller.config.enabled&&this.config.enabled}},{key:"state",get:function(){return this.controller.state[this.stateKey]}},{key:"handler",get:function(){return this.controller.handlers[this.stateKey]}}]),r}();function SO(r,o){return Math.abs(r)>=o?aA(r)*o:!1}function EO(r,o,a){var c=o[0],p=o[1],_=a[0],x=a[1],T=r[0],C=T[0],P=T[1],O=r[1],F=O[0],U=O[1];return[U0(c,C,P,_),U0(p,F,U,x)]}function kT(r,o,a){var c=r.state,p=r.args,_=o.timeStamp,x=o.type,T=c.values,C=a?0:_-c.startTime;return{_lastEventType:x,event:o,timeStamp:_,elapsedTime:C,args:p,previous:T}}function jY(r,o,a){var c=r.state.offset,p=a.timeStamp;return ws({},oB()[r.stateKey],{_active:!0,values:o,initial:o,offset:c,lastOffset:c,startTime:p})}function UY(r,o){return function(a){for(var c=arguments.length,p=new Array(c>1?c-1:0),_=1;_<c;_++)p[_-1]=arguments[_];return r.call.apply(r,[this,ws({},o,{event:a})].concat(p))}}var VY=function(o){var a=this;this.classes=o,this.bind=function(){for(var c={},p=arguments.length,_=new Array(p),x=0;x<p;x++)_[x]=arguments[x];for(var T=N2(a.classes),C;!(C=T()).done;){var P=C.value;new P(a,_).addBindings(c)}for(var O=0,F=Object.entries(a.nativeRefs);O<F.length;O++){var U=F[O],Z=U[0],$=U[1];lA(c,Z,UY($,ws({},a.state.shared,{args:_})))}return a.config.domTarget?qY(a,c):WY(a,c)},this.effect=function(){return a.config.domTarget&&a.bind(),a.clean},this.clean=function(){var c=aB(a.config),p=a.config.eventOptions;c&&kv(c,sB(a.domListeners),p),Object.values(a.timeouts).forEach(clearTimeout),$Y(a)},this.state=oB(),this.timeouts={},this.domListeners=[],this.windowListeners={}};function $Y(r){var o=r.config,a=o.window,c=o.eventOptions,p=r.windowListeners;if(a){for(var _ in p){var x=p[_];kv(a,x,c)}r.windowListeners={}}}function GY(r,o){var a=r.config,c=r.windowListeners;a.window&&(kv(a.window,c[o],a.eventOptions),delete c[o])}function HY(r,o,a){var c=r.config,p=r.windowListeners;a===void 0&&(a=[]),c.window&&(kv(c.window,p[o],c.eventOptions),lB(c.window,p[o]=a,c.eventOptions))}function qY(r,o){var a=r.config,c=r.domListeners,p=aB(a);if(!p)throw new Error("domTarget must be defined");var _=a.eventOptions;kv(p,sB(c),_);for(var x=0,T=Object.entries(o);x<T.length;x++){var C=T[x],P=C[0],O=C[1],F=P.slice(2).toLowerCase();c.push([F,rB.apply(void 0,O)])}lB(p,c,_)}function WY(r,o){for(var a=r.config,c={},p=a.eventOptions.capture?"Capture":"",_=0,x=Object.entries(o);_<x.length;_++){var T=x[_],C=T[0],P=T[1],O=Array.isArray(P)?P:[P],F=C+p;c[F]=rB.apply(void 0,O)}return c}function sB(r){return r===void 0&&(r=[]),r.splice(0,r.length)}function aB(r){var o=r.domTarget;return o&&"current"in o?o.current:o}function lA(r,o,a){r[o]||(r[o]=[]),r[o].push(a)}function lB(r,o,a){o===void 0&&(o=[]),a===void 0&&(a={});for(var c=N2(o),p;!(p=c()).done;){var _=p.value,x=_[0],T=_[1];r.addEventListener(x,T,a)}}function kv(r,o,a){o===void 0&&(o=[]),a===void 0&&(a={});for(var c=N2(o),p;!(p=c()).done;){var _=p.value,x=_[0],T=_[1];r.removeEventListener(x,T,a)}}function ZY(r,o,a){a===void 0&&(a={});var c=KY(r),p=Xn.useMemo(function(){return new VY(c)},[]);return p.config=o,p.handlers=r,p.nativeRefs=a,Xn.useEffect(p.effect,[]),p.config.domTarget?XY:p.bind}function XY(){}function KY(r){var o=new Set;return r.drag&&o.add(wf.get("drag")),r.wheel&&o.add(wf.get("wheel")),r.scroll&&o.add(wf.get("scroll")),r.move&&o.add(wf.get("move")),r.pinch&&o.add(wf.get("pinch")),r.hover&&o.add(wf.get("hover")),o}var YY=function(r){tB(o,r);function o(){return r.apply(this,arguments)||this}var a=o.prototype;return a.getInternalMovement=function(p,_){return eB(p,_.initial)},a.checkIntentionality=function(p,_){if(p[0]===!1&&p[1]===!1)return{_intentional:p,axis:this.state.axis};var x=_.map(Math.abs),T=x[0],C=x[1],P=this.state.axis||(T>C?"x":T<C?"y":void 0);return!this.config.axis&&!this.config.lockDirection?{_intentional:p,_blocked:!1,axis:P}:P?this.config.axis&&P!==this.config.axis?{_intentional:p,_blocked:!0,axis:P}:(p[P==="x"?1:0]=!1,{_intentional:p,_blocked:!1,axis:P}):{_intentional:[!1,!1],_blocked:!1,axis:P}},a.getKinematics=function(p,_){var x=this.getMovement(p);if(!x._blocked){var T=_.timeStamp-this.state.timeStamp;Object.assign(x,bY(x.movement,x.delta,T))}return x},a.mapStateValues=function(p){return{xy:p.values,vxvy:p.velocities}},o}(NY);function uB(r){if("touches"in r){var o=r.targetTouches,a=r.changedTouches;return o.length>0?o:a}return null}function TO(r){var o="buttons"in r?r.buttons:0,a=uB(r),c=a&&a.length||0,p=c>0||o>0,_=r.shiftKey,x=r.altKey,T=r.metaKey,C=r.ctrlKey;return{touches:c,down:p,buttons:o,shiftKey:_,altKey:x,metaKey:T,ctrlKey:C}}function CO(r){var o=uB(r),a=o?o[0]:r,c=a.clientX,p=a.clientY;return[c,p]}var QY=3,JY=220,eQ=function(r){tB(o,r);function o(){var c;return c=r.apply(this,arguments)||this,c.ingKey="dragging",c.stateKey="drag",c.onDragStart=function(p){!c.enabled||c.state._active||(HY(c.controller,c.stateKey,[["pointermove",c.onDragChange],["pointerup",c.onDragEnd],["pointercancel",c.onDragEnd]]),c.updateGestureState({_pointerId:p.pointerId}),c.config.delay>0?(c.state._delayedEvent=!0,"persist"in p&&typeof p.persist=="function"&&p.persist(),c.setTimeout(c.startDrag.bind(pw(c)),c.config.delay,p)):c.startDrag(p))},c.onDragChange=function(p){if(!c.state.canceled&&p.pointerId===c.state._pointerId){if(!c.state._active){c.state._delayedEvent&&(c.clearTimeout(),c.startDrag(p));return}var _=TO(p);if(!_.down){c.onDragEnd(p);return}c.updateSharedState(_);var x=CO(p),T=c.getKinematics(x,p),C=kT(pw(c),p),P=c.state._isTap,O=sA(T._movement);P&&O>=QY&&(P=!1),c.updateGestureState(ws({},C,T,{_isTap:P})),c.fireGestureHandler()}},c.onDragEnd=function(p){if(p.pointerId===c.state._pointerId){c.state._active=!1,c.updateSharedState({down:!1,buttons:0,touches:0});var _=c.state._isTap,x=c.state.velocities,T=x[0],C=x[1],P=c.state.movement,O=P[0],F=P[1],U=c.state._intentional,Z=U[0],$=U[1],K=c.config.swipeVelocity,ie=K[0],H=K[1],G=c.config.swipeDistance,ee=G[0],W=G[1],me=ws({},kT(pw(c),p),c.getMovement(c.state.values)),de=[0,0];me.elapsedTime<JY&&(Z!==!1&&Math.abs(T)>ie&&Math.abs(O)>ee&&(de[0]=aA(T)),$!==!1&&Math.abs(C)>H&&Math.abs(F)>W&&(de[1]=aA(C))),c.updateGestureState(ws({},me,{tap:_,swipe:de})),c.fireGestureHandler(_===!0)}},c.clean=function(){r.prototype.clean.call(pw(c)),c.state._delayedEvent=!1,GY(c.controller,c.stateKey)},c.onCancel=function(){c.state.canceled||(c.updateGestureState({canceled:!0}),c.state._active=!1,c.updateSharedState({down:!1,buttons:0,touches:0}),requestAnimationFrame(function(){return c.fireGestureHandler()}))},c.onClick=function(p){c.state._isTap||p.stopPropagation()},c}var a=o.prototype;return a.startDrag=function(p){var _=CO(p);this.updateSharedState(TO(p)),this.updateGestureState(ws({},jY(this,_,p),kT(this,p,!0),{_pointerId:p.pointerId,cancel:this.onCancel})),this.updateGestureState(this.getMovement(_)),this.fireGestureHandler()},a.addBindings=function(p){if(lA(p,"onPointerDown",this.onDragStart),this.config.filterTaps){var _=this.controller.config.eventOptions.capture?"onClick":"onClickCapture";lA(p,_,this.onClick)}},o}(YY);function tQ(r,o){var a,c=[],p,_=!1;function x(){for(var T=arguments.length,C=new Array(T),P=0;P<T;P++)C[P]=arguments[P];return _&&a===this&&o(C,c)||(p=r.apply(this,C),_=!0,a=this,c=C),p}return x}function Ww(r,o){if(r===o)return!0;if(r&&o&&typeof r=="object"&&typeof o=="object"){if(r.constructor!==o.constructor)return!1;var a,c,p;if(Array.isArray(r)){if(a=r.length,a!==o.length)return!1;for(c=a;c--!==0;)if(!Ww(r[c],o[c]))return!1;return!0}var _;if(typeof Map=="function"&&r instanceof Map&&o instanceof Map){if(r.size!==o.size)return!1;for(_=r.entries();!(c=_.next()).done;)if(!o.has(c.value[0]))return!1;for(_=r.entries();!(c=_.next()).done;)if(!Ww(c.value[1],o.get(c.value[0])))return!1;return!0}if(typeof Set=="function"&&r instanceof Set&&o instanceof Set){if(r.size!==o.size)return!1;for(_=r.entries();!(c=_.next()).done;)if(!o.has(c.value[0]))return!1;return!0}if(r.constructor===RegExp)return r.source===o.source&&r.flags===o.flags;if(r.valueOf!==Object.prototype.valueOf)return r.valueOf()===o.valueOf();if(r.toString!==Object.prototype.toString)return r.toString()===o.toString();if(p=Object.keys(r),a=p.length,a!==Object.keys(o).length)return!1;for(c=a;c--!==0;)if(!Object.prototype.hasOwnProperty.call(o,p[c]))return!1;if(typeof Element<"u"&&r instanceof Element)return!1;for(c=a;c--!==0;)if(!(p[c]==="_owner"&&r.$$typeof)&&!Ww(r[p[c]],o[p[c]]))return!1;return!0}return r!==r&&o!==o}function nQ(r,o){try{return Ww(r,o)}catch(a){if((a.message||"").match(/stack|recursion/i))return console.warn("react-fast-compare cannot handle circular refs"),!1;throw a}}function rQ(r,o){o===void 0&&(o={}),wf.set("drag",eQ);var a=_e.useRef();return a.current||(a.current=tQ(BY,nQ)),ZY({drag:r},a.current(o))}/*!
* tabbable 5.3.3
* @license MIT, https://github.com/focus-trap/tabbable/blob/master/LICENSE
*/var cB=["input","select","textarea","a[href]","button","[tabindex]:not(slot)","audio[controls]","video[controls]",'[contenteditable]:not([contenteditable="false"])',"details>summary:first-of-type","details"],qb=cB.join(","),hB=typeof Element>"u",jf=hB?function(){}:Element.prototype.matches||Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector,uA=!hB&&Element.prototype.getRootNode?function(r){return r.getRootNode()}:function(r){return r.ownerDocument},dB=function(o,a,c){var p=Array.prototype.slice.apply(o.querySelectorAll(qb));return a&&jf.call(o,qb)&&p.unshift(o),p=p.filter(c),p},fB=function r(o,a,c){for(var p=[],_=Array.from(o);_.length;){var x=_.shift();if(x.tagName==="SLOT"){var T=x.assignedElements(),C=T.length?T:x.children,P=r(C,!0,c);c.flatten?p.push.apply(p,P):p.push({scope:x,candidates:P})}else{var O=jf.call(x,qb);O&&c.filter(x)&&(a||!o.includes(x))&&p.push(x);var F=x.shadowRoot||typeof c.getShadowRoot=="function"&&c.getShadowRoot(x),U=!c.shadowRootFilter||c.shadowRootFilter(x);if(F&&U){var Z=r(F===!0?x.children:F.children,!0,c);c.flatten?p.push.apply(p,Z):p.push({scope:x,candidates:Z})}else _.unshift.apply(_,x.children)}}return p},pB=function(o,a){return o.tabIndex<0&&(a||/^(AUDIO|VIDEO|DETAILS)$/.test(o.tagName)||o.isContentEditable)&&isNaN(parseInt(o.getAttribute("tabindex"),10))?0:o.tabIndex},iQ=function(o,a){return o.tabIndex===a.tabIndex?o.documentOrder-a.documentOrder:o.tabIndex-a.tabIndex},mB=function(o){return o.tagName==="INPUT"},oQ=function(o){return mB(o)&&o.type==="hidden"},sQ=function(o){var a=o.tagName==="DETAILS"&&Array.prototype.slice.apply(o.children).some(function(c){return c.tagName==="SUMMARY"});return a},aQ=function(o,a){for(var c=0;c<o.length;c++)if(o[c].checked&&o[c].form===a)return o[c]},lQ=function(o){if(!o.name)return!0;var a=o.form||uA(o),c=function(T){return a.querySelectorAll('input[type="radio"][name="'+T+'"]')},p;if(typeof window<"u"&&typeof window.CSS<"u"&&typeof window.CSS.escape=="function")p=c(window.CSS.escape(o.name));else try{p=c(o.name)}catch(x){return console.error("Looks like you have a radio button with a name attribute containing invalid CSS selector characters and need the CSS.escape polyfill: %s",x.message),!1}var _=aQ(p,o.form);return!_||_===o},uQ=function(o){return mB(o)&&o.type==="radio"},cQ=function(o){return uQ(o)&&!lQ(o)},AO=function(o){var a=o.getBoundingClientRect(),c=a.width,p=a.height;return c===0&&p===0},hQ=function(o,a){var c=a.displayCheck,p=a.getShadowRoot;if(getComputedStyle(o).visibility==="hidden")return!0;var _=jf.call(o,"details>summary:first-of-type"),x=_?o.parentElement:o;if(jf.call(x,"details:not([open]) *"))return!0;var T=uA(o).host,C=(T==null?void 0:T.ownerDocument.contains(T))||o.ownerDocument.contains(o);if(!c||c==="full"){if(typeof p=="function"){for(var P=o;o;){var O=o.parentElement,F=uA(o);if(O&&!O.shadowRoot&&p(O)===!0)return AO(o);o.assignedSlot?o=o.assignedSlot:!O&&F!==o.ownerDocument?o=F.host:o=O}o=P}if(C)return!o.getClientRects().length}else if(c==="non-zero-area")return AO(o);return!1},dQ=function(o){if(/^(INPUT|BUTTON|SELECT|TEXTAREA)$/.test(o.tagName))for(var a=o.parentElement;a;){if(a.tagName==="FIELDSET"&&a.disabled){for(var c=0;c<a.children.length;c++){var p=a.children.item(c);if(p.tagName==="LEGEND")return jf.call(a,"fieldset[disabled] *")?!0:!p.contains(o)}return!0}a=a.parentElement}return!1},Wb=function(o,a){return!(a.disabled||oQ(a)||hQ(a,o)||sQ(a)||dQ(a))},cA=function(o,a){return!(cQ(a)||pB(a)<0||!Wb(o,a))},fQ=function(o){var a=parseInt(o.getAttribute("tabindex"),10);return!!(isNaN(a)||a>=0)},pQ=function r(o){var a=[],c=[];return o.forEach(function(p,_){var x=!!p.scope,T=x?p.scope:p,C=pB(T,x),P=x?r(p.candidates):T;C===0?x?a.push.apply(a,P):a.push(T):c.push({documentOrder:_,tabIndex:C,item:p,isScope:x,content:P})}),c.sort(iQ).reduce(function(p,_){return _.isScope?p.push.apply(p,_.content):p.push(_.content),p},[]).concat(a)},mQ=function(o,a){a=a||{};var c;return a.getShadowRoot?c=fB([o],a.includeContainer,{filter:cA.bind(null,a),flatten:!1,getShadowRoot:a.getShadowRoot,shadowRootFilter:fQ}):c=dB(o,a.includeContainer,cA.bind(null,a)),pQ(c)},gQ=function(o,a){a=a||{};var c;return a.getShadowRoot?c=fB([o],a.includeContainer,{filter:Wb.bind(null,a),flatten:!0,getShadowRoot:a.getShadowRoot}):c=dB(o,a.includeContainer,Wb.bind(null,a)),c},gw=function(o,a){if(a=a||{},!o)throw new Error("No node provided");return jf.call(o,qb)===!1?!1:cA(a,o)},yQ=cB.concat("iframe").join(","),PT=function(o,a){if(a=a||{},!o)throw new Error("No node provided");return jf.call(o,yQ)===!1?!1:Wb(a,o)};/*!
* focus-trap 6.9.4
* @license MIT, https://github.com/focus-trap/focus-trap/blob/master/LICENSE
*/function MO(r,o){var a=Object.keys(r);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(r);o&&(c=c.filter(function(p){return Object.getOwnPropertyDescriptor(r,p).enumerable})),a.push.apply(a,c)}return a}function IO(r){for(var o=1;o<arguments.length;o++){var a=arguments[o]!=null?arguments[o]:{};o%2?MO(Object(a),!0).forEach(function(c){_Q(r,c,a[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(a)):MO(Object(a)).forEach(function(c){Object.defineProperty(r,c,Object.getOwnPropertyDescriptor(a,c))})}return r}function _Q(r,o,a){return o in r?Object.defineProperty(r,o,{value:a,enumerable:!0,configurable:!0,writable:!0}):r[o]=a,r}var kO=function(){var r=[];return{activateTrap:function(a){if(r.length>0){var c=r[r.length-1];c!==a&&c.pause()}var p=r.indexOf(a);p===-1||r.splice(p,1),r.push(a)},deactivateTrap:function(a){var c=r.indexOf(a);c!==-1&&r.splice(c,1),r.length>0&&r[r.length-1].unpause()}}}(),vQ=function(o){return o.tagName&&o.tagName.toLowerCase()==="input"&&typeof o.select=="function"},xQ=function(o){return o.key==="Escape"||o.key==="Esc"||o.keyCode===27},wQ=function(o){return o.key==="Tab"||o.keyCode===9},PO=function(o){return setTimeout(o,0)},RO=function(o,a){var c=-1;return o.every(function(p,_){return a(p)?(c=_,!1):!0}),c},l0=function(o){for(var a=arguments.length,c=new Array(a>1?a-1:0),p=1;p<a;p++)c[p-1]=arguments[p];return typeof o=="function"?o.apply(void 0,c):o},yw=function(o){return o.target.shadowRoot&&typeof o.composedPath=="function"?o.composedPath()[0]:o.target},bQ=function(o,a){var c=(a==null?void 0:a.document)||document,p=IO({returnFocusOnDeactivate:!0,escapeDeactivates:!0,delayInitialFocus:!0},a),_={containers:[],containerGroups:[],tabbableGroups:[],nodeFocusedBeforeActivation:null,mostRecentlyFocusedNode:null,active:!1,paused:!1,delayInitialFocusTimer:void 0},x,T=function(de,he,se){return de&&de[he]!==void 0?de[he]:p[se||he]},C=function(de){return _.containerGroups.findIndex(function(he){var se=he.container,q=he.tabbableNodes;return se.contains(de)||q.find(function(Se){return Se===de})})},P=function(de){var he=p[de];if(typeof he=="function"){for(var se=arguments.length,q=new Array(se>1?se-1:0),Se=1;Se<se;Se++)q[Se-1]=arguments[Se];he=he.apply(void 0,q)}if(he===!0&&(he=void 0),!he){if(he===void 0||he===!1)return he;throw new Error("`".concat(de,"` was specified but was not a node, or did not return a node"))}var ze=he;if(typeof he=="string"&&(ze=c.querySelector(he),!ze))throw new Error("`".concat(de,"` as selector refers to no known node"));return ze},O=function(){var de=P("initialFocus");if(de===!1)return!1;if(de===void 0)if(C(c.activeElement)>=0)de=c.activeElement;else{var he=_.tabbableGroups[0],se=he&&he.firstTabbableNode;de=se||P("fallbackFocus")}if(!de)throw new Error("Your focus-trap needs to have at least one focusable element");return de},F=function(){if(_.containerGroups=_.containers.map(function(de){var he=mQ(de,p.tabbableOptions),se=gQ(de,p.tabbableOptions);return{container:de,tabbableNodes:he,focusableNodes:se,firstTabbableNode:he.length>0?he[0]:null,lastTabbableNode:he.length>0?he[he.length-1]:null,nextTabbableNode:function(Se){var ze=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,Ue=se.findIndex(function(Be){return Be===Se});if(!(Ue<0))return ze?se.slice(Ue+1).find(function(Be){return gw(Be,p.tabbableOptions)}):se.slice(0,Ue).reverse().find(function(Be){return gw(Be,p.tabbableOptions)})}}}),_.tabbableGroups=_.containerGroups.filter(function(de){return de.tabbableNodes.length>0}),_.tabbableGroups.length<=0&&!P("fallbackFocus"))throw new Error("Your focus-trap must have at least one container with at least one tabbable node in it at all times")},U=function me(de){if(de!==!1&&de!==c.activeElement){if(!de||!de.focus){me(O());return}de.focus({preventScroll:!!p.preventScroll}),_.mostRecentlyFocusedNode=de,vQ(de)&&de.select()}},Z=function(de){var he=P("setReturnFocus",de);return he||(he===!1?!1:de)},$=function(de){var he=yw(de);if(!(C(he)>=0)){if(l0(p.clickOutsideDeactivates,de)){x.deactivate({returnFocus:p.returnFocusOnDeactivate&&!PT(he,p.tabbableOptions)});return}l0(p.allowOutsideClick,de)||de.preventDefault()}},K=function(de){var he=yw(de),se=C(he)>=0;se||he instanceof Document?se&&(_.mostRecentlyFocusedNode=he):(de.stopImmediatePropagation(),U(_.mostRecentlyFocusedNode||O()))},ie=function(de){var he=yw(de);F();var se=null;if(_.tabbableGroups.length>0){var q=C(he),Se=q>=0?_.containerGroups[q]:void 0;if(q<0)de.shiftKey?se=_.tabbableGroups[_.tabbableGroups.length-1].lastTabbableNode:se=_.tabbableGroups[0].firstTabbableNode;else if(de.shiftKey){var ze=RO(_.tabbableGroups,function(dt){var Te=dt.firstTabbableNode;return he===Te});if(ze<0&&(Se.container===he||PT(he,p.tabbableOptions)&&!gw(he,p.tabbableOptions)&&!Se.nextTabbableNode(he,!1))&&(ze=q),ze>=0){var Ue=ze===0?_.tabbableGroups.length-1:ze-1,Be=_.tabbableGroups[Ue];se=Be.lastTabbableNode}}else{var rt=RO(_.tabbableGroups,function(dt){var Te=dt.lastTabbableNode;return he===Te});if(rt<0&&(Se.container===he||PT(he,p.tabbableOptions)&&!gw(he,p.tabbableOptions)&&!Se.nextTabbableNode(he))&&(rt=q),rt>=0){var _t=rt===_.tabbableGroups.length-1?0:rt+1,zt=_.tabbableGroups[_t];se=zt.firstTabbableNode}}}else se=P("fallbackFocus");se&&(de.preventDefault(),U(se))},H=function(de){if(xQ(de)&&l0(p.escapeDeactivates,de)!==!1){de.preventDefault(),x.deactivate();return}if(wQ(de)){ie(de);return}},G=function(de){var he=yw(de);C(he)>=0||l0(p.clickOutsideDeactivates,de)||l0(p.allowOutsideClick,de)||(de.preventDefault(),de.stopImmediatePropagation())},ee=function(){if(_.active)return kO.activateTrap(x),_.delayInitialFocusTimer=p.delayInitialFocus?PO(function(){U(O())}):U(O()),c.addEventListener("focusin",K,!0),c.addEventListener("mousedown",$,{capture:!0,passive:!1}),c.addEventListener("touchstart",$,{capture:!0,passive:!1}),c.addEventListener("click",G,{capture:!0,passive:!1}),c.addEventListener("keydown",H,{capture:!0,passive:!1}),x},W=function(){if(_.active)return c.removeEventListener("focusin",K,!0),c.removeEventListener("mousedown",$,!0),c.removeEventListener("touchstart",$,!0),c.removeEventListener("click",G,!0),c.removeEventListener("keydown",H,!0),x};return x={get active(){return _.active},get paused(){return _.paused},activate:function(de){if(_.active)return this;var he=T(de,"onActivate"),se=T(de,"onPostActivate"),q=T(de,"checkCanFocusTrap");q||F(),_.active=!0,_.paused=!1,_.nodeFocusedBeforeActivation=c.activeElement,he&&he();var Se=function(){q&&F(),ee(),se&&se()};return q?(q(_.containers.concat()).then(Se,Se),this):(Se(),this)},deactivate:function(de){if(!_.active)return this;var he=IO({onDeactivate:p.onDeactivate,onPostDeactivate:p.onPostDeactivate,checkCanReturnFocus:p.checkCanReturnFocus},de);clearTimeout(_.delayInitialFocusTimer),_.delayInitialFocusTimer=void 0,W(),_.active=!1,_.paused=!1,kO.deactivateTrap(x);var se=T(he,"onDeactivate"),q=T(he,"onPostDeactivate"),Se=T(he,"checkCanReturnFocus"),ze=T(he,"returnFocus","returnFocusOnDeactivate");se&&se();var Ue=function(){PO(function(){ze&&U(Z(_.nodeFocusedBeforeActivation)),q&&q()})};return ze&&Se?(Se(Z(_.nodeFocusedBeforeActivation)).then(Ue,Ue),this):(Ue(),this)},pause:function(){return _.paused||!_.active?this:(_.paused=!0,W(),this)},unpause:function(){return!_.paused||!_.active?this:(_.paused=!1,F(),ee(),this)},updateContainerElements:function(de){var he=[].concat(de).filter(Boolean);return _.containers=he.map(function(se){return typeof se=="string"?c.querySelector(se):se}),_.active&&F(),this}},x.updateContainerElements(o),x};function SQ(r){if(Array.isArray(r)){for(var o=0,a=Array(r.length);o<r.length;o++)a[o]=r[o];return a}else return Array.from(r)}var VM=!1;if(typeof window<"u"){var DO={get passive(){VM=!0}};window.addEventListener("testPassive",null,DO),window.removeEventListener("testPassive",null,DO)}var gB=typeof window<"u"&&window.navigator&&window.navigator.platform&&(/iP(ad|hone|od)/.test(window.navigator.platform)||window.navigator.platform==="MacIntel"&&window.navigator.maxTouchPoints>1),$h=[],Zb=!1,yB=-1,V0=void 0,$0=void 0,_B=function(o){return $h.some(function(a){return!!(a.options.allowTouchMove&&a.options.allowTouchMove(o))})},Xb=function(o){var a=o||window.event;return _B(a.target)||a.touches.length>1?!0:(a.preventDefault&&a.preventDefault(),!1)},EQ=function(o){if($0===void 0){var a=!!o&&o.reserveScrollBarGap===!0,c=window.innerWidth-document.documentElement.clientWidth;a&&c>0&&($0=document.body.style.paddingRight,document.body.style.paddingRight=c+"px")}V0===void 0&&(V0=document.body.style.overflow,document.body.style.overflow="hidden")},TQ=function(){$0!==void 0&&(document.body.style.paddingRight=$0,$0=void 0),V0!==void 0&&(document.body.style.overflow=V0,V0=void 0)},CQ=function(o){return o?o.scrollHeight-o.scrollTop<=o.clientHeight:!1},AQ=function(o,a){var c=o.targetTouches[0].clientY-yB;return _B(o.target)?!1:a&&a.scrollTop===0&&c>0||CQ(a)&&c<0?Xb(o):(o.stopPropagation(),!0)},MQ=function(o,a){if(!o){console.error("disableBodyScroll unsuccessful - targetElement must be provided when calling disableBodyScroll on IOS devices.");return}if(!$h.some(function(p){return p.targetElement===o})){var c={targetElement:o,options:a||{}};$h=[].concat(SQ($h),[c]),gB?(o.ontouchstart=function(p){p.targetTouches.length===1&&(yB=p.targetTouches[0].clientY)},o.ontouchmove=function(p){p.targetTouches.length===1&&AQ(p,o)},Zb||(document.addEventListener("touchmove",Xb,VM?{passive:!1}:void 0),Zb=!0)):EQ(a)}},IQ=function(o){if(!o){console.error("enableBodyScroll unsuccessful - targetElement must be provided when calling enableBodyScroll on IOS devices.");return}$h=$h.filter(function(a){return a.targetElement!==o}),gB?(o.ontouchstart=null,o.ontouchmove=null,Zb&&$h.length===0&&(document.removeEventListener("touchmove",Xb,VM?{passive:!1}:void 0),Zb=!1)):$h.length||TQ()},Pf=[],kQ=function(){return Pf.some(function(r){return r.activeTargets.length>0})},PQ=function(){return Pf.some(function(r){return r.skippedTargets.length>0})},LO="ResizeObserver loop completed with undelivered notifications.",RQ=function(){var r;typeof ErrorEvent=="function"?r=new ErrorEvent("error",{message:LO}):(r=document.createEvent("Event"),r.initEvent("error",!1,!1),r.message=LO),window.dispatchEvent(r)},gv;(function(r){r.BORDER_BOX="border-box",r.CONTENT_BOX="content-box",r.DEVICE_PIXEL_CONTENT_BOX="device-pixel-content-box"})(gv||(gv={}));var Rf=function(r){return Object.freeze(r)},DQ=function(){function r(o,a){this.inlineSize=o,this.blockSize=a,Rf(this)}return r}(),vB=function(){function r(o,a,c,p){return this.x=o,this.y=a,this.width=c,this.height=p,this.top=this.y,this.left=this.x,this.bottom=this.top+this.height,this.right=this.left+this.width,Rf(this)}return r.prototype.toJSON=function(){var o=this,a=o.x,c=o.y,p=o.top,_=o.right,x=o.bottom,T=o.left,C=o.width,P=o.height;return{x:a,y:c,top:p,right:_,bottom:x,left:T,width:C,height:P}},r.fromRect=function(o){return new r(o.x,o.y,o.width,o.height)},r}(),$M=function(r){return r instanceof SVGElement&&"getBBox"in r},xB=function(r){if($M(r)){var o=r.getBBox(),a=o.width,c=o.height;return!a&&!c}var p=r,_=p.offsetWidth,x=p.offsetHeight;return!(_||x||r.getClientRects().length)},OO=function(r){var o;if(r instanceof Element)return!0;var a=(o=r==null?void 0:r.ownerDocument)===null||o===void 0?void 0:o.defaultView;return!!(a&&r instanceof a.Element)},LQ=function(r){switch(r.tagName){case"INPUT":if(r.type!=="image")break;case"VIDEO":case"AUDIO":case"EMBED":case"OBJECT":case"CANVAS":case"IFRAME":case"IMG":return!0}return!1},G0=typeof window<"u"?window:{},_w=new WeakMap,zO=/auto|scroll/,OQ=/^tb|vertical/,zQ=/msie|trident/i.test(G0.navigator&&G0.navigator.userAgent),uu=function(r){return parseFloat(r||"0")},Eg=function(r,o,a){return r===void 0&&(r=0),o===void 0&&(o=0),a===void 0&&(a=!1),new DQ((a?o:r)||0,(a?r:o)||0)},FO=Rf({devicePixelContentBoxSize:Eg(),borderBoxSize:Eg(),contentBoxSize:Eg(),contentRect:new vB(0,0,0,0)}),wB=function(r,o){if(o===void 0&&(o=!1),_w.has(r)&&!o)return _w.get(r);if(xB(r))return _w.set(r,FO),FO;var a=getComputedStyle(r),c=$M(r)&&r.ownerSVGElement&&r.getBBox(),p=!zQ&&a.boxSizing==="border-box",_=OQ.test(a.writingMode||""),x=!c&&zO.test(a.overflowY||""),T=!c&&zO.test(a.overflowX||""),C=c?0:uu(a.paddingTop),P=c?0:uu(a.paddingRight),O=c?0:uu(a.paddingBottom),F=c?0:uu(a.paddingLeft),U=c?0:uu(a.borderTopWidth),Z=c?0:uu(a.borderRightWidth),$=c?0:uu(a.borderBottomWidth),K=c?0:uu(a.borderLeftWidth),ie=F+P,H=C+O,G=K+Z,ee=U+$,W=T?r.offsetHeight-ee-r.clientHeight:0,me=x?r.offsetWidth-G-r.clientWidth:0,de=p?ie+G:0,he=p?H+ee:0,se=c?c.width:uu(a.width)-de-me,q=c?c.height:uu(a.height)-he-W,Se=se+ie+me+G,ze=q+H+W+ee,Ue=Rf({devicePixelContentBoxSize:Eg(Math.round(se*devicePixelRatio),Math.round(q*devicePixelRatio),_),borderBoxSize:Eg(Se,ze,_),contentBoxSize:Eg(se,q,_),contentRect:new vB(F,C,se,q)});return _w.set(r,Ue),Ue},bB=function(r,o,a){var c=wB(r,a),p=c.borderBoxSize,_=c.contentBoxSize,x=c.devicePixelContentBoxSize;switch(o){case gv.DEVICE_PIXEL_CONTENT_BOX:return x;case gv.BORDER_BOX:return p;default:return _}},FQ=function(){function r(o){var a=wB(o);this.target=o,this.contentRect=a.contentRect,this.borderBoxSize=Rf([a.borderBoxSize]),this.contentBoxSize=Rf([a.contentBoxSize]),this.devicePixelContentBoxSize=Rf([a.devicePixelContentBoxSize])}return r}(),SB=function(r){if(xB(r))return 1/0;for(var o=0,a=r.parentNode;a;)o+=1,a=a.parentNode;return o},BQ=function(){var r=1/0,o=[];Pf.forEach(function(x){if(x.activeTargets.length!==0){var T=[];x.activeTargets.forEach(function(P){var O=new FQ(P.target),F=SB(P.target);T.push(O),P.lastReportedSize=bB(P.target,P.observedBox),F<r&&(r=F)}),o.push(function(){x.callback.call(x.observer,T,x.observer)}),x.activeTargets.splice(0,x.activeTargets.length)}});for(var a=0,c=o;a<c.length;a++){var p=c[a];p()}return r},BO=function(r){Pf.forEach(function(a){a.activeTargets.splice(0,a.activeTargets.length),a.skippedTargets.splice(0,a.skippedTargets.length),a.observationTargets.forEach(function(p){p.isActive()&&(SB(p.target)>r?a.activeTargets.push(p):a.skippedTargets.push(p))})})},NQ=function(){var r=0;for(BO(r);kQ();)r=BQ(),BO(r);return PQ()&&RQ(),r>0},RT,EB=[],jQ=function(){return EB.splice(0).forEach(function(r){return r()})},UQ=function(r){if(!RT){var o=0,a=document.createTextNode(""),c={characterData:!0};new MutationObserver(function(){return jQ()}).observe(a,c),RT=function(){a.textContent="".concat(o?o--:o++)}}EB.push(r),RT()},VQ=function(r){UQ(function(){requestAnimationFrame(r)})},Zw=0,$Q=function(){return!!Zw},GQ=250,HQ={attributes:!0,characterData:!0,childList:!0,subtree:!0},NO=["resize","load","transitionend","animationend","animationstart","animationiteration","keyup","keydown","mouseup","mousedown","mouseover","mouseout","blur","focus"],jO=function(r){return r===void 0&&(r=0),Date.now()+r},DT=!1,qQ=function(){function r(){var o=this;this.stopped=!0,this.listener=function(){return o.schedule()}}return r.prototype.run=function(o){var a=this;if(o===void 0&&(o=GQ),!DT){DT=!0;var c=jO(o);VQ(function(){var p=!1;try{p=NQ()}finally{if(DT=!1,o=c-jO(),!$Q())return;p?a.run(1e3):o>0?a.run(o):a.start()}})}},r.prototype.schedule=function(){this.stop(),this.run()},r.prototype.observe=function(){var o=this,a=function(){return o.observer&&o.observer.observe(document.body,HQ)};document.body?a():G0.addEventListener("DOMContentLoaded",a)},r.prototype.start=function(){var o=this;this.stopped&&(this.stopped=!1,this.observer=new MutationObserver(this.listener),this.observe(),NO.forEach(function(a){return G0.addEventListener(a,o.listener,!0)}))},r.prototype.stop=function(){var o=this;this.stopped||(this.observer&&this.observer.disconnect(),NO.forEach(function(a){return G0.removeEventListener(a,o.listener,!0)}),this.stopped=!0)},r}(),hA=new qQ,UO=function(r){!Zw&&r>0&&hA.start(),Zw+=r,!Zw&&hA.stop()},WQ=function(r){return!$M(r)&&!LQ(r)&&getComputedStyle(r).display==="inline"},ZQ=function(){function r(o,a){this.target=o,this.observedBox=a||gv.CONTENT_BOX,this.lastReportedSize={inlineSize:0,blockSize:0}}return r.prototype.isActive=function(){var o=bB(this.target,this.observedBox,!0);return WQ(this.target)&&(this.lastReportedSize=o),this.lastReportedSize.inlineSize!==o.inlineSize||this.lastReportedSize.blockSize!==o.blockSize},r}(),XQ=function(){function r(o,a){this.activeTargets=[],this.skippedTargets=[],this.observationTargets=[],this.observer=o,this.callback=a}return r}(),vw=new WeakMap,VO=function(r,o){for(var a=0;a<r.length;a+=1)if(r[a].target===o)return a;return-1},xw=function(){function r(){}return r.connect=function(o,a){var c=new XQ(o,a);vw.set(o,c)},r.observe=function(o,a,c){var p=vw.get(o),_=p.observationTargets.length===0;VO(p.observationTargets,a)<0&&(_&&Pf.push(p),p.observationTargets.push(new ZQ(a,c&&c.box)),UO(1),hA.schedule())},r.unobserve=function(o,a){var c=vw.get(o),p=VO(c.observationTargets,a),_=c.observationTargets.length===1;p>=0&&(_&&Pf.splice(Pf.indexOf(c),1),c.observationTargets.splice(p,1),UO(-1))},r.disconnect=function(o){var a=this,c=vw.get(o);c.observationTargets.slice().forEach(function(p){return a.unobserve(o,p.target)}),c.activeTargets.splice(0,c.activeTargets.length)},r}(),KQ=function(){function r(o){if(arguments.length===0)throw new TypeError("Failed to construct 'ResizeObserver': 1 argument required, but only 0 present.");if(typeof o!="function")throw new TypeError("Failed to construct 'ResizeObserver': The callback provided as parameter 1 is not a function.");xw.connect(this,o)}return r.prototype.observe=function(o,a){if(arguments.length===0)throw new TypeError("Failed to execute 'observe' on 'ResizeObserver': 1 argument required, but only 0 present.");if(!OO(o))throw new TypeError("Failed to execute 'observe' on 'ResizeObserver': parameter 1 is not of type 'Element");xw.observe(this,o,a)},r.prototype.unobserve=function(o){if(arguments.length===0)throw new TypeError("Failed to execute 'unobserve' on 'ResizeObserver': 1 argument required, but only 0 present.");if(!OO(o))throw new TypeError("Failed to execute 'unobserve' on 'ResizeObserver': parameter 1 is not of type 'Element");xw.unobserve(this,o)},r.prototype.disconnect=function(){xw.disconnect(this)},r.toString=function(){return"function ResizeObserver () { [polyfill code] }"},r}();function ts(){return ts=Object.assign||function(r){for(var o=1;o<arguments.length;o++){var a=arguments[o];for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(r[c]=a[c])}return r},ts.apply(this,arguments)}function Xw(r,o){if(r==null)return{};var a,c,p={},_=Object.keys(r);for(c=0;c<_.length;c++)o.indexOf(a=_[c])>=0||(p[a]=r[a]);return p}var H0=typeof window<"u"?_e.useLayoutEffect:_e.useEffect;function u0(r,o,a){return o=(o=+o)==o?o:0,a=(a=+a)==a?a:0,(r=+r)==r&&(r=(r=r<=a?r:a)>=o?r:o),r}function ww(r){var o=Math.round(r);if(Number.isNaN(r))throw new TypeError("Found a NaN! Check your snapPoints / defaultSnap / snapTo ");return o}var YQ={box:"border-box"};function LT(r,o){var a=o.label,c=o.enabled,p=o.resizeSourceRef,_=_e.useState(0),x=_[0],T=_[1];_e.useDebugValue(a+": "+x);var C=_e.useCallback(function(P){T(P[0].borderBoxSize[0].blockSize),p.current="element"},[p]);return H0(function(){if(r.current&&c){var P=new KQ(C);return P.observe(r.current,YQ),function(){P.disconnect()}}},[r,C,c]),c?x:0}function es(r){return r===void 0&&(r=1e3),new Promise(function(o){return setTimeout(o,r)})}var $O={DRAG:{target:"#overlay.dragging",actions:"onOpenEnd"}},GO={RESIZE:{target:"#overlay.resizing",actions:"onOpenEnd"}},QQ=EK({id:"overlay",initial:"closed",context:{initialState:"CLOSED"},states:{closed:{on:{OPEN:"opening",CLOSE:void 0}},opening:{initial:"start",states:{start:{invoke:{src:"onOpenStart",onDone:"transition"}},transition:{always:[{target:"immediately",cond:"initiallyOpen"},{target:"smoothly",cond:"initiallyClosed"}]},immediately:{initial:"open",states:{open:{invoke:{src:"openImmediately",onDone:"activating"}},activating:{invoke:{src:"activate",onDone:"#overlay.opening.end"},on:ts({},$O,GO)}}},smoothly:{initial:"visuallyHidden",states:{visuallyHidden:{invoke:{src:"renderVisuallyHidden",onDone:"activating"}},activating:{invoke:{src:"activate",onDone:"open"}},open:{invoke:{src:"openSmoothly",onDone:"#overlay.opening.end"},on:ts({},$O,GO)}}},end:{invoke:{src:"onOpenEnd",onDone:"done"},on:{CLOSE:"#overlay.closing",DRAG:"#overlay.dragging"}},done:{type:"final"}},on:ts({},{CLOSE:{target:"#overlay.closing",actions:"onOpenCancel"}}),onDone:"open"},open:{on:{DRAG:"#overlay.dragging",SNAP:"snapping",RESIZE:"resizing"}},dragging:{on:{SNAP:"snapping"}},snapping:{initial:"start",states:{start:{invoke:{src:"onSnapStart",onDone:"snappingSmoothly"},entry:[TK({y:function(r,o){return o.payload.y},velocity:function(r,o){return o.payload.velocity},snapSource:function(r,o){var a=o.payload.source;return a===void 0?"custom":a}})]},snappingSmoothly:{invoke:{src:"snapSmoothly",onDone:"end"}},end:{invoke:{src:"onSnapEnd",onDone:"done"},on:{RESIZE:"#overlay.resizing",SNAP:"#overlay.snapping",CLOSE:"#overlay.closing",DRAG:"#overlay.dragging"}},done:{type:"final"}},on:{SNAP:{target:"snapping",actions:"onSnapEnd"},RESIZE:{target:"#overlay.resizing",actions:"onSnapCancel"},DRAG:{target:"#overlay.dragging",actions:"onSnapCancel"},CLOSE:{target:"#overlay.closing",actions:"onSnapCancel"}},onDone:"open"},resizing:{initial:"start",states:{start:{invoke:{src:"onResizeStart",onDone:"resizingSmoothly"}},resizingSmoothly:{invoke:{src:"resizeSmoothly",onDone:"end"}},end:{invoke:{src:"onResizeEnd",onDone:"done"},on:{SNAP:"#overlay.snapping",CLOSE:"#overlay.closing",DRAG:"#overlay.dragging"}},done:{type:"final"}},on:{RESIZE:{target:"resizing",actions:"onResizeEnd"},SNAP:{target:"snapping",actions:"onResizeCancel"},DRAG:{target:"#overlay.dragging",actions:"onResizeCancel"},CLOSE:{target:"#overlay.closing",actions:"onResizeCancel"}},onDone:"open"},closing:{initial:"start",states:{start:{invoke:{src:"onCloseStart",onDone:"deactivating"},on:{OPEN:{target:"#overlay.open",actions:"onCloseCancel"}}},deactivating:{invoke:{src:"deactivate",onDone:"closingSmoothly"}},closingSmoothly:{invoke:{src:"closeSmoothly",onDone:"end"}},end:{invoke:{src:"onCloseEnd",onDone:"done"},on:{OPEN:{target:"#overlay.opening",actions:"onCloseCancel"}}},done:{type:"final"}},on:{CLOSE:void 0,OPEN:{target:"#overlay.opening",actions:"onCloseCancel"}},onDone:"closed"}},on:{CLOSE:"closing"}},{actions:{onOpenCancel:function(r,o){},onSnapCancel:function(r,o){},onResizeCancel:function(r,o){},onCloseCancel:function(r,o){},onOpenEnd:function(r,o){},onSnapEnd:function(r,o){},onRezizeEnd:function(r,o){}},services:{onSnapStart:function(){try{return Promise.resolve(es()).then(function(){})}catch(r){return Promise.reject(r)}},onOpenStart:function(){try{return Promise.resolve(es()).then(function(){})}catch(r){return Promise.reject(r)}},onCloseStart:function(){try{return Promise.resolve(es()).then(function(){})}catch(r){return Promise.reject(r)}},onResizeStart:function(){try{return Promise.resolve(es()).then(function(){})}catch(r){return Promise.reject(r)}},onSnapEnd:function(){try{return Promise.resolve(es()).then(function(){})}catch(r){return Promise.reject(r)}},onOpenEnd:function(){try{return Promise.resolve(es()).then(function(){})}catch(r){return Promise.reject(r)}},onCloseEnd:function(){try{return Promise.resolve(es()).then(function(){})}catch(r){return Promise.reject(r)}},onResizeEnd:function(){try{return Promise.resolve(es()).then(function(){})}catch(r){return Promise.reject(r)}},renderVisuallyHidden:function(r,o){try{return Promise.resolve(es()).then(function(){})}catch(a){return Promise.reject(a)}},activate:function(r,o){try{return Promise.resolve(es()).then(function(){})}catch(a){return Promise.reject(a)}},deactivate:function(r,o){try{return Promise.resolve(es()).then(function(){})}catch(a){return Promise.reject(a)}},openSmoothly:function(r,o){try{return Promise.resolve(es()).then(function(){})}catch(a){return Promise.reject(a)}},openImmediately:function(r,o){try{return Promise.resolve(es()).then(function(){})}catch(a){return Promise.reject(a)}},snapSmoothly:function(r,o){try{return Promise.resolve(es()).then(function(){})}catch(a){return Promise.reject(a)}},resizeSmoothly:function(r,o){try{return Promise.resolve(es()).then(function(){})}catch(a){return Promise.reject(a)}},closeSmoothly:function(r,o){try{return Promise.resolve(es()).then(function(){})}catch(a){return Promise.reject(a)}}},guards:{initiallyClosed:function(r){return r.initialState==="CLOSED"},initiallyOpen:function(r){return r.initialState==="OPEN"}}}),JQ=["children","sibling","className","footer","header","open","initialState","lastSnapRef","initialFocusRef","onDismiss","maxHeight","defaultSnap","snapPoints","blocking","scrollLocking","style","onSpringStart","onSpringCancel","onSpringEnd","reserveScrollBarGap","expandOnContentDrag"],eJ=["velocity"],tJ=["onRest","config"],TB=YK.default,nJ=TB.tension,bw=TB.friction,rJ=Xn.forwardRef(function(r,o){var a=r.children,c=r.sibling,p=r.className,_=r.footer,x=r.header,T=r.open,C=r.initialState,P=r.lastSnapRef,O=r.initialFocusRef,F=r.onDismiss,U=r.maxHeight,Z=r.defaultSnap,$=Z===void 0?oJ:Z,K=r.snapPoints,ie=K===void 0?sJ:K,H=r.blocking,G=H===void 0||H,ee=r.scrollLocking,W=ee===void 0||ee,me=r.style,de=r.onSpringStart,he=r.onSpringCancel,se=r.onSpringEnd,q=r.reserveScrollBarGap,Se=q===void 0?G:q,ze=r.expandOnContentDrag,Ue=ze!==void 0&&ze,Be=Xw(r,JQ),rt=function(){var be=_e.useState(!1),Ke=be[0],nt=be[1],Vt=_e.useState({}),Ht=Vt[0],$t=Vt[1],jt=_e.useCallback(function(Lt){return $t(function(Oe){var Ie;return ts({},Oe,((Ie={})[Lt]=!1,Ie))}),function(){$t(function(Oe){var Ie;return ts({},Oe,((Ie={})[Lt]=!0,Ie))})}},[]);return _e.useEffect(function(){var Lt=Object.values(Ht);Lt.length!==0&&Lt.every(Boolean)&&nt(!0)},[Ht]),{ready:Ke,registerReady:jt}}(),_t=rt.ready,zt=rt.registerReady,dt=_e.useRef(!1),Te=_e.useRef(de),we=_e.useRef(he),Q=_e.useRef(se);_e.useEffect(function(){Te.current=de,we.current=he,Q.current=se},[he,de,se]);var ce,De,He=nY(function(){return{y:0,ready:0,maxHeight:0,minSnap:0,maxSnap:0}}),$e=He[0],xt=He[1],ge=_e.useRef(null),Pt=_e.useRef(null),ot=_e.useRef(null),Dn=_e.useRef(null),$n=_e.useRef(null),Ln=_e.useRef(null),vn=_e.useRef(0),On=_e.useRef(),Br=_e.useRef(!1),bn=(ce=_e.useMemo(function(){return typeof window<"u"?window.matchMedia("(prefers-reduced-motion: reduce)"):null},[]),De=_e.useRef(ce==null?void 0:ce.matches),_e.useDebugValue(De.current?"reduce":"no-preference"),_e.useEffect(function(){var be=function(Ke){De.current=Ke.matches};return ce==null||ce.addListener(be),function(){return ce==null?void 0:ce.removeListener(be)}},[ce]),De),et=function(be){var Ke=be.targetRef,nt=be.enabled,Vt=be.reserveScrollBarGap,Ht=_e.useRef({activate:function(){throw new TypeError("Tried to activate scroll lock too early")},deactivate:function(){}});return _e.useDebugValue(nt?"Enabled":"Disabled"),_e.useEffect(function(){if(!nt)return Ht.current.deactivate(),void(Ht.current={activate:function(){},deactivate:function(){}});var $t=Ke.current,jt=!1;Ht.current={activate:function(){jt||(jt=!0,MQ($t,{allowTouchMove:function(Lt){return Lt.closest("[data-body-scroll-lock-ignore]")},reserveScrollBarGap:Vt}))},deactivate:function(){jt&&(jt=!1,IQ($t))}}},[nt,Ke,Vt]),Ht}({targetRef:Pt,enabled:_t&&W,reserveScrollBarGap:Se}),te=function(be){var Ke=be.targetRef,nt=be.enabled,Vt=_e.useRef({activate:function(){throw new TypeError("Tried to activate aria hider too early")},deactivate:function(){}});return _e.useDebugValue(nt?"Enabled":"Disabled"),_e.useEffect(function(){if(!nt)return Vt.current.deactivate(),void(Vt.current={activate:function(){},deactivate:function(){}});var Ht=Ke.current,$t=!1,jt=[],Lt=[];Vt.current={activate:function(){if(!$t){$t=!0;var Oe=Ht.parentNode;document.querySelectorAll("body > *").forEach(function(Ie){if(Ie!==Oe){var je=Ie.getAttribute("aria-hidden");je!==null&&je!=="false"||(jt.push(je),Lt.push(Ie),Ie.setAttribute("aria-hidden","true"))}})}},deactivate:function(){$t&&($t=!1,Lt.forEach(function(Oe,Ie){var je=jt[Ie];je===null?Oe.removeAttribute("aria-hidden"):Oe.setAttribute("aria-hidden",je)}),jt=[],Lt=[])}}},[Ke,nt]),Vt}({targetRef:ge,enabled:_t&&G}),ue=function(be){var Ke=be.targetRef,nt=be.fallbackRef,Vt=be.initialFocusRef,Ht=be.enabled,$t=_e.useRef({activate:function(){throw new TypeError("Tried to activate focus trap too early")},deactivate:function(){}});return _e.useDebugValue(Ht?"Enabled":"Disabled"),_e.useEffect(function(){if(!Ht)return $t.current.deactivate(),void($t.current={activate:function(){},deactivate:function(){}});var jt=nt.current,Lt=bQ(Ke.current,{onActivate:void 0,initialFocus:Vt?function(){return(Vt==null?void 0:Vt.current)||jt}:void 0,fallbackFocus:jt,escapeDeactivates:!1,clickOutsideDeactivates:!1}),Oe=!1;$t.current={activate:function(){try{return Oe?Promise.resolve():(Oe=!0,Promise.resolve(Lt.activate()).then(function(){return Promise.resolve(new Promise(function(Ie){return setTimeout(function(){return Ie(void 0)},0)})).then(function(){})}))}catch(Ie){return Promise.reject(Ie)}},deactivate:function(){Oe&&(Oe=!1,Lt.deactivate())}}},[Ht,nt,Vt,Ke]),$t}({targetRef:ge,fallbackRef:Ln,initialFocusRef:O||void 0,enabled:_t&&G&&O!==!1}),ye=function(be){var Ke=be.getSnapPoints,nt=be.heightRef,Vt=be.lastSnapRef,Ht=be.ready,$t=function(at){var ut=at.contentRef,Et=at.controlledMaxHeight,it=at.footerEnabled,Yt=at.footerRef,xn=at.headerEnabled,Ot=at.headerRef,qn=at.registerReady,Wn=at.resizeSourceRef,pn=_e.useMemo(function(){return qn("contentHeight")},[qn]),rr=function(Po,oa,Ho){var Ll=_e.useMemo(function(){return oa("maxHeight")},[oa]),Sc=_e.useState(function(){return ww(Po)||typeof window<"u"?window.innerHeight:0}),od=Sc[0],oi=Sc[1],sd=od>0,Ol=_e.useRef(0);return _e.useDebugValue(Po?"controlled":"auto"),_e.useEffect(function(){sd&&Ll()},[sd,Ll]),H0(function(){if(Po)return oi(ww(Po)),void(Ho.current="maxheightprop");var Ec=function(){Ol.current||(Ol.current=requestAnimationFrame(function(){oi(window.innerHeight),Ho.current="window",Ol.current=0}))};return window.addEventListener("resize",Ec),oi(window.innerHeight),Ho.current="window",Ll(),function(){window.removeEventListener("resize",Ec),cancelAnimationFrame(Ol.current)}},[Po,Ll,Ho]),od}(Et,qn,Wn),Rr=LT(Ot,{label:"headerHeight",enabled:xn,resizeSourceRef:Wn}),Yr=LT(ut,{label:"contentHeight",enabled:!0,resizeSourceRef:Wn}),ar=LT(Yt,{label:"footerHeight",enabled:it,resizeSourceRef:Wn}),Dr=Math.min(rr-Rr-ar,Yr)+Rr+ar;_e.useDebugValue("minHeight: "+Dr);var Qr=Yr>0;return _e.useEffect(function(){Qr&&pn()},[Qr,pn]),{maxHeight:rr,minHeight:Dr,headerHeight:Rr,footerHeight:ar}}({contentRef:be.contentRef,controlledMaxHeight:be.controlledMaxHeight,footerEnabled:be.footerEnabled,footerRef:be.footerRef,headerEnabled:be.headerEnabled,headerRef:be.headerRef,registerReady:be.registerReady,resizeSourceRef:be.resizeSourceRef}),jt=$t.maxHeight,Lt=$t.minHeight,Oe=$t.headerHeight,Ie=$t.footerHeight,je=function(at,ut){var Et=[].concat(at).map(ww).reduce(function(Ot,qn){return Ot.add(u0(qn,0,ut)),Ot},new Set),it=Array.from(Et),Yt=Math.min.apply(Math,it);if(Number.isNaN(Yt))throw new TypeError("minSnap is NaN");var xn=Math.max.apply(Math,it);if(Number.isNaN(xn))throw new TypeError("maxSnap is NaN");return{snapPoints:it,minSnap:Yt,maxSnap:xn}}(Ht?Ke({height:nt.current,footerHeight:Ie,headerHeight:Oe,minHeight:Lt,maxHeight:jt}):[0],jt),Qe=je.snapPoints,tt=je.minSnap,ht=je.maxSnap;return _e.useDebugValue("minSnap: "+tt+", maxSnap:"+ht),{minSnap:tt,maxSnap:ht,findSnap:function(at){var ut=ww(typeof at=="function"?at({footerHeight:Ie,headerHeight:Oe,height:nt.current,minHeight:Lt,maxHeight:jt,snapPoints:Qe,lastSnap:Vt.current}):at);return Qe.reduce(function(Et,it){return Math.abs(it-ut)<Math.abs(Et-ut)?it:Et},tt)},maxHeight:jt}}({contentRef:ot,controlledMaxHeight:U,footerEnabled:!!_,footerRef:$n,getSnapPoints:ie,headerEnabled:x!==!1,headerRef:Dn,heightRef:vn,lastSnapRef:P,ready:_t,registerReady:zt,resizeSourceRef:On}),We=ye.minSnap,Je=ye.maxSnap,bt=ye.maxHeight,St=ye.findSnap,Ne=_e.useRef(bt),wt=_e.useRef(We),Rt=_e.useRef(Je),Wt=_e.useRef(St),cn=_e.useRef(0);H0(function(){Ne.current=bt,Rt.current=Je,wt.current=We,Wt.current=St,cn.current=St($)},[St,$,bt,Je,We]);var Yn=_e.useCallback(function(be){var Ke=be.onRest,nt=be.config,Vt=(nt=nt===void 0?{}:nt).velocity,Ht=Vt===void 0?1:Vt,$t=Xw(nt,eJ),jt=Xw(be,tJ);return new Promise(function(Lt){return xt(ts({},jt,{config:ts({velocity:Ht},$t,{mass:1,tension:nJ,friction:Math.max(bw,bw+(bw-bw*Ht))}),onRest:function(){var Oe=[].slice.call(arguments);Lt.apply(void 0,Oe),Ke==null||Ke.apply(void 0,Oe)}}))})},[xt]),hr=LK(QQ,{devTools:!1,actions:{onOpenCancel:_e.useCallback(function(){return we.current==null?void 0:we.current({type:"OPEN"})},[]),onSnapCancel:_e.useCallback(function(be){return we.current==null?void 0:we.current({type:"SNAP",source:be.snapSource})},[]),onCloseCancel:_e.useCallback(function(){return we.current==null?void 0:we.current({type:"CLOSE"})},[]),onResizeCancel:_e.useCallback(function(){return we.current==null?void 0:we.current({type:"RESIZE",source:On.current})},[]),onOpenEnd:_e.useCallback(function(){return Q.current==null?void 0:Q.current({type:"OPEN"})},[]),onSnapEnd:_e.useCallback(function(be,Ke){return Q.current==null?void 0:Q.current({type:"SNAP",source:be.snapSource})},[]),onResizeEnd:_e.useCallback(function(){return Q.current==null?void 0:Q.current({type:"RESIZE",source:On.current})},[])},context:{initialState:C},services:{onSnapStart:_e.useCallback(function(be,Ke){try{return Promise.resolve(Te.current==null?void 0:Te.current({type:"SNAP",source:Ke.payload.source||"custom"}))}catch(nt){return Promise.reject(nt)}},[]),onOpenStart:_e.useCallback(function(){try{return Promise.resolve(Te.current==null?void 0:Te.current({type:"OPEN"}))}catch(be){return Promise.reject(be)}},[]),onCloseStart:_e.useCallback(function(){try{return Promise.resolve(Te.current==null?void 0:Te.current({type:"CLOSE"}))}catch(be){return Promise.reject(be)}},[]),onResizeStart:_e.useCallback(function(){try{return Promise.resolve(Te.current==null?void 0:Te.current({type:"RESIZE",source:On.current}))}catch(be){return Promise.reject(be)}},[]),onSnapEnd:_e.useCallback(function(be,Ke){try{return Promise.resolve(Q.current==null?void 0:Q.current({type:"SNAP",source:be.snapSource}))}catch(nt){return Promise.reject(nt)}},[]),onOpenEnd:_e.useCallback(function(){try{return Promise.resolve(Q.current==null?void 0:Q.current({type:"OPEN"}))}catch(be){return Promise.reject(be)}},[]),onCloseEnd:_e.useCallback(function(){try{return Promise.resolve(Q.current==null?void 0:Q.current({type:"CLOSE"}))}catch(be){return Promise.reject(be)}},[]),onResizeEnd:_e.useCallback(function(){try{return Promise.resolve(Q.current==null?void 0:Q.current({type:"RESIZE",source:On.current}))}catch(be){return Promise.reject(be)}},[]),renderVisuallyHidden:_e.useCallback(function(be,Ke){try{return Promise.resolve(Yn({y:cn.current,ready:0,maxHeight:Ne.current,maxSnap:Rt.current,minSnap:cn.current,immediate:!0})).then(function(){})}catch(nt){return Promise.reject(nt)}},[Yn]),activate:_e.useCallback(function(be,Ke){try{return dt.current=!0,Promise.resolve(Promise.all([et.current.activate(),ue.current.activate(),te.current.activate()])).then(function(){})}catch(nt){return Promise.reject(nt)}},[te,ue,et]),deactivate:_e.useCallback(function(){try{return et.current.deactivate(),ue.current.deactivate(),te.current.deactivate(),dt.current=!1,Promise.resolve()}catch(be){return Promise.reject(be)}},[te,ue,et]),openImmediately:_e.useCallback(function(){try{return vn.current=cn.current,Promise.resolve(Yn({y:cn.current,ready:1,maxHeight:Ne.current,maxSnap:Rt.current,minSnap:cn.current,immediate:!0})).then(function(){})}catch(be){return Promise.reject(be)}},[Yn]),openSmoothly:_e.useCallback(function(){try{return Promise.resolve(Yn({y:0,ready:1,maxHeight:Ne.current,maxSnap:Rt.current,minSnap:cn.current,immediate:!0})).then(function(){return vn.current=cn.current,Promise.resolve(Yn({y:cn.current,ready:1,maxHeight:Ne.current,maxSnap:Rt.current,minSnap:cn.current,immediate:bn.current})).then(function(){})})}catch(be){return Promise.reject(be)}},[Yn,bn]),snapSmoothly:_e.useCallback(function(be,Ke){try{var nt=Wt.current(be.y);return vn.current=nt,P.current=nt,Promise.resolve(Yn({y:nt,ready:1,maxHeight:Ne.current,maxSnap:Rt.current,minSnap:wt.current,immediate:bn.current,config:{velocity:be.velocity}})).then(function(){})}catch(Vt){return Promise.reject(Vt)}},[Yn,P,bn]),resizeSmoothly:_e.useCallback(function(){try{var be=Wt.current(vn.current);return vn.current=be,P.current=be,Promise.resolve(Yn({y:be,ready:1,maxHeight:Ne.current,maxSnap:Rt.current,minSnap:wt.current,immediate:On.current!=="element"||bn.current})).then(function(){})}catch(Ke){return Promise.reject(Ke)}},[Yn,P,bn]),closeSmoothly:_e.useCallback(function(be,Ke){try{return Yn({minSnap:vn.current,immediate:!0}),vn.current=0,Promise.resolve(Yn({y:0,maxHeight:Ne.current,maxSnap:Rt.current,immediate:bn.current})).then(function(){return Promise.resolve(Yn({ready:0,immediate:!0})).then(function(){})})}catch(nt){return Promise.reject(nt)}},[Yn,bn])}}),pr=hr[0],nr=hr[1];_e.useEffect(function(){_t&&nr(T?"OPEN":"CLOSE")},[T,nr,_t]),H0(function(){(bt||Je||We)&&nr("RESIZE")},[bt,Je,We,nr]),_e.useEffect(function(){return function(){et.current.deactivate(),ue.current.deactivate(),te.current.deactivate()}},[te,ue,et]),_e.useImperativeHandle(o,function(){return{snapTo:function(be,Ke){var nt=Ke===void 0?{}:Ke,Vt=nt.velocity,Ht=Vt===void 0?1:Vt,$t=nt.source,jt=$t===void 0?"custom":$t;nr("SNAP",{payload:{y:Wt.current(be),velocity:Ht,source:jt}})},get height(){return vn.current}}},[nr]),_e.useEffect(function(){var be=Pt.current,Ke=function(Vt){Br.current&&Vt.preventDefault()},nt=function(Vt){be.scrollTop<0&&(requestAnimationFrame(function(){be.style.overflow="hidden",be.scrollTop=0,be.style.removeProperty("overflow")}),Vt.preventDefault())};return Ue&&(be.addEventListener("scroll",Ke),be.addEventListener("touchmove",Ke),be.addEventListener("touchstart",nt)),function(){be.removeEventListener("scroll",Ke),be.removeEventListener("touchmove",Ke),be.removeEventListener("touchstart",nt)}},[Ue,Pt]);var dr=rQ(function(be){var Ke=be.args,nt=(Ke=Ke===void 0?[]:Ke)[0],Vt=(nt=nt===void 0?{}:nt).closeOnTap,Ht=Vt!==void 0&&Vt,$t=nt.isContentDragging,jt=$t!==void 0&&$t,Lt=be.cancel,Oe=be.direction[1],Ie=be.down,je=be.first,Qe=be.last,tt=be.memo,ht=tt===void 0?$e.y.getValue():tt,at=be.tap,ut=be.velocity,Et=-1*be.movement[1];if(!dt.current)return Lt(),ht;if(F&&Ht&&at)return Lt(),setTimeout(function(){return F()},0),ht;if(at)return ht;var it=ht+Et,Yt=Et*ut,xn=Math.max(wt.current,Math.min(Rt.current,it+2*Yt));if(!Ie&&F&&Oe>0&&it+Yt<wt.current/2)return Lt(),F(),ht;var Ot=Ie?F||wt.current!==Rt.current?U0(it,F?0:wt.current,Rt.current,.55):it<wt.current?U0(it,wt.current,2*Rt.current,.55):U0(it,wt.current/2,Rt.current,.55):xn;return Ue&&jt?(Ot>=Rt.current&&(Ot=Rt.current),ht===Rt.current&&Pt.current.scrollTop>0&&(Ot=Rt.current),Br.current=Ot<Rt.current):Br.current=!1,je&&nr("DRAG"),Qe?(nr("SNAP",{payload:{y:Ot,velocity:ut>.05?ut:1,source:"dragging"}}),ht):(xt({y:Ot,ready:1,maxHeight:Ne.current,maxSnap:Rt.current,minSnap:wt.current,immediate:!0,config:{velocity:ut}}),ht)},{filterTaps:!0});if(Number.isNaN(Rt.current))throw new TypeError("maxSnapRef is NaN!!");if(Number.isNaN(wt.current))throw new TypeError("minSnapRef is NaN!!");var Xe=function(be){var Ke,nt=be.spring,Vt=Xm([nt.y,nt.maxHeight],function(Ie,je){return Math.round(u0(je-Ie,0,16))+"px"}),Ht=Xm([nt.y,nt.minSnap,nt.maxSnap],function(Ie,je,Qe){return u0(Ie,je,Qe)+"px"}),$t=Xm([nt.y,nt.minSnap,nt.maxSnap],function(Ie,je,Qe){return Ie<je?je-Ie+"px":Ie>Qe?Qe-Ie+"px":"0px"}),jt=Xm([nt.y,nt.maxSnap],function(Ie,je){return Ie>=je?Math.ceil(Ie-je):0}),Lt=Xm([nt.y,nt.minSnap],function(Ie,je){if(!je)return 0;var Qe=Math.max(je/2-45,0);return u0((Ie-Qe)*(1/(Math.min(je/2+45,je)-Qe)+0),0,1)}),Oe=Xm([nt.y,nt.minSnap],function(Ie,je){return je?u0(Ie/je,0,1):0});return(Ke={})["--rsbs-content-opacity"]=Lt,Ke["--rsbs-backdrop-opacity"]=Oe,Ke["--rsbs-antigap-scale-y"]=jt,Ke["--rsbs-overlay-translate-y"]=$t,Ke["--rsbs-overlay-rounded"]=Vt,Ke["--rsbs-overlay-h"]=Ht,Ke}({spring:$e});return Xn.createElement(wY.div,ts({},Be,{"data-rsbs-root":!0,"data-rsbs-state":iJ.find(pr.matches),"data-rsbs-is-blocking":G,"data-rsbs-is-dismissable":!!F,"data-rsbs-has-header":!!x,"data-rsbs-has-footer":!!_,className:p,ref:ge,style:ts({},Xe,me,{opacity:$e.ready})}),c,G&&Xn.createElement("div",ts({key:"backdrop","data-rsbs-backdrop":!0},dr({closeOnTap:!0}))),Xn.createElement("div",{key:"overlay","aria-modal":"true",role:"dialog","data-rsbs-overlay":!0,tabIndex:-1,ref:Ln,onKeyDown:function(be){be.key==="Escape"&&(be.stopPropagation(),F&&F())}},x!==!1&&Xn.createElement("div",ts({key:"header","data-rsbs-header":!0,ref:Dn},dr()),x),Xn.createElement("div",ts({key:"scroll","data-rsbs-scroll":!0,ref:Pt},Ue?dr({isContentDragging:!0}):{}),Xn.createElement("div",{"data-rsbs-content":!0,ref:ot},a)),_&&Xn.createElement("div",ts({key:"footer",ref:$n,"data-rsbs-footer":!0},dr()),_)))}),iJ=["closed","opening","open","closing","dragging","snapping","resizing"];function oJ(r){var o=r.lastSnap;return o??Math.min.apply(Math,r.snapPoints)}function sJ(r){return r.minHeight}var aJ=["onSpringStart","onSpringEnd","skipInitialTransition"],CB=_e.forwardRef(function(r,o){var a=r.onSpringStart,c=r.onSpringEnd,p=r.skipInitialTransition,_=Xw(r,aJ),x=_e.useState(!1),T=x[0],C=x[1],P=_e.useRef(),O=_e.useRef(null),F=_e.useRef(p&&_.open?"OPEN":"CLOSED");H0(function(){if(_.open)return cancelAnimationFrame(P.current),C(!0),function(){F.current="CLOSED"}},[_.open]);var U=_e.useCallback(function($){return Promise.resolve(a==null?void 0:a($)).then(function(){$.type==="OPEN"&&cancelAnimationFrame(P.current)})},[a]),Z=_e.useCallback(function($){return Promise.resolve(c==null?void 0:c($)).then(function(){$.type==="CLOSE"&&(P.current=requestAnimationFrame(function(){return C(!1)}))})},[c]);return T?Xn.createElement(IX,{"data-rsbs-portal":!0},Xn.createElement(rJ,ts({},_,{lastSnapRef:O,ref:o,initialState:F.current,onSpringStart:U,onSpringEnd:Z}))):null}),Ml=(r=>(r.Regular="Pretendard-Regular",r.Medium="Pretendard-Medium",r.Bold="Pretendard-Bold",r))(Ml||{}),Pv=(r=>(r.GET_ALL_THREATS="GET_ALL_THREATS",r.GET_NEARBY_THREATS="GET_NEARBY_THREATS",r.GET_ADDRESS="GET_ADDRESS",r))(Pv||{});const lJ=({image:r,open:o,onDismiss:a,capturedAt:c})=>{const[p,_]=_e.useState(!1),[x,T]=_e.useState(""),[C]=CM(AM),{latitude:P,longitude:O}=(C==null?void 0:C.coords)||{},F=dM(),U=hH(_X,{onSuccess:()=>{mi.success(" ."),F.invalidateQueries([Pv.GET_ALL_THREATS]),a&&a()}});_e.useEffect(()=>()=>{r&&URL.revokeObjectURL(URL.createObjectURL(r))},[r]);const Z=()=>{if(!r){mi.error(" .");return}if(!x){mi.error(" .");return}U.mutate({image:r,latitude:P||0,longitude:O||0,capturedAt:c})};return st(CB,{open:o,children:st(qg,{children:ci(TM,{children:[st("img",{src:r&&URL.createObjectURL(r),alt:"captured",style:{width:"calc(100% - 8px)",maxHeight:"36vh",objectFit:"contain",borderRadius:"8px",border:`4px solid ${dn.secondaryText}`}}),st(du,{height:"16px"}),ci(Xi,{justifyContent:"space-between",children:[st(Vo,{font:Ml.Bold,size:"20px",children:""}),st(Vo,{font:Ml.Medium,size:"20px",color:p?dn.threat:dn.caution,children:p?"":""})]}),ci(Xi,{justifyContent:"center",gap:"24px",children:[st(mu,{onClick:()=>_(!1),children:ci(Xi,{flexDirection:"column",gap:"5px",children:[st(Fg,{diameter:"58px",backgroundColor:p?dn.white:dn.cautionBg,style:{boxShadow:`0px 0px 0px 1px ${dn.cautionBg}`},children:st(Yi.Caution,{color:p?dn.caution:dn.white,size:"30px"})}),st(Vo,{color:dn.cautionBg,children:""})]})}),st(mu,{onClick:()=>_(!0),children:ci(Xi,{flexDirection:"column",gap:"5px",children:[st(Fg,{diameter:"58px",backgroundColor:p?dn.threat:dn.white,style:{boxShadow:`0px 0px 0px 1px ${dn.threat}`},children:st(Yi.Threat,{color:p?dn.white:dn.threat,size:"30px"})}),st(Vo,{color:dn.threat,children:""})]})})]}),st(du,{height:"16px"}),st(Vo,{font:Ml.Bold,size:"20px",children:""}),st(du,{height:"8px"}),st("textarea",{style:{width:"calc(100% - 18px)",height:"100px",borderRadius:"8px",border:`1px solid ${dn.secondaryText}`,padding:"8px",resize:"none"},placeholder:"  ?",value:x,onChange:$=>T($.target.value)}),st(du,{height:"16px"}),ci(Xi,{justifyContent:"center",gap:"10px",children:[st(mu,{backgroundColor:dn.primary,borderRadius:"10px",style:{padding:"7px 16px"},onClick:Z,children:st(Vo,{font:Ml.Medium,color:dn.white,children:""})}),st(mu,{borderRadius:"10px",style:{padding:"7px 16px"},onClick:a,children:st(Vo,{font:Ml.Medium,color:dn.secondaryText,children:""})})]}),st(du,{style:{padding:"20px"}})]})})})},uJ=r=>{switch(r){case tr.SAFE:return dn.primary;case tr.CAUTION:return dn.caution;case tr.THREAT:return dn.threat;default:return dn.secondaryText}},cJ=({safety:r})=>{const o=_e.useRef(null),[a,c]=_e.useState(!1),[p,_]=_e.useState(),[x,T]=_e.useState(),C=()=>{o.current?o.current.click():console.error("inputRef is null")},P=O=>{const F=O.target.files;if(!F)return;const U=F[0];U&&(_(U),T(new Date),c(!0))};return st(yA,{children:ci(mu,{onClick:C,children:[st(Fg,{diameter:"64px",backgroundColor:uJ(r),children:st(Yi.Camera,{color:r===tr.SAFE?dn.secondary:dn.white})}),st("input",{type:"file",accept:"image/*",ref:o,style:{display:"none"},onChange:P}),p&&x&&st(lJ,{image:p,open:a,onDismiss:()=>c(!1),capturedAt:x})]})})};var AB={exports:{}};(function(r,o){(function(a,c){r.exports=c()})(r7,function(){var a,c,p;function _(T,C){if(!a)a=C;else if(!c)c=C;else{var P="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+a+")(sharedChunk); ("+c+")(sharedChunk); self.onerror = null;",O={};a(O),p=C(O),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(p.workerUrl=window.URL.createObjectURL(new Blob([P],{type:"text/javascript"})))}}_(["exports"],function(T){var C=typeof self<"u"?self:{},P="3.0.0-beta.1";let O;const F={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(O==null){const t=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{O={}.API_URL_REGEX!=null?new RegExp({}.API_URL_REGEX):t}catch{O=t}}return O},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){if(!F.API_URL)return null;try{const t=new URL(F.API_URL);return t.hostname==="api.mapbox.cn"?"https://events.mapbox.cn/events/v2":t.hostname==="api.mapbox.com"?"https://events.mapbox.com/events/v2":null}catch{return null}},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,DEFAULT_STYLE:"mapbox://styles/mapbox/standard-beta",MAX_PARALLEL_IMAGE_REQUESTS:16,LOADERS_URL:"https://api.mapbox.com/mapbox-gl-js/v3.0.0/mapbox-gl-loaders.js"},U={supported:!1,testSupport:function(t){!K&&$&&(ie?H(t):Z=t)}};let Z,$,K=!1,ie=!1;function H(t){const e=t.createTexture();t.bindTexture(t.TEXTURE_2D,e);try{if(t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,$),t.isContextLost())return;U.supported=!0}catch{}t.deleteTexture(e),K=!0}C.document&&($=C.document.createElement("img"),$.onload=function(){Z&&H(Z),Z=null,ie=!0},$.onerror=function(){K=!0,Z=null},$.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const G="01";function ee(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var W=me;function me(t,e,n,i){this.cx=3*t,this.bx=3*(n-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(i-e)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=e,this.p2x=n,this.p2y=i}me.prototype={sampleCurveX:function(t){return((this.ax*t+this.bx)*t+this.cx)*t},sampleCurveY:function(t){return((this.ay*t+this.by)*t+this.cy)*t},sampleCurveDerivativeX:function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},solveCurveX:function(t,e){if(e===void 0&&(e=1e-6),t<0)return 0;if(t>1)return 1;for(var n=t,i=0;i<8;i++){var s=this.sampleCurveX(n)-t;if(Math.abs(s)<e)return n;var l=this.sampleCurveDerivativeX(n);if(Math.abs(l)<1e-6)break;n-=s/l}var u=0,h=1;for(n=t,i=0;i<20&&(s=this.sampleCurveX(n),!(Math.abs(s-t)<e));i++)t>s?u=n:h=n,n=.5*(h-u)+u;return n},solve:function(t,e){return this.sampleCurveY(this.solveCurveX(t,e))}};var de=ee(W),he=se;function se(t,e){this.x=t,this.y=e}se.prototype={clone:function(){return new se(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},multByPoint:function(t){return this.clone()._multByPoint(t)},divByPoint:function(t){return this.clone()._divByPoint(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},rotateAround:function(t,e){return this.clone()._rotateAround(t,e)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var e=t.x-this.x,n=t.y-this.y;return e*e+n*n},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,e){return Math.atan2(this.x*e-this.y*t,this.x*t+this.y*e)},_matMult:function(t){var e=t[2]*this.x+t[3]*this.y;return this.x=t[0]*this.x+t[1]*this.y,this.y=e,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_multByPoint:function(t){return this.x*=t.x,this.y*=t.y,this},_divByPoint:function(t){return this.x/=t.x,this.y/=t.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var e=Math.cos(t),n=Math.sin(t),i=n*this.x+e*this.y;return this.x=e*this.x-n*this.y,this.y=i,this},_rotateAround:function(t,e){var n=Math.cos(t),i=Math.sin(t),s=e.y+i*(this.x-e.x)+n*(this.y-e.y);return this.x=e.x+n*(this.x-e.x)-i*(this.y-e.y),this.y=s,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},se.convert=function(t){return t instanceof se?t:Array.isArray(t)?new se(t[0],t[1]):t};var q=ee(he);function Se(t,e){if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(!Se(t[n],e[n]))return!1;return!0}if(typeof t=="object"&&t!==null&&e!==null){if(typeof e!="object"||Object.keys(t).length!==Object.keys(e).length)return!1;for(const n in t)if(!Se(t[n],e[n]))return!1;return!0}return t===e}const ze=Math.PI/180,Ue=180/Math.PI;function Be(t){return t*ze}function rt(t){return t*Ue}const _t=[[0,0],[1,0],[1,1],[0,1]];function zt(t){if(t<=0)return 0;if(t>=1)return 1;const e=t*t,n=e*t;return 4*(t<.5?n:3*(t-e)+n-.75)}function dt(t){let e=1/0,n=1/0,i=-1/0,s=-1/0;for(const l of t)e=Math.min(e,l.x),n=Math.min(n,l.y),i=Math.max(i,l.x),s=Math.max(s,l.y);return{min:new q(e,n),max:new q(i,s)}}function Te(t,e,n=0,i=!0){const s=new q(n,n),l=t.sub(s),u=e.add(s),h=[l,new q(u.x,l.y),u,new q(l.x,u.y)];return i&&h.push(l.clone()),h}function we(t,e,n,i){const s=new de(t,e,n,i);return function(l){return s.solve(l)}}const Q=we(.25,.1,.25,1);function ce(t,e,n){return Math.min(n,Math.max(e,t))}function De(t,e,n){return(n=ce((n-t)/(e-t),0,1))*n*(3-2*n)}function He(t,e,n){const i=n-e,s=((t-e)%i+i)%i+e;return s===e?n:s}function $e(t,e,n){if(!t.length)return n(null,[]);let i=t.length;const s=new Array(t.length);let l=null;t.forEach((u,h)=>{e(u,(f,m)=>{f&&(l=f),s[h]=m,--i==0&&n(l,s)})})}function xt(t){const e=[];for(const n in t)e.push(t[n]);return e}function ge(t,...e){for(const n of e)for(const i in n)t[i]=n[i];return t}function Pt(t,e){const n={};for(let i=0;i<e.length;i++){const s=e[i];s in t&&(n[s]=t[s])}return n}let ot=1;function Dn(){return ot++}function $n(){return function t(e){return e?(e^Math.random()*(16>>e/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,t)}()}function Ln(t){return t<=1?1:Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))}function vn(t){return!!t&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(t)}function On(t,e){t.forEach(n=>{e[n]&&(e[n]=e[n].bind(e))})}function Br(t,e){return t.indexOf(e,t.length-e.length)!==-1}function bn(t,e,n){const i={};for(const s in t)i[s]=e.call(n||this,t[s],s,t);return i}function et(t,e,n){const i={};for(const s in t)e.call(n||this,t[s],s,t)&&(i[s]=t[s]);return i}function te(t){return Array.isArray(t)?t.map(te):typeof t=="object"&&t?bn(t,te):t}const ue={};function ye(t){ue[t]||(typeof console<"u"&&console.warn(t),ue[t]=!0)}function We(t,e,n){return(n.y-t.y)*(e.x-t.x)>(e.y-t.y)*(n.x-t.x)}function Je(t){let e=0;for(let n,i,s=0,l=t.length,u=l-1;s<l;u=s++)n=t[s],i=t[u],e+=(i.x-n.x)*(n.y+i.y);return e}function bt([t,e,n]){const i=Be(e+90),s=Be(n);return{x:t*Math.cos(i)*Math.sin(s),y:t*Math.sin(i)*Math.sin(s),z:t*Math.cos(s),azimuthal:e,polar:n}}function St(t,e,n){const i=Math.sqrt(t*t+e*e+n*n),s=i>0?Math.acos(n/i)*Ue:0;let l=t!==0||e!==0?Math.atan2(-e,-t)*Ue+90:0;return l<0&&(l+=360),[i,l,s]}function Ne(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function wt(t){const e={};if(t.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(n,i,s,l)=>{const u=s||l;return e[i]=!u||u.toLowerCase(),""}),e["max-age"]){const n=parseInt(e["max-age"],10);isNaN(n)?delete e["max-age"]:e["max-age"]=n}return e}let Rt=null;function Wt(t){if(Rt==null){const e=t.navigator?t.navigator.userAgent:null;Rt=!!t.safari||!(!e||!(/\b(iPad|iPhone|iPod)\b/.test(e)||e.match("Safari")&&!e.match("Chrome")))}return Rt}function cn(){return!!C.document.fullscreenElement||!!C.document.webkitFullscreenElement}function Yn(t){try{const e=C[t];return e.setItem("_mapbox_test_",1),e.removeItem("_mapbox_test_"),!0}catch{return!1}}function hr(t,e){return[t[4*e],t[4*e+1],t[4*e+2],t[4*e+3]]}function pr(t,e,n){t[4*e+0]=n[0],t[4*e+1]=n[1],t[4*e+2]=n[2],t[4*e+3]=n[3]}function nr(t,e){return[Math.pow(t[0],2.2)*e,Math.pow(t[1],2.2)*e,Math.pow(t[2],2.2)*e]}function dr(t){return[Math.pow(t[0],1/2.2),Math.pow(t[1],1/2.2),Math.pow(t[2],1/2.2)]}const Xe="mapbox-tiles";let be=500,Ke=50,nt,Vt;function Ht(){try{return C.caches}catch{}}function $t(){Ht()&&!nt&&(nt=C.caches.open(Xe))}function jt(t){const e=t.indexOf("?");if(e<0)return t;const n=function(s){const l=s.indexOf("?");return l>0?s.slice(l+1).split("&"):[]}(t),i=n.filter(s=>{const l=s.split("=");return l[0]==="language"||l[0]==="worldview"});return i.length?`${t.slice(0,e)}?${i.join("&")}`:t.slice(0,e)}let Lt=1/0;function Oe(t){Lt++,Lt>Ke&&(t.getActor().send("enforceCacheSizeLimit",be),Lt=0)}const Ie={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(Ie);class je extends Error{constructor(e,n,i){n===401&&pn(i)&&(e+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(e),this.status=n,this.url=i}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const Qe=Ne()?()=>self.worker&&self.worker.referrer:()=>(C.location.protocol==="blob:"?C.parent:C).location.href,tt=function(t,e){if(!(/^file:/.test(n=t.url)||/^file:/.test(Qe())&&!/^\w+:/.test(n))){if(C.fetch&&C.Request&&C.AbortController&&C.Request.prototype.hasOwnProperty("signal"))return function(i,s){const l=new C.AbortController,u=new C.Request(i.url,{method:i.method||"GET",body:i.body,credentials:i.credentials,headers:i.headers,referrer:Qe(),referrerPolicy:i.referrerPolicy,signal:l.signal});let h=!1,f=!1;const m=(y=u.url).indexOf("sku=")>0&&pn(y);var y;i.type==="json"&&u.headers.set("Accept","application/json");const v=(S,E,A)=>{if(f)return;if(S&&S.message!=="SecurityError"&&ye(S.toString()),E&&A)return w(E);const M=Date.now();C.fetch(u).then(k=>{if(k.ok){const R=m?k.clone():null;return w(k,R,M)}return s(new je(k.statusText,k.status,i.url))}).catch(k=>{k.name!=="AbortError"&&s(new Error(`${k.message} ${i.url}`))})},w=(S,E,A)=>{(i.type==="arrayBuffer"?S.arrayBuffer():i.type==="json"?S.json():S.text()).then(M=>{f||(E&&A&&function(k,R,L){if($t(),!nt)return;const z={status:R.status,statusText:R.statusText,headers:new C.Headers};R.headers.forEach((V,Y)=>z.headers.set(Y,V));const B=wt(R.headers.get("Cache-Control")||"");if(B["no-store"])return;B["max-age"]&&z.headers.set("Expires",new Date(L+1e3*B["max-age"]).toUTCString());const j=z.headers.get("Expires");j&&(new Date(j).getTime()-L<42e4||function(V,Y){if(Vt===void 0)try{new Response(new ReadableStream),Vt=!0}catch{Vt=!1}Vt?Y(V.body):V.blob().then(Y)}(R,V=>{const Y=new C.Response(V,z);$t(),nt&&nt.then(ne=>ne.put(jt(k.url),Y)).catch(ne=>ye(ne.message))}))}(u,E,A),h=!0,s(null,M,S.headers.get("Cache-Control"),S.headers.get("Expires")))}).catch(M=>{f||s(new Error(M.message))})};return m?function(S,E){if($t(),!nt)return E(null);const A=jt(S.url);nt.then(M=>{M.match(A).then(k=>{const R=function(L){if(!L)return!1;const z=new Date(L.headers.get("Expires")||0),B=wt(L.headers.get("Cache-Control")||"");return z>Date.now()&&!B["no-cache"]}(k);M.delete(A),R&&M.put(A,k.clone()),E(null,k,R)}).catch(E)}).catch(E)}(u,v):v(null,null),{cancel:()=>{f=!0,h||l.abort()}}}(t,e);if(Ne()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",t,e,void 0,!0)}var n;return function(i,s){const l=new C.XMLHttpRequest;l.open(i.method||"GET",i.url,!0),i.type==="arrayBuffer"&&(l.responseType="arraybuffer");for(const u in i.headers)l.setRequestHeader(u,i.headers[u]);return i.type==="json"&&(l.responseType="text",l.setRequestHeader("Accept","application/json")),l.withCredentials=i.credentials==="include",l.onerror=()=>{s(new Error(l.statusText))},l.onload=()=>{if((l.status>=200&&l.status<300||l.status===0)&&l.response!==null){let u=l.response;if(i.type==="json")try{u=JSON.parse(l.response)}catch(h){return s(h)}s(null,u,l.getResponseHeader("Cache-Control"),l.getResponseHeader("Expires"))}else s(new je(l.statusText,l.status,i.url))},l.send(i.body),{cancel:()=>l.abort()}}(t,e)},ht=function(t,e){return tt(ge(t,{type:"json"}),e)},at=function(t,e){return tt(ge(t,{type:"arrayBuffer"}),e)};function ut(t){const e=C.document.createElement("a");return e.href=t,e.protocol===C.document.location.protocol&&e.host===C.document.location.host}const Et="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let it,Yt;it=[],Yt=0;const xn=function(t,e){if(U.supported&&(t.headers||(t.headers={}),t.headers.accept="image/webp,*/*"),Yt>=F.MAX_PARALLEL_IMAGE_REQUESTS){const l={requestParameters:t,callback:e,cancelled:!1,cancel(){this.cancelled=!0}};return it.push(l),l}Yt++;let n=!1;const i=()=>{if(!n)for(n=!0,Yt--;it.length&&Yt<F.MAX_PARALLEL_IMAGE_REQUESTS;){const l=it.shift(),{requestParameters:u,callback:h,cancelled:f}=l;f||(l.cancel=xn(u,h).cancel)}},s=at(t,(l,u,h,f)=>{i(),l?e(l):u&&(C.createImageBitmap?function(m,y){const v=new C.Blob([new Uint8Array(m)],{type:"image/png"});C.createImageBitmap(v).then(w=>{y(null,w)}).catch(w=>{y(new Error(`Could not load image because of ${w.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(u,(m,y)=>e(m,y,h,f)):function(m,y){const v=new C.Image,w=C.URL;v.onload=()=>{y(null,v),w.revokeObjectURL(v.src),v.onload=null,C.requestAnimationFrame(()=>{v.src=Et})},v.onerror=()=>y(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const S=new C.Blob([new Uint8Array(m)],{type:"image/png"});v.src=m.byteLength?w.createObjectURL(S):Et}(u,(m,y)=>e(m,y,h,f)))});return{cancel:()=>{s.cancel(),i()}}},Ot="NO_ACCESS_TOKEN";class qn{constructor(e,n,i){this._transformRequestFn=e,this._customAccessToken=n,this._silenceAuthErrors=!!i,this._createSkuToken()}_createSkuToken(){const e=function(){let n="";for(let i=0;i<10;i++)n+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",G,n].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=e.token,this._skuTokenExpiresAt=e.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(e,n){return this._transformRequestFn&&this._transformRequestFn(e,n)||{url:e}}normalizeStyleURL(e,n){if(!Wn(e))return e;const i=Dr(e);return i.path=`/styles/v1${i.path}`,this._makeAPIURL(i,this._customAccessToken||n)}normalizeGlyphsURL(e,n){if(!Wn(e))return e;const i=Dr(e);return i.path=`/fonts/v1${i.path}`,this._makeAPIURL(i,this._customAccessToken||n)}normalizeModelURL(e,n){if(!Wn(e))return e;const i=Dr(e);return i.path=`/models/v1${i.path}`,this._makeAPIURL(i,this._customAccessToken||n)}normalizeSourceURL(e,n,i,s){if(!Wn(e))return e;const l=Dr(e);return l.path=`/v4/${l.authority}.json`,l.params.push("secure"),i&&l.params.push(`language=${i}`),s&&l.params.push(`worldview=${s}`),this._makeAPIURL(l,this._customAccessToken||n)}normalizeSpriteURL(e,n,i,s){const l=Dr(e);return Wn(e)?(l.path=`/styles/v1${l.path}/sprite${n}${i}`,this._makeAPIURL(l,this._customAccessToken||s)):(l.path+=`${n}${i}`,Qr(l))}normalizeTileURL(e,n,i){if(this._isSkuTokenExpired()&&this._createSkuToken(),e&&!Wn(e))return e;const s=Dr(e);s.path=s.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${n||i&&s.authority!=="raster"&&i===512?"@2x":""}${U.supported?".webp":"$1"}`),s.authority==="raster"?s.path=`/${F.RASTER_URL_PREFIX}${s.path}`:(s.path=s.path.replace(/^.+\/v4\//,"/"),s.path=`/${F.TILE_URL_VERSION}${s.path}`);const l=this._customAccessToken||function(u){for(const h of u){const f=h.match(/^access_token=(.*)$/);if(f)return f[1]}return null}(s.params)||F.ACCESS_TOKEN;return F.REQUIRE_ACCESS_TOKEN&&l&&this._skuToken&&s.params.push(`sku=${this._skuToken}`),this._makeAPIURL(s,l)}canonicalizeTileURL(e,n){const i=Dr(e);if(!i.path.match(/^(\/v4\/|\/raster\/v1\/)/)||!i.path.match(/\.[\w]+$/))return e;let s="mapbox://";i.path.match(/^\/raster\/v1\//)?s+=`raster/${i.path.replace(`/${F.RASTER_URL_PREFIX}/`,"")}`:s+=`tiles/${i.path.replace(`/${F.TILE_URL_VERSION}/`,"")}`;let l=i.params;return n&&(l=l.filter(u=>!u.match(/^access_token=/))),l.length&&(s+=`?${l.join("&")}`),s}canonicalizeTileset(e,n){const i=!!n&&Wn(n),s=[];for(const l of e.tiles||[])pn(l)?s.push(this.canonicalizeTileURL(l,i)):s.push(l);return s}_makeAPIURL(e,n){const i="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",s=Dr(F.API_URL);if(e.protocol=s.protocol,e.authority=s.authority,e.protocol==="http"){const l=e.params.indexOf("secure");l>=0&&e.params.splice(l,1)}if(s.path!=="/"&&(e.path=`${s.path}${e.path}`),!F.REQUIRE_ACCESS_TOKEN)return Qr(e);if(n=n||F.ACCESS_TOKEN,!this._silenceAuthErrors){if(!n)throw new Error(`An API access token is required to use Mapbox GL. ${i}`);if(n[0]==="s")throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${i}`)}return e.params=e.params.filter(l=>l.indexOf("access_token")===-1),e.params.push(`access_token=${n||""}`),Qr(e)}}function Wn(t){return t.indexOf("mapbox:")===0}function pn(t){return F.API_URL_REGEX.test(t)}function rr(t){return F.API_CDN_URL_REGEX.test(t)}function Rr(t){return F.API_STYLE_REGEX.test(t)&&!Yr(t)}function Yr(t){return F.API_SPRITE_REGEX.test(t)}const ar=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function Dr(t){const e=t.match(ar);if(!e)throw new Error("Unable to parse URL object");return{protocol:e[1],authority:e[2],path:e[3]||"/",params:e[4]?e[4].split("&"):[]}}function Qr(t){const e=t.params.length?`?${t.params.join("&")}`:"";return`${t.protocol}://${t.authority}${t.path}${e}`}const Po="mapbox.eventData";function oa(t){if(!t)return null;const e=t.split(".");if(!e||e.length!==3)return null;try{return JSON.parse(decodeURIComponent(C.atob(e[1]).split("").map(n=>"%"+("00"+n.charCodeAt(0).toString(16)).slice(-2)).join("")))}catch{return null}}class Ho{constructor(e){this.type=e,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(e){const n=oa(F.ACCESS_TOKEN);let i="";return i=n&&n.u?C.btoa(encodeURIComponent(n.u).replace(/%([0-9A-F]{2})/g,(s,l)=>String.fromCharCode(+("0x"+l)))):F.ACCESS_TOKEN||"",e?`${Po}.${e}:${i}`:`${Po}:${i}`}fetchEventData(){const e=Yn("localStorage"),n=this.getStorageKey(),i=this.getStorageKey("uuid");if(e)try{const s=C.localStorage.getItem(n);s&&(this.eventData=JSON.parse(s));const l=C.localStorage.getItem(i);l&&(this.anonId=l)}catch{ye("Unable to read from LocalStorage")}}saveEventData(){const e=Yn("localStorage"),n=this.getStorageKey(),i=this.getStorageKey("uuid");if(e)try{C.localStorage.setItem(i,this.anonId),Object.keys(this.eventData).length>=1&&C.localStorage.setItem(n,JSON.stringify(this.eventData))}catch{ye("Unable to write to LocalStorage")}}processRequests(e){}postEvent(e,n,i,s){if(!F.EVENTS_URL)return;const l=Dr(F.EVENTS_URL);l.params.push(`access_token=${s||F.ACCESS_TOKEN||""}`);const u={event:this.type,created:new Date(e).toISOString()},h=n?ge(u,n):u,f={url:Qr(l),headers:{"Content-Type":"text/plain"},body:JSON.stringify([h])};this.pendingRequest=function(m,y){return tt(ge(m,{method:"POST"}),y)}(f,m=>{this.pendingRequest=null,i(m),this.saveEventData(),this.processRequests(s)})}queueRequest(e,n){this.queue.push(e),this.processRequests(n)}}const Ll=new class extends Ho{constructor(t){super("appUserTurnstile"),this._customAccessToken=t}postTurnstileEvent(t,e){F.EVENTS_URL&&F.ACCESS_TOKEN&&Array.isArray(t)&&t.some(n=>Wn(n)||pn(n))&&this.queueRequest(Date.now(),e)}processRequests(t){if(this.pendingRequest||this.queue.length===0)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const e=oa(F.ACCESS_TOKEN),n=e?e.u:F.ACCESS_TOKEN;let i=n!==this.eventData.tokenU;vn(this.anonId)||(this.anonId=$n(),i=!0);const s=this.queue.shift();if(this.eventData.lastSuccess){const l=new Date(this.eventData.lastSuccess),u=new Date(s),h=(s-this.eventData.lastSuccess)/864e5;i=i||h>=1||h<-1||l.getDate()!==u.getDate()}else i=!0;i?this.postEvent(s,{sdkIdentifier:"mapbox-gl-js",sdkVersion:P,skuId:G,"enabled.telemetry":!1,userId:this.anonId},l=>{l||(this.eventData.lastSuccess=s,this.eventData.tokenU=n)},t):this.processRequests()}},Sc=Ll.postTurnstileEvent.bind(Ll),od=new class extends Ho{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(t,e,n,i){this.skuToken=e,this.errorCb=i,F.EVENTS_URL&&(n||F.ACCESS_TOKEN?this.queueRequest({id:t,timestamp:Date.now()},n):this.errorCb(new Error(Ot)))}processRequests(t){if(this.pendingRequest||this.queue.length===0)return;const{id:e,timestamp:n}=this.queue.shift();e&&this.success[e]||(this.anonId||this.fetchEventData(),vn(this.anonId)||(this.anonId=$n()),this.postEvent(n,{sdkIdentifier:"mapbox-gl-js",sdkVersion:P,skuId:G,skuToken:this.skuToken,userId:this.anonId},i=>{i?this.errorCb(i):e&&(this.success[e]=!0)},t))}},oi=od.postMapLoadEvent.bind(od),sd=new class extends Ho{constructor(){super("gljs.performance")}postPerformanceEvent(t,e){F.EVENTS_URL&&(t||F.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:e},t)}processRequests(t){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:e,performanceData:n}=this.queue.shift(),i=function(s){const l=C.performance.getEntriesByType("resource"),u=C.performance.getEntriesByType("mark"),h=function(w){const S={};if(w){for(const E in w)if(E!=="other")for(const A of w[E]){const M=`${E}ResolveRangeMin`,k=`${E}ResolveRangeMax`,R=`${E}RequestCount`,L=`${E}RequestCachedCount`;S[M]=Math.min(S[M]||1/0,A.startTime),S[k]=Math.max(S[k]||-1/0,A.responseEnd);const z=B=>{S[B]===void 0&&(S[B]=0),++S[B]};A.transferSize!==void 0&&A.transferSize===0&&z(L),z(R)}}return S}(function(w,S){const E={};if(w)for(const A of w){const M=S(A);E[M]===void 0&&(E[M]=[]),E[M].push(A)}return E}(l,j2)),f=C.devicePixelRatio,m=C.navigator.connection||C.navigator.mozConnection||C.navigator.webkitConnection,y={counters:[],metadata:[],attributes:[]},v=(w,S,E)=>{E!=null&&w.push({name:S,value:E.toString()})};for(const w in h)v(y.counters,w,h[w]);if(s.interactionRange[0]!==1/0&&s.interactionRange[1]!==-1/0&&(v(y.counters,"interactionRangeMin",s.interactionRange[0]),v(y.counters,"interactionRangeMax",s.interactionRange[1])),u)for(const w of Object.keys(vu)){const S=vu[w],E=u.find(A=>A.name===S);E&&v(y.counters,S,E.startTime)}return v(y.counters,"visibilityHidden",s.visibilityHidden),v(y.attributes,"style",function(w){if(w)for(const S of w){const E=S.name.split("?")[0];if(Rr(E)){const A=E.split("/").slice(-2);if(A.length===2)return`mapbox://styles/${A[0]}/${A[1]}`}}}(l)),v(y.attributes,"terrainEnabled",s.terrainEnabled?"true":"false"),v(y.attributes,"fogEnabled",s.fogEnabled?"true":"false"),v(y.attributes,"projection",s.projection),v(y.attributes,"zoom",s.zoom),v(y.metadata,"devicePixelRatio",f),v(y.metadata,"connectionEffectiveType",m?m.effectiveType:void 0),v(y.metadata,"navigatorUserAgent",C.navigator.userAgent),v(y.metadata,"screenWidth",C.screen.width),v(y.metadata,"screenHeight",C.screen.height),v(y.metadata,"windowWidth",C.innerWidth),v(y.metadata,"windowHeight",C.innerHeight),v(y.metadata,"mapWidth",s.width/f),v(y.metadata,"mapHeight",s.height/f),v(y.metadata,"webglRenderer",s.renderer),v(y.metadata,"webglVendor",s.vendor),v(y.metadata,"sdkVersion",P),v(y.metadata,"sdkIdentifier","mapbox-gl-js"),y}(n);for(const s of i.metadata);for(const s of i.counters);for(const s of i.attributes);this.postEvent(e,i,()=>{},t)}},Ol=sd.postPerformanceEvent.bind(sd),Ec=new class extends Ho{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(t,e,n,i){if(!F.API_URL||!F.SESSION_PATH)return;const s=Dr(F.API_URL+F.SESSION_PATH);s.params.push(`sku=${e||""}`),s.params.push(`access_token=${i||F.ACCESS_TOKEN||""}`);const l={url:Qr(s),headers:{"Content-Type":"text/plain"}};this.pendingRequest=function(u,h){return tt(ge(u,{method:"GET"}),h)}(l,u=>{this.pendingRequest=null,n(u),this.saveEventData(),this.processRequests(i)})}getSessionAPI(t,e,n,i){this.skuToken=e,this.errorCb=i,F.SESSION_PATH&&F.API_URL&&(n||F.ACCESS_TOKEN?this.queueRequest({id:t,timestamp:Date.now()},n):this.errorCb(new Error(Ot)))}processRequests(t){if(this.pendingRequest||this.queue.length===0)return;const{id:e,timestamp:n}=this.queue.shift();e&&this.success[e]||this.getSession(n,this.skuToken,i=>{i?this.errorCb(i):e&&(this.success[e]=!0)},t)}},$f=Ec.getSessionAPI.bind(Ec),Gf=new Set;function Xg(t,e){e?Gf.add(t):Gf.delete(t)}const vu={create:"create",load:"load",fullLoad:"fullLoad"},Hs={mark(t){C.performance.mark(t)},measure(t,e,n){C.performance.measure(t,e,n)}};function j2(t){const e=t.name.split("?")[0];return rr(e)&&e.includes("mapbox-gl.js")?"javascript":rr(e)&&e.includes("mapbox-gl.css")?"css":function(n){return F.API_FONTS_REGEX.test(n)}(e)?"fontRange":Yr(e)?"sprite":Rr(e)?"style":function(n){return F.API_TILEJSON_REGEX.test(n)}(e)?"tilejson":"other"}const qs=C.performance;function Rv(t){const e=t?t.url.toString():void 0;return qs.getEntriesByName(e)}var Dv=Kg;function Kg(t){return!function(e){return typeof window>"u"||typeof document>"u"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var i,s,l=new Blob([""],{type:"text/javascript"}),u=URL.createObjectURL(l);try{s=new Worker(u),i=!0}catch{i=!1}return s&&s.terminate(),URL.revokeObjectURL(u),i}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var i=document.createElement("canvas");i.width=i.height=1;var s=i.getContext("2d");if(!s)return!1;var l=s.getImageData(0,0,1,1);return l&&l.width===i.width}()?(Tc[n=e&&e.failIfMajorPerformanceCaveat]===void 0&&(Tc[n]=function(i){var s,l=function(u){var h=document.createElement("canvas"),f=Object.create(Kg.webGLContextAttributes);return f.failIfMajorPerformanceCaveat=u,h.getContext("webgl",f)||h.getContext("experimental-webgl",f)}(i);if(!l)return!1;try{s=l.createShader(l.VERTEX_SHADER)}catch{return!1}return!(!s||l.isContextLost())&&(l.shaderSource(s,"void main() {}"),l.compileShader(s),l.getShaderParameter(s,l.COMPILE_STATUS)===!0)}(n)),Tc[n]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var n}(t)}var Tc={};let xu,wu,bu,Su;Kg.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};const mn={now:()=>bu!==void 0?bu:C.performance.now(),setNow(t){bu=t},restoreNow(){bu=void 0},frame(t){const e=C.requestAnimationFrame(t);return{cancel:()=>C.cancelAnimationFrame(e)}},getImageData(t,e=0){const{width:n,height:i}=t;Su||(Su=C.document.createElement("canvas"));const s=Su.getContext("2d",{willReadFrequently:!0});if(!s)throw new Error("failed to create canvas 2d context");return(n>Su.width||i>Su.height)&&(Su.width=n,Su.height=i),s.clearRect(-e,-e,n+2*e,i+2*e),s.drawImage(t,0,0,n,i),s.getImageData(-e,-e,n+2*e,i+2*e)},resolveURL:t=>(xu||(xu=C.document.createElement("a")),xu.href=t,xu.href),get devicePixelRatio(){return C.devicePixelRatio},get prefersReducedMotion(){return!!C.matchMedia&&(wu==null&&(wu=C.matchMedia("(prefers-reduced-motion: reduce)")),wu.matches)}};function lr(t,e,n){const i=C.document.createElement(t);return e!==void 0&&(i.className=e),n&&n.appendChild(i),i}function sa(t,e,n){const i=C.document.createElementNS("http://www.w3.org/2000/svg",t);for(const s of Object.keys(e))i.setAttributeNS(null,s,e[s]);return n&&n.appendChild(i),i}const Na=C.document&&C.document.documentElement.style,ja=Na&&Na.userSelect!==void 0?"userSelect":"WebkitUserSelect";let Lv;function Hf(){Na&&ja&&(Lv=Na[ja],Na[ja]="none")}function Lr(){Na&&ja&&(Na[ja]=Lv)}function qf(t){t.preventDefault(),t.stopPropagation(),C.removeEventListener("click",qf,!0)}function Wf(){C.addEventListener("click",qf,!0),C.setTimeout(()=>{C.removeEventListener("click",qf,!0)},0)}function Eu(t,e){const n=t.getBoundingClientRect();return Qg(t,n,e)}function ad(t,e){const n=t.getBoundingClientRect(),i=[];for(let s=0;s<e.length;s++)i.push(Qg(t,n,e[s]));return i}function Yg(t){return C.InstallTrigger!==void 0&&t.button===2&&t.ctrlKey&&C.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:t.button}function Qg(t,e,n){const i=t.offsetWidth===e.width?1:t.offsetWidth/e.width;return new q((n.clientX-e.left)*i,(n.clientY-e.top)*i)}function Zf(t,e,n){n[t]&&n[t].indexOf(e)!==-1||(n[t]=n[t]||[],n[t].push(e))}function Cc(t,e,n){if(n&&n[t]){const i=n[t].indexOf(e);i!==-1&&n[t].splice(i,1)}}class ct{constructor(e,n={}){ge(this,n),this.type=e}}class en extends ct{constructor(e,n={}){super("error",ge({error:e},n))}}class Cr{on(e,n){return this._listeners=this._listeners||{},Zf(e,n,this._listeners),this}off(e,n){return Cc(e,n,this._listeners),Cc(e,n,this._oneTimeListeners),this}once(e,n){return n?(this._oneTimeListeners=this._oneTimeListeners||{},Zf(e,n,this._oneTimeListeners),this):new Promise(i=>this.once(e,i))}fire(e,n){typeof e=="string"&&(e=new ct(e,n||{}));const i=e.type;if(this.listens(i)){e.target=this;const s=this._listeners&&this._listeners[i]?this._listeners[i].slice():[];for(const h of s)h.call(this,e);const l=this._oneTimeListeners&&this._oneTimeListeners[i]?this._oneTimeListeners[i].slice():[];for(const h of l)Cc(i,h,this._oneTimeListeners),h.call(this,e);const u=this._eventedParent;u&&(ge(e,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),u.fire(e))}else e instanceof en&&console.error(e.error);return this}listens(e){return!!(this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e))}setEventedParent(e,n){return this._eventedParent=e,this._eventedParentData=n,this}}var ke=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"fragment":{"type":"boolean"},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360,"units":"degrees"},"pitch":{"type":"number","default":0,"units":"degrees"},"light":{"type":"light"},"lights":{"required":false,"type":"array","value":"light-3d"},"terrain":{"type":"terrain"},"fog":{"type":"fog"},"camera":{"type":"camera"},"imports":{"type":"array","value":"import"},"schema":{"type":"schema"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"},"models":{"type":"models"}},"model":{"type":"string","required":true},"import":{"id":{"type":"string","required":true},"url":{"type":"string","required":true},"config":{"type":"config"},"data":{"type":"$root"}},"config":{"*":{"type":"*"}},"schema":{"*":{"type":"option"}},"option":{"default":{"type":"*","required":true},"type":{"type":"enum","values":{"string":{},"number":{},"boolean":{},"color":{}}},"array":{"type":"boolean"},"minValue":{"type":"number"},"maxValue":{"type":"number"},"stepValue":{"type":"number"},"values":{"type":"array","value":"*"},"metadata":{"type":"*"}},"models":{"*":{"type":"model"}},"light-3d":{"id":{"type":"string","required":true},"properties":{"type":"properties"},"type":{"type":"enum","values":{"ambient":{},"directional":{},"flat":{}}}},"properties":["properties_light_directional","properties_light_ambient","properties_light_flat"],"properties_light_directional":{"direction":{"type":"array","default":[210,30],"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"cast-shadows":{"type":"boolean","default":false,"transition":false,"expression":{"interpolated":false},"property-type":"data-constant"},"shadow-intensity":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_ambient":{"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_flat":{"anchor":{"type":"enum","default":"viewport","values":{"map":{},"viewport":{}},"property-type":"data-constant","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image","source_model"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":{},"mapbox":{}},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":{}}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":{}}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":{}}},"url":{"required":true,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_model":{"type":{"required":true,"type":"enum","values":{"model":{},"batched-model":{}}},"maxzoom":{"type":"number","default":18},"minzoom":{"type":"number","default":0},"tiles":{"type":"array","value":"string"}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"hillshade":{},"model":{},"background":{},"sky":{},"slot":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"slot":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background","layout_sky","layout_model"],"layout_background":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","expression":{"interpolated":false},"property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","expression":{"interpolated":false},"property-type":"constant"}},"layout_model":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","expression":{"interpolated":false},"property-type":"constant"},"model-id":{"type":"string","property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]},"transition":false,"requires":[{"source":["geojson","vector"]}]}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","expression":{"interpolated":false},"property-type":"constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","expression":{"interpolated":false},"property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","expression":{"interpolated":false},"property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","expression":{"interpolated":false},"property-type":"constant"},"fill-extrusion-edge-radius":{"type":"number","private":true,"default":0,"minimum":0,"maximum":1,"expression":{"interpolated":false},"property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":{},"round":{},"square":{}},"default":"butt","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":{},"round":{},"miter":{}},"default":"miter","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"requires":[{"line-join":"miter"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"requires":[{"line-join":"round"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","expression":{"interpolated":false},"property-type":"constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":{},"line":{},"line-center":{}},"default":"point","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"units":"pixels","requires":[{"symbol-placement":"line"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":{},"viewport-y":{},"source":{}},"default":"auto","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"units":"factor of the original icon size","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{"type":"enum","values":{"none":{},"width":{},"height":{},"both":{}},"default":"none","requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"units":"pixels","requires":["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"requires":["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{"type":"number","default":10,"minimum":0,"units":"ems","requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":{},"left":{},"center":{},"right":{}},"default":"center","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","units":"ems","default":0,"requires":["text-field"],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["text-field",{"!":"text-variable-anchor"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"units":"degrees","requires":["text-field",{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":{},"vertical":{}},"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"requires":["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":{},"uppercase":{},"lowercase":{}},"default":"none","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","units":"ems","length":2,"default":[0,0],"requires":["text-field",{"!":"text-radial-offset"}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"requires":["text-field","icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","expression":{"interpolated":false},"property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","expression":{"interpolated":false},"property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","expression":{"interpolated":false},"property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},"in":{},"!in":{},"all":{},"any":{},"none":{},"has":{},"!has":{}}},"geometry_type":{"type":"enum","values":{"Point":{},"LineString":{},"Polygon":{}}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":{},"exponential":{},"interval":{},"categorical":{}},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":{},"lab":{},"hcl":{}},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true}},"camera":{"camera-projection":{"type":"enum","values":{"perspective":{},"orthographic":{}},"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"default":"perspective","property-type":"data-constant"}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":{},"viewport":{}},"property-type":"data-constant","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":{},"equalEarth":{},"equirectangular":{},"lambertConformalConic":{},"mercator":{},"naturalEarth":{},"winkelTripel":{},"globe":{}},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["source"]}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky","paint_model"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"requires":[{"!":"fill-pattern"},{"fill-antialias":true}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"units":"intensity","expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-extrusion-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-extrusion-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"requires":["fill-extrusion-height"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant","type":"number","private":true,"default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant","type":"number","private":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["fill-extrusion-edge-radius"]},"fill-extrusion-ambient-occlusion-wall-radius":{"property-type":"data-constant","type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["fill-extrusion-edge-radius"]},"fill-extrusion-ambient-occlusion-ground-radius":{"property-type":"data-constant","type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-attenuation":{"property-type":"data-constant","type":"number","default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-flood-light-color":{"property-type":"data-constant","type":"color","default":"#ffffff","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-intensity":{"property-type":"data-constant","type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-wall-radius":{"property-type":"data-driven","type":"number","units":"meters","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-radius":{"property-type":"data-driven","type":"number","units":"meters","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-attenuation":{"property-type":"data-constant","type":"number","default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-vertical-scale":{"property-type":"data-constant","type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-rounded-roof":{"property-type":"data-constant","type":"boolean","default":true,"requires":["fill-extrusion-edge-radius"],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]}}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"line-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["line-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"transition":false,"units":"line widths","requires":[{"!":"line-pattern"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-gradient":{"type":"color","transition":false,"requires":[{"!":"line-pattern"},{"source":"geojson","has":{"lineMetrics":true}}],"expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"transition":false,"requires":[{"source":"geojson","has":{"lineMetrics":true}}],"property-type":"constant"},"line-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"units":"intensity","expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"line-border-width":{"type":"number","private":true,"default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-border-color":{"type":"color","private":true,"default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["circle-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"units":"intensity","expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"transition":false,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"transition":false,"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"units":"intensity","expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-driven"},"text-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"units":"intensity","expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["icon-image","icon-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-image-cross-fade":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"transition":true},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["text-field","text-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-color":{"type":"color","transition":false,"expression":{"interpolated":true,"parameters":["raster-value"]},"property-type":"color-ramp"},"raster-color-mix":{"type":"array","default":[0.2126,0.7152,0.0722,0],"length":4,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-color-range":{"type":"array","default":[0,1],"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"units":"degrees","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":{},"nearest":{}},"default":"linear","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"transition":false,"units":"milliseconds","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"transition":false,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_background":{"background-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"background-pattern"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"units":"intensity","expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":{},"atmosphere":{}},"default":"atmosphere","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"requires":[{"sky-type":"atmosphere"}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","requires":[{"sky-type":"atmosphere"}],"default":10,"minimum":0,"maximum":100,"transition":false,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","requires":[{"sky-type":"gradient"}],"value":"number","default":[0,0],"length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","requires":[{"sky-type":"gradient"}],"default":90,"minimum":0,"maximum":180,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"transition":false,"requires":[{"sky-type":"gradient"}],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_model":{"model-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"model-rotation":{"type":"array","value":"number","length":3,"default":[0,0,0],"period":360,"units":"degrees","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state"]},"transition":true},"model-scale":{"type":"array","value":"number","length":3,"default":[1,1,1],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-translation":{"type":"array","value":"number","length":3,"default":[0,0,0],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state"]},"transition":true},"model-color":{"type":"color","default":"#ffffff","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-color-mix-intensity":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-type":{"type":"enum","values":{"common-3d":{},"location-indicator":{}},"default":"common-3d","property-type":"data-constant"},"model-cast-shadows":{"type":"boolean","default":true,"transition":false,"expression":{"interpolated":false},"property-type":"data-constant"},"model-receive-shadows":{"type":"boolean","default":true,"transition":false,"expression":{"interpolated":false},"property-type":"data-constant"},"model-ambient-occlusion-intensity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant","transition":true},"model-emissive-strength":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":5,"units":"number","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-roughness":{"type":"number","default":1,"minimum":0,"maximum":1,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state"]},"transition":true},"model-height-based-emissive-strength-multiplier":{"type":"array","default":[1,1,1,1,0],"length":5,"value":"number","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true}},"transition":{"duration":{"type":"number","default":300,"minimum":0,"units":"milliseconds"},"delay":{"type":"number","default":0,"minimum":0,"units":"milliseconds"}},"property-type":{"data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');function os(t,...e){for(const n of e)for(const i in n)t[i]=n[i];return t}class Ct{constructor(e,n,i,s){this.message=(e?`${e}: `:"")+i,s&&(this.identifier=s),n!=null&&n.__line__&&(this.line=n.__line__)}}function Bi(t){return t instanceof Number||t instanceof String||t instanceof Boolean?t.valueOf():t}function aa(t){if(Array.isArray(t))return t.map(aa);if(t instanceof Object&&!(t instanceof Number||t instanceof String||t instanceof Boolean)){const e={};for(const n in t)e[n]=aa(t[n]);return e}return Bi(t)}class ld extends Error{constructor(e,n){super(n),this.message=n,this.key=e}}var la=ld;class Xf{constructor(e,n=[]){this.parent=e,this.bindings={};for(const[i,s]of n)this.bindings[i]=s}concat(e){return new Xf(this,e)}get(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(`${e} not found in scope.`)}has(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)}}var Kf=Xf;const Tu={kind:"null"},It={kind:"number"},Bn={kind:"string"},Gn={kind:"boolean"},lo={kind:"color"},Ua={kind:"object"},Zn={kind:"value"},Yf={kind:"collator"},Cu={kind:"formatted"},zl={kind:"resolvedImage"};function po(t,e){return{kind:"array",itemType:t,N:e}}function si(t){if(t.kind==="array"){const e=si(t.itemType);return typeof t.N=="number"?`array<${e}, ${t.N}>`:t.itemType.kind==="value"?"array":`array<${e}>`}return t.kind}const Fl=[Tu,It,Bn,Gn,lo,Cu,Ua,po(Zn),zl];function Au(t,e){if(e.kind==="error")return null;if(t.kind==="array"){if(e.kind==="array"&&(e.N===0&&e.itemType.kind==="value"||!Au(t.itemType,e.itemType))&&(typeof t.N!="number"||t.N===e.N))return null}else{if(t.kind===e.kind)return null;if(t.kind==="value"){for(const n of Fl)if(!Au(n,e))return null}}return`Expected ${si(t)} but found ${si(e)} instead.`}function Ac(t,e){return e.some(n=>n.kind===t.kind)}function Mc(t,e){return e.some(n=>n==="null"?t===null:n==="array"?Array.isArray(t):n==="object"?t&&!Array.isArray(t)&&typeof t=="object":n===typeof t)}var Ic,ud={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function cd(t){return(t=Math.round(t))<0?0:t>255?255:t}function Ro(t){return cd(t[t.length-1]==="%"?parseFloat(t)/100*255:parseInt(t))}function Va(t){return(e=t[t.length-1]==="%"?parseFloat(t)/100:parseFloat(t))<0?0:e>1?1:e;var e}function hd(t,e,n){return n<0?n+=1:n>1&&(n-=1),6*n<1?t+(e-t)*n*6:2*n<1?e:3*n<2?t+(e-t)*(2/3-n)*6:t}try{Ic={}.parseCSSColor=function(t){var e,n=t.replace(/ /g,"").toLowerCase();if(n in ud)return ud[n].slice();if(n[0]==="#")return n.length===4?(e=parseInt(n.substr(1),16))>=0&&e<=4095?[(3840&e)>>4|(3840&e)>>8,240&e|(240&e)>>4,15&e|(15&e)<<4,1]:null:n.length===7&&(e=parseInt(n.substr(1),16))>=0&&e<=16777215?[(16711680&e)>>16,(65280&e)>>8,255&e,1]:null;var i=n.indexOf("("),s=n.indexOf(")");if(i!==-1&&s+1===n.length){var l=n.substr(0,i),u=n.substr(i+1,s-(i+1)).split(","),h=1;switch(l){case"rgba":if(u.length!==4)return null;h=Va(u.pop());case"rgb":return u.length!==3?null:[Ro(u[0]),Ro(u[1]),Ro(u[2]),h];case"hsla":if(u.length!==4)return null;h=Va(u.pop());case"hsl":if(u.length!==3)return null;var f=(parseFloat(u[0])%360+360)%360/360,m=Va(u[1]),y=Va(u[2]),v=y<=.5?y*(m+1):y+m-y*m,w=2*y-v;return[cd(255*hd(w,v,f+1/3)),cd(255*hd(w,v,f)),cd(255*hd(w,v,f-1/3)),h];default:return null}}return null}}catch{}class Qi{constructor(e,n,i,s=1){this.r=e,this.g=n,this.b=i,this.a=s}static parse(e){if(!e)return;if(e instanceof Qi)return e;if(typeof e!="string")return;const n=Ic(e);return n?new Qi(n[0]/255*n[3],n[1]/255*n[3],n[2]/255*n[3],n[3]):void 0}toString(){const[e,n,i,s]=this.toArray();return`rgba(${Math.round(e)},${Math.round(n)},${Math.round(i)},${s})`}toArray(){const{r:e,g:n,b:i,a:s}=this;return s===0?[0,0,0,0]:[255*e/s,255*n/s,255*i/s,s]}toArray01(){const{r:e,g:n,b:i,a:s}=this;return s===0?[0,0,0,0]:[e/s,n/s,i/s,s]}toArray01Scaled(e){const{r:n,g:i,b:s,a:l}=this;return l===0?[0,0,0]:[n/l*e,i/l*e,s/l*e]}toArray01PremultipliedAlpha(){const{r:e,g:n,b:i,a:s}=this;return[e,n,i,s]}toArray01Linear(){const{r:e,g:n,b:i,a:s}=this;return s===0?[0,0,0,0]:[Math.pow(e/s,2.2),Math.pow(n/s,2.2),Math.pow(i/s,2.2),s]}}Qi.black=new Qi(0,0,0,1),Qi.white=new Qi(1,1,1,1),Qi.transparent=new Qi(0,0,0,0),Qi.red=new Qi(1,0,0,1),Qi.blue=new Qi(0,0,1,1);var wn=Qi;class dd{constructor(e,n,i){this.sensitivity=e?n?"variant":"case":n?"accent":"base",this.locale=i,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(e,n){return this.collator.compare(e,n)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class fd{constructor(e,n,i,s,l){this.text=e.normalize?e.normalize():e,this.image=n,this.scale=i,this.fontStack=s,this.textColor=l}}class Ji{constructor(e){this.sections=e}static fromString(e){return new Ji([new fd(e,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(e=>e.text.length!==0||e.image&&e.image.namePrimary.length!==0)}static factory(e){return e instanceof Ji?e:Ji.fromString(e)}toString(){return this.sections.length===0?"":this.sections.map(e=>e.text).join("")}serialize(){const e=["format"];for(const n of this.sections){if(n.image){e.push(["image",n.image.namePrimary]);continue}e.push(n.text);const i={};n.fontStack&&(i["text-font"]=["literal",n.fontStack.split(",")]),n.scale&&(i["font-scale"]=n.scale),n.textColor&&(i["text-color"]=["rgba"].concat(n.textColor.toArray())),e.push(i)}return e}}class Do{constructor(e){this.namePrimary=e.namePrimary,e.nameSecondary&&(this.nameSecondary=e.nameSecondary),this.available=e.available}toString(){return this.nameSecondary?`[${this.namePrimary},${this.nameSecondary}]`:this.namePrimary}static fromString(e,n){return e?new Do({namePrimary:e,nameSecondary:n,available:!1}):null}serialize(){return this.nameSecondary?["image",this.namePrimary,this.nameSecondary]:["image",this.namePrimary]}}function Jg(t,e,n,i){return typeof t=="number"&&t>=0&&t<=255&&typeof e=="number"&&e>=0&&e<=255&&typeof n=="number"&&n>=0&&n<=255?i===void 0||typeof i=="number"&&i>=0&&i<=1?null:`Invalid rgba value [${[t,e,n,i].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof i=="number"?[t,e,n,i]:[t,e,n]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function kc(t){if(t===null||typeof t=="string"||typeof t=="boolean"||typeof t=="number"||t instanceof wn||t instanceof dd||t instanceof Ji||t instanceof Do)return!0;if(Array.isArray(t)){for(const e of t)if(!kc(e))return!1;return!0}if(typeof t=="object"){for(const e in t)if(!kc(t[e]))return!1;return!0}return!1}function Pi(t){if(t===null)return Tu;if(typeof t=="string")return Bn;if(typeof t=="boolean")return Gn;if(typeof t=="number")return It;if(t instanceof wn)return lo;if(t instanceof dd)return Yf;if(t instanceof Ji)return Cu;if(t instanceof Do)return zl;if(Array.isArray(t)){const e=t.length;let n;for(const i of t){const s=Pi(i);if(n){if(n===s)continue;n=Zn;break}n=s}return po(n||Zn,e)}return Ua}function pd(t){const e=typeof t;return t===null?"":e==="string"||e==="number"||e==="boolean"?String(t):t instanceof wn||t instanceof Ji||t instanceof Do?t.toString():JSON.stringify(t)}class md{constructor(e,n){this.type=e,this.value=n}static parse(e,n){if(e.length!==2)return n.error(`'literal' expression requires exactly one argument, but found ${e.length-1} instead.`);if(!kc(e[1]))return n.error("invalid value");const i=e[1];let s=Pi(i);const l=n.expectedType;return s.kind!=="array"||s.N!==0||!l||l.kind!=="array"||typeof l.N=="number"&&l.N!==0||(s=l),new md(s,i)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof wn?["rgba"].concat(this.value.toArray()):this.value instanceof Ji?this.value.serialize():this.value}}var gd=md,Ni=class{constructor(t){this.name="ExpressionEvaluationError",this.message=t}toJSON(){return this.message}};const ey={string:Bn,number:It,boolean:Gn,object:Ua};class ty{constructor(e,n){this.type=e,this.args=n}static parse(e,n){if(e.length<2)return n.error("Expected at least one argument.");let i,s=1;const l=e[0];if(l==="array"){let h,f;if(e.length>2){const m=e[1];if(typeof m!="string"||!(m in ey)||m==="object")return n.error('The item type argument of "array" must be one of string, number, boolean',1);h=ey[m],s++}else h=Zn;if(e.length>3){if(e[2]!==null&&(typeof e[2]!="number"||e[2]<0||e[2]!==Math.floor(e[2])))return n.error('The length argument to "array" must be a positive integer literal',2);f=e[2],s++}i=po(h,f)}else i=ey[l];const u=[];for(;s<e.length;s++){const h=n.parse(e[s],s,Zn);if(!h)return null;u.push(h)}return new ty(i,u)}evaluate(e){for(let n=0;n<this.args.length;n++){const i=this.args[n].evaluate(e);if(!Au(this.type,Pi(i)))return i;if(n===this.args.length-1)throw new Ni(`Expected value to be of type ${si(this.type)}, but found ${si(Pi(i))} instead.`)}return null}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){const e=this.type,n=[e.kind];if(e.kind==="array"){const i=e.itemType;if(i.kind==="string"||i.kind==="number"||i.kind==="boolean"){n.push(i.kind);const s=e.N;(typeof s=="number"||this.args.length>1)&&n.push(s)}}return n.concat(this.args.map(i=>i.serialize()))}}var $a=ty;class Pc{constructor(e){this.type=Cu,this.sections=e}static parse(e,n){if(e.length<2)return n.error("Expected at least one argument.");const i=e[1];if(!Array.isArray(i)&&typeof i=="object")return n.error("First argument must be an image or text section.");const s=[];let l=!1;for(let u=1;u<=e.length-1;++u){const h=e[u];if(l&&typeof h=="object"&&!Array.isArray(h)){l=!1;let f=null;if(h["font-scale"]&&(f=n.parse(h["font-scale"],1,It),!f))return null;let m=null;if(h["text-font"]&&(m=n.parse(h["text-font"],1,po(Bn)),!m))return null;let y=null;if(h["text-color"]&&(y=n.parse(h["text-color"],1,lo),!y))return null;const v=s[s.length-1];v.scale=f,v.font=m,v.textColor=y}else{const f=n.parse(e[u],1,Zn);if(!f)return null;const m=f.type.kind;if(m!=="string"&&m!=="value"&&m!=="null"&&m!=="resolvedImage")return n.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");l=!0,s.push({content:f,scale:null,font:null,textColor:null})}}return new Pc(s)}evaluate(e){return new Ji(this.sections.map(n=>{const i=n.content.evaluate(e);return Pi(i)===zl?new fd("",i,null,null,null):new fd(pd(i),null,n.scale?n.scale.evaluate(e):null,n.font?n.font.evaluate(e).join(","):null,n.textColor?n.textColor.evaluate(e):null)}))}eachChild(e){for(const n of this.sections)e(n.content),n.scale&&e(n.scale),n.font&&e(n.font),n.textColor&&e(n.textColor)}outputDefined(){return!1}serialize(){const e=["format"];for(const n of this.sections){e.push(n.content.serialize());const i={};n.scale&&(i["font-scale"]=n.scale.serialize()),n.font&&(i["text-font"]=n.font.serialize()),n.textColor&&(i["text-color"]=n.textColor.serialize()),e.push(i)}return e}}class yd{constructor(e,n){this.type=zl,this.inputPrimary=e,this.inputSecondary=n}static parse(e,n){if(e.length<2)return n.error("Expected two or more arguments.");const i=n.parse(e[1],1,Bn);if(!i)return n.error("No image name provided.");if(e.length===2)return new yd(i);const s=n.parse(e[2],1,Bn);return s?new yd(i,s):n.error("Secondary image variant is not a string.")}evaluate(e){const n=Do.fromString(this.inputPrimary.evaluate(e),this.inputSecondary?this.inputSecondary.evaluate(e):void 0);return n&&e.availableImages&&(n.available=e.availableImages.indexOf(n.namePrimary)>-1,n.nameSecondary&&n.available&&e.availableImages&&(n.available=e.availableImages.indexOf(n.nameSecondary)>-1)),n}eachChild(e){e(this.inputPrimary),this.inputSecondary&&e(this.inputSecondary)}outputDefined(){return!1}serialize(){return this.inputSecondary?["image",this.inputPrimary.serialize(),this.inputSecondary.serialize()]:["image",this.inputPrimary.serialize()]}}function Qn(t){return t instanceof Number?"number":t instanceof String?"string":t instanceof Boolean?"boolean":Array.isArray(t)?"array":t===null?"null":typeof t}const U2={"to-boolean":Gn,"to-color":lo,"to-number":It,"to-string":Bn};class ny{constructor(e,n){this.type=e,this.args=n}static parse(e,n){if(e.length<2)return n.error("Expected at least one argument.");const i=e[0],s=[];let l=Tu;if(i==="to-array"){if(!Array.isArray(e[1]))return null;const u=e[1].length;if(n.expectedType){if(n.expectedType.kind!=="array")return n.error(`Expected ${n.expectedType.kind} but found array.`);l=po(n.expectedType.itemType,u)}else{if(!(u>0&&kc(e[1][0])))return null;l=po(Pi(e[1][0]),u)}for(let h=0;h<u;h++){const f=e[1][h];let m;if(Qn(f)==="array")m=n.parse(f,void 0,l.itemType);else{const y=Qn(f);if(y!==l.itemType.kind)return n.error(`Expected ${l.itemType.kind} but found ${y}.`);m=n.registry.literal.parse(["literal",f===void 0?null:f],n)}if(!m)return null;s.push(m)}}else{if((i==="to-boolean"||i==="to-string")&&e.length!==2)return n.error("Expected one argument.");l=U2[i];for(let u=1;u<e.length;u++){const h=n.parse(e[u],u,Zn);if(!h)return null;s.push(h)}}return new ny(l,s)}evaluate(e){if(this.type.kind==="boolean")return!!this.args[0].evaluate(e);if(this.type.kind==="color"){let n,i;for(const s of this.args){if(n=s.evaluate(e),i=null,n instanceof wn)return n;if(typeof n=="string"){const l=e.parseColor(n);if(l)return l}else if(Array.isArray(n)&&(i=n.length<3||n.length>4?`Invalid rbga value ${JSON.stringify(n)}: expected an array containing either three or four numeric values.`:Jg(n[0],n[1],n[2],n[3]),!i))return new wn(n[0]/255,n[1]/255,n[2]/255,n[3])}throw new Ni(i||`Could not parse color from value '${typeof n=="string"?n:String(JSON.stringify(n))}'`)}if(this.type.kind==="number"){let n=null;for(const i of this.args){if(n=i.evaluate(e),n===null)return 0;const s=Number(n);if(!isNaN(s))return s}throw new Ni(`Could not convert ${JSON.stringify(n)} to number.`)}return this.type.kind==="formatted"?Ji.fromString(pd(this.args[0].evaluate(e))):this.type.kind==="resolvedImage"?Do.fromString(pd(this.args[0].evaluate(e))):this.type.kind==="array"?this.args.map(n=>n.evaluate(e)):pd(this.args[0].evaluate(e))}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){if(this.type.kind==="formatted")return new Pc([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new yd(this.args[0]).serialize();const e=this.type.kind==="array"?[]:[`to-${this.type.kind}`];return this.eachChild(n=>{e.push(n.serialize())}),e}}var Ga=ny;const V2=["Unknown","Point","LineString","Polygon"];var Ov=class{constructor(t){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null,this.options=t}id(){return this.feature&&this.feature.id!==void 0?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?V2[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}measureLight(t){return this.globals.brightness||0}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const t=this.featureDistanceData.center,e=this.featureDistanceData.scale,{x:n,y:i}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(n*e-t[0])+this.featureDistanceData.bearing[1]*(i*e-t[1])}return 0}parseColor(t){let e=this._parseColorCache[t];return e||(e=this._parseColorCache[t]=wn.parse(t)),e}getConfig(t){return this.options?this.options.get(t):null}};class Rc{constructor(e,n,i,s){this.name=e,this.type=n,this._evaluate=i,this.args=s}evaluate(e){return this._evaluate(e,this.args)}eachChild(e){this.args.forEach(e)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(e=>e.serialize()))}static parse(e,n){const i=e[0],s=Rc.definitions[i];if(!s)return n.error(`Unknown expression "${i}". If you wanted a literal array, use ["literal", [...]].`,0);const l=Array.isArray(s)?s[0]:s.type,u=Array.isArray(s)?[[s[1],s[2]]]:s.overloads,h=u.filter(([m])=>!Array.isArray(m)||m.length===e.length-1);let f=null;for(const[m,y]of h){f=new dp(n.registry,n.path,null,n.scope,void 0,n.options);const v=[];let w=!1;for(let S=1;S<e.length;S++){const E=e[S],A=Array.isArray(m)?m[S-1]:m.type,M=f.parse(E,1+v.length,A);if(!M){w=!0;break}v.push(M)}if(!w)if(Array.isArray(m)&&m.length!==v.length)f.error(`Expected ${m.length} arguments, but found ${v.length} instead.`);else{for(let S=0;S<v.length;S++){const E=Array.isArray(m)?m[S]:m.type,A=v[S];f.concat(S+1).checkSubtype(E,A.type)}if(f.errors.length===0)return new Rc(i,l,y,v)}}if(h.length===1)n.errors.push(...f.errors);else{const m=(h.length?h:u).map(([v])=>{return w=v,Array.isArray(w)?`(${w.map(si).join(", ")})`:`(${si(w.type)}...)`;var w}).join(" | "),y=[];for(let v=1;v<e.length;v++){const w=n.parse(e[v],1+y.length);if(!w)return null;y.push(si(w.type))}n.error(`Expected arguments of type ${m}, but found (${y.join(", ")}) instead.`)}return null}static register(e,n){Rc.definitions=n;for(const i in n)e[i]=Rc}}var Ws=Rc;class Qf{constructor(e,n,i){this.type=Yf,this.locale=i,this.caseSensitive=e,this.diacriticSensitive=n}static parse(e,n){if(e.length!==2)return n.error("Expected one argument.");const i=e[1];if(typeof i!="object"||Array.isArray(i))return n.error("Collator options argument must be an object.");const s=n.parse(i["case-sensitive"]!==void 0&&i["case-sensitive"],1,Gn);if(!s)return null;const l=n.parse(i["diacritic-sensitive"]!==void 0&&i["diacritic-sensitive"],1,Gn);if(!l)return null;let u=null;return i.locale&&(u=n.parse(i.locale,1,Bn),!u)?null:new Qf(s,l,u)}evaluate(e){return new dd(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)}eachChild(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)}outputDefined(){return!1}serialize(){const e={};return e["case-sensitive"]=this.caseSensitive.serialize(),e["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(e.locale=this.locale.serialize()),["collator",e]}}var zv={exports:{}};zv.exports=function(){function t(i,s,l,u,h){for(;u>l;){if(u-l>600){var f=u-l+1,m=s-l+1,y=Math.log(f),v=.5*Math.exp(2*y/3),w=.5*Math.sqrt(y*v*(f-v)/f)*(m-f/2<0?-1:1);t(i,s,Math.max(l,Math.floor(s-m*v/f+w)),Math.min(u,Math.floor(s+(f-m)*v/f+w)),h)}var S=i[s],E=l,A=u;for(e(i,l,s),h(i[u],S)>0&&e(i,l,u);E<A;){for(e(i,E,A),E++,A--;h(i[E],S)<0;)E++;for(;h(i[A],S)>0;)A--}h(i[l],S)===0?e(i,l,A):e(i,++A,u),A<=s&&(l=A+1),s<=A&&(u=A-1)}}function e(i,s,l){var u=i[s];i[s]=i[l],i[l]=u}function n(i,s){return i<s?-1:i>s?1:0}return function(i,s,l,u,h){t(i,s,l||0,u||i.length-1,h||n)}}();var $2=ee(zv.exports);function G2(t){let e=0;for(let n,i,s=0,l=t.length,u=l-1;s<l;u=s++)n=t[s],i=t[u],e+=(i.x-n.x)*(n.y+i.y);return e}function _d(t,e){t[0]=Math.min(t[0],e[0]),t[1]=Math.min(t[1],e[1]),t[2]=Math.max(t[2],e[0]),t[3]=Math.max(t[3],e[1])}function vd(t,e){return!(t[0]<=e[0]||t[2]>=e[2]||t[1]<=e[1]||t[3]>=e[3])}function H2(t,e,n){const i=t[0]-e[0],s=t[1]-e[1],l=t[0]-n[0],u=t[1]-n[1];return i*u-l*s==0&&i*l<=0&&s*u<=0}function Bl(t,e,n=!1){let i=!1;for(let h=0,f=e.length;h<f;h++){const m=e[h];for(let y=0,v=m.length,w=v-1;y<v;w=y++){const S=m[w],E=m[y];if(H2(t,S,E))return n;(l=S)[1]>(s=t)[1]!=(u=E)[1]>s[1]&&s[0]<(u[0]-l[0])*(s[1]-l[1])/(u[1]-l[1])+l[0]&&(i=!i)}}var s,l,u;return i}function Dc(t,e,n,i){const s=i[0]-n[0],l=i[1]-n[1],u=(t[0]-n[0])*l-s*(t[1]-n[1]),h=(e[0]-n[0])*l-s*(e[1]-n[1]);return u>0&&h<0||u<0&&h>0}function Jf(t,e,n,i){return(s=[i[0]-n[0],i[1]-n[1]])[0]*(l=[e[0]-t[0],e[1]-t[1]])[1]-s[1]*l[0]!=0&&!(!Dc(t,e,n,i)||!Dc(n,i,t,e));var s,l}const Ha=8192;function Fv(t,e){const n=(180+t[0])/360,i=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t[1]*Math.PI/360)))/360,s=Math.pow(2,e.z);return[Math.round(n*s*Ha),Math.round(i*s*Ha)]}function Bv(t,e){for(let n=0;n<e.length;n++)if(Bl(t,e[n]))return!0;return!1}function Nv(t,e,n){for(const i of n)for(let s=0,l=i.length,u=l-1;s<l;u=s++)if(Jf(t,e,i[u],i[s]))return!0;return!1}function ry(t,e){for(let n=0;n<t.length;++n)if(!Bl(t[n],e))return!1;for(let n=0;n<t.length-1;++n)if(Nv(t[n],t[n+1],e))return!1;return!0}function Lc(t,e){for(let n=0;n<e.length;n++)if(ry(t,e[n]))return!0;return!1}function iy(t,e,n){const i=[];for(let s=0;s<t.length;s++){const l=[];for(let u=0;u<t[s].length;u++){const h=Fv(t[s][u],n);_d(e,h),l.push(h)}i.push(l)}return i}function jv(t,e,n){const i=[];for(let s=0;s<t.length;s++){const l=iy(t[s],e,n);i.push(l)}return i}function Uv(t,e,n,i){if(t[0]<n[0]||t[0]>n[2]){const s=.5*i;let l=t[0]-n[0]>s?-i:n[0]-t[0]>s?i:0;l===0&&(l=t[0]-n[2]>s?-i:n[2]-t[0]>s?i:0),t[0]+=l}_d(e,t)}function oy(t,e,n,i){const s=Math.pow(2,i.z)*Ha,l=[i.x*Ha,i.y*Ha],u=[];if(!t)return u;for(const h of t)for(const f of h){const m=[f.x+l[0],f.y+l[1]];Uv(m,e,n,s),u.push(m)}return u}function sy(t,e,n,i){const s=Math.pow(2,i.z)*Ha,l=[i.x*Ha,i.y*Ha],u=[];if(!t)return u;for(const f of t){const m=[];for(const y of f){const v=[y.x+l[0],y.y+l[1]];_d(e,v),m.push(v)}u.push(m)}if(e[2]-e[0]<=s/2){(h=e)[0]=h[1]=1/0,h[2]=h[3]=-1/0;for(const f of u)for(const m of f)Uv(m,e,n,s)}var h;return u}class qa{constructor(e,n){this.type=Gn,this.geojson=e,this.geometries=n}static parse(e,n){if(e.length!==2)return n.error(`'within' expression requires exactly one argument, but found ${e.length-1} instead.`);if(kc(e[1])){const i=e[1];if(i.type==="FeatureCollection")for(let s=0;s<i.features.length;++s){const l=i.features[s].geometry.type;if(l==="Polygon"||l==="MultiPolygon")return new qa(i,i.features[s].geometry)}else if(i.type==="Feature"){const s=i.geometry.type;if(s==="Polygon"||s==="MultiPolygon")return new qa(i,i.geometry)}else if(i.type==="Polygon"||i.type==="MultiPolygon")return new qa(i,i)}return n.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return function(n,i){const s=[1/0,1/0,-1/0,-1/0],l=[1/0,1/0,-1/0,-1/0],u=n.canonicalID();if(!u)return!1;if(i.type==="Polygon"){const h=iy(i.coordinates,l,u),f=oy(n.geometry(),s,l,u);if(!vd(s,l))return!1;for(const m of f)if(!Bl(m,h))return!1}if(i.type==="MultiPolygon"){const h=jv(i.coordinates,l,u),f=oy(n.geometry(),s,l,u);if(!vd(s,l))return!1;for(const m of f)if(!Bv(m,h))return!1}return!0}(e,this.geometries);if(e.geometryType()==="LineString")return function(n,i){const s=[1/0,1/0,-1/0,-1/0],l=[1/0,1/0,-1/0,-1/0],u=n.canonicalID();if(!u)return!1;if(i.type==="Polygon"){const h=iy(i.coordinates,l,u),f=sy(n.geometry(),s,l,u);if(!vd(s,l))return!1;for(const m of f)if(!ry(m,h))return!1}if(i.type==="MultiPolygon"){const h=jv(i.coordinates,l,u),f=sy(n.geometry(),s,l,u);if(!vd(s,l))return!1;for(const m of f)if(!Lc(m,h))return!1}return!0}(e,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}var Mu=qa,Vv={exports:{}};Vv.exports=function(){var t={kilometers:1,miles:.621371192237334,nauticalmiles:.5399568034557235,meters:1e3,metres:1e3,yards:1093.6132983377079,feet:3280.839895013123,inches:39370.078740157485},e=1/298.257223563,n=e*(2-e),i=Math.PI/180,s=function(m,y){if(m===void 0)throw new Error("No latitude given.");if(y&&!t[y])throw new Error("Unknown unit "+y+". Use one of: "+Object.keys(t).join(", "));var v=6378.137*i*(y?t[y]:1),w=Math.cos(m*i),S=1/(1-n*(1-w*w)),E=Math.sqrt(S);this.kx=v*E*w,this.ky=v*E*S*(1-n)},l={units:{configurable:!0}};function u(m,y){return m[0]===y[0]&&m[1]===y[1]}function h(m,y,v){var w=f(y[0]-m[0]);return[m[0]+w*v,m[1]+(y[1]-m[1])*v]}function f(m){for(;m<-180;)m+=360;for(;m>180;)m-=360;return m}return s.fromTile=function(m,y,v){var w=Math.PI*(1-2*(m+.5)/Math.pow(2,y)),S=Math.atan(.5*(Math.exp(w)-Math.exp(-w)))/i;return new s(S,v)},l.units.get=function(){return t},s.prototype.distance=function(m,y){var v=f(m[0]-y[0])*this.kx,w=(m[1]-y[1])*this.ky;return Math.sqrt(v*v+w*w)},s.prototype.bearing=function(m,y){var v=f(y[0]-m[0])*this.kx;return Math.atan2(v,(y[1]-m[1])*this.ky)/i},s.prototype.destination=function(m,y,v){var w=v*i;return this.offset(m,Math.sin(w)*y,Math.cos(w)*y)},s.prototype.offset=function(m,y,v){return[m[0]+y/this.kx,m[1]+v/this.ky]},s.prototype.lineDistance=function(m){for(var y=0,v=0;v<m.length-1;v++)y+=this.distance(m[v],m[v+1]);return y},s.prototype.area=function(m){for(var y=0,v=0;v<m.length;v++)for(var w=m[v],S=0,E=w.length,A=E-1;S<E;A=S++)y+=f(w[S][0]-w[A][0])*(w[S][1]+w[A][1])*(v?-1:1);return Math.abs(y)/2*this.kx*this.ky},s.prototype.along=function(m,y){var v=0;if(y<=0)return m[0];for(var w=0;w<m.length-1;w++){var S=m[w],E=m[w+1],A=this.distance(S,E);if((v+=A)>y)return h(S,E,(y-(v-A))/A)}return m[m.length-1]},s.prototype.pointToSegmentDistance=function(m,y,v){var w=y[0],S=y[1],E=f(v[0]-w)*this.kx,A=(v[1]-S)*this.ky,M=0;return E===0&&A===0||((M=(f(m[0]-w)*this.kx*E+(m[1]-S)*this.ky*A)/(E*E+A*A))>1?(w=v[0],S=v[1]):M>0&&(w+=E/this.kx*M,S+=A/this.ky*M)),E=f(m[0]-w)*this.kx,A=(m[1]-S)*this.ky,Math.sqrt(E*E+A*A)},s.prototype.pointOnLine=function(m,y){for(var v,w,S,E,A=1/0,M=0;M<m.length-1;M++){var k=m[M][0],R=m[M][1],L=f(m[M+1][0]-k)*this.kx,z=(m[M+1][1]-R)*this.ky,B=0;L===0&&z===0||((B=(f(y[0]-k)*this.kx*L+(y[1]-R)*this.ky*z)/(L*L+z*z))>1?(k=m[M+1][0],R=m[M+1][1]):B>0&&(k+=L/this.kx*B,R+=z/this.ky*B));var j=(L=f(y[0]-k)*this.kx)*L+(z=(y[1]-R)*this.ky)*z;j<A&&(A=j,v=k,w=R,S=M,E=B)}return{point:[v,w],index:S,t:Math.max(0,Math.min(1,E))}},s.prototype.lineSlice=function(m,y,v){var w=this.pointOnLine(v,m),S=this.pointOnLine(v,y);if(w.index>S.index||w.index===S.index&&w.t>S.t){var E=w;w=S,S=E}var A=[w.point],M=w.index+1,k=S.index;!u(v[M],A[0])&&M<=k&&A.push(v[M]);for(var R=M+1;R<=k;R++)A.push(v[R]);return u(v[k],S.point)||A.push(S.point),A},s.prototype.lineSliceAlong=function(m,y,v){for(var w=0,S=[],E=0;E<v.length-1;E++){var A=v[E],M=v[E+1],k=this.distance(A,M);if((w+=k)>m&&S.length===0&&S.push(h(A,M,(m-(w-k))/k)),w>=y)return S.push(h(A,M,(y-(w-k))/k)),S;w>m&&S.push(M)}return S},s.prototype.bufferPoint=function(m,y){var v=y/this.ky,w=y/this.kx;return[m[0]-w,m[1]-v,m[0]+w,m[1]+v]},s.prototype.bufferBBox=function(m,y){var v=y/this.ky,w=y/this.kx;return[m[0]-w,m[1]-v,m[2]+w,m[3]+v]},s.prototype.insideBBox=function(m,y){return f(m[0]-y[0])>=0&&f(m[0]-y[2])<=0&&m[1]>=y[1]&&m[1]<=y[3]},Object.defineProperties(s,l),s}();var Oc=ee(Vv.exports),$v={exports:{}};$v.exports=function(){var t=function(n,i){if(n===void 0&&(n=[]),i===void 0&&(i=e),this.data=n,this.length=this.data.length,this.compare=i,this.length>0)for(var s=(this.length>>1)-1;s>=0;s--)this._down(s)};function e(n,i){return n<i?-1:n>i?1:0}return t.prototype.push=function(n){this.data.push(n),this.length++,this._up(this.length-1)},t.prototype.pop=function(){if(this.length!==0){var n=this.data[0],i=this.data.pop();return this.length--,this.length>0&&(this.data[0]=i,this._down(0)),n}},t.prototype.peek=function(){return this.data[0]},t.prototype._up=function(n){for(var i=this.data,s=this.compare,l=i[n];n>0;){var u=n-1>>1,h=i[u];if(s(l,h)>=0)break;i[n]=h,n=u}i[n]=l},t.prototype._down=function(n){for(var i=this.data,s=this.compare,l=this.length>>1,u=i[n];n<l;){var h=1+(n<<1),f=i[h],m=h+1;if(m<this.length&&s(i[m],f)<0&&(h=m,f=i[m]),s(f,u)>=0)break;i[n]=f,n=h}i[n]=u},t}();var ep=ee($v.exports),Ge=8192;function tp(t,e){return e.dist-t.dist}const np=100,rp=50;function ay(t){const e=[1/0,1/0,-1/0,-1/0];if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function ip(t){return t[1]-t[0]+1}function Wa(t,e){const n=t[1]>=t[0]&&t[1]<e;return n||console.warn("Distance Expression: Index is out of range"),n}function ly(t,e){if(t[0]>t[1])return[null,null];const n=ip(t);if(e){if(n===2)return[t,null];const i=Math.floor(n/2);return[[t[0],t[0]+i],[t[0]+i,t[1]]]}{if(n===1)return[t,null];const i=Math.floor(n/2)-1;return[[t[0],t[0]+i],[t[0]+i+1,t[1]]]}}function Iu(t,e){const n=[1/0,1/0,-1/0,-1/0];if(!Wa(e,t.length))return n;for(let i=e[0];i<=e[1];++i)_d(n,t[i]);return n}function op(t){const e=[1/0,1/0,-1/0,-1/0];for(let n=0;n<t.length;++n)for(let i=0;i<t[n].length;++i)_d(e,t[n][i]);return e}function mo(t,e,n){if(ay(t)||ay(e))return NaN;let i=0,s=0;return t[2]<e[0]&&(i=e[0]-t[2]),t[0]>e[2]&&(i=t[0]-e[2]),t[1]>e[3]&&(s=t[1]-e[3]),t[3]<e[1]&&(s=e[1]-t[3]),n.distance([0,0],[i,s])}function ku(t,e){const n=Math.pow(2,e.z);return[(s=(t.x/Ge+e.x)/n,360*s-180),(i=(t.y/Ge+e.y)/n,360/Math.PI*Math.atan(Math.exp((180-360*i)*Math.PI/180))-90)];var i,s}function Gv(t,e){const n=[];for(let i=0;i<t.length;++i)n.push(ku(t[i],e));return n}function uy(t,e,n){const i=n.pointOnLine(e,t).point;return n.distance(t,i)}function cy(t,e,n,i,s){const l=n.slice(i[0],i[1]+1);let u=1/0;for(let h=e[0];h<=e[1];++h)if((u=Math.min(u,uy(t[h],l,s)))===0)return 0;return u}function sp(t,e,n,i,s){const l=Math.min(s.pointToSegmentDistance(t,n,i),s.pointToSegmentDistance(e,n,i)),u=Math.min(s.pointToSegmentDistance(n,t,e),s.pointToSegmentDistance(i,t,e));return Math.min(l,u)}function hy(t,e,n,i,s){if(!Wa(e,t.length)||!Wa(i,n.length))return NaN;let l=1/0;for(let u=e[0];u<e[1];++u)for(let h=i[0];h<i[1];++h){if(Jf(t[u],t[u+1],n[h],n[h+1]))return 0;l=Math.min(l,sp(t[u],t[u+1],n[h],n[h+1],s))}return l}function q2(t,e,n,i,s){if(!Wa(e,t.length)||!Wa(i,n.length))return NaN;let l=1/0;for(let u=e[0];u<=e[1];++u)for(let h=i[0];h<=i[1];++h)if((l=Math.min(l,s.distance(t[u],n[h])))===0)return l;return l}function W2(t,e,n){if(Bl(t,e,!0))return 0;let i=1/0;for(const s of e){const l=s.length;if(l<2)return console.warn("Distance Expression: Invalid polygon!"),NaN;if(s[0]!==s[l-1]&&(i=Math.min(i,n.pointToSegmentDistance(t,s[l-1],s[0])))===0||(i=Math.min(i,uy(t,s,n)))===0)return i}return i}function zc(t,e,n,i){if(!Wa(e,t.length))return NaN;for(let l=e[0];l<=e[1];++l)if(Bl(t[l],n,!0))return 0;let s=1/0;for(let l=e[0];l<e[1];++l)for(const u of n)for(let h=0,f=u.length,m=f-1;h<f;m=h++){if(Jf(t[l],t[l+1],u[m],u[h]))return 0;s=Math.min(s,sp(t[l],t[l+1],u[m],u[h],i))}return s}function ap(t,e){for(const n of t)for(let i=0;i<=n.length-1;++i)if(Bl(n[i],e,!0))return!0;return!1}function xd(t,e,n,i=1/0){const s=op(t),l=op(e);if(i!==1/0&&mo(s,l,n)>=i)return i;if(vd(s,l)){if(ap(t,e))return 0}else if(ap(e,t))return 0;let u=i;for(const h of t)for(let f=0,m=h.length,y=m-1;f<m;y=f++)for(const v of e)for(let w=0,S=v.length,E=S-1;w<S;E=w++){if(Jf(h[y],h[f],v[E],v[w]))return 0;u=Math.min(u,sp(h[y],h[f],v[E],v[w],n))}return u}function Fc(t,e,n,i,s,l,u){if(l===null||u===null)return;const h=mo(Iu(i,l),Iu(s,u),n);h<e&&t.push({dist:h,range1:l,range2:u})}function Hv(t,e,n,i,s=1/0){let l=Math.min(i.distance(t[0],n[0][0]),s);if(l===0)return l;const u=new ep([{dist:0,range1:[0,t.length-1],range2:[0,0]}],tp),h=e?rp:np,f=op(n);for(;u.length;){const m=u.pop();if(m.dist>=l)continue;const y=m.range1;if(ip(y)<=h){if(!Wa(y,t.length))return NaN;if(e){const v=zc(t,y,n,i);if((l=Math.min(l,v))===0)return l}else for(let v=y[0];v<=y[1];++v){const w=W2(t[v],n,i);if((l=Math.min(l,w))===0)return l}}else{const v=ly(y,e);if(v[0]!==null){const w=mo(Iu(t,v[0]),f,i);w<l&&u.push({dist:w,range1:v[0],range2:[0,0]})}if(v[1]!==null){const w=mo(Iu(t,v[1]),f,i);w<l&&u.push({dist:w,range1:v[1],range2:[0,0]})}}}return l}function wd(t,e,n,i,s,l=1/0){let u=Math.min(l,s.distance(t[0],n[0]));if(u===0)return u;const h=new ep([{dist:0,range1:[0,t.length-1],range2:[0,n.length-1]}],tp),f=e?rp:np,m=i?rp:np;for(;h.length;){const y=h.pop();if(y.dist>=u)continue;const v=y.range1,w=y.range2;if(ip(v)<=f&&ip(w)<=m){if(!Wa(v,t.length)||!Wa(w,n.length))return NaN;if(e&&i?u=Math.min(u,hy(t,v,n,w,s)):e||i?e&&!i?u=Math.min(u,cy(n,w,t,v,s)):!e&&i&&(u=Math.min(u,cy(t,v,n,w,s))):u=Math.min(u,q2(t,v,n,w,s)),u===0)return u}else{const S=ly(v,e),E=ly(w,i);Fc(h,u,s,t,n,S[0],E[0]),Fc(h,u,s,t,n,S[0],E[1]),Fc(h,u,s,t,n,S[1],E[0]),Fc(h,u,s,t,n,S[1],E[1])}}return u}function Nl(t,e,n,i,s=1/0){let l=s;const u=Iu(t,[0,t.length-1]);for(const h of n)if(!(l!==1/0&&mo(u,Iu(h,[0,h.length-1]),i)>=l)&&(l=Math.min(l,wd(t,e,h,!0,i,l)),l===0))return l;return l}function Bc(t,e,n,i,s=1/0){let l=s;const u=Iu(t,[0,t.length-1]);for(const h of n){if(l!==1/0&&mo(u,op(h),i)>=l)continue;const f=Hv(t,e,h,i,l);if(isNaN(f))return f;if((l=Math.min(l,f))===0)return l}return l}function lp(t){return t==="Point"||t==="MultiPoint"||t==="LineString"||t==="MultiLineString"||t==="Polygon"||t==="MultiPolygon"}class jl{constructor(e,n){this.type=It,this.geojson=e,this.geometries=n}static parse(e,n){if(e.length!==2)return n.error(`'distance' expression requires either one argument, but found ' ${e.length-1} instead.`);if(kc(e[1])){const i=e[1];if(i.type==="FeatureCollection"){for(let s=0;s<i.features.length;++s)if(lp(i.features[s].geometry.type))return new jl(i,i.features[s].geometry)}else if(i.type==="Feature"){if(lp(i.geometry.type))return new jl(i,i.geometry)}else if(lp(i.type))return new jl(i,i)}return n.error("'distance' expression needs to be an array with format ['Distance', GeoJSONObj].")}evaluate(e){const n=e.geometry(),i=e.canonicalID();if(n!=null&&i!=null){if(e.geometryType()==="Point")return function(s,l,u){const h=[];for(const m of s)for(const y of m)h.push(ku(y,l));const f=new Oc(h[0][1],"meters");return u.type==="Point"||u.type==="MultiPoint"||u.type==="LineString"?wd(h,!1,u.type==="Point"?[u.coordinates]:u.coordinates,u.type==="LineString",f):u.type==="MultiLineString"?Nl(h,!1,u.coordinates,f):u.type==="Polygon"||u.type==="MultiPolygon"?Bc(h,!1,u.type==="Polygon"?[u.coordinates]:u.coordinates,f):null}(n,i,this.geometries);if(e.geometryType()==="LineString")return function(s,l,u){const h=[];for(const m of s){const y=[];for(const v of m)y.push(ku(v,l));h.push(y)}const f=new Oc(h[0][0][1],"meters");if(u.type==="Point"||u.type==="MultiPoint"||u.type==="LineString")return Nl(u.type==="Point"?[u.coordinates]:u.coordinates,u.type==="LineString",h,f);if(u.type==="MultiLineString"){let m=1/0;for(let y=0;y<u.coordinates.length;y++){const v=Nl(u.coordinates[y],!0,h,f,m);if(isNaN(v))return v;if((m=Math.min(m,v))===0)return m}return m}if(u.type==="Polygon"||u.type==="MultiPolygon"){let m=1/0;for(let y=0;y<h.length;y++){const v=Bc(h[y],!0,u.type==="Polygon"?[u.coordinates]:u.coordinates,f,m);if(isNaN(v))return v;if((m=Math.min(m,v))===0)return m}return m}return null}(n,i,this.geometries);if(e.geometryType()==="Polygon")return function(s,l,u){const h=[];for(const m of function(y,v){const w=y.length;if(w<=1)return[y];const S=[];let E,A;for(let M=0;M<w;M++){const k=G2(y[M]);k!==0&&(y[M].area=Math.abs(k),A===void 0&&(A=k<0),A===k<0?(E&&S.push(E),E=[y[M]]):E.push(y[M]))}return E&&S.push(E),S}(s)){const y=[];for(let v=0;v<m.length;++v)y.push(Gv(m[v],l));h.push(y)}const f=new Oc(h[0][0][0][1],"meters");if(u.type==="Point"||u.type==="MultiPoint"||u.type==="LineString")return Bc(u.type==="Point"?[u.coordinates]:u.coordinates,u.type==="LineString",h,f);if(u.type==="MultiLineString"){let m=1/0;for(let y=0;y<u.coordinates.length;y++){const v=Bc(u.coordinates[y],!0,h,f,m);if(isNaN(v))return v;if((m=Math.min(m,v))===0)return m}return m}return u.type==="Polygon"||u.type==="MultiPolygon"?function(m,y,v){let w=1/0;for(const S of m)for(const E of y){const A=xd(S,E,v,w);if(isNaN(A))return A;if((w=Math.min(w,A))===0)return w}return w}(u.type==="Polygon"?[u.coordinates]:u.coordinates,h,f):null}(n,i,this.geometries);console.warn("Distance Expression: currently only evaluates valid Point/LineString/Polygon geometries.")}else console.warn("Distance Expression: requirs valid feature and canonical information.");return null}eachChild(){}outputDefined(){return!0}serialize(){return["distance",this.geojson]}}var up=jl;function Nc(t){if(t instanceof Ws&&(t.name==="get"&&t.args.length===1||t.name==="feature-state"||t.name==="has"&&t.args.length===1||t.name==="properties"||t.name==="geometry-type"||t.name==="id"||/^filter-/.test(t.name))||t instanceof Mu||t instanceof up)return!1;let e=!0;return t.eachChild(n=>{e&&!Nc(n)&&(e=!1)}),e}function bd(t){if(t instanceof Ws&&t.name==="feature-state")return!1;let e=!0;return t.eachChild(n=>{e&&!bd(n)&&(e=!1)}),e}function cp(t){if(t instanceof Ws&&t.name==="config")return!1;let e=!0;return t.eachChild(n=>{e&&!cp(n)&&(e=!1)}),e}function Ul(t,e){if(t instanceof Ws&&e.indexOf(t.name)>=0)return!1;let n=!0;return t.eachChild(i=>{n&&!Ul(i,e)&&(n=!1)}),n}class hp{constructor(e,n){this.type=n.type,this.name=e,this.boundExpression=n}static parse(e,n){if(e.length!==2||typeof e[1]!="string")return n.error("'var' expression requires exactly one string literal argument.");const i=e[1];return n.scope.has(i)?new hp(i,n.scope.get(i)):n.error(`Unknown variable "${i}". Make sure "${i}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(e){return this.boundExpression.evaluate(e)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}var Za=hp;class Sd{constructor(e,n=[],i,s=new Kf,l=[],u){this.registry=e,this.path=n,this.key=n.map(h=>`[${h}]`).join(""),this.scope=s,this.errors=l,this.expectedType=i,this.options=u}parse(e,n,i,s,l={}){return n||i?this.concat(n,i,s)._parse(e,l):this._parse(e,l)}_parse(e,n){function i(s,l,u){return u==="assert"?new $a(l,[s]):u==="coerce"?new Ga(l,[s]):s}if(e!==null&&typeof e!="string"&&typeof e!="boolean"&&typeof e!="number"||(e=["literal",e]),Array.isArray(e)){if(e.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const s=typeof e[0]=="string"?this.registry[e[0]]:void 0;if(s){let l=s.parse(e,this);if(!l)return null;if(this.expectedType){const u=this.expectedType,h=l.type;if(u.kind!=="string"&&u.kind!=="number"&&u.kind!=="boolean"&&u.kind!=="object"&&u.kind!=="array"||h.kind!=="value")if(u.kind!=="color"&&u.kind!=="formatted"&&u.kind!=="resolvedImage"||h.kind!=="value"&&h.kind!=="string"){if(this.checkSubtype(u,h))return null}else l=i(l,u,n.typeAnnotation||"coerce");else l=i(l,u,n.typeAnnotation||"assert")}if(!(l instanceof gd)&&l.type.kind!=="resolvedImage"&&dy(l)){const u=new Ov(this.options);try{l=new gd(l.type,l.evaluate(u))}catch(h){return this.error(h.message),null}}return l}return Ga.parse(["to-array",e],this)}return this.error(e===void 0?"'undefined' value invalid. Use null instead.":typeof e=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof e} instead.`)}concat(e,n,i){const s=typeof e=="number"?this.path.concat(e):this.path,l=i?this.scope.concat(i):this.scope;return new Sd(this.registry,s,n||null,l,this.errors,this.options)}error(e,...n){const i=`${this.key}${n.map(s=>`[${s}]`).join("")}`;this.errors.push(new la(i,e))}checkSubtype(e,n){const i=Au(e,n);return i&&this.error(i),i}}var dp=Sd;function dy(t){if(t instanceof Za)return dy(t.boundExpression);if(t instanceof Ws&&t.name==="error"||t instanceof Ws&&t.name==="config"||t instanceof Qf||t instanceof Mu||t instanceof up)return!1;const e=t instanceof Ga||t instanceof $a;let n=!0;return t.eachChild(i=>{n=e?n&&dy(i):n&&i instanceof gd}),!!n&&Nc(t)&&Ul(t,["zoom","heatmap-density","line-progress","raster-value","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center","measure-light"])}function fp(t,e){const n=t.length-1;let i,s,l=0,u=n,h=0;for(;l<=u;)if(h=Math.floor((l+u)/2),i=t[h],s=t[h+1],i<=e){if(h===n||e<s)return h;l=h+1}else{if(!(i>e))throw new Ni("Input is not a number.");u=h-1}return 0}class Pu{constructor(e,n,i){this.type=e,this.input=n,this.labels=[],this.outputs=[];for(const[s,l]of i)this.labels.push(s),this.outputs.push(l)}static parse(e,n){if(e.length-1<4)return n.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return n.error("Expected an even number of arguments.");const i=n.parse(e[1],1,It);if(!i)return null;const s=[];let l=null;n.expectedType&&n.expectedType.kind!=="value"&&(l=n.expectedType);for(let u=1;u<e.length;u+=2){const h=u===1?-1/0:e[u],f=e[u+1],m=u,y=u+1;if(typeof h!="number")return n.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',m);if(s.length&&s[s.length-1][0]>=h)return n.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',m);const v=n.parse(f,y,l);if(!v)return null;l=l||v.type,s.push([h,v])}return new Pu(l,i,s)}evaluate(e){const n=this.labels,i=this.outputs;if(n.length===1)return i[0].evaluate(e);const s=this.input.evaluate(e);if(s<=n[0])return i[0].evaluate(e);const l=n.length;return s>=n[l-1]?i[l-1].evaluate(e):i[fp(n,s)].evaluate(e)}eachChild(e){e(this.input);for(const n of this.outputs)e(n)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}serialize(){const e=["step",this.input.serialize()];for(let n=0;n<this.labels.length;n++)n>0&&e.push(this.labels[n]),e.push(this.outputs[n].serialize());return e}}var fy=Pu;function nn(t,e,n){return t*(1-n)+e*n}var Ed=Object.freeze({__proto__:null,array:function(t,e,n){return t.map((i,s)=>nn(i,e[s],n))},color:function(t,e,n){return new wn(nn(t.r,e.r,n),nn(t.g,e.g,n),nn(t.b,e.b,n),nn(t.a,e.a,n))},number:nn});const Jr=.95047,pp=1.08883,Td=4/29,ua=6/29,py=3*ua*ua,my=ua*ua*ua,Cd=Math.PI/180,mp=180/Math.PI;function Vl(t){return t>my?Math.pow(t,1/3):t/py+Td}function gp(t){return t>ua?t*t*t:py*(t-Td)}function gy(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function yy(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function _y(t){const e=yy(t.r),n=yy(t.g),i=yy(t.b),s=Vl((.4124564*e+.3575761*n+.1804375*i)/Jr),l=Vl((.2126729*e+.7151522*n+.072175*i)/1);return{l:116*l-16,a:500*(s-l),b:200*(l-Vl((.0193339*e+.119192*n+.9503041*i)/pp)),alpha:t.a}}function Ad(t){let e=(t.l+16)/116,n=isNaN(t.a)?e:e+t.a/500,i=isNaN(t.b)?e:e-t.b/200;return e=1*gp(e),n=Jr*gp(n),i=pp*gp(i),new wn(gy(3.2404542*n-1.5371385*e-.4985314*i),gy(-.969266*n+1.8760108*e+.041556*i),gy(.0556434*n-.2040259*e+1.0572252*i),t.alpha)}function yp(t,e,n){const i=e-t;return t+n*(i>180||i<-180?i-360*Math.round(i/360):i)}const Ru={forward:_y,reverse:Ad,interpolate:function(t,e,n){return{l:nn(t.l,e.l,n),a:nn(t.a,e.a,n),b:nn(t.b,e.b,n),alpha:nn(t.alpha,e.alpha,n)}}},Du={forward:function(t){const{l:e,a:n,b:i}=_y(t),s=Math.atan2(i,n)*mp;return{h:s<0?s+360:s,c:Math.sqrt(n*n+i*i),l:e,alpha:t.a}},reverse:function(t){const e=t.h*Cd,n=t.c;return Ad({l:t.l,a:Math.cos(e)*n,b:Math.sin(e)*n,alpha:t.alpha})},interpolate:function(t,e,n){return{h:yp(t.h,e.h,n),c:nn(t.c,e.c,n),l:nn(t.l,e.l,n),alpha:nn(t.alpha,e.alpha,n)}}};var _p=Object.freeze({__proto__:null,hcl:Du,lab:Ru});class jc{constructor(e,n,i,s,l){this.type=e,this.operator=n,this.interpolation=i,this.input=s,this.labels=[],this.outputs=[];for(const[u,h]of l)this.labels.push(u),this.outputs.push(h)}static interpolationFactor(e,n,i,s){let l=0;if(e.name==="exponential")l=vy(n,e.base,i,s);else if(e.name==="linear")l=vy(n,1,i,s);else if(e.name==="cubic-bezier"){const u=e.controlPoints;l=new de(u[0],u[1],u[2],u[3]).solve(vy(n,1,i,s))}return l}static parse(e,n){let[i,s,l,...u]=e;if(!Array.isArray(s)||s.length===0)return n.error("Expected an interpolation type expression.",1);if(s[0]==="linear")s={name:"linear"};else if(s[0]==="exponential"){const m=s[1];if(typeof m!="number")return n.error("Exponential interpolation requires a numeric base.",1,1);s={name:"exponential",base:m}}else{if(s[0]!=="cubic-bezier")return n.error(`Unknown interpolation type ${String(s[0])}`,1,0);{const m=s.slice(1);if(m.length!==4||m.some(y=>typeof y!="number"||y<0||y>1))return n.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);s={name:"cubic-bezier",controlPoints:m}}}if(e.length-1<4)return n.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return n.error("Expected an even number of arguments.");if(l=n.parse(l,2,It),!l)return null;const h=[];let f=null;i==="interpolate-hcl"||i==="interpolate-lab"?f=lo:n.expectedType&&n.expectedType.kind!=="value"&&(f=n.expectedType);for(let m=0;m<u.length;m+=2){const y=u[m],v=u[m+1],w=m+3,S=m+4;if(typeof y!="number")return n.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',w);if(h.length&&h[h.length-1][0]>=y)return n.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',w);const E=n.parse(v,S,f);if(!E)return null;f=f||E.type,h.push([y,E])}return f.kind==="number"||f.kind==="color"||f.kind==="array"&&f.itemType.kind==="number"&&typeof f.N=="number"?new jc(f,i,s,l,h):n.error(`Type ${si(f)} is not interpolatable.`)}evaluate(e){const n=this.labels,i=this.outputs;if(n.length===1)return i[0].evaluate(e);const s=this.input.evaluate(e);if(s<=n[0])return i[0].evaluate(e);const l=n.length;if(s>=n[l-1])return i[l-1].evaluate(e);const u=fp(n,s),h=jc.interpolationFactor(this.interpolation,s,n[u],n[u+1]),f=i[u].evaluate(e),m=i[u+1].evaluate(e);return this.operator==="interpolate"?Ed[this.type.kind.toLowerCase()](f,m,h):this.operator==="interpolate-hcl"?Du.reverse(Du.interpolate(Du.forward(f),Du.forward(m),h)):Ru.reverse(Ru.interpolate(Ru.forward(f),Ru.forward(m),h))}eachChild(e){e(this.input);for(const n of this.outputs)e(n)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}serialize(){let e;e=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const n=[this.operator,e,this.input.serialize()];for(let i=0;i<this.labels.length;i++)n.push(this.labels[i],this.outputs[i].serialize());return n}}function vy(t,e,n,i){const s=i-n,l=t-n;return s===0?0:e===1?l/s:(Math.pow(e,l)-1)/(Math.pow(e,s)-1)}var Zs=jc;class xy{constructor(e,n){this.type=e,this.args=n}static parse(e,n){if(e.length<2)return n.error("Expectected at least one argument.");let i=null;const s=n.expectedType;s&&s.kind!=="value"&&(i=s);const l=[];for(const h of e.slice(1)){const f=n.parse(h,1+l.length,i,void 0,{typeAnnotation:"omit"});if(!f)return null;i=i||f.type,l.push(f)}const u=s&&l.some(h=>Au(s,h.type));return new xy(u?Zn:i,l)}evaluate(e){let n,i=null,s=0;for(const l of this.args){if(s++,i=l.evaluate(e),i&&i instanceof Do&&!i.available&&(n||(n=i),i=null,s===this.args.length))return n;if(i!==null)break}return i}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){const e=["coalesce"];return this.eachChild(n=>{e.push(n.serialize())}),e}}var qv=xy;class Md{constructor(e,n){this.type=n.type,this.bindings=[].concat(e),this.result=n}evaluate(e){return this.result.evaluate(e)}eachChild(e){for(const n of this.bindings)e(n[1]);e(this.result)}static parse(e,n){if(e.length<4)return n.error(`Expected at least 3 arguments, but found ${e.length-1} instead.`);const i=[];for(let l=1;l<e.length-1;l+=2){const u=e[l];if(typeof u!="string")return n.error(`Expected string, but found ${typeof u} instead.`,l);if(/[^a-zA-Z0-9_]/.test(u))return n.error("Variable names must contain only alphanumeric characters or '_'.",l);const h=n.parse(e[l+1],l+1);if(!h)return null;i.push([u,h])}const s=n.parse(e[e.length-1],e.length-1,n.expectedType,i);return s?new Md(i,s):null}outputDefined(){return this.result.outputDefined()}serialize(){const e=["let"];for(const[n,i]of this.bindings)e.push(n,i.serialize());return e.push(this.result.serialize()),e}}var Xa=Md;class vp{constructor(e,n,i){this.type=e,this.index=n,this.input=i}static parse(e,n){if(e.length!==3)return n.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const i=n.parse(e[1],1,It),s=n.parse(e[2],2,po(n.expectedType||Zn));return i&&s?new vp(s.type.itemType,i,s):null}evaluate(e){const n=this.index.evaluate(e),i=this.input.evaluate(e);if(n<0)throw new Ni(`Array index out of bounds: ${n} < 0.`);if(n>=i.length)throw new Ni(`Array index out of bounds: ${n} > ${i.length-1}.`);if(n!==Math.floor(n))throw new Ni(`Array index must be an integer, but found ${n} instead.`);return i[n]}eachChild(e){e(this.index),e(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}var Uc=vp;class Ts{constructor(e,n){this.type=Gn,this.needle=e,this.haystack=n}static parse(e,n){if(e.length!==3)return n.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const i=n.parse(e[1],1,Zn),s=n.parse(e[2],2,Zn);return i&&s?Ac(i.type,[Gn,Bn,It,Tu,Zn])?new Ts(i,s):n.error(`Expected first argument to be of type boolean, string, number or null, but found ${si(i.type)} instead`):null}evaluate(e){const n=this.needle.evaluate(e),i=this.haystack.evaluate(e);if(i==null)return!1;if(!Mc(n,["boolean","string","number","null"]))throw new Ni(`Expected first argument to be of type boolean, string, number or null, but found ${si(Pi(n))} instead.`);if(!Mc(i,["string","array"]))throw new Ni(`Expected second argument to be of type array or string, but found ${si(Pi(i))} instead.`);return i.indexOf(n)>=0}eachChild(e){e(this.needle),e(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}var Id=Ts;class Cs{constructor(e,n,i){this.type=It,this.needle=e,this.haystack=n,this.fromIndex=i}static parse(e,n){if(e.length<=2||e.length>=5)return n.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const i=n.parse(e[1],1,Zn),s=n.parse(e[2],2,Zn);if(!i||!s)return null;if(!Ac(i.type,[Gn,Bn,It,Tu,Zn]))return n.error(`Expected first argument to be of type boolean, string, number or null, but found ${si(i.type)} instead`);if(e.length===4){const l=n.parse(e[3],3,It);return l?new Cs(i,s,l):null}return new Cs(i,s)}evaluate(e){const n=this.needle.evaluate(e),i=this.haystack.evaluate(e);if(!Mc(n,["boolean","string","number","null"]))throw new Ni(`Expected first argument to be of type boolean, string, number or null, but found ${si(Pi(n))} instead.`);if(!Mc(i,["string","array"]))throw new Ni(`Expected second argument to be of type array or string, but found ${si(Pi(i))} instead.`);if(this.fromIndex){const s=this.fromIndex.evaluate(e);return i.indexOf(n,s)}return i.indexOf(n)}eachChild(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)}outputDefined(){return!1}serialize(){if(this.fromIndex!=null&&this.fromIndex!==void 0){const e=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),e]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}var wy=Cs;class by{constructor(e,n,i,s,l,u){this.inputType=e,this.type=n,this.input=i,this.cases=s,this.outputs=l,this.otherwise=u}static parse(e,n){if(e.length<5)return n.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if(e.length%2!=1)return n.error("Expected an even number of arguments.");let i,s;n.expectedType&&n.expectedType.kind!=="value"&&(s=n.expectedType);const l={},u=[];for(let m=2;m<e.length-1;m+=2){let y=e[m];const v=e[m+1];Array.isArray(y)||(y=[y]);const w=n.concat(m);if(y.length===0)return w.error("Expected at least one branch label.");for(const E of y){if(typeof E!="number"&&typeof E!="string")return w.error("Branch labels must be numbers or strings.");if(typeof E=="number"&&Math.abs(E)>Number.MAX_SAFE_INTEGER)return w.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof E=="number"&&Math.floor(E)!==E)return w.error("Numeric branch labels must be integer values.");if(i){if(w.checkSubtype(i,Pi(E)))return null}else i=Pi(E);if(l[String(E)]!==void 0)return w.error("Branch labels must be unique.");l[String(E)]=u.length}const S=n.parse(v,m,s);if(!S)return null;s=s||S.type,u.push(S)}const h=n.parse(e[1],1,Zn);if(!h)return null;const f=n.parse(e[e.length-1],e.length-1,s);return f?h.type.kind!=="value"&&n.concat(1).checkSubtype(i,h.type)?null:new by(i,s,h,l,u,f):null}evaluate(e){const n=this.input.evaluate(e);return(Pi(n)===this.inputType&&this.outputs[this.cases[n]]||this.otherwise).evaluate(e)}eachChild(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)}outputDefined(){return this.outputs.every(e=>e.outputDefined())&&this.otherwise.outputDefined()}serialize(){const e=["match",this.input.serialize()],n=Object.keys(this.cases).sort(),i=[],s={};for(const u of n){const h=s[this.cases[u]];h===void 0?(s[this.cases[u]]=i.length,i.push([this.cases[u],[u]])):i[h][1].push(u)}const l=u=>this.inputType.kind==="number"?Number(u):u;for(const[u,h]of i)e.push(h.length===1?l(h[0]):h.map(l)),e.push(this.outputs[u].serialize());return e.push(this.otherwise.serialize()),e}}var Z2=by;class Ka{constructor(e,n,i){this.type=e,this.branches=n,this.otherwise=i}static parse(e,n){if(e.length<4)return n.error(`Expected at least 3 arguments, but found only ${e.length-1}.`);if(e.length%2!=0)return n.error("Expected an odd number of arguments.");let i;n.expectedType&&n.expectedType.kind!=="value"&&(i=n.expectedType);const s=[];for(let u=1;u<e.length-1;u+=2){const h=n.parse(e[u],u,Gn);if(!h)return null;const f=n.parse(e[u+1],u+1,i);if(!f)return null;s.push([h,f]),i=i||f.type}const l=n.parse(e[e.length-1],e.length-1,i);return l?new Ka(i,s,l):null}evaluate(e){for(const[n,i]of this.branches)if(n.evaluate(e))return i.evaluate(e);return this.otherwise.evaluate(e)}eachChild(e){for(const[n,i]of this.branches)e(n),e(i);e(this.otherwise)}outputDefined(){return this.branches.every(([e,n])=>n.outputDefined())&&this.otherwise.outputDefined()}serialize(){const e=["case"];return this.eachChild(n=>{e.push(n.serialize())}),e}}var kd=Ka;class Ya{constructor(e,n,i,s){this.type=e,this.input=n,this.beginIndex=i,this.endIndex=s}static parse(e,n){if(e.length<=2||e.length>=5)return n.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const i=n.parse(e[1],1,Zn),s=n.parse(e[2],2,It);if(!i||!s)return null;if(!Ac(i.type,[po(Zn),Bn,Zn]))return n.error(`Expected first argument to be of type array or string, but found ${si(i.type)} instead`);if(e.length===4){const l=n.parse(e[3],3,It);return l?new Ya(i.type,i,s,l):null}return new Ya(i.type,i,s)}evaluate(e){const n=this.input.evaluate(e),i=this.beginIndex.evaluate(e);if(!Mc(n,["string","array"]))throw new Ni(`Expected first argument to be of type array or string, but found ${si(Pi(n))} instead.`);if(this.endIndex){const s=this.endIndex.evaluate(e);return n.slice(i,s)}return n.slice(i)}eachChild(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)}outputDefined(){return!1}serialize(){if(this.endIndex!=null&&this.endIndex!==void 0){const e=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),e]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}var xp=Ya;function wp(t,e){return t==="=="||t==="!="?e.kind==="boolean"||e.kind==="string"||e.kind==="number"||e.kind==="null"||e.kind==="value":e.kind==="string"||e.kind==="number"||e.kind==="value"}function Lu(t,e,n,i){return i.compare(e,n)===0}function ss(t,e,n){const i=t!=="=="&&t!=="!=";return class MB{constructor(l,u,h){this.type=Gn,this.lhs=l,this.rhs=u,this.collator=h,this.hasUntypedArgument=l.type.kind==="value"||u.type.kind==="value"}static parse(l,u){if(l.length!==3&&l.length!==4)return u.error("Expected two or three arguments.");const h=l[0];let f=u.parse(l[1],1,Zn);if(!f)return null;if(!wp(h,f.type))return u.concat(1).error(`"${h}" comparisons are not supported for type '${si(f.type)}'.`);let m=u.parse(l[2],2,Zn);if(!m)return null;if(!wp(h,m.type))return u.concat(2).error(`"${h}" comparisons are not supported for type '${si(m.type)}'.`);if(f.type.kind!==m.type.kind&&f.type.kind!=="value"&&m.type.kind!=="value")return u.error(`Cannot compare types '${si(f.type)}' and '${si(m.type)}'.`);i&&(f.type.kind==="value"&&m.type.kind!=="value"?f=new $a(m.type,[f]):f.type.kind!=="value"&&m.type.kind==="value"&&(m=new $a(f.type,[m])));let y=null;if(l.length===4){if(f.type.kind!=="string"&&m.type.kind!=="string"&&f.type.kind!=="value"&&m.type.kind!=="value")return u.error("Cannot use collator to compare non-string types.");if(y=u.parse(l[3],3,Yf),!y)return null}return new MB(f,m,y)}evaluate(l){const u=this.lhs.evaluate(l),h=this.rhs.evaluate(l);if(i&&this.hasUntypedArgument){const f=Pi(u),m=Pi(h);if(f.kind!==m.kind||f.kind!=="string"&&f.kind!=="number")throw new Ni(`Expected arguments for "${t}" to be (string, string) or (number, number), but found (${f.kind}, ${m.kind}) instead.`)}if(this.collator&&!i&&this.hasUntypedArgument){const f=Pi(u),m=Pi(h);if(f.kind!=="string"||m.kind!=="string")return e(l,u,h)}return this.collator?n(l,u,h,this.collator.evaluate(l)):e(l,u,h)}eachChild(l){l(this.lhs),l(this.rhs),this.collator&&l(this.collator)}outputDefined(){return!0}serialize(){const l=[t];return this.eachChild(u=>{l.push(u.serialize())}),l}}}const ai=ss("==",function(t,e,n){return e===n},Lu),ei=ss("!=",function(t,e,n){return e!==n},function(t,e,n,i){return!Lu(0,e,n,i)}),$l=ss("<",function(t,e,n){return e<n},function(t,e,n,i){return i.compare(e,n)<0}),go=ss(">",function(t,e,n){return e>n},function(t,e,n,i){return i.compare(e,n)>0}),qo=ss("<=",function(t,e,n){return e<=n},function(t,e,n,i){return i.compare(e,n)<=0}),Ou=ss(">=",function(t,e,n){return e>=n},function(t,e,n,i){return i.compare(e,n)>=0});class Gl{constructor(e,n,i,s,l,u){this.type=Bn,this.number=e,this.locale=n,this.currency=i,this.unit=s,this.minFractionDigits=l,this.maxFractionDigits=u}static parse(e,n){if(e.length!==3)return n.error("Expected two arguments.");const i=n.parse(e[1],1,It);if(!i)return null;const s=e[2];if(typeof s!="object"||Array.isArray(s))return n.error("NumberFormat options argument must be an object.");let l=null;if(s.locale&&(l=n.parse(s.locale,1,Bn),!l))return null;let u=null;if(s.currency&&(u=n.parse(s.currency,1,Bn),!u))return null;let h=null;if(s.unit&&(h=n.parse(s.unit,1,Bn),!h))return null;let f=null;if(s["min-fraction-digits"]&&(f=n.parse(s["min-fraction-digits"],1,It),!f))return null;let m=null;return s["max-fraction-digits"]&&(m=n.parse(s["max-fraction-digits"],1,It),!m)?null:new Gl(i,l,u,h,f,m)}evaluate(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(e):void 0,unit:this.unit?this.unit.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))}eachChild(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.unit&&e(this.unit),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const e={};return this.locale&&(e.locale=this.locale.serialize()),this.currency&&(e.currency=this.currency.serialize()),this.unit&&(e.unit=this.unit.serialize()),this.minFractionDigits&&(e["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(e["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),e]}}class yo{constructor(e){this.type=It,this.input=e}static parse(e,n){if(e.length!==2)return n.error(`Expected 1 argument, but found ${e.length-1} instead.`);const i=n.parse(e[1],1);return i?i.type.kind!=="array"&&i.type.kind!=="string"&&i.type.kind!=="value"?n.error(`Expected argument of type string or array, but found ${si(i.type)} instead.`):new yo(i):null}evaluate(e){const n=this.input.evaluate(e);if(typeof n=="string"||Array.isArray(n))return n.length;throw new Ni(`Expected value to be of type string or array, but found ${si(Pi(n))} instead.`)}eachChild(e){e(this.input)}outputDefined(){return!1}serialize(){const e=["length"];return this.eachChild(n=>{e.push(n.serialize())}),e}}function Vc(t){return function(){t=1831565813+(t|=0)|0;let e=Math.imul(t^t>>>15,1|t);return e=e+Math.imul(e^e>>>7,61|e)^e,((e^e>>>14)>>>0)/4294967296}}const Sy={"==":ai,"!=":ei,">":go,"<":$l,">=":Ou,"<=":qo,array:$a,at:Uc,boolean:$a,case:kd,coalesce:qv,collator:Qf,format:Pc,image:yd,in:Id,"index-of":wy,interpolate:Zs,"interpolate-hcl":Zs,"interpolate-lab":Zs,length:yo,let:Xa,literal:gd,match:Z2,number:$a,"number-format":Gl,object:$a,slice:xp,step:fy,string:$a,"to-boolean":Ga,"to-color":Ga,"to-number":Ga,"to-string":Ga,var:Za,within:Mu,distance:up};function Ey(t,[e,n,i,s]){e=e.evaluate(t),n=n.evaluate(t),i=i.evaluate(t);const l=s?s.evaluate(t):1,u=Jg(e,n,i,l);if(u)throw new Ni(u);return new wn(e/255*l,n/255*l,i/255*l,l)}function Pd(t,[e,n,i,s]){e=e.evaluate(t),n=n.evaluate(t),i=i.evaluate(t);const l=s?s.evaluate(t):1,u=function(m,y,v,w){return typeof m=="number"&&m>=0&&m<=360?typeof y=="number"&&y>=0&&y<=100&&typeof v=="number"&&v>=0&&v<=100?w===void 0||typeof w=="number"&&w>=0&&w<=1?null:`Invalid hsla value [${[m,y,v,w].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid hsla value [${(typeof w=="number"?[m,y,v,w]:[m,y,v]).join(", ")}]: 's', and 'l' must be between 0 and 100.`:`Invalid hsla value [${(typeof w=="number"?[m,y,v,w]:[m,y,v]).join(", ")}]: 'h' must be between 0 and 360.`}(e,n,i,l);if(u)throw new Ni(u);const h=`hsla(${e}, ${n}%, ${i}%, ${l})`,f=wn.parse(h);if(!f)throw new Ni(`Failed to parse HSLA color: ${h}`);return f}function Ty(t,e){return t in e}function Xs(t,e){const n=e[t];return n===void 0?null:n}function Rd(t,e,n){n.length&&(e+=`${n}`);const i=t.getConfig(e);return i?i.evaluate(t):null}function Qa(t){return{type:t}}Ws.register(Sy,{error:[{kind:"error"},[Bn],(t,[e])=>{throw new Ni(e.evaluate(t))}],typeof:[Bn,[Zn],(t,[e])=>si(Pi(e.evaluate(t)))],"to-rgba":[po(It,4),[lo],(t,[e])=>e.evaluate(t).toArray()],rgb:[lo,[It,It,It],Ey],rgba:[lo,[It,It,It,It],Ey],hsl:[lo,[It,It,It],Pd],hsla:[lo,[It,It,It,It],Pd],has:{type:Gn,overloads:[[[Bn],(t,[e])=>Ty(e.evaluate(t),t.properties())],[[Bn,Ua],(t,[e,n])=>Ty(e.evaluate(t),n.evaluate(t))]]},get:{type:Zn,overloads:[[[Bn],(t,[e])=>Xs(e.evaluate(t),t.properties())],[[Bn,Ua],(t,[e,n])=>Xs(e.evaluate(t),n.evaluate(t))]]},config:{type:Zn,overloads:[[[Bn],(t,[e])=>Rd(t,e.evaluate(t),"")],[[Bn,Bn],(t,[e,n])=>Rd(t,e.evaluate(t),n.evaluate(t))]]},"feature-state":[Zn,[Bn],(t,[e])=>Xs(e.evaluate(t),t.featureState||{})],properties:[Ua,[],t=>t.properties()],"geometry-type":[Bn,[],t=>t.geometryType()],id:[Zn,[],t=>t.id()],zoom:[It,[],t=>t.globals.zoom],pitch:[It,[],t=>t.globals.pitch||0],"distance-from-center":[It,[],t=>t.distanceFromCenter()],"measure-light":[It,[Bn],(t,[e])=>t.measureLight(e.evaluate(t))],"heatmap-density":[It,[],t=>t.globals.heatmapDensity||0],"line-progress":[It,[],t=>t.globals.lineProgress||0],"raster-value":[It,[],t=>t.globals.rasterValue||0],"sky-radial-progress":[It,[],t=>t.globals.skyRadialProgress||0],accumulated:[Zn,[],t=>t.globals.accumulated===void 0?null:t.globals.accumulated],"+":[It,Qa(It),(t,e)=>{let n=0;for(const i of e)n+=i.evaluate(t);return n}],"*":[It,Qa(It),(t,e)=>{let n=1;for(const i of e)n*=i.evaluate(t);return n}],"-":{type:It,overloads:[[[It,It],(t,[e,n])=>e.evaluate(t)-n.evaluate(t)],[[It],(t,[e])=>-e.evaluate(t)]]},"/":[It,[It,It],(t,[e,n])=>e.evaluate(t)/n.evaluate(t)],"%":[It,[It,It],(t,[e,n])=>e.evaluate(t)%n.evaluate(t)],ln2:[It,[],()=>Math.LN2],pi:[It,[],()=>Math.PI],e:[It,[],()=>Math.E],"^":[It,[It,It],(t,[e,n])=>Math.pow(e.evaluate(t),n.evaluate(t))],sqrt:[It,[It],(t,[e])=>Math.sqrt(e.evaluate(t))],log10:[It,[It],(t,[e])=>Math.log(e.evaluate(t))/Math.LN10],ln:[It,[It],(t,[e])=>Math.log(e.evaluate(t))],log2:[It,[It],(t,[e])=>Math.log(e.evaluate(t))/Math.LN2],sin:[It,[It],(t,[e])=>Math.sin(e.evaluate(t))],cos:[It,[It],(t,[e])=>Math.cos(e.evaluate(t))],tan:[It,[It],(t,[e])=>Math.tan(e.evaluate(t))],asin:[It,[It],(t,[e])=>Math.asin(e.evaluate(t))],acos:[It,[It],(t,[e])=>Math.acos(e.evaluate(t))],atan:[It,[It],(t,[e])=>Math.atan(e.evaluate(t))],min:[It,Qa(It),(t,e)=>Math.min(...e.map(n=>n.evaluate(t)))],max:[It,Qa(It),(t,e)=>Math.max(...e.map(n=>n.evaluate(t)))],abs:[It,[It],(t,[e])=>Math.abs(e.evaluate(t))],round:[It,[It],(t,[e])=>{const n=e.evaluate(t);return n<0?-Math.round(-n):Math.round(n)}],floor:[It,[It],(t,[e])=>Math.floor(e.evaluate(t))],ceil:[It,[It],(t,[e])=>Math.ceil(e.evaluate(t))],"filter-==":[Gn,[Bn,Zn],(t,[e,n])=>t.properties()[e.value]===n.value],"filter-id-==":[Gn,[Zn],(t,[e])=>t.id()===e.value],"filter-type-==":[Gn,[Bn],(t,[e])=>t.geometryType()===e.value],"filter-<":[Gn,[Bn,Zn],(t,[e,n])=>{const i=t.properties()[e.value],s=n.value;return typeof i==typeof s&&i<s}],"filter-id-<":[Gn,[Zn],(t,[e])=>{const n=t.id(),i=e.value;return typeof n==typeof i&&n<i}],"filter->":[Gn,[Bn,Zn],(t,[e,n])=>{const i=t.properties()[e.value],s=n.value;return typeof i==typeof s&&i>s}],"filter-id->":[Gn,[Zn],(t,[e])=>{const n=t.id(),i=e.value;return typeof n==typeof i&&n>i}],"filter-<=":[Gn,[Bn,Zn],(t,[e,n])=>{const i=t.properties()[e.value],s=n.value;return typeof i==typeof s&&i<=s}],"filter-id-<=":[Gn,[Zn],(t,[e])=>{const n=t.id(),i=e.value;return typeof n==typeof i&&n<=i}],"filter->=":[Gn,[Bn,Zn],(t,[e,n])=>{const i=t.properties()[e.value],s=n.value;return typeof i==typeof s&&i>=s}],"filter-id->=":[Gn,[Zn],(t,[e])=>{const n=t.id(),i=e.value;return typeof n==typeof i&&n>=i}],"filter-has":[Gn,[Zn],(t,[e])=>e.value in t.properties()],"filter-has-id":[Gn,[],t=>t.id()!==null&&t.id()!==void 0],"filter-type-in":[Gn,[po(Bn)],(t,[e])=>e.value.indexOf(t.geometryType())>=0],"filter-id-in":[Gn,[po(Zn)],(t,[e])=>e.value.indexOf(t.id())>=0],"filter-in-small":[Gn,[Bn,po(Zn)],(t,[e,n])=>n.value.indexOf(t.properties()[e.value])>=0],"filter-in-large":[Gn,[Bn,po(Zn)],(t,[e,n])=>function(i,s,l,u){for(;l<=u;){const h=l+u>>1;if(s[h]===i)return!0;s[h]>i?u=h-1:l=h+1}return!1}(t.properties()[e.value],n.value,0,n.value.length-1)],all:{type:Gn,overloads:[[[Gn,Gn],(t,[e,n])=>e.evaluate(t)&&n.evaluate(t)],[Qa(Gn),(t,e)=>{for(const n of e)if(!n.evaluate(t))return!1;return!0}]]},any:{type:Gn,overloads:[[[Gn,Gn],(t,[e,n])=>e.evaluate(t)||n.evaluate(t)],[Qa(Gn),(t,e)=>{for(const n of e)if(n.evaluate(t))return!0;return!1}]]},"!":[Gn,[Gn],(t,[e])=>!e.evaluate(t)],"is-supported-script":[Gn,[Bn],(t,[e])=>{const n=t.globals&&t.globals.isSupportedScript;return!n||n(e.evaluate(t))}],upcase:[Bn,[Bn],(t,[e])=>e.evaluate(t).toUpperCase()],downcase:[Bn,[Bn],(t,[e])=>e.evaluate(t).toLowerCase()],concat:[Bn,Qa(Zn),(t,e)=>e.map(n=>pd(n.evaluate(t))).join("")],"resolved-locale":[Bn,[Yf],(t,[e])=>e.evaluate(t).resolvedLocale()],random:[It,[It,It,Zn],(t,e)=>{const[n,i,s]=e.map(u=>u.evaluate(t));if(n>i||n===i)return n;let l;if(typeof s=="string")l=function(u){let h=0;if(u.length===0)return h;for(let f=0;f<u.length;f++)h=(h<<5)-h+u.charCodeAt(f),h&=h;return h}(s);else{if(typeof s!="number")throw new Ni(`Invalid seed input: ${s}`);l=s}return n+Vc(l)()*(i-n)}]});var $c=Sy;function Wv(t){return{result:"success",value:t}}function Wo(t){return{result:"error",value:t}}function zu(t,e){return!!t&&!!t.parameters&&t.parameters.indexOf(e)>-1}function As(t){return t["property-type"]==="data-driven"}function Dd(t){return zu(t.expression,"measure-light")}function Gc(t){return zu(t.expression,"zoom")}function Zo(t){return!!t.expression&&t.expression.interpolated}function Lo(t){return typeof t=="object"&&t!==null&&!Array.isArray(t)}function Fu(t){return t}function ca(t,e){const n=e.type==="color",i=t.stops&&typeof t.stops[0][0]=="object",s=i||!(i||t.property!==void 0),l=t.type||(Zo(e)?"exponential":"interval");if(n&&((t=os({},t)).stops&&(t.stops=t.stops.map(m=>[m[0],wn.parse(m[1])])),t.default=wn.parse(t.default?t.default:e.default)),t.colorSpace&&t.colorSpace!=="rgb"&&!_p[t.colorSpace])throw new Error(`Unknown color space: ${t.colorSpace}`);let u,h,f;if(l==="exponential")u=bp;else if(l==="interval")u=Zv;else if(l==="categorical"){u=Bu,h=Object.create(null);for(const m of t.stops)h[m[0]]=m[1];f=typeof t.stops[0][0]}else{if(l!=="identity")throw new Error(`Unknown function type "${l}"`);u=Cy}if(i){const m={},y=[];for(let S=0;S<t.stops.length;S++){const E=t.stops[S],A=E[0].zoom;m[A]===void 0&&(m[A]={zoom:A,type:t.type,property:t.property,default:t.default,stops:[]},y.push(A)),m[A].stops.push([E[0].value,E[1]])}const v=[];for(const S of y)v.push([m[S].zoom,ca(m[S],e)]);const w={name:"linear"};return{kind:"composite",interpolationType:w,interpolationFactor:Zs.interpolationFactor.bind(void 0,w),zoomStops:v.map(S=>S[0]),evaluate:({zoom:S},E)=>bp({stops:v,base:t.base},e,S).evaluate(S,E)}}if(s){const m=l==="exponential"?{name:"exponential",base:t.base!==void 0?t.base:1}:null;return{kind:"camera",interpolationType:m,interpolationFactor:Zs.interpolationFactor.bind(void 0,m),zoomStops:t.stops.map(y=>y[0]),evaluate:({zoom:y})=>u(t,e,y,h,f)}}return{kind:"source",evaluate(m,y){const v=y&&y.properties?y.properties[t.property]:void 0;return v===void 0?as(t.default,e.default):u(t,e,v,h,f)}}}function as(t,e,n){return t!==void 0?t:e!==void 0?e:n!==void 0?n:void 0}function Bu(t,e,n,i,s){return as(typeof n===s?i[n]:void 0,t.default,e.default)}function Zv(t,e,n){if(Qn(n)!=="number")return as(t.default,e.default);const i=t.stops.length;if(i===1||n<=t.stops[0][0])return t.stops[0][1];if(n>=t.stops[i-1][0])return t.stops[i-1][1];const s=fp(t.stops.map(l=>l[0]),n);return t.stops[s][1]}function bp(t,e,n){const i=t.base!==void 0?t.base:1;if(Qn(n)!=="number")return as(t.default,e.default);const s=t.stops.length;if(s===1||n<=t.stops[0][0])return t.stops[0][1];if(n>=t.stops[s-1][0])return t.stops[s-1][1];const l=fp(t.stops.map(y=>y[0]),n),u=function(y,v,w,S){const E=S-w,A=y-w;return E===0?0:v===1?A/E:(Math.pow(v,A)-1)/(Math.pow(v,E)-1)}(n,i,t.stops[l][0],t.stops[l+1][0]),h=t.stops[l][1],f=t.stops[l+1][1];let m=Ed[e.type]||Fu;if(t.colorSpace&&t.colorSpace!=="rgb"){const y=_p[t.colorSpace];m=(v,w)=>y.reverse(y.interpolate(y.forward(v),y.forward(w),u))}return typeof h.evaluate=="function"?{evaluate(...y){const v=h.evaluate.apply(void 0,y),w=f.evaluate.apply(void 0,y);if(v!==void 0&&w!==void 0)return m(v,w,u)}}:m(h,f,u)}function Cy(t,e,n){return e.type==="color"?n=wn.parse(n):e.type==="formatted"?n=Ji.fromString(n.toString()):e.type==="resolvedImage"?n=Do.fromString(n.toString()):Qn(n)===e.type||e.type==="enum"&&e.values[n]||(n=void 0),as(n,t.default,e.default)}class Oo{constructor(e,n,i){this.expression=e,this._warningHistory={},this._evaluator=new Ov(i),this._defaultValue=n?function(s){return s.type==="color"&&(Lo(s.default)||Array.isArray(s.default))?new wn(0,0,0,0):s.type==="color"?wn.parse(s.default)||null:s.default===void 0?null:s.default}(n):null,this._enumValues=n&&n.type==="enum"?n.values:null}evaluateWithoutErrorHandling(e,n,i,s,l,u,h,f){return this._evaluator.globals=e,this._evaluator.feature=n,this._evaluator.featureState=i,this._evaluator.canonical=s||null,this._evaluator.availableImages=l||null,this._evaluator.formattedSection=u,this._evaluator.featureTileCoord=h||null,this._evaluator.featureDistanceData=f||null,this.expression.evaluate(this._evaluator)}evaluate(e,n,i,s,l,u,h,f){this._evaluator.globals=e,this._evaluator.feature=n||null,this._evaluator.featureState=i||null,this._evaluator.canonical=s||null,this._evaluator.availableImages=l||null,this._evaluator.formattedSection=u||null,this._evaluator.featureTileCoord=h||null,this._evaluator.featureDistanceData=f||null;try{const m=this.expression.evaluate(this._evaluator);if(m==null||typeof m=="number"&&m!=m)return this._defaultValue;if(this._enumValues&&!(m in this._enumValues))throw new Ni(`Expected value to be one of ${Object.keys(this._enumValues).map(y=>JSON.stringify(y)).join(", ")}, but found ${JSON.stringify(m)} instead.`);return m}catch(m){return this._warningHistory[m.message]||(this._warningHistory[m.message]=!0,typeof console<"u"&&console.warn(m.message)),this._defaultValue}}}function _o(t){return Array.isArray(t)&&t.length>0&&typeof t[0]=="string"&&t[0]in $c}function Ar(t,e,n){const i=new dp($c,[],e?function(l){const u={color:lo,string:Bn,number:It,enum:Bn,boolean:Gn,formatted:Cu,resolvedImage:zl};return l.type==="array"?po(u[l.value]||Zn,l.length):u[l.type]}(e):void 0,void 0,void 0,n),s=i.parse(t,void 0,void 0,void 0,e&&e.type==="string"?{typeAnnotation:"coerce"}:void 0);return s?Wv(new Oo(s,e,n)):Wo(i.errors)}class ls{constructor(e,n,i){this.kind=e,this._styleExpression=n,this.isLightConstant=i,this.isStateDependent=e!=="constant"&&!bd(n.expression),this.isConfigDependent=!cp(n.expression)}evaluateWithoutErrorHandling(e,n,i,s,l,u){return this._styleExpression.evaluateWithoutErrorHandling(e,n,i,s,l,u)}evaluate(e,n,i,s,l,u){return this._styleExpression.evaluate(e,n,i,s,l,u)}}class Ld{constructor(e,n,i,s,l){this.kind=e,this.zoomStops=i,this._styleExpression=n,this.isStateDependent=e!=="camera"&&!bd(n.expression),this.isLightConstant=l,this.isConfigDependent=!cp(n.expression),this.interpolationType=s}evaluateWithoutErrorHandling(e,n,i,s,l,u){return this._styleExpression.evaluateWithoutErrorHandling(e,n,i,s,l,u)}evaluate(e,n,i,s,l,u){return this._styleExpression.evaluate(e,n,i,s,l,u)}interpolationFactor(e,n,i){return this.interpolationType?Zs.interpolationFactor(this.interpolationType,e,n,i):0}}function Sp(t,e,n){if((t=Ar(t,e,n)).result==="error")return t;const i=t.value.expression,s=Nc(i);if(!s&&!As(e))return Wo([new la("","data expressions not supported")]);const l=Ul(i,["zoom","pitch","distance-from-center"]);if(!l&&!Gc(e))return Wo([new la("","zoom expressions not supported")]);const u=Ul(i,["measure-light"]);if(!u&&!Dd(e))return Wo([new la("","measure-light expression not supported")]);const h=e.expression&&e.expression.relaxZoomRestriction,f=qc(i);return f||l||h?f instanceof la?Wo([f]):f instanceof Zs&&!Zo(e)?Wo([new la("",'"interpolate" expressions cannot be used with this property')]):Wv(f?new Ld(s?"camera":"composite",t.value,f.labels,f instanceof Zs?f.interpolation:void 0,u):new ls(s?"constant":"source",t.value,u)):Wo([new la("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression, or in the properties of atmosphere.')])}class Hc{constructor(e,n){this._parameters=e,this._specification=n,os(this,ca(this._parameters,this._specification))}static deserialize(e){return new Hc(e._parameters,e._specification)}static serialize(e){return{_parameters:e._parameters,_specification:e._specification}}}function qc(t){let e=null;if(t instanceof Xa)e=qc(t.result);else if(t instanceof qv){for(const n of t.args)if(e=qc(n),e)break}else(t instanceof fy||t instanceof Zs)&&t.input instanceof Ws&&t.input.name==="zoom"&&(e=t);return e instanceof la||t.eachChild(n=>{const i=qc(n);i instanceof la?e=i:e&&i&&e!==i&&(e=new la("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),e}function us(t){const e=t.key,n=t.value,i=t.valueSpec||{},s=t.objectElementValidators||{},l=t.style,u=t.styleSpec;let h=[];const f=Qn(n);if(f!=="object")return[new Ct(e,n,`object expected, ${f} found`)];for(const m in n){const y=m.split(".")[0];let v;s[y]?v=s[y]:i[y]?v=yi:s["*"]?v=s["*"]:i["*"]&&(v=yi),v?h=h.concat(v({key:(e&&`${e}.`)+m,value:n[m],valueSpec:i[y]||i["*"],style:l,styleSpec:u,object:n,objectKey:m},n)):h.push(new Ct(e,n[m],`unknown property "${m}"`))}for(const m in i)s[m]||i[m].required&&i[m].default===void 0&&n[m]===void 0&&h.push(new Ct(e,n,`missing required property "${m}"`));return h}function Od(t){const e=t.value,n=t.valueSpec,i=t.style,s=t.styleSpec,l=t.key,u=t.arrayElementValidator||yi;if(Qn(e)!=="array")return[new Ct(l,e,`array expected, ${Qn(e)} found`)];if(n.length&&e.length!==n.length)return[new Ct(l,e,`array length ${n.length} expected, length ${e.length} found`)];if(n["min-length"]&&e.length<n["min-length"])return[new Ct(l,e,`array length at least ${n["min-length"]} expected, length ${e.length} found`)];let h={type:n.value,values:n.values,minimum:n.minimum,maximum:n.maximum,function:void 0};s.$version<7&&(h.function=n.function),Qn(n.value)==="object"&&(h=n.value);let f=[];for(let m=0;m<e.length;m++)f=f.concat(u({array:e,arrayIndex:m,value:e[m],valueSpec:h,style:i,styleSpec:s,key:`${l}[${m}]`},!0));return f}function Ay(t){const e=t.key,n=t.value,i=t.valueSpec;let s=Qn(n);if(s==="number"&&n!=n&&(s="NaN"),s!=="number")return[new Ct(e,n,`number expected, ${s} found`)];if("minimum"in i){let l=i.minimum;if(Qn(i.minimum)==="array"&&(l=i.minimum[t.arrayIndex]),n<l)return[new Ct(e,n,`${n} is less than the minimum value ${l}`)]}if("maximum"in i){let l=i.maximum;if(Qn(i.maximum)==="array"&&(l=i.maximum[t.arrayIndex]),n>l)return[new Ct(e,n,`${n} is greater than the maximum value ${l}`)]}return[]}function Nu(t){const e=t.valueSpec,n=Bi(t.value.type);let i,s,l,u={};const h=n!=="categorical"&&t.value.property===void 0,f=!h,m=Qn(t.value.stops)==="array"&&Qn(t.value.stops[0])==="array"&&Qn(t.value.stops[0][0])==="object",y=us({key:t.key,value:t.value,valueSpec:t.styleSpec.function,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{stops:function(S){if(n==="identity")return[new Ct(S.key,S.value,'identity function may not have a "stops" property')];let E=[];const A=S.value;return E=E.concat(Od({key:S.key,value:A,valueSpec:S.valueSpec,style:S.style,styleSpec:S.styleSpec,arrayElementValidator:v})),Qn(A)==="array"&&A.length===0&&E.push(new Ct(S.key,A,"array must have at least one stop")),E},default:function(S){return yi({key:S.key,value:S.value,valueSpec:e,style:S.style,styleSpec:S.styleSpec})}}});return n==="identity"&&h&&y.push(new Ct(t.key,t.value,'missing required property "property"')),n==="identity"||t.value.stops||y.push(new Ct(t.key,t.value,'missing required property "stops"')),n==="exponential"&&t.valueSpec.expression&&!Zo(t.valueSpec)&&y.push(new Ct(t.key,t.value,"exponential functions not supported")),t.styleSpec.$version>=8&&(f&&!As(t.valueSpec)?y.push(new Ct(t.key,t.value,"property functions not supported")):h&&!Gc(t.valueSpec)&&y.push(new Ct(t.key,t.value,"zoom functions not supported"))),n!=="categorical"&&!m||t.value.property!==void 0||y.push(new Ct(t.key,t.value,'"property" property is required')),y;function v(S){let E=[];const A=S.value,M=S.key;if(Qn(A)!=="array")return[new Ct(M,A,`array expected, ${Qn(A)} found`)];if(A.length!==2)return[new Ct(M,A,`array length 2 expected, length ${A.length} found`)];if(m){if(Qn(A[0])!=="object")return[new Ct(M,A,`object expected, ${Qn(A[0])} found`)];if(A[0].zoom===void 0)return[new Ct(M,A,"object stop key must have zoom")];if(A[0].value===void 0)return[new Ct(M,A,"object stop key must have value")];const k=Bi(A[0].zoom);if(typeof k!="number")return[new Ct(M,A[0].zoom,"stop zoom values must be numbers")];if(l&&l>k)return[new Ct(M,A[0].zoom,"stop zoom values must appear in ascending order")];k!==l&&(l=k,s=void 0,u={}),E=E.concat(us({key:`${M}[0]`,value:A[0],valueSpec:{zoom:{}},style:S.style,styleSpec:S.styleSpec,objectElementValidators:{zoom:Ay,value:w}}))}else E=E.concat(w({key:`${M}[0]`,value:A[0],valueSpec:{},style:S.style,styleSpec:S.styleSpec},A));return _o(aa(A[1]))?E.concat([new Ct(`${M}[1]`,A[1],"expressions are not allowed in function stops.")]):E.concat(yi({key:`${M}[1]`,value:A[1],valueSpec:e,style:S.style,styleSpec:S.styleSpec}))}function w(S,E){const A=Qn(S.value),M=Bi(S.value),k=S.value!==null?S.value:E;if(i){if(A!==i)return[new Ct(S.key,k,`${A} stop domain type must match previous stop domain type ${i}`)]}else i=A;if(A!=="number"&&A!=="string"&&A!=="boolean"&&typeof M!="number"&&typeof M!="string"&&typeof M!="boolean")return[new Ct(S.key,k,"stop domain value must be a number, string, or boolean")];if(A!=="number"&&n!=="categorical"){let R=`number expected, ${A} found`;return As(e)&&n===void 0&&(R+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Ct(S.key,k,R)]}return n!=="categorical"||A!=="number"||typeof M=="number"&&isFinite(M)&&Math.floor(M)===M?n!=="categorical"&&A==="number"&&typeof M=="number"&&typeof s=="number"&&s!==void 0&&M<s?[new Ct(S.key,k,"stop domain values must appear in ascending order")]:(s=M,n==="categorical"&&M in u?[new Ct(S.key,k,"stop domain values must be unique")]:(u[M]=!0,[])):[new Ct(S.key,k,`integer expected, found ${String(M)}`)]}}function Ja(t){const e=(t.expressionContext==="property"?Sp:Ar)(aa(t.value),t.valueSpec);if(e.result==="error")return e.value.map(i=>new Ct(`${t.key}${i.key}`,t.value,i.message));const n=e.value.expression||e.value._styleExpression.expression;if(t.expressionContext==="property"&&t.propertyKey==="text-font"&&!n.outputDefined())return[new Ct(t.key,t.value,`Invalid data expression for "${t.propertyKey}". Output values must be contained as literals within the expression.`)];if(t.expressionContext==="property"&&t.propertyType==="layout"&&!bd(n))return[new Ct(t.key,t.value,'"feature-state" data expressions are not supported with layout properties.')];if(t.expressionContext==="filter")return Xv(n,t);if(t.expressionContext&&t.expressionContext.indexOf("cluster")===0){if(!Ul(n,["zoom","feature-state"]))return[new Ct(t.key,t.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(t.expressionContext==="cluster-initial"&&!Nc(n))return[new Ct(t.key,t.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Xv(t,e){const n=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(e.valueSpec&&e.valueSpec.expression)for(const s of e.valueSpec.expression.parameters)n.delete(s);if(n.size===0)return[];const i=[];return t instanceof Ws&&n.has(t.name)?[new Ct(e.key,e.value,`["${t.name}"] expression is not supported in a filter for a ${e.object.type} layer with id: ${e.object.id}`)]:(t.eachChild(s=>{i.push(...Xv(s,e))}),i)}function Xo(t){const e=t.key,n=t.value,i=t.valueSpec,s=[];return Array.isArray(i.values)?i.values.indexOf(Bi(n))===-1&&s.push(new Ct(e,n,`expected one of [${i.values.join(", ")}], ${JSON.stringify(n)} found`)):Object.keys(i.values).indexOf(Bi(n))===-1&&s.push(new Ct(e,n,`expected one of [${Object.keys(i.values).join(", ")}], ${JSON.stringify(n)} found`)),s}function Wc(t){if(t===!0||t===!1)return!0;if(!Array.isArray(t)||t.length===0)return!1;switch(t[0]){case"has":return t.length>=2&&t[1]!=="$id"&&t[1]!=="$type";case"in":return t.length>=3&&(typeof t[1]!="string"||Array.isArray(t[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return t.length!==3||Array.isArray(t[1])||Array.isArray(t[2]);case"any":case"all":for(const e of t.slice(1))if(!Wc(e)&&typeof e!="boolean")return!1;return!0;default:return!0}}function ju(t,e="fill"){if(t==null)return{filter:()=>!0,needGeometry:!1,needFeature:!1};Wc(t)||(t=zo(t));const n=t;let i=!0;try{i=function(m){if(!Hl(m))return m;let y=aa(m);return Ep(y),y=Uu(y),y}(n)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.
This is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md
and paste the contents of this message in the report.
Thank you!
Filter Expression:
${JSON.stringify(n,null,2)}
        `)}const s=ke[`filter_${e}`],l=Ar(i,s);let u=null;if(l.result==="error")throw new Error(l.value.map(m=>`${m.key}: ${m.message}`).join(", "));u=(m,y,v)=>l.value.evaluate(m,y,{},v);let h=null,f=null;if(i!==n){const m=Ar(n,s);if(m.result==="error")throw new Error(m.value.map(y=>`${y.key}: ${y.message}`).join(", "));h=(y,v,w,S,E)=>m.value.evaluate(y,v,{},w,void 0,void 0,S,E),f=!Nc(m.value.expression)}return{filter:u,dynamicFilter:h||void 0,needGeometry:Vu(i),needFeature:!!f}}function Uu(t){if(!Array.isArray(t))return t;const e=function(n){if(My.has(n[0])){for(let i=1;i<n.length;i++)if(Hl(n[i]))return!0}return n}(t);return e===!0?e:e.map(n=>Uu(n))}function Ep(t){let e=!1;const n=[];if(t[0]==="case"){for(let i=1;i<t.length-1;i+=2)e=e||Hl(t[i]),n.push(t[i+1]);n.push(t[t.length-1])}else if(t[0]==="match"){e=e||Hl(t[1]);for(let i=2;i<t.length-1;i+=2)n.push(t[i+1]);n.push(t[t.length-1])}else if(t[0]==="step"){e=e||Hl(t[1]);for(let i=1;i<t.length-1;i+=2)n.push(t[i+1])}e&&(t.length=0,t.push("any",...n));for(let i=1;i<t.length;i++)Ep(t[i])}function Hl(t){if(!Array.isArray(t))return!1;if((e=t[0])==="pitch"||e==="distance-from-center")return!0;var e;for(let n=1;n<t.length;n++)if(Hl(t[n]))return!0;return!1}const My=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function Iy(t,e){return t<e?-1:t>e?1:0}function Vu(t){if(!Array.isArray(t))return!1;if(t[0]==="within"||t[0]==="distance")return!0;for(let e=1;e<t.length;e++)if(Vu(t[e]))return!0;return!1}function zo(t){if(!t)return!0;const e=t[0];return t.length<=1?e!=="any":e==="=="?el(t[1],t[2],"=="):e==="!="?Ms(el(t[1],t[2],"==")):e==="<"||e===">"||e==="<="||e===">="?el(t[1],t[2],e):e==="any"?(n=t.slice(1),["any"].concat(n.map(zo))):e==="all"?["all"].concat(t.slice(1).map(zo)):e==="none"?["all"].concat(t.slice(1).map(zo).map(Ms)):e==="in"?Tp(t[1],t.slice(2)):e==="!in"?Ms(Tp(t[1],t.slice(2))):e==="has"?ky(t[1]):e!=="!has"||Ms(ky(t[1]));var n}function el(t,e,n){switch(t){case"$type":return[`filter-type-${n}`,e];case"$id":return[`filter-id-${n}`,e];default:return[`filter-${n}`,t,e]}}function Tp(t,e){if(e.length===0)return!1;switch(t){case"$type":return["filter-type-in",["literal",e]];case"$id":return["filter-id-in",["literal",e]];default:return e.length>200&&!e.some(n=>typeof n!=typeof e[0])?["filter-in-large",t,["literal",e.sort(Iy)]]:["filter-in-small",t,["literal",e]]}}function ky(t){switch(t){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",t]}}function Ms(t){return["!",t]}function ha(t){return Wc(aa(t.value))?Ja(os({},t,{expressionContext:"filter",valueSpec:t.styleSpec[`filter_${t.layerType||"fill"}`]})):Cp(t)}function Cp(t){const e=t.value,n=t.key;if(Qn(e)!=="array")return[new Ct(n,e,`array expected, ${Qn(e)} found`)];const i=t.styleSpec;let s,l=[];if(e.length<1)return[new Ct(n,e,"filter array must have at least 1 element")];switch(l=l.concat(Xo({key:`${n}[0]`,value:e[0],valueSpec:i.filter_operator,style:t.style,styleSpec:t.styleSpec})),Bi(e[0])){case"<":case"<=":case">":case">=":e.length>=2&&Bi(e[1])==="$type"&&l.push(new Ct(n,e,`"$type" cannot be use with operator "${e[0]}"`));case"==":case"!=":e.length!==3&&l.push(new Ct(n,e,`filter array for operator "${e[0]}" must have 3 elements`));case"in":case"!in":e.length>=2&&(s=Qn(e[1]),s!=="string"&&l.push(new Ct(`${n}[1]`,e[1],`string expected, ${s} found`)));for(let u=2;u<e.length;u++)s=Qn(e[u]),Bi(e[1])==="$type"?l=l.concat(Xo({key:`${n}[${u}]`,value:e[u],valueSpec:i.geometry_type,style:t.style,styleSpec:t.styleSpec})):s!=="string"&&s!=="number"&&s!=="boolean"&&l.push(new Ct(`${n}[${u}]`,e[u],`string, number, or boolean expected, ${s} found`));break;case"any":case"all":case"none":for(let u=1;u<e.length;u++)l=l.concat(Cp({key:`${n}[${u}]`,value:e[u],style:t.style,styleSpec:t.styleSpec}));break;case"has":case"!has":s=Qn(e[1]),e.length!==2?l.push(new Ct(n,e,`filter array for "${e[0]}" operator must have 2 elements`)):s!=="string"&&l.push(new Ct(`${n}[1]`,e[1],`string expected, ${s} found`))}return l}function Py(t,e){const n=t.key,i=t.style,s=t.layer,l=t.styleSpec,u=t.value,h=t.objectKey,f=l[`${e}_${t.layerType}`];if(!f)return[];const m=h.match(/^(.*)-transition$/);if(e==="paint"&&m&&f[m[1]]&&f[m[1]].transition)return yi({key:n,value:u,valueSpec:l.transition,style:i,styleSpec:l});const y=t.valueSpec||f[h];if(!y)return[new Ct(n,u,`unknown property "${h}"`)];let v;if(Qn(u)==="string"&&As(y)&&!y.tokens&&(v=/^{([^}]+)}$/.exec(u))){const S=`\`{ "type": "identity", "property": ${v?JSON.stringify(v[1]):'"_"'} }\``;return[new Ct(n,u,`"${h}" does not support interpolation syntax
Use an identity property function instead: ${S}.`)]}const w=[];if(t.layerType==="symbol")h==="text-field"&&i&&!i.glyphs&&w.push(new Ct(n,u,'use of "text-field" requires a style "glyphs" property')),h==="text-font"&&Lo(aa(u))&&Bi(u.type)==="identity"&&w.push(new Ct(n,u,'"text-font" does not support identity functions'));else if(t.layerType==="model"&&e==="paint"&&s&&s.layout&&s.layout.hasOwnProperty("model-id")&&As(y)&&(Dd(y)||Gc(y))){const S=Sp(aa(u),y),E=S.value.expression||S.value._styleExpression.expression;!E||Ul(E,["zoom"])&&Ul(E,["measure-light"])||w.push(new Ct(n,u,`${h} does not support zoom or measure-light expressions when the model layer source is vector tile or GeoJSON.`))}return w.concat(yi({key:t.key,value:u,valueSpec:y,style:i,styleSpec:l,expressionContext:"property",propertyType:e,propertyKey:h}))}function da(t){return Py(t,"paint")}function tl(t){return Py(t,"layout")}function zd(t){let e=[];const n=t.value,i=t.key,s=t.style,l=t.styleSpec;n.type||n.ref||e.push(new Ct(i,n,'either "type" or "ref" is required'));let u=Bi(n.type);const h=Bi(n.ref);if(n.id){const f=Bi(n.id);for(let m=0;m<t.arrayIndex;m++){const y=s.layers[m];Bi(y.id)===f&&e.push(new Ct(i,n.id,`duplicate layer id "${n.id}", previously used at line ${y.id.__line__}`))}}if("ref"in n){let f;["type","source","source-layer","filter","layout"].forEach(m=>{m in n&&e.push(new Ct(i,n[m],`"${m}" is prohibited for ref layers`))}),s.layers.forEach(m=>{Bi(m.id)===h&&(f=m)}),f?f.ref?e.push(new Ct(i,n.ref,"ref cannot reference another ref layer")):u=Bi(f.type):typeof h=="string"&&e.push(new Ct(i,n.ref,`ref layer "${h}" not found`))}else if(u!=="background"&&u!=="sky"&&u!=="slot")if(n.source){const f=s.sources&&s.sources[n.source],m=f&&Bi(f.type);f?m==="vector"&&u==="raster"?e.push(new Ct(i,n.source,`layer "${n.id}" requires a raster source`)):m==="raster"&&u!=="raster"?e.push(new Ct(i,n.source,`layer "${n.id}" requires a vector source`)):m!=="vector"||n["source-layer"]?m==="raster-dem"&&u!=="hillshade"?e.push(new Ct(i,n.source,"raster-dem source can only be used with layer type 'hillshade'.")):u!=="line"||!n.paint||!n.paint["line-gradient"]&&!n.paint["line-trim-offset"]||m==="geojson"&&f.lineMetrics||e.push(new Ct(i,n,`layer "${n.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):e.push(new Ct(i,n,`layer "${n.id}" must specify a "source-layer"`)):e.push(new Ct(i,n.source,`source "${n.source}" not found`))}else e.push(new Ct(i,n,'missing required property "source"'));return e=e.concat(us({key:i,value:n,valueSpec:l.layer,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{"*":()=>[],type:()=>yi({key:`${i}.type`,value:n.type,valueSpec:l.layer.type,style:t.style,styleSpec:t.styleSpec,object:n,objectKey:"type"}),filter:f=>ha(os({layerType:u},f)),layout:f=>us({layer:n,key:f.key,value:f.value,valueSpec:{},style:f.style,styleSpec:f.styleSpec,objectElementValidators:{"*":m=>tl(os({layerType:u},m))}}),paint:f=>us({layer:n,key:f.key,value:f.value,valueSpec:{},style:f.style,styleSpec:f.styleSpec,objectElementValidators:{"*":m=>da(os({layerType:u,layer:n},m))}})}})),e}function $u(t){const e=t.value,n=t.key,i=Qn(e);return i!=="string"?[new Ct(n,e,`string expected, ${i} found`)]:[]}const Fd={promoteId:function({key:t,value:e}){if(Qn(e)==="string")return $u({key:t,value:e});{const n=[];for(const i in e)n.push(...$u({key:`${t}.${i}`,value:e[i]}));return n}}};function Ry(t){const e=t.value,n=t.key,i=t.styleSpec,s=t.style;if(!e.type)return[new Ct(n,e,'"type" is required')];const l=Bi(e.type);let u;switch(l){case"vector":case"raster":case"raster-dem":return u=us({key:n,value:e,valueSpec:i[`source_${l.replace("-","_")}`],style:t.style,styleSpec:i,objectElementValidators:Fd}),u;case"geojson":if(u=us({key:n,value:e,valueSpec:i.source_geojson,style:s,styleSpec:i,objectElementValidators:Fd}),e.cluster)for(const h in e.clusterProperties){const[f,m]=e.clusterProperties[h],y=typeof f=="string"?[f,["accumulated"],["get",h]]:f;u.push(...Ja({key:`${n}.${h}.map`,value:m,expressionContext:"cluster-map"})),u.push(...Ja({key:`${n}.${h}.reduce`,value:y,expressionContext:"cluster-reduce"}))}return u;case"video":return us({key:n,value:e,valueSpec:i.source_video,style:s,styleSpec:i});case"image":return us({key:n,value:e,valueSpec:i.source_image,style:s,styleSpec:i});case"canvas":return[new Ct(n,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Xo({key:`${n}.type`,value:e.type,valueSpec:{values:Kv(i)},style:s,styleSpec:i})}}function Kv(t){return t.source.reduce((e,n)=>{const i=t[n];return i.type.type==="enum"&&(e=e.concat(Object.keys(i.type.values))),e},[])}function Ap(t){const e=t.value;let n=[];if(!e)return n;const i=Qn(e);return i!=="string"?(n=n.concat([new Ct(t.key,e,`string expected, "${i}" found`)]),n):(function(s){const l=s.indexOf("://")===-1;try{return new URL(s,l?"http://example.com":void 0),!0}catch{return!1}}(e)||(n=n.concat([new Ct(t.key,e,`invalid url "${e}"`)])),n)}function Bd(t){const e=t.value,n=t.styleSpec,i=n.light,s=t.style;let l=[];const u=Qn(e);if(e===void 0)return l;if(u!=="object")return l=l.concat([new Ct("light",e,`object expected, ${u} found`)]),l;for(const h in e){const f=h.match(/^(.*)-transition$/);l=l.concat(f&&i[f[1]]&&i[f[1]].transition?yi({key:h,value:e[h],valueSpec:n.transition,style:s,styleSpec:n}):i[h]?yi({key:h,value:e[h],valueSpec:i[h],style:s,styleSpec:n}):[new Ct(h,e[h],`unknown property "${h}"`)])}return l}function Dy(t){const e=t.value;let n=[];if(!e)return n;const i=Qn(e);if(i!=="object")return n=n.concat([new Ct("light-3d",e,`object expected, ${i} found`)]),n;const s=t.styleSpec,l=s["light-3d"],u=t.style;for(const m of["type","id"])if(!(m in e))return n=n.concat([new Ct("light-3d",e,`missing property ${m} on light`)]),n;const h=`properties_light_${e.type}`;if(!(h in s))return n=n.concat([new Ct("light-3d",e,`Invalid light type ${e.type}`)]),n;const f=s[h];for(const m in e)if(m==="properties"){const y=e[m],v=Qn(y);if(v!=="object")return n=n.concat([new Ct("properties",y,`object expected, ${v} found`)]),n;for(const w in y)n=n.concat(yi({key:w,value:y[w],valueSpec:f[w],style:u,styleSpec:s}))}else{const y=m.match(/^(.*)-transition$/);n=n.concat(y&&l[y[1]]&&l[y[1]].transition?yi({key:m,value:e[m],valueSpec:s.transition,style:u,styleSpec:s}):l[m]?yi({key:m,value:e[m],valueSpec:l[m],style:u,styleSpec:s}):[new Ct(m,e[m],`unknown property "${m}"`)])}return n}function Ly(t){const e=t.value,n=t.key,i=t.style,s=t.styleSpec,l=s.terrain;let u=[];const h=Qn(e);if(e===void 0)return u;if(h!=="object")return u=u.concat([new Ct("terrain",e,`object expected, ${h} found`)]),u;for(const f in e){const m=f.match(/^(.*)-transition$/);u=u.concat(m&&l[m[1]]&&l[m[1]].transition?yi({key:f,value:e[f],valueSpec:s.transition,style:i,styleSpec:s}):l[f]?yi({key:f,value:e[f],valueSpec:l[f],style:i,styleSpec:s}):[new Ct(f,e[f],`unknown property "${f}"`)])}if(e.source){const f=i.sources&&i.sources[e.source],m=f&&Bi(f.type);f?m!=="raster-dem"&&u.push(new Ct(n,e.source,`terrain cannot be used with a source of type ${String(m)}, it only be used with a "raster-dem" source type`)):u.push(new Ct(n,e.source,`source "${e.source}" not found`))}else u.push(new Ct(n,e,'terrain is missing required property "source"'));return u}function Oy(t){const e=t.value,n=t.style,i=t.styleSpec,s=i.fog;let l=[];const u=Qn(e);if(e===void 0)return l;if(u!=="object")return l=l.concat([new Ct("fog",e,`object expected, ${u} found`)]),l;for(const h in e){const f=h.match(/^(.*)-transition$/);l=l.concat(f&&s[f[1]]&&s[f[1]].transition?yi({key:h,value:e[h],valueSpec:i.transition,style:n,styleSpec:i}):s[h]?yi({key:h,value:e[h],valueSpec:s[h],style:n,styleSpec:i}):[new Ct(h,e[h],`unknown property "${h}"`)])}return l}const Mp={"*":()=>[],array:Od,boolean:function(t){const e=t.value,n=t.key,i=Qn(e);return i!=="boolean"?[new Ct(n,e,`boolean expected, ${i} found`)]:[]},number:Ay,color:function(t){const e=t.key,n=t.value,i=Qn(n);return i!=="string"?[new Ct(e,n,`color expected, ${i} found`)]:Ic(n)===null?[new Ct(e,n,`color expected, "${n}" found`)]:[]},enum:Xo,filter:ha,function:Nu,layer:zd,object:us,source:Ry,model:Ap,light:Bd,"light-3d":Dy,terrain:Ly,fog:Oy,string:$u,formatted:function(t){return $u(t).length===0?[]:Ja(t)},resolvedImage:function(t){return $u(t).length===0?[]:Ja(t)},projection:function(t){const e=t.value,n=t.styleSpec,i=n.projection,s=t.style;let l=[];const u=Qn(e);if(u==="object")for(const h in e)l=l.concat(yi({key:h,value:e[h],valueSpec:i[h],style:s,styleSpec:n}));else u!=="string"&&(l=l.concat([new Ct("projection",e,`object or string expected, ${u} found`)]));return l},import:function(t){const{value:e,styleSpec:n}=t,{data:i,...s}=e;Object.defineProperty(s,"__line__",{value:e.__line__,enumerable:!1});let l=us(os({},t,{value:s,valueSpec:n.import}));return i&&(l=l.concat(zy(i,n,{key:`${t.key}.data`}))),l}};function yi(t,e=!1){const n=t.value,i=t.valueSpec,s=t.styleSpec;if(i.expression&&Lo(Bi(n)))return Nu(t);if(i.expression&&_o(aa(n)))return Ja(t);if(i.type&&Mp[i.type]){const l=Mp[i.type](t);return e===!0&&l.length>0&&Qn(t.value)==="array"?Ja(t):l}return us(os({},t,{valueSpec:i.type?s[i.type]:i}))}function Ip(t){const e=t.value,n=t.key,i=$u(t);return i.length||(e.indexOf("{fontstack}")===-1&&i.push(new Ct(n,e,'"glyphs" url must include a "{fontstack}" token')),e.indexOf("{range}")===-1&&i.push(new Ct(n,e,'"glyphs" url must include a "{range}" token'))),i}function zy(t,e=ke,n={}){return yi({key:n.key||"",value:t,valueSpec:e.$root,styleSpec:e,style:t,objectElementValidators:{glyphs:Ip,"*":()=>[]}})}function Gu(t,e=ke){return cs(zy(t,e))}const Zc=t=>cs(Ry(t)),Yv=t=>cs(Bd(t)),Nd=t=>cs(Dy(t)),fa=t=>cs(Ly(t)),jd=t=>cs(Oy(t)),Ud=t=>cs(zd(t)),nl=t=>cs(ha(t)),Fy=t=>cs(da(t)),Xc=t=>cs(tl(t)),Qv=t=>cs(Ap(t));function cs(t){return t.slice().sort((e,n)=>e.line&&n.line?e.line-n.line:0)}function ti(t,e){let n=!1;if(e&&e.length)for(const i of e)t.fire(new en(new Error(i.message))),n=!0;return n}var kp=Is,pa=3;function Is(t,e,n){var i=this.cells=[];if(t instanceof ArrayBuffer){this.arrayBuffer=t;var s=new Int32Array(this.arrayBuffer);t=s[0],this.d=(e=s[1])+2*(n=s[2]);for(var l=0;l<this.d*this.d;l++){var u=s[pa+l],h=s[pa+l+1];i.push(u===h?null:s.subarray(u,h))}var f=s[pa+i.length+1];this.keys=s.subarray(s[pa+i.length],f),this.bboxes=s.subarray(f),this.insert=this._insertReadonly}else{this.d=e+2*n;for(var m=0;m<this.d*this.d;m++)i.push([]);this.keys=[],this.bboxes=[]}this.n=e,this.extent=t,this.padding=n,this.scale=e/t,this.uid=0;var y=n/e*t;this.min=-y,this.max=t+y}Is.prototype.insert=function(t,e,n,i,s){this._forEachCell(e,n,i,s,this._insertCell,this.uid++),this.keys.push(t),this.bboxes.push(e),this.bboxes.push(n),this.bboxes.push(i),this.bboxes.push(s)},Is.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},Is.prototype._insertCell=function(t,e,n,i,s,l){this.cells[s].push(l)},Is.prototype.query=function(t,e,n,i,s){var l=this.min,u=this.max;if(t<=l&&e<=l&&u<=n&&u<=i&&!s)return Array.prototype.slice.call(this.keys);var h=[];return this._forEachCell(t,e,n,i,this._queryCell,h,{},s),h},Is.prototype._queryCell=function(t,e,n,i,s,l,u,h){var f=this.cells[s];if(f!==null)for(var m=this.keys,y=this.bboxes,v=0;v<f.length;v++){var w=f[v];if(u[w]===void 0){var S=4*w;(h?h(y[S+0],y[S+1],y[S+2],y[S+3]):t<=y[S+2]&&e<=y[S+3]&&n>=y[S+0]&&i>=y[S+1])?(u[w]=!0,l.push(m[w])):u[w]=!1}}},Is.prototype._forEachCell=function(t,e,n,i,s,l,u,h){for(var f=this._convertToCellCoord(t),m=this._convertToCellCoord(e),y=this._convertToCellCoord(n),v=this._convertToCellCoord(i),w=f;w<=y;w++)for(var S=m;S<=v;S++){var E=this.d*S+w;if((!h||h(this._convertFromCellCoord(w),this._convertFromCellCoord(S),this._convertFromCellCoord(w+1),this._convertFromCellCoord(S+1)))&&s.call(this,t,e,n,i,E,l,u,h))return}},Is.prototype._convertFromCellCoord=function(t){return(t-this.padding)/this.scale},Is.prototype._convertToCellCoord=function(t){return Math.max(0,Math.min(this.d-1,Math.floor(t*this.scale)+this.padding))},Is.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var t=this.cells,e=pa+this.cells.length+1+1,n=0,i=0;i<this.cells.length;i++)n+=this.cells[i].length;var s=new Int32Array(e+n+this.keys.length+this.bboxes.length);s[0]=this.extent,s[1]=this.n,s[2]=this.padding;for(var l=e,u=0;u<t.length;u++){var h=t[u];s[pa+u]=l,s.set(h,l),l+=h.length}return s[pa+t.length]=l,s.set(this.keys,l),s[pa+t.length+1]=l+=this.keys.length,s.set(this.bboxes,l),l+=this.bboxes.length,s.buffer};var rl=ee(kp);const Kc={};function kt(t,e,n={}){Object.defineProperty(t,"_classRegistryKey",{value:e,writeable:!1}),Kc[e]={klass:t,omit:n.omit||[]}}kt(Object,"Object"),rl.serialize=function(t,e){const n=t.toArrayBuffer();return e&&e.push(n),{buffer:n}},rl.deserialize=function(t){return new rl(t.buffer)},Object.defineProperty(rl,"name",{value:"Grid"}),kt(rl,"Grid"),kt(wn,"Color"),kt(Error,"Error"),kt(je,"AJAXError"),kt(Do,"ResolvedImage"),kt(Hc,"StylePropertyFunction"),kt(Oo,"StyleExpression",{omit:["_evaluator"]}),kt(Ld,"ZoomDependentExpression"),kt(ls,"ZoomConstantExpression"),kt(Ws,"CompoundExpression",{omit:["_evaluate"]});for(const t in $c)Kc[$c[t]._classRegistryKey]||kt($c[t],`Expression${t}`);function hi(t){return t&&typeof ArrayBuffer<"u"&&(t instanceof ArrayBuffer||t.constructor&&t.constructor.name==="ArrayBuffer")}function ji(t){return C.ImageBitmap&&t instanceof C.ImageBitmap}function _i(t,e){if(t==null||typeof t=="boolean"||typeof t=="number"||typeof t=="string"||t instanceof Boolean||t instanceof Number||t instanceof String||t instanceof Date||t instanceof RegExp)return t;if(hi(t)||ji(t))return e&&e.push(t),t;if(ArrayBuffer.isView(t)){const n=t;return e&&e.push(n.buffer),n}if(t instanceof C.ImageData)return e&&e.push(t.data.buffer),t;if(Array.isArray(t)){const n=[];for(const i of t)n.push(_i(i,e));return n}if(t instanceof Map){const n={$name:"Map"};for(const[i,s]of t.entries())n[i]=_i(s);return n}if(typeof t=="object"){const n=t.constructor,i=n._classRegistryKey;if(!i)throw new Error(`can't serialize object of unregistered class ${i}`);const s=n.serialize?n.serialize(t,e):{};if(!n.serialize){for(const l in t)t.hasOwnProperty(l)&&(Kc[i].omit.indexOf(l)>=0||(s[l]=_i(t[l],e)));t instanceof Error&&(s.message=t.message)}if(s.$name)throw new Error("$name property is reserved for worker serialization logic.");return i!=="Object"&&(s.$name=i),s}throw new Error("can't serialize object of type "+typeof t)}function il(t){if(t==null||typeof t=="boolean"||typeof t=="number"||typeof t=="string"||t instanceof Boolean||t instanceof Number||t instanceof String||t instanceof Date||t instanceof RegExp||hi(t)||ji(t)||ArrayBuffer.isView(t)||t instanceof C.ImageData)return t;if(Array.isArray(t))return t.map(il);if(typeof t=="object"){const e=t.$name||"Object";if(e==="Map"){const s=new Map;for(const l of Object.keys(t))l!=="$name"&&s.set(l,il(t[l]));return s}const{klass:n}=Kc[e];if(!n)throw new Error(`can't deserialize unregistered class ${e}`);if(n.deserialize)return n.deserialize(t);const i=Object.create(n.prototype);for(const s of Object.keys(t))s!=="$name"&&(i[s]=il(t[s]));return i}throw new Error("can't deserialize object of type "+typeof t)}const Ft={"Latin-1 Supplement":t=>t>=128&&t<=255,Arabic:t=>t>=1536&&t<=1791,"Arabic Supplement":t=>t>=1872&&t<=1919,"Arabic Extended-A":t=>t>=2208&&t<=2303,"Hangul Jamo":t=>t>=4352&&t<=4607,"Unified Canadian Aboriginal Syllabics":t=>t>=5120&&t<=5759,Khmer:t=>t>=6016&&t<=6143,"Unified Canadian Aboriginal Syllabics Extended":t=>t>=6320&&t<=6399,"General Punctuation":t=>t>=8192&&t<=8303,"Letterlike Symbols":t=>t>=8448&&t<=8527,"Number Forms":t=>t>=8528&&t<=8591,"Miscellaneous Technical":t=>t>=8960&&t<=9215,"Control Pictures":t=>t>=9216&&t<=9279,"Optical Character Recognition":t=>t>=9280&&t<=9311,"Enclosed Alphanumerics":t=>t>=9312&&t<=9471,"Geometric Shapes":t=>t>=9632&&t<=9727,"Miscellaneous Symbols":t=>t>=9728&&t<=9983,"Miscellaneous Symbols and Arrows":t=>t>=11008&&t<=11263,"CJK Radicals Supplement":t=>t>=11904&&t<=12031,"Kangxi Radicals":t=>t>=12032&&t<=12255,"Ideographic Description Characters":t=>t>=12272&&t<=12287,"CJK Symbols and Punctuation":t=>t>=12288&&t<=12351,Hiragana:t=>t>=12352&&t<=12447,Katakana:t=>t>=12448&&t<=12543,Bopomofo:t=>t>=12544&&t<=12591,"Hangul Compatibility Jamo":t=>t>=12592&&t<=12687,Kanbun:t=>t>=12688&&t<=12703,"Bopomofo Extended":t=>t>=12704&&t<=12735,"CJK Strokes":t=>t>=12736&&t<=12783,"Katakana Phonetic Extensions":t=>t>=12784&&t<=12799,"Enclosed CJK Letters and Months":t=>t>=12800&&t<=13055,"CJK Compatibility":t=>t>=13056&&t<=13311,"CJK Unified Ideographs Extension A":t=>t>=13312&&t<=19903,"Yijing Hexagram Symbols":t=>t>=19904&&t<=19967,"CJK Unified Ideographs":t=>t>=19968&&t<=40959,"Yi Syllables":t=>t>=40960&&t<=42127,"Yi Radicals":t=>t>=42128&&t<=42191,"Hangul Jamo Extended-A":t=>t>=43360&&t<=43391,"Hangul Syllables":t=>t>=44032&&t<=55215,"Hangul Jamo Extended-B":t=>t>=55216&&t<=55295,"Private Use Area":t=>t>=57344&&t<=63743,"CJK Compatibility Ideographs":t=>t>=63744&&t<=64255,"Arabic Presentation Forms-A":t=>t>=64336&&t<=65023,"Vertical Forms":t=>t>=65040&&t<=65055,"CJK Compatibility Forms":t=>t>=65072&&t<=65103,"Small Form Variants":t=>t>=65104&&t<=65135,"Arabic Presentation Forms-B":t=>t>=65136&&t<=65279,"Halfwidth and Fullwidth Forms":t=>t>=65280&&t<=65519,"CJK Unified Ideographs Extension B":t=>t>=131072&&t<=173791};function Hu(t){for(const e of t)if(Vd(e.charCodeAt(0)))return!0;return!1}function X2(t){for(const e of t)if(!vo(e.charCodeAt(0)))return!1;return!0}function vo(t){return!(Ft.Arabic(t)||Ft["Arabic Supplement"](t)||Ft["Arabic Extended-A"](t)||Ft["Arabic Presentation Forms-A"](t)||Ft["Arabic Presentation Forms-B"](t))}function Vd(t){return!(t!==746&&t!==747&&(t<4352||!(Ft["Bopomofo Extended"](t)||Ft.Bopomofo(t)||Ft["CJK Compatibility Forms"](t)&&!(t>=65097&&t<=65103)||Ft["CJK Compatibility Ideographs"](t)||Ft["CJK Compatibility"](t)||Ft["CJK Radicals Supplement"](t)||Ft["CJK Strokes"](t)||!(!Ft["CJK Symbols and Punctuation"](t)||t>=12296&&t<=12305||t>=12308&&t<=12319||t===12336)||Ft["CJK Unified Ideographs Extension A"](t)||Ft["CJK Unified Ideographs"](t)||Ft["Enclosed CJK Letters and Months"](t)||Ft["Hangul Compatibility Jamo"](t)||Ft["Hangul Jamo Extended-A"](t)||Ft["Hangul Jamo Extended-B"](t)||Ft["Hangul Jamo"](t)||Ft["Hangul Syllables"](t)||Ft.Hiragana(t)||Ft["Ideographic Description Characters"](t)||Ft.Kanbun(t)||Ft["Kangxi Radicals"](t)||Ft["Katakana Phonetic Extensions"](t)||Ft.Katakana(t)&&t!==12540||!(!Ft["Halfwidth and Fullwidth Forms"](t)||t===65288||t===65289||t===65293||t>=65306&&t<=65310||t===65339||t===65341||t===65343||t>=65371&&t<=65503||t===65507||t>=65512&&t<=65519)||!(!Ft["Small Form Variants"](t)||t>=65112&&t<=65118||t>=65123&&t<=65126)||Ft["Unified Canadian Aboriginal Syllabics"](t)||Ft["Unified Canadian Aboriginal Syllabics Extended"](t)||Ft["Vertical Forms"](t)||Ft["Yijing Hexagram Symbols"](t)||Ft["Yi Syllables"](t)||Ft["Yi Radicals"](t))))}function Pp(t){return!(Vd(t)||function(e){return!!(Ft["Latin-1 Supplement"](e)&&(e===167||e===169||e===174||e===177||e===188||e===189||e===190||e===215||e===247)||Ft["General Punctuation"](e)&&(e===8214||e===8224||e===8225||e===8240||e===8241||e===8251||e===8252||e===8258||e===8263||e===8264||e===8265||e===8273)||Ft["Letterlike Symbols"](e)||Ft["Number Forms"](e)||Ft["Miscellaneous Technical"](e)&&(e>=8960&&e<=8967||e>=8972&&e<=8991||e>=8996&&e<=9e3||e===9003||e>=9085&&e<=9114||e>=9150&&e<=9165||e===9167||e>=9169&&e<=9179||e>=9186&&e<=9215)||Ft["Control Pictures"](e)&&e!==9251||Ft["Optical Character Recognition"](e)||Ft["Enclosed Alphanumerics"](e)||Ft["Geometric Shapes"](e)||Ft["Miscellaneous Symbols"](e)&&!(e>=9754&&e<=9759)||Ft["Miscellaneous Symbols and Arrows"](e)&&(e>=11026&&e<=11055||e>=11088&&e<=11097||e>=11192&&e<=11243)||Ft["CJK Symbols and Punctuation"](e)||Ft.Katakana(e)||Ft["Private Use Area"](e)||Ft["CJK Compatibility Forms"](e)||Ft["Small Form Variants"](e)||Ft["Halfwidth and Fullwidth Forms"](e)||e===8734||e===8756||e===8757||e>=9984&&e<=10087||e>=10102&&e<=10131||e===65532||e===65533)}(t))}function Rp(t){return t>=1424&&t<=2303||Ft["Arabic Presentation Forms-A"](t)||Ft["Arabic Presentation Forms-B"](t)}function ma(t,e){return!(!e&&Rp(t)||t>=2304&&t<=3583||t>=3840&&t<=4255||Ft.Khmer(t))}function ks(t){for(const e of t)if(Rp(e.charCodeAt(0)))return!0;return!1}const qu="deferred",$d="loading",Gd="loaded";let Dp=null,Fo="unavailable",ol=null;const By=function(t){t&&typeof t=="string"&&t.indexOf("NetworkError")>-1&&(Fo="error"),Dp&&Dp(t)};function Lp(){Op.fire(new ct("pluginStateChange",{pluginStatus:Fo,pluginURL:ol}))}const Op=new Cr,zp=function(){return Fo},Ny=function(){if(Fo!==qu||!ol)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");Fo=$d,Lp(),ol&&at({url:ol},t=>{t?By(t):(Fo=Gd,Lp())})},xo={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>Fo===Gd||xo.applyArabicShaping!=null,isLoading:()=>Fo===$d,setState(t){Fo=t.pluginStatus,ol=t.pluginURL},isParsed:()=>xo.applyArabicShaping!=null&&xo.processBidirectionalText!=null&&xo.processStyledBidirectionalText!=null,getPluginURL:()=>ol};class Nr{constructor(e,n){this.zoom=e,n?(this.now=n.now,this.fadeDuration=n.fadeDuration,this.transition=n.transition,this.pitch=n.pitch,this.brightness=n.brightness):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0,this.brightness=0)}isSupportedScript(e){return function(n,i){for(const s of n)if(!ma(s.charCodeAt(0),i))return!1;return!0}(e,xo.isLoaded())}}class Wu{constructor(e,n,i){this.property=e,this.value=n,this.expression=function(s,l,u){if(Lo(s))return new Hc(s,l);if(_o(s)||Array.isArray(s)&&s.length>0){const h=Sp(s,l,u);if(h.result==="error")throw new Error(h.value.map(f=>`${f.key}: ${f.message}`).join(", "));return h.value}{let h=s;return typeof s=="string"&&l.type==="color"&&(h=wn.parse(s)),{kind:"constant",isConfigDependent:!1,evaluate:()=>h}}}(n===void 0?e.specification.default:n,e.specification,i)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(e,n,i){return this.property.possiblyEvaluate(this,e,n,i)}}class Yc{constructor(e,n){this.property=e,this.value=new Wu(e,void 0,n)}transitioned(e,n){return new Fp(this.property,this.value,n,ge({},e.transition,this.transition),e.now)}untransitioned(){return new Fp(this.property,this.value,null,{},0)}}class Qc{constructor(e,n){this._properties=e,this._values=Object.create(e.defaultTransitionablePropertyValues),this._options=n,this.isConfigDependent=!1}getValue(e){return te(this._values[e].value.value)}setValue(e,n){this._values.hasOwnProperty(e)||(this._values[e]=new Yc(this._values[e].property,this._options)),this._values[e].value=new Wu(this._values[e].property,n===null?void 0:te(n),this._options),this.isConfigDependent=this.isConfigDependent||this._values[e].value.expression.isConfigDependent}setTransitionOrValue(e){if(e)for(const n in e){const i=e[n];Br(n,"-transition")?this.setTransition(n.slice(0,-11),i):this.setValue(n,i)}}getTransition(e){return te(this._values[e].transition)}setTransition(e,n){this._values.hasOwnProperty(e)||(this._values[e]=new Yc(this._values[e].property)),this._values[e].transition=te(n)||void 0}serialize(){const e={};for(const n of Object.keys(this._values)){const i=this.getValue(n);i!==void 0&&(e[n]=i);const s=this.getTransition(n);s!==void 0&&(e[`${n}-transition`]=s)}return e}transitioned(e,n){const i=new jy(this._properties);for(const s of Object.keys(this._values))i._values[s]=this._values[s].transitioned(e,n._values[s]);return i}untransitioned(){const e=new jy(this._properties);for(const n of Object.keys(this._values))e._values[n]=this._values[n].untransitioned();return e}}class Fp{constructor(e,n,i,s,l){const u=s.delay||0,h=s.duration||0;l=l||0,this.property=e,this.value=n,this.begin=l+u,this.end=this.begin+h,e.specification.transition&&(s.delay||s.duration)&&(this.prior=i)}possiblyEvaluate(e,n,i){const s=e.now||0,l=this.value.possiblyEvaluate(e,n,i),u=this.prior;if(u){if(s>this.end)return this.prior=null,l;if(this.value.isDataDriven())return this.prior=null,l;if(s<this.begin)return u.possiblyEvaluate(e,n,i);{const h=(s-this.begin)/(this.end-this.begin);return this.property.interpolate(u.possiblyEvaluate(e,n,i),l,zt(h))}}return l}}class jy{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitioningPropertyValues)}possiblyEvaluate(e,n,i){const s=new Hd(this._properties);for(const l of Object.keys(this._values))s._values[l]=this._values[l].possiblyEvaluate(e,n,i);return s}hasTransition(){for(const e of Object.keys(this._values))if(this._values[e].prior)return!0;return!1}}class Jv{constructor(e,n){this._properties=e,this._values=Object.create(e.defaultPropertyValues),this._options=n,this.isConfigDependent=!1}getValue(e){return te(this._values[e].value)}setValue(e,n){this._values[e]=new Wu(this._values[e].property,n===null?void 0:te(n),this._options),this.isConfigDependent=this.isConfigDependent||this._values[e].expression.isConfigDependent}serialize(){const e={};for(const n of Object.keys(this._values)){const i=this.getValue(n);i!==void 0&&(e[n]=i)}return e}possiblyEvaluate(e,n,i){const s=new Hd(this._properties);for(const l of Object.keys(this._values))s._values[l]=this._values[l].possiblyEvaluate(e,n,i);return s}}class Zu{constructor(e,n,i){this.property=e,this.value=n,this.parameters=i}isConstant(){return this.value.kind==="constant"}constantOr(e){return this.value.kind==="constant"?this.value.value:e}evaluate(e,n,i,s){return this.property.evaluate(this.value,this.parameters,e,n,i,s)}}class Hd{constructor(e){this._properties=e,this._values=Object.create(e.defaultPossiblyEvaluatedValues)}get(e){return this._values[e]}}class gt{constructor(e){this.specification=e}possiblyEvaluate(e,n){return e.expression.evaluate(n)}interpolate(e,n,i){const s=Ed[this.specification.type];return s?s(e,n,i):e}}class qt{constructor(e,n){this.specification=e,this.overrides=n}possiblyEvaluate(e,n,i,s){return new Zu(this,e.expression.kind==="constant"||e.expression.kind==="camera"?{kind:"constant",value:e.expression.evaluate(n,null,{},i,s)}:e.expression,n)}interpolate(e,n,i){if(e.value.kind!=="constant"||n.value.kind!=="constant")return e;if(e.value.value===void 0||n.value.value===void 0)return new Zu(this,{kind:"constant",value:void 0},e.parameters);const s=Ed[this.specification.type];return s?new Zu(this,{kind:"constant",value:s(e.value.value,n.value.value,i)},e.parameters):e}evaluate(e,n,i,s,l,u){return e.kind==="constant"?e.value:e.evaluate(n,i,s,l,u)}}class Jc{constructor(e){this.specification=e}possiblyEvaluate(e,n,i,s){return!!e.expression.evaluate(n,null,{},i,s)}interpolate(){return!1}}class jr{constructor(e){this.properties=e,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const n=new Nr(0,{});for(const i in e){const s=e[i];s.specification.overridable&&this.overridableProperties.push(i);const l=this.defaultPropertyValues[i]=new Wu(s,void 0),u=this.defaultTransitionablePropertyValues[i]=new Yc(s);this.defaultTransitioningPropertyValues[i]=u.untransitioned(),this.defaultPossiblyEvaluatedValues[i]=l.possiblyEvaluate(n)}}}function e1(t,e){return 256*(t=ce(Math.floor(t),0,255))+ce(Math.floor(e),0,255)}kt(qt,"DataDrivenProperty"),kt(gt,"DataConstantProperty"),kt(Jc,"ColorRampProperty");const t1={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Bp{constructor(e,n){this._structArray=e,this._pos1=n*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Ur{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(e,n){return e._trim(),n&&(e.isTransferred=!0,n.push(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}}static deserialize(e){const n=Object.create(this.prototype);return n.arrayBuffer=e.arrayBuffer,n.length=e.length,n.capacity=e.arrayBuffer.byteLength/n.bytesPerElement,n._refreshViews(),n}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(e){this.reserve(e),this.length=e}reserve(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const n=this.uint8;this._refreshViews(),n&&this.uint8.set(n)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function Kn(t,e=1){let n=0,i=0;return{members:t.map(s=>{const l=t1[s.type].BYTES_PER_ELEMENT,u=n=Uy(n,Math.max(e,l)),h=s.components||1;return i=Math.max(i,l),n+=l*h,{name:s.name,type:s.type,components:h,offset:u}}),size:Uy(n,Math.max(i,e)),alignment:e}}function Uy(t,e){return Math.ceil(t/e)*e}class Bo extends Ur{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,n){const i=this.length;return this.resize(i+1),this.emplace(i,e,n)}emplace(e,n,i){const s=2*e;return this.int16[s+0]=n,this.int16[s+1]=i,e}}Bo.prototype.bytesPerElement=4,kt(Bo,"StructArrayLayout2i4");class Xu extends Ur{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,n,i){const s=this.length;return this.resize(s+1),this.emplace(s,e,n,i)}emplace(e,n,i,s){const l=3*e;return this.int16[l+0]=n,this.int16[l+1]=i,this.int16[l+2]=s,e}}Xu.prototype.bytesPerElement=6,kt(Xu,"StructArrayLayout3i6");class ql extends Ur{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,n,i,s){const l=this.length;return this.resize(l+1),this.emplace(l,e,n,i,s)}emplace(e,n,i,s,l){const u=4*e;return this.int16[u+0]=n,this.int16[u+1]=i,this.int16[u+2]=s,this.int16[u+3]=l,e}}ql.prototype.bytesPerElement=8,kt(ql,"StructArrayLayout4i8");class Vy extends Ur{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,i,s,l,u,h){const f=this.length;return this.resize(f+1),this.emplace(f,e,n,i,s,l,u,h)}emplace(e,n,i,s,l,u,h,f){const m=6*e,y=12*e,v=3*e;return this.int16[m+0]=n,this.int16[m+1]=i,this.uint8[y+4]=s,this.uint8[y+5]=l,this.uint8[y+6]=u,this.uint8[y+7]=h,this.float32[v+2]=f,e}}Vy.prototype.bytesPerElement=12,kt(Vy,"StructArrayLayout2i4ub1f12");class Wl extends Ur{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,i,s){const l=this.length;return this.resize(l+1),this.emplace(l,e,n,i,s)}emplace(e,n,i,s,l){const u=4*e;return this.float32[u+0]=n,this.float32[u+1]=i,this.float32[u+2]=s,this.float32[u+3]=l,e}}Wl.prototype.bytesPerElement=16,kt(Wl,"StructArrayLayout4f16");class hs extends Ur{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,i,s,l){const u=this.length;return this.resize(u+1),this.emplace(u,e,n,i,s,l)}emplace(e,n,i,s,l,u){const h=6*e,f=3*e;return this.uint16[h+0]=n,this.uint16[h+1]=i,this.uint16[h+2]=s,this.uint16[h+3]=l,this.float32[f+2]=u,e}}hs.prototype.bytesPerElement=12,kt(hs,"StructArrayLayout4ui1f12");class eh extends Ur{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,n,i,s){const l=this.length;return this.resize(l+1),this.emplace(l,e,n,i,s)}emplace(e,n,i,s,l){const u=4*e;return this.uint16[u+0]=n,this.uint16[u+1]=i,this.uint16[u+2]=s,this.uint16[u+3]=l,e}}eh.prototype.bytesPerElement=8,kt(eh,"StructArrayLayout4ui8");class th extends Ur{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,n,i,s,l,u){const h=this.length;return this.resize(h+1),this.emplace(h,e,n,i,s,l,u)}emplace(e,n,i,s,l,u,h){const f=6*e;return this.int16[f+0]=n,this.int16[f+1]=i,this.int16[f+2]=s,this.int16[f+3]=l,this.int16[f+4]=u,this.int16[f+5]=h,e}}th.prototype.bytesPerElement=12,kt(th,"StructArrayLayout6i12");class $y extends Ur{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,n,i,s,l,u,h,f,m,y,v,w){const S=this.length;return this.resize(S+1),this.emplace(S,e,n,i,s,l,u,h,f,m,y,v,w)}emplace(e,n,i,s,l,u,h,f,m,y,v,w,S){const E=12*e;return this.int16[E+0]=n,this.int16[E+1]=i,this.int16[E+2]=s,this.int16[E+3]=l,this.uint16[E+4]=u,this.uint16[E+5]=h,this.uint16[E+6]=f,this.uint16[E+7]=m,this.int16[E+8]=y,this.int16[E+9]=v,this.int16[E+10]=w,this.int16[E+11]=S,e}}$y.prototype.bytesPerElement=24,kt($y,"StructArrayLayout4i4ui4i24");class Np extends Ur{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,i,s,l,u){const h=this.length;return this.resize(h+1),this.emplace(h,e,n,i,s,l,u)}emplace(e,n,i,s,l,u,h){const f=10*e,m=5*e;return this.int16[f+0]=n,this.int16[f+1]=i,this.int16[f+2]=s,this.float32[m+2]=l,this.float32[m+3]=u,this.float32[m+4]=h,e}}Np.prototype.bytesPerElement=20,kt(Np,"StructArrayLayout3i3f20");class jp extends Ur{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e){const n=this.length;return this.resize(n+1),this.emplace(n,e)}emplace(e,n){return this.uint32[1*e+0]=n,e}}jp.prototype.bytesPerElement=4,kt(jp,"StructArrayLayout1ul4");class sl extends Ur{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,n){const i=this.length;return this.resize(i+1),this.emplace(i,e,n)}emplace(e,n,i){const s=2*e;return this.uint16[s+0]=n,this.uint16[s+1]=i,e}}sl.prototype.bytesPerElement=4,kt(sl,"StructArrayLayout2ui4");class Up extends Ur{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,n,i,s,l,u,h,f,m,y,v,w,S){const E=this.length;return this.resize(E+1),this.emplace(E,e,n,i,s,l,u,h,f,m,y,v,w,S)}emplace(e,n,i,s,l,u,h,f,m,y,v,w,S,E){const A=20*e,M=10*e;return this.int16[A+0]=n,this.int16[A+1]=i,this.int16[A+2]=s,this.int16[A+3]=l,this.int16[A+4]=u,this.float32[M+3]=h,this.float32[M+4]=f,this.float32[M+5]=m,this.float32[M+6]=y,this.int16[A+14]=v,this.uint32[M+8]=w,this.uint16[A+18]=S,this.uint16[A+19]=E,e}}Up.prototype.bytesPerElement=40,kt(Up,"StructArrayLayout5i4f1i1ul2ui40");class qd extends Ur{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,n,i,s,l,u,h){const f=this.length;return this.resize(f+1),this.emplace(f,e,n,i,s,l,u,h)}emplace(e,n,i,s,l,u,h,f){const m=8*e;return this.int16[m+0]=n,this.int16[m+1]=i,this.int16[m+2]=s,this.int16[m+4]=l,this.int16[m+5]=u,this.int16[m+6]=h,this.int16[m+7]=f,e}}qd.prototype.bytesPerElement=16,kt(qd,"StructArrayLayout3i2i2i16");class Gy extends Ur{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,n,i,s,l){const u=this.length;return this.resize(u+1),this.emplace(u,e,n,i,s,l)}emplace(e,n,i,s,l,u){const h=4*e,f=8*e;return this.float32[h+0]=n,this.float32[h+1]=i,this.float32[h+2]=s,this.int16[f+6]=l,this.int16[f+7]=u,e}}Gy.prototype.bytesPerElement=16,kt(Gy,"StructArrayLayout2f1f2i16");class wo extends Ur{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,i,s){const l=this.length;return this.resize(l+1),this.emplace(l,e,n,i,s)}emplace(e,n,i,s,l){const u=12*e,h=3*e;return this.uint8[u+0]=n,this.uint8[u+1]=i,this.float32[h+1]=s,this.float32[h+2]=l,e}}wo.prototype.bytesPerElement=12,kt(wo,"StructArrayLayout2ub2f12");class Ei extends Ur{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,i){const s=this.length;return this.resize(s+1),this.emplace(s,e,n,i)}emplace(e,n,i,s){const l=3*e;return this.float32[l+0]=n,this.float32[l+1]=i,this.float32[l+2]=s,e}}Ei.prototype.bytesPerElement=12,kt(Ei,"StructArrayLayout3f12");class di extends Ur{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,n,i){const s=this.length;return this.resize(s+1),this.emplace(s,e,n,i)}emplace(e,n,i,s){const l=3*e;return this.uint16[l+0]=n,this.uint16[l+1]=i,this.uint16[l+2]=s,e}}di.prototype.bytesPerElement=6,kt(di,"StructArrayLayout3ui6");class Vp extends Ur{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e,n,i,s,l,u,h,f,m,y,v,w,S,E,A,M,k,R,L,z,B){const j=this.length;return this.resize(j+1),this.emplace(j,e,n,i,s,l,u,h,f,m,y,v,w,S,E,A,M,k,R,L,z,B)}emplace(e,n,i,s,l,u,h,f,m,y,v,w,S,E,A,M,k,R,L,z,B,j){const V=30*e,Y=15*e,ne=60*e;return this.int16[V+0]=n,this.int16[V+1]=i,this.int16[V+2]=s,this.float32[Y+2]=l,this.float32[Y+3]=u,this.uint16[V+8]=h,this.uint16[V+9]=f,this.uint32[Y+5]=m,this.uint32[Y+6]=y,this.uint32[Y+7]=v,this.uint16[V+16]=w,this.uint16[V+17]=S,this.uint16[V+18]=E,this.float32[Y+10]=A,this.float32[Y+11]=M,this.uint8[ne+48]=k,this.uint8[ne+49]=R,this.uint8[ne+50]=L,this.uint32[Y+13]=z,this.int16[V+28]=B,this.uint8[ne+58]=j,e}}Vp.prototype.bytesPerElement=60,kt(Vp,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class $p extends Ur{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e,n,i,s,l,u,h,f,m,y,v,w,S,E,A,M,k,R,L,z,B,j,V,Y,ne,re,J,ae,le,oe,Ee){const xe=this.length;return this.resize(xe+1),this.emplace(xe,e,n,i,s,l,u,h,f,m,y,v,w,S,E,A,M,k,R,L,z,B,j,V,Y,ne,re,J,ae,le,oe,Ee)}emplace(e,n,i,s,l,u,h,f,m,y,v,w,S,E,A,M,k,R,L,z,B,j,V,Y,ne,re,J,ae,le,oe,Ee,xe){const Pe=40*e,pe=20*e,Ae=80*e;return this.int16[Pe+0]=n,this.int16[Pe+1]=i,this.int16[Pe+2]=s,this.float32[pe+2]=l,this.float32[pe+3]=u,this.int16[Pe+8]=h,this.int16[Pe+9]=f,this.int16[Pe+10]=m,this.int16[Pe+11]=y,this.int16[Pe+12]=v,this.int16[Pe+13]=w,this.uint16[Pe+14]=S,this.uint16[Pe+15]=E,this.uint16[Pe+16]=A,this.uint16[Pe+17]=M,this.uint16[Pe+18]=k,this.uint16[Pe+19]=R,this.uint16[Pe+20]=L,this.uint16[Pe+21]=z,this.uint16[Pe+22]=B,this.uint16[Pe+23]=j,this.uint16[Pe+24]=V,this.uint16[Pe+25]=Y,this.uint16[Pe+26]=ne,this.uint16[Pe+27]=re,this.uint16[Pe+28]=J,this.uint32[pe+15]=ae,this.float32[pe+16]=le,this.float32[pe+17]=oe,this.float32[pe+18]=Ee,this.uint8[Ae+76]=xe,e}}$p.prototype.bytesPerElement=80,kt($p,"StructArrayLayout3i2f6i15ui1ul3f1ub80");class Wd extends Ur{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e){const n=this.length;return this.resize(n+1),this.emplace(n,e)}emplace(e,n){return this.float32[1*e+0]=n,e}}Wd.prototype.bytesPerElement=4,kt(Wd,"StructArrayLayout1f4");class nh extends Ur{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,i,s,l){const u=this.length;return this.resize(u+1),this.emplace(u,e,n,i,s,l)}emplace(e,n,i,s,l,u){const h=5*e;return this.float32[h+0]=n,this.float32[h+1]=i,this.float32[h+2]=s,this.float32[h+3]=l,this.float32[h+4]=u,e}}nh.prototype.bytesPerElement=20,kt(nh,"StructArrayLayout5f20");class Zd extends Ur{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,i,s,l,u,h){const f=this.length;return this.resize(f+1),this.emplace(f,e,n,i,s,l,u,h)}emplace(e,n,i,s,l,u,h,f){const m=7*e;return this.float32[m+0]=n,this.float32[m+1]=i,this.float32[m+2]=s,this.float32[m+3]=l,this.float32[m+4]=u,this.float32[m+5]=h,this.float32[m+6]=f,e}}Zd.prototype.bytesPerElement=28,kt(Zd,"StructArrayLayout7f28");class Gp extends Ur{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,n,i,s){const l=this.length;return this.resize(l+1),this.emplace(l,e,n,i,s)}emplace(e,n,i,s,l){const u=6*e;return this.uint32[3*e+0]=n,this.uint16[u+2]=i,this.uint16[u+3]=s,this.uint16[u+4]=l,e}}Gp.prototype.bytesPerElement=12,kt(Gp,"StructArrayLayout1ul3ui12");class Ku extends Ur{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e){const n=this.length;return this.resize(n+1),this.emplace(n,e)}emplace(e,n){return this.uint16[1*e+0]=n,e}}Ku.prototype.bytesPerElement=2,kt(Ku,"StructArrayLayout1ui2");class rh extends Ur{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n){const i=this.length;return this.resize(i+1),this.emplace(i,e,n)}emplace(e,n,i){const s=2*e;return this.float32[s+0]=n,this.float32[s+1]=i,e}}rh.prototype.bytesPerElement=8,kt(rh,"StructArrayLayout2f8");class Hp extends Ur{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,i,s,l,u,h,f,m,y,v,w,S,E,A,M){const k=this.length;return this.resize(k+1),this.emplace(k,e,n,i,s,l,u,h,f,m,y,v,w,S,E,A,M)}emplace(e,n,i,s,l,u,h,f,m,y,v,w,S,E,A,M,k){const R=16*e;return this.float32[R+0]=n,this.float32[R+1]=i,this.float32[R+2]=s,this.float32[R+3]=l,this.float32[R+4]=u,this.float32[R+5]=h,this.float32[R+6]=f,this.float32[R+7]=m,this.float32[R+8]=y,this.float32[R+9]=v,this.float32[R+10]=w,this.float32[R+11]=S,this.float32[R+12]=E,this.float32[R+13]=A,this.float32[R+14]=M,this.float32[R+15]=k,e}}Hp.prototype.bytesPerElement=64,kt(Hp,"StructArrayLayout16f64");class ih extends Ur{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,i,s,l,u,h){const f=this.length;return this.resize(f+1),this.emplace(f,e,n,i,s,l,u,h)}emplace(e,n,i,s,l,u,h,f){const m=10*e,y=5*e;return this.uint16[m+0]=n,this.uint16[m+1]=i,this.uint16[m+2]=s,this.uint16[m+3]=l,this.float32[y+2]=u,this.float32[y+3]=h,this.float32[y+4]=f,e}}ih.prototype.bytesPerElement=20,kt(ih,"StructArrayLayout4ui3f20");class Xd extends Ur{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer)}emplaceBack(e){const n=this.length;return this.resize(n+1),this.emplace(n,e)}emplace(e,n){return this.uint8[1*e+0]=n,e}}Xd.prototype.bytesPerElement=1,kt(Xd,"StructArrayLayout1ub1");class Hy extends Bp{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}Hy.prototype.size=40;class Kd extends Up{get(e){return new Hy(this,e)}}kt(Kd,"CollisionBoxArray");class Yd extends Bp{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(e){this._structArray.uint8[this._pos1+49]=e}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(e){this._structArray.uint8[this._pos1+50]=e}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(e){this._structArray.uint32[this._pos4+13]=e}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(e){this._structArray.uint8[this._pos1+58]=e}}Yd.prototype.size=60;class n1 extends Vp{get(e){return new Yd(this,e)}}kt(n1,"PlacedSymbolArray");class qy extends Bp{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+11]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+13]}get key(){return this._structArray.uint16[this._pos2+14]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+17]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+19]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+21]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+22]}get featureIndex(){return this._structArray.uint16[this._pos2+23]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+25]}get numIconVertices(){return this._structArray.uint16[this._pos2+26]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+27]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+28]}get crossTileID(){return this._structArray.uint32[this._pos4+15]}set crossTileID(e){this._structArray.uint32[this._pos4+15]=e}get textOffset0(){return this._structArray.float32[this._pos4+16]}get textOffset1(){return this._structArray.float32[this._pos4+17]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+18]}get hasIconTextFit(){return this._structArray.uint8[this._pos1+76]}}qy.prototype.size=80;class qp extends $p{get(e){return new qy(this,e)}}kt(qp,"SymbolInstanceArray");class Wy extends Wd{getoffsetX(e){return this.float32[1*e+0]}}kt(Wy,"GlyphOffsetArray");class Qd extends Bo{getx(e){return this.int16[2*e+0]}gety(e){return this.int16[2*e+1]}}kt(Qd,"SymbolLineVertexArray");class ga extends Bp{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}ga.prototype.size=12;class r1 extends Gp{get(e){return new ga(this,e)}}kt(r1,"FeatureIndexArray");class Zy extends sl{geta_centroid_pos0(e){return this.uint16[2*e+0]}geta_centroid_pos1(e){return this.uint16[2*e+1]}}kt(Zy,"FillExtrusionCentroidArray");const Xy=Kn([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),i1=Kn([{name:"a_dash",components:4,type:"Uint16"}]);var Jd={exports:{}},oh={exports:{}};(function(t){t.exports=function(e,n){var i,s,l,u,h,f,m,y;for(s=e.length-(i=3&e.length),l=n,h=3432918353,f=461845907,y=0;y<s;)m=255&e.charCodeAt(y)|(255&e.charCodeAt(++y))<<8|(255&e.charCodeAt(++y))<<16|(255&e.charCodeAt(++y))<<24,++y,l=27492+(65535&(u=5*(65535&(l=(l^=m=(65535&(m=(m=(65535&m)*h+(((m>>>16)*h&65535)<<16)&4294967295)<<15|m>>>17))*f+(((m>>>16)*f&65535)<<16)&4294967295)<<13|l>>>19))+((5*(l>>>16)&65535)<<16)&4294967295))+((58964+(u>>>16)&65535)<<16);switch(m=0,i){case 3:m^=(255&e.charCodeAt(y+2))<<16;case 2:m^=(255&e.charCodeAt(y+1))<<8;case 1:l^=m=(65535&(m=(m=(65535&(m^=255&e.charCodeAt(y)))*h+(((m>>>16)*h&65535)<<16)&4294967295)<<15|m>>>17))*f+(((m>>>16)*f&65535)<<16)&4294967295}return l^=e.length,l=2246822507*(65535&(l^=l>>>16))+((2246822507*(l>>>16)&65535)<<16)&4294967295,l=3266489909*(65535&(l^=l>>>13))+((3266489909*(l>>>16)&65535)<<16)&4294967295,(l^=l>>>16)>>>0}})(oh);var bo=oh.exports,o1={exports:{}};(function(t){t.exports=function(e,n){for(var i,s=e.length,l=n^s,u=0;s>=4;)i=1540483477*(65535&(i=255&e.charCodeAt(u)|(255&e.charCodeAt(++u))<<8|(255&e.charCodeAt(++u))<<16|(255&e.charCodeAt(++u))<<24))+((1540483477*(i>>>16)&65535)<<16),l=1540483477*(65535&l)+((1540483477*(l>>>16)&65535)<<16)^(i=1540483477*(65535&(i^=i>>>24))+((1540483477*(i>>>16)&65535)<<16)),s-=4,++u;switch(s){case 3:l^=(255&e.charCodeAt(u+2))<<16;case 2:l^=(255&e.charCodeAt(u+1))<<8;case 1:l=1540483477*(65535&(l^=255&e.charCodeAt(u)))+((1540483477*(l>>>16)&65535)<<16)}return l=1540483477*(65535&(l^=l>>>13))+((1540483477*(l>>>16)&65535)<<16),(l^=l>>>15)>>>0}})(o1);var s1=bo,Wp=o1.exports;Jd.exports=s1,Jd.exports.murmur3=s1,Jd.exports.murmur2=Wp;var eo=ee(Jd.exports);class Zp{constructor(){this.ids=[],this.uniqueIds=[],this.positions=[],this.indexed=!1}add(e,n,i,s){this.ids.push(tn(e)),this.positions.push(n,i,s)}eachPosition(e,n){const i=tn(e);let s=0,l=this.ids.length-1;for(;s<l;){const u=s+l>>1;this.ids[u]>=i?l=u:s=u+1}for(;this.ids[s]===i;)n(this.positions[3*s],this.positions[3*s+1],this.positions[3*s+2]),s++}static serialize(e,n){const i=new Float64Array(e.ids),s=new Uint32Array(e.positions);return Zl(i,s,0,i.length-1),n&&n.push(i.buffer,s.buffer),{ids:i,positions:s}}static deserialize(e){const n=new Zp;let i;n.ids=e.ids,n.positions=e.positions;for(const s of n.ids)s!==i&&n.uniqueIds.push(s),i=s;return n.indexed=!0,n}}function tn(t){const e=+t;return!isNaN(e)&&Number.MIN_SAFE_INTEGER<=e&&e<=Number.MAX_SAFE_INTEGER?e:eo(String(t))}function Zl(t,e,n,i){for(;n<i;){const s=t[n+i>>1];let l=n-1,u=i+1;for(;;){do l++;while(t[l]<s);do u--;while(t[u]>s);if(l>=u)break;sh(t,l,u),sh(e,3*l,3*u),sh(e,3*l+1,3*u+1),sh(e,3*l+2,3*u+2)}u-n<i-u?(Zl(t,e,n,u),n=u+1):(Zl(t,e,u+1,i),i=u)}}function sh(t,e,n){const i=t[e];t[e]=t[n],t[n]=i}kt(Zp,"FeaturePositionMap");class ya{constructor(e){this.gl=e.gl,this.initialized=!1}fetchUniformLocation(e,n){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(e,n),this.initialized=!0),!!this.location}}class Sn extends ya{constructor(e){super(e),this.current=0}set(e,n,i){this.fetchUniformLocation(e,n)&&this.current!==i&&(this.current=i,this.gl.uniform1i(this.location,i))}}class pt extends ya{constructor(e){super(e),this.current=0}set(e,n,i){this.fetchUniformLocation(e,n)&&this.current!==i&&(this.current=i,this.gl.uniform1f(this.location,i))}}class En extends ya{constructor(e){super(e),this.current=[0,0]}set(e,n,i){this.fetchUniformLocation(e,n)&&(i[0]===this.current[0]&&i[1]===this.current[1]||(this.current=i,this.gl.uniform2f(this.location,i[0],i[1])))}}class fn extends ya{constructor(e){super(e),this.current=[0,0,0]}set(e,n,i){this.fetchUniformLocation(e,n)&&(i[0]===this.current[0]&&i[1]===this.current[1]&&i[2]===this.current[2]||(this.current=i,this.gl.uniform3f(this.location,i[0],i[1],i[2])))}}class Ko extends ya{constructor(e){super(e),this.current=[0,0,0,0]}set(e,n,i){this.fetchUniformLocation(e,n)&&(i[0]===this.current[0]&&i[1]===this.current[1]&&i[2]===this.current[2]&&i[3]===this.current[3]||(this.current=i,this.gl.uniform4f(this.location,i[0],i[1],i[2],i[3])))}}class Yu extends ya{constructor(e){super(e),this.current=wn.transparent}set(e,n,i){this.fetchUniformLocation(e,n)&&(i.r===this.current.r&&i.g===this.current.g&&i.b===this.current.b&&i.a===this.current.a||(this.current=i,this.gl.uniform4f(this.location,i.r,i.g,i.b,i.a)))}}const a1=new Float32Array(16);class gn extends ya{constructor(e){super(e),this.current=a1}set(e,n,i){if(this.fetchUniformLocation(e,n)){if(i[12]!==this.current[12]||i[0]!==this.current[0])return this.current=i,void this.gl.uniformMatrix4fv(this.location,!1,i);for(let s=1;s<16;s++)if(i[s]!==this.current[s]){this.current=i,this.gl.uniformMatrix4fv(this.location,!1,i);break}}}}const Ky=new Float32Array(9);class to extends ya{constructor(e){super(e),this.current=Ky}set(e,n,i){if(this.fetchUniformLocation(e,n)){for(let s=0;s<9;s++)if(i[s]!==this.current[s]){this.current=i,this.gl.uniformMatrix3fv(this.location,!1,i);break}}}}const Ks=new Float32Array(4);class _a extends ya{constructor(e){super(e),this.current=Ks}set(e,n,i){if(this.fetchUniformLocation(e,n)){for(let s=0;s<4;s++)if(i[s]!==this.current[s]){this.current=i,this.gl.uniformMatrix2fv(this.location,!1,i);break}}}}function Xp(t){return[e1(255*t.r,255*t.g),e1(255*t.b,255*t.a)]}class ah{constructor(e,n,i){this.value=e,this.uniformNames=n.map(s=>`u_${s}`),this.type=i}setUniform(e,n,i,s,l){n.set(e,l,s.constantOr(this.value))}getBinding(e,n){return this.type==="color"?new Yu(e):new pt(e)}}class So{constructor(e,n){this.uniformNames=n.map(i=>`u_${i}`),this.pattern=null,this.pixelRatio=1}setConstantPatternPositions(e){this.pixelRatio=e.pixelRatio||1,this.pattern=e.tl.concat(e.br)}setUniform(e,n,i,s,l){const u=l==="u_pattern"||l==="u_dash"?this.pattern:l==="u_pixel_ratio"?this.pixelRatio:null;u&&n.set(e,l,u)}getBinding(e,n){return n==="u_pattern"||n==="u_dash"?new Ko(e):new pt(e)}}class va{constructor(e,n,i,s){this.expression=e,this.type=i,this.maxValue=0,this.paintVertexAttributes=n.map(l=>({name:`a_${l}`,type:"Float32",components:i==="color"?2:1,offset:0})),this.paintVertexArray=new s}populatePaintArray(e,n,i,s,l,u,h){const f=this.paintVertexArray.length,m=this.expression.evaluate(new Nr(0,{brightness:u}),n,{},l,s,h);this.paintVertexArray.resize(e),this._setPaintValue(f,e,m)}updatePaintArray(e,n,i,s,l,u,h){const f=this.expression.evaluate({zoom:0,brightness:h},i,s,void 0,l);this._setPaintValue(e,n,f)}_setPaintValue(e,n,i){if(this.type==="color"){const s=Xp(i);for(let l=e;l<n;l++)this.paintVertexArray.emplace(l,s[0],s[1])}else{for(let s=e;s<n;s++)this.paintVertexArray.emplace(s,i);this.maxValue=Math.max(this.maxValue,Math.abs(i))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Ui{constructor(e,n,i,s,l,u){this.expression=e,this.uniformNames=n.map(h=>`u_${h}_t`),this.type=i,this.useIntegerZoom=s,this.zoom=l,this.maxValue=0,this.paintVertexAttributes=n.map(h=>({name:`a_${h}`,type:"Float32",components:i==="color"?4:2,offset:0})),this.paintVertexArray=new u}populatePaintArray(e,n,i,s,l,u,h){const f=this.expression.evaluate(new Nr(this.zoom,{brightness:u}),n,{},l,s,h),m=this.expression.evaluate(new Nr(this.zoom+1,{brightness:u}),n,{},l,s,h),y=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(y,e,f,m)}updatePaintArray(e,n,i,s,l,u,h){const f=this.expression.evaluate({zoom:this.zoom,brightness:h},i,s,void 0,l),m=this.expression.evaluate({zoom:this.zoom+1,brightness:h},i,s,void 0,l);this._setPaintValue(e,n,f,m)}_setPaintValue(e,n,i,s){if(this.type==="color"){const l=Xp(i),u=Xp(s);for(let h=e;h<n;h++)this.paintVertexArray.emplace(h,l[0],l[1],u[0],u[1])}else{for(let l=e;l<n;l++)this.paintVertexArray.emplace(l,i,s);this.maxValue=Math.max(this.maxValue,Math.abs(i),Math.abs(s))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(e,n,i,s,l){const u=this.useIntegerZoom?Math.floor(i.zoom):i.zoom,h=ce(this.expression.interpolationFactor(u,this.zoom,this.zoom+1),0,1);n.set(e,l,h)}getBinding(e,n){return new pt(e)}}class Xl{constructor(e,n,i,s,l){this.expression=e,this.layerId=l,this.paintVertexAttributes=(i==="array"?i1:Xy).members;for(let u=0;u<n.length;++u);this.paintVertexArray=new s}populatePaintArray(e,n,i){const s=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValues(s,e,n.patterns&&n.patterns[this.layerId],i)}updatePaintArray(e,n,i,s,l,u,h){this._setPaintValues(e,n,i.patterns&&i.patterns[this.layerId],u)}_setPaintValues(e,n,i,s){if(!s||!i)return;const l=s[i];if(!l)return;const{tl:u,br:h,pixelRatio:f}=l;for(let m=e;m<n;m++)this.paintVertexArray.emplace(m,u[0],u[1],h[0],h[1],f)}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class al{constructor(e,n,i=()=>!0){this.binders={},this._buffers=[];const s=[];for(const l in e.paint._values){if(!i(l))continue;const u=e.paint.get(l);if(!(u instanceof Zu&&As(u.property.specification)))continue;const h=u1(l,e.type),f=u.value,m=u.property.specification.type,y=!!u.property.useIntegerZoom,v=l==="line-dasharray"||l.endsWith("pattern"),w=l==="line-dasharray"&&e.layout.get("line-cap").value.kind!=="constant";if(f.kind!=="constant"||w)if(f.kind==="source"||w||v){const S=Yp(l,m,"source");this.binders[l]=v?new Xl(f,h,m,S,e.id):new va(f,h,m,S),s.push(`/a_${l}`)}else{const S=Yp(l,m,"composite");this.binders[l]=new Ui(f,h,m,y,n,S),s.push(`/z_${l}`)}else this.binders[l]=v?new So(f.value,h):new ah(f.value,h,m),s.push(`/u_${l}`)}this.cacheKey=s.sort().join("")}getMaxValue(e){const n=this.binders[e];return n instanceof va||n instanceof Ui?n.maxValue:0}populatePaintArrays(e,n,i,s,l,u,h){for(const f in this.binders){const m=this.binders[f];(m instanceof va||m instanceof Ui||m instanceof Xl)&&m.populatePaintArray(e,n,i,s,l,u,h)}}setConstantPatternPositions(e){for(const n in this.binders){const i=this.binders[n];i instanceof So&&i.setConstantPatternPositions(e)}}updatePaintArrays(e,n,i,s,l,u,h){let f=!1;const m=Object.keys(e),y=m.length===0?n.uniqueIds:m;if(y.length===0)return!1;for(const v in this.binders){const w=this.binders[v];if((w instanceof va||w instanceof Ui||w instanceof Xl)&&(w.expression.isStateDependent===!0||w.expression.isLightConstant===!1)){const S=s.paint.get(v);w.expression=S.value;for(const E of y){const A=e[E.toString()];n.eachPosition(E,(M,k,R)=>{const L=i.feature(M);w.updatePaintArray(k,R,L,A,l,u,h)})}f=!0}}return f}defines(){const e=[];for(const n in this.binders){const i=this.binders[n];(i instanceof ah||i instanceof So)&&e.push(...i.uniformNames.map(s=>`#define HAS_UNIFORM_${s}`))}return e}getBinderAttributes(){const e=[];for(const n in this.binders){const i=this.binders[n];if(i instanceof va||i instanceof Ui||i instanceof Xl)for(let s=0;s<i.paintVertexAttributes.length;s++)e.push(i.paintVertexAttributes[s].name)}return e}getBinderUniforms(){const e=[];for(const n in this.binders){const i=this.binders[n];if(i instanceof ah||i instanceof So||i instanceof Ui)for(const s of i.uniformNames)e.push(s)}return e}getPaintVertexBuffers(){return this._buffers}getUniforms(e){const n=[];for(const i in this.binders){const s=this.binders[i];if(s instanceof ah||s instanceof So||s instanceof Ui)for(const l of s.uniformNames)n.push({name:l,property:i,binding:s.getBinding(e,l)})}return n}setUniforms(e,n,i,s,l){for(const{name:u,property:h,binding:f}of i)this.binders[h].setUniform(e,f,l,s.get(h),u)}updatePaintBuffers(){this._buffers=[];for(const e in this.binders){const n=this.binders[e];(n instanceof va||n instanceof Ui||n instanceof Xl)&&n.paintVertexBuffer&&this._buffers.push(n.paintVertexBuffer)}}upload(e){for(const n in this.binders){const i=this.binders[n];(i instanceof va||i instanceof Ui||i instanceof Xl)&&i.upload(e)}this.updatePaintBuffers()}destroy(){for(const e in this.binders){const n=this.binders[e];(n instanceof va||n instanceof Ui||n instanceof Xl)&&n.destroy()}}}class ll{constructor(e,n,i=()=>!0){this.programConfigurations={};for(const s of e)this.programConfigurations[s.id]=new al(s,n,i);this.needsUpload=!1,this._featureMap=new Zp,this._bufferOffset=0}populatePaintArrays(e,n,i,s,l,u,h,f){for(const m in this.programConfigurations)this.programConfigurations[m].populatePaintArrays(e,n,s,l,u,h,f);n.id!==void 0&&this._featureMap.add(n.id,i,this._bufferOffset,e),this._bufferOffset=e,this.needsUpload=!0}updatePaintArrays(e,n,i,s,l,u){for(const h of i)this.needsUpload=this.programConfigurations[h.id].updatePaintArrays(e,this._featureMap,n,h,s,l,u||0)||this.needsUpload}get(e){return this.programConfigurations[e]}upload(e){if(this.needsUpload){for(const n in this.programConfigurations)this.programConfigurations[n].upload(e);this.needsUpload=!1}}destroy(){for(const e in this.programConfigurations)this.programConfigurations[e].destroy()}}const l1={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-emissive-strength":["emissive_strength"],"icon-emissive-strength":["emissive_strength"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio"],"fill-pattern":["pattern","pixel_ratio"],"fill-extrusion-pattern":["pattern","pixel_ratio"],"line-dasharray":["dash"]};function u1(t,e){return l1[t]||[t.replace(`${e}-`,"").replace(/-/g,"_")]}const K2={"line-pattern":{source:hs,composite:hs},"fill-pattern":{source:hs,composite:hs},"fill-extrusion-pattern":{source:hs,composite:hs},"line-dasharray":{source:eh,composite:eh}},Kp={color:{source:rh,composite:Wl},number:{source:Wd,composite:rh}};function Yp(t,e,n){const i=K2[t];return i&&i[n]||Kp[e][n]}kt(ah,"ConstantBinder"),kt(So,"PatternConstantBinder"),kt(va,"SourceExpressionBinder"),kt(Xl,"PatternCompositeBinder"),kt(Ui,"CompositeExpressionBinder"),kt(al,"ProgramConfiguration",{omit:["_buffers"]}),kt(ll,"ProgramConfigurationSet");const ds="-transition";class Hn extends Cr{constructor(e,n,i){if(super(),this.id=e.id,this.type=e.type,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,this.isConfigDependent=!1,e.type!=="custom"&&(this.metadata=e.metadata,this.minzoom=e.minzoom,this.maxzoom=e.maxzoom,e.type!=="background"&&e.type!=="sky"&&e.type!=="slot"&&(this.source=e.source,this.sourceLayer=e["source-layer"],this.filter=e.filter),this.options=i,e.slot&&(this.slot=e.slot),n.layout&&(this._unevaluatedLayout=new Jv(n.layout,i),this.isConfigDependent=this.isConfigDependent||this._unevaluatedLayout.isConfigDependent),n.paint)){this._transitionablePaint=new Qc(n.paint,i);for(const s in e.paint)this.setPaintProperty(s,e.paint[s],{validate:!1});for(const s in e.layout)this.setLayoutProperty(s,e.layout[s],{validate:!1});this.isConfigDependent=this.isConfigDependent||this._transitionablePaint.isConfigDependent,this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Hd(n.paint)}}getLayoutProperty(e){return e==="visibility"?this.visibility:this._unevaluatedLayout.getValue(e)}setLayoutProperty(e,n,i={}){n!=null&&this._validate(Xc,`layers.${this.id}.layout.${e}`,e,n,i)||(this._unevaluatedLayout.setValue(e,n),this.isConfigDependent=this.isConfigDependent||this._unevaluatedLayout.isConfigDependent,e==="visibility"&&(this.visibility=this._unevaluatedLayout._values.visibility.possiblyEvaluate({zoom:0})))}getPaintProperty(e){return Br(e,ds)?this._transitionablePaint.getTransition(e.slice(0,-11)):this._transitionablePaint.getValue(e)}setPaintProperty(e,n,i={}){if(n!=null&&this._validate(Fy,`layers.${this.id}.paint.${e}`,e,n,i))return!1;if(Br(e,ds))return this._transitionablePaint.setTransition(e.slice(0,-11),n||void 0),!1;{const s=this._transitionablePaint._values[e],l=s.value.isDataDriven(),u=s.value;this._transitionablePaint.setValue(e,n),this.isConfigDependent=this.isConfigDependent||this._transitionablePaint.isConfigDependent,this._handleSpecialPaintPropertyUpdate(e);const h=this._transitionablePaint._values[e].value,f=h.isDataDriven(),m=Br(e,"pattern")||e==="line-dasharray";return f||l||m||this._handleOverridablePaintPropertyUpdate(e,u,h)}}_handleSpecialPaintPropertyUpdate(e){}getProgramIds(){return null}getProgramConfiguration(e){return null}_handleOverridablePaintPropertyUpdate(e,n,i){return!1}isHidden(e){return!!(this.minzoom&&e<this.minzoom)||!!(this.maxzoom&&e>=this.maxzoom)||this.visibility==="none"}updateTransitions(e){this._transitioningPaint=this._transitionablePaint.transitioned(e,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(e,n){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(e,void 0,n)),this.paint=this._transitioningPaint.possiblyEvaluate(e,void 0,n)}serialize(){return et({id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()},(e,n)=>!(e===void 0||n==="layout"&&!Object.keys(e).length||n==="paint"&&!Object.keys(e).length))}_validate(e,n,i,s,l={}){return(!l||l.validate!==!1)&&ti(this,e.call(Gu,{key:n,layerType:this.type,objectKey:i,value:s,styleSpec:ke,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}hasShadowPass(){return!1}hasLightBeamPass(){return!1}resize(){}isStateDependent(){for(const e in this.paint._values){const n=this.paint.get(e);if(n instanceof Zu&&As(n.property.specification)&&(n.value.kind==="source"||n.value.kind==="composite")&&n.value.isStateDependent)return!0}return!1}compileFilter(){this._filterCompiled||(this._featureFilter=ju(this.filter),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}}const no=Kn([{name:"a_pos",components:2,type:"Int16"}],4),Vi=Kn([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class In{constructor(e=[]){this.segments=e}prepareSegment(e,n,i,s){let l=this.segments[this.segments.length-1];return e>In.MAX_VERTEX_ARRAY_LENGTH&&ye(`Max vertices per segment is ${In.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${e}`),(!l||l.vertexLength+e>In.MAX_VERTEX_ARRAY_LENGTH||l.sortKey!==s)&&(l={vertexOffset:n.length,primitiveOffset:i.length,vertexLength:0,primitiveLength:0},s!==void 0&&(l.sortKey=s),this.segments.push(l)),l}get(){return this.segments}destroy(){for(const e of this.segments)for(const n in e.vaos)e.vaos[n].destroy()}static simpleSegment(e,n,i,s){return new In([{vertexOffset:e,primitiveOffset:n,vertexLength:i,primitiveLength:s,vaos:{},sortKey:0}])}}In.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,kt(In,"SegmentVector");class li{constructor(e,n){e&&(n?this.setSouthWest(e).setNorthEast(n):e.length===4?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1]))}setNorthEast(e){return this._ne=e instanceof sn?new sn(e.lng,e.lat):sn.convert(e),this}setSouthWest(e){return this._sw=e instanceof sn?new sn(e.lng,e.lat):sn.convert(e),this}extend(e){const n=this._sw,i=this._ne;let s,l;if(e instanceof sn)s=e,l=e;else{if(!(e instanceof li))return Array.isArray(e)?e.length===4||e.every(Array.isArray)?this.extend(li.convert(e)):this.extend(sn.convert(e)):typeof e=="object"&&e!==null&&e.hasOwnProperty("lat")&&(e.hasOwnProperty("lon")||e.hasOwnProperty("lng"))?this.extend(sn.convert(e)):this;if(s=e._sw,l=e._ne,!s||!l)return this}return n||i?(n.lng=Math.min(s.lng,n.lng),n.lat=Math.min(s.lat,n.lat),i.lng=Math.max(l.lng,i.lng),i.lat=Math.max(l.lat,i.lat)):(this._sw=new sn(s.lng,s.lat),this._ne=new sn(l.lng,l.lat)),this}getCenter(){return new sn((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new sn(this.getWest(),this.getNorth())}getSouthEast(){return new sn(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(e){const{lng:n,lat:i}=sn.convert(e);let s=this._sw.lng<=n&&n<=this._ne.lng;return this._sw.lng>this._ne.lng&&(s=this._sw.lng>=n&&n>=this._ne.lng),this._sw.lat<=i&&i<=this._ne.lat&&s}static convert(e){return!e||e instanceof li?e:new li(e)}}var ni={},Jn={};Object.defineProperty(Jn,"__esModule",{value:!0}),Jn.setMatrixArrayType=function(t){Jn.ARRAY_TYPE=Kl=t},Jn.toRadian=function(t){return t*Yy},Jn.equals=function(t,e){return Math.abs(t-e)<=lh*Math.max(1,Math.abs(t),Math.abs(e))},Jn.RANDOM=Jn.ARRAY_TYPE=Jn.EPSILON=void 0;var lh=1e-6;Jn.EPSILON=lh;var Kl=typeof Float32Array<"u"?Float32Array:Array;Jn.ARRAY_TYPE=Kl;var Qp=Math.random;Jn.RANDOM=Qp;var Yy=Math.PI/180;Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});var vr={};function Eo(t){return Eo=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Eo(t)}Object.defineProperty(vr,"__esModule",{value:!0}),vr.create=function(){var t=new xa.ARRAY_TYPE(4);return xa.ARRAY_TYPE!=Float32Array&&(t[1]=0,t[2]=0),t[0]=1,t[3]=1,t},vr.clone=function(t){var e=new xa.ARRAY_TYPE(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},vr.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},vr.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},vr.fromValues=function(t,e,n,i){var s=new xa.ARRAY_TYPE(4);return s[0]=t,s[1]=e,s[2]=n,s[3]=i,s},vr.set=function(t,e,n,i,s){return t[0]=e,t[1]=n,t[2]=i,t[3]=s,t},vr.transpose=function(t,e){if(t===e){var n=e[1];t[1]=e[2],t[2]=n}else t[0]=e[0],t[1]=e[2],t[2]=e[1],t[3]=e[3];return t},vr.invert=function(t,e){var n=e[0],i=e[1],s=e[2],l=e[3],u=n*l-s*i;return u?(t[0]=l*(u=1/u),t[1]=-i*u,t[2]=-s*u,t[3]=n*u,t):null},vr.adjoint=function(t,e){var n=e[0];return t[0]=e[3],t[1]=-e[1],t[2]=-e[2],t[3]=n,t},vr.determinant=function(t){return t[0]*t[3]-t[2]*t[1]},vr.multiply=wa,vr.rotate=function(t,e,n){var i=e[0],s=e[1],l=e[2],u=e[3],h=Math.sin(n),f=Math.cos(n);return t[0]=i*f+l*h,t[1]=s*f+u*h,t[2]=i*-h+l*f,t[3]=s*-h+u*f,t},vr.scale=function(t,e,n){var i=e[1],s=e[2],l=e[3],u=n[0],h=n[1];return t[0]=e[0]*u,t[1]=i*u,t[2]=s*h,t[3]=l*h,t},vr.fromRotation=function(t,e){var n=Math.sin(e),i=Math.cos(e);return t[0]=i,t[1]=n,t[2]=-n,t[3]=i,t},vr.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t},vr.str=function(t){return"mat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},vr.frob=function(t){return Math.hypot(t[0],t[1],t[2],t[3])},vr.LDU=function(t,e,n,i){return t[2]=i[2]/i[0],n[0]=i[0],n[1]=i[1],n[3]=i[3]-t[2]*n[1],[t,e,n]},vr.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t},vr.subtract=ef,vr.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]},vr.equals=function(t,e){var n=t[0],i=t[1],s=t[2],l=t[3],u=e[0],h=e[1],f=e[2],m=e[3];return Math.abs(n-u)<=xa.EPSILON*Math.max(1,Math.abs(n),Math.abs(u))&&Math.abs(i-h)<=xa.EPSILON*Math.max(1,Math.abs(i),Math.abs(h))&&Math.abs(s-f)<=xa.EPSILON*Math.max(1,Math.abs(s),Math.abs(f))&&Math.abs(l-m)<=xa.EPSILON*Math.max(1,Math.abs(l),Math.abs(m))},vr.multiplyScalar=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t},vr.multiplyScalarAndAdd=function(t,e,n,i){return t[0]=e[0]+n[0]*i,t[1]=e[1]+n[1]*i,t[2]=e[2]+n[2]*i,t[3]=e[3]+n[3]*i,t},vr.sub=vr.mul=void 0;var xa=function(t,e){if(t&&t.__esModule)return t;if(t===null||Eo(t)!=="object"&&typeof t!="function")return{default:t};var n=Qu(void 0);if(n&&n.has(t))return n.get(t);var i={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var l in t)if(l!=="default"&&Object.prototype.hasOwnProperty.call(t,l)){var u=s?Object.getOwnPropertyDescriptor(t,l):null;u&&(u.get||u.set)?Object.defineProperty(i,l,u):i[l]=t[l]}return i.default=t,n&&n.set(t,i),i}(Jn);function Qu(t){if(typeof WeakMap!="function")return null;var e=new WeakMap,n=new WeakMap;return(Qu=function(i){return i?n:e})(t)}function wa(t,e,n){var i=e[0],s=e[1],l=e[2],u=e[3],h=n[0],f=n[1],m=n[2],y=n[3];return t[0]=i*h+l*f,t[1]=s*h+u*f,t[2]=i*m+l*y,t[3]=s*m+u*y,t}function ef(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t}vr.mul=wa,vr.sub=ef;var Mr={};function ba(t){return ba=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ba(t)}Object.defineProperty(Mr,"__esModule",{value:!0}),Mr.create=function(){var t=new fs.ARRAY_TYPE(6);return fs.ARRAY_TYPE!=Float32Array&&(t[1]=0,t[2]=0,t[4]=0,t[5]=0),t[0]=1,t[3]=1,t},Mr.clone=function(t){var e=new fs.ARRAY_TYPE(6);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e},Mr.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t},Mr.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t},Mr.fromValues=function(t,e,n,i,s,l){var u=new fs.ARRAY_TYPE(6);return u[0]=t,u[1]=e,u[2]=n,u[3]=i,u[4]=s,u[5]=l,u},Mr.set=function(t,e,n,i,s,l,u){return t[0]=e,t[1]=n,t[2]=i,t[3]=s,t[4]=l,t[5]=u,t},Mr.invert=function(t,e){var n=e[0],i=e[1],s=e[2],l=e[3],u=e[4],h=e[5],f=n*l-i*s;return f?(t[0]=l*(f=1/f),t[1]=-i*f,t[2]=-s*f,t[3]=n*f,t[4]=(s*h-l*u)*f,t[5]=(i*u-n*h)*f,t):null},Mr.determinant=function(t){return t[0]*t[3]-t[1]*t[2]},Mr.multiply=tf,Mr.rotate=function(t,e,n){var i=e[0],s=e[1],l=e[2],u=e[3],h=e[4],f=e[5],m=Math.sin(n),y=Math.cos(n);return t[0]=i*y+l*m,t[1]=s*y+u*m,t[2]=i*-m+l*y,t[3]=s*-m+u*y,t[4]=h,t[5]=f,t},Mr.scale=function(t,e,n){var i=e[1],s=e[2],l=e[3],u=e[4],h=e[5],f=n[0],m=n[1];return t[0]=e[0]*f,t[1]=i*f,t[2]=s*m,t[3]=l*m,t[4]=u,t[5]=h,t},Mr.translate=function(t,e,n){var i=e[0],s=e[1],l=e[2],u=e[3],h=e[4],f=e[5],m=n[0],y=n[1];return t[0]=i,t[1]=s,t[2]=l,t[3]=u,t[4]=i*m+l*y+h,t[5]=s*m+u*y+f,t},Mr.fromRotation=function(t,e){var n=Math.sin(e),i=Math.cos(e);return t[0]=i,t[1]=n,t[2]=-n,t[3]=i,t[4]=0,t[5]=0,t},Mr.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t[4]=0,t[5]=0,t},Mr.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=e[0],t[5]=e[1],t},Mr.str=function(t){return"mat2d("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+")"},Mr.frob=function(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],1)},Mr.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t},Mr.subtract=uh,Mr.multiplyScalar=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t},Mr.multiplyScalarAndAdd=function(t,e,n,i){return t[0]=e[0]+n[0]*i,t[1]=e[1]+n[1]*i,t[2]=e[2]+n[2]*i,t[3]=e[3]+n[3]*i,t[4]=e[4]+n[4]*i,t[5]=e[5]+n[5]*i,t},Mr.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]},Mr.equals=function(t,e){var n=t[0],i=t[1],s=t[2],l=t[3],u=t[4],h=t[5],f=e[0],m=e[1],y=e[2],v=e[3],w=e[4],S=e[5];return Math.abs(n-f)<=fs.EPSILON*Math.max(1,Math.abs(n),Math.abs(f))&&Math.abs(i-m)<=fs.EPSILON*Math.max(1,Math.abs(i),Math.abs(m))&&Math.abs(s-y)<=fs.EPSILON*Math.max(1,Math.abs(s),Math.abs(y))&&Math.abs(l-v)<=fs.EPSILON*Math.max(1,Math.abs(l),Math.abs(v))&&Math.abs(u-w)<=fs.EPSILON*Math.max(1,Math.abs(u),Math.abs(w))&&Math.abs(h-S)<=fs.EPSILON*Math.max(1,Math.abs(h),Math.abs(S))},Mr.sub=Mr.mul=void 0;var fs=function(t,e){if(t&&t.__esModule)return t;if(t===null||ba(t)!=="object"&&typeof t!="function")return{default:t};var n=ul(void 0);if(n&&n.has(t))return n.get(t);var i={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var l in t)if(l!=="default"&&Object.prototype.hasOwnProperty.call(t,l)){var u=s?Object.getOwnPropertyDescriptor(t,l):null;u&&(u.get||u.set)?Object.defineProperty(i,l,u):i[l]=t[l]}return i.default=t,n&&n.set(t,i),i}(Jn);function ul(t){if(typeof WeakMap!="function")return null;var e=new WeakMap,n=new WeakMap;return(ul=function(i){return i?n:e})(t)}function tf(t,e,n){var i=e[0],s=e[1],l=e[2],u=e[3],h=e[4],f=e[5],m=n[0],y=n[1],v=n[2],w=n[3],S=n[4],E=n[5];return t[0]=i*m+l*y,t[1]=s*m+u*y,t[2]=i*v+l*w,t[3]=s*v+u*w,t[4]=i*S+l*E+h,t[5]=s*S+u*E+f,t}function uh(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t}Mr.mul=tf,Mr.sub=uh;var er={};function ch(t){return ch=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ch(t)}Object.defineProperty(er,"__esModule",{value:!0}),er.create=function(){var t=new To.ARRAY_TYPE(9);return To.ARRAY_TYPE!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t},er.fromMat4=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t},er.clone=function(t){var e=new To.ARRAY_TYPE(9);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},er.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},er.fromValues=function(t,e,n,i,s,l,u,h,f){var m=new To.ARRAY_TYPE(9);return m[0]=t,m[1]=e,m[2]=n,m[3]=i,m[4]=s,m[5]=l,m[6]=u,m[7]=h,m[8]=f,m},er.set=function(t,e,n,i,s,l,u,h,f,m){return t[0]=e,t[1]=n,t[2]=i,t[3]=s,t[4]=l,t[5]=u,t[6]=h,t[7]=f,t[8]=m,t},er.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},er.transpose=function(t,e){if(t===e){var n=e[1],i=e[2],s=e[5];t[1]=e[3],t[2]=e[6],t[3]=n,t[5]=e[7],t[6]=i,t[7]=s}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t},er.invert=function(t,e){var n=e[0],i=e[1],s=e[2],l=e[3],u=e[4],h=e[5],f=e[6],m=e[7],y=e[8],v=y*u-h*m,w=-y*l+h*f,S=m*l-u*f,E=n*v+i*w+s*S;return E?(t[0]=v*(E=1/E),t[1]=(-y*i+s*m)*E,t[2]=(h*i-s*u)*E,t[3]=w*E,t[4]=(y*n-s*f)*E,t[5]=(-h*n+s*l)*E,t[6]=S*E,t[7]=(-m*n+i*f)*E,t[8]=(u*n-i*l)*E,t):null},er.adjoint=function(t,e){var n=e[0],i=e[1],s=e[2],l=e[3],u=e[4],h=e[5],f=e[6],m=e[7],y=e[8];return t[0]=u*y-h*m,t[1]=s*m-i*y,t[2]=i*h-s*u,t[3]=h*f-l*y,t[4]=n*y-s*f,t[5]=s*l-n*h,t[6]=l*m-u*f,t[7]=i*f-n*m,t[8]=n*u-i*l,t},er.determinant=function(t){var e=t[3],n=t[4],i=t[5],s=t[6],l=t[7],u=t[8];return t[0]*(u*n-i*l)+t[1]*(-u*e+i*s)+t[2]*(l*e-n*s)},er.multiply=cl,er.translate=function(t,e,n){var i=e[0],s=e[1],l=e[2],u=e[3],h=e[4],f=e[5],m=e[6],y=e[7],v=e[8],w=n[0],S=n[1];return t[0]=i,t[1]=s,t[2]=l,t[3]=u,t[4]=h,t[5]=f,t[6]=w*i+S*u+m,t[7]=w*s+S*h+y,t[8]=w*l+S*f+v,t},er.rotate=function(t,e,n){var i=e[0],s=e[1],l=e[2],u=e[3],h=e[4],f=e[5],m=e[6],y=e[7],v=e[8],w=Math.sin(n),S=Math.cos(n);return t[0]=S*i+w*u,t[1]=S*s+w*h,t[2]=S*l+w*f,t[3]=S*u-w*i,t[4]=S*h-w*s,t[5]=S*f-w*l,t[6]=m,t[7]=y,t[8]=v,t},er.scale=function(t,e,n){var i=n[0],s=n[1];return t[0]=i*e[0],t[1]=i*e[1],t[2]=i*e[2],t[3]=s*e[3],t[4]=s*e[4],t[5]=s*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},er.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=e[0],t[7]=e[1],t[8]=1,t},er.fromRotation=function(t,e){var n=Math.sin(e),i=Math.cos(e);return t[0]=i,t[1]=n,t[2]=0,t[3]=-n,t[4]=i,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},er.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=e[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},er.fromMat2d=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=0,t[3]=e[2],t[4]=e[3],t[5]=0,t[6]=e[4],t[7]=e[5],t[8]=1,t},er.fromQuat=function(t,e){var n=e[0],i=e[1],s=e[2],l=e[3],u=n+n,h=i+i,f=s+s,m=n*u,y=i*u,v=i*h,w=s*u,S=s*h,E=s*f,A=l*u,M=l*h,k=l*f;return t[0]=1-v-E,t[3]=y-k,t[6]=w+M,t[1]=y+k,t[4]=1-m-E,t[7]=S-A,t[2]=w-M,t[5]=S+A,t[8]=1-m-v,t},er.normalFromMat4=function(t,e){var n=e[0],i=e[1],s=e[2],l=e[3],u=e[4],h=e[5],f=e[6],m=e[7],y=e[8],v=e[9],w=e[10],S=e[11],E=e[12],A=e[13],M=e[14],k=e[15],R=n*h-i*u,L=n*f-s*u,z=n*m-l*u,B=i*f-s*h,j=i*m-l*h,V=s*m-l*f,Y=y*A-v*E,ne=y*M-w*E,re=y*k-S*E,J=v*M-w*A,ae=v*k-S*A,le=w*k-S*M,oe=R*le-L*ae+z*J+B*re-j*ne+V*Y;return oe?(t[0]=(h*le-f*ae+m*J)*(oe=1/oe),t[1]=(f*re-u*le-m*ne)*oe,t[2]=(u*ae-h*re+m*Y)*oe,t[3]=(s*ae-i*le-l*J)*oe,t[4]=(n*le-s*re+l*ne)*oe,t[5]=(i*re-n*ae-l*Y)*oe,t[6]=(A*V-M*j+k*B)*oe,t[7]=(M*z-E*V-k*L)*oe,t[8]=(E*j-A*z+k*R)*oe,t):null},er.projection=function(t,e,n){return t[0]=2/e,t[1]=0,t[2]=0,t[3]=0,t[4]=-2/n,t[5]=0,t[6]=-1,t[7]=1,t[8]=1,t},er.str=function(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"},er.frob=function(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8])},er.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t[8]=e[8]+n[8],t},er.subtract=Ps,er.multiplyScalar=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*n,t},er.multiplyScalarAndAdd=function(t,e,n,i){return t[0]=e[0]+n[0]*i,t[1]=e[1]+n[1]*i,t[2]=e[2]+n[2]*i,t[3]=e[3]+n[3]*i,t[4]=e[4]+n[4]*i,t[5]=e[5]+n[5]*i,t[6]=e[6]+n[6]*i,t[7]=e[7]+n[7]*i,t[8]=e[8]+n[8]*i,t},er.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]},er.equals=function(t,e){var n=t[0],i=t[1],s=t[2],l=t[3],u=t[4],h=t[5],f=t[6],m=t[7],y=t[8],v=e[0],w=e[1],S=e[2],E=e[3],A=e[4],M=e[5],k=e[6],R=e[7],L=e[8];return Math.abs(n-v)<=To.EPSILON*Math.max(1,Math.abs(n),Math.abs(v))&&Math.abs(i-w)<=To.EPSILON*Math.max(1,Math.abs(i),Math.abs(w))&&Math.abs(s-S)<=To.EPSILON*Math.max(1,Math.abs(s),Math.abs(S))&&Math.abs(l-E)<=To.EPSILON*Math.max(1,Math.abs(l),Math.abs(E))&&Math.abs(u-A)<=To.EPSILON*Math.max(1,Math.abs(u),Math.abs(A))&&Math.abs(h-M)<=To.EPSILON*Math.max(1,Math.abs(h),Math.abs(M))&&Math.abs(f-k)<=To.EPSILON*Math.max(1,Math.abs(f),Math.abs(k))&&Math.abs(m-R)<=To.EPSILON*Math.max(1,Math.abs(m),Math.abs(R))&&Math.abs(y-L)<=To.EPSILON*Math.max(1,Math.abs(y),Math.abs(L))},er.sub=er.mul=void 0;var To=function(t,e){if(t&&t.__esModule)return t;if(t===null||ch(t)!=="object"&&typeof t!="function")return{default:t};var n=Co(void 0);if(n&&n.has(t))return n.get(t);var i={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var l in t)if(l!=="default"&&Object.prototype.hasOwnProperty.call(t,l)){var u=s?Object.getOwnPropertyDescriptor(t,l):null;u&&(u.get||u.set)?Object.defineProperty(i,l,u):i[l]=t[l]}return i.default=t,n&&n.set(t,i),i}(Jn);function Co(t){if(typeof WeakMap!="function")return null;var e=new WeakMap,n=new WeakMap;return(Co=function(i){return i?n:e})(t)}function cl(t,e,n){var i=e[0],s=e[1],l=e[2],u=e[3],h=e[4],f=e[5],m=e[6],y=e[7],v=e[8],w=n[0],S=n[1],E=n[2],A=n[3],M=n[4],k=n[5],R=n[6],L=n[7],z=n[8];return t[0]=w*i+S*u+E*m,t[1]=w*s+S*h+E*y,t[2]=w*l+S*f+E*v,t[3]=A*i+M*u+k*m,t[4]=A*s+M*h+k*y,t[5]=A*l+M*f+k*v,t[6]=R*i+L*u+z*m,t[7]=R*s+L*h+z*y,t[8]=R*l+L*f+z*v,t}function Ps(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t[6]=e[6]-n[6],t[7]=e[7]-n[7],t[8]=e[8]-n[8],t}er.mul=cl,er.sub=Ps;var Qt={};function Jp(t){return Jp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Jp(t)}Object.defineProperty(Qt,"__esModule",{value:!0}),Qt.create=function(){var t=new Vr.ARRAY_TYPE(16);return Vr.ARRAY_TYPE!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t},Qt.clone=function(t){var e=new Vr.ARRAY_TYPE(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},Qt.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},Qt.fromValues=function(t,e,n,i,s,l,u,h,f,m,y,v,w,S,E,A){var M=new Vr.ARRAY_TYPE(16);return M[0]=t,M[1]=e,M[2]=n,M[3]=i,M[4]=s,M[5]=l,M[6]=u,M[7]=h,M[8]=f,M[9]=m,M[10]=y,M[11]=v,M[12]=w,M[13]=S,M[14]=E,M[15]=A,M},Qt.set=function(t,e,n,i,s,l,u,h,f,m,y,v,w,S,E,A,M){return t[0]=e,t[1]=n,t[2]=i,t[3]=s,t[4]=l,t[5]=u,t[6]=h,t[7]=f,t[8]=m,t[9]=y,t[10]=v,t[11]=w,t[12]=S,t[13]=E,t[14]=A,t[15]=M,t},Qt.identity=c1,Qt.transpose=function(t,e){if(t===e){var n=e[1],i=e[2],s=e[3],l=e[6],u=e[7],h=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=i,t[9]=l,t[11]=e[14],t[12]=s,t[13]=u,t[14]=h}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t},Qt.invert=function(t,e){var n=e[0],i=e[1],s=e[2],l=e[3],u=e[4],h=e[5],f=e[6],m=e[7],y=e[8],v=e[9],w=e[10],S=e[11],E=e[12],A=e[13],M=e[14],k=e[15],R=n*h-i*u,L=n*f-s*u,z=n*m-l*u,B=i*f-s*h,j=i*m-l*h,V=s*m-l*f,Y=y*A-v*E,ne=y*M-w*E,re=y*k-S*E,J=v*M-w*A,ae=v*k-S*A,le=w*k-S*M,oe=R*le-L*ae+z*J+B*re-j*ne+V*Y;return oe?(t[0]=(h*le-f*ae+m*J)*(oe=1/oe),t[1]=(s*ae-i*le-l*J)*oe,t[2]=(A*V-M*j+k*B)*oe,t[3]=(w*j-v*V-S*B)*oe,t[4]=(f*re-u*le-m*ne)*oe,t[5]=(n*le-s*re+l*ne)*oe,t[6]=(M*z-E*V-k*L)*oe,t[7]=(y*V-w*z+S*L)*oe,t[8]=(u*ae-h*re+m*Y)*oe,t[9]=(i*re-n*ae-l*Y)*oe,t[10]=(E*j-A*z+k*R)*oe,t[11]=(v*z-y*j-S*R)*oe,t[12]=(h*ne-u*J-f*Y)*oe,t[13]=(n*J-i*ne+s*Y)*oe,t[14]=(A*L-E*B-M*R)*oe,t[15]=(y*B-v*L+w*R)*oe,t):null},Qt.adjoint=function(t,e){var n=e[0],i=e[1],s=e[2],l=e[3],u=e[4],h=e[5],f=e[6],m=e[7],y=e[8],v=e[9],w=e[10],S=e[11],E=e[12],A=e[13],M=e[14],k=e[15];return t[0]=h*(w*k-S*M)-v*(f*k-m*M)+A*(f*S-m*w),t[1]=-(i*(w*k-S*M)-v*(s*k-l*M)+A*(s*S-l*w)),t[2]=i*(f*k-m*M)-h*(s*k-l*M)+A*(s*m-l*f),t[3]=-(i*(f*S-m*w)-h*(s*S-l*w)+v*(s*m-l*f)),t[4]=-(u*(w*k-S*M)-y*(f*k-m*M)+E*(f*S-m*w)),t[5]=n*(w*k-S*M)-y*(s*k-l*M)+E*(s*S-l*w),t[6]=-(n*(f*k-m*M)-u*(s*k-l*M)+E*(s*m-l*f)),t[7]=n*(f*S-m*w)-u*(s*S-l*w)+y*(s*m-l*f),t[8]=u*(v*k-S*A)-y*(h*k-m*A)+E*(h*S-m*v),t[9]=-(n*(v*k-S*A)-y*(i*k-l*A)+E*(i*S-l*v)),t[10]=n*(h*k-m*A)-u*(i*k-l*A)+E*(i*m-l*h),t[11]=-(n*(h*S-m*v)-u*(i*S-l*v)+y*(i*m-l*h)),t[12]=-(u*(v*M-w*A)-y*(h*M-f*A)+E*(h*w-f*v)),t[13]=n*(v*M-w*A)-y*(i*M-s*A)+E*(i*w-s*v),t[14]=-(n*(h*M-f*A)-u*(i*M-s*A)+E*(i*f-s*h)),t[15]=n*(h*w-f*v)-u*(i*w-s*v)+y*(i*f-s*h),t},Qt.determinant=function(t){var e=t[0],n=t[1],i=t[2],s=t[3],l=t[4],u=t[5],h=t[6],f=t[7],m=t[8],y=t[9],v=t[10],w=t[11],S=t[12],E=t[13],A=t[14],M=t[15];return(e*u-n*l)*(v*M-w*A)-(e*h-i*l)*(y*M-w*E)+(e*f-s*l)*(y*A-v*E)+(n*h-i*u)*(m*M-w*S)-(n*f-s*u)*(m*A-v*S)+(i*f-s*h)*(m*E-y*S)},Qt.multiply=hl,Qt.translate=function(t,e,n){var i,s,l,u,h,f,m,y,v,w,S,E,A=n[0],M=n[1],k=n[2];return e===t?(t[12]=e[0]*A+e[4]*M+e[8]*k+e[12],t[13]=e[1]*A+e[5]*M+e[9]*k+e[13],t[14]=e[2]*A+e[6]*M+e[10]*k+e[14],t[15]=e[3]*A+e[7]*M+e[11]*k+e[15]):(s=e[1],l=e[2],u=e[3],h=e[4],f=e[5],m=e[6],y=e[7],v=e[8],w=e[9],S=e[10],E=e[11],t[0]=i=e[0],t[1]=s,t[2]=l,t[3]=u,t[4]=h,t[5]=f,t[6]=m,t[7]=y,t[8]=v,t[9]=w,t[10]=S,t[11]=E,t[12]=i*A+h*M+v*k+e[12],t[13]=s*A+f*M+w*k+e[13],t[14]=l*A+m*M+S*k+e[14],t[15]=u*A+y*M+E*k+e[15]),t},Qt.scale=function(t,e,n){var i=n[0],s=n[1],l=n[2];return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t[4]=e[4]*s,t[5]=e[5]*s,t[6]=e[6]*s,t[7]=e[7]*s,t[8]=e[8]*l,t[9]=e[9]*l,t[10]=e[10]*l,t[11]=e[11]*l,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},Qt.rotate=function(t,e,n,i){var s,l,u,h,f,m,y,v,w,S,E,A,M,k,R,L,z,B,j,V,Y,ne,re,J,ae=i[0],le=i[1],oe=i[2],Ee=Math.hypot(ae,le,oe);return Ee<Vr.EPSILON?null:(ae*=Ee=1/Ee,le*=Ee,oe*=Ee,s=Math.sin(n),l=Math.cos(n),f=e[1],m=e[2],y=e[3],w=e[5],S=e[6],E=e[7],M=e[9],k=e[10],R=e[11],j=ae*le*(u=1-l)-oe*s,V=le*le*u+l,Y=oe*le*u+ae*s,ne=ae*oe*u+le*s,re=le*oe*u-ae*s,J=oe*oe*u+l,t[0]=(h=e[0])*(L=ae*ae*u+l)+(v=e[4])*(z=le*ae*u+oe*s)+(A=e[8])*(B=oe*ae*u-le*s),t[1]=f*L+w*z+M*B,t[2]=m*L+S*z+k*B,t[3]=y*L+E*z+R*B,t[4]=h*j+v*V+A*Y,t[5]=f*j+w*V+M*Y,t[6]=m*j+S*V+k*Y,t[7]=y*j+E*V+R*Y,t[8]=h*ne+v*re+A*J,t[9]=f*ne+w*re+M*J,t[10]=m*ne+S*re+k*J,t[11]=y*ne+E*re+R*J,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)},Qt.rotateX=function(t,e,n){var i=Math.sin(n),s=Math.cos(n),l=e[4],u=e[5],h=e[6],f=e[7],m=e[8],y=e[9],v=e[10],w=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=l*s+m*i,t[5]=u*s+y*i,t[6]=h*s+v*i,t[7]=f*s+w*i,t[8]=m*s-l*i,t[9]=y*s-u*i,t[10]=v*s-h*i,t[11]=w*s-f*i,t},Qt.rotateY=function(t,e,n){var i=Math.sin(n),s=Math.cos(n),l=e[0],u=e[1],h=e[2],f=e[3],m=e[8],y=e[9],v=e[10],w=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=l*s-m*i,t[1]=u*s-y*i,t[2]=h*s-v*i,t[3]=f*s-w*i,t[8]=l*i+m*s,t[9]=u*i+y*s,t[10]=h*i+v*s,t[11]=f*i+w*s,t},Qt.rotateZ=function(t,e,n){var i=Math.sin(n),s=Math.cos(n),l=e[0],u=e[1],h=e[2],f=e[3],m=e[4],y=e[5],v=e[6],w=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=l*s+m*i,t[1]=u*s+y*i,t[2]=h*s+v*i,t[3]=f*s+w*i,t[4]=m*s-l*i,t[5]=y*s-u*i,t[6]=v*s-h*i,t[7]=w*s-f*i,t},Qt.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t},Qt.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},Qt.fromRotation=function(t,e,n){var i,s,l,u=n[0],h=n[1],f=n[2],m=Math.hypot(u,h,f);return m<Vr.EPSILON?null:(u*=m=1/m,h*=m,f*=m,i=Math.sin(e),s=Math.cos(e),t[0]=u*u*(l=1-s)+s,t[1]=h*u*l+f*i,t[2]=f*u*l-h*i,t[3]=0,t[4]=u*h*l-f*i,t[5]=h*h*l+s,t[6]=f*h*l+u*i,t[7]=0,t[8]=u*f*l+h*i,t[9]=h*f*l-u*i,t[10]=f*f*l+s,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)},Qt.fromXRotation=function(t,e){var n=Math.sin(e),i=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=i,t[6]=n,t[7]=0,t[8]=0,t[9]=-n,t[10]=i,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},Qt.fromYRotation=function(t,e){var n=Math.sin(e),i=Math.cos(e);return t[0]=i,t[1]=0,t[2]=-n,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=n,t[9]=0,t[10]=i,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},Qt.fromZRotation=function(t,e){var n=Math.sin(e),i=Math.cos(e);return t[0]=i,t[1]=n,t[2]=0,t[3]=0,t[4]=-n,t[5]=i,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},Qt.fromRotationTranslation=Qy,Qt.fromQuat2=function(t,e){var n=new Vr.ARRAY_TYPE(3),i=-e[0],s=-e[1],l=-e[2],u=e[3],h=e[4],f=e[5],m=e[6],y=e[7],v=i*i+s*s+l*l+u*u;return v>0?(n[0]=2*(h*u+y*i+f*l-m*s)/v,n[1]=2*(f*u+y*s+m*i-h*l)/v,n[2]=2*(m*u+y*l+h*s-f*i)/v):(n[0]=2*(h*u+y*i+f*l-m*s),n[1]=2*(f*u+y*s+m*i-h*l),n[2]=2*(m*u+y*l+h*s-f*i)),Qy(t,e,n),t},Qt.getTranslation=function(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t},Qt.getScaling=tm,Qt.getRotation=function(t,e){var n=new Vr.ARRAY_TYPE(3);tm(n,e);var i=1/n[0],s=1/n[1],l=1/n[2],u=e[0]*i,h=e[1]*s,f=e[2]*l,m=e[4]*i,y=e[5]*s,v=e[6]*l,w=e[8]*i,S=e[9]*s,E=e[10]*l,A=u+y+E,M=0;return A>0?(M=2*Math.sqrt(A+1),t[3]=.25*M,t[0]=(v-S)/M,t[1]=(w-f)/M,t[2]=(h-m)/M):u>y&&u>E?(M=2*Math.sqrt(1+u-y-E),t[3]=(v-S)/M,t[0]=.25*M,t[1]=(h+m)/M,t[2]=(w+f)/M):y>E?(M=2*Math.sqrt(1+y-u-E),t[3]=(w-f)/M,t[0]=(h+m)/M,t[1]=.25*M,t[2]=(v+S)/M):(M=2*Math.sqrt(1+E-u-y),t[3]=(h-m)/M,t[0]=(w+f)/M,t[1]=(v+S)/M,t[2]=.25*M),t},Qt.fromRotationTranslationScale=function(t,e,n,i){var s=e[0],l=e[1],u=e[2],h=e[3],f=s+s,m=l+l,y=u+u,v=s*f,w=s*m,S=s*y,E=l*m,A=l*y,M=u*y,k=h*f,R=h*m,L=h*y,z=i[0],B=i[1],j=i[2];return t[0]=(1-(E+M))*z,t[1]=(w+L)*z,t[2]=(S-R)*z,t[3]=0,t[4]=(w-L)*B,t[5]=(1-(v+M))*B,t[6]=(A+k)*B,t[7]=0,t[8]=(S+R)*j,t[9]=(A-k)*j,t[10]=(1-(v+E))*j,t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t},Qt.fromRotationTranslationScaleOrigin=function(t,e,n,i,s){var l=e[0],u=e[1],h=e[2],f=e[3],m=l+l,y=u+u,v=h+h,w=l*m,S=l*y,E=l*v,A=u*y,M=u*v,k=h*v,R=f*m,L=f*y,z=f*v,B=i[0],j=i[1],V=i[2],Y=s[0],ne=s[1],re=s[2],J=(1-(A+k))*B,ae=(S+z)*B,le=(E-L)*B,oe=(S-z)*j,Ee=(1-(w+k))*j,xe=(M+R)*j,Pe=(E+L)*V,pe=(M-R)*V,Ae=(1-(w+A))*V;return t[0]=J,t[1]=ae,t[2]=le,t[3]=0,t[4]=oe,t[5]=Ee,t[6]=xe,t[7]=0,t[8]=Pe,t[9]=pe,t[10]=Ae,t[11]=0,t[12]=n[0]+Y-(J*Y+oe*ne+Pe*re),t[13]=n[1]+ne-(ae*Y+Ee*ne+pe*re),t[14]=n[2]+re-(le*Y+xe*ne+Ae*re),t[15]=1,t},Qt.fromQuat=function(t,e){var n=e[0],i=e[1],s=e[2],l=e[3],u=n+n,h=i+i,f=s+s,m=n*u,y=i*u,v=i*h,w=s*u,S=s*h,E=s*f,A=l*u,M=l*h,k=l*f;return t[0]=1-v-E,t[1]=y+k,t[2]=w-M,t[3]=0,t[4]=y-k,t[5]=1-m-E,t[6]=S+A,t[7]=0,t[8]=w+M,t[9]=S-A,t[10]=1-m-v,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},Qt.frustum=function(t,e,n,i,s,l,u){var h=1/(n-e),f=1/(s-i),m=1/(l-u);return t[0]=2*l*h,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*l*f,t[6]=0,t[7]=0,t[8]=(n+e)*h,t[9]=(s+i)*f,t[10]=(u+l)*m,t[11]=-1,t[12]=0,t[13]=0,t[14]=u*l*2*m,t[15]=0,t},Qt.perspectiveNO=Yl,Qt.perspectiveZO=function(t,e,n,i,s){var l,u=1/Math.tan(e/2);return t[0]=u/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=u,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,s!=null&&s!==1/0?(t[10]=s*(l=1/(i-s)),t[14]=s*i*l):(t[10]=-1,t[14]=-i),t},Qt.perspectiveFromFieldOfView=function(t,e,n,i){var s=Math.tan(e.upDegrees*Math.PI/180),l=Math.tan(e.downDegrees*Math.PI/180),u=Math.tan(e.leftDegrees*Math.PI/180),h=Math.tan(e.rightDegrees*Math.PI/180),f=2/(u+h),m=2/(s+l);return t[0]=f,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=m,t[6]=0,t[7]=0,t[8]=-(u-h)*f*.5,t[9]=(s-l)*m*.5,t[10]=i/(n-i),t[11]=-1,t[12]=0,t[13]=0,t[14]=i*n/(n-i),t[15]=0,t},Qt.orthoNO=nm,Qt.orthoZO=function(t,e,n,i,s,l,u){var h=1/(e-n),f=1/(i-s),m=1/(l-u);return t[0]=-2*h,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*f,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=m,t[11]=0,t[12]=(e+n)*h,t[13]=(s+i)*f,t[14]=l*m,t[15]=1,t},Qt.lookAt=function(t,e,n,i){var s,l,u,h,f,m,y,v,w,S,E=e[0],A=e[1],M=e[2],k=i[0],R=i[1],L=i[2],z=n[0],B=n[1],j=n[2];return Math.abs(E-z)<Vr.EPSILON&&Math.abs(A-B)<Vr.EPSILON&&Math.abs(M-j)<Vr.EPSILON?c1(t):(y=E-z,v=A-B,w=M-j,s=R*(w*=S=1/Math.hypot(y,v,w))-L*(v*=S),l=L*(y*=S)-k*w,u=k*v-R*y,(S=Math.hypot(s,l,u))?(s*=S=1/S,l*=S,u*=S):(s=0,l=0,u=0),h=v*u-w*l,f=w*s-y*u,m=y*l-v*s,(S=Math.hypot(h,f,m))?(h*=S=1/S,f*=S,m*=S):(h=0,f=0,m=0),t[0]=s,t[1]=h,t[2]=y,t[3]=0,t[4]=l,t[5]=f,t[6]=v,t[7]=0,t[8]=u,t[9]=m,t[10]=w,t[11]=0,t[12]=-(s*E+l*A+u*M),t[13]=-(h*E+f*A+m*M),t[14]=-(y*E+v*A+w*M),t[15]=1,t)},Qt.targetTo=function(t,e,n,i){var s=e[0],l=e[1],u=e[2],h=i[0],f=i[1],m=i[2],y=s-n[0],v=l-n[1],w=u-n[2],S=y*y+v*v+w*w;S>0&&(y*=S=1/Math.sqrt(S),v*=S,w*=S);var E=f*w-m*v,A=m*y-h*w,M=h*v-f*y;return(S=E*E+A*A+M*M)>0&&(E*=S=1/Math.sqrt(S),A*=S,M*=S),t[0]=E,t[1]=A,t[2]=M,t[3]=0,t[4]=v*M-w*A,t[5]=w*E-y*M,t[6]=y*A-v*E,t[7]=0,t[8]=y,t[9]=v,t[10]=w,t[11]=0,t[12]=s,t[13]=l,t[14]=u,t[15]=1,t},Qt.str=function(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"},Qt.frob=function(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15])},Qt.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t[8]=e[8]+n[8],t[9]=e[9]+n[9],t[10]=e[10]+n[10],t[11]=e[11]+n[11],t[12]=e[12]+n[12],t[13]=e[13]+n[13],t[14]=e[14]+n[14],t[15]=e[15]+n[15],t},Qt.subtract=Ql,Qt.multiplyScalar=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*n,t[9]=e[9]*n,t[10]=e[10]*n,t[11]=e[11]*n,t[12]=e[12]*n,t[13]=e[13]*n,t[14]=e[14]*n,t[15]=e[15]*n,t},Qt.multiplyScalarAndAdd=function(t,e,n,i){return t[0]=e[0]+n[0]*i,t[1]=e[1]+n[1]*i,t[2]=e[2]+n[2]*i,t[3]=e[3]+n[3]*i,t[4]=e[4]+n[4]*i,t[5]=e[5]+n[5]*i,t[6]=e[6]+n[6]*i,t[7]=e[7]+n[7]*i,t[8]=e[8]+n[8]*i,t[9]=e[9]+n[9]*i,t[10]=e[10]+n[10]*i,t[11]=e[11]+n[11]*i,t[12]=e[12]+n[12]*i,t[13]=e[13]+n[13]*i,t[14]=e[14]+n[14]*i,t[15]=e[15]+n[15]*i,t},Qt.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]},Qt.equals=function(t,e){var n=t[0],i=t[1],s=t[2],l=t[3],u=t[4],h=t[5],f=t[6],m=t[7],y=t[8],v=t[9],w=t[10],S=t[11],E=t[12],A=t[13],M=t[14],k=t[15],R=e[0],L=e[1],z=e[2],B=e[3],j=e[4],V=e[5],Y=e[6],ne=e[7],re=e[8],J=e[9],ae=e[10],le=e[11],oe=e[12],Ee=e[13],xe=e[14],Pe=e[15];return Math.abs(n-R)<=Vr.EPSILON*Math.max(1,Math.abs(n),Math.abs(R))&&Math.abs(i-L)<=Vr.EPSILON*Math.max(1,Math.abs(i),Math.abs(L))&&Math.abs(s-z)<=Vr.EPSILON*Math.max(1,Math.abs(s),Math.abs(z))&&Math.abs(l-B)<=Vr.EPSILON*Math.max(1,Math.abs(l),Math.abs(B))&&Math.abs(u-j)<=Vr.EPSILON*Math.max(1,Math.abs(u),Math.abs(j))&&Math.abs(h-V)<=Vr.EPSILON*Math.max(1,Math.abs(h),Math.abs(V))&&Math.abs(f-Y)<=Vr.EPSILON*Math.max(1,Math.abs(f),Math.abs(Y))&&Math.abs(m-ne)<=Vr.EPSILON*Math.max(1,Math.abs(m),Math.abs(ne))&&Math.abs(y-re)<=Vr.EPSILON*Math.max(1,Math.abs(y),Math.abs(re))&&Math.abs(v-J)<=Vr.EPSILON*Math.max(1,Math.abs(v),Math.abs(J))&&Math.abs(w-ae)<=Vr.EPSILON*Math.max(1,Math.abs(w),Math.abs(ae))&&Math.abs(S-le)<=Vr.EPSILON*Math.max(1,Math.abs(S),Math.abs(le))&&Math.abs(E-oe)<=Vr.EPSILON*Math.max(1,Math.abs(E),Math.abs(oe))&&Math.abs(A-Ee)<=Vr.EPSILON*Math.max(1,Math.abs(A),Math.abs(Ee))&&Math.abs(M-xe)<=Vr.EPSILON*Math.max(1,Math.abs(M),Math.abs(xe))&&Math.abs(k-Pe)<=Vr.EPSILON*Math.max(1,Math.abs(k),Math.abs(Pe))},Qt.sub=Qt.mul=Qt.ortho=Qt.perspective=void 0;var Vr=function(t,e){if(t&&t.__esModule)return t;if(t===null||Jp(t)!=="object"&&typeof t!="function")return{default:t};var n=em(void 0);if(n&&n.has(t))return n.get(t);var i={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var l in t)if(l!=="default"&&Object.prototype.hasOwnProperty.call(t,l)){var u=s?Object.getOwnPropertyDescriptor(t,l):null;u&&(u.get||u.set)?Object.defineProperty(i,l,u):i[l]=t[l]}return i.default=t,n&&n.set(t,i),i}(Jn);function em(t){if(typeof WeakMap!="function")return null;var e=new WeakMap,n=new WeakMap;return(em=function(i){return i?n:e})(t)}function c1(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function hl(t,e,n){var i=e[0],s=e[1],l=e[2],u=e[3],h=e[4],f=e[5],m=e[6],y=e[7],v=e[8],w=e[9],S=e[10],E=e[11],A=e[12],M=e[13],k=e[14],R=e[15],L=n[0],z=n[1],B=n[2],j=n[3];return t[0]=L*i+z*h+B*v+j*A,t[1]=L*s+z*f+B*w+j*M,t[2]=L*l+z*m+B*S+j*k,t[3]=L*u+z*y+B*E+j*R,t[4]=(L=n[4])*i+(z=n[5])*h+(B=n[6])*v+(j=n[7])*A,t[5]=L*s+z*f+B*w+j*M,t[6]=L*l+z*m+B*S+j*k,t[7]=L*u+z*y+B*E+j*R,t[8]=(L=n[8])*i+(z=n[9])*h+(B=n[10])*v+(j=n[11])*A,t[9]=L*s+z*f+B*w+j*M,t[10]=L*l+z*m+B*S+j*k,t[11]=L*u+z*y+B*E+j*R,t[12]=(L=n[12])*i+(z=n[13])*h+(B=n[14])*v+(j=n[15])*A,t[13]=L*s+z*f+B*w+j*M,t[14]=L*l+z*m+B*S+j*k,t[15]=L*u+z*y+B*E+j*R,t}function Qy(t,e,n){var i=e[0],s=e[1],l=e[2],u=e[3],h=i+i,f=s+s,m=l+l,y=i*h,v=i*f,w=i*m,S=s*f,E=s*m,A=l*m,M=u*h,k=u*f,R=u*m;return t[0]=1-(S+A),t[1]=v+R,t[2]=w-k,t[3]=0,t[4]=v-R,t[5]=1-(y+A),t[6]=E+M,t[7]=0,t[8]=w+k,t[9]=E-M,t[10]=1-(y+S),t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t}function tm(t,e){var n=e[4],i=e[5],s=e[6],l=e[8],u=e[9],h=e[10];return t[0]=Math.hypot(e[0],e[1],e[2]),t[1]=Math.hypot(n,i,s),t[2]=Math.hypot(l,u,h),t}function Yl(t,e,n,i,s){var l,u=1/Math.tan(e/2);return t[0]=u/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=u,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,s!=null&&s!==1/0?(t[10]=(s+i)*(l=1/(i-s)),t[14]=2*s*i*l):(t[10]=-1,t[14]=-2*i),t}function nm(t,e,n,i,s,l,u){var h=1/(e-n),f=1/(i-s),m=1/(l-u);return t[0]=-2*h,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*f,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*m,t[11]=0,t[12]=(e+n)*h,t[13]=(s+i)*f,t[14]=(u+l)*m,t[15]=1,t}function Ql(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t[6]=e[6]-n[6],t[7]=e[7]-n[7],t[8]=e[8]-n[8],t[9]=e[9]-n[9],t[10]=e[10]-n[10],t[11]=e[11]-n[11],t[12]=e[12]-n[12],t[13]=e[13]-n[13],t[14]=e[14]-n[14],t[15]=e[15]-n[15],t}Qt.perspective=Yl,Qt.ortho=nm,Qt.mul=hl,Qt.sub=Ql;var hn={},yn={};function nf(t){return nf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},nf(t)}Object.defineProperty(yn,"__esModule",{value:!0}),yn.create=d1,yn.clone=function(t){var e=new Rs.ARRAY_TYPE(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},yn.length=Jy,yn.fromValues=function(t,e,n){var i=new Rs.ARRAY_TYPE(3);return i[0]=t,i[1]=e,i[2]=n,i},yn.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},yn.set=function(t,e,n,i){return t[0]=e,t[1]=n,t[2]=i,t},yn.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t},yn.subtract=e_,yn.multiply=Jl,yn.divide=f1,yn.ceil=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t},yn.floor=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t},yn.min=function(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t},yn.max=function(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t},yn.round=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t},yn.scale=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t},yn.scaleAndAdd=function(t,e,n,i){return t[0]=e[0]+n[0]*i,t[1]=e[1]+n[1]*i,t[2]=e[2]+n[2]*i,t},yn.distance=Ju,yn.squaredDistance=t_,yn.squaredLength=vi,yn.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t},yn.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t},yn.normalize=function(t,e){var n=e[0],i=e[1],s=e[2],l=n*n+i*i+s*s;return l>0&&(l=1/Math.sqrt(l)),t[0]=e[0]*l,t[1]=e[1]*l,t[2]=e[2]*l,t},yn.dot=p1,yn.cross=function(t,e,n){var i=e[0],s=e[1],l=e[2],u=n[0],h=n[1],f=n[2];return t[0]=s*f-l*h,t[1]=l*u-i*f,t[2]=i*h-s*u,t},yn.lerp=function(t,e,n,i){var s=e[0],l=e[1],u=e[2];return t[0]=s+i*(n[0]-s),t[1]=l+i*(n[1]-l),t[2]=u+i*(n[2]-u),t},yn.hermite=function(t,e,n,i,s,l){var u=l*l,h=u*(2*l-3)+1,f=u*(l-2)+l,m=u*(l-1),y=u*(3-2*l);return t[0]=e[0]*h+n[0]*f+i[0]*m+s[0]*y,t[1]=e[1]*h+n[1]*f+i[1]*m+s[1]*y,t[2]=e[2]*h+n[2]*f+i[2]*m+s[2]*y,t},yn.bezier=function(t,e,n,i,s,l){var u=1-l,h=u*u,f=l*l,m=h*u,y=3*l*h,v=3*f*u,w=f*l;return t[0]=e[0]*m+n[0]*y+i[0]*v+s[0]*w,t[1]=e[1]*m+n[1]*y+i[1]*v+s[1]*w,t[2]=e[2]*m+n[2]*y+i[2]*v+s[2]*w,t},yn.random=function(t,e){e=e||1;var n=2*Rs.RANDOM()*Math.PI,i=2*Rs.RANDOM()-1,s=Math.sqrt(1-i*i)*e;return t[0]=Math.cos(n)*s,t[1]=Math.sin(n)*s,t[2]=i*e,t},yn.transformMat4=function(t,e,n){var i=e[0],s=e[1],l=e[2],u=n[3]*i+n[7]*s+n[11]*l+n[15];return t[0]=(n[0]*i+n[4]*s+n[8]*l+n[12])/(u=u||1),t[1]=(n[1]*i+n[5]*s+n[9]*l+n[13])/u,t[2]=(n[2]*i+n[6]*s+n[10]*l+n[14])/u,t},yn.transformMat3=function(t,e,n){var i=e[0],s=e[1],l=e[2];return t[0]=i*n[0]+s*n[3]+l*n[6],t[1]=i*n[1]+s*n[4]+l*n[7],t[2]=i*n[2]+s*n[5]+l*n[8],t},yn.transformQuat=function(t,e,n){var i=n[0],s=n[1],l=n[2],u=e[0],h=e[1],f=e[2],m=s*f-l*h,y=l*u-i*f,v=i*h-s*u,w=s*v-l*y,S=l*m-i*v,E=i*y-s*m,A=2*n[3];return y*=A,v*=A,S*=2,E*=2,t[0]=u+(m*=A)+(w*=2),t[1]=h+y+S,t[2]=f+v+E,t},yn.rotateX=function(t,e,n,i){var s=[],l=[];return s[0]=e[0]-n[0],s[1]=e[1]-n[1],s[2]=e[2]-n[2],l[0]=s[0],l[1]=s[1]*Math.cos(i)-s[2]*Math.sin(i),l[2]=s[1]*Math.sin(i)+s[2]*Math.cos(i),t[0]=l[0]+n[0],t[1]=l[1]+n[1],t[2]=l[2]+n[2],t},yn.rotateY=function(t,e,n,i){var s=[],l=[];return s[0]=e[0]-n[0],s[1]=e[1]-n[1],s[2]=e[2]-n[2],l[0]=s[2]*Math.sin(i)+s[0]*Math.cos(i),l[1]=s[1],l[2]=s[2]*Math.cos(i)-s[0]*Math.sin(i),t[0]=l[0]+n[0],t[1]=l[1]+n[1],t[2]=l[2]+n[2],t},yn.rotateZ=function(t,e,n,i){var s=[],l=[];return s[0]=e[0]-n[0],s[1]=e[1]-n[1],s[2]=e[2]-n[2],l[0]=s[0]*Math.cos(i)-s[1]*Math.sin(i),l[1]=s[0]*Math.sin(i)+s[1]*Math.cos(i),l[2]=s[2],t[0]=l[0]+n[0],t[1]=l[1]+n[1],t[2]=l[2]+n[2],t},yn.angle=function(t,e){var n=t[0],i=t[1],s=t[2],l=e[0],u=e[1],h=e[2],f=Math.sqrt(n*n+i*i+s*s)*Math.sqrt(l*l+u*u+h*h),m=f&&p1(t,e)/f;return Math.acos(Math.min(Math.max(m,-1),1))},yn.zero=function(t){return t[0]=0,t[1]=0,t[2]=0,t},yn.str=function(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"},yn.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]},yn.equals=function(t,e){var n=t[0],i=t[1],s=t[2],l=e[0],u=e[1],h=e[2];return Math.abs(n-l)<=Rs.EPSILON*Math.max(1,Math.abs(n),Math.abs(l))&&Math.abs(i-u)<=Rs.EPSILON*Math.max(1,Math.abs(i),Math.abs(u))&&Math.abs(s-h)<=Rs.EPSILON*Math.max(1,Math.abs(s),Math.abs(h))},yn.forEach=yn.sqrLen=yn.len=yn.sqrDist=yn.dist=yn.div=yn.mul=yn.sub=void 0;var Rs=function(t,e){if(t&&t.__esModule)return t;if(t===null||nf(t)!=="object"&&typeof t!="function")return{default:t};var n=h1(void 0);if(n&&n.has(t))return n.get(t);var i={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var l in t)if(l!=="default"&&Object.prototype.hasOwnProperty.call(t,l)){var u=s?Object.getOwnPropertyDescriptor(t,l):null;u&&(u.get||u.set)?Object.defineProperty(i,l,u):i[l]=t[l]}return i.default=t,n&&n.set(t,i),i}(Jn);function h1(t){if(typeof WeakMap!="function")return null;var e=new WeakMap,n=new WeakMap;return(h1=function(i){return i?n:e})(t)}function d1(){var t=new Rs.ARRAY_TYPE(3);return Rs.ARRAY_TYPE!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function Jy(t){return Math.hypot(t[0],t[1],t[2])}function e_(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t}function Jl(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t}function f1(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t}function Ju(t,e){return Math.hypot(e[0]-t[0],e[1]-t[1],e[2]-t[2])}function t_(t,e){var n=e[0]-t[0],i=e[1]-t[1],s=e[2]-t[2];return n*n+i*i+s*s}function vi(t){var e=t[0],n=t[1],i=t[2];return e*e+n*n+i*i}function p1(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}yn.sub=e_,yn.mul=Jl,yn.div=f1,yn.dist=Ju,yn.sqrDist=t_,yn.len=Jy,yn.sqrLen=vi;var Sa,Y2=(Sa=d1(),function(t,e,n,i,s,l){var u,h;for(e||(e=3),n||(n=0),h=i?Math.min(i*e+n,t.length):t.length,u=n;u<h;u+=e)Sa[0]=t[u],Sa[1]=t[u+1],Sa[2]=t[u+2],s(Sa,Sa,l),t[u]=Sa[0],t[u+1]=Sa[1],t[u+2]=Sa[2];return t});yn.forEach=Y2;var kn={};function rm(t){return rm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},rm(t)}Object.defineProperty(kn,"__esModule",{value:!0}),kn.create=ms,kn.clone=function(t){var e=new ps.ARRAY_TYPE(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},kn.fromValues=function(t,e,n,i){var s=new ps.ARRAY_TYPE(4);return s[0]=t,s[1]=e,s[2]=n,s[3]=i,s},kn.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},kn.set=function(t,e,n,i,s){return t[0]=e,t[1]=n,t[2]=i,t[3]=s,t},kn.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t},kn.subtract=im,kn.multiply=g1,kn.divide=dl,kn.ceil=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t[3]=Math.ceil(e[3]),t},kn.floor=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t[3]=Math.floor(e[3]),t},kn.min=function(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t[3]=Math.min(e[3],n[3]),t},kn.max=function(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t[3]=Math.max(e[3],n[3]),t},kn.round=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t[3]=Math.round(e[3]),t},kn.scale=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t},kn.scaleAndAdd=function(t,e,n,i){return t[0]=e[0]+n[0]*i,t[1]=e[1]+n[1]*i,t[2]=e[2]+n[2]*i,t[3]=e[3]+n[3]*i,t},kn.distance=rf,kn.squaredDistance=eu,kn.length=of,kn.squaredLength=om,kn.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t},kn.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t[3]=1/e[3],t},kn.normalize=function(t,e){var n=e[0],i=e[1],s=e[2],l=e[3],u=n*n+i*i+s*s+l*l;return u>0&&(u=1/Math.sqrt(u)),t[0]=n*u,t[1]=i*u,t[2]=s*u,t[3]=l*u,t},kn.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]},kn.cross=function(t,e,n,i){var s=n[0]*i[1]-n[1]*i[0],l=n[0]*i[2]-n[2]*i[0],u=n[0]*i[3]-n[3]*i[0],h=n[1]*i[2]-n[2]*i[1],f=n[1]*i[3]-n[3]*i[1],m=n[2]*i[3]-n[3]*i[2],y=e[0],v=e[1],w=e[2],S=e[3];return t[0]=v*m-w*f+S*h,t[1]=-y*m+w*u-S*l,t[2]=y*f-v*u+S*s,t[3]=-y*h+v*l-w*s,t},kn.lerp=function(t,e,n,i){var s=e[0],l=e[1],u=e[2],h=e[3];return t[0]=s+i*(n[0]-s),t[1]=l+i*(n[1]-l),t[2]=u+i*(n[2]-u),t[3]=h+i*(n[3]-h),t},kn.random=function(t,e){var n,i,s,l,u,h;e=e||1;do u=(n=2*ps.RANDOM()-1)*n+(i=2*ps.RANDOM()-1)*i;while(u>=1);do h=(s=2*ps.RANDOM()-1)*s+(l=2*ps.RANDOM()-1)*l;while(h>=1);var f=Math.sqrt((1-u)/h);return t[0]=e*n,t[1]=e*i,t[2]=e*s*f,t[3]=e*l*f,t},kn.transformMat4=function(t,e,n){var i=e[0],s=e[1],l=e[2],u=e[3];return t[0]=n[0]*i+n[4]*s+n[8]*l+n[12]*u,t[1]=n[1]*i+n[5]*s+n[9]*l+n[13]*u,t[2]=n[2]*i+n[6]*s+n[10]*l+n[14]*u,t[3]=n[3]*i+n[7]*s+n[11]*l+n[15]*u,t},kn.transformQuat=function(t,e,n){var i=e[0],s=e[1],l=e[2],u=n[0],h=n[1],f=n[2],m=n[3],y=m*i+h*l-f*s,v=m*s+f*i-u*l,w=m*l+u*s-h*i,S=-u*i-h*s-f*l;return t[0]=y*m+S*-u+v*-f-w*-h,t[1]=v*m+S*-h+w*-u-y*-f,t[2]=w*m+S*-f+y*-h-v*-u,t[3]=e[3],t},kn.zero=function(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t},kn.str=function(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},kn.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]},kn.equals=function(t,e){var n=t[0],i=t[1],s=t[2],l=t[3],u=e[0],h=e[1],f=e[2],m=e[3];return Math.abs(n-u)<=ps.EPSILON*Math.max(1,Math.abs(n),Math.abs(u))&&Math.abs(i-h)<=ps.EPSILON*Math.max(1,Math.abs(i),Math.abs(h))&&Math.abs(s-f)<=ps.EPSILON*Math.max(1,Math.abs(s),Math.abs(f))&&Math.abs(l-m)<=ps.EPSILON*Math.max(1,Math.abs(l),Math.abs(m))},kn.forEach=kn.sqrLen=kn.len=kn.sqrDist=kn.dist=kn.div=kn.mul=kn.sub=void 0;var ps=function(t,e){if(t&&t.__esModule)return t;if(t===null||rm(t)!=="object"&&typeof t!="function")return{default:t};var n=m1(void 0);if(n&&n.has(t))return n.get(t);var i={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var l in t)if(l!=="default"&&Object.prototype.hasOwnProperty.call(t,l)){var u=s?Object.getOwnPropertyDescriptor(t,l):null;u&&(u.get||u.set)?Object.defineProperty(i,l,u):i[l]=t[l]}return i.default=t,n&&n.set(t,i),i}(Jn);function m1(t){if(typeof WeakMap!="function")return null;var e=new WeakMap,n=new WeakMap;return(m1=function(i){return i?n:e})(t)}function ms(){var t=new ps.ARRAY_TYPE(4);return ps.ARRAY_TYPE!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function im(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t}function g1(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t[3]=e[3]*n[3],t}function dl(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t[3]=e[3]/n[3],t}function rf(t,e){return Math.hypot(e[0]-t[0],e[1]-t[1],e[2]-t[2],e[3]-t[3])}function eu(t,e){var n=e[0]-t[0],i=e[1]-t[1],s=e[2]-t[2],l=e[3]-t[3];return n*n+i*i+s*s+l*l}function of(t){return Math.hypot(t[0],t[1],t[2],t[3])}function om(t){var e=t[0],n=t[1],i=t[2],s=t[3];return e*e+n*n+i*i+s*s}kn.sub=im,kn.mul=g1,kn.div=dl,kn.dist=rf,kn.sqrDist=eu,kn.len=of,kn.sqrLen=om;var n_=function(){var t=ms();return function(e,n,i,s,l,u){var h,f;for(n||(n=4),i||(i=0),f=s?Math.min(s*n+i,e.length):e.length,h=i;h<f;h+=n)t[0]=e[h],t[1]=e[h+1],t[2]=e[h+2],t[3]=e[h+3],l(t,t,u),e[h]=t[0],e[h+1]=t[1],e[h+2]=t[2],e[h+3]=t[3];return e}}();function r_(t){return r_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r_(t)}kn.forEach=n_,Object.defineProperty(hn,"__esModule",{value:!0}),hn.create=sm,hn.identity=function(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t},hn.setAxisAngle=am,hn.getAxisAngle=function(t,e){var n=2*Math.acos(e[3]),i=Math.sin(n/2);return i>fl.EPSILON?(t[0]=e[0]/i,t[1]=e[1]/i,t[2]=e[2]/i):(t[0]=1,t[1]=0,t[2]=0),n},hn.getAngle=function(t,e){var n=o_(t,e);return Math.acos(2*n*n-1)},hn.multiply=y1,hn.rotateX=function(t,e,n){n*=.5;var i=e[0],s=e[1],l=e[2],u=e[3],h=Math.sin(n),f=Math.cos(n);return t[0]=i*f+u*h,t[1]=s*f+l*h,t[2]=l*f-s*h,t[3]=u*f-i*h,t},hn.rotateY=function(t,e,n){n*=.5;var i=e[0],s=e[1],l=e[2],u=e[3],h=Math.sin(n),f=Math.cos(n);return t[0]=i*f-l*h,t[1]=s*f+u*h,t[2]=l*f+i*h,t[3]=u*f-s*h,t},hn.rotateZ=function(t,e,n){n*=.5;var i=e[0],s=e[1],l=e[2],u=e[3],h=Math.sin(n),f=Math.cos(n);return t[0]=i*f+s*h,t[1]=s*f-i*h,t[2]=l*f+u*h,t[3]=u*f-l*h,t},hn.calculateW=function(t,e){var n=e[0],i=e[1],s=e[2];return t[0]=n,t[1]=i,t[2]=s,t[3]=Math.sqrt(Math.abs(1-n*n-i*i-s*s)),t},hn.exp=i_,hn.ln=lm,hn.pow=function(t,e,n){return lm(t,e),af(t,t,n),i_(t,t),t},hn.slerp=tc,hn.random=function(t){var e=fl.RANDOM(),n=fl.RANDOM(),i=fl.RANDOM(),s=Math.sqrt(1-e),l=Math.sqrt(e);return t[0]=s*Math.sin(2*Math.PI*n),t[1]=s*Math.cos(2*Math.PI*n),t[2]=l*Math.sin(2*Math.PI*i),t[3]=l*Math.cos(2*Math.PI*i),t},hn.invert=function(t,e){var n=e[0],i=e[1],s=e[2],l=e[3],u=n*n+i*i+s*s+l*l,h=u?1/u:0;return t[0]=-n*h,t[1]=-i*h,t[2]=-s*h,t[3]=l*h,t},hn.conjugate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t},hn.fromMat3=um,hn.fromEuler=function(t,e,n,i){var s=.5*Math.PI/180;e*=s,n*=s,i*=s;var l=Math.sin(e),u=Math.cos(e),h=Math.sin(n),f=Math.cos(n),m=Math.sin(i),y=Math.cos(i);return t[0]=l*f*y-u*h*m,t[1]=u*h*y+l*f*m,t[2]=u*f*m-l*h*y,t[3]=u*f*y+l*h*m,t},hn.str=function(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},hn.setAxes=hn.sqlerp=hn.rotationTo=hn.equals=hn.exactEquals=hn.normalize=hn.sqrLen=hn.squaredLength=hn.len=hn.length=hn.lerp=hn.dot=hn.scale=hn.mul=hn.add=hn.set=hn.copy=hn.fromValues=hn.clone=void 0;var fl=ec(Jn),Q2=ec(er),Ea=ec(yn),Yo=ec(kn);function sf(t){if(typeof WeakMap!="function")return null;var e=new WeakMap,n=new WeakMap;return(sf=function(i){return i?n:e})(t)}function ec(t,e){if(!e&&t&&t.__esModule)return t;if(t===null||r_(t)!=="object"&&typeof t!="function")return{default:t};var n=sf(e);if(n&&n.has(t))return n.get(t);var i={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var l in t)if(l!=="default"&&Object.prototype.hasOwnProperty.call(t,l)){var u=s?Object.getOwnPropertyDescriptor(t,l):null;u&&(u.get||u.set)?Object.defineProperty(i,l,u):i[l]=t[l]}return i.default=t,n&&n.set(t,i),i}function sm(){var t=new fl.ARRAY_TYPE(4);return fl.ARRAY_TYPE!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function am(t,e,n){n*=.5;var i=Math.sin(n);return t[0]=i*e[0],t[1]=i*e[1],t[2]=i*e[2],t[3]=Math.cos(n),t}function y1(t,e,n){var i=e[0],s=e[1],l=e[2],u=e[3],h=n[0],f=n[1],m=n[2],y=n[3];return t[0]=i*y+u*h+s*m-l*f,t[1]=s*y+u*f+l*h-i*m,t[2]=l*y+u*m+i*f-s*h,t[3]=u*y-i*h-s*f-l*m,t}function i_(t,e){var n=e[0],i=e[1],s=e[2],l=e[3],u=Math.sqrt(n*n+i*i+s*s),h=Math.exp(l),f=u>0?h*Math.sin(u)/u:0;return t[0]=n*f,t[1]=i*f,t[2]=s*f,t[3]=h*Math.cos(u),t}function lm(t,e){var n=e[0],i=e[1],s=e[2],l=e[3],u=Math.sqrt(n*n+i*i+s*s),h=u>0?Math.atan2(u,l)/u:0;return t[0]=n*h,t[1]=i*h,t[2]=s*h,t[3]=.5*Math.log(n*n+i*i+s*s+l*l),t}function tc(t,e,n,i){var s,l,u,h,f,m=e[0],y=e[1],v=e[2],w=e[3],S=n[0],E=n[1],A=n[2],M=n[3];return(l=m*S+y*E+v*A+w*M)<0&&(l=-l,S=-S,E=-E,A=-A,M=-M),1-l>fl.EPSILON?(s=Math.acos(l),u=Math.sin(s),h=Math.sin((1-i)*s)/u,f=Math.sin(i*s)/u):(h=1-i,f=i),t[0]=h*m+f*S,t[1]=h*y+f*E,t[2]=h*v+f*A,t[3]=h*w+f*M,t}function um(t,e){var n,i=e[0]+e[4]+e[8];if(i>0)n=Math.sqrt(i+1),t[3]=.5*n,t[0]=(e[5]-e[7])*(n=.5/n),t[1]=(e[6]-e[2])*n,t[2]=(e[1]-e[3])*n;else{var s=0;e[4]>e[0]&&(s=1),e[8]>e[3*s+s]&&(s=2);var l=(s+1)%3,u=(s+2)%3;n=Math.sqrt(e[3*s+s]-e[3*l+l]-e[3*u+u]+1),t[s]=.5*n,t[3]=(e[3*l+u]-e[3*u+l])*(n=.5/n),t[l]=(e[3*l+s]+e[3*s+l])*n,t[u]=(e[3*u+s]+e[3*s+u])*n}return t}hn.clone=Yo.clone,hn.fromValues=Yo.fromValues,hn.copy=Yo.copy,hn.set=Yo.set,hn.add=Yo.add,hn.mul=y1;var af=Yo.scale;hn.scale=af;var o_=Yo.dot;hn.dot=o_,hn.lerp=Yo.lerp;var _1=Yo.length;hn.length=_1,hn.len=_1;var lf=Yo.squaredLength;hn.squaredLength=lf,hn.sqrLen=lf;var s_=Yo.normalize;hn.normalize=s_,hn.exactEquals=Yo.exactEquals,hn.equals=Yo.equals;var No,v1,uf,d=(No=Ea.create(),v1=Ea.fromValues(1,0,0),uf=Ea.fromValues(0,1,0),function(t,e,n){var i=Ea.dot(e,n);return i<-.999999?(Ea.cross(No,v1,e),Ea.len(No)<1e-6&&Ea.cross(No,uf,e),Ea.normalize(No,No),am(t,No,Math.PI),t):i>.999999?(t[0]=0,t[1]=0,t[2]=0,t[3]=1,t):(Ea.cross(No,e,n),t[0]=No[0],t[1]=No[1],t[2]=No[2],t[3]=1+i,s_(t,t))});hn.rotationTo=d;var g,b,I=(g=sm(),b=sm(),function(t,e,n,i,s,l){return tc(g,e,s,l),tc(b,n,i,l),tc(t,g,b,2*l*(1-l)),t});hn.sqlerp=I;var D,N=(D=Q2.create(),function(t,e,n,i){return D[0]=n[0],D[3]=n[1],D[6]=n[2],D[1]=i[0],D[4]=i[1],D[7]=i[2],D[2]=-e[0],D[5]=-e[1],D[8]=-e[2],s_(t,um(t,D))});hn.setAxes=N;var X={};function ve(t){return ve=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ve(t)}Object.defineProperty(X,"__esModule",{value:!0}),X.create=function(){var t=new Ce.ARRAY_TYPE(8);return Ce.ARRAY_TYPE!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[4]=0,t[5]=0,t[6]=0,t[7]=0),t[3]=1,t},X.clone=function(t){var e=new Ce.ARRAY_TYPE(8);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e},X.fromValues=function(t,e,n,i,s,l,u,h){var f=new Ce.ARRAY_TYPE(8);return f[0]=t,f[1]=e,f[2]=n,f[3]=i,f[4]=s,f[5]=l,f[6]=u,f[7]=h,f},X.fromRotationTranslationValues=function(t,e,n,i,s,l,u){var h=new Ce.ARRAY_TYPE(8);h[0]=t,h[1]=e,h[2]=n,h[3]=i;var f=.5*s,m=.5*l,y=.5*u;return h[4]=f*i+m*n-y*e,h[5]=m*i+y*t-f*n,h[6]=y*i+f*e-m*t,h[7]=-f*t-m*e-y*n,h},X.fromRotationTranslation=Jt,X.fromTranslation=function(t,e){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t[4]=.5*e[0],t[5]=.5*e[1],t[6]=.5*e[2],t[7]=0,t},X.fromRotation=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=0,t[5]=0,t[6]=0,t[7]=0,t},X.fromMat4=function(t,e){var n=Ye.create();At.getRotation(n,e);var i=new Ce.ARRAY_TYPE(3);return At.getTranslation(i,e),Jt(t,n,i),t},X.copy=on,X.identity=function(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t[6]=0,t[7]=0,t},X.set=function(t,e,n,i,s,l,u,h,f){return t[0]=e,t[1]=n,t[2]=i,t[3]=s,t[4]=l,t[5]=u,t[6]=h,t[7]=f,t},X.getDual=function(t,e){return t[0]=e[4],t[1]=e[5],t[2]=e[6],t[3]=e[7],t},X.setDual=function(t,e){return t[4]=e[0],t[5]=e[1],t[6]=e[2],t[7]=e[3],t},X.getTranslation=function(t,e){var n=e[4],i=e[5],s=e[6],l=e[7],u=-e[0],h=-e[1],f=-e[2],m=e[3];return t[0]=2*(n*m+l*u+i*f-s*h),t[1]=2*(i*m+l*h+s*u-n*f),t[2]=2*(s*m+l*f+n*h-i*u),t},X.translate=function(t,e,n){var i=e[0],s=e[1],l=e[2],u=e[3],h=.5*n[0],f=.5*n[1],m=.5*n[2],y=e[4],v=e[5],w=e[6],S=e[7];return t[0]=i,t[1]=s,t[2]=l,t[3]=u,t[4]=u*h+s*m-l*f+y,t[5]=u*f+l*h-i*m+v,t[6]=u*m+i*f-s*h+w,t[7]=-i*h-s*f-l*m+S,t},X.rotateX=function(t,e,n){var i=-e[0],s=-e[1],l=-e[2],u=e[3],h=e[4],f=e[5],m=e[6],y=e[7],v=h*u+y*i+f*l-m*s,w=f*u+y*s+m*i-h*l,S=m*u+y*l+h*s-f*i,E=y*u-h*i-f*s-m*l;return Ye.rotateX(t,e,n),t[4]=v*(u=t[3])+E*(i=t[0])+w*(l=t[2])-S*(s=t[1]),t[5]=w*u+E*s+S*i-v*l,t[6]=S*u+E*l+v*s-w*i,t[7]=E*u-v*i-w*s-S*l,t},X.rotateY=function(t,e,n){var i=-e[0],s=-e[1],l=-e[2],u=e[3],h=e[4],f=e[5],m=e[6],y=e[7],v=h*u+y*i+f*l-m*s,w=f*u+y*s+m*i-h*l,S=m*u+y*l+h*s-f*i,E=y*u-h*i-f*s-m*l;return Ye.rotateY(t,e,n),t[4]=v*(u=t[3])+E*(i=t[0])+w*(l=t[2])-S*(s=t[1]),t[5]=w*u+E*s+S*i-v*l,t[6]=S*u+E*l+v*s-w*i,t[7]=E*u-v*i-w*s-S*l,t},X.rotateZ=function(t,e,n){var i=-e[0],s=-e[1],l=-e[2],u=e[3],h=e[4],f=e[5],m=e[6],y=e[7],v=h*u+y*i+f*l-m*s,w=f*u+y*s+m*i-h*l,S=m*u+y*l+h*s-f*i,E=y*u-h*i-f*s-m*l;return Ye.rotateZ(t,e,n),t[4]=v*(u=t[3])+E*(i=t[0])+w*(l=t[2])-S*(s=t[1]),t[5]=w*u+E*s+S*i-v*l,t[6]=S*u+E*l+v*s-w*i,t[7]=E*u-v*i-w*s-S*l,t},X.rotateByQuatAppend=function(t,e,n){var i=n[0],s=n[1],l=n[2],u=n[3],h=e[0],f=e[1],m=e[2],y=e[3];return t[0]=h*u+y*i+f*l-m*s,t[1]=f*u+y*s+m*i-h*l,t[2]=m*u+y*l+h*s-f*i,t[3]=y*u-h*i-f*s-m*l,t[4]=(h=e[4])*u+(y=e[7])*i+(f=e[5])*l-(m=e[6])*s,t[5]=f*u+y*s+m*i-h*l,t[6]=m*u+y*l+h*s-f*i,t[7]=y*u-h*i-f*s-m*l,t},X.rotateByQuatPrepend=function(t,e,n){var i=e[0],s=e[1],l=e[2],u=e[3],h=n[0],f=n[1],m=n[2],y=n[3];return t[0]=i*y+u*h+s*m-l*f,t[1]=s*y+u*f+l*h-i*m,t[2]=l*y+u*m+i*f-s*h,t[3]=u*y-i*h-s*f-l*m,t[4]=i*(y=n[7])+u*(h=n[4])+s*(m=n[6])-l*(f=n[5]),t[5]=s*y+u*f+l*h-i*m,t[6]=l*y+u*m+i*f-s*h,t[7]=u*y-i*h-s*f-l*m,t},X.rotateAroundAxis=function(t,e,n,i){if(Math.abs(i)<Ce.EPSILON)return on(t,e);var s=Math.hypot(n[0],n[1],n[2]);i*=.5;var l=Math.sin(i),u=l*n[0]/s,h=l*n[1]/s,f=l*n[2]/s,m=Math.cos(i),y=e[0],v=e[1],w=e[2],S=e[3];t[0]=y*m+S*u+v*f-w*h,t[1]=v*m+S*h+w*u-y*f,t[2]=w*m+S*f+y*h-v*u,t[3]=S*m-y*u-v*h-w*f;var E=e[4],A=e[5],M=e[6],k=e[7];return t[4]=E*m+k*u+A*f-M*h,t[5]=A*m+k*h+M*u-E*f,t[6]=M*m+k*f+E*h-A*u,t[7]=k*m-E*u-A*h-M*f,t},X.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t},X.multiply=un,X.scale=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t},X.lerp=function(t,e,n,i){var s=1-i;return Ti(e,n)<0&&(i=-i),t[0]=e[0]*s+n[0]*i,t[1]=e[1]*s+n[1]*i,t[2]=e[2]*s+n[2]*i,t[3]=e[3]*s+n[3]*i,t[4]=e[4]*s+n[4]*i,t[5]=e[5]*s+n[5]*i,t[6]=e[6]*s+n[6]*i,t[7]=e[7]*s+n[7]*i,t},X.invert=function(t,e){var n=Fe(e);return t[0]=-e[0]/n,t[1]=-e[1]/n,t[2]=-e[2]/n,t[3]=e[3]/n,t[4]=-e[4]/n,t[5]=-e[5]/n,t[6]=-e[6]/n,t[7]=e[7]/n,t},X.conjugate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t[4]=-e[4],t[5]=-e[5],t[6]=-e[6],t[7]=e[7],t},X.normalize=function(t,e){var n=Fe(e);if(n>0){n=Math.sqrt(n);var i=e[0]/n,s=e[1]/n,l=e[2]/n,u=e[3]/n,h=e[4],f=e[5],m=e[6],y=e[7],v=i*h+s*f+l*m+u*y;t[0]=i,t[1]=s,t[2]=l,t[3]=u,t[4]=(h-i*v)/n,t[5]=(f-s*v)/n,t[6]=(m-l*v)/n,t[7]=(y-u*v)/n}return t},X.str=function(t){return"quat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+")"},X.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]},X.equals=function(t,e){var n=t[0],i=t[1],s=t[2],l=t[3],u=t[4],h=t[5],f=t[6],m=t[7],y=e[0],v=e[1],w=e[2],S=e[3],E=e[4],A=e[5],M=e[6],k=e[7];return Math.abs(n-y)<=Ce.EPSILON*Math.max(1,Math.abs(n),Math.abs(y))&&Math.abs(i-v)<=Ce.EPSILON*Math.max(1,Math.abs(i),Math.abs(v))&&Math.abs(s-w)<=Ce.EPSILON*Math.max(1,Math.abs(s),Math.abs(w))&&Math.abs(l-S)<=Ce.EPSILON*Math.max(1,Math.abs(l),Math.abs(S))&&Math.abs(u-E)<=Ce.EPSILON*Math.max(1,Math.abs(u),Math.abs(E))&&Math.abs(h-A)<=Ce.EPSILON*Math.max(1,Math.abs(h),Math.abs(A))&&Math.abs(f-M)<=Ce.EPSILON*Math.max(1,Math.abs(f),Math.abs(M))&&Math.abs(m-k)<=Ce.EPSILON*Math.max(1,Math.abs(m),Math.abs(k))},X.sqrLen=X.squaredLength=X.len=X.length=X.dot=X.mul=X.setReal=X.getReal=void 0;var Ce=Tt(Jn),Ye=Tt(hn),At=Tt(Qt);function Dt(t){if(typeof WeakMap!="function")return null;var e=new WeakMap,n=new WeakMap;return(Dt=function(i){return i?n:e})(t)}function Tt(t,e){if(!e&&t&&t.__esModule)return t;if(t===null||ve(t)!=="object"&&typeof t!="function")return{default:t};var n=Dt(e);if(n&&n.has(t))return n.get(t);var i={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var l in t)if(l!=="default"&&Object.prototype.hasOwnProperty.call(t,l)){var u=s?Object.getOwnPropertyDescriptor(t,l):null;u&&(u.get||u.set)?Object.defineProperty(i,l,u):i[l]=t[l]}return i.default=t,n&&n.set(t,i),i}function Jt(t,e,n){var i=.5*n[0],s=.5*n[1],l=.5*n[2],u=e[0],h=e[1],f=e[2],m=e[3];return t[0]=u,t[1]=h,t[2]=f,t[3]=m,t[4]=i*m+s*f-l*h,t[5]=s*m+l*u-i*f,t[6]=l*m+i*h-s*u,t[7]=-i*u-s*h-l*f,t}function on(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t}function un(t,e,n){var i=e[0],s=e[1],l=e[2],u=e[3],h=n[4],f=n[5],m=n[6],y=n[7],v=e[4],w=e[5],S=e[6],E=e[7],A=n[0],M=n[1],k=n[2],R=n[3];return t[0]=i*R+u*A+s*k-l*M,t[1]=s*R+u*M+l*A-i*k,t[2]=l*R+u*k+i*M-s*A,t[3]=u*R-i*A-s*M-l*k,t[4]=i*y+u*h+s*m-l*f+v*R+E*A+w*k-S*M,t[5]=s*y+u*f+l*h-i*m+w*R+E*M+S*A-v*k,t[6]=l*y+u*m+i*f-s*h+S*R+E*k+v*M-w*A,t[7]=u*y-i*h-s*f-l*m+E*R-v*A-w*M-S*k,t}X.getReal=Ye.copy,X.setReal=Ye.copy,X.mul=un;var Ti=Ye.dot;X.dot=Ti;var Ze=Ye.length;X.length=Ze,X.len=Ze;var Fe=Ye.squaredLength;X.squaredLength=Fe,X.sqrLen=Fe;var Re={};function Bt(t){return Bt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Bt(t)}Object.defineProperty(Re,"__esModule",{value:!0}),Re.create=Cn,Re.clone=function(t){var e=new rn.ARRAY_TYPE(2);return e[0]=t[0],e[1]=t[1],e},Re.fromValues=function(t,e){var n=new rn.ARRAY_TYPE(2);return n[0]=t,n[1]=e,n},Re.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t},Re.set=function(t,e,n){return t[0]=e,t[1]=n,t},Re.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t},Re.subtract=jn,Re.multiply=qi,Re.divide=Sr,Re.ceil=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t},Re.floor=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t},Re.min=function(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t},Re.max=function(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t},Re.round=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t},Re.scale=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t},Re.scaleAndAdd=function(t,e,n,i){return t[0]=e[0]+n[0]*i,t[1]=e[1]+n[1]*i,t},Re.distance=pl,Re.squaredDistance=x1,Re.length=qM,Re.squaredLength=WM,Re.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t},Re.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t},Re.normalize=function(t,e){var n=e[0],i=e[1],s=n*n+i*i;return s>0&&(s=1/Math.sqrt(s)),t[0]=e[0]*s,t[1]=e[1]*s,t},Re.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]},Re.cross=function(t,e,n){var i=e[0]*n[1]-e[1]*n[0];return t[0]=t[1]=0,t[2]=i,t},Re.lerp=function(t,e,n,i){var s=e[0],l=e[1];return t[0]=s+i*(n[0]-s),t[1]=l+i*(n[1]-l),t},Re.random=function(t,e){e=e||1;var n=2*rn.RANDOM()*Math.PI;return t[0]=Math.cos(n)*e,t[1]=Math.sin(n)*e,t},Re.transformMat2=function(t,e,n){var i=e[0],s=e[1];return t[0]=n[0]*i+n[2]*s,t[1]=n[1]*i+n[3]*s,t},Re.transformMat2d=function(t,e,n){var i=e[0],s=e[1];return t[0]=n[0]*i+n[2]*s+n[4],t[1]=n[1]*i+n[3]*s+n[5],t},Re.transformMat3=function(t,e,n){var i=e[0],s=e[1];return t[0]=n[0]*i+n[3]*s+n[6],t[1]=n[1]*i+n[4]*s+n[7],t},Re.transformMat4=function(t,e,n){var i=e[0],s=e[1];return t[0]=n[0]*i+n[4]*s+n[12],t[1]=n[1]*i+n[5]*s+n[13],t},Re.rotate=function(t,e,n,i){var s=e[0]-n[0],l=e[1]-n[1],u=Math.sin(i),h=Math.cos(i);return t[0]=s*h-l*u+n[0],t[1]=s*u+l*h+n[1],t},Re.angle=function(t,e){var n=t[0],i=t[1],s=e[0],l=e[1],u=Math.sqrt(n*n+i*i)*Math.sqrt(s*s+l*l);return Math.acos(Math.min(Math.max(u&&(n*s+i*l)/u,-1),1))},Re.zero=function(t){return t[0]=0,t[1]=0,t},Re.str=function(t){return"vec2("+t[0]+", "+t[1]+")"},Re.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]},Re.equals=function(t,e){var n=t[0],i=t[1],s=e[0],l=e[1];return Math.abs(n-s)<=rn.EPSILON*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(i-l)<=rn.EPSILON*Math.max(1,Math.abs(i),Math.abs(l))},Re.forEach=Re.sqrLen=Re.sqrDist=Re.dist=Re.div=Re.mul=Re.sub=Re.len=void 0;var rn=function(t,e){if(t&&t.__esModule)return t;if(t===null||Bt(t)!=="object"&&typeof t!="function")return{default:t};var n=Tn(void 0);if(n&&n.has(t))return n.get(t);var i={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var l in t)if(l!=="default"&&Object.prototype.hasOwnProperty.call(t,l)){var u=s?Object.getOwnPropertyDescriptor(t,l):null;u&&(u.get||u.set)?Object.defineProperty(i,l,u):i[l]=t[l]}return i.default=t,n&&n.set(t,i),i}(Jn);function Tn(t){if(typeof WeakMap!="function")return null;var e=new WeakMap,n=new WeakMap;return(Tn=function(i){return i?n:e})(t)}function Cn(){var t=new rn.ARRAY_TYPE(2);return rn.ARRAY_TYPE!=Float32Array&&(t[0]=0,t[1]=0),t}function jn(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t}function qi(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t}function Sr(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t}function pl(t,e){return Math.hypot(e[0]-t[0],e[1]-t[1])}function x1(t,e){var n=e[0]-t[0],i=e[1]-t[1];return n*n+i*i}function qM(t){return Math.hypot(t[0],t[1])}function WM(t){var e=t[0],n=t[1];return e*e+n*n}Re.len=qM,Re.sub=jn,Re.mul=qi,Re.div=Sr,Re.dist=pl,Re.sqrDist=x1,Re.sqrLen=WM;var kB=function(){var t=Cn();return function(e,n,i,s,l,u){var h,f;for(n||(n=2),i||(i=0),f=s?Math.min(s*n+i,e.length):e.length,h=i;h<f;h+=n)t[0]=e[h],t[1]=e[h+1],l(t,t,u),e[h]=t[0],e[h+1]=t[1];return e}}();function J2(t){return J2=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},J2(t)}Re.forEach=kB,Object.defineProperty(ni,"__esModule",{value:!0});var xr=ni.vec4=fe=ni.vec3=ni.vec2=ni.quat2=uo=ni.quat=Me=ni.mat4=gs=ni.mat3=ni.mat2d=cm=ni.mat2=ni.glMatrix=void 0,PB=tu(Jn);ni.glMatrix=PB;var RB=tu(vr),cm=ni.mat2=RB,DB=tu(Mr);ni.mat2d=DB;var LB=tu(er),gs=ni.mat3=LB,OB=tu(Qt),Me=ni.mat4=OB,zB=tu(hn),uo=ni.quat=zB,FB=tu(X);ni.quat2=FB;var BB=tu(Re);ni.vec2=BB;var NB=tu(yn),fe=ni.vec3=NB,jB=tu(kn);function ZM(t){if(typeof WeakMap!="function")return null;var e=new WeakMap,n=new WeakMap;return(ZM=function(i){return i?n:e})(t)}function tu(t,e){if(!e&&t&&t.__esModule)return t;if(t===null||J2(t)!=="object"&&typeof t!="function")return{default:t};var n=ZM(e);if(n&&n.has(t))return n.get(t);var i={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var l in t)if(l!=="default"&&Object.prototype.hasOwnProperty.call(t,l)){var u=s?Object.getOwnPropertyDescriptor(t,l):null;u&&(u.get||u.set)?Object.defineProperty(i,l,u):i[l]=t[l]}return i.default=t,n&&n.set(t,i),i}xr=ni.vec4=jB;const UB=Kn([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:XM}=UB,KM=Kn([{name:"a_pos_3",components:3,type:"Int16"}]);var hh=Kn([{name:"a_pos",type:"Int16",components:2}]);class w1{constructor(e,n){this.pos=e,this.dir=n}intersectsPlane(e,n,i){const s=fe.dot(n,this.dir);if(Math.abs(s)<1e-6)return!1;const l=((e[0]-this.pos[0])*n[0]+(e[1]-this.pos[1])*n[1]+(e[2]-this.pos[2])*n[2])/s;return i[0]=this.pos[0]+this.dir[0]*l,i[1]=this.pos[1]+this.dir[1]*l,i[2]=this.pos[2]+this.dir[2]*l,!0}closestPointOnSphere(e,n,i){if(fe.equals(this.pos,e)||n===0)return i[0]=i[1]=i[2]=0,!1;const[s,l,u]=this.dir,h=this.pos[0]-e[0],f=this.pos[1]-e[1],m=this.pos[2]-e[2],y=s*s+l*l+u*u,v=2*(h*s+f*l+m*u),w=v*v-4*y*(h*h+f*f+m*m-n*n);if(w<0){const S=Math.max(-v/2,0),E=h+s*S,A=f+l*S,M=m+u*S,k=Math.hypot(E,A,M);return i[0]=E*n/k,i[1]=A*n/k,i[2]=M*n/k,!1}{const S=(-v-Math.sqrt(w))/(2*y);if(S<0){const E=Math.hypot(h,f,m);return i[0]=h*n/E,i[1]=f*n/E,i[2]=m*n/E,!1}return i[0]=h+s*S,i[1]=f+l*S,i[2]=m+u*S,!0}}}class eS{constructor(e,n,i,s,l){this.TL=e,this.TR=n,this.BR=i,this.BL=s,this.horizon=l}static fromInvProjectionMatrix(e,n,i){const s=[-1,1,1],l=[1,1,1],u=[1,-1,1],h=[-1,-1,1],f=fe.transformMat4(s,s,e),m=fe.transformMat4(l,l,e),y=fe.transformMat4(u,u,e),v=fe.transformMat4(h,h,e);return new eS(f,m,y,v,n/i)}}function tS(t,e,n){let i=1/0,s=-1/0;const l=[];for(const u of t){fe.sub(l,u,e);const h=fe.dot(l,n);i=Math.min(i,h),s=Math.max(s,h)}return[i,s]}function YM(t,e){let n=!0;for(let i=0;i<t.planes.length;i++){const s=t.planes[i];let l=0;for(let u=0;u<e.length;u++)l+=fe.dot(s,e[u])+s[3]>=0;if(l===0)return 0;l!==e.length&&(n=!1)}return n?2:1}function QM(t,e){for(const n of t.projections){const i=tS(e,t.points[0],n.axis);if(n.projection[1]<i[0]||n.projection[0]>i[1])return 0}return 1}class hm{constructor(e,n){this.points=e||new Array(8).fill([0,0,0]),this.planes=n||new Array(6).fill([0,0,0,0]),this.bounds=ri.fromPoints(this.points),this.projections=[];const i=[fe.sub([],this.points[2],this.points[3]),fe.sub([],this.points[0],this.points[3]),fe.sub([],this.points[4],this.points[0]),fe.sub([],this.points[5],this.points[1]),fe.sub([],this.points[6],this.points[2]),fe.sub([],this.points[7],this.points[3])];for(const s of i){const l=[0,-s[2],s[1]],u=[s[2],0,-s[0]];this.projections.push({axis:l,projection:tS(this.points,this.points[0],l)}),this.projections.push({axis:u,projection:tS(this.points,this.points[0],u)})}}static fromInvProjectionMatrix(e,n,i,s){const l=Math.pow(2,i),u=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(m=>{const y=xr.transformMat4([],m,e),v=1/y[3]/n*l;return xr.mul(y,y,[v,v,s?1/y[3]:v,v])}),h=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(m=>{const y=fe.sub([],u[m[0]],u[m[1]]),v=fe.sub([],u[m[2]],u[m[1]]),w=fe.normalize([],fe.cross([],y,v)),S=-fe.dot(w,u[m[1]]);return w.concat(S)}),f=[];for(let m=0;m<u.length;m++)f.push([u[m][0],u[m][1],u[m][2]]);return new hm(f,h)}}class ri{static fromPoints(e){const n=[1/0,1/0,1/0],i=[-1/0,-1/0,-1/0];for(const s of e)fe.min(n,n,s),fe.max(i,i,s);return new ri(n,i)}static applyTransform(e,n){const i=e.getCorners();for(let s=0;s<i.length;++s)fe.transformMat4(i[s],i[s],n);return ri.fromPoints(i)}static projectAabbCorners(e,n){const i=e.getCorners();for(let s=0;s<i.length;++s)fe.transformMat4(i[s],i[s],n);return i}constructor(e,n){this.min=e,this.max=n,this.center=fe.scale([],fe.add([],this.min,this.max),.5)}quadrant(e){const n=[e%2==0,e<2],i=fe.clone(this.min),s=fe.clone(this.max);for(let l=0;l<n.length;l++)i[l]=n[l]?this.min[l]:this.center[l],s[l]=n[l]?this.center[l]:this.max[l];return s[2]=this.max[2],new ri(i,s)}distanceX(e){return Math.max(Math.min(this.max[0],e[0]),this.min[0])-e[0]}distanceY(e){return Math.max(Math.min(this.max[1],e[1]),this.min[1])-e[1]}distanceZ(e){return Math.max(Math.min(this.max[2],e[2]),this.min[2])-e[2]}getCorners(){const e=this.min,n=this.max;return[[e[0],e[1],e[2]],[n[0],e[1],e[2]],[n[0],n[1],e[2]],[e[0],n[1],e[2]],[e[0],e[1],n[2]],[n[0],e[1],n[2]],[n[0],n[1],n[2]],[e[0],n[1],n[2]]]}intersects(e){return this.intersectsAabb(e.bounds)?YM(e,this.getCorners()):0}intersectsFlat(e){return this.intersectsAabb(e.bounds)?YM(e,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsPrecise(e,n){return n||this.intersects(e)?QM(e,this.getCorners()):0}intersectsPreciseFlat(e,n){return n||this.intersectsFlat(e)?QM(e,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsAabb(e){for(let n=0;n<3;++n)if(this.min[n]>e.max[n]||e.min[n]>this.max[n])return!1;return!0}intersectsAabbXY(e){return!(this.min[0]>e.max[0]||e.min[0]>this.max[0]||this.min[1]>e.max[1]||e.min[1]>this.max[1])}encapsulate(e){for(let n=0;n<3;n++)this.min[n]=Math.min(this.min[n],e.min[n]),this.max[n]=Math.max(this.max[n],e.max[n])}encapsulatePoint(e){for(let n=0;n<3;n++)this.min[n]=Math.min(this.min[n],e[n]),this.max[n]=Math.max(this.max[n],e[n])}}kt(ri,"Aabb");const a_=5,dh=6,Ds=Ge/Math.PI/2,VB=16383,dm=64,nS=[dm,32,16],Ta=-Ds,Ca=Ds,$B=[new ri([Ta,Ta,Ta],[Ca,Ca,Ca]),new ri([Ta,Ta,Ta],[0,0,Ca]),new ri([0,Ta,Ta],[Ca,0,Ca]),new ri([Ta,0,Ta],[0,Ca,Ca]),new ri([0,0,Ta],[Ca,Ca,Ca])];function b1(t){return t*Ds/mm}function JM(t,e,n,i=!0){const s=fe.scale([],t._camera.position,t.worldSize),l=[e,n,1,1];xr.transformMat4(l,l,t.pixelMatrixInverse),xr.scale(l,l,1/l[3]);const u=fe.sub([],l,s),h=fe.normalize([],u),f=t.globeMatrix,m=[f[12],f[13],f[14]],y=fe.sub([],m,s),v=fe.length(y),w=fe.normalize([],y),S=t.worldSize/(2*Math.PI),E=fe.dot(w,h),A=Math.asin(S/v);if(A<Math.acos(E)){if(!i)return null;const J=[],ae=[];fe.scale(J,h,v/E),fe.normalize(ae,fe.sub(ae,J,y)),fe.normalize(h,fe.add(h,y,fe.scale(h,ae,Math.tan(A)*v)))}const M=[];new w1(s,h).closestPointOnSphere(m,S,M);const k=fe.normalize([],hr(f,0)),R=fe.normalize([],hr(f,1)),L=fe.normalize([],hr(f,2)),z=fe.dot(k,M),B=fe.dot(R,M),j=fe.dot(L,M),V=rt(Math.asin(-B/S));let Y=rt(Math.atan2(z,j));Y=t.center.lng+function(J,ae){const le=(ae-J+180)%360-180;return le<-180?le+360:le}(t.center.lng,Y);const ne=io(Y),re=ce(co(V),0,1);return new Un(ne,re)}class GB{constructor(e,n,i){this.a=fe.sub([],e,i),this.b=fe.sub([],n,i),this.center=i;const s=fe.normalize([],this.a),l=fe.normalize([],this.b);this.angle=Math.acos(fe.dot(s,l))}}function rS(t,e){if(t.angle===0)return null;let n;return n=t.a[e]===0?1/t.angle*.5*Math.PI:1/t.angle*Math.atan(t.b[e]/t.a[e]/Math.sin(t.angle)-1/Math.tan(t.angle)),n<0||n>1?null:function(i,s,l,u){const h=Math.sin(l);return i*(Math.sin((1-u)*l)/h)+s*(Math.sin(u*l)/h)}(t.a[e],t.b[e],t.angle,ce(n,0,1))+t.center[e]}function ml(t){if(t.z<=1)return $B[t.z+2*t.y+t.x];const e=oS(S1(t));return ri.fromPoints(e)}function nc(t,e,n){return fe.scale(t,t,1-n),fe.scaleAndAdd(t,t,e,n)}function e3(t,e){const n=ro(e.zoom);if(n===0)return ml(t);const i=S1(t),s=oS(i),l=io(i.getWest())*e.worldSize,u=io(i.getEast())*e.worldSize,h=co(i.getNorth())*e.worldSize,f=co(i.getSouth())*e.worldSize,m=[l,h,0],y=[u,h,0],v=[l,f,0],w=[u,f,0],S=Me.invert([],e.globeMatrix);return fe.transformMat4(m,m,S),fe.transformMat4(y,y,S),fe.transformMat4(v,v,S),fe.transformMat4(w,w,S),s[0]=nc(s[0],v,n),s[1]=nc(s[1],w,n),s[2]=nc(s[2],y,n),s[3]=nc(s[3],m,n),ri.fromPoints(s)}function t3(t,e,n){for(const i of t)fe.transformMat4(i,i,e),fe.scale(i,i,n)}function iS(t,e,n,i){const s=e/t.worldSize,l=t.globeMatrix;if(n.z<=1){const ne=ml(n).getCorners();return t3(ne,l,s),ri.fromPoints(ne)}const u=S1(n,i),h=oS(u);t3(h,l,s);const f=Number.MAX_VALUE,m=[-f,-f,-f],y=[f,f,f];if(u.contains(t.center)){for(const J of h)fe.min(y,y,J),fe.max(m,m,J);m[2]=0;const ne=t.point,re=[ne.x*s,ne.y*s,0];return fe.min(y,y,re),fe.max(m,m,re),new ri(y,m)}const v=[l[12]*s,l[13]*s,l[14]*s],w=u.getCenter(),S=ce(t.center.lat,-xi,xi),E=ce(w.lat,-xi,xi),A=io(t.center.lng),M=co(S);let k=A-io(w.lng);const R=M-co(E);k>.5?k-=1:k<-.5&&(k+=1);let L=0;if(Math.abs(k)>Math.abs(R))L=k>=0?1:3;else{L=R>=0?0:2;const ne=[l[4]*s,l[5]*s,l[6]*s],re=-Math.sin(Be(R>=0?u.getSouth():u.getNorth()))*Ds;fe.scaleAndAdd(v,v,ne,re)}const z=h[L],B=h[(L+1)%4],j=new GB(z,B,v),V=[rS(j,0)||z[0],rS(j,1)||z[1],rS(j,2)||z[2]],Y=ro(t.zoom);if(Y>0){const ne=function({x:J,y:ae,z:le},oe,Ee,xe,Pe){const pe=1/(1<<le);let Ae=J*pe,Le=Ae+pe,qe=ae*pe,Ve=qe+pe,yt=0;const mt=(Ae+Le)/2-xe;return mt>.5?yt=-1:mt<-.5&&(yt=1),Ae=((Ae+yt)*oe-(xe*=oe))*Ee+xe,Le=((Le+yt)*oe-xe)*Ee+xe,qe=(qe*oe-(Pe*=oe))*Ee+Pe,Ve=(Ve*oe-Pe)*Ee+Pe,[[Ae,Ve,0],[Le,Ve,0],[Le,qe,0],[Ae,qe,0]]}(n,e,t._pixelsPerMercatorPixel,A,M);for(let J=0;J<h.length;J++)nc(h[J],ne[J],Y);const re=fe.add([],ne[L],ne[(L+1)%4]);fe.scale(re,re,.5),nc(V,re,Y)}for(const ne of h)fe.min(y,y,ne),fe.max(m,m,ne);return y[2]=Math.min(z[2],B[2]),fe.min(y,y,V),fe.max(m,m,V),new ri(y,m)}function S1({x:t,y:e,z:n},i=!1){const s=1/(1<<n),l=new sn(Ls(t*s),e===(1<<n)-1&&i?-90:Ci((e+1)*s)),u=new sn(Ls((t+1)*s),e===0&&i?90:Ci(e*s));return new li(l,u)}function oS(t){const e=Be(t.getNorth()),n=Be(t.getSouth()),i=Math.cos(e),s=Math.cos(n),l=Math.sin(e),u=Math.sin(n),h=t.getWest(),f=t.getEast();return[fm(s,u,h),fm(s,u,f),fm(i,l,f),fm(i,l,h)]}function fm(t,e,n,i=Ds){return n=Be(n),[t*Math.sin(n)*i,-e*i,t*Math.cos(n)*i]}function ys(t,e,n){return fm(Math.cos(Be(t)),Math.sin(Be(t)),e,n)}function l_(t,e,n,i){const s=1<<n.z,l=(t/Ge+n.x)/s;return ys(Ci((e/Ge+n.y)/s),Ls(l),i)}function E1({min:t,max:e}){return VB/Math.max(e[0]-t[0],e[1]-t[1],e[2]-t[2])}const n3=new Float64Array(16);function pm(t){const e=E1(t),n=Me.fromScaling(n3,[e,e,e]);return Me.translate(n,n,fe.negate([],t.min))}function sS(t){const e=Me.fromTranslation(n3,t.min),n=1/E1(t);return Me.scale(e,e,[n,n,n])}function aS(t){const e=Ge/(2*Math.PI);return t/(2*Math.PI)/e}function r3(t,e){return Ge/(512*Math.pow(2,t))*E1(ml(e))}function i3(t,e,n,i,s){const l=aS(n),u=[t,e,-n/(2*Math.PI)],h=Me.identity(new Float64Array(16));return Me.translate(h,h,u),Me.scale(h,h,[l,l,l]),Me.rotateX(h,h,Be(-s)),Me.rotateY(h,h,Be(-i)),h}function ro(t){return De(a_,dh,t)}function HB(t,e,n){const i=Me.identity(new Float64Array(16)),s=(e/(1<<t)-.5)*Math.PI*2;return Me.rotateY(i,n.globeMatrix,s),Float32Array.from(i)}function o3(t,e,n){const i=ro(n.zoom),s=t.style.map._antialias,l=!!e.extStandardDerivatives,u=e.extStandardDerivativesForceOff||t.terrain&&t.terrain.exaggeration()>0;return i===0&&!s&&!u&&l}function qB(t,e,n,i){const s=e.getNorth(),l=e.getSouth(),u=e.getWest(),h=e.getEast(),f=1<<t.z,m=h-u,y=s-l,v=m/dm,w=-y/nS[n],S=[0,v,0,w,0,0,s,u,0];if(t.z>0){const E=180/i;gs.multiply(S,S,[E/m+1,0,0,0,E/y+1,0,-.5*E/v,.5*E/w,1])}return S[2]=f,S[5]=t.x,S[8]=t.y,S}function WB(t){const e=xi-5;t=ce(t,-e,e)/e*90;const n=Math.pow(Math.abs(Math.sin(Be(t))),3);return Math.round(n*(nS.length-1))}function s3(t){const e=[0,0,0],n=Me.identity(new Float64Array(16));return Me.multiply(n,t.pixelMatrix,t.globeMatrix),fe.transformMat4(e,e,n),new q(e[0],e[1])}function a3(t,e){const n=ys(e.lat,e.lng),i=function(l){const u=ys(l._center.lat,l._center.lng),h=fe.fromValues(0,1,0);let f=fe.cross([],h,u);const m=Me.fromRotation([],-l.angle,u);f=fe.transformMat4(f,f,m),Me.fromRotation(m,-l._pitch,f);const y=fe.normalize([],u);return fe.scale(y,y,b1(l.cameraToCenterDistance/l.pixelsPerMeter)),fe.transformMat4(y,y,m),fe.add([],u,y)}(t),s=fe.subtract([],i,n);return fe.angle(s,n)}function T1(t,e){return a3(t,e)>Math.PI/2*1.01}const l3=Be(85),ZB=Math.cos(l3),XB=Math.sin(l3);class KB{constructor(e){this._createGrid(e),this._createPoles(e)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const e of this._poleSegments)e.destroy();for(const e of this._gridSegments)e.withSkirts.destroy(),e.withoutSkirts.destroy()}_fillGridMeshWithLods(e,n){const i=new Bo,s=new di,l=[],u=e+1+2,h=n[0]+1,f=n[0]+1+(1+n.length),m=(y,v,w)=>{let S=y===u-1?y-2:y===0?y:y-1;return S+=w?24575:0,[S,v]};for(let y=0;y<u;++y)i.emplaceBack(...m(y,0,!0));for(let y=0;y<h;++y)for(let v=0;v<u;++v)i.emplaceBack(...m(v,y,(v===0||v===u-1)&&!0));for(let y=0;y<n.length;++y){const v=n[y];for(let w=0;w<u;++w)i.emplaceBack(...m(w,v,!0))}for(let y=0;y<n.length;++y){const v=s.length,w=n[y]+1+2,S=new di;for(let M=0;M<w-1;M++){const k=M===w-2,R=k?u*(f-n.length+y-M):u;for(let L=0;L<u-1;L++){const z=M*u+L;M===0||k||L===0||L===u-2?(S.emplaceBack(z+1,z,z+R),S.emplaceBack(z+R,z+R+1,z+1)):(s.emplaceBack(z+1,z,z+R),s.emplaceBack(z+R,z+R+1,z+1))}}const E=In.simpleSegment(0,v,i.length,s.length-v);for(let M=0;M<S.uint16.length;M+=3)s.emplaceBack(S.uint16[M],S.uint16[M+1],S.uint16[M+2]);const A=In.simpleSegment(0,v,i.length,s.length-v);l.push({withoutSkirts:E,withSkirts:A})}return{vertices:i,indices:s,segments:l}}_createGrid(e){const n=this._fillGridMeshWithLods(dm,nS);this._gridSegments=n.segments,this._gridBuffer=e.createVertexBuffer(n.vertices,hh.members),this._gridIndexBuffer=e.createIndexBuffer(n.indices,!0)}_createPoles(e){const n=new di;for(let l=0;l<=dm;l++)n.emplaceBack(0,l+1,l+2);this._poleIndexBuffer=e.createIndexBuffer(n,!0);const i=new nh,s=new nh;this._poleSegments=[];for(let l=0,u=0;l<a_;l++){const h=360/(1<<l);i.emplaceBack(0,-Ds,0,.5,0),s.emplaceBack(0,-Ds,0,.5,1);for(let f=0;f<=dm;f++){const m=f/dm,y=nn(0,h,m),[v,w,S]=fm(ZB,XB,y,Ds);i.emplaceBack(v,w,S,m,0),s.emplaceBack(v,w,S,m,1)}this._poleSegments.push(In.simpleSegment(u,0,66,64)),u+=66}this._poleNorthVertexBuffer=e.createVertexBuffer(i,XM,!1),this._poleSouthVertexBuffer=e.createVertexBuffer(s,XM,!1)}getGridBuffers(e,n){return[this._gridBuffer,this._gridIndexBuffer,n?this._gridSegments[e].withSkirts:this._gridSegments[e].withoutSkirts]}getPoleBuffers(e){return[this._poleNorthVertexBuffer,this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[e]]}}const mm=63710088e-1,lS=2*Math.PI*mm;class fh{constructor(e,n){if(isNaN(e)||isNaN(n))throw new Error(`Invalid LngLat object: (${e}, ${n})`);if(this.lng=+e,this.lat=+n,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new fh(He(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(e){const n=Math.PI/180,i=this.lat*n,s=e.lat*n,l=Math.sin(i)*Math.sin(s)+Math.cos(i)*Math.cos(s)*Math.cos((e.lng-this.lng)*n);return mm*Math.acos(Math.min(l,1))}toBounds(e=0){const n=360*e/40075017,i=n/Math.cos(Math.PI/180*this.lat);return new li(new fh(this.lng-i,this.lat-n),new fh(this.lng+i,this.lat+n))}toEcef(e){const n=b1(e);return ys(this.lat,this.lng,Ds+n)}static convert(e){if(e instanceof fh)return e;if(Array.isArray(e)&&(e.length===2||e.length===3))return new fh(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&typeof e=="object"&&e!==null)return new fh(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}var sn=fh,u3={};(function(t,e){(function(n){function i(l,u,h){var f=s(256*l,256*(u=Math.pow(2,h)-u-1),h),m=s(256*(l+1),256*(u+1),h);return f[0]+","+f[1]+","+m[0]+","+m[1]}function s(l,u,h){var f=2*Math.PI*6378137/256/Math.pow(2,h);return[l*f-2*Math.PI*6378137/2,u*f-2*Math.PI*6378137/2]}n.getURL=function(l,u,h,f,m,y){return y=y||{},l+"?"+["bbox="+i(h,f,m),"format="+(y.format||"image/png"),"service="+(y.service||"WMS"),"version="+(y.version||"1.1.1"),"request="+(y.request||"GetMap"),"srs="+(y.srs||"EPSG:3857"),"width="+(y.width||256),"height="+(y.height||256),"layers="+u].join("&")},n.getTileBBox=i,n.getMercCoords=s,Object.defineProperty(n,"__esModule",{value:!0})})(e)})(0,u3);var YB=u3;class rc{constructor(e,n,i){this.z=e,this.x=n,this.y=i,this.key=u_(0,e,e,n,i)}equals(e){return this.z===e.z&&this.x===e.x&&this.y===e.y}url(e,n){const i=YB.getTileBBox(this.x,this.y,this.z),s=function(l,u,h){let f,m="";for(let y=l;y>0;y--)f=1<<y-1,m+=(u&f?1:0)+(h&f?2:0);return m}(this.z,this.x,this.y);return e[(this.x+this.y)%e.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(n==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",s).replace("{bbox-epsg-3857}",i)}toString(){return`${this.z}/${this.x}/${this.y}`}}class uS{constructor(e,n){this.wrap=e,this.canonical=n,this.key=u_(e,n.z,n.z,n.x,n.y)}}class Ir{constructor(e,n,i,s,l){this.overscaledZ=e,this.wrap=n,this.canonical=new rc(i,+s,+l),this.key=n===0&&e===i?this.canonical.key:u_(n,e,i,s,l)}equals(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)}scaledTo(e){const n=this.canonical.z-e;return e>this.canonical.z?new Ir(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Ir(e,this.wrap,e,this.canonical.x>>n,this.canonical.y>>n)}calculateScaledKey(e,n=!0){if(this.overscaledZ===e&&n)return this.key;if(e>this.canonical.z)return u_(this.wrap*+n,e,this.canonical.z,this.canonical.x,this.canonical.y);{const i=this.canonical.z-e;return u_(this.wrap*+n,e,e,this.canonical.x>>i,this.canonical.y>>i)}}isChildOf(e){if(e.wrap!==this.wrap)return!1;const n=this.canonical.z-e.canonical.z;return e.overscaledZ===0||e.overscaledZ<this.overscaledZ&&e.canonical.x===this.canonical.x>>n&&e.canonical.y===this.canonical.y>>n}children(e){if(this.overscaledZ>=e)return[new Ir(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const n=this.canonical.z+1,i=2*this.canonical.x,s=2*this.canonical.y;return[new Ir(n,this.wrap,n,i,s),new Ir(n,this.wrap,n,i+1,s),new Ir(n,this.wrap,n,i,s+1),new Ir(n,this.wrap,n,i+1,s+1)]}isLessThan(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))}wrapped(){return new Ir(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(e){return new Ir(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new uS(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function u_(t,e,n,i,s){const l=1<<Math.min(n,22);let u=l*(s%l)+i%l;return t&&n<22&&(u+=l*l*((t<0?-2*t-1:2*t)%(1<<2*(22-n)))),16*(32*u+n)+(e-n)}kt(rc,"CanonicalTileID"),kt(Ir,"OverscaledTileID",{omit:["projMatrix"]});const QB=0,JB=25.5;function C1(t){return lS*Math.cos(t*Math.PI/180)}function io(t){return(180+t)/360}function co(t){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t*Math.PI/360)))/360}function mr(t,e){return t/C1(e)}function Ls(t){return 360*t-180}function Ci(t){return 360/Math.PI*Math.atan(Math.exp((180-360*t)*Math.PI/180))-90}function c3(t,e){return t*C1(Ci(e))}const xi=85.051129;function h3(t){return Math.cos(Be(ce(t,-xi,xi)))}function ph(t,e){const n=ce(e,QB,JB),i=Math.pow(2,n);return h3(t)*lS/(512*i)}function cS(t){return 1/Math.cos(t*Math.PI/180)}function c_(t,e=0){const n=Math.exp(Math.PI*(1-(t.y+e/Ge)/(1<<t.z)*2));return 80150034*n/(n*n+1)/Ge/(1<<t.z)}class Un{constructor(e,n,i=0){this.x=+e,this.y=+n,this.z=+i}static fromLngLat(e,n=0){const i=sn.convert(e);return new Un(io(i.lng),co(i.lat),mr(n,i.lat))}toLngLat(){return new sn(Ls(this.x),Ci(this.y))}toAltitude(){return c3(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/lS*cS(Ci(this.y))}}function hS(t,e,n,i,s,l,u,h,f){const m=(e+i)/2,y=(n+s)/2,v=new q(m,y);h(v),function(w,S,E,A,M,k){const R=E-M,L=A-k;return Math.abs((A-S)*R-(E-w)*L)/Math.hypot(R,L)}(v.x,v.y,l.x,l.y,u.x,u.y)>=f?(hS(t,e,n,m,y,l,v,h,f),hS(t,m,y,i,s,v,u,h,f)):t.push(u)}function d3(t,e,n){let i=t[0],s=i.x,l=i.y;e(i);const u=[i];for(let h=1;h<t.length;h++){const f=t[h],{x:m,y}=f;e(f),hS(u,s,l,m,y,i,f,e,n),s=m,l=y,i=f}return u}function dS(t,e,n,i){if(i(e,n)){const s=e.add(n)._mult(.5);dS(t,e,s,i),dS(t,s,n,i)}else t.push(n)}function eN(t,e){let n=t[0];const i=[n];for(let s=1;s<t.length;s++){const l=t[s];dS(i,n,l,e),n=l}return i}const fS=Math.pow(2,14)-1,f3=-fS-1;function tN(t,e){const n=Math.round(t.x*e),i=Math.round(t.y*e);return t.x=ce(n,f3,fS),t.y=ce(i,f3,fS),(n<t.x||n>t.x+1||i<t.y||i>t.y+1)&&ye("Geometry exceeds allowed extent, reduce your vector tile buffer size"),t}function nu(t,e,n){const i=t.loadGeometry(),s=t.extent,l=Ge/s;if(e&&n&&n.projection.isReprojectedInTileSpace){const u=1<<e.z,{scale:h,x:f,y:m,projection:y}=n,v=w=>{const S=Ls((e.x+w.x/s)/u),E=Ci((e.y+w.y/s)/u),A=y.project(S,E);w.x=(A.x*h-f)*s,w.y=(A.y*h-m)*s};for(let w=0;w<i.length;w++)if(t.type!==1)i[w]=d3(i[w],v,1);else{const S=[];for(const E of i[w])E.x<0||E.x>=s||E.y<0||E.y>=s||(v(E),S.push(E));i[w]=S}}for(const u of i)for(const h of u)tN(h,l);return i}function mh(t,e){return{type:t.type,id:t.id,properties:t.properties,geometry:e?nu(t):[]}}function A1(t,e,n,i,s){t.emplaceBack(2*e+(i+1)/2,2*n+(s+1)/2)}function M1(t,e,n){t.emplaceBack(e.x,e.y,e.z,n[0]*16384,n[1]*16384,n[2]*16384)}class pS{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(n=>n.id),this.index=e.index,this.hasPattern=!1,this.projection=e.projection,this.layoutVertexArray=new Bo,this.indexArray=new di,this.segments=new In,this.programConfigurations=new ll(e.layers,e.zoom),this.stateDependentLayerIds=this.layers.filter(n=>n.isStateDependent()).map(n=>n.id)}populate(e,n,i,s){const l=this.layers[0],u=[];let h=null;l.type==="circle"&&(h=l.layout.get("circle-sort-key"));for(const{feature:m,id:y,index:v,sourceLayerIndex:w}of e){const S=this.layers[0]._featureFilter.needGeometry,E=mh(m,S);if(!this.layers[0]._featureFilter.filter(new Nr(this.zoom),E,i))continue;const A=h?h.evaluate(E,{},i):void 0,M={id:y,properties:m.properties,type:m.type,sourceLayerIndex:w,index:v,geometry:S?E.geometry:nu(m,i,s),patterns:{},sortKey:A};u.push(M)}h&&u.sort((m,y)=>m.sortKey-y.sortKey);let f=null;s.projection.name==="globe"&&(this.globeExtVertexArray=new th,f=s.projection);for(const m of u){const{geometry:y,index:v,sourceLayerIndex:w}=m,S=e[v].feature;this.addFeature(m,y,v,n.availableImages,i,f,n.brightness),n.featureIndex.insert(S,y,v,w,this.index)}}update(e,n,i,s,l){const u=Object.keys(e).length!==0;u&&!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(e,n,u?this.stateDependentLayers:this.layers,i,s,l)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,no.members),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=e.createVertexBuffer(this.globeExtVertexArray,Vi.members))),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(e,n,i,s,l,u,h){for(const f of n)for(const m of f){const y=m.x,v=m.y;if(y<0||y>=Ge||v<0||v>=Ge)continue;if(u){const E=u.projectTilePoint(y,v,l),A=u.upVector(l,y,v),M=this.globeExtVertexArray;M1(M,E,A),M1(M,E,A),M1(M,E,A),M1(M,E,A)}const w=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,e.sortKey),S=w.vertexLength;A1(this.layoutVertexArray,y,v,-1,-1),A1(this.layoutVertexArray,y,v,1,-1),A1(this.layoutVertexArray,y,v,1,1),A1(this.layoutVertexArray,y,v,-1,1),this.indexArray.emplaceBack(S,S+1,S+2),this.indexArray.emplaceBack(S,S+2,S+3),w.vertexLength+=4,w.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,i,{},s,l,h)}}function p3(t,e){for(let n=0;n<t.length;n++)if(gh(e,t[n]))return!0;for(let n=0;n<e.length;n++)if(gh(t,e[n]))return!0;return!!mS(t,e)}function nN(t,e,n){return!!gh(t,e)||!!gS(e,t,n)}function m3(t,e){if(t.length===1)return y3(e,t[0]);for(let n=0;n<e.length;n++){const i=e[n];for(let s=0;s<i.length;s++)if(gh(t,i[s]))return!0}for(let n=0;n<t.length;n++)if(y3(e,t[n]))return!0;for(let n=0;n<e.length;n++)if(mS(t,e[n]))return!0;return!1}function rN(t,e,n){if(t.length>1){if(mS(t,e))return!0;for(let i=0;i<e.length;i++)if(gS(e[i],t,n))return!0}for(let i=0;i<t.length;i++)if(gS(t[i],e,n))return!0;return!1}function mS(t,e){if(t.length===0||e.length===0)return!1;for(let n=0;n<t.length-1;n++){const i=t[n],s=t[n+1];for(let l=0;l<e.length-1;l++)if(iN(i,s,e[l],e[l+1]))return!0}return!1}function iN(t,e,n,i){return We(t,n,i)!==We(e,n,i)&&We(t,e,n)!==We(t,e,i)}function gS(t,e,n){const i=n*n;if(e.length===1)return t.distSqr(e[0])<i;for(let s=1;s<e.length;s++)if(g3(t,e[s-1],e[s])<i)return!0;return!1}function g3(t,e,n){const i=e.distSqr(n);if(i===0)return t.distSqr(e);const s=((t.x-e.x)*(n.x-e.x)+(t.y-e.y)*(n.y-e.y))/i;return t.distSqr(s<0?e:s>1?n:n.sub(e)._mult(s)._add(e))}function y3(t,e){let n,i,s,l=!1;for(let u=0;u<t.length;u++){n=t[u];for(let h=0,f=n.length-1;h<n.length;f=h++)i=n[h],s=n[f],i.y>e.y!=s.y>e.y&&e.x<(s.x-i.x)*(e.y-i.y)/(s.y-i.y)+i.x&&(l=!l)}return l}function gh(t,e){let n=!1;for(let i=0,s=t.length-1;i<t.length;s=i++){const l=t[i],u=t[s];l.y>e.y!=u.y>e.y&&e.x<(u.x-l.x)*(e.y-l.y)/(u.y-l.y)+l.x&&(n=!n)}return n}function _3(t,e,n,i,s){for(const u of t)if(e<=u.x&&n<=u.y&&i>=u.x&&s>=u.y)return!0;const l=[new q(e,n),new q(e,s),new q(i,s),new q(i,n)];if(t.length>2){for(const u of l)if(gh(t,u))return!0}for(let u=0;u<t.length-1;u++)if(oN(t[u],t[u+1],l))return!0;return!1}function oN(t,e,n){const i=n[0],s=n[2];if(t.x<i.x&&e.x<i.x||t.x>s.x&&e.x>s.x||t.y<i.y&&e.y<i.y||t.y>s.y&&e.y>s.y)return!1;const l=We(t,e,n[0]);return l!==We(t,e,n[1])||l!==We(t,e,n[2])||l!==We(t,e,n[3])}function gm(t,e,n,i,s,l){let u=e.y-t.y,h=t.x-e.x;if(l=l||0){const f=u*u+h*h;if(f===0)return!0;const m=Math.sqrt(f);u/=m,h/=m}return!((n.x-t.x)*u+(n.y-t.y)*h-l<0||(i.x-t.x)*u+(i.y-t.y)*h-l<0||(s.x-t.x)*u+(s.y-t.y)*h-l<0)}function yS(t,e,n,i,s,l,u){return!(gm(t,e,i,s,l,u)||gm(e,n,i,s,l,u)||gm(n,t,i,s,l,u)||gm(i,s,t,e,n,u)||gm(s,l,t,e,n,u)||gm(l,i,t,e,n,u))}function ym(t,e,n){const i=e.paint.get(t).value;return i.kind==="constant"?i.value:n.programConfigurations.get(e.id).getMaxValue(t)}function I1(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}function v3(t,e,n,i,s){if(!e[0]&&!e[1])return t;const l=q.convert(e)._mult(s);n==="viewport"&&l._rotate(-i);const u=[];for(let h=0;h<t.length;h++)u.push(t[h].sub(l));return u}function x3(t,e,n,i){const s=q.convert(t)._mult(i);return e==="viewport"&&s._rotate(-n),s}kt(pS,"CircleBucket",{omit:["layers"]});const sN=new jr({"circle-sort-key":new qt(ke.layout_circle["circle-sort-key"]),visibility:new gt(ke.layout_circle.visibility)});var aN={paint:new jr({"circle-radius":new qt(ke.paint_circle["circle-radius"]),"circle-color":new qt(ke.paint_circle["circle-color"]),"circle-blur":new qt(ke.paint_circle["circle-blur"]),"circle-opacity":new qt(ke.paint_circle["circle-opacity"]),"circle-translate":new gt(ke.paint_circle["circle-translate"]),"circle-translate-anchor":new gt(ke.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new gt(ke.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new gt(ke.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new qt(ke.paint_circle["circle-stroke-width"]),"circle-stroke-color":new qt(ke.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new qt(ke.paint_circle["circle-stroke-opacity"]),"circle-emissive-strength":new gt(ke.paint_circle["circle-emissive-strength"])}),layout:sN};function w3(t,e,n,i,s,l,u,h,f){if(l&&t.queryGeometry.isAboveHorizon)return!1;l&&(f*=t.pixelToTileUnitsFactor);const m=t.tileID.canonical,y=n.projection.upVectorScale(m,n.center.lat,n.worldSize).metersToTile;for(const v of e)for(const w of v){const S=w.add(h),E=s&&n.elevation?n.elevation.exaggeration()*s.getElevationAt(S.x,S.y,!0):0,A=n.projection.projectTilePoint(S.x,S.y,m);if(E>0){const L=n.projection.upVector(m,S.x,S.y);A.x+=L[0]*y*E,A.y+=L[1]*y*E,A.z+=L[2]*y*E}const M=l?S:lN(A.x,A.y,A.z,i),k=l?t.tilespaceRays.map(L=>cN(L,E)):t.queryGeometry.screenGeometry,R=xr.transformMat4([],[A.x,A.y,A.z,1],i);if(!u&&l?f*=R[3]/n.cameraToCenterDistance:u&&!l&&(f*=n.cameraToCenterDistance/R[3]),l){const L=Ci((w.y/Ge+m.y)/(1<<m.z));f/=n.projection.pixelsPerMeter(L,1)/mr(1,L)}if(nN(k,M,f))return!0}return!1}function lN(t,e,n,i){const s=xr.transformMat4([],[t,e,n,1],i);return new q(s[0]/s[3],s[1]/s[3])}const b3=fe.fromValues(0,0,0),uN=fe.fromValues(0,0,1);function cN(t,e){const n=fe.create();return b3[2]=e,t.intersectsPlane(b3,uN,n),new q(n[0],n[1])}class S3 extends pS{}function E3(t,{width:e,height:n},i,s){if(s){if(s instanceof Uint8ClampedArray)s=new Uint8Array(s.buffer);else if(s.length!==e*n*i)throw new RangeError("mismatched image size")}else s=new Uint8Array(e*n*i);return t.width=e,t.height=n,t.data=s,t}function T3(t,e,n){const{width:i,height:s}=e;i===t.width&&s===t.height||(_S(t,e,{x:0,y:0},{x:0,y:0},{width:Math.min(t.width,i),height:Math.min(t.height,s)},n),t.width=i,t.height=s,t.data=e.data)}function _S(t,e,n,i,s,l){if(s.width===0||s.height===0)return e;if(s.width>t.width||s.height>t.height||n.x>t.width-s.width||n.y>t.height-s.height)throw new RangeError("out of range source coordinates for image copy");if(s.width>e.width||s.height>e.height||i.x>e.width-s.width||i.y>e.height-s.height)throw new RangeError("out of range destination coordinates for image copy");const u=t.data,h=e.data;for(let f=0;f<s.height;f++){const m=((n.y+f)*t.width+n.x)*l,y=((i.y+f)*e.width+i.x)*l;for(let v=0;v<s.width*l;v++)h[y+v]=u[m+v]}return e}kt(S3,"HeatmapBucket",{omit:["layers"]});class ic{constructor(e,n){E3(this,e,1,n)}resize(e){T3(this,new ic(e),1)}clone(){return new ic({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,n,i,s,l){_S(e,n,i,s,l,1)}}class ui{constructor(e,n){E3(this,e,4,n)}resize(e){T3(this,new ui(e),4)}replace(e,n){n?this.data.set(e):this.data=e instanceof Uint8ClampedArray?new Uint8Array(e.buffer):e}clone(){return new ui({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,n,i,s,l){_S(e,n,i,s,l,4)}}kt(ic,"AlphaImage"),kt(ui,"RGBAImage");const hN=new jr({visibility:new gt(ke.layout_heatmap.visibility)});var dN={paint:new jr({"heatmap-radius":new qt(ke.paint_heatmap["heatmap-radius"]),"heatmap-weight":new qt(ke.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new gt(ke.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Jc(ke.paint_heatmap["heatmap-color"]),"heatmap-opacity":new gt(ke.paint_heatmap["heatmap-opacity"])}),layout:hN};function k1(t){const e={},n=t.resolution||256,i=t.clips?t.clips.length:1,s=t.image||new ui({width:n,height:i}),l=(u,h,f)=>{e[t.evaluationKey]=f;const m=t.expression.evaluate(e);s.data[u+h+0]=Math.floor(255*m.r/m.a),s.data[u+h+1]=Math.floor(255*m.g/m.a),s.data[u+h+2]=Math.floor(255*m.b/m.a),s.data[u+h+3]=Math.floor(255*m.a)};if(t.clips)for(let u=0,h=0;u<i;++u,h+=4*n)for(let f=0,m=0;f<n;f++,m+=4){const y=f/(n-1),{start:v,end:w}=t.clips[u];l(h,m,v*(1-y)+w*y)}else for(let u=0,h=0;u<n;u++,h+=4)l(0,h,u/(n-1));return s}const fN=new jr({visibility:new gt(ke.layout_hillshade.visibility)});var pN={paint:new jr({"hillshade-illumination-direction":new gt(ke.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new gt(ke.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new gt(ke.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new gt(ke.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new gt(ke.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new gt(ke.paint_hillshade["hillshade-accent-color"])}),layout:fN};const mN=Kn([{name:"a_pos",components:2,type:"Int16"}],4),{members:gN}=mN;var vS={exports:{}};function P1(t,e,n){n=n||2;var i,s,l,u,h,f,m,y=e&&e.length,v=y?e[0]*n:t.length,w=C3(t,0,v,n,!0),S=[];if(!w||w.next===w.prev)return S;if(y&&(w=function(A,M,k,R){var L,z,B,j=[];for(L=0,z=M.length;L<z;L++)(B=C3(A,M[L]*R,L<z-1?M[L+1]*R:A.length,R,!1))===B.next&&(B.steiner=!0),j.push(EN(B));for(j.sort(wN),L=0;L<j.length;L++)k=bN(j[L],k);return k}(t,e,w,n)),t.length>80*n){i=l=t[0],s=u=t[1];for(var E=n;E<v;E+=n)(h=t[E])<i&&(i=h),(f=t[E+1])<s&&(s=f),h>l&&(l=h),f>u&&(u=f);m=(m=Math.max(l-i,u-s))!==0?32767/m:0}return h_(w,S,n,i,s,m,0),S}function C3(t,e,n,i,s){var l,u;if(s===bS(t,e,n,i)>0)for(l=e;l<n;l+=i)u=I3(l,t[l],t[l+1],u);else for(l=n-i;l>=e;l-=i)u=I3(l,t[l],t[l+1],u);return u&&R1(u,u.next)&&(f_(u),u=u.next),u}function cf(t,e){if(!t)return t;e||(e=t);var n,i=t;do if(n=!1,i.steiner||!R1(i,i.next)&&Ri(i.prev,i,i.next)!==0)i=i.next;else{if(f_(i),(i=e=i.prev)===i.next)break;n=!0}while(n||i!==e);return e}function h_(t,e,n,i,s,l,u){if(t){!u&&l&&function(y,v,w,S){var E=y;do E.z===0&&(E.z=xS(E.x,E.y,v,w,S)),E.prevZ=E.prev,E.nextZ=E.next,E=E.next;while(E!==y);E.prevZ.nextZ=null,E.prevZ=null,function(A){var M,k,R,L,z,B,j,V,Y=1;do{for(k=A,A=null,z=null,B=0;k;){for(B++,R=k,j=0,M=0;M<Y&&(j++,R=R.nextZ);M++);for(V=Y;j>0||V>0&&R;)j!==0&&(V===0||!R||k.z<=R.z)?(L=k,k=k.nextZ,j--):(L=R,R=R.nextZ,V--),z?z.nextZ=L:A=L,L.prevZ=z,z=L;k=R}z.nextZ=null,Y*=2}while(B>1)}(E)}(t,i,s,l);for(var h,f,m=t;t.prev!==t.next;)if(h=t.prev,f=t.next,l?_N(t,i,s,l):yN(t))e.push(h.i/n|0),e.push(t.i/n|0),e.push(f.i/n|0),f_(t),t=f.next,m=f.next;else if((t=f)===m){u?u===1?h_(t=vN(cf(t),e,n),e,n,i,s,l,2):u===2&&xN(t,e,n,i,s,l):h_(cf(t),e,n,i,s,l,1);break}}}function yN(t){var e=t.prev,n=t,i=t.next;if(Ri(e,n,i)>=0)return!1;for(var s=e.x,l=n.x,u=i.x,h=e.y,f=n.y,m=i.y,y=s<l?s<u?s:u:l<u?l:u,v=h<f?h<m?h:m:f<m?f:m,w=s>l?s>u?s:u:l>u?l:u,S=h>f?h>m?h:m:f>m?f:m,E=i.next;E!==e;){if(E.x>=y&&E.x<=w&&E.y>=v&&E.y<=S&&_m(s,h,l,f,u,m,E.x,E.y)&&Ri(E.prev,E,E.next)>=0)return!1;E=E.next}return!0}function _N(t,e,n,i){var s=t.prev,l=t,u=t.next;if(Ri(s,l,u)>=0)return!1;for(var h=s.x,f=l.x,m=u.x,y=s.y,v=l.y,w=u.y,S=h<f?h<m?h:m:f<m?f:m,E=y<v?y<w?y:w:v<w?v:w,A=h>f?h>m?h:m:f>m?f:m,M=y>v?y>w?y:w:v>w?v:w,k=xS(S,E,e,n,i),R=xS(A,M,e,n,i),L=t.prevZ,z=t.nextZ;L&&L.z>=k&&z&&z.z<=R;){if(L.x>=S&&L.x<=A&&L.y>=E&&L.y<=M&&L!==s&&L!==u&&_m(h,y,f,v,m,w,L.x,L.y)&&Ri(L.prev,L,L.next)>=0||(L=L.prevZ,z.x>=S&&z.x<=A&&z.y>=E&&z.y<=M&&z!==s&&z!==u&&_m(h,y,f,v,m,w,z.x,z.y)&&Ri(z.prev,z,z.next)>=0))return!1;z=z.nextZ}for(;L&&L.z>=k;){if(L.x>=S&&L.x<=A&&L.y>=E&&L.y<=M&&L!==s&&L!==u&&_m(h,y,f,v,m,w,L.x,L.y)&&Ri(L.prev,L,L.next)>=0)return!1;L=L.prevZ}for(;z&&z.z<=R;){if(z.x>=S&&z.x<=A&&z.y>=E&&z.y<=M&&z!==s&&z!==u&&_m(h,y,f,v,m,w,z.x,z.y)&&Ri(z.prev,z,z.next)>=0)return!1;z=z.nextZ}return!0}function vN(t,e,n){var i=t;do{var s=i.prev,l=i.next.next;!R1(s,l)&&A3(s,i,i.next,l)&&d_(s,l)&&d_(l,s)&&(e.push(s.i/n|0),e.push(i.i/n|0),e.push(l.i/n|0),f_(i),f_(i.next),i=t=l),i=i.next}while(i!==t);return cf(i)}function xN(t,e,n,i,s,l){var u=t;do{for(var h=u.next.next;h!==u.prev;){if(u.i!==h.i&&TN(u,h)){var f=M3(u,h);return u=cf(u,u.next),f=cf(f,f.next),h_(u,e,n,i,s,l,0),void h_(f,e,n,i,s,l,0)}h=h.next}u=u.next}while(u!==t)}function wN(t,e){return t.x-e.x}function bN(t,e){var n=function(s,l){var u,h=l,f=s.x,m=s.y,y=-1/0;do{if(m<=h.y&&m>=h.next.y&&h.next.y!==h.y){var v=h.x+(m-h.y)*(h.next.x-h.x)/(h.next.y-h.y);if(v<=f&&v>y&&(y=v,u=h.x<h.next.x?h:h.next,v===f))return u}h=h.next}while(h!==l);if(!u)return null;var w,S=u,E=u.x,A=u.y,M=1/0;h=u;do f>=h.x&&h.x>=E&&f!==h.x&&_m(m<A?f:y,m,E,A,m<A?y:f,m,h.x,h.y)&&(w=Math.abs(m-h.y)/(f-h.x),d_(h,s)&&(w<M||w===M&&(h.x>u.x||h.x===u.x&&SN(u,h)))&&(u=h,M=w)),h=h.next;while(h!==S);return u}(t,e);if(!n)return e;var i=M3(n,t);return cf(i,i.next),cf(n,n.next)}function SN(t,e){return Ri(t.prev,t,e.prev)<0&&Ri(e.next,t,t.next)<0}function xS(t,e,n,i,s){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-n)*s|0)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-i)*s|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function EN(t){var e=t,n=t;do(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next;while(e!==t);return n}function _m(t,e,n,i,s,l,u,h){return(s-u)*(e-h)>=(t-u)*(l-h)&&(t-u)*(i-h)>=(n-u)*(e-h)&&(n-u)*(l-h)>=(s-u)*(i-h)}function TN(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(n,i){var s=n;do{if(s.i!==n.i&&s.next.i!==n.i&&s.i!==i.i&&s.next.i!==i.i&&A3(s,s.next,n,i))return!0;s=s.next}while(s!==n);return!1}(t,e)&&(d_(t,e)&&d_(e,t)&&function(n,i){var s=n,l=!1,u=(n.x+i.x)/2,h=(n.y+i.y)/2;do s.y>h!=s.next.y>h&&s.next.y!==s.y&&u<(s.next.x-s.x)*(h-s.y)/(s.next.y-s.y)+s.x&&(l=!l),s=s.next;while(s!==n);return l}(t,e)&&(Ri(t.prev,t,e.prev)||Ri(t,e.prev,e))||R1(t,e)&&Ri(t.prev,t,t.next)>0&&Ri(e.prev,e,e.next)>0)}function Ri(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function R1(t,e){return t.x===e.x&&t.y===e.y}function A3(t,e,n,i){var s=L1(Ri(t,e,n)),l=L1(Ri(t,e,i)),u=L1(Ri(n,i,t)),h=L1(Ri(n,i,e));return s!==l&&u!==h||!(s!==0||!D1(t,n,e))||!(l!==0||!D1(t,i,e))||!(u!==0||!D1(n,t,i))||!(h!==0||!D1(n,e,i))}function D1(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function L1(t){return t>0?1:t<0?-1:0}function d_(t,e){return Ri(t.prev,t,t.next)<0?Ri(t,e,t.next)>=0&&Ri(t,t.prev,e)>=0:Ri(t,e,t.prev)<0||Ri(t,t.next,e)<0}function M3(t,e){var n=new wS(t.i,t.x,t.y),i=new wS(e.i,e.x,e.y),s=t.next,l=e.prev;return t.next=e,e.prev=t,n.next=s,s.prev=n,i.next=n,n.prev=i,l.next=i,i.prev=l,i}function I3(t,e,n,i){var s=new wS(t,e,n);return i?(s.next=i.next,s.prev=i,i.next.prev=s,i.next=s):(s.prev=s,s.next=s),s}function f_(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function wS(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function bS(t,e,n,i){for(var s=0,l=e,u=n-i;l<n;l+=i)s+=(t[u]-t[l])*(t[l+1]+t[u+1]),u=l;return s}vS.exports=P1,vS.exports.default=P1,P1.deviation=function(t,e,n,i){var s=e&&e.length,l=Math.abs(bS(t,0,s?e[0]*n:t.length,n));if(s)for(var u=0,h=e.length;u<h;u++)l-=Math.abs(bS(t,e[u]*n,u<h-1?e[u+1]*n:t.length,n));var f=0;for(u=0;u<i.length;u+=3){var m=i[u]*n,y=i[u+1]*n,v=i[u+2]*n;f+=Math.abs((t[m]-t[v])*(t[y+1]-t[m+1])-(t[m]-t[y])*(t[v+1]-t[m+1]))}return l===0&&f===0?0:Math.abs((f-l)/l)},P1.flatten=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},i=0,s=0;s<t.length;s++){for(var l=0;l<t[s].length;l++)for(var u=0;u<e;u++)n.vertices.push(t[s][l][u]);s>0&&n.holes.push(i+=t[s-1].length)}return n};var O1=ee(vS.exports);function SS(t,e){const n=t.length;if(n<=1)return[t];const i=[];let s,l;for(let u=0;u<n;u++){const h=Je(t[u]);h!==0&&(t[u].area=Math.abs(h),l===void 0&&(l=h<0),l===h<0?(s&&i.push(s),s=[t[u]]):s.push(t[u]))}if(s&&i.push(s),e>1)for(let u=0;u<i.length;u++)i[u].length<=e||($2(i[u],e,1,i[u].length-1,CN),i[u]=i[u].slice(0,e));return i}function CN(t,e){return e.area-t.area}function ES(t,e,n){const i=n.patternDependencies;let s=!1;for(const l of e){const u=l.paint.get(`${t}-pattern`);u.isConstant()||(s=!0);const h=u.constantOr(null);h&&(s=!0,i[h]=!0)}return s}function TS(t,e,n,i,s){const l=s.patternDependencies;for(const u of e){const h=u.paint.get(`${t}-pattern`).value;if(h.kind!=="constant"){let f=h.evaluate({zoom:i},n,{},s.availableImages);f=f&&f.name?f.name:f,l[f]=!0,n.patterns[u.id]=f}}return n}class z1{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(n=>n.id),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Bo,this.indexArray=new di,this.indexArray2=new sl,this.programConfigurations=new ll(e.layers,e.zoom),this.segments=new In,this.segments2=new In,this.stateDependentLayerIds=this.layers.filter(n=>n.isStateDependent()).map(n=>n.id),this.projection=e.projection}populate(e,n,i,s){this.hasPattern=ES("fill",this.layers,n);const l=this.layers[0].layout.get("fill-sort-key"),u=[];for(const{feature:h,id:f,index:m,sourceLayerIndex:y}of e){const v=this.layers[0]._featureFilter.needGeometry,w=mh(h,v);if(!this.layers[0]._featureFilter.filter(new Nr(this.zoom),w,i))continue;const S=l?l.evaluate(w,{},i,n.availableImages):void 0,E={id:f,properties:h.properties,type:h.type,sourceLayerIndex:y,index:m,geometry:v?w.geometry:nu(h,i,s),patterns:{},sortKey:S};u.push(E)}l&&u.sort((h,f)=>h.sortKey-f.sortKey);for(const h of u){const{geometry:f,index:m,sourceLayerIndex:y}=h;if(this.hasPattern){const v=TS("fill",this.layers,h,this.zoom,n);this.patternFeatures.push(v)}else this.addFeature(h,f,m,i,{},n.availableImages,n.brightness);n.featureIndex.insert(e[m].feature,f,m,y,this.index)}}update(e,n,i,s,l){const u=Object.keys(e).length!==0;u&&!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(e,n,u?this.stateDependentLayers:this.layers,i,s,l)}addFeatures(e,n,i,s,l,u){for(const h of this.patternFeatures)this.addFeature(h,h.geometry,h.index,n,i,s,u)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,gN),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(e,n,i,s,l,u=[],h){for(const f of SS(n,500)){let m=0;for(const A of f)m+=A.length;const y=this.segments.prepareSegment(m,this.layoutVertexArray,this.indexArray),v=y.vertexLength,w=[],S=[];for(const A of f){if(A.length===0)continue;A!==f[0]&&S.push(w.length/2);const M=this.segments2.prepareSegment(A.length,this.layoutVertexArray,this.indexArray2),k=M.vertexLength;this.layoutVertexArray.emplaceBack(A[0].x,A[0].y),this.indexArray2.emplaceBack(k+A.length-1,k),w.push(A[0].x),w.push(A[0].y);for(let R=1;R<A.length;R++)this.layoutVertexArray.emplaceBack(A[R].x,A[R].y),this.indexArray2.emplaceBack(k+R-1,k+R),w.push(A[R].x),w.push(A[R].y);M.vertexLength+=A.length,M.primitiveLength+=A.length}const E=O1(w,S);for(let A=0;A<E.length;A+=3)this.indexArray.emplaceBack(v+E[A],v+E[A+1],v+E[A+2]);y.vertexLength+=m,y.primitiveLength+=E.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,i,l,u,s,h)}}kt(z1,"FillBucket",{omit:["layers","patternFeatures"]});const AN=new jr({"fill-sort-key":new qt(ke.layout_fill["fill-sort-key"]),visibility:new gt(ke.layout_fill.visibility)});var MN={paint:new jr({"fill-antialias":new gt(ke.paint_fill["fill-antialias"]),"fill-opacity":new qt(ke.paint_fill["fill-opacity"]),"fill-color":new qt(ke.paint_fill["fill-color"]),"fill-outline-color":new qt(ke.paint_fill["fill-outline-color"]),"fill-translate":new gt(ke.paint_fill["fill-translate"]),"fill-translate-anchor":new gt(ke.paint_fill["fill-translate-anchor"]),"fill-pattern":new qt(ke.paint_fill["fill-pattern"]),"fill-emissive-strength":new gt(ke.paint_fill["fill-emissive-strength"])}),layout:AN};const IN=Kn([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),kN=Kn([{name:"a_pos_end",components:4,type:"Int16"}]),PN=Kn([{name:"a_centroid_pos",components:2,type:"Uint16"}]),RN=Kn([{name:"a_hidden_by_landmark",components:1,type:"Uint8"}]),DN=Kn([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:LN}=IN;var F1={},ON=he,k3=vm;function vm(t,e,n,i,s){this.properties={},this.extent=n,this.type=0,this._pbf=t,this._geometry=-1,this._keys=i,this._values=s,t.readFields(zN,this,e)}function zN(t,e,n){t==1?e.id=n.readVarint():t==2?function(i,s){for(var l=i.readVarint()+i.pos;i.pos<l;){var u=s._keys[i.readVarint()],h=s._values[i.readVarint()];s.properties[u]=h}}(n,e):t==3?e.type=n.readVarint():t==4&&(e._geometry=n.pos)}function FN(t){for(var e,n,i=0,s=0,l=t.length,u=l-1;s<l;u=s++)i+=((n=t[u]).x-(e=t[s]).x)*(e.y+n.y);return i}vm.types=["Unknown","Point","LineString","Polygon"],vm.prototype.loadGeometry=function(){var t=this._pbf;t.pos=this._geometry;for(var e,n=t.readVarint()+t.pos,i=1,s=0,l=0,u=0,h=[];t.pos<n;){if(s<=0){var f=t.readVarint();i=7&f,s=f>>3}if(s--,i===1||i===2)l+=t.readSVarint(),u+=t.readSVarint(),i===1&&(e&&h.push(e),e=[]),e.push(new ON(l,u));else{if(i!==7)throw new Error("unknown command "+i);e&&e.push(e[0].clone())}}return e&&h.push(e),h},vm.prototype.bbox=function(){var t=this._pbf;t.pos=this._geometry;for(var e=t.readVarint()+t.pos,n=1,i=0,s=0,l=0,u=1/0,h=-1/0,f=1/0,m=-1/0;t.pos<e;){if(i<=0){var y=t.readVarint();n=7&y,i=y>>3}if(i--,n===1||n===2)(s+=t.readSVarint())<u&&(u=s),s>h&&(h=s),(l+=t.readSVarint())<f&&(f=l),l>m&&(m=l);else if(n!==7)throw new Error("unknown command "+n)}return[u,f,h,m]},vm.prototype.toGeoJSON=function(t,e,n){var i,s,l=this.extent*Math.pow(2,n),u=this.extent*t,h=this.extent*e,f=this.loadGeometry(),m=vm.types[this.type];function y(S){for(var E=0;E<S.length;E++){var A=S[E];S[E]=[360*(A.x+u)/l-180,360/Math.PI*Math.atan(Math.exp((180-360*(A.y+h)/l)*Math.PI/180))-90]}}switch(this.type){case 1:var v=[];for(i=0;i<f.length;i++)v[i]=f[i][0];y(f=v);break;case 2:for(i=0;i<f.length;i++)y(f[i]);break;case 3:for(f=function(S){var E=S.length;if(E<=1)return[S];for(var A,M,k=[],R=0;R<E;R++){var L=FN(S[R]);L!==0&&(M===void 0&&(M=L<0),M===L<0?(A&&k.push(A),A=[S[R]]):A.push(S[R]))}return A&&k.push(A),k}(f),i=0;i<f.length;i++)for(s=0;s<f[i].length;s++)y(f[i][s])}f.length===1?f=f[0]:m="Multi"+m;var w={type:"Feature",geometry:{type:m,coordinates:f},properties:this.properties};return"id"in this&&(w.id=this.id),w};var BN=k3,P3=R3;function R3(t,e){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=t,this._keys=[],this._values=[],this._features=[],t.readFields(NN,this,e),this.length=this._features.length}function NN(t,e,n){t===15?e.version=n.readVarint():t===1?e.name=n.readString():t===5?e.extent=n.readVarint():t===2?e._features.push(n.pos):t===3?e._keys.push(n.readString()):t===4&&e._values.push(function(i){for(var s=null,l=i.readVarint()+i.pos;i.pos<l;){var u=i.readVarint()>>3;s=u===1?i.readString():u===2?i.readFloat():u===3?i.readDouble():u===4?i.readVarint64():u===5?i.readVarint():u===6?i.readSVarint():u===7?i.readBoolean():null}return s}(n))}R3.prototype.feature=function(t){if(t<0||t>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[t];var e=this._pbf.readVarint()+this._pbf.pos;return new BN(this._pbf,e,this.extent,this._keys,this._values)};var jN=P3;function UN(t,e,n){if(t===3){var i=new jN(n,n.readVarint()+n.pos);i.length&&(e[i.name]=i)}}var CS=F1.VectorTile=function(t,e){this.layers=t.readFields(UN,{},e)},B1=F1.VectorTileFeature=k3;function N1(t,e,n,i){const s=[],l=i===0?(u,h,f,m,y,v)=>{u.push(new q(v,f+(v-h)/(m-h)*(y-f)))}:(u,h,f,m,y,v)=>{u.push(new q(h+(v-f)/(y-f)*(m-h),v))};for(const u of t){const h=[];for(const f of u){if(f.length<=2)continue;const m=[];for(let w=0;w<f.length-1;w++){const S=f[w].x,E=f[w].y,A=f[w+1].x,M=f[w+1].y,k=i===0?S:E,R=i===0?A:M;k<e?R>e&&l(m,S,E,A,M,e):k>n?R<n&&l(m,S,E,A,M,n):m.push(f[w]),R<e&&k>=e&&l(m,S,E,A,M,e),R>n&&k<=n&&l(m,S,E,A,M,n)}let y=f[f.length-1];const v=i===0?y.x:y.y;v>=e&&v<=n&&m.push(y),m.length&&(y=m[m.length-1],m[0].x===y.x&&m[0].y===y.y||m.push(m[0]),h.push(m))}h.length&&s.push(h)}return s}F1.VectorTileLayer=P3;class D3{constructor(e){this._stringToNumber={},this._numberToString=[];for(let n=0;n<e.length;n++){const i=e[n];this._stringToNumber[i]=n,this._numberToString[n]=i}}encode(e){return this._stringToNumber[e]}decode(e){return this._numberToString[e]}}var VN={read:function(t,e,n,i,s){var l,u,h=8*s-i-1,f=(1<<h)-1,m=f>>1,y=-7,v=n?s-1:0,w=n?-1:1,S=t[e+v];for(v+=w,l=S&(1<<-y)-1,S>>=-y,y+=h;y>0;l=256*l+t[e+v],v+=w,y-=8);for(u=l&(1<<-y)-1,l>>=-y,y+=i;y>0;u=256*u+t[e+v],v+=w,y-=8);if(l===0)l=1-m;else{if(l===f)return u?NaN:1/0*(S?-1:1);u+=Math.pow(2,i),l-=m}return(S?-1:1)*u*Math.pow(2,l-i)},write:function(t,e,n,i,s,l){var u,h,f,m=8*l-s-1,y=(1<<m)-1,v=y>>1,w=s===23?Math.pow(2,-24)-Math.pow(2,-77):0,S=i?0:l-1,E=i?1:-1,A=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(h=isNaN(e)?1:0,u=y):(u=Math.floor(Math.log(e)/Math.LN2),e*(f=Math.pow(2,-u))<1&&(u--,f*=2),(e+=u+v>=1?w/f:w*Math.pow(2,1-v))*f>=2&&(u++,f/=2),u+v>=y?(h=0,u=y):u+v>=1?(h=(e*f-1)*Math.pow(2,s),u+=v):(h=e*Math.pow(2,v-1)*Math.pow(2,s),u=0));s>=8;t[n+S]=255&h,S+=E,h/=256,s-=8);for(u=u<<s|h,m+=s;m>0;t[n+S]=255&u,S+=E,u/=256,m-=8);t[n+S-E]|=128*A}},L3=$r,j1=VN;function $r(t){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(t)?t:new Uint8Array(t||0),this.pos=0,this.type=0,this.length=this.buf.length}$r.Varint=0,$r.Fixed64=1,$r.Bytes=2,$r.Fixed32=5;var AS=4294967296,O3=1/AS,z3=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function oc(t){return t.type===$r.Bytes?t.readVarint()+t.pos:t.pos+1}function xm(t,e,n){return n?4294967296*e+(t>>>0):4294967296*(e>>>0)+(t>>>0)}function F3(t,e,n){var i=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(7*Math.LN2));n.realloc(i);for(var s=n.pos-1;s>=t;s--)n.buf[s+i]=n.buf[s]}function $N(t,e){for(var n=0;n<t.length;n++)e.writeVarint(t[n])}function GN(t,e){for(var n=0;n<t.length;n++)e.writeSVarint(t[n])}function HN(t,e){for(var n=0;n<t.length;n++)e.writeFloat(t[n])}function qN(t,e){for(var n=0;n<t.length;n++)e.writeDouble(t[n])}function WN(t,e){for(var n=0;n<t.length;n++)e.writeBoolean(t[n])}function ZN(t,e){for(var n=0;n<t.length;n++)e.writeFixed32(t[n])}function XN(t,e){for(var n=0;n<t.length;n++)e.writeSFixed32(t[n])}function KN(t,e){for(var n=0;n<t.length;n++)e.writeFixed64(t[n])}function YN(t,e){for(var n=0;n<t.length;n++)e.writeSFixed64(t[n])}function U1(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+16777216*t[e+3]}function wm(t,e,n){t[n]=e,t[n+1]=e>>>8,t[n+2]=e>>>16,t[n+3]=e>>>24}function B3(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+(t[e+3]<<24)}$r.prototype={destroy:function(){this.buf=null},readFields:function(t,e,n){for(n=n||this.length;this.pos<n;){var i=this.readVarint(),s=i>>3,l=this.pos;this.type=7&i,t(s,e,this),this.pos===l&&this.skip(i)}return e},readMessage:function(t,e){return this.readFields(t,e,this.readVarint()+this.pos)},readFixed32:function(){var t=U1(this.buf,this.pos);return this.pos+=4,t},readSFixed32:function(){var t=B3(this.buf,this.pos);return this.pos+=4,t},readFixed64:function(){var t=U1(this.buf,this.pos)+U1(this.buf,this.pos+4)*AS;return this.pos+=8,t},readSFixed64:function(){var t=U1(this.buf,this.pos)+B3(this.buf,this.pos+4)*AS;return this.pos+=8,t},readFloat:function(){var t=j1.read(this.buf,this.pos,!0,23,4);return this.pos+=4,t},readDouble:function(){var t=j1.read(this.buf,this.pos,!0,52,8);return this.pos+=8,t},readVarint:function(t){var e,n,i=this.buf;return e=127&(n=i[this.pos++]),n<128?e:(e|=(127&(n=i[this.pos++]))<<7,n<128?e:(e|=(127&(n=i[this.pos++]))<<14,n<128?e:(e|=(127&(n=i[this.pos++]))<<21,n<128?e:function(s,l,u){var h,f,m=u.buf;if(h=(112&(f=m[u.pos++]))>>4,f<128||(h|=(127&(f=m[u.pos++]))<<3,f<128)||(h|=(127&(f=m[u.pos++]))<<10,f<128)||(h|=(127&(f=m[u.pos++]))<<17,f<128)||(h|=(127&(f=m[u.pos++]))<<24,f<128)||(h|=(1&(f=m[u.pos++]))<<31,f<128))return xm(s,h,l);throw new Error("Expected varint not more than 10 bytes")}(e|=(15&(n=i[this.pos]))<<28,t,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var t=this.readVarint();return t%2==1?(t+1)/-2:t/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var t=this.readVarint()+this.pos,e=this.pos;return this.pos=t,t-e>=12&&z3?function(n,i,s){return z3.decode(n.subarray(i,s))}(this.buf,e,t):function(n,i,s){for(var l="",u=i;u<s;){var h,f,m,y=n[u],v=null,w=y>239?4:y>223?3:y>191?2:1;if(u+w>s)break;w===1?y<128&&(v=y):w===2?(192&(h=n[u+1]))==128&&(v=(31&y)<<6|63&h)<=127&&(v=null):w===3?(f=n[u+2],(192&(h=n[u+1]))==128&&(192&f)==128&&((v=(15&y)<<12|(63&h)<<6|63&f)<=2047||v>=55296&&v<=57343)&&(v=null)):w===4&&(f=n[u+2],m=n[u+3],(192&(h=n[u+1]))==128&&(192&f)==128&&(192&m)==128&&((v=(15&y)<<18|(63&h)<<12|(63&f)<<6|63&m)<=65535||v>=1114112)&&(v=null)),v===null?(v=65533,w=1):v>65535&&(v-=65536,l+=String.fromCharCode(v>>>10&1023|55296),v=56320|1023&v),l+=String.fromCharCode(v),u+=w}return l}(this.buf,e,t)},readBytes:function(){var t=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,t);return this.pos=t,e},readPackedVarint:function(t,e){if(this.type!==$r.Bytes)return t.push(this.readVarint(e));var n=oc(this);for(t=t||[];this.pos<n;)t.push(this.readVarint(e));return t},readPackedSVarint:function(t){if(this.type!==$r.Bytes)return t.push(this.readSVarint());var e=oc(this);for(t=t||[];this.pos<e;)t.push(this.readSVarint());return t},readPackedBoolean:function(t){if(this.type!==$r.Bytes)return t.push(this.readBoolean());var e=oc(this);for(t=t||[];this.pos<e;)t.push(this.readBoolean());return t},readPackedFloat:function(t){if(this.type!==$r.Bytes)return t.push(this.readFloat());var e=oc(this);for(t=t||[];this.pos<e;)t.push(this.readFloat());return t},readPackedDouble:function(t){if(this.type!==$r.Bytes)return t.push(this.readDouble());var e=oc(this);for(t=t||[];this.pos<e;)t.push(this.readDouble());return t},readPackedFixed32:function(t){if(this.type!==$r.Bytes)return t.push(this.readFixed32());var e=oc(this);for(t=t||[];this.pos<e;)t.push(this.readFixed32());return t},readPackedSFixed32:function(t){if(this.type!==$r.Bytes)return t.push(this.readSFixed32());var e=oc(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed32());return t},readPackedFixed64:function(t){if(this.type!==$r.Bytes)return t.push(this.readFixed64());var e=oc(this);for(t=t||[];this.pos<e;)t.push(this.readFixed64());return t},readPackedSFixed64:function(t){if(this.type!==$r.Bytes)return t.push(this.readSFixed64());var e=oc(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed64());return t},skip:function(t){var e=7&t;if(e===$r.Varint)for(;this.buf[this.pos++]>127;);else if(e===$r.Bytes)this.pos=this.readVarint()+this.pos;else if(e===$r.Fixed32)this.pos+=4;else{if(e!==$r.Fixed64)throw new Error("Unimplemented type: "+e);this.pos+=8}},writeTag:function(t,e){this.writeVarint(t<<3|e)},realloc:function(t){for(var e=this.length||16;e<this.pos+t;)e*=2;if(e!==this.length){var n=new Uint8Array(e);n.set(this.buf),this.buf=n,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(t){this.realloc(4),wm(this.buf,t,this.pos),this.pos+=4},writeSFixed32:function(t){this.realloc(4),wm(this.buf,t,this.pos),this.pos+=4},writeFixed64:function(t){this.realloc(8),wm(this.buf,-1&t,this.pos),wm(this.buf,Math.floor(t*O3),this.pos+4),this.pos+=8},writeSFixed64:function(t){this.realloc(8),wm(this.buf,-1&t,this.pos),wm(this.buf,Math.floor(t*O3),this.pos+4),this.pos+=8},writeVarint:function(t){(t=+t||0)>268435455||t<0?function(e,n){var i,s;if(e>=0?(i=e%4294967296|0,s=e/4294967296|0):(s=~(-e/4294967296),4294967295^(i=~(-e%4294967296))?i=i+1|0:(i=0,s=s+1|0)),e>=18446744073709552e3||e<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");n.realloc(10),function(l,u,h){h.buf[h.pos++]=127&l|128,l>>>=7,h.buf[h.pos++]=127&l|128,l>>>=7,h.buf[h.pos++]=127&l|128,l>>>=7,h.buf[h.pos++]=127&l|128,h.buf[h.pos]=127&(l>>>=7)}(i,0,n),function(l,u){var h=(7&l)<<4;u.buf[u.pos++]|=h|((l>>>=3)?128:0),l&&(u.buf[u.pos++]=127&l|((l>>>=7)?128:0),l&&(u.buf[u.pos++]=127&l|((l>>>=7)?128:0),l&&(u.buf[u.pos++]=127&l|((l>>>=7)?128:0),l&&(u.buf[u.pos++]=127&l|((l>>>=7)?128:0),l&&(u.buf[u.pos++]=127&l)))))}(s,n)}(t,this):(this.realloc(4),this.buf[this.pos++]=127&t|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=t>>>7&127))))},writeSVarint:function(t){this.writeVarint(t<0?2*-t-1:2*t)},writeBoolean:function(t){this.writeVarint(!!t)},writeString:function(t){t=String(t),this.realloc(4*t.length),this.pos++;var e=this.pos;this.pos=function(i,s,l){for(var u,h,f=0;f<s.length;f++){if((u=s.charCodeAt(f))>55295&&u<57344){if(!h){u>56319||f+1===s.length?(i[l++]=239,i[l++]=191,i[l++]=189):h=u;continue}if(u<56320){i[l++]=239,i[l++]=191,i[l++]=189,h=u;continue}u=h-55296<<10|u-56320|65536,h=null}else h&&(i[l++]=239,i[l++]=191,i[l++]=189,h=null);u<128?i[l++]=u:(u<2048?i[l++]=u>>6|192:(u<65536?i[l++]=u>>12|224:(i[l++]=u>>18|240,i[l++]=u>>12&63|128),i[l++]=u>>6&63|128),i[l++]=63&u|128)}return l}(this.buf,t,this.pos);var n=this.pos-e;n>=128&&F3(e,n,this),this.pos=e-1,this.writeVarint(n),this.pos+=n},writeFloat:function(t){this.realloc(4),j1.write(this.buf,t,this.pos,!0,23,4),this.pos+=4},writeDouble:function(t){this.realloc(8),j1.write(this.buf,t,this.pos,!0,52,8),this.pos+=8},writeBytes:function(t){var e=t.length;this.writeVarint(e),this.realloc(e);for(var n=0;n<e;n++)this.buf[this.pos++]=t[n]},writeRawMessage:function(t,e){this.pos++;var n=this.pos;t(e,this);var i=this.pos-n;i>=128&&F3(n,i,this),this.pos=n-1,this.writeVarint(i),this.pos+=i},writeMessage:function(t,e,n){this.writeTag(t,$r.Bytes),this.writeRawMessage(e,n)},writePackedVarint:function(t,e){e.length&&this.writeMessage(t,$N,e)},writePackedSVarint:function(t,e){e.length&&this.writeMessage(t,GN,e)},writePackedBoolean:function(t,e){e.length&&this.writeMessage(t,WN,e)},writePackedFloat:function(t,e){e.length&&this.writeMessage(t,HN,e)},writePackedDouble:function(t,e){e.length&&this.writeMessage(t,qN,e)},writePackedFixed32:function(t,e){e.length&&this.writeMessage(t,ZN,e)},writePackedSFixed32:function(t,e){e.length&&this.writeMessage(t,XN,e)},writePackedFixed64:function(t,e){e.length&&this.writeMessage(t,KN,e)},writePackedSFixed64:function(t,e){e.length&&this.writeMessage(t,YN,e)},writeBytesField:function(t,e){this.writeTag(t,$r.Bytes),this.writeBytes(e)},writeFixed32Field:function(t,e){this.writeTag(t,$r.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(t,e){this.writeTag(t,$r.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(t,e){this.writeTag(t,$r.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(t,e){this.writeTag(t,$r.Fixed64),this.writeSFixed64(e)},writeVarintField:function(t,e){this.writeTag(t,$r.Varint),this.writeVarint(e)},writeSVarintField:function(t,e){this.writeTag(t,$r.Varint),this.writeSVarint(e)},writeStringField:function(t,e){this.writeTag(t,$r.Bytes),this.writeString(e)},writeFloatField:function(t,e){this.writeTag(t,$r.Fixed32),this.writeFloat(e)},writeDoubleField:function(t,e){this.writeTag(t,$r.Fixed64),this.writeDouble(e)},writeBooleanField:function(t,e){this.writeVarintField(t,!!e)}};var V1=ee(L3);const QN=["tile","layer","source","sourceLayer","state"];class N3{constructor(e,n,i,s,l){this.type="Feature",this._vectorTileFeature=e,this._z=n,this._x=i,this._y=s,this.properties=e.properties,this.id=l}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(e){this._geometry=e}toJSON(){const e={type:"Feature",state:void 0,geometry:this.geometry,properties:this.properties};this.id!==void 0&&(e.id=this.id);for(const n of QN)this[n]!==void 0&&(e[n]=this[n]);return e}}class JN{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(e,n,i){const s=String(n);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][s]=this.stateChanges[e][s]||{},ge(this.stateChanges[e][s],i),this.deletedStates[e]===null){this.deletedStates[e]={};for(const l in this.state[e])l!==s&&(this.deletedStates[e][l]=null)}else if(this.deletedStates[e]&&this.deletedStates[e][s]===null){this.deletedStates[e][s]={};for(const l in this.state[e][s])i[l]||(this.deletedStates[e][s][l]=null)}else for(const l in i)this.deletedStates[e]&&this.deletedStates[e][s]&&this.deletedStates[e][s][l]===null&&delete this.deletedStates[e][s][l]}removeFeatureState(e,n,i){if(this.deletedStates[e]===null)return;const s=String(n);if(this.deletedStates[e]=this.deletedStates[e]||{},i&&n!==void 0)this.deletedStates[e][s]!==null&&(this.deletedStates[e][s]=this.deletedStates[e][s]||{},this.deletedStates[e][s][i]=null);else if(n!==void 0)if(this.stateChanges[e]&&this.stateChanges[e][s])for(i in this.deletedStates[e][s]={},this.stateChanges[e][s])this.deletedStates[e][s][i]=null;else this.deletedStates[e][s]=null;else this.deletedStates[e]=null}getState(e,n){const i=String(n),s=ge({},(this.state[e]||{})[i],(this.stateChanges[e]||{})[i]);if(this.deletedStates[e]===null)return{};if(this.deletedStates[e]){const l=this.deletedStates[e][n];if(l===null)return{};for(const u in l)delete s[u]}return s}initializeTileState(e,n){e.setFeatureState(this.state,n)}coalesceChanges(e,n){const i={};for(const s in this.stateChanges){this.state[s]=this.state[s]||{};const l={};for(const u in this.stateChanges[s])this.state[s][u]||(this.state[s][u]={}),ge(this.state[s][u],this.stateChanges[s][u]),l[u]=this.state[s][u];i[s]=l}for(const s in this.deletedStates){this.state[s]=this.state[s]||{};const l={};if(this.deletedStates[s]===null)for(const u in this.state[s])l[u]={},this.state[s][u]={};else for(const u in this.deletedStates[s]){if(this.deletedStates[s][u]===null)this.state[s][u]={};else if(this.state[s][u])for(const h of Object.keys(this.deletedStates[s][u]))delete this.state[s][u][h];l[u]=this.state[s][u]}i[s]=i[s]||{},ge(i[s],l)}if(this.stateChanges={},this.deletedStates={},Object.keys(i).length!==0)for(const s in e)e[s].setFeatureState(i,n)}}class j3{constructor(e){this.size=e,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(e,n){const i=this.toIdx(e,n);return{min:this.minimums[i],max:this.maximums[i]}}isLeaf(e,n){return this.leaves[this.toIdx(e,n)]}toIdx(e,n){return n*this.size+e}}function U3(t,e,n,i){let s=0,l=Number.MAX_VALUE;for(let u=0;u<3;u++)if(Math.abs(i[u])<1e-15){if(n[u]<t[u]||n[u]>e[u])return null}else{const h=1/i[u];let f=(t[u]-n[u])*h,m=(e[u]-n[u])*h;if(f>m){const y=f;f=m,m=y}if(f>s&&(s=f),m<l&&(l=m),s>l)return null}return s}function V3(t,e,n,i,s,l,u,h,f,m,y){const v=i-t,w=s-e,S=l-n,E=u-t,A=h-e,M=f-n,k=y[1]*M-y[2]*A,R=y[2]*E-y[0]*M,L=y[0]*A-y[1]*E,z=v*k+w*R+S*L;if(Math.abs(z)<1e-15)return null;const B=1/z,j=m[0]-t,V=m[1]-e,Y=m[2]-n,ne=(j*k+V*R+Y*L)*B;if(ne<0||ne>1)return null;const re=V*S-Y*w,J=Y*v-j*S,ae=j*w-V*v,le=(y[0]*re+y[1]*J+y[2]*ae)*B;return le<0||ne+le>1?null:(E*re+A*J+M*ae)*B}function $3(t,e,n){return(t-e)/(n-e)}function G3(t,e,n,i,s,l,u,h,f){const m=1<<n,y=l-i,v=u-s,w=(t+1)/m*y+i,S=(e+0)/m*v+s,E=(e+1)/m*v+s;h[0]=(t+0)/m*y+i,h[1]=S,f[0]=w,f[1]=E}class H3{constructor(e){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=e,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const n=function(l){const u=Math.ceil(Math.log2(l.dim/8)),h=[];let f=Math.ceil(Math.pow(2,u));const m=1/f,y=(S,E,A,M,k)=>{const R=M?1:0,L=(S+1)*A-R,z=E*A,B=(E+1)*A-R;k[0]=S*A,k[1]=z,k[2]=L,k[3]=B};let v=new j3(f);const w=[];for(let S=0;S<f*f;S++){y(S%f,Math.floor(S/f),m,!1,w);const E=yh(w[0],w[1],l),A=yh(w[2],w[1],l),M=yh(w[2],w[3],l),k=yh(w[0],w[3],l);v.minimums.push(Math.min(E,A,M,k)),v.maximums.push(Math.max(E,A,M,k)),v.leaves.push(1)}for(h.push(v),f/=2;f>=1;f/=2){const S=h[h.length-1];v=new j3(f);for(let E=0;E<f*f;E++){y(E%f,Math.floor(E/f),2,!0,w);const A=S.getElevation(w[0],w[1]),M=S.getElevation(w[2],w[1]),k=S.getElevation(w[2],w[3]),R=S.getElevation(w[0],w[3]),L=S.isLeaf(w[0],w[1]),z=S.isLeaf(w[2],w[1]),B=S.isLeaf(w[2],w[3]),j=S.isLeaf(w[0],w[3]),V=Math.min(A.min,M.min,k.min,R.min),Y=Math.max(A.max,M.max,k.max,R.max),ne=L&&z&&B&&j;v.maximums.push(Y),v.minimums.push(V),v.leaves.push(Y-V<=5&&ne?1:0)}h.push(v)}return h}(this.dem),i=n.length-1,s=n[i];this._addNode(s.minimums[0],s.maximums[0],s.leaves[0]),this._construct(n,0,0,i,0)}raycastRoot(e,n,i,s,l,u,h=1){return U3([e,n,-100],[i,s,this.maximums[0]*h],l,u)}raycast(e,n,i,s,l,u,h=1){if(!this.nodeCount)return null;const f=this.raycastRoot(e,n,i,s,l,u,h);if(f==null)return null;const m=[],y=[],v=[],w=[],S=[{idx:0,t:f,nodex:0,nodey:0,depth:0}];for(;S.length>0;){const{idx:E,t:A,nodex:M,nodey:k,depth:R}=S.pop();if(this.leaves[E]){G3(M,k,R,e,n,i,s,v,w);const z=1<<R,B=(M+0)/z,j=(M+1)/z,V=(k+0)/z,Y=(k+1)/z,ne=yh(B,V,this.dem)*h,re=yh(j,V,this.dem)*h,J=yh(j,Y,this.dem)*h,ae=yh(B,Y,this.dem)*h,le=V3(v[0],v[1],ne,w[0],v[1],re,w[0],w[1],J,l,u),oe=V3(w[0],w[1],J,v[0],w[1],ae,v[0],v[1],ne,l,u),Ee=Math.min(le!==null?le:Number.MAX_VALUE,oe!==null?oe:Number.MAX_VALUE);if(Ee!==Number.MAX_VALUE)return Ee;{const xe=fe.scaleAndAdd([],l,u,A);if(q3(ne,re,ae,J,$3(xe[0],v[0],w[0]),$3(xe[1],v[1],w[1]))>=xe[2])return A}continue}let L=0;for(let z=0;z<this._siblingOffset.length;z++){G3((M<<1)+this._siblingOffset[z][0],(k<<1)+this._siblingOffset[z][1],R+1,e,n,i,s,v,w),v[2]=-100,w[2]=this.maximums[this.childOffsets[E]+z]*h;const B=U3(v,w,l,u);if(B!=null){const j=B;m[z]=j;let V=!1;for(let Y=0;Y<L&&!V;Y++)j>=m[y[Y]]&&(y.splice(Y,0,z),V=!0);V||(y[L]=z),L++}}for(let z=0;z<L;z++){const B=y[z];S.push({idx:this.childOffsets[E]+B,t:m[B],nodex:(M<<1)+this._siblingOffset[B][0],nodey:(k<<1)+this._siblingOffset[B][1],depth:R+1})}}return null}_addNode(e,n,i){return this.minimums.push(e),this.maximums.push(n),this.leaves.push(i),this.childOffsets.push(0),this.nodeCount++}_construct(e,n,i,s,l){if(e[s].isLeaf(n,i)===1)return;this.childOffsets[l]||(this.childOffsets[l]=this.nodeCount);const u=s-1,h=e[u];let f=0,m=0;for(let y=0;y<this._siblingOffset.length;y++){const v=2*n+this._siblingOffset[y][0],w=2*i+this._siblingOffset[y][1],S=h.getElevation(v,w),E=h.isLeaf(v,w),A=this._addNode(S.min,S.max,E);E&&(f|=1<<y),m||(m=A)}for(let y=0;y<this._siblingOffset.length;y++)f&1<<y||this._construct(e,2*n+this._siblingOffset[y][0],2*i+this._siblingOffset[y][1],u,m+y)}}function q3(t,e,n,i,s,l){return nn(nn(t,n,l),nn(e,i,l),s)}function yh(t,e,n){const i=n.dim,s=ce(t*i-.5,0,i-1),l=ce(e*i-.5,0,i-1),u=Math.floor(s),h=Math.floor(l),f=Math.min(u+1,i-1),m=Math.min(h+1,i-1);return q3(n.get(u,h),n.get(f,h),n.get(u,m),n.get(f,m),s-u,l-h)}const W3={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};function e6(t,e,n){return(256*t*256+256*e+n)/10-1e4}function t6(t,e,n){return 256*t+e+n/256-32768}class bm{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(e,n,i,s=!1,l=!1){if(this.uid=e,n.height!==n.width)throw new RangeError("DEM tiles must be square");if(i&&i!=="mapbox"&&i!=="terrarium")return ye(`"${i}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=n.height;const u=this.dim=n.height-2,h=new Uint32Array(n.data.buffer);if(this.pixels=new Uint8Array(n.data.buffer),this.encoding=i||"mapbox",this.borderReady=s,!s){for(let f=0;f<u;f++)h[this._idx(-1,f)]=h[this._idx(0,f)],h[this._idx(u,f)]=h[this._idx(u-1,f)],h[this._idx(f,-1)]=h[this._idx(f,0)],h[this._idx(f,u)]=h[this._idx(f,u-1)];h[this._idx(-1,-1)]=h[this._idx(0,0)],h[this._idx(u,-1)]=h[this._idx(u-1,0)],h[this._idx(-1,u)]=h[this._idx(0,u-1)],h[this._idx(u,u)]=h[this._idx(u-1,u-1)],l&&this._buildQuadTree()}}_buildQuadTree(){this._tree=new H3(this)}get(e,n,i=!1){i&&(e=ce(e,-1,this.dim),n=ce(n,-1,this.dim));const s=4*this._idx(e,n);return(this.encoding==="terrarium"?t6:e6)(this.pixels[s],this.pixels[s+1],this.pixels[s+2])}static getUnpackVector(e){return W3[e]}get unpackVector(){return W3[this.encoding]}_idx(e,n){if(e<-1||e>=this.dim+1||n<-1||n>=this.dim+1)throw new RangeError(`out of range source coordinates for DEM; coords = (${e}, ${n}), dim = ${this.dim}, stride = ${this.stride}`);return(n+1)*this.stride+(e+1)}static pack(e,n){const i=[0,0,0,0],s=bm.getUnpackVector(n);let l=Math.floor((e+s[3])/s[2]);return i[2]=l%256,l=Math.floor(l/256),i[1]=l%256,l=Math.floor(l/256),i[0]=l,i}getPixels(){return new ui({width:this.stride,height:this.stride},this.pixels)}backfillBorder(e,n,i){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");let s=n*this.dim,l=n*this.dim+this.dim,u=i*this.dim,h=i*this.dim+this.dim;switch(n){case-1:s=l-1;break;case 1:l=s+1}switch(i){case-1:u=h-1;break;case 1:h=u+1}const f=-n*this.dim,m=-i*this.dim;for(let y=u;y<h;y++)for(let v=s;v<l;v++){const w=4*this._idx(v,y),S=4*this._idx(v+f,y+m);this.pixels[w+0]=e.pixels[S+0],this.pixels[w+1]=e.pixels[S+1],this.pixels[w+2]=e.pixels[S+2],this.pixels[w+3]=e.pixels[S+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}kt(bm,"DEMData"),kt(H3,"DemMinMaxQuadTree",{omit:["dem"]});class n6{isDataAvailableAtPoint(e){const n=this._source();if(this.isUsingMockSource()||!n||e.y<0||e.y>1)return!1;const i=n.getSource().maxzoom,s=1<<i,l=Math.floor(e.x),u=Math.floor((e.x-l)*s),h=Math.floor(e.y*s),f=this.findDEMTileFor(new Ir(i,l,i,u,h));return!(!f||!f.dem)}getAtPointOrZero(e,n=0){return this.getAtPoint(e,n)||0}getAtPoint(e,n,i=!0){if(this.isUsingMockSource())return null;n==null&&(n=null);const s=this._source();if(!s||e.y<0||e.y>1)return n;const l=s.getSource().maxzoom,u=1<<l,h=Math.floor(e.x),f=e.x-h,m=new Ir(l,h,l,Math.floor(f*u),Math.floor(e.y*u)),y=this.findDEMTileFor(m);if(!y||!y.dem)return n;const v=y.dem,w=1<<y.tileID.canonical.z,S=(f*w-y.tileID.canonical.x)*v.dim,E=(e.y*w-y.tileID.canonical.y)*v.dim,A=Math.floor(S),M=Math.floor(E);return(i?this.exaggeration():1)*nn(nn(v.get(A,M),v.get(A,M+1),E-M),nn(v.get(A+1,M),v.get(A+1,M+1),E-M),S-A)}getAtTileOffset(e,n,i){const s=1<<e.canonical.z;return this.getAtPointOrZero(new Un(e.wrap+(e.canonical.x+n/Ge)/s,(e.canonical.y+i/Ge)/s))}getAtTileOffsetFunc(e,n,i,s){return l=>{const u=this.getAtTileOffset(e,l.x,l.y),h=s.upVector(e.canonical,l.x,l.y),f=s.upVectorScale(e.canonical,n,i).metersToTile;return fe.scale(h,h,u*f),h}}getForTilePoints(e,n,i,s){if(this.isUsingMockSource())return!1;const l=Sm.create(this,e,s);return!!l&&(n.forEach(u=>{u[2]=this.exaggeration()*l.getElevationAt(u[0],u[1],i)}),!0)}getMinMaxForTile(e){if(this.isUsingMockSource())return null;const n=this.findDEMTileFor(e);if(!n||!n.dem)return null;const i=n.dem.tree,s=n.tileID,l=1<<e.canonical.z-s.canonical.z;let u=e.canonical.x/l-s.canonical.x,h=e.canonical.y/l-s.canonical.y,f=0;for(let m=0;m<e.canonical.z-s.canonical.z&&!i.leaves[f];m++){u*=2,h*=2;const y=2*Math.floor(h)+Math.floor(u);f=i.childOffsets[f]+y,u%=1,h%=1}return{min:this.exaggeration()*i.minimums[f],max:this.exaggeration()*i.maximums[f]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(e,n,i){throw new Error("Pure virtual method called.")}pointCoordinate(e){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(e){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}}class Sm{constructor(e,n,i){this._demTile=e,this._dem=this._demTile.dem,this._scale=n,this._offset=i}static create(e,n,i){const s=i||e.findDEMTileFor(n);if(!s||!s.dem)return;const l=s.dem,u=s.tileID,h=1<<n.canonical.z-u.canonical.z;return new Sm(s,s.tileSize/Ge/h,[(n.canonical.x/h-u.canonical.x)*l.dim,(n.canonical.y/h-u.canonical.y)*l.dim])}tileCoordToPixel(e,n){const i=n*this._scale+this._offset[1],s=Math.floor(e*this._scale+this._offset[0]),l=Math.floor(i);return new q(s,l)}getElevationAt(e,n,i,s){const l=e*this._scale+this._offset[0],u=n*this._scale+this._offset[1],h=Math.floor(l),f=Math.floor(u),m=this._dem;return s=!!s,i?nn(nn(m.get(h,f,s),m.get(h,f+1,s),u-f),nn(m.get(h+1,f,s),m.get(h+1,f+1,s),u-f),l-h):m.get(h,f,s)}getElevationAtPixel(e,n,i){return this._dem.get(e,n,!!i)}getMeterToDEM(e){return(1<<this._demTile.tileID.canonical.z)*mr(1,e)*this._dem.stride}}class MS{constructor(e,n){this.tileID=e,this.x=e.canonical.x,this.y=e.canonical.y,this.z=e.canonical.z,this.grid=new rl(Ge,16,0),this.featureIndexArray=new r1,this.promoteId=n}insert(e,n,i,s,l,u=0){const h=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(i,s,l,u);const f=this.grid;for(let m=0;m<n.length;m++){const y=n[m],v=[1/0,1/0,-1/0,-1/0];for(let w=0;w<y.length;w++){const S=y[w];v[0]=Math.min(v[0],S.x),v[1]=Math.min(v[1],S.y),v[2]=Math.max(v[2],S.x),v[3]=Math.max(v[3],S.y)}v[0]<Ge&&v[1]<Ge&&v[2]>=0&&v[3]>=0&&f.insert(h,v[0],v[1],v[2],v[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new CS(new V1(this.rawTileData)).layers,this.sourceLayerCoder=new D3(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const e in this.vtLayers)this.vtFeatures[e]=[]}return this.vtLayers}query(e,n,i,s){this.loadVTLayers();const l=e.params||{},u=ju(l.filter),h=e.tileResult,f=e.transform,m=h.bufferedTilespaceBounds,y=this.grid.query(m.min.x,m.min.y,m.max.x,m.max.y,(E,A,M,k)=>_3(h.bufferedTilespaceGeometry,E,A,M,k));y.sort(r6);let v=null;f.elevation&&y.length>0&&(v=Sm.create(f.elevation,this.tileID));const w={};let S;for(let E=0;E<y.length;E++){const A=y[E];if(A===S)continue;S=A;const M=this.featureIndexArray.get(A);let k=null;this.loadMatchingFeature(w,M,u,l.layers,l.availableImages,n,i,s,(R,L,z,B=0)=>(k||(k=nu(R,this.tileID.canonical,e.tileTransform)),L.queryIntersectsFeature(h,R,z,k,this.z,e.transform,e.pixelPosMatrix,v,B)))}return w}loadMatchingFeature(e,n,i,s,l,u,h,f,m){const{featureIndex:y,bucketIndex:v,sourceLayerIndex:w,layoutVertexArrayOffset:S}=n,E=this.bucketLayerIDs[v];if(s&&!function(R,L){for(let z=0;z<R.length;z++)if(L.indexOf(R[z])>=0)return!0;return!1}(s,E))return;const A=this.sourceLayerCoder.decode(w),M=this.vtLayers[A].feature(y);if(i.needGeometry){const R=mh(M,!0);if(!i.filter(new Nr(this.tileID.overscaledZ),R,this.tileID.canonical))return}else if(!i.filter(new Nr(this.tileID.overscaledZ),M))return;const k=this.getId(M,A);for(let R=0;R<E.length;R++){const L=E[R];if(s&&s.indexOf(L)<0)continue;const z=u[L];if(!z)continue;let B={};k!==void 0&&f&&(B=f.getState(z.sourceLayer||"_geojsonTileLayer",k));const j=ge({},h[L]);j.paint=Z3(j.paint,z.paint,M,B,l),j.layout=Z3(j.layout,z.layout,M,B,l);const V=!m||m(M,z,B,S);if(!V)continue;const Y=new N3(M,this.z,this.x,this.y,k);Y.layer=j;let ne=e[L];ne===void 0&&(ne=e[L]=[]),ne.push({featureIndex:y,feature:Y,intersectionZ:V})}}lookupSymbolFeatures(e,n,i,s,l,u,h,f){const m={};this.loadVTLayers();const y=ju(l);for(const v of e)this.loadMatchingFeature(m,{bucketIndex:i,sourceLayerIndex:s,featureIndex:v,layoutVertexArrayOffset:0},y,u,h,f,n);return m}loadFeature(e){const{featureIndex:n,sourceLayerIndex:i}=e;this.loadVTLayers();const s=this.sourceLayerCoder.decode(i),l=this.vtFeatures[s];if(l[n])return l[n];const u=this.vtLayers[s].feature(n);return l[n]=u,u}hasLayer(e){for(const n of this.bucketLayerIDs)for(const i of n)if(e===i)return!0;return!1}getId(e,n){let i=e.id;if(this.promoteId){const s=typeof this.promoteId=="string"?this.promoteId:this.promoteId[n];s!=null&&(i=e.properties[s]),typeof i=="boolean"&&(i=Number(i))}return i}}function Z3(t,e,n,i,s){return bn(t,(l,u)=>{const h=e instanceof Hd?e.get(u):null;return h&&h.evaluate?h.evaluate(n,i,s):h})}function r6(t,e){return e-t}kt(MS,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});const i6=Kn([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),o6=Kn([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),s6=Kn([{name:"a_projected_pos",components:4,type:"Float32"}],4);Kn([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const a6=Kn([{name:"a_texb",components:2,type:"Uint16"}]),l6=Kn([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),u6=Kn([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"}]);Kn([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const X3=Kn([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),c6=Kn([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);Kn([{name:"triangle",components:3,type:"Uint16"}]),Kn([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),Kn([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint8",name:"hasIconTextFit"}]),Kn([{type:"Float32",name:"offsetX"}]),Kn([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);var Wi=24;const gl=128;function IS(t,e){const{expression:n}=e;if(n.kind==="constant")return{kind:"constant",layoutSize:n.evaluate(new Nr(t+1))};if(n.kind==="source")return{kind:"source"};{const{zoomStops:i,interpolationType:s}=n;let l=0;for(;l<i.length&&i[l]<=t;)l++;l=Math.max(0,l-1);let u=l;for(;u<i.length&&i[u]<t+1;)u++;u=Math.min(i.length-1,u);const h=i[l],f=i[u];return n.kind==="composite"?{kind:"composite",minZoom:h,maxZoom:f,interpolationType:s}:{kind:"camera",minZoom:h,maxZoom:f,minSize:n.evaluate(new Nr(h)),maxSize:n.evaluate(new Nr(f)),interpolationType:s}}}function p_(t,{uSize:e,uSizeT:n},{lowerSize:i,upperSize:s}){return t.kind==="source"?i/gl:t.kind==="composite"?nn(i/gl,s/gl,n):e}function ru(t,e){let n=0,i=0;if(t.kind==="constant")i=t.layoutSize;else if(t.kind!=="source"){const{interpolationType:s,minZoom:l,maxZoom:u}=t,h=s?ce(Zs.interpolationFactor(s,e,l,u),0,1):0;t.kind==="camera"?i=nn(t.minSize,t.maxSize,h):n=h}return{uSizeT:n,uSize:i}}var h6=Object.freeze({__proto__:null,SIZE_PACK_FACTOR:gl,evaluateSizeForFeature:p_,evaluateSizeForZoom:ru,getSizeData:IS});function d6(t,e,n){return t.sections.forEach(i=>{i.text=function(s,l,u){const h=l.layout.get("text-transform").evaluate(u,{});return h==="uppercase"?s=s.toLocaleUpperCase():h==="lowercase"&&(s=s.toLocaleLowerCase()),xo.applyArabicShaping&&(s=xo.applyArabicShaping(s)),s}(i.text,e,n)}),t}const m_={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};function f6(t){return t===""||t===""||t===""||t===""||t===""||t===""||t===""||t===""||t===""||t===""||t===""||t===""||t===""||t===""||t===""||t===""||t===""}function p6(t){return t===""||t===""||t===""||t===""||t===""||t===""||t===""||t===""||t===""||t===""}const kS=3;function m6(t,e,n){e.glyphs=[],t===1&&n.readMessage(g6,e)}function g6(t,e,n){if(t===3){const{id:i,bitmap:s,width:l,height:u,left:h,top:f,advance:m}=n.readMessage(y6,{});e.glyphs.push({id:i,bitmap:new ic({width:l+2*kS,height:u+2*kS},s),metrics:{width:l,height:u,left:h,top:f,advance:m}})}else t===4?e.ascender=n.readSVarint():t===5&&(e.descender=n.readSVarint())}function y6(t,e,n){t===1?e.id=n.readVarint():t===2?e.bitmap=n.readBytes():t===3?e.width=n.readVarint():t===4?e.height=n.readVarint():t===5?e.left=n.readSVarint():t===6?e.top=n.readSVarint():t===7&&(e.advance=n.readVarint())}const K3=kS;function PS(t){let e=0,n=0;for(const u of t)e+=u.w*u.h,n=Math.max(n,u.w);t.sort((u,h)=>h.h-u.h);const i=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(e/.95)),n),h:1/0}];let s=0,l=0;for(const u of t)for(let h=i.length-1;h>=0;h--){const f=i[h];if(!(u.w>f.w||u.h>f.h)){if(u.x=f.x,u.y=f.y,l=Math.max(l,u.y+u.h),s=Math.max(s,u.x+u.w),u.w===f.w&&u.h===f.h){const m=i.pop();h<i.length&&(i[h]=m)}else u.h===f.h?(f.x+=u.w,f.w-=u.w):u.w===f.w?(f.y+=u.h,f.h-=u.h):(i.push({x:f.x+u.w,y:f.y,w:f.w-u.w,h:u.h}),f.y+=u.h,f.h-=u.h);break}}return{w:s,h:l,fill:e/(s*l)||0}}const _s=1;class RS{constructor(e,{pixelRatio:n,version:i,stretchX:s,stretchY:l,content:u}){this.paddedRect=e,this.pixelRatio=n,this.stretchX=s,this.stretchY=l,this.content=u,this.version=i}get tl(){return[this.paddedRect.x+_s,this.paddedRect.y+_s]}get br(){return[this.paddedRect.x+this.paddedRect.w-_s,this.paddedRect.y+this.paddedRect.h-_s]}get displaySize(){return[(this.paddedRect.w-2*_s)/this.pixelRatio,(this.paddedRect.h-2*_s)/this.pixelRatio]}}class Y3{constructor(e,n){const i={},s={};this.haveRenderCallbacks=[];const l=[];this.addImages(e,i,l),this.addImages(n,s,l);const{w:u,h}=PS(l),f=new ui({width:u||1,height:h||1});for(const m in e){const y=e[m],v=i[m].paddedRect;ui.copy(y.data,f,{x:0,y:0},{x:v.x+_s,y:v.y+_s},y.data)}for(const m in n){const y=n[m],v=s[m].paddedRect,w=v.x+_s,S=v.y+_s,E=y.data.width,A=y.data.height;ui.copy(y.data,f,{x:0,y:0},{x:w,y:S},y.data),ui.copy(y.data,f,{x:0,y:A-1},{x:w,y:S-1},{width:E,height:1}),ui.copy(y.data,f,{x:0,y:0},{x:w,y:S+A},{width:E,height:1}),ui.copy(y.data,f,{x:E-1,y:0},{x:w-1,y:S},{width:1,height:A}),ui.copy(y.data,f,{x:0,y:0},{x:w+E,y:S},{width:1,height:A})}this.image=f,this.iconPositions=i,this.patternPositions=s}addImages(e,n,i){for(const s in e){const l=e[s],u={x:0,y:0,w:l.data.width+2*_s,h:l.data.height+2*_s};i.push(u),n[s]=new RS(u,l),l.hasRenderCallback&&this.haveRenderCallbacks.push(s)}}patchUpdatedImages(e,n,i){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(s=>e.hasImage(s,i)),e.dispatchRenderCallbacks(this.haveRenderCallbacks,i);for(const s in e.getUpdatedImages(i))this.patchUpdatedImage(this.iconPositions[s],e.getImage(s,i),n),this.patchUpdatedImage(this.patternPositions[s],e.getImage(s,i),n)}patchUpdatedImage(e,n,i){if(!e||!n||e.version===n.version)return;e.version=n.version;const[s,l]=e.tl;i.update(n.data,void 0,{x:s,y:l})}}kt(RS,"ImagePosition"),kt(Y3,"ImageAtlas");const Gr={horizontal:1,vertical:2,horizontalOnly:3},Q3=-17;class g_{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(e,n){const i=new g_;return i.scale=e||1,i.fontStack=n,i}static forImage(e){const n=new g_;return n.imageName=e,n}}class Em{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(e,n){const i=new Em;for(let s=0;s<e.sections.length;s++){const l=e.sections[s];l.image?i.addImageSection(l):i.addTextSection(l,n)}return i}length(){return this.text.length}getSection(e){return this.sections[this.sectionIndex[e]]}getSections(){return this.sections}getSectionIndex(e){return this.sectionIndex[e]}getCodePoint(e){return this.text.codePointAt(e)}verticalizePunctuation(e){this.text=function(n,i){let s="";for(let l=0;l<n.length;l++){const u=n.charCodeAt(l+1)||null,h=n.charCodeAt(l-1)||null;s+=!i&&(u&&Pp(u)&&!m_[n[l+1]]||h&&Pp(h)&&!m_[n[l-1]])||!m_[n[l]]?n[l]:m_[n[l]]}return s}(this.text,e)}trim(){let e=0;for(let i=0;i<this.text.length&&$1[this.text.charCodeAt(i)];i++)e++;let n=this.text.length;for(let i=this.text.length-1;i>=0&&i>=e&&$1[this.text.charCodeAt(i)];i--)n--;this.text=this.text.substring(e,n),this.sectionIndex=this.sectionIndex.slice(e,n)}substring(e,n){const i=new Em;return i.text=this.text.substring(e,n),i.sectionIndex=this.sectionIndex.slice(e,n),i.sections=this.sections,i}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((e,n)=>Math.max(e,this.sections[n].scale),0)}addTextSection(e,n){this.text+=e.text,this.sections.push(g_.forText(e.scale,e.fontStack||n));const i=this.sections.length-1;for(let s=0;s<e.text.length;++s)this.sectionIndex.push(i)}addImageSection(e){const n=e.image?e.image.namePrimary:"";if(n.length===0)return void ye("Can't add FormattedSection with an empty image.");const i=this.getNextImageSectionCharCode();i?(this.text+=String.fromCodePoint(i),this.sections.push(g_.forImage(n)),this.sectionIndex.push(this.sections.length-1)):ye("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function DS(t,e,n,i,s,l,u,h,f,m,y,v,w,S,E){const A=Em.fromFeature(t,s);v===Gr.vertical&&A.verticalizePunctuation(w);let M=[];const k=function(j,V,Y,ne,re,J){if(!j)return[];const ae=[],le=function(Pe,pe,Ae,Le,qe,Ve){let yt=0;for(let mt=0;mt<Pe.length();mt++){const lt=Pe.getSection(mt);yt+=J3(Pe.getCodePoint(mt),lt,Le,qe,pe,Ve)}return yt/Math.max(1,Math.ceil(yt/Ae))}(j,V,Y,ne,re,J),oe=j.text.indexOf("")>=0;let Ee=0;for(let Pe=0;Pe<j.length();Pe++){const pe=j.getSection(Pe),Ae=j.getCodePoint(Pe);if($1[Ae]||(Ee+=J3(Ae,pe,ne,re,V,J)),Pe<j.length()-1){const Le=!((xe=Ae)<11904||!(Ft["Bopomofo Extended"](xe)||Ft.Bopomofo(xe)||Ft["CJK Compatibility Forms"](xe)||Ft["CJK Compatibility Ideographs"](xe)||Ft["CJK Compatibility"](xe)||Ft["CJK Radicals Supplement"](xe)||Ft["CJK Strokes"](xe)||Ft["CJK Symbols and Punctuation"](xe)||Ft["CJK Unified Ideographs Extension A"](xe)||Ft["CJK Unified Ideographs"](xe)||Ft["Enclosed CJK Letters and Months"](xe)||Ft["Halfwidth and Fullwidth Forms"](xe)||Ft.Hiragana(xe)||Ft["Ideographic Description Characters"](xe)||Ft["Kangxi Radicals"](xe)||Ft["Katakana Phonetic Extensions"](xe)||Ft.Katakana(xe)||Ft["Vertical Forms"](xe)||Ft["Yi Radicals"](xe)||Ft["Yi Syllables"](xe)));(_6[Ae]||Le||pe.imageName)&&ae.push(tI(Pe+1,Ee,le,ae,v6(Ae,j.getCodePoint(Pe+1),Le&&oe),!1))}}var xe;return nI(tI(j.length(),Ee,le,ae,0,!0))}(A,m,l,e,i,S),{processBidirectionalText:R,processStyledBidirectionalText:L}=xo;if(R&&A.sections.length===1){const j=R(A.toString(),k);for(const V of j){const Y=new Em;Y.text=V,Y.sections=A.sections;for(let ne=0;ne<V.length;ne++)Y.sectionIndex.push(0);M.push(Y)}}else if(L){const j=L(A.text,A.sectionIndex,k);for(const V of j){const Y=new Em;Y.text=V[0],Y.sectionIndex=V[1],Y.sections=A.sections,M.push(Y)}}else M=function(j,V){const Y=[],ne=j.text;let re=0;for(const J of V)Y.push(j.substring(re,J)),re=J;return re<ne.length&&Y.push(j.substring(re,ne.length)),Y}(A,k);const z=[],B={positionedLines:z,text:A.toString(),top:y[1],bottom:y[1],left:y[0],right:y[0],writingMode:v,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(j,V,Y,ne,re,J,ae,le,oe,Ee,xe,Pe){let pe=0,Ae=0,Le=0;const qe=le==="right"?1:le==="left"?0:.5;let Ve=!1;for(const Zt of re){const Gt=Zt.getSections();for(const Ut of Gt){if(Ut.imageName)continue;const Xt=V[Ut.fontStack];if(Xt&&(Ve=Xt.ascender!==void 0&&Xt.descender!==void 0,!Ve))break}if(!Ve)break}let yt=0;for(const Zt of re){Zt.trim();const Gt=Zt.getMaxScale(),Ut=(Gt-1)*Wi,Xt={positionedGlyphs:[],lineOffset:0};j.positionedLines[yt]=Xt;const zn=Xt.positionedGlyphs;let Pn=0;if(!Zt.length()){Ae+=J,++yt;continue}let or=0,Rn=0;for(let an=0;an<Zt.length();an++){const An=Zt.getSection(an),sr=Zt.getSectionIndex(an),Mn=Zt.getCodePoint(an);let cr=An.scale,fi=null,pi=null,Zr=null,zr=Wi,Mi=0;const qr=!(oe===Gr.horizontal||!xe&&!Vd(Mn)||xe&&($1[Mn]||(mt=Mn,Ft.Arabic(mt)||Ft["Arabic Supplement"](mt)||Ft["Arabic Extended-A"](mt)||Ft["Arabic Presentation Forms-A"](mt)||Ft["Arabic Presentation Forms-B"](mt))));if(An.imageName){const Di=ne[An.imageName];if(!Di)continue;Zr=An.imageName,j.iconsInText=j.iconsInText||!0,pi=Di.paddedRect;const fr=Di.displaySize;cr=cr*Wi/Pe,fi={width:fr[0],height:fr[1],left:_s,top:-K3,advance:qr?fr[1]:fr[0],localGlyph:!1},Mi=Ve?-fi.height*cr:Q3+Gt*Wi-fr[1]*cr,zr=fi.advance;const vs=(qr?fr[0]:fr[1])*cr-Wi*Gt;vs>0&&vs>Pn&&(Pn=vs)}else{const Di=Y[An.fontStack];if(!Di)continue;Di[Mn]&&(pi=Di[Mn]);const fr=V[An.fontStack];if(!fr)continue;const vs=fr.glyphs[Mn];if(!vs)continue;if(fi=vs.metrics,zr=Mn!==8203?Wi:0,Ve){const Um=fr.ascender!==void 0?Math.abs(fr.ascender):0,uc=fr.descender!==void 0?Math.abs(fr.descender):0,cc=(Um+uc)*cr;or<cc&&(or=cc,Rn=(Um-uc)/2*cr),Mi=-Um*cr}else Mi=Q3+(Gt-cr)*Wi}qr?(j.verticalizable=!0,zn.push({glyph:Mn,imageName:Zr,x:pe,y:Ae+Mi,vertical:qr,scale:cr,localGlyph:fi.localGlyph,fontStack:An.fontStack,sectionIndex:sr,metrics:fi,rect:pi}),pe+=zr*cr+Ee):(zn.push({glyph:Mn,imageName:Zr,x:pe,y:Ae+Mi,vertical:qr,scale:cr,localGlyph:fi.localGlyph,fontStack:An.fontStack,sectionIndex:sr,metrics:fi,rect:pi}),pe+=fi.advance*cr+Ee)}zn.length!==0&&(Le=Math.max(pe-Ee,Le),Ve?rI(zn,qe,Pn,Rn,J*Gt/2):rI(zn,qe,Pn,0,J/2)),pe=0;const Fn=J*Gt+Pn;Xt.lineOffset=Math.max(Pn,Ut),Ae+=Fn,++yt}var mt;const lt=Ae,{horizontalAlign:ft,verticalAlign:Mt}=G1(ae);(function(Zt,Gt,Ut,Xt,zn,Pn){const or=(Gt-Ut)*zn,Rn=-Pn*Xt;for(const Fn of Zt)for(const an of Fn.positionedGlyphs)an.x+=or,an.y+=Rn})(j.positionedLines,qe,ft,Mt,Le,lt),j.top+=-Mt*lt,j.bottom=j.top+lt,j.left+=-ft*Le,j.right=j.left+Le,j.hasBaseline=Ve}(B,e,n,i,M,u,h,f,v,m,w,E),!function(j){for(const V of j)if(V.positionedGlyphs.length!==0)return!1;return!0}(z)&&B}const $1={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},_6={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function J3(t,e,n,i,s,l){if(e.imageName){const u=i[e.imageName];return u?u.displaySize[0]*e.scale*Wi/l+s:0}{const u=n[e.fontStack],h=u&&u.glyphs[t];return h?h.metrics.advance*e.scale+s:0}}function eI(t,e,n,i){const s=Math.pow(t-e,2);return i?t<e?s/2:2*s:s+Math.abs(n)*n}function v6(t,e,n){let i=0;return t===10&&(i-=1e4),n&&(i+=150),t!==40&&t!==65288||(i+=50),e!==41&&e!==65289||(i+=50),i}function tI(t,e,n,i,s,l){let u=null,h=eI(e,n,s,l);for(const f of i){const m=eI(e-f.x,n,s,l)+f.badness;m<=h&&(u=f,h=m)}return{index:t,x:e,priorBreak:u,badness:h}}function nI(t){return t?nI(t.priorBreak).concat(t.index):[]}function G1(t){let e=.5,n=.5;switch(t){case"right":case"top-right":case"bottom-right":e=1;break;case"left":case"top-left":case"bottom-left":e=0}switch(t){case"bottom":case"bottom-right":case"bottom-left":n=1;break;case"top":case"top-right":case"top-left":n=0}return{horizontalAlign:e,verticalAlign:n}}function rI(t,e,n,i,s){if(!(e||n||i||s))return;const l=t.length-1,u=t[l],h=(u.x+u.metrics.advance*u.scale)*e;for(let f=0;f<=l;f++)t[f].x-=h,t[f].y+=n+i+s}function x6(t,e,n,i){const{horizontalAlign:s,verticalAlign:l}=G1(i),u=n[0]-t.displaySize[0]*s,h=n[1]-t.displaySize[1]*l;return{imagePrimary:t,imageSecondary:e,top:h,bottom:h+t.displaySize[1],left:u,right:u+t.displaySize[0]}}function iI(t,e,n,i,s,l){const u=t.imagePrimary;let h;if(u.content){const M=u.content,k=u.pixelRatio||1;h=[M[0]/k,M[1]/k,u.displaySize[0]-M[2]/k,u.displaySize[1]-M[3]/k]}const f=e.left*l,m=e.right*l;let y,v,w,S;n==="width"||n==="both"?(S=s[0]+f-i[3],v=s[0]+m+i[1]):(S=s[0]+(f+m-u.displaySize[0])/2,v=S+u.displaySize[0]);const E=e.top*l,A=e.bottom*l;return n==="height"||n==="both"?(y=s[1]+E-i[0],w=s[1]+A+i[2]):(y=s[1]+(E+A-u.displaySize[1])/2,w=y+u.displaySize[1]),{imagePrimary:u,imageSecondary:void 0,top:y,right:v,bottom:w,left:S,collisionPadding:h}}class sc extends q{constructor(e,n,i,s,l){super(e,n),this.angle=s,this.z=i,l!==void 0&&(this.segment=l)}clone(){return new sc(this.x,this.y,this.z,this.angle,this.segment)}}function oI(t,e,n,i,s){if(e.segment===void 0)return!0;let l=e,u=e.segment+1,h=0;for(;h>-n/2;){if(u--,u<0)return!1;h-=t[u].dist(l),l=t[u]}h+=t[u].dist(t[u+1]),u++;const f=[];let m=0;for(;h<n/2;){const y=t[u],v=t[u+1];if(!v)return!1;let w=t[u-1].angleTo(y)-y.angleTo(v);for(w=Math.abs((w+3*Math.PI)%(2*Math.PI)-Math.PI),f.push({distance:h,angleDelta:w}),m+=w;h-f[0].distance>i;)m-=f.shift().angleDelta;if(m>s)return!1;u++,h+=y.dist(v)}return!0}function sI(t){let e=0;for(let n=0;n<t.length-1;n++)e+=t[n].dist(t[n+1]);return e}function aI(t,e,n){return t?.6*e*n:0}function lI(t,e){return Math.max(t?t.right-t.left:0,e?e.right-e.left:0)}function w6(t,e,n,i,s,l){const u=aI(n,s,l),h=lI(n,i)*l;let f=0;const m=sI(t)/2;for(let y=0;y<t.length-1;y++){const v=t[y],w=t[y+1],S=v.dist(w);if(f+S>m){const E=(m-f)/S,A=nn(v.x,w.x,E),M=nn(v.y,w.y,E),k=new sc(A,M,0,w.angleTo(v),y);return!u||oI(t,k,h,u,e)?k:void 0}f+=S}}function b6(t,e,n,i,s,l,u,h,f){const m=aI(i,l,u),y=lI(i,s),v=y*u,w=t[0].x===0||t[0].x===f||t[0].y===0||t[0].y===f;return e-v<e/4&&(e=v+e/4),uI(t,w?e/2*h%e:(y/2+2*l)*u*h%e,e,m,n,v,w,!1,f)}function uI(t,e,n,i,s,l,u,h,f){const m=l/2,y=sI(t);let v=0,w=e-n,S=[];for(let E=0;E<t.length-1;E++){const A=t[E],M=t[E+1],k=A.dist(M),R=M.angleTo(A);for(;w+n<v+k;){w+=n;const L=(w-v)/k,z=nn(A.x,M.x,L),B=nn(A.y,M.y,L);if(z>=0&&z<f&&B>=0&&B<f&&w-m>=0&&w+m<=y){const j=new sc(z,B,0,R,E);j._round(),i&&!oI(t,j,l,i,s)||S.push(j)}}v+=k}return h||S.length||u||(S=uI(t,v/2,n,i,s,l,u,!0,f)),S}function cI(t,e,n,i,s){const l=[];for(let u=0;u<t.length;u++){const h=t[u];let f;for(let m=0;m<h.length-1;m++){let y=h[m],v=h[m+1];y.x<e&&v.x<e||(y.x<e?y=new q(e,y.y+(e-y.x)/(v.x-y.x)*(v.y-y.y))._round():v.x<e&&(v=new q(e,y.y+(e-y.x)/(v.x-y.x)*(v.y-y.y))._round()),y.y<n&&v.y<n||(y.y<n?y=new q(y.x+(n-y.y)/(v.y-y.y)*(v.x-y.x),n)._round():v.y<n&&(v=new q(y.x+(n-y.y)/(v.y-y.y)*(v.x-y.x),n)._round()),y.x>=i&&v.x>=i||(y.x>=i?y=new q(i,y.y+(i-y.x)/(v.x-y.x)*(v.y-y.y))._round():v.x>=i&&(v=new q(i,y.y+(i-y.x)/(v.x-y.x)*(v.y-y.y))._round()),y.y>=s&&v.y>=s||(y.y>=s?y=new q(y.x+(s-y.y)/(v.y-y.y)*(v.x-y.x),s)._round():v.y>=s&&(v=new q(y.x+(s-y.y)/(v.y-y.y)*(v.x-y.x),s)._round()),f&&y.equals(f[f.length-1])||(f=[y],l.push(f)),f.push(v)))))}}return l}kt(sc,"Anchor");const y_=1e20;function hI(t,e,n,i,s,l,u,h,f){for(let m=e;m<e+i;m++)dI(t,n*l+m,l,s,u,h,f);for(let m=n;m<n+s;m++)dI(t,m*l+e,1,i,u,h,f)}function dI(t,e,n,i,s,l,u){l[0]=0,u[0]=-y_,u[1]=y_,s[0]=t[e];for(let h=1,f=0,m=0;h<i;h++){s[h]=t[e+h*n];const y=h*h;do{const v=l[f];m=(s[h]-s[v]+y-v*v)/(h-v)/2}while(m<=u[f]&&--f>-1);f++,l[f]=h,u[f]=m,u[f+1]=y_}for(let h=0,f=0;h<i;h++){for(;u[f+1]<h;)f++;const m=l[f],y=h-m;t[e+h*n]=s[m]+y*y}}const yl=2;class Tm{constructor(e,n,i){this.requestManager=e,this.localGlyphMode=n,this.localFontFamily=i,this.urls={},this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(e,n){this.urls[n]=e}getGlyphs(e,n,i){const s=[],l=this.urls[n];if(l){for(const u in e)for(const h of e[u])s.push({stack:u,id:h});$e(s,({stack:u,id:h},f)=>{let m=this.entries[u];m||(m=this.entries[u]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let y=m.glyphs[h];if(y!==void 0)return void f(null,{stack:u,id:h,glyph:y});if(y=this._tinySDF(m,u,h),y)return m.glyphs[h]=y,void f(null,{stack:u,id:h,glyph:y});const v=Math.floor(h/256);if(256*v>65535)return void f(new Error("glyphs > 65535 not supported"));if(m.ranges[v])return void f(null,{stack:u,id:h,glyph:y});let w=m.requests[v];w||(w=m.requests[v]=[],Tm.loadGlyphRange(u,v,l,this.requestManager,(S,E)=>{if(E){m.ascender=E.ascender,m.descender=E.descender;for(const A in E.glyphs)this._doesCharSupportLocalGlyph(+A)||(m.glyphs[+A]=E.glyphs[+A]);m.ranges[v]=!0}for(const A of w)A(S,E);delete m.requests[v]})),w.push((S,E)=>{S?f(S):E&&f(null,{stack:u,id:h,glyph:E.glyphs[h]||null})})},(u,h)=>{if(u)i(u);else if(h){const f={};for(const{stack:m,id:y,glyph:v}of h)f[m]===void 0&&(f[m]={}),f[m].glyphs===void 0&&(f[m].glyphs={}),f[m].glyphs[y]=v&&{id:v.id,bitmap:v.bitmap.clone(),metrics:v.metrics},f[m].ascender=this.entries[m].ascender,f[m].descender=this.entries[m].descender;i(null,f)}})}else i(new Error("Missing glyph URL"))}_doesCharSupportLocalGlyph(e){return this.localGlyphMode!==0&&(this.localGlyphMode===2?!!this.localFontFamily:!!this.localFontFamily&&(Ft["CJK Unified Ideographs"](e)||Ft["Hangul Syllables"](e)||Ft.Hiragana(e)||Ft.Katakana(e)||Ft["CJK Symbols and Punctuation"](e)||Ft["CJK Unified Ideographs Extension A"](e)||Ft["CJK Unified Ideographs Extension B"](e)))}_tinySDF(e,n,i){const s=this.localFontFamily;if(!s||!this._doesCharSupportLocalGlyph(i))return;let l=e.tinySDF;if(!l){let A="400";/bold/i.test(n)?A="900":/medium/i.test(n)?A="500":/light/i.test(n)&&(A="200"),l=e.tinySDF=new Tm.TinySDF({fontFamily:s,fontWeight:A,fontSize:24*yl,buffer:3*yl,radius:8*yl}),l.fontWeight=A}if(this.localGlyphs[l.fontWeight][i])return this.localGlyphs[l.fontWeight][i];const u=String.fromCodePoint(i),{data:h,width:f,height:m,glyphWidth:y,glyphHeight:v,glyphLeft:w,glyphTop:S,glyphAdvance:E}=l.draw(u);return this.localGlyphs[l.fontWeight][i]={id:i,bitmap:new ic({width:f,height:m},h),metrics:{width:y/yl,height:v/yl,left:w/yl,top:S/yl-27,advance:E/yl,localGlyph:!0}}}}Tm.loadGlyphRange=function(t,e,n,i,s){const l=256*e,u=l+255,h=i.transformRequest(i.normalizeGlyphsURL(n).replace("{fontstack}",t).replace("{range}",`${l}-${u}`),Ie.Glyphs);at(h,(f,m)=>{if(f)s(f);else if(m){const y={},v=function(w){return new V1(w).readFields(m6,{})}(m);for(const w of v.glyphs)y[w.id]=w;s(null,{glyphs:y,ascender:v.ascender,descender:v.descender})}})},Tm.TinySDF=class{constructor({fontSize:t=24,buffer:e=3,radius:n=8,cutoff:i=.25,fontFamily:s="sans-serif",fontWeight:l="normal",fontStyle:u="normal"}={}){this.buffer=e,this.cutoff=i,this.radius=n;const h=this.size=t+4*e,f=this._createCanvas(h),m=this.ctx=f.getContext("2d",{willReadFrequently:!0});m.font=`${u} ${l} ${t}px ${s}`,m.textBaseline="alphabetic",m.textAlign="left",m.fillStyle="black",this.gridOuter=new Float64Array(h*h),this.gridInner=new Float64Array(h*h),this.f=new Float64Array(h),this.z=new Float64Array(h+1),this.v=new Uint16Array(h)}_createCanvas(t){const e=document.createElement("canvas");return e.width=e.height=t,e}draw(t){const{width:e,actualBoundingBoxAscent:n,actualBoundingBoxDescent:i,actualBoundingBoxLeft:s,actualBoundingBoxRight:l}=this.ctx.measureText(t),u=Math.ceil(n),h=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(l-s))),f=Math.min(this.size-this.buffer,u+Math.ceil(i)),m=h+2*this.buffer,y=f+2*this.buffer,v=Math.max(m*y,0),w=new Uint8ClampedArray(v),S={data:w,width:m,height:y,glyphWidth:h,glyphHeight:f,glyphTop:u,glyphLeft:0,glyphAdvance:e};if(h===0||f===0)return S;const{ctx:E,buffer:A,gridInner:M,gridOuter:k}=this;E.clearRect(A,A,h,f),E.fillText(t,A,A+u);const R=E.getImageData(A,A,h,f);k.fill(y_,0,v),M.fill(0,0,v);for(let L=0;L<f;L++)for(let z=0;z<h;z++){const B=R.data[4*(L*h+z)+3]/255;if(B===0)continue;const j=(L+A)*m+z+A;if(B===1)k[j]=0,M[j]=y_;else{const V=.5-B;k[j]=V>0?V*V:0,M[j]=V<0?V*V:0}}hI(k,0,0,m,y,m,this.f,this.v,this.z),hI(M,A,A,h,f,m,this.f,this.v,this.z);for(let L=0;L<v;L++){const z=Math.sqrt(k[L])-Math.sqrt(M[L]);w[L]=Math.round(255-255*(z/this.radius+this.cutoff))}return S}};const _h=_s;function fI(t,e,n,i){const s=[],l=t.imagePrimary,u=l.pixelRatio,h=l.paddedRect.w-2*_h,f=l.paddedRect.h-2*_h,m=t.right-t.left,y=t.bottom-t.top,v=l.stretchX||[[0,h]],w=l.stretchY||[[0,f]],S=(J,ae)=>J+ae[1]-ae[0],E=v.reduce(S,0),A=w.reduce(S,0),M=h-E,k=f-A;let R=0,L=E,z=0,B=A,j=0,V=M,Y=0,ne=k;if(l.content&&i){const J=l.content;R=H1(v,0,J[0]),z=H1(w,0,J[1]),L=H1(v,J[0],J[2]),B=H1(w,J[1],J[3]),j=J[0]-R,Y=J[1]-z,V=J[2]-J[0]-L,ne=J[3]-J[1]-B}const re=(J,ae,le,oe)=>{const Ee=q1(J.stretch-R,L,m,t.left),xe=W1(J.fixed-j,V,J.stretch,E),Pe=q1(ae.stretch-z,B,y,t.top),pe=W1(ae.fixed-Y,ne,ae.stretch,A),Ae=q1(le.stretch-R,L,m,t.left),Le=W1(le.fixed-j,V,le.stretch,E),qe=q1(oe.stretch-z,B,y,t.top),Ve=W1(oe.fixed-Y,ne,oe.stretch,A),yt=new q(Ee,Pe),mt=new q(Ae,Pe),lt=new q(Ae,qe),ft=new q(Ee,qe),Mt=new q(xe/u,pe/u),Zt=new q(Le/u,Ve/u),Gt=e*Math.PI/180;if(Gt){const Rn=Math.sin(Gt),Fn=Math.cos(Gt),an=[Fn,-Rn,Rn,Fn];yt._matMult(an),mt._matMult(an),ft._matMult(an),lt._matMult(an)}const Ut=J.stretch+J.fixed,Xt=le.stretch+le.fixed,zn=ae.stretch+ae.fixed,Pn=oe.stretch+oe.fixed,or=t.imageSecondary;return{tl:yt,tr:mt,bl:ft,br:lt,texPrimary:{x:l.paddedRect.x+_h+Ut,y:l.paddedRect.y+_h+zn,w:Xt-Ut,h:Pn-zn},texSecondary:or?{x:or.paddedRect.x+_h+Ut,y:or.paddedRect.y+_h+zn,w:Xt-Ut,h:Pn-zn}:void 0,writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Mt,pixelOffsetBR:Zt,minFontScaleX:V/u/m,minFontScaleY:ne/u/y,isSDF:n}};if(i&&(l.stretchX||l.stretchY)){const J=pI(v,M,E),ae=pI(w,k,A);for(let le=0;le<J.length-1;le++){const oe=J[le],Ee=J[le+1];for(let xe=0;xe<ae.length-1;xe++)s.push(re(oe,ae[xe],Ee,ae[xe+1]))}}else s.push(re({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:h+1},{fixed:0,stretch:f+1}));return s}function H1(t,e,n){let i=0;for(const s of t)i+=Math.max(e,Math.min(n,s[1]))-Math.max(e,Math.min(n,s[0]));return i}function pI(t,e,n){const i=[{fixed:-_h,stretch:0}];for(const[s,l]of t){const u=i[i.length-1];i.push({fixed:s-u.stretch,stretch:u.stretch}),i.push({fixed:s-u.stretch,stretch:u.stretch+(l-s)})}return i.push({fixed:e+_h,stretch:n}),i}function q1(t,e,n,i){return t/e*n+i}function W1(t,e,n,i){return t-e*n/i}function S6(t,e,n,i){const s=e+t.positionedLines[i].lineOffset;return i===0?n+s/2:n+(s+(e+t.positionedLines[i-1].lineOffset))/2}function E6(t,e=1,n=!1){let i=1/0,s=1/0,l=-1/0,u=-1/0;const h=t[0];for(let S=0;S<h.length;S++){const E=h[S];(!S||E.x<i)&&(i=E.x),(!S||E.y<s)&&(s=E.y),(!S||E.x>l)&&(l=E.x),(!S||E.y>u)&&(u=E.y)}const f=Math.min(l-i,u-s);let m=f/2;const y=new ep([],T6);if(f===0)return new q(i,s);for(let S=i;S<l;S+=f)for(let E=s;E<u;E+=f)y.push(new Cm(S+m,E+m,m,t));let v=function(S){let E=0,A=0,M=0;const k=S[0];for(let R=0,L=k.length,z=L-1;R<L;z=R++){const B=k[R],j=k[z],V=B.x*j.y-j.x*B.y;A+=(B.x+j.x)*V,M+=(B.y+j.y)*V,E+=3*V}return new Cm(A/E,M/E,0,S)}(t),w=y.length;for(;y.length;){const S=y.pop();(S.d>v.d||!v.d)&&(v=S,n&&console.log("found best %d after %d probes",Math.round(1e4*S.d)/1e4,w)),S.max-v.d<=e||(m=S.h/2,y.push(new Cm(S.p.x-m,S.p.y-m,m,t)),y.push(new Cm(S.p.x+m,S.p.y-m,m,t)),y.push(new Cm(S.p.x-m,S.p.y+m,m,t)),y.push(new Cm(S.p.x+m,S.p.y+m,m,t)),w+=4)}return n&&(console.log(`num probes: ${w}`),console.log(`best distance: ${v.d}`)),v.p}function T6(t,e){return e.max-t.max}class Cm{constructor(e,n,i,s){this.p=new q(e,n),this.h=i,this.d=function(l,u){let h=!1,f=1/0;for(let m=0;m<u.length;m++){const y=u[m];for(let v=0,w=y.length,S=w-1;v<w;S=v++){const E=y[v],A=y[S];E.y>l.y!=A.y>l.y&&l.x<(A.x-E.x)*(l.y-E.y)/(A.y-E.y)+E.x&&(h=!h),f=Math.min(f,g3(l,E,A))}}return(h?1:-1)*Math.sqrt(f)}(this.p,s),this.max=this.d+this.h*Math.SQRT2}}const Am=7,LS=Number.POSITIVE_INFINITY,C6=Math.sqrt(2);function OS(t,[e,n]){let i=0,s=0;if(n===LS){e<0&&(e=0);const l=e/C6;switch(t){case"top-right":case"top-left":s=l-Am;break;case"bottom-right":case"bottom-left":s=-l+Am;break;case"bottom":s=-e+Am;break;case"top":s=e-Am}switch(t){case"top-right":case"bottom-right":i=-l;break;case"top-left":case"bottom-left":i=l;break;case"left":i=e;break;case"right":i=-e}}else{switch(e=Math.abs(e),n=Math.abs(n),t){case"top-right":case"top-left":case"top":s=n-Am;break;case"bottom-right":case"bottom-left":case"bottom":s=-n+Am}switch(t){case"top-right":case"bottom-right":case"right":i=-e;break;case"top-left":case"bottom-left":case"left":i=e}}return[i,s]}function A6(t,e,n,i,s,l,u,h,f,m,y){t.createArrays(),t.tilePixelRatio=Ge/(512*t.overscaling),t.compareText={},t.iconsNeedLinear=!1;const v=t.layers[0].layout,w=t.layers[0]._unevaluatedLayout._values,S={};if(t.textSizeData.kind==="composite"){const{minZoom:k,maxZoom:R}=t.textSizeData;S.compositeTextSizes=[w["text-size"].possiblyEvaluate(new Nr(k),h),w["text-size"].possiblyEvaluate(new Nr(R),h)]}if(t.iconSizeData.kind==="composite"){const{minZoom:k,maxZoom:R}=t.iconSizeData;S.compositeIconSizes=[w["icon-size"].possiblyEvaluate(new Nr(k),h),w["icon-size"].possiblyEvaluate(new Nr(R),h)]}S.layoutTextSize=w["text-size"].possiblyEvaluate(new Nr(f+1),h),S.layoutIconSize=w["icon-size"].possiblyEvaluate(new Nr(f+1),h),S.textMaxSize=w["text-size"].possiblyEvaluate(new Nr(18),h);const E=v.get("text-rotation-alignment")==="map"&&v.get("symbol-placement")!=="point",A=v.get("text-size");let M=!1;for(const k of t.features)if(k.icon&&k.icon.nameSecondary){M=!0;break}for(const k of t.features){const R=v.get("text-font").evaluate(k,{},h).join(","),L=A.evaluate(k,{},h),z=S.layoutTextSize.evaluate(k,{},h),B=(S.layoutIconSize.evaluate(k,{},h),{horizontal:{},vertical:void 0}),j=k.text;let V,Y=[0,0];if(j){const J=j.toString(),ae=v.get("text-letter-spacing").evaluate(k,{},h)*Wi,le=v.get("text-line-height").evaluate(k,{},h)*Wi,oe=X2(J)?ae:0,Ee=v.get("text-anchor").evaluate(k,{},h),xe=v.get("text-variable-anchor");if(!xe){const qe=v.get("text-radial-offset").evaluate(k,{},h);Y=qe?OS(Ee,[qe*Wi,LS]):v.get("text-offset").evaluate(k,{},h).map(Ve=>Ve*Wi)}let Pe=E?"center":v.get("text-justify").evaluate(k,{},h);const pe=v.get("symbol-placement")==="point",Ae=pe?v.get("text-max-width").evaluate(k,{},h)*Wi:1/0,Le=qe=>{t.allowVerticalPlacement&&Hu(J)&&(B.vertical=DS(j,e,n,s,R,Ae,le,Ee,qe,oe,Y,Gr.vertical,!0,z,L))};if(!E&&xe){const qe=Pe==="auto"?xe.map(yt=>zS(yt)):[Pe];let Ve=!1;for(let yt=0;yt<qe.length;yt++){const mt=qe[yt];if(!B.horizontal[mt])if(Ve)B.horizontal[mt]=B.horizontal[0];else{const lt=DS(j,e,n,s,R,Ae,le,"center",mt,oe,Y,Gr.horizontal,!1,z,L);lt&&(B.horizontal[mt]=lt,Ve=lt.positionedLines.length===1)}}Le("left")}else{if(Pe==="auto"&&(Pe=zS(Ee)),pe||v.get("text-writing-mode").indexOf("horizontal")>=0||!Hu(J)){const qe=DS(j,e,n,s,R,Ae,le,Ee,Pe,oe,Y,Gr.horizontal,!1,z,L);qe&&(B.horizontal[Pe]=qe)}Le(pe?"left":Pe)}}let ne=!1;if(k.icon&&k.icon.namePrimary){const J=i[k.icon.namePrimary];J&&(V=x6(s[k.icon.namePrimary],k.icon.nameSecondary?s[k.icon.nameSecondary]:void 0,v.get("icon-offset").evaluate(k,{},h),v.get("icon-anchor").evaluate(k,{},h)),ne=J.sdf,t.sdfIcons===void 0?t.sdfIcons=J.sdf:t.sdfIcons!==J.sdf&&ye("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(J.pixelRatio!==t.pixelRatio||v.get("icon-rotate").constantOr(1)!==0)&&(t.iconsNeedLinear=!0))}const re=gI(B.horizontal)||B.vertical;t.iconsInText||(t.iconsInText=!!re&&re.iconsInText),(re||V)&&M6(t,k,B,V,i,S,z,0,Y,ne,u,h,m,y,M)}l&&t.generateCollisionDebugBuffers(f,t.collisionBoxArray)}function zS(t){switch(t){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function M6(t,e,n,i,s,l,u,h,f,m,y,v,w,S,E){let A=l.textMaxSize.evaluate(e,{},v);A===void 0&&(A=u);const M=t.layers[0].layout,k=M.get("icon-offset").evaluate(e,{},v),R=gI(n.horizontal)||n.vertical,L=w.name==="globe",z=Wi,B=u/z,j=t.tilePixelRatio*A/z,V=(Ee=t.overscaling,t.zoom>18&&Ee>2&&(Ee>>=1),Math.max(Ge/(512*Ee),1)*M.get("symbol-spacing")),Y=M.get("text-padding")*t.tilePixelRatio,ne=M.get("icon-padding")*t.tilePixelRatio,re=Be(M.get("text-max-angle")),J=M.get("text-rotation-alignment")==="map"&&M.get("symbol-placement")!=="point",ae=M.get("icon-rotation-alignment")==="map"&&M.get("symbol-placement")!=="point",le=M.get("symbol-placement"),oe=V/2;var Ee;const xe=M.get("icon-text-fit").evaluate(e,{},v),Pe=M.get("icon-text-fit-padding").evaluate(e,{},v),pe=xe!=="none";let Ae;t.hasAnyIconTextFit===!1&&pe&&(t.hasAnyIconTextFit=!0),i&&pe&&(t.allowVerticalPlacement&&n.vertical&&(Ae=iI(i,n.vertical,xe,Pe,k,B)),R&&(i=iI(i,R,xe,Pe,k,B)));const Le=(qe,Ve,yt)=>{if(Ve.x<0||Ve.x>=Ge||Ve.y<0||Ve.y>=Ge)return;let mt=null;if(L){const{x:lt,y:ft,z:Mt}=w.projectTilePoint(Ve.x,Ve.y,yt);mt={anchor:new sc(lt,ft,Mt,0,void 0),up:w.upVector(yt,Ve.x,Ve.y)}}(function(lt,ft,Mt,Zt,Gt,Ut,Xt,zn,Pn,or,Rn,Fn,an,An,sr,Mn,cr,fi,pi,Zr,zr,Mi,qr,Di,fr,vs,Um){const uc=lt.addToLineVertexArray(ft,Zt);let cc,j_,U_,Lx,gR,yR,_R,vR=0,xR=0,wR=0,bR=0,RE=-1,DE=-1;const au={};let SR=eo("");const mf=Mt?Mt.anchor:ft,LE=Pn.layout.get("icon-text-fit").evaluate(zr,{},fr)!=="none";let OE=0,zE=0;if(Pn._unevaluatedLayout.getValue("text-radial-offset")===void 0?[OE,zE]=Pn.layout.get("text-offset").evaluate(zr,{},fr).map(zs=>zs*Wi):(OE=Pn.layout.get("text-radial-offset").evaluate(zr,{},fr)*Wi,zE=LS),lt.allowVerticalPlacement&&Gt.vertical){const zs=Gt.vertical;if(sr)yR=FS(zs),zn&&(_R=FS(zn));else{const Fs=Pn.layout.get("text-rotate").evaluate(zr,{},fr)+90;U_=Z1(or,mf,ft,Rn,Fn,an,zs,An,Fs,Mn),zn&&(Lx=Z1(or,mf,ft,Rn,Fn,an,zn,fi,Fs))}}if(Ut){const zs=Pn.layout.get("icon-rotate").evaluate(zr,{},fr),Fs=fI(Ut,zs,qr,LE),Vm=zn?fI(zn,zs,qr,LE):void 0;j_=Z1(or,mf,ft,Rn,Fn,an,Ut,fi,zs),vR=4*Fs.length;const ER=lt.iconSizeData;let gf=null;ER.kind==="source"?(gf=[gl*Pn.layout.get("icon-size").evaluate(zr,{},fr)],gf[0]>vh&&ye(`${lt.layerIds[0]}: Value for "icon-size" is >= ${__}. Reduce your "icon-size".`)):ER.kind==="composite"&&(gf=[gl*Mi.compositeIconSizes[0].evaluate(zr,{},fr),gl*Mi.compositeIconSizes[1].evaluate(zr,{},fr)],(gf[0]>vh||gf[1]>vh)&&ye(`${lt.layerIds[0]}: Value for "icon-size" is >= ${__}. Reduce your "icon-size".`)),lt.addSymbols(lt.icon,Fs,gf,Zr,pi,zr,!1,Mt,ft,uc.lineStartIndex,uc.lineLength,-1,Di,fr,vs,Um),RE=lt.icon.placedSymbolArray.length-1,Vm&&(xR=4*Vm.length,lt.addSymbols(lt.icon,Vm,gf,Zr,pi,zr,Gr.vertical,Mt,ft,uc.lineStartIndex,uc.lineLength,-1,Di,fr,vs,Um),DE=lt.icon.placedSymbolArray.length-1)}for(const zs in Gt.horizontal){const Fs=Gt.horizontal[zs];cc||(SR=eo(Fs.text),sr?gR=FS(Fs):cc=Z1(or,mf,ft,Rn,Fn,an,Fs,An,Pn.layout.get("text-rotate").evaluate(zr,{},fr),Mn));const Vm=Fs.positionedLines.length===1;if(wR+=mI(lt,Mt,ft,Fs,Xt,Pn,sr,zr,Mn,uc,Gt.vertical?Gr.horizontal:Gr.horizontalOnly,Vm?Object.keys(Gt.horizontal):[zs],au,RE,Mi,Di,fr,vs),Vm)break}Gt.vertical&&(bR+=mI(lt,Mt,ft,Gt.vertical,Xt,Pn,sr,zr,Mn,uc,Gr.vertical,["vertical"],au,DE,Mi,Di,fr,vs));let Ih=-1;const FE=(zs,Fs)=>zs?Math.max(zs,Fs):Fs;Ih=FE(gR,Ih),Ih=FE(yR,Ih),Ih=FE(_R,Ih);const t7=Ih>-1?1:0;lt.glyphOffsetArray.length>=S_.MAX_GLYPHS&&ye("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),zr.sortKey!==void 0&&lt.addToSortKeyRanges(lt.symbolInstances.length,zr.sortKey),lt.symbolInstances.emplaceBack(mf.x,mf.y,mf.z,ft.x,ft.y,au.right>=0?au.right:-1,au.center>=0?au.center:-1,au.left>=0?au.left:-1,au.vertical>=0?au.vertical:-1,RE,DE,SR,cc!==void 0?cc:lt.collisionBoxArray.length,cc!==void 0?cc+1:lt.collisionBoxArray.length,U_!==void 0?U_:lt.collisionBoxArray.length,U_!==void 0?U_+1:lt.collisionBoxArray.length,j_!==void 0?j_:lt.collisionBoxArray.length,j_!==void 0?j_+1:lt.collisionBoxArray.length,Lx||lt.collisionBoxArray.length,Lx?Lx+1:lt.collisionBoxArray.length,Rn,wR,bR,vR,xR,t7,0,OE,zE,Ih,LE?1:0)})(t,Ve,mt,qe,n,i,s,Ae,t.layers[0],t.collisionBoxArray,e.index,e.sourceLayerIndex,t.index,Y,J,f,0,ne,ae,k,e,l,m,y,v,S,E)};if(le==="line")for(const qe of cI(e.geometry,0,0,Ge,Ge)){const Ve=b6(qe,V,re,n.vertical||R,i,z,j,t.overscaling,Ge);for(const yt of Ve)R&&I6(t,R.text,oe,yt)||Le(qe,yt,v)}else if(le==="line-center"){for(const qe of e.geometry)if(qe.length>1){const Ve=w6(qe,re,n.vertical||R,i,z,j);Ve&&Le(qe,Ve,v)}}else if(e.type==="Polygon")for(const qe of SS(e.geometry,0)){const Ve=E6(qe,16);Le(qe[0],new sc(Ve.x,Ve.y,0,0,void 0),v)}else if(e.type==="LineString")for(const qe of e.geometry)Le(qe,new sc(qe[0].x,qe[0].y,0,0,void 0),v);else if(e.type==="Point")for(const qe of e.geometry)for(const Ve of qe)Le([Ve],new sc(Ve.x,Ve.y,0,0,void 0),v)}const __=255,vh=__*gl;function mI(t,e,n,i,s,l,u,h,f,m,y,v,w,S,E,A,M,k){const R=function(B,j,V,Y,ne,re,J,ae){const le=[];if(j.positionedLines.length===0)return le;const oe=Y.layout.get("text-rotate").evaluate(re,{})*Math.PI/180,Ee=function(Le){const qe=Le[0],Ve=Le[1],yt=qe*Ve;return yt>0?[qe,-Ve]:yt<0?[-qe,Ve]:qe===0?[Ve,qe]:[Ve,-qe]}(V);let xe=Math.abs(j.top-j.bottom);for(const Le of j.positionedLines)xe-=Le.lineOffset;const Pe=j.positionedLines.length,pe=xe/Pe;let Ae=j.top-V[1];for(let Le=0;Le<Pe;++Le){const qe=j.positionedLines[Le];Ae=S6(j,pe,Ae,Le);for(const Ve of qe.positionedGlyphs){if(!Ve.rect)continue;const yt=Ve.rect||{};let mt=K3+1,lt=!0,ft=1,Mt=0;if(Ve.imageName){const Zr=J[Ve.imageName];if(!Zr)continue;if(Zr.sdf){ye("SDF images are not supported in formatted text and will be ignored.");continue}lt=!1,ft=Zr.pixelRatio,mt=_s/ft}const Zt=(ne||ae)&&Ve.vertical,Gt=Ve.metrics.advance*Ve.scale/2,Ut=Ve.metrics,Xt=Ve.rect;if(Xt===null)continue;ae&&j.verticalizable&&(Mt=Ve.imageName?Gt-Ve.metrics.width*Ve.scale/2:0);const zn=ne?[Ve.x+Gt,Ve.y]:[0,0];let Pn=[0,0],or=[0,0],Rn=!1;ne||(Zt?(or=[Ve.x+Gt+Ee[0],Ve.y+Ee[1]-Mt],Rn=!0):Pn=[Ve.x+Gt+V[0],Ve.y+V[1]-Mt]);const Fn=Xt.w*Ve.scale/(ft*(Ve.localGlyph?yl:1)),an=Xt.h*Ve.scale/(ft*(Ve.localGlyph?yl:1));let An,sr,Mn,cr;if(Zt){const Zr=Ve.y-Ae,zr=new q(-Gt,Gt-Zr),Mi=-Math.PI/2,qr=new q(...or);An=new q(-Gt+Pn[0],Pn[1]),An._rotateAround(Mi,zr)._add(qr),An.x+=-Zr+Gt,An.y-=(Ut.left-mt)*Ve.scale;const Di=Ve.imageName?Ut.advance*Ve.scale:Wi*Ve.scale,fr=String.fromCodePoint(Ve.glyph);f6(fr)?An.x+=(1-mt)*Ve.scale:p6(fr)?An.x+=Di-Ut.height*Ve.scale+(-mt-1)*Ve.scale:An.x+=Ve.imageName||Ut.width+2*mt===Xt.w&&Ut.height+2*mt===Xt.h?(Di-an)/2:(Di-(Ut.height+2*mt)*Ve.scale)/2,sr=new q(An.x,An.y-Fn),Mn=new q(An.x+an,An.y),cr=new q(An.x+an,An.y-Fn)}else{const Zr=(Ut.left-mt)*Ve.scale-Gt+Pn[0],zr=(-Ut.top-mt)*Ve.scale+Pn[1],Mi=Zr+Fn,qr=zr+an;An=new q(Zr,zr),sr=new q(Mi,zr),Mn=new q(Zr,qr),cr=new q(Mi,qr)}if(oe){let Zr;Zr=ne?new q(0,0):Rn?new q(Ee[0],Ee[1]):new q(V[0],V[1]),An._rotateAround(oe,Zr),sr._rotateAround(oe,Zr),Mn._rotateAround(oe,Zr),cr._rotateAround(oe,Zr)}const fi=new q(0,0),pi=new q(0,0);le.push({tl:An,tr:sr,bl:Mn,br:cr,texPrimary:yt,texSecondary:void 0,writingMode:j.writingMode,glyphOffset:zn,sectionIndex:Ve.sectionIndex,isSDF:lt,pixelOffsetTL:fi,pixelOffsetBR:pi,minFontScaleX:0,minFontScaleY:0})}}return le}(0,i,f,l,u,h,s,t.allowVerticalPlacement),L=t.textSizeData;let z=null;L.kind==="source"?(z=[gl*l.layout.get("text-size").evaluate(h,{},M)],z[0]>vh&&ye(`${t.layerIds[0]}: Value for "text-size" is >= ${__}. Reduce your "text-size".`)):L.kind==="composite"&&(z=[gl*E.compositeTextSizes[0].evaluate(h,{},M),gl*E.compositeTextSizes[1].evaluate(h,{},M)],(z[0]>vh||z[1]>vh)&&ye(`${t.layerIds[0]}: Value for "text-size" is >= ${__}. Reduce your "text-size".`)),t.addSymbols(t.text,R,z,f,u,h,y,e,n,m.lineStartIndex,m.lineLength,S,A,M,k,!1);for(const B of v)w[B]=t.text.placedSymbolArray.length-1;return 4*R.length}function gI(t){for(const e in t)return t[e];return null}function Z1(t,e,n,i,s,l,u,h,f,m){let y=u.top,v=u.bottom,w=u.left,S=u.right;const E=u.collisionPadding;if(E&&(w-=E[0],y-=E[1],S+=E[2],v+=E[3]),f){const A=new q(w,y),M=new q(S,y),k=new q(w,v),R=new q(S,v),L=Be(f);let z=new q(0,0);m&&(z=new q(m[0],m[1])),A._rotateAround(L,z),M._rotateAround(L,z),k._rotateAround(L,z),R._rotateAround(L,z),w=Math.min(A.x,M.x,k.x,R.x),S=Math.max(A.x,M.x,k.x,R.x),y=Math.min(A.y,M.y,k.y,R.y),v=Math.max(A.y,M.y,k.y,R.y)}return t.emplaceBack(e.x,e.y,e.z,n.x,n.y,w,y,S,v,h,i,s,l),t.length-1}function FS(t){t.collisionPadding&&(t.top-=t.collisionPadding[1],t.bottom+=t.collisionPadding[3]);const e=t.bottom-t.top;return e>0?Math.max(10,e):null}function I6(t,e,n,i){const s=t.compareText;if(e in s){const l=s[e];for(let u=l.length-1;u>=0;u--)if(i.dist(l[u])<n)return!0}else s[e]=[];return s[e].push(i),!1}function yI(t,e){const n=t.fovAboveCenter,i=t.elevation?t.elevation.getMinElevationBelowMSL()*e:0,s=(t._camera.position[2]*t.worldSize-i)/Math.cos(t._pitch),l=Math.sin(n)*s/Math.sin(Math.max(Math.PI/2-t._pitch-n,.01)),u=Math.sin(t._pitch)*l+s;return Math.min(1.01*u,s*(1/t._horizonShift))}function hf(t,e){if(!e.isReprojectedInTileSpace)return{scale:1<<t.z,x:t.x,y:t.y,x2:t.x+1,y2:t.y+1,projection:e};const n=Math.pow(2,-t.z),i=t.x*n,s=(t.x+1)*n,l=t.y*n,u=(t.y+1)*n,h=Ls(i),f=Ls(s),m=Ci(l),y=Ci(u),v=e.project(h,m),w=e.project(f,m),S=e.project(f,y),E=e.project(h,y);let A=Math.min(v.x,w.x,S.x,E.x),M=Math.min(v.y,w.y,S.y,E.y),k=Math.max(v.x,w.x,S.x,E.x),R=Math.max(v.y,w.y,S.y,E.y);const L=n/16;function z(j,V,Y,ne,re,J){const ae=(Y+re)/2,le=(ne+J)/2,oe=e.project(Ls(ae),Ci(le)),Ee=Math.max(0,A-oe.x,M-oe.y,oe.x-k,oe.y-R);A=Math.min(A,oe.x),k=Math.max(k,oe.x),M=Math.min(M,oe.y),R=Math.max(R,oe.y),Ee>L&&(z(j,oe,Y,ne,ae,le),z(oe,V,ae,le,re,J))}z(v,w,i,l,s,l),z(w,S,s,l,s,u),z(S,E,s,u,i,u),z(E,v,i,u,i,l),A-=L,M-=L,k+=L,R+=L;const B=1/Math.max(k-A,R-M);return{scale:B,x:A*B,y:M*B,x2:k*B,y2:R*B,projection:e}}function _I(t,e,n,i,s,l,u,h,f){if(f.name==="globe")return iS(t,e,new rc(n,i,s),!1);const m=hf({z:n,x:i,y:s},f);return new ri([(l+m.x/m.scale)*e,e*(m.y/m.scale),u],[(l+m.x2/m.scale)*e,e*(m.y2/m.scale),h])}function vI(t,{x:e,y:n},i=0){return new q(((e-i)*t.scale-t.x)*Ge,(n*t.scale-t.y)*Ge)}function xI(t,e,n=0){return fe.fromValues(((e.x-n)*t.scale-t.x)*Ge,(e.y*t.scale-t.y)*Ge,c3(e.z,e.y))}const k6=Me.identity(new Float32Array(16));class xh{constructor(e){this.spec=e,this.name=e.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(e,n){return{x:0,y:0,z:0}}unproject(e,n){return new sn(0,0)}projectTilePoint(e,n,i){return{x:e,y:n,z:0}}locationPoint(e,n,i=!0){return e._coordinatePoint(e.locationCoordinate(n),i)}pixelsPerMeter(e,n){return mr(1,e)*n}pixelSpaceConversion(e,n,i){return 1}farthestPixelDistance(e){return yI(e,e.pixelsPerMeter)}pointCoordinate(e,n,i,s){const l=e.horizonLineFromTop(!1),u=new q(n,Math.max(l,i));return e.rayIntersectionCoordinate(e.pointRayIntersection(u,s))}pointCoordinate3D(e,n,i){const s=new q(n,i);if(e.elevation)return e.elevation.pointCoordinate(s);{const l=this.pointCoordinate(e,s.x,s.y,0);return[l.x,l.y,l.z]}}isPointAboveHorizon(e,n){if(e.elevation)return!this.pointCoordinate3D(e,n.x,n.y);const i=e.horizonLineFromTop();return n.y<i}createInversionMatrix(e,n){return k6}createTileMatrix(e,n,i){let s,l,u;const h=i.canonical,f=Me.identity(new Float64Array(16));if(this.isReprojectedInTileSpace){const m=hf(h,this);s=1,l=m.x+i.wrap*m.scale,u=m.y,Me.scale(f,f,[s/m.scale,s/m.scale,e.pixelsPerMeter/n])}else s=n/e.zoomScale(h.z),l=(h.x+Math.pow(2,h.z)*i.wrap)*s,u=h.y*s;return Me.translate(f,f,[l,u,0]),Me.scale(f,f,[s/Ge,s/Ge,1]),f}upVector(e,n,i){return[0,0,1]}upVectorScale(e,n,i){return{metersToTile:1}}}class P6 extends xh{constructor(e){super(e),this.range=[4,7],this.center=e.center||[-96,37.5];const[n,i]=this.parallels=e.parallels||[29.5,45.5],s=Math.sin(Be(n));this.n=(s+Math.sin(Be(i)))/2,this.c=1+s*(2*this.n-s),this.r0=Math.sqrt(this.c)/this.n}project(e,n){const{n:i,c:s,r0:l}=this,u=Be(e-this.center[0]),h=Be(n),f=Math.sqrt(s-2*i*Math.sin(h))/i;return{x:f*Math.sin(u*i),y:f*Math.cos(u*i)-l,z:0}}unproject(e,n){const{n:i,c:s,r0:l}=this,u=l+n;let h=Math.atan2(e,Math.abs(u))*Math.sign(u);u*i<0&&(h-=Math.PI*Math.sign(e)*Math.sign(u));const f=Be(this.center[0])*i;h=He(h,-Math.PI-f,Math.PI-f);const m=ce(rt(h/i)+this.center[0],-180,180),y=Math.asin(ce((s-(e*e+u*u)*i*i)/(2*i),-1,1)),v=ce(rt(y),-xi,xi);return new sn(m,v)}}const v_=1.340264,x_=-.081106,w_=893e-6,b_=.003796,X1=Math.sqrt(3)/2;class R6 extends xh{project(e,n){n=n/180*Math.PI,e=e/180*Math.PI;const i=Math.asin(X1*Math.sin(n)),s=i*i,l=s*s*s;return{x:.5*(e*Math.cos(i)/(X1*(v_+3*x_*s+l*(7*w_+9*b_*s)))/Math.PI+.5),y:1-.5*(i*(v_+x_*s+l*(w_+b_*s))/Math.PI+1),z:0}}unproject(e,n){e=(2*e-.5)*Math.PI;let i=n=(2*(1-n)-1)*Math.PI,s=i*i,l=s*s*s;for(let y,v,w,S=0;S<12&&(v=i*(v_+x_*s+l*(w_+b_*s))-n,w=v_+3*x_*s+l*(7*w_+9*b_*s),y=v/w,i=ce(i-y,-Math.PI/3,Math.PI/3),s=i*i,l=s*s*s,!(Math.abs(y)<1e-12));++S);const u=X1*e*(v_+3*x_*s+l*(7*w_+9*b_*s))/Math.cos(i),h=Math.asin(Math.sin(i)/X1),f=ce(180*u/Math.PI,-180,180),m=ce(180*h/Math.PI,-xi,xi);return new sn(f,m)}}class D6 extends xh{constructor(e){super(e),this.wrap=!0,this.supportsWorldCopies=!0}project(e,n){return{x:.5+e/360,y:.5-n/360,z:0}}unproject(e,n){const i=360*(e-.5),s=ce(360*(.5-n),-xi,xi);return new sn(i,s)}}const Mm=Math.PI/2;function K1(t){return Math.tan((Mm+t)/2)}class L6 extends xh{constructor(e){super(e),this.center=e.center||[0,30];const[n,i]=this.parallels=e.parallels||[30,30];let s=Be(n),l=Be(i);this.southernCenter=s+l<0,this.southernCenter&&(s=-s,l=-l);const u=Math.cos(s),h=K1(s);this.n=s===l?Math.sin(s):Math.log(u/Math.cos(l))/Math.log(K1(l)/h),this.f=u*Math.pow(K1(s),this.n)/this.n}project(e,n){n=Be(n),this.southernCenter&&(n=-n),e=Be(e-this.center[0]);const i=1e-6,{n:s,f:l}=this;l>0?n<-Mm+i&&(n=-Mm+i):n>Mm-i&&(n=Mm-i);const u=l/Math.pow(K1(n),s);let h=u*Math.sin(s*e),f=l-u*Math.cos(s*e);return h=.5*(h/Math.PI+.5),f=.5*(f/Math.PI+.5),{x:h,y:this.southernCenter?f:1-f,z:0}}unproject(e,n){e=(2*e-.5)*Math.PI,this.southernCenter&&(n=1-n),n=(2*(1-n)-.5)*Math.PI;const{n:i,f:s}=this,l=s-n,u=Math.sign(l),h=Math.sign(i)*Math.sqrt(e*e+l*l);let f=Math.atan2(e,Math.abs(l))*u;l*i<0&&(f-=Math.PI*Math.sign(e)*u);const m=ce(rt(f/i)+this.center[0],-180,180),y=ce(rt(2*Math.atan(Math.pow(s/h,1/i))-Mm),-xi,xi);return new sn(m,this.southernCenter?-y:y)}}class wI extends xh{constructor(e){super(e),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(e,n){return{x:io(e),y:co(n),z:0}}unproject(e,n){const i=Ls(e),s=Ci(n);return new sn(i,s)}}const bI=Be(xi);class O6 extends xh{project(e,n){const i=(n=Be(n))*n,s=i*i;return{x:.5*((e=Be(e))*(.8707-.131979*i+s*(s*(.003971*i-.001529*s)-.013791))/Math.PI+.5),y:1-.5*(n*(1.007226+i*(.015085+s*(.028874*i-.044475-.005916*s)))/Math.PI+1),z:0}}unproject(e,n){e=(2*e-.5)*Math.PI;let i=n=(2*(1-n)-1)*Math.PI,s=25,l=0,u=i*i;do{u=i*i;const m=u*u;l=(i*(1.007226+u*(.015085+m*(.028874*u-.044475-.005916*m)))-n)/(1.007226+u*(.045255+m*(.259866*u-.311325-.005916*11*m))),i=ce(i-l,-bI,bI)}while(Math.abs(l)>1e-6&&--s>0);u=i*i;const h=ce(rt(e/(.8707+u*(u*(u*u*u*(.003971-.001529*u)-.013791)-.131979))),-180,180),f=rt(i);return new sn(h,f)}}const SI=Be(xi);class z6 extends xh{project(e,n){n=Be(n),e=Be(e);const i=Math.cos(n),s=2/Math.PI,l=Math.acos(i*Math.cos(e/2)),u=Math.sin(l)/l,h=.5*(e*s+2*i*Math.sin(e/2)/u)||0,f=.5*(n+Math.sin(n)/u)||0;return{x:.5*(h/Math.PI+.5),y:1-.5*(f/Math.PI+1),z:0}}unproject(e,n){let i=e=(2*e-.5)*Math.PI,s=n=(2*(1-n)-1)*Math.PI,l=25;const u=1e-6;let h=0,f=0;do{const m=Math.cos(s),y=Math.sin(s),v=2*y*m,w=y*y,S=m*m,E=Math.cos(i/2),A=Math.sin(i/2),M=2*E*A,k=A*A,R=1-S*E*E,L=R?1/R:0,z=R?Math.acos(m*E)*Math.sqrt(1/R):0,B=.5*(2*z*m*A+2*i/Math.PI)-e,j=.5*(z*y+s)-n,V=.5*L*(S*k+z*m*E*w)+1/Math.PI,Y=L*(M*v/4-z*y*A),ne=.125*L*(v*A-z*y*S*M),re=.5*L*(w*E+z*k*m)+.5,J=Y*ne-re*V;h=(j*Y-B*re)/J,f=(B*ne-j*V)/J,i=ce(i-h,-Math.PI,Math.PI),s=ce(s-f,-SI,SI)}while((Math.abs(h)>u||Math.abs(f)>u)&&--l>0);return new sn(rt(i),rt(s))}}class EI extends xh{constructor(e){super(e),this.center=e.center||[0,0],this.parallels=e.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(Be(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(e,n){const{scale:i,cosPhi:s}=this;return{x:Be(e)*s*i+.5,y:-Math.sin(Be(n))/s*i+.5,z:0}}unproject(e,n){const{scale:i,cosPhi:s}=this,l=-(n-.5)/i,u=ce(rt((e-.5)/i)/s,-180,180),h=Math.asin(ce(l*s,-1,1)),f=ce(rt(h),-xi,xi);return new sn(u,f)}}class F6 extends wI{constructor(e){super(e),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(e,n,i){const s=l_(e,n,i),l=pm(ml(i));return fe.transformMat4(s,s,l),{x:s[0],y:s[1],z:s[2]}}locationPoint(e,n){const i=ys(n.lat,n.lng),s=fe.normalize([],i),l=e.elevation?e.elevation.getAtPointOrZero(e.locationCoordinate(n),e._centerAltitude):e._centerAltitude,u=mr(1,0)*Ge*l;fe.scaleAndAdd(i,i,s,u);const h=Me.identity(new Float64Array(16));return Me.multiply(h,e.pixelMatrix,e.globeMatrix),fe.transformMat4(i,i,h),new q(i[0],i[1])}pixelsPerMeter(e,n){return mr(1,0)*n}pixelSpaceConversion(e,n,i){const s=mr(1,e)*n,l=nn(mr(1,45)*n,s,i);return this.pixelsPerMeter(e,n)/l}createTileMatrix(e,n,i){const s=sS(ml(i.canonical));return Me.multiply(new Float64Array(16),e.globeMatrix,s)}createInversionMatrix(e,n){const{center:i}=e,s=pm(ml(n));return Me.rotateY(s,s,Be(i.lng)),Me.rotateX(s,s,Be(i.lat)),Me.scale(s,s,[e._pixelsPerMercatorPixel,e._pixelsPerMercatorPixel,1]),Float32Array.from(s)}pointCoordinate(e,n,i,s){return JM(e,n,i,!0)||new Un(0,0)}pointCoordinate3D(e,n,i){const s=this.pointCoordinate(e,n,i,0);return[s.x,s.y,s.z]}isPointAboveHorizon(e,n){return!JM(e,n.x,n.y,!1)}farthestPixelDistance(e){const n=function(s,l){const u=s.cameraToCenterDistance,h=s._centerAltitude*l,f=s._camera,m=s._camera.forward(),y=fe.add([],fe.scale([],m,-u),[0,0,h]),v=s.worldSize/(2*Math.PI),w=[0,0,-v],S=s.width/s.height,E=Math.tan(s.fovAboveCenter),A=fe.scale([],f.up(),E),M=fe.scale([],f.right(),E*S),k=fe.normalize([],fe.add([],fe.add([],m,A),M)),R=[];let L;if(new w1(y,k).closestPointOnSphere(w,v,R)){const z=fe.add([],R,w),B=fe.sub([],z,y);L=Math.cos(s.fovAboveCenter)*fe.length(B)}else{const z=fe.sub([],y,w),B=fe.sub([],w,y);fe.normalize(B,B);const j=fe.length(z)-v;L=Math.sqrt(j*(j+2*v));const V=Math.acos(L/(v+j))-Math.acos(fe.dot(m,B));L*=Math.cos(V)}return 1.01*L}(e,this.pixelsPerMeter(e.center.lat,e.worldSize)),i=ro(e.zoom);if(i>0){const s=yI(e,mr(1,e.center.lat)*e.worldSize),l=e.worldSize/(2*Math.PI),u=Math.max(e.width,e.height)/e.worldSize*Math.PI;return nn(n,s+l*(1-Math.cos(u)),Math.pow(i,10))}return n}upVector(e,n,i){return l_(n,i,e,1)}upVectorScale(e){return{metersToTile:b1(E1(ml(e)))}}}function Y1(t){const e=t.parallels,n=!!e&&Math.abs(e[0]+e[1])<.01;switch(t.name){case"mercator":return new wI(t);case"equirectangular":return new D6(t);case"naturalEarth":return new O6(t);case"equalEarth":return new R6(t);case"winkelTripel":return new z6(t);case"albers":return n?new EI(t):new P6(t);case"lambertConformalConic":return n?new EI(t):new L6(t);case"globe":return new F6(t)}throw new Error(`Invalid projection name: ${t.name}`)}const B6=new jr({"symbol-placement":new gt(ke.layout_symbol["symbol-placement"]),"symbol-spacing":new gt(ke.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new gt(ke.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new qt(ke.layout_symbol["symbol-sort-key"]),"symbol-z-order":new gt(ke.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new gt(ke.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new gt(ke.layout_symbol["icon-ignore-placement"]),"icon-optional":new gt(ke.layout_symbol["icon-optional"]),"icon-rotation-alignment":new gt(ke.layout_symbol["icon-rotation-alignment"]),"icon-size":new qt(ke.layout_symbol["icon-size"]),"icon-text-fit":new qt(ke.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new qt(ke.layout_symbol["icon-text-fit-padding"]),"icon-image":new qt(ke.layout_symbol["icon-image"]),"icon-rotate":new qt(ke.layout_symbol["icon-rotate"]),"icon-padding":new gt(ke.layout_symbol["icon-padding"]),"icon-keep-upright":new gt(ke.layout_symbol["icon-keep-upright"]),"icon-offset":new qt(ke.layout_symbol["icon-offset"]),"icon-anchor":new qt(ke.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new gt(ke.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new gt(ke.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new gt(ke.layout_symbol["text-rotation-alignment"]),"text-field":new qt(ke.layout_symbol["text-field"]),"text-font":new qt(ke.layout_symbol["text-font"]),"text-size":new qt(ke.layout_symbol["text-size"]),"text-max-width":new qt(ke.layout_symbol["text-max-width"]),"text-line-height":new qt(ke.layout_symbol["text-line-height"]),"text-letter-spacing":new qt(ke.layout_symbol["text-letter-spacing"]),"text-justify":new qt(ke.layout_symbol["text-justify"]),"text-radial-offset":new qt(ke.layout_symbol["text-radial-offset"]),"text-variable-anchor":new gt(ke.layout_symbol["text-variable-anchor"]),"text-anchor":new qt(ke.layout_symbol["text-anchor"]),"text-max-angle":new gt(ke.layout_symbol["text-max-angle"]),"text-writing-mode":new gt(ke.layout_symbol["text-writing-mode"]),"text-rotate":new qt(ke.layout_symbol["text-rotate"]),"text-padding":new gt(ke.layout_symbol["text-padding"]),"text-keep-upright":new gt(ke.layout_symbol["text-keep-upright"]),"text-transform":new qt(ke.layout_symbol["text-transform"]),"text-offset":new qt(ke.layout_symbol["text-offset"]),"text-allow-overlap":new gt(ke.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new gt(ke.layout_symbol["text-ignore-placement"]),"text-optional":new gt(ke.layout_symbol["text-optional"]),visibility:new gt(ke.layout_symbol.visibility)});var BS={paint:new jr({"icon-opacity":new qt(ke.paint_symbol["icon-opacity"]),"icon-emissive-strength":new qt(ke.paint_symbol["icon-emissive-strength"]),"text-emissive-strength":new qt(ke.paint_symbol["text-emissive-strength"]),"icon-color":new qt(ke.paint_symbol["icon-color"]),"icon-halo-color":new qt(ke.paint_symbol["icon-halo-color"]),"icon-halo-width":new qt(ke.paint_symbol["icon-halo-width"]),"icon-halo-blur":new qt(ke.paint_symbol["icon-halo-blur"]),"icon-translate":new gt(ke.paint_symbol["icon-translate"]),"icon-translate-anchor":new gt(ke.paint_symbol["icon-translate-anchor"]),"icon-image-cross-fade":new qt(ke.paint_symbol["icon-image-cross-fade"]),"text-opacity":new qt(ke.paint_symbol["text-opacity"]),"text-color":new qt(ke.paint_symbol["text-color"],{runtimeType:lo,getOverride:t=>t.textColor,hasOverride:t=>!!t.textColor}),"text-halo-color":new qt(ke.paint_symbol["text-halo-color"]),"text-halo-width":new qt(ke.paint_symbol["text-halo-width"]),"text-halo-blur":new qt(ke.paint_symbol["text-halo-blur"]),"text-translate":new gt(ke.paint_symbol["text-translate"]),"text-translate-anchor":new gt(ke.paint_symbol["text-translate-anchor"])}),layout:B6};class TI{constructor(e){this.type=e.property.overrides?e.property.overrides.runtimeType:Tu,this.defaultValue=e}evaluate(e){if(e.formattedSection){const n=this.defaultValue.property.overrides;if(n&&n.hasOverride(e.formattedSection))return n.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default}eachChild(e){this.defaultValue.isConstant()||e(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}kt(TI,"FormatSectionOverride",{omit:["defaultValue"]});class Q1 extends Hn{constructor(e,n){super(e,BS,n)}recalculate(e,n){super.recalculate(e,n),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const i=this.layout.get("text-writing-mode");if(i){const s=[];for(const l of i)s.indexOf(l)<0&&s.push(l);this.layout._values["text-writing-mode"]=s}else this.layout._values["text-writing-mode"]=this.layout.get("symbol-placement")==="point"?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getValueAndResolveTokens(e,n,i,s){const l=this.layout.get(e).evaluate(n,{},i,s),u=this._unevaluatedLayout._values[e];return u.isDataDriven()||_o(u.value)||!l?l:function(h,f){return f.replace(/{([^{}]+)}/g,(m,y)=>y in h?String(h[y]):"")}(n.properties,l)}createBucket(e){return new S_(e)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const e of BS.paint.overridableProperties){if(!Q1.hasPaintOverride(this.layout,e))continue;const n=this.paint.get(e),i=new TI(n),s=new Oo(i,n.property.specification);let l=null;l=n.value.kind==="constant"||n.value.kind==="source"?new ls("source",s):new Ld("composite",s,n.value.zoomStops,n.value._interpolationType),this.paint._values[e]=new Zu(n.property,l,n.parameters)}}_handleOverridablePaintPropertyUpdate(e,n,i){return!(!this.layout||n.isDataDriven()||i.isDataDriven())&&Q1.hasPaintOverride(this.layout,e)}static hasPaintOverride(e,n){const i=e.get("text-field"),s=BS.paint.properties[n];let l=!1;const u=h=>{for(const f of h)if(s.overrides&&s.overrides.hasOverride(f))return void(l=!0)};if(i.value.kind==="constant"&&i.value.value instanceof Ji)u(i.value.value.sections);else if(i.value.kind==="source"){const h=m=>{l||(m instanceof gd&&Pi(m.value)===Cu?u(m.value.sections):m instanceof Pc?u(m.sections):m.eachChild(h))},f=i.value;f._styleExpression&&h(f._styleExpression.expression)}return l}getProgramConfiguration(e){return new al(this,e)}}const N6=B1.types,j6=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function J1(t,e,n,i,s,l,u,h,f,m,y,v,w){const S=h?Math.min(vh,Math.round(h[0])):0,E=h?Math.min(vh,Math.round(h[1])):0;t.emplaceBack(e,n,Math.round(32*i),Math.round(32*s),l,u,(S<<1)+(f?1:0),E,16*m,16*y,256*v,256*w)}function ex(t,e,n){t.emplaceBack(e,n)}function tx(t,e,n,i,s,l,u){t.emplaceBack(e,n,i,s,l,u)}function nx(t,e,n,i,s){const l=5*e+2;t.float32[l+0]=n,t.float32[l+1]=i,t.float32[l+2]=s}function Im(t,e,n,i,s){t.emplaceBack(e,n,i,s),t.emplaceBack(e,n,i,s),t.emplaceBack(e,n,i,s),t.emplaceBack(e,n,i,s)}function U6(t){for(const e of t.sections)if(ks(e.text))return!0;return!1}class NS{constructor(e){this.layoutVertexArray=new $y,this.indexArray=new di,this.programConfigurations=e,this.segments=new In,this.dynamicLayoutVertexArray=new Wl,this.opacityVertexArray=new jp,this.placedSymbolArray=new n1,this.iconTransitioningVertexArray=new sl,this.globeExtVertexArray=new Np}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0&&this.iconTransitioningVertexArray.length===0}upload(e,n,i,s){this.isEmpty()||(i&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,i6.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,n),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,s6.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,j6,!0),this.iconTransitioningVertexArray.length>0&&(this.iconTransitioningVertexBuffer=e.createVertexBuffer(this.iconTransitioningVertexArray,a6.members,!0)),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=e.createVertexBuffer(this.globeExtVertexArray,o6.members,!0)),this.opacityVertexBuffer.itemSize=1),(i||s)&&this.programConfigurations.upload(e))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.iconTransitioningVertexBuffer&&this.iconTransitioningVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}}kt(NS,"SymbolBuffers");class jS{constructor(e,n,i){this.layoutVertexArray=new e,this.layoutAttributes=n,this.indexArray=new i,this.segments=new In,this.collisionVertexArray=new wo,this.collisionVertexArrayExt=new Ei}upload(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,l6.members,!0),this.collisionVertexBufferExt=e.createVertexBuffer(this.collisionVertexArrayExt,u6.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}kt(jS,"CollisionBuffers");class rx{constructor(e){this.collisionBoxArray=e.collisionBoxArray,this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(u=>u.id),this.index=e.index,this.pixelRatio=e.pixelRatio,this.sourceLayerIndex=e.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.hasAnyIconTextFit=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Me.identity([]),this.placementViewportMatrix=Me.identity([]);const n=this.layers[0]._unevaluatedLayout._values;this.textSizeData=IS(this.zoom,n["text-size"]),this.iconSizeData=IS(this.zoom,n["icon-size"]);const i=this.layers[0].layout,s=i.get("symbol-sort-key"),l=i.get("symbol-z-order");this.canOverlap=i.get("text-allow-overlap")||i.get("icon-allow-overlap")||i.get("text-ignore-placement")||i.get("icon-ignore-placement"),this.sortFeaturesByKey=l!=="viewport-y"&&s.constantOr(1)!==void 0,this.sortFeaturesByY=(l==="viewport-y"||l==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=i.get("text-writing-mode").map(u=>Gr[u]),this.stateDependentLayerIds=this.layers.filter(u=>u.isStateDependent()).map(u=>u.id),this.sourceID=e.sourceID,this.projection=e.projection}createArrays(){this.text=new NS(new ll(this.layers,this.zoom,e=>/^text/.test(e))),this.icon=new NS(new ll(this.layers,this.zoom,e=>/^icon/.test(e))),this.glyphOffsetArray=new Wy,this.lineVertexArray=new Qd,this.symbolInstances=new qp}calculateGlyphDependencies(e,n,i,s,l){for(let u=0;u<e.length;u++){const h=e.codePointAt(u);if(h===void 0)break;if(n[h]=!0,s&&l&&h<=65535){const f=m_[e.charAt(u)];f&&(n[f.charCodeAt(0)]=!0)}}}populate(e,n,i,s){const l=this.layers[0],u=l.layout,h=this.projection.name==="globe",f=u.get("text-font"),m=u.get("text-field"),y=u.get("icon-image"),v=(m.value.kind!=="constant"||m.value.value instanceof Ji&&!m.value.value.isEmpty()||m.value.value.toString().length>0)&&(f.value.kind!=="constant"||f.value.value.length>0),w=y.value.kind!=="constant"||!!y.value.value||Object.keys(y.parameters).length>0,S=u.get("symbol-sort-key");if(this.features=[],!v&&!w)return;const E=n.iconDependencies,A=n.glyphDependencies,M=n.availableImages,k=new Nr(this.zoom);for(const{feature:R,id:L,index:z,sourceLayerIndex:B}of e){const j=l._featureFilter.needGeometry,V=mh(R,j);if(!l._featureFilter.filter(k,V,i))continue;if(j||(V.geometry=nu(R,i,s)),h&&R.type!==1&&i.z<=5){const J=V.geometry,ae=.98078528056,le=(oe,Ee)=>{const xe=l_(oe.x,oe.y,i,1),Pe=l_(Ee.x,Ee.y,i,1);return fe.dot(xe,Pe)<ae};for(let oe=0;oe<J.length;oe++)J[oe]=eN(J[oe],le)}let Y,ne;if(v){const J=l.getValueAndResolveTokens("text-field",V,i,M),ae=Ji.factory(J);U6(ae)&&(this.hasRTLText=!0),(!this.hasRTLText||zp()==="unavailable"||this.hasRTLText&&xo.isParsed())&&(Y=d6(ae,l,V))}if(w){const J=l.getValueAndResolveTokens("icon-image",V,i,M);ne=J instanceof Do?J:Do.fromString(J)}if(!Y&&!ne)continue;const re=this.sortFeaturesByKey?S.evaluate(V,{},i):void 0;if(this.features.push({id:L,text:Y,icon:ne,index:z,sourceLayerIndex:B,geometry:V.geometry,properties:R.properties,type:N6[R.type],sortKey:re}),ne&&(E[ne.namePrimary]=!0,ne.nameSecondary&&(E[ne.nameSecondary]=!0)),Y){const J=f.evaluate(V,{},i).join(","),ae=u.get("text-rotation-alignment")==="map"&&u.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(Gr.vertical)>=0;for(const le of Y.sections)if(le.image)E[le.image.namePrimary]=!0;else{const oe=Hu(Y.toString()),Ee=le.fontStack||J,xe=A[Ee]=A[Ee]||{};this.calculateGlyphDependencies(le.text,xe,ae,this.allowVerticalPlacement,oe)}}}u.get("symbol-placement")==="line"&&(this.features=function(R){const L={},z={},B=[];let j=0;function V(J){B.push(R[J]),j++}function Y(J,ae,le){const oe=z[J];return delete z[J],z[ae]=oe,B[oe].geometry[0].pop(),B[oe].geometry[0]=B[oe].geometry[0].concat(le[0]),oe}function ne(J,ae,le){const oe=L[ae];return delete L[ae],L[J]=oe,B[oe].geometry[0].shift(),B[oe].geometry[0]=le[0].concat(B[oe].geometry[0]),oe}function re(J,ae,le){const oe=le?ae[0][ae[0].length-1]:ae[0][0];return`${J}:${oe.x}:${oe.y}`}for(let J=0;J<R.length;J++){const ae=R[J],le=ae.geometry,oe=ae.text?ae.text.toString():null;if(!oe){V(J);continue}const Ee=re(oe,le),xe=re(oe,le,!0);if(Ee in z&&xe in L&&z[Ee]!==L[xe]){const Pe=ne(Ee,xe,le),pe=Y(Ee,xe,B[Pe].geometry);delete L[Ee],delete z[xe],z[re(oe,B[pe].geometry,!0)]=pe,B[Pe].geometry=null}else Ee in z?Y(Ee,xe,le):xe in L?ne(Ee,xe,le):(V(J),L[Ee]=j-1,z[xe]=j-1)}return B.filter(J=>J.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((R,L)=>R.sortKey-L.sortKey)}update(e,n,i,s,l){const u=Object.keys(e).length!==0;if(u&&!this.stateDependentLayers.length)return;const h=u?this.stateDependentLayers:this.layers;this.text.programConfigurations.updatePaintArrays(e,n,h,i,s,l),this.icon.programConfigurations.updatePaintArrays(e,n,h,i,s,l)}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=Y1(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(e,n){const i=this.lineVertexArray.length;if(e.segment!==void 0)for(const{x:s,y:l}of n)this.lineVertexArray.emplaceBack(s,l);return{lineStartIndex:i,lineLength:this.lineVertexArray.length-i}}addSymbols(e,n,i,s,l,u,h,f,m,y,v,w,S,E,A,M){const k=e.indexArray,R=e.layoutVertexArray,L=e.globeExtVertexArray,z=e.segments.prepareSegment(4*n.length,R,k,this.canOverlap?u.sortKey:void 0),B=this.glyphOffsetArray.length,j=z.vertexLength,V=this.allowVerticalPlacement&&h===Gr.vertical?Math.PI/2:0,Y=u.text&&u.text.sections;for(let re=0;re<n.length;re++){const{tl:J,tr:ae,bl:le,br:oe,texPrimary:Ee,texSecondary:xe,pixelOffsetTL:Pe,pixelOffsetBR:pe,minFontScaleX:Ae,minFontScaleY:Le,glyphOffset:qe,isSDF:Ve,sectionIndex:yt}=n[re],mt=z.vertexLength,lt=qe[1];if(J1(R,m.x,m.y,J.x,lt+J.y,Ee.x,Ee.y,i,Ve,Pe.x,Pe.y,Ae,Le),J1(R,m.x,m.y,ae.x,lt+ae.y,Ee.x+Ee.w,Ee.y,i,Ve,pe.x,Pe.y,Ae,Le),J1(R,m.x,m.y,le.x,lt+le.y,Ee.x,Ee.y+Ee.h,i,Ve,Pe.x,pe.y,Ae,Le),J1(R,m.x,m.y,oe.x,lt+oe.y,Ee.x+Ee.w,Ee.y+Ee.h,i,Ve,pe.x,pe.y,Ae,Le),f){const{x:ft,y:Mt,z:Zt}=f.anchor,[Gt,Ut,Xt]=f.up;tx(L,ft,Mt,Zt,Gt,Ut,Xt),tx(L,ft,Mt,Zt,Gt,Ut,Xt),tx(L,ft,Mt,Zt,Gt,Ut,Xt),tx(L,ft,Mt,Zt,Gt,Ut,Xt),Im(e.dynamicLayoutVertexArray,ft,Mt,Zt,V)}else Im(e.dynamicLayoutVertexArray,m.x,m.y,m.z,V);if(M){const ft=xe||Ee;ex(e.iconTransitioningVertexArray,ft.x,ft.y),ex(e.iconTransitioningVertexArray,ft.x+ft.w,ft.y),ex(e.iconTransitioningVertexArray,ft.x,ft.y+ft.h),ex(e.iconTransitioningVertexArray,ft.x+ft.w,ft.y+ft.h)}k.emplaceBack(mt,mt+1,mt+2),k.emplaceBack(mt+1,mt+2,mt+3),z.vertexLength+=4,z.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(qe[0]),re!==n.length-1&&yt===n[re+1].sectionIndex||e.programConfigurations.populatePaintArrays(R.length,u,u.index,{},S,E,A,Y&&Y[yt])}const ne=f?f.anchor:m;e.placedSymbolArray.emplaceBack(ne.x,ne.y,ne.z,m.x,m.y,B,this.glyphOffsetArray.length-B,j,y,v,m.segment,i?i[0]:0,i?i[1]:0,s[0],s[1],h,0,!1,0,w,0)}_commitLayoutVertex(e,n,i,s,l,u,h){e.emplaceBack(n,i,s,l,u,Math.round(h.x),Math.round(h.y))}_addCollisionDebugVertices(e,n,i,s,l,u,h){const f=i.segments.prepareSegment(4,i.layoutVertexArray,i.indexArray),m=f.vertexLength,y=h.tileAnchorX,v=h.tileAnchorY;for(let S=0;S<4;S++)i.collisionVertexArray.emplaceBack(0,0,0,0);i.collisionVertexArrayExt.emplaceBack(n,-e.padding,-e.padding),i.collisionVertexArrayExt.emplaceBack(n,e.padding,-e.padding),i.collisionVertexArrayExt.emplaceBack(n,e.padding,e.padding),i.collisionVertexArrayExt.emplaceBack(n,-e.padding,e.padding),this._commitLayoutVertex(i.layoutVertexArray,s,l,u,y,v,new q(e.x1,e.y1)),this._commitLayoutVertex(i.layoutVertexArray,s,l,u,y,v,new q(e.x2,e.y1)),this._commitLayoutVertex(i.layoutVertexArray,s,l,u,y,v,new q(e.x2,e.y2)),this._commitLayoutVertex(i.layoutVertexArray,s,l,u,y,v,new q(e.x1,e.y2)),f.vertexLength+=4;const w=i.indexArray;w.emplaceBack(m,m+1),w.emplaceBack(m+1,m+2),w.emplaceBack(m+2,m+3),w.emplaceBack(m+3,m),f.primitiveLength+=4}_addTextDebugCollisionBoxes(e,n,i,s,l,u){for(let h=s;h<l;h++){const f=i.get(h),m=this.getSymbolInstanceTextSize(e,u,n,h);this._addCollisionDebugVertices(f,m,this.textCollisionBox,f.projectedAnchorX,f.projectedAnchorY,f.projectedAnchorZ,u)}}_addIconDebugCollisionBoxes(e,n,i,s,l,u){for(let h=s;h<l;h++){const f=i.get(h),m=this.getSymbolInstanceIconSize(e,n,u.placedIconSymbolIndex);this._addCollisionDebugVertices(f,m,this.iconCollisionBox,f.projectedAnchorX,f.projectedAnchorY,f.projectedAnchorZ,u)}}generateCollisionDebugBuffers(e,n){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new jS(qd,X3.members,sl),this.iconCollisionBox=new jS(qd,X3.members,sl);const i=ru(this.iconSizeData,e),s=ru(this.textSizeData,e);for(let l=0;l<this.symbolInstances.length;l++){const u=this.symbolInstances.get(l);this._addTextDebugCollisionBoxes(s,e,n,u.textBoxStartIndex,u.textBoxEndIndex,u),this._addTextDebugCollisionBoxes(s,e,n,u.verticalTextBoxStartIndex,u.verticalTextBoxEndIndex,u),this._addIconDebugCollisionBoxes(i,e,n,u.iconBoxStartIndex,u.iconBoxEndIndex,u),this._addIconDebugCollisionBoxes(i,e,n,u.verticalIconBoxStartIndex,u.verticalIconBoxEndIndex,u)}}getSymbolInstanceTextSize(e,n,i,s){const l=this.text.placedSymbolArray.get(n.rightJustifiedTextSymbolIndex>=0?n.rightJustifiedTextSymbolIndex:n.centerJustifiedTextSymbolIndex>=0?n.centerJustifiedTextSymbolIndex:n.leftJustifiedTextSymbolIndex>=0?n.leftJustifiedTextSymbolIndex:n.verticalPlacedTextSymbolIndex>=0?n.verticalPlacedTextSymbolIndex:s),u=p_(this.textSizeData,e,l)/Wi;return this.tilePixelRatio*u}getSymbolInstanceIconSize(e,n,i){const s=this.icon.placedSymbolArray.get(i),l=p_(this.iconSizeData,e,s);return this.tilePixelRatio*l}_commitDebugCollisionVertexUpdate(e,n,i){e.emplaceBack(n,-i,-i),e.emplaceBack(n,i,-i),e.emplaceBack(n,i,i),e.emplaceBack(n,-i,i)}_updateTextDebugCollisionBoxes(e,n,i,s,l,u){for(let h=s;h<l;h++){const f=i.get(h),m=this.getSymbolInstanceTextSize(e,u,n,h);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,m,f.padding)}}_updateIconDebugCollisionBoxes(e,n,i,s,l,u){for(let h=s;h<l;h++){const f=i.get(h),m=this.getSymbolInstanceIconSize(e,n,u);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,m,f.padding)}}updateCollisionDebugBuffers(e,n){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const i=ru(this.iconSizeData,e),s=ru(this.textSizeData,e);for(let l=0;l<this.symbolInstances.length;l++){const u=this.symbolInstances.get(l);this._updateTextDebugCollisionBoxes(s,e,n,u.textBoxStartIndex,u.textBoxEndIndex,u),this._updateTextDebugCollisionBoxes(s,e,n,u.verticalTextBoxStartIndex,u.verticalTextBoxEndIndex,u),this._updateIconDebugCollisionBoxes(i,e,n,u.iconBoxStartIndex,u.iconBoxEndIndex,u.placedIconSymbolIndex),this._updateIconDebugCollisionBoxes(i,e,n,u.verticalIconBoxStartIndex,u.verticalIconBoxEndIndex,u.placedIconSymbolIndex)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(e,n,i,s,l,u,h,f,m){const y={};if(n<i){const{x1:v,y1:w,x2:S,y2:E,padding:A,projectedAnchorX:M,projectedAnchorY:k,projectedAnchorZ:R,tileAnchorX:L,tileAnchorY:z,featureIndex:B}=e.get(n);y.textBox={x1:v,y1:w,x2:S,y2:E,padding:A,projectedAnchorX:M,projectedAnchorY:k,projectedAnchorZ:R,tileAnchorX:L,tileAnchorY:z},y.textFeatureIndex=B}if(s<l){const{x1:v,y1:w,x2:S,y2:E,padding:A,projectedAnchorX:M,projectedAnchorY:k,projectedAnchorZ:R,tileAnchorX:L,tileAnchorY:z,featureIndex:B}=e.get(s);y.verticalTextBox={x1:v,y1:w,x2:S,y2:E,padding:A,projectedAnchorX:M,projectedAnchorY:k,projectedAnchorZ:R,tileAnchorX:L,tileAnchorY:z},y.verticalTextFeatureIndex=B}if(u<h){const{x1:v,y1:w,x2:S,y2:E,padding:A,projectedAnchorX:M,projectedAnchorY:k,projectedAnchorZ:R,tileAnchorX:L,tileAnchorY:z,featureIndex:B}=e.get(u);y.iconBox={x1:v,y1:w,x2:S,y2:E,padding:A,projectedAnchorX:M,projectedAnchorY:k,projectedAnchorZ:R,tileAnchorX:L,tileAnchorY:z},y.iconFeatureIndex=B}if(f<m){const{x1:v,y1:w,x2:S,y2:E,padding:A,projectedAnchorX:M,projectedAnchorY:k,projectedAnchorZ:R,tileAnchorX:L,tileAnchorY:z,featureIndex:B}=e.get(f);y.verticalIconBox={x1:v,y1:w,x2:S,y2:E,padding:A,projectedAnchorX:M,projectedAnchorY:k,projectedAnchorZ:R,tileAnchorX:L,tileAnchorY:z},y.verticalIconFeatureIndex=B}return y}deserializeCollisionBoxes(e){this.collisionArrays=[];for(let n=0;n<this.symbolInstances.length;n++){const i=this.symbolInstances.get(n);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,i.textBoxStartIndex,i.textBoxEndIndex,i.verticalTextBoxStartIndex,i.verticalTextBoxEndIndex,i.iconBoxStartIndex,i.iconBoxEndIndex,i.verticalIconBoxStartIndex,i.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}hasIconTextFit(){return this.hasAnyIconTextFit}addIndicesForPlacedSymbol(e,n){const i=e.placedSymbolArray.get(n),s=i.vertexStartIndex+4*i.numGlyphs;for(let l=i.vertexStartIndex;l<s;l+=4)e.indexArray.emplaceBack(l,l+1,l+2),e.indexArray.emplaceBack(l+1,l+2,l+3)}getSortedSymbolIndexes(e){if(this.sortedAngle===e&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const n=Math.sin(e),i=Math.cos(e),s=[],l=[],u=[];for(let h=0;h<this.symbolInstances.length;++h){u.push(h);const f=this.symbolInstances.get(h);s.push(0|Math.round(n*f.tileAnchorX+i*f.tileAnchorY)),l.push(f.featureIndex)}return u.sort((h,f)=>s[h]-s[f]||l[f]-l[h]),u}addToSortKeyRanges(e,n){const i=this.sortKeyRanges[this.sortKeyRanges.length-1];i&&i.sortKey===n?i.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:n,symbolInstanceStart:e,symbolInstanceEnd:e+1})}sortFeatures(e){if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const n of this.symbolInstanceIndexes){const i=this.symbolInstances.get(n);this.featureSortOrder.push(i.featureIndex);const{rightJustifiedTextSymbolIndex:s,centerJustifiedTextSymbolIndex:l,leftJustifiedTextSymbolIndex:u,verticalPlacedTextSymbolIndex:h,placedIconSymbolIndex:f,verticalPlacedIconSymbolIndex:m}=i;s>=0&&this.addIndicesForPlacedSymbol(this.text,s),l>=0&&l!==s&&this.addIndicesForPlacedSymbol(this.text,l),u>=0&&u!==l&&u!==s&&this.addIndicesForPlacedSymbol(this.text,u),h>=0&&this.addIndicesForPlacedSymbol(this.text,h),f>=0&&this.addIndicesForPlacedSymbol(this.icon,f),m>=0&&this.addIndicesForPlacedSymbol(this.icon,m)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}kt(rx,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),rx.MAX_GLYPHS=65535,rx.addDynamicAttributes=Im;var S_=rx;const V6=Kn([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),{members:$6}=V6,G6=Kn([{name:"a_packed",components:4,type:"Float32"}]),{members:H6}=G6,q6=B1.types,W6=Math.cos(Math.PI/180*37.5);class ix{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(n=>n.id),this.index=e.index,this.projection=e.projection,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(n=>{this.gradients[n.id]={}}),this.layoutVertexArray=new Vy,this.layoutVertexArray2=new Wl,this.indexArray=new di,this.programConfigurations=new ll(e.layers,e.zoom),this.segments=new In,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(n=>n.isStateDependent()).map(n=>n.id)}populate(e,n,i,s){this.hasPattern=ES("line",this.layers,n);const l=this.layers[0].layout.get("line-sort-key"),u=[];for(const{feature:y,id:v,index:w,sourceLayerIndex:S}of e){const E=this.layers[0]._featureFilter.needGeometry,A=mh(y,E);if(!this.layers[0]._featureFilter.filter(new Nr(this.zoom),A,i))continue;const M=l?l.evaluate(A,{},i):void 0,k={id:v,properties:y.properties,type:y.type,sourceLayerIndex:S,index:w,geometry:E?A.geometry:nu(y,i,s),patterns:{},sortKey:M};u.push(k)}l&&u.sort((y,v)=>y.sortKey-v.sortKey);const{lineAtlas:h,featureIndex:f}=n,m=this.addConstantDashes(h);for(const y of u){const{geometry:v,index:w,sourceLayerIndex:S}=y;if(m&&this.addFeatureDashes(y,h),this.hasPattern){const E=TS("line",this.layers,y,this.zoom,n);this.patternFeatures.push(E)}else this.addFeature(y,v,w,i,h.positions,n.availableImages,n.brightness);f.insert(e[w].feature,v,w,S,this.index)}}addConstantDashes(e){let n=!1;for(const i of this.layers){const s=i.paint.get("line-dasharray").value,l=i.layout.get("line-cap").value;if(s.kind!=="constant"||l.kind!=="constant")n=!0;else{const u=l.value,h=s.value;if(!h)continue;e.addDash(h,u)}}return n}addFeatureDashes(e,n){const i=this.zoom;for(const s of this.layers){const l=s.paint.get("line-dasharray").value,u=s.layout.get("line-cap").value;if(l.kind==="constant"&&u.kind==="constant")continue;let h,f;if(l.kind==="constant"){if(h=l.value,!h)continue}else h=l.evaluate({zoom:i},e);f=u.kind==="constant"?u.value:u.evaluate({zoom:i},e),n.addDash(h,f),e.patterns[s.id]=n.getKey(h,f)}}update(e,n,i,s,l){const u=Object.keys(e).length!==0;u&&!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(e,n,u?this.stateDependentLayers:this.layers,i,s,l)}addFeatures(e,n,i,s,l,u){for(const h of this.patternFeatures)this.addFeature(h,h.geometry,h.index,n,i,s,u)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,H6)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,$6),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(e){if(e.properties&&e.properties.hasOwnProperty("mapbox_clip_start")&&e.properties.hasOwnProperty("mapbox_clip_end"))return{start:+e.properties.mapbox_clip_start,end:+e.properties.mapbox_clip_end}}addFeature(e,n,i,s,l,u,h){const f=this.layers[0].layout,m=f.get("line-join").evaluate(e,{}),y=f.get("line-cap").evaluate(e,{}),v=f.get("line-miter-limit"),w=f.get("line-round-limit");this.lineClips=this.lineFeatureClips(e);for(const S of n)this.addLine(S,e,m,y,v,w);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,i,l,u,s,h)}addLine(e,n,i,s,l,u){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let k=0;k<e.length-1;k++)this.totalDistance+=e[k].dist(e[k+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const h=q6[n.type]==="Polygon";let f=e.length;for(;f>=2&&e[f-1].equals(e[f-2]);)f--;let m=0;for(;m<f-1&&e[m].equals(e[m+1]);)m++;if(f<(h?3:2))return;i==="bevel"&&(l=1.05);const y=this.overscaling<=16?15*Ge/(512*this.overscaling):0,v=this.segments.prepareSegment(10*f,this.layoutVertexArray,this.indexArray);let w,S,E,A,M;this.e1=this.e2=-1,h&&(w=e[f-2],M=e[m].sub(w)._unit()._perp());for(let k=m;k<f;k++){if(E=k===f-1?h?e[m+1]:void 0:e[k+1],E&&e[k].equals(E))continue;M&&(A=M),w&&(S=w),w=e[k],M=E?E.sub(w)._unit()._perp():A,A=A||M;let R=A.add(M);R.x===0&&R.y===0||R._unit();const L=A.x*M.x+A.y*M.y,z=R.x*M.x+R.y*M.y,B=z!==0?1/z:1/0,j=2*Math.sqrt(2-2*z),V=z<W6&&S&&E,Y=A.x*M.y-A.y*M.x>0;if(V&&k>m){const J=w.dist(S);if(J>2*y){const ae=w.sub(w.sub(S)._mult(y/J)._round());this.updateDistance(S,ae),this.addCurrentVertex(ae,A,0,0,v),S=ae}}const ne=S&&E;let re=ne?i:h?"butt":s;if(ne&&re==="round"&&(B<u?re="miter":B<=2&&(re="fakeround")),re==="miter"&&B>l&&(re="bevel"),re==="bevel"&&(B>2&&(re="flipbevel"),B<l&&(re="miter")),S&&this.updateDistance(S,w),re==="miter")R._mult(B),this.addCurrentVertex(w,R,0,0,v);else if(re==="flipbevel"){if(B>100)R=M.mult(-1);else{const J=B*A.add(M).mag()/A.sub(M).mag();R._perp()._mult(J*(Y?-1:1))}this.addCurrentVertex(w,R,0,0,v),this.addCurrentVertex(w,R.mult(-1),0,0,v)}else if(re==="bevel"||re==="fakeround"){const J=-Math.sqrt(B*B-1),ae=Y?J:0,le=Y?0:J;if(S&&this.addCurrentVertex(w,A,ae,le,v),re==="fakeround"){const oe=Math.round(180*j/Math.PI/20);for(let Ee=1;Ee<oe;Ee++){let xe=Ee/oe;if(xe!==.5){const pe=xe-.5;xe+=xe*pe*(xe-1)*((1.0904+L*(L*(3.55645-1.43519*L)-3.2452))*pe*pe+(.848013+L*(.215638*L-1.06021)))}const Pe=M.sub(A)._mult(xe)._add(A)._unit()._mult(Y?-1:1);this.addHalfVertex(w,Pe.x,Pe.y,!1,Y,0,v)}}E&&this.addCurrentVertex(w,M,-ae,-le,v)}else if(re==="butt")this.addCurrentVertex(w,R,0,0,v);else if(re==="square"){const J=S?1:-1;S||this.addCurrentVertex(w,R,J,J,v),this.addCurrentVertex(w,R,0,0,v),S&&this.addCurrentVertex(w,R,J,J,v)}else re==="round"&&(S&&(this.addCurrentVertex(w,A,0,0,v),this.addCurrentVertex(w,A,1,1,v,!0)),E&&(this.addCurrentVertex(w,M,-1,-1,v,!0),this.addCurrentVertex(w,M,0,0,v)));if(V&&k<f-1){const J=w.dist(E);if(J>2*y){const ae=w.add(E.sub(w)._mult(y/J)._round());this.updateDistance(w,ae),this.addCurrentVertex(ae,M,0,0,v),w=ae}}}}addCurrentVertex(e,n,i,s,l,u=!1){const h=n.y*s-n.x,f=-n.y-n.x*s;this.addHalfVertex(e,n.x+n.y*i,n.y-n.x*i,u,!1,i,l),this.addHalfVertex(e,h,f,u,!0,-s,l)}addHalfVertex({x:e,y:n},i,s,l,u,h,f){this.layoutVertexArray.emplaceBack((e<<1)+(l?1:0),(n<<1)+(u?1:0),Math.round(63*i)+128,Math.round(63*s)+128,1+(h===0?0:h<0?-1:1),0,this.lineSoFar),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineClips.start,this.lineClips.end);const m=f.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,m),f.primitiveLength++),u?this.e2=m:this.e1=m}updateScaledDistance(){if(this.lineClips){const e=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=e*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}updateDistance(e,n){this.distance+=e.dist(n),this.updateScaledDistance()}}kt(ix,"LineBucket",{omit:["layers","patternFeatures"]});class Ai{constructor(e,n,i,s){this.context=e,this.format=i,this.texture=e.gl.createTexture(),this.update(n,s)}update(e,n,i){const{width:s,height:l}=e,{context:u}=this,{gl:h}=u,{HTMLImageElement:f,HTMLCanvasElement:m,HTMLVideoElement:y,ImageData:v,ImageBitmap:w}=C;if(h.bindTexture(h.TEXTURE_2D,this.texture),u.pixelStoreUnpackFlipY.set(!1),u.pixelStoreUnpack.set(1),u.pixelStoreUnpackPremultiplyAlpha.set(this.format===h.RGBA&&(!n||n.premultiply!==!1)),i||this.size&&this.size[0]===s&&this.size[1]===l){const{x:S,y:E}=i||{x:0,y:0};e instanceof f||e instanceof m||e instanceof y||e instanceof v||w&&e instanceof w?h.texSubImage2D(h.TEXTURE_2D,0,S,E,h.RGBA,h.UNSIGNED_BYTE,e):h.texSubImage2D(h.TEXTURE_2D,0,S,E,s,l,h.RGBA,h.UNSIGNED_BYTE,e.data)}else if(this.size=[s,l],e instanceof f||e instanceof m||e instanceof y||e instanceof v||w&&e instanceof w){let S=this.format;u.isWebGL2&&this.format===h.R8&&(S=h.RED),h.texImage2D(h.TEXTURE_2D,0,this.format,S,h.UNSIGNED_BYTE,e)}else{let S=this.format,E=h.UNSIGNED_BYTE;this.format===h.DEPTH_COMPONENT&&(S=h.DEPTH_COMPONENT16,E=h.UNSIGNED_SHORT),h.texImage2D(h.TEXTURE_2D,0,S,s,l,0,this.format,E,e.data)}this.useMipmap=!!(n&&n.useMipmap&&this.isSizePowerOfTwo()),this.useMipmap&&h.generateMipmap(h.TEXTURE_2D)}bind(e,n){const{context:i}=this,{gl:s}=i;s.bindTexture(s.TEXTURE_2D,this.texture),e!==this.minFilter&&(s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MAG_FILTER,e),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MIN_FILTER,this.useMipmap?e===s.NEAREST?s.NEAREST_MIPMAP_NEAREST:s.LINEAR_MIPMAP_NEAREST:e),this.minFilter=e),n!==this.wrapS&&(s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_S,n),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_T,n),this.wrapS=n)}bindExtraParam(e,n,i,s){const{context:l}=this,{gl:u}=l;u.bindTexture(u.TEXTURE_2D,this.texture),n!==this.magFilter&&(u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MAG_FILTER,n),this.magFilter=n),e!==this.minFilter&&(u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MIN_FILTER,this.useMipmap?e===u.NEAREST?u.NEAREST_MIPMAP_NEAREST:u.LINEAR_MIPMAP_NEAREST:e),this.minFilter=e),i!==this.wrapS&&(u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_S,i),this.wrapS=i),s!==this.wrapT&&(u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_T,s),this.wrapT=s)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:e}=this.context;e.deleteTexture(this.texture),this.texture=null}}const Aa=32,iu=33,wh=new Uint16Array(8184);for(let t=0;t<2046;t++){let e=t+2,n=0,i=0,s=0,l=0,u=0,h=0;for(1&e?s=l=u=Aa:n=i=h=Aa;(e>>=1)>1;){const m=n+s>>1,y=i+l>>1;1&e?(s=n,l=i,n=u,i=h):(n=s,i=l,s=u,l=h),u=m,h=y}const f=4*t;wh[f+0]=n,wh[f+1]=i,wh[f+2]=s,wh[f+3]=l}const ou=new Uint16Array(2178),bh=new Uint8Array(1089),ox=new Uint16Array(1089);function CI(t){return t===0?-.03125:t===32?.03125:0}var US=Kn([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);const AI={type:2,extent:Ge,loadGeometry:()=>[[new q(0,0),new q(Ge+1,0),new q(Ge+1,Ge+1),new q(0,Ge+1),new q(0,0)]]};class E_{constructor(e,n,i,s,l){this.tileID=e,this.uid=Dn(),this.uses=0,this.tileSize=n,this.tileZoom=i,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=l,s&&s.style&&(this._lastUpdatedBrightness=s.style.getBrightness()),this.expiredRequestCount=0,this.state="loading",s&&s.transform&&(this.projection=s.transform.projection)}registerFadeDuration(e){const n=e+this.timeAdded;n<mn.now()||this.fadeEndTime&&n<this.fadeEndTime||(this.fadeEndTime=n)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}get tileTransform(){return this._tileTransform||(this._tileTransform=hf(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(e,n,i){if(this.unloadVectorData(),this.state="loaded",e){e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=function(s,l){const u={};if(!l)return u;for(const h of s){const f=h.layerIds.map(m=>l.getLayer(m)).filter(Boolean);if(f.length!==0){h.layers=f,h.stateDependentLayerIds&&(h.stateDependentLayers=h.stateDependentLayerIds.map(m=>f.filter(y=>y.id===m)[0]));for(const m of f)u[m.id]=h}}return u}(e.buckets,n.style),this.hasSymbolBuckets=!1;for(const s in this.buckets){const l=this.buckets[s];if(l instanceof S_){if(this.hasSymbolBuckets=!0,!i)break;l.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const s in this.buckets){const l=this.buckets[s];if(l instanceof S_&&l.hasRTLText){this.hasRTLText=!0,xo.isLoading()||xo.isLoaded()||zp()!=="deferred"||Ny();break}}this.queryPadding=0;for(const s in this.buckets){const l=this.buckets[s];this.queryPadding=Math.max(this.queryPadding,n.style.getLayer(s).queryRadius(l))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage),e.lineAtlas&&(this.lineAtlas=e.lineAtlas),this._lastUpdatedBrightness=e.brightness}else this.collisionBoxArray=new Kd}unloadVectorData(){if(this.hasData()){for(const e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}getBucket(e){return this.buckets[e.id]}upload(e){for(const i in this.buckets){const s=this.buckets[i];s.uploadPending()&&s.upload(e)}const n=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new Ai(e,this.imageAtlas.image,n.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Ai(e,this.glyphAtlasImage,n.ALPHA),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new Ai(e,this.lineAtlas.image,n.ALPHA),this.lineAtlas.uploaded=!0)}prepare(e,n,i){if(this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture,i),!n||!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData)return;const s=n.style.getBrightness();(this._lastUpdatedBrightness||s)&&(this._lastUpdatedBrightness&&s&&Math.abs(this._lastUpdatedBrightness-s)<.001||(this._lastUpdatedBrightness=s,this.updateBuckets(void 0,n)))}queryRenderedFeatures(e,n,i,s,l,u,h,f){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({tileResult:s,pixelPosMatrix:h,transform:u,params:l,tileTransform:this.tileTransform},e,n,i):{}}querySourceFeatures(e,n){const i=this.latestFeatureIndex;if(!i||!i.rawTileData)return;const s=i.loadVTLayers(),l=n?n.sourceLayer:"",u=s._geojsonTileLayer||s[l];if(!u)return;const h=ju(n&&n.filter),{z:f,x:m,y}=this.tileID.canonical,v={z:f,x:m,y};for(let w=0;w<u.length;w++){const S=u.feature(w);if(h.needGeometry){const M=mh(S,!0);if(!h.filter(new Nr(this.tileID.overscaledZ),M,this.tileID.canonical))continue}else if(!h.filter(new Nr(this.tileID.overscaledZ),S))continue;const E=i.getId(S,l),A=new N3(S,f,m,y,E);A.tile=v,e.push(A)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}bucketsLoaded(){for(const e in this.buckets)if(this.buckets[e].uploadPending())return!1;return!0}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(e){const n=this.expirationTime;if(e.cacheControl){const i=wt(e.cacheControl);i["max-age"]&&(this.expirationTime=Date.now()+1e3*i["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){const i=Date.now();let s=!1;if(this.expirationTime>i)s=!1;else if(n)if(this.expirationTime<n)s=!0;else{const l=this.expirationTime-n;l?this.expirationTime=i+Math.max(l,3e4):s=!0}else s=!0;s?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(e,n){this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&Object.keys(e).length!==0&&n&&this.updateBuckets(e,n)}updateBuckets(e,n){if(!this.latestFeatureIndex)return;const i=this.latestFeatureIndex.loadVTLayers(),s=n.style.listImages(),l=n.style.getBrightness();for(const u in this.buckets){if(!n.style.hasLayer(u))continue;const h=this.buckets[u],f=h.layers[0].sourceLayer||"_geojsonTileLayer",m=i[f];let y={};if(e&&(y=e[f],!m||!y||Object.keys(y).length===0))continue;if(h.update(y,m,s,this.imageAtlas&&this.imageAtlas.patternPositions||{},l),h instanceof ix||h instanceof z1){const w=n.style._getSourceCache(h.layers[0].source);n._terrain&&n._terrain.enabled&&w&&h.programConfigurations.needsUpload&&n._terrain._clearRenderCacheForTile(w.id,this.tileID)}const v=n&&n.style&&n.style.getLayer(u);v&&(this.queryPadding=Math.max(this.queryPadding,v.queryRadius(h)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<mn.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(e){this.symbolFadeHoldUntil=mn.now()+e}setTexture(e,n){const i=n.context,s=i.gl;this.texture=this.texture||n.getTileTexture(e.width),this.texture?this.texture.update(e,{useMipmap:!0}):(this.texture=new Ai(i,e,s.RGBA,{useMipmap:!0}),this.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE))}setDependencies(e,n){const i={};for(const s of n)i[s]=!0;this.dependencies[e]=i}hasDependency(e,n){for(const i of e){const s=this.dependencies[i];if(s){for(const l of n)if(s[l])return!0}}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(e,n){if(!n||n.name==="mercator"||this._tileDebugBuffer)return;const i=nu(AI,this.tileID.canonical,this.tileTransform)[0],s=new Bo,l=new Ku;for(let u=0;u<i.length;u++){const{x:h,y:f}=i[u];s.emplaceBack(h,f),l.emplaceBack(u)}l.emplaceBack(0),this._tileDebugIndexBuffer=e.createIndexBuffer(l),this._tileDebugBuffer=e.createVertexBuffer(s,hh.members),this._tileDebugSegments=In.simpleSegment(0,0,s.length,l.length)}_makeTileBoundsBuffers(e,n){if(this._tileBoundsBuffer||!n||n.name==="mercator")return;const i=nu(AI,this.tileID.canonical,this.tileTransform)[0];let s,l;if(this.isRaster){const u=function(h,f){const m=hf(h,f),y=Math.pow(2,h.z);for(let M=0;M<iu;M++)for(let k=0;k<iu;k++){const R=Ls((h.x+(k+CI(k))/Aa)/y),L=Ci((h.y+(M+CI(M))/Aa)/y),z=f.project(R,L),B=M*iu+k;ou[2*B+0]=Math.round((z.x*m.scale-m.x)*Ge),ou[2*B+1]=Math.round((z.y*m.scale-m.y)*Ge)}bh.fill(0),ox.fill(0);for(let M=2045;M>=0;M--){const k=4*M,R=wh[k+0],L=wh[k+1],z=wh[k+2],B=wh[k+3],j=R+z>>1,V=L+B>>1,Y=j+V-L,ne=V+R-j,re=L*iu+R,J=B*iu+z,ae=V*iu+j,le=Math.hypot((ou[2*re+0]+ou[2*J+0])/2-ou[2*ae+0],(ou[2*re+1]+ou[2*J+1])/2-ou[2*ae+1])>=16;bh[ae]=bh[ae]||(le?1:0),M<1022&&(bh[ae]=bh[ae]||bh[(L+ne>>1)*iu+(R+Y>>1)]||bh[(B+ne>>1)*iu+(z+Y>>1)])}const v=new ql,w=new di;let S=0;function E(M,k){const R=k*iu+M;return ox[R]===0&&(v.emplaceBack(ou[2*R+0],ou[2*R+1],M*Ge/Aa,k*Ge/Aa),ox[R]=++S),ox[R]-1}function A(M,k,R,L,z,B){const j=M+R>>1,V=k+L>>1;if(Math.abs(M-z)+Math.abs(k-B)>1&&bh[V*iu+j])A(z,B,M,k,j,V),A(R,L,z,B,j,V);else{const Y=E(M,k),ne=E(R,L),re=E(z,B);w.emplaceBack(Y,ne,re)}}return A(0,0,Aa,Aa,Aa,0),A(Aa,Aa,0,0,0,Aa),{vertices:v,indices:w}}(this.tileID.canonical,n);s=u.vertices,l=u.indices}else{s=new ql,l=new di;for(const{x:h,y:f}of i)s.emplaceBack(h,f,0,0);const u=O1(s.int16,void 0,4);for(let h=0;h<u.length;h+=3)l.emplaceBack(u[h],u[h+1],u[h+2])}this._tileBoundsBuffer=e.createVertexBuffer(s,US.members),this._tileBoundsIndexBuffer=e.createIndexBuffer(l),this._tileBoundsSegments=In.simpleSegment(0,0,s.length,l.length)}_makeGlobeTileDebugBuffers(e,n){const i=n.projection;if(!i||i.name!=="globe"||n.freezeTileCoverage)return;const s=this.tileID.canonical,l=pm(e3(s,n)),u=ro(n.zoom);let h;u>0&&(h=Me.invert(new Float64Array(16),n.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(e,s,n,l,h,u),this._makeGlobeTileDebugTextBuffer(e,s,n,l,h,u)}_globePoint(e,n,i,s,l,u,h){let f=l_(e,n,i);if(u){const m=1<<i.z,y=io(s.center.lng),v=co(s.center.lat),w=(i.x+.5)/m-y;let S=0;w>.5?S=-1:w<-.5&&(S=1);let E=(e/Ge+i.x)/m+S,A=(n/Ge+i.y)/m;E=(E-y)*s._pixelsPerMercatorPixel+y,A=(A-v)*s._pixelsPerMercatorPixel+v;const M=[E*s.worldSize,A*s.worldSize,0];fe.transformMat4(M,M,u),f=nc(f,M,h)}return fe.transformMat4(f,f,l)}_makeGlobeTileDebugBorderBuffer(e,n,i,s,l,u){const h=new Bo,f=new Ku,m=new Xu,y=(w,S,E,A,M)=>{const k=(E-w)/(M-1),R=(A-S)/(M-1),L=h.length;for(let z=0;z<M;z++){const B=w+z*k,j=S+z*R;h.emplaceBack(B,j);const V=this._globePoint(B,j,n,i,s,l,u);m.emplaceBack(V[0],V[1],V[2]),f.emplaceBack(L+z)}},v=Ge;y(0,0,v,0,16),y(v,0,v,v,16),y(v,v,0,v,16),y(0,v,0,0,16),this._tileDebugIndexBuffer=e.createIndexBuffer(f),this._tileDebugBuffer=e.createVertexBuffer(h,hh.members),this._globeTileDebugBorderBuffer=e.createVertexBuffer(m,KM.members),this._tileDebugSegments=In.simpleSegment(0,0,h.length,f.length)}_makeGlobeTileDebugTextBuffer(e,n,i,s,l,u){const h=Ge/4,f=new Bo,m=new di,y=new Xu,v=25;m.reserve(32),f.reserve(v),y.reserve(v);const w=(S,E)=>v*S+E;for(let S=0;S<v;S++){const E=S*h;for(let A=0;A<v;A++){const M=A*h;f.emplaceBack(M,E);const k=this._globePoint(M,E,n,i,s,l,u);y.emplaceBack(k[0],k[1],k[2])}}for(let S=0;S<4;S++)for(let E=0;E<4;E++){const A=w(S,E),M=w(S,E+1),k=w(S+1,E),R=w(S+1,E+1);m.emplaceBack(A,M,k),m.emplaceBack(k,M,R)}this._tileDebugTextIndexBuffer=e.createIndexBuffer(m),this._tileDebugTextBuffer=e.createVertexBuffer(f,hh.members),this._globeTileDebugTextBuffer=e.createVertexBuffer(y,KM.members),this._tileDebugTextSegments=In.simpleSegment(0,0,v,32)}}class Z6{constructor(e,n){this.max=e,this.onRemove=n,this.reset()}reset(){for(const e in this.data)for(const n of this.data[e])n.timeout&&clearTimeout(n.timeout),this.onRemove(n.value);return this.data={},this.order=[],this}add(e,n,i){const s=e.wrapped().key;this.data[s]===void 0&&(this.data[s]=[]);const l={value:n,timeout:void 0};if(i!==void 0&&(l.timeout=setTimeout(()=>{this.remove(e,l)},i)),this.data[s].push(l),this.order.push(s),this.order.length>this.max){const u=this._getAndRemoveByKey(this.order[0]);u&&this.onRemove(u)}return this}has(e){return e.wrapped().key in this.data}getAndRemove(e){return this.has(e)?this._getAndRemoveByKey(e.wrapped().key):null}_getAndRemoveByKey(e){const n=this.data[e].shift();return n.timeout&&clearTimeout(n.timeout),this.data[e].length===0&&delete this.data[e],this.order.splice(this.order.indexOf(e),1),n.value}getByKey(e){const n=this.data[e];return n?n[0].value:null}get(e){return this.has(e)?this.data[e.wrapped().key][0].value:null}remove(e,n){if(!this.has(e))return this;const i=e.wrapped().key,s=n===void 0?0:this.data[i].indexOf(n),l=this.data[i][s];return this.data[i].splice(s,1),l.timeout&&clearTimeout(l.timeout),this.data[i].length===0&&delete this.data[i],this.onRemove(l.value),this.order.splice(this.order.indexOf(i),1),this}setMaxSize(e){for(this.max=e;this.order.length>this.max;){const n=this._getAndRemoveByKey(this.order[0]);n&&this.onRemove(n)}return this}filter(e){const n=[];for(const i in this.data)for(const s of this.data[i])e(s.value)||n.push(s);for(const i of n)this.remove(i.value.tileID,i)}}class Sh{constructor(e,n,i,s){this.id=Sh.uniqueIdxCounter,Sh.uniqueIdxCounter++,this.context=e;const l=e.gl;this.buffer=l.createBuffer(),this.dynamicDraw=!!i,this.context.unbindVAO(),e.bindElementBuffer.set(this.buffer),l.bufferData(l.ELEMENT_ARRAY_BUFFER,n.arrayBuffer,this.dynamicDraw?l.DYNAMIC_DRAW:l.STATIC_DRAW),this.dynamicDraw||s||n.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(e){this.id=Sh.uniqueIdxCounter,Sh.uniqueIdxCounter++;const n=this.context.gl;this.context.unbindVAO(),this.bind(),n.bufferSubData(n.ELEMENT_ARRAY_BUFFER,0,e.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}Sh.uniqueIdxCounter=0;const X6={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class K6{constructor(e,n,i,s,l){this.length=n.length,this.attributes=i,this.itemSize=n.bytesPerElement,this.dynamicDraw=s,this.context=e;const u=e.gl;this.buffer=u.createBuffer(),e.bindVertexBuffer.set(this.buffer),u.bufferData(u.ARRAY_BUFFER,n.arrayBuffer,this.dynamicDraw?u.DYNAMIC_DRAW:u.STATIC_DRAW),this.dynamicDraw||l||n.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(e){const n=this.context.gl;this.bind(),n.bufferSubData(n.ARRAY_BUFFER,0,e.arrayBuffer)}enableAttributes(e,n){for(let i=0;i<this.attributes.length;i++){const s=n.attributes[this.attributes[i].name];s!==void 0&&e.enableVertexAttribArray(s)}}setVertexAttribPointers(e,n,i){for(let s=0;s<this.attributes.length;s++){const l=this.attributes[s],u=n.attributes[l.name];u!==void 0&&e.vertexAttribPointer(u,l.components,e[X6[l.type]],!1,this.itemSize,l.offset+this.itemSize*(i||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class Or{constructor(e){this.gl=e.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(e){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Y6 extends Or{getDefault(){return wn.transparent}set(e){const n=this.current;(e.r!==n.r||e.g!==n.g||e.b!==n.b||e.a!==n.a||this.dirty)&&(this.gl.clearColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)}}class Q6 extends Or{getDefault(){return 1}set(e){(e!==this.current||this.dirty)&&(this.gl.clearDepth(e),this.current=e,this.dirty=!1)}}class J6 extends Or{getDefault(){return 0}set(e){(e!==this.current||this.dirty)&&(this.gl.clearStencil(e),this.current=e,this.dirty=!1)}}class e8 extends Or{getDefault(){return[!0,!0,!0,!0]}set(e){const n=this.current;(e[0]!==n[0]||e[1]!==n[1]||e[2]!==n[2]||e[3]!==n[3]||this.dirty)&&(this.gl.colorMask(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}}class t8 extends Or{getDefault(){return!0}set(e){(e!==this.current||this.dirty)&&(this.gl.depthMask(e),this.current=e,this.dirty=!1)}}class n8 extends Or{getDefault(){return 255}set(e){(e!==this.current||this.dirty)&&(this.gl.stencilMask(e),this.current=e,this.dirty=!1)}}class r8 extends Or{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(e){const n=this.current;(e.func!==n.func||e.ref!==n.ref||e.mask!==n.mask||this.dirty)&&(this.gl.stencilFunc(e.func,e.ref,e.mask),this.current=e,this.dirty=!1)}}class i8 extends Or{getDefault(){const e=this.gl;return[e.KEEP,e.KEEP,e.KEEP]}set(e){const n=this.current;(e[0]!==n[0]||e[1]!==n[1]||e[2]!==n[2]||this.dirty)&&(this.gl.stencilOp(e[0],e[1],e[2]),this.current=e,this.dirty=!1)}}class o8 extends Or{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const n=this.gl;e?n.enable(n.STENCIL_TEST):n.disable(n.STENCIL_TEST),this.current=e,this.dirty=!1}}class s8 extends Or{getDefault(){return[0,1]}set(e){const n=this.current;(e[0]!==n[0]||e[1]!==n[1]||this.dirty)&&(this.gl.depthRange(e[0],e[1]),this.current=e,this.dirty=!1)}}class a8 extends Or{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const n=this.gl;e?n.enable(n.DEPTH_TEST):n.disable(n.DEPTH_TEST),this.current=e,this.dirty=!1}}class l8 extends Or{getDefault(){return this.gl.LESS}set(e){(e!==this.current||this.dirty)&&(this.gl.depthFunc(e),this.current=e,this.dirty=!1)}}class u8 extends Or{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const n=this.gl;e?n.enable(n.BLEND):n.disable(n.BLEND),this.current=e,this.dirty=!1}}class c8 extends Or{getDefault(){const e=this.gl;return[e.ONE,e.ZERO,e.ONE,e.ZERO]}set(e){const n=this.current;(e[0]!==n[0]||e[1]!==n[1]||e[2]!==n[2]||e[3]!==n[3]||this.dirty)&&(this.gl.blendFuncSeparate(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}}class h8 extends Or{getDefault(){return wn.transparent}set(e){const n=this.current;(e.r!==n.r||e.g!==n.g||e.b!==n.b||e.a!==n.a||this.dirty)&&(this.gl.blendColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)}}class d8 extends Or{getDefault(){return this.gl.FUNC_ADD}set(e){(e!==this.current||this.dirty)&&(this.gl.blendEquationSeparate(e,e),this.current=e,this.dirty=!1)}}class f8 extends Or{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const n=this.gl;e?n.enable(n.CULL_FACE):n.disable(n.CULL_FACE),this.current=e,this.dirty=!1}}class p8 extends Or{getDefault(){return this.gl.BACK}set(e){(e!==this.current||this.dirty)&&(this.gl.cullFace(e),this.current=e,this.dirty=!1)}}class m8 extends Or{getDefault(){return this.gl.CCW}set(e){(e!==this.current||this.dirty)&&(this.gl.frontFace(e),this.current=e,this.dirty=!1)}}let g8=class extends Or{getDefault(){return null}set(t){(t!==this.current||this.dirty)&&(this.gl.useProgram(t),this.current=t,this.dirty=!1)}};class y8 extends Or{getDefault(){return this.gl.TEXTURE0}set(e){(e!==this.current||this.dirty)&&(this.gl.activeTexture(e),this.current=e,this.dirty=!1)}}class _8 extends Or{getDefault(){const e=this.gl;return[0,0,e.drawingBufferWidth,e.drawingBufferHeight]}set(e){const n=this.current;(e[0]!==n[0]||e[1]!==n[1]||e[2]!==n[2]||e[3]!==n[3]||this.dirty)&&(this.gl.viewport(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}}class v8 extends Or{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const n=this.gl;n.bindFramebuffer(n.FRAMEBUFFER,e),this.current=e,this.dirty=!1}}class x8 extends Or{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const n=this.gl;n.bindRenderbuffer(n.RENDERBUFFER,e),this.current=e,this.dirty=!1}}class w8 extends Or{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const n=this.gl;n.bindTexture(n.TEXTURE_2D,e),this.current=e,this.dirty=!1}}class b8 extends Or{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const n=this.gl;n.bindBuffer(n.ARRAY_BUFFER,e),this.current=e,this.dirty=!1}}class S8 extends Or{getDefault(){return null}set(e){const n=this.gl;n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,e),this.current=e,this.dirty=!1}}class E8 extends Or{constructor(e){super(e),this.vao=e.extVertexArrayObject}getDefault(){return null}set(e){this.vao&&(e!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(e),this.current=e,this.dirty=!1)}}class T8 extends Or{getDefault(){return 4}set(e){if(e===this.current&&!this.dirty)return;const n=this.gl;n.pixelStorei(n.UNPACK_ALIGNMENT,e),this.current=e,this.dirty=!1}}class C8 extends Or{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const n=this.gl;n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e),this.current=e,this.dirty=!1}}class A8 extends Or{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const n=this.gl;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,e),this.current=e,this.dirty=!1}}class VS extends Or{constructor(e,n){super(e),this.context=e,this.parent=n}getDefault(){return null}}class M8 extends VS{setDirty(){this.dirty=!0}set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const n=this.gl;n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,e,0),this.current=e,this.dirty=!1}}class MI extends VS{attachment(){return this.gl.DEPTH_ATTACHMENT}set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const n=this.gl;n.framebufferRenderbuffer(n.FRAMEBUFFER,this.attachment(),n.RENDERBUFFER,e),this.current=e,this.dirty=!1}}class I8 extends VS{attachment(){return this.gl.DEPTH_ATTACHMENT}set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const n=this.gl;n.framebufferTexture2D(n.FRAMEBUFFER,this.attachment(),n.TEXTURE_2D,e,0),this.current=e,this.dirty=!1}}class k8 extends MI{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}class P8{constructor(e,n,i,s,l){this.context=e,this.width=n,this.height=i;const u=this.framebuffer=e.gl.createFramebuffer();s&&(this.colorAttachment=new M8(e,u)),l&&(this.depthAttachmentType=l,this.depthAttachment=l==="renderbuffer"?new MI(e,u):new I8(e,u))}destroy(){const e=this.context.gl;if(this.colorAttachment){const n=this.colorAttachment.get();n&&e.deleteTexture(n)}if(this.depthAttachment&&this.depthAttachmentType)if(this.depthAttachmentType==="renderbuffer"){const n=this.depthAttachment.get();n&&e.deleteRenderbuffer(n)}else{const n=this.depthAttachment.get();n&&e.deleteTexture(n)}e.deleteFramebuffer(this.framebuffer)}}class _n{constructor(e,n,i){this.func=e,this.mask=n,this.range=i}}_n.ReadOnly=!1,_n.ReadWrite=!0,_n.disabled=new _n(519,_n.ReadOnly,[0,1]);const $S=7680;class Nn{constructor(e,n,i,s,l,u){this.test=e,this.ref=n,this.mask=i,this.fail=s,this.depthFail=l,this.pass=u}}Nn.disabled=new Nn({func:519,mask:0},0,0,$S,$S,$S);const sx=771;class ur{constructor(e,n,i,s){this.blendFunction=e,this.blendColor=n,this.mask=i,this.blendEquation=s}}ur.Replace=[1,0,1,0],ur.disabled=new ur(ur.Replace,wn.transparent,[!1,!1,!1,!1]),ur.unblended=new ur(ur.Replace,wn.transparent,[!0,!0,!0,!0]),ur.alphaBlended=new ur([1,sx,1,sx],wn.transparent,[!0,!0,!0,!0]),ur.multiply=new ur([774,0,774,0],wn.transparent,[!0,!0,!0,!0]);const GS=1029,HS=2305;class Vn{constructor(e,n,i){this.enable=e,this.mode=n,this.frontFace=i}}Vn.disabled=new Vn(!1,GS,HS),Vn.backCCW=new Vn(!0,GS,HS),Vn.backCW=new Vn(!0,GS,2304),Vn.frontCW=new Vn(!0,1028,2304),Vn.frontCCW=new Vn(!0,1028,HS);class R8{constructor(e,n=!1){if(this.gl=e,this.isWebGL2=n,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),n){const i=e;this.extVertexArrayObject={createVertexArrayOES:i.createVertexArray.bind(e),deleteVertexArrayOES:i.deleteVertexArray.bind(e),bindVertexArrayOES:i.bindVertexArray.bind(e)}}this.clearColor=new Y6(this),this.clearDepth=new Q6(this),this.clearStencil=new J6(this),this.colorMask=new e8(this),this.depthMask=new t8(this),this.stencilMask=new n8(this),this.stencilFunc=new r8(this),this.stencilOp=new i8(this),this.stencilTest=new o8(this),this.depthRange=new s8(this),this.depthTest=new a8(this),this.depthFunc=new l8(this),this.blend=new u8(this),this.blendFunc=new c8(this),this.blendColor=new h8(this),this.blendEquation=new d8(this),this.cullFace=new f8(this),this.cullFaceSide=new p8(this),this.frontFace=new m8(this),this.program=new g8(this),this.activeTexture=new y8(this),this.viewport=new _8(this),this.bindFramebuffer=new v8(this),this.bindRenderbuffer=new x8(this),this.bindTexture=new w8(this),this.bindVertexBuffer=new b8(this),this.bindElementBuffer=new S8(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new E8(this),this.pixelStoreUnpack=new T8(this),this.pixelStoreUnpackPremultiplyAlpha=new C8(this),this.pixelStoreUnpackFlipY=new A8(this),this.extTextureFilterAnisotropic=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=e.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureFilterAnisotropicForceOff=!1,this.extStandardDerivativesForceOff=!1,this.extDebugRendererInfo=e.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=e.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=e.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),n||(this.extTextureHalfFloat=e.getExtension("OES_texture_half_float")),(n||this.extTextureHalfFloat&&e.getExtension("OES_texture_half_float_linear"))&&(this.extRenderToTextureHalfFloat=e.getExtension("EXT_color_buffer_half_float")),this.extStandardDerivatives=n||e.getExtension("OES_standard_derivatives"),this.extTimerQuery=e.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=e.getParameter(e.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(e,n,i){return new Sh(this,e,n,i)}createVertexBuffer(e,n,i,s){return new K6(this,e,n,i,s)}createRenderbuffer(e,n,i){const s=this.gl,l=s.createRenderbuffer();return this.bindRenderbuffer.set(l),s.renderbufferStorage(s.RENDERBUFFER,e,n,i),this.bindRenderbuffer.set(null),l}createFramebuffer(e,n,i,s){return new P8(this,e,n,i,s)}clear({color:e,depth:n,stencil:i,colorMask:s}){const l=this.gl;let u=0;e&&(u|=l.COLOR_BUFFER_BIT,this.clearColor.set(e),this.colorMask.set(s||[!0,!0,!0,!0])),n!==void 0&&(u|=l.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(n),this.depthMask.set(!0)),i!==void 0&&(u|=l.STENCIL_BUFFER_BIT,this.clearStencil.set(i),this.stencilMask.set(255)),l.clear(u)}setCullFace(e){e.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(e.mode),this.frontFace.set(e.frontFace))}setDepthMode(e){e.func!==this.gl.ALWAYS||e.mask?(this.depthTest.set(!0),this.depthFunc.set(e.func),this.depthMask.set(e.mask),this.depthRange.set(e.range)):this.depthTest.set(!1)}setStencilMode(e){e.test.func!==this.gl.ALWAYS||e.mask?(this.stencilTest.set(!0),this.stencilMask.set(e.mask),this.stencilOp.set([e.fail,e.depthFail,e.pass]),this.stencilFunc.set({func:e.test.func,ref:e.ref,mask:e.test.mask})):this.stencilTest.set(!1)}setColorMode(e){Se(e.blendFunction,ur.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(e.blendFunction),this.blendColor.set(e.blendColor),e.blendEquation?this.blendEquation.set(e.blendEquation):this.blendEquation.setDefault()),this.colorMask.set(e.mask)}unbindVAO(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)}}class _l extends Cr{constructor(e,n,i){super(),this.id=e,this._onlySymbols=i,n.on("data",s=>{s.dataType==="source"&&s.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&s.dataType==="source"&&s.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform))}),n.on("error",()=>{this._sourceErrored=!0}),this._source=n,this._tiles={},this._cache=new Z6(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=n.minTileCacheSize,this._maxTileCacheSize=n.maxTileCacheSize,this._loadedParentTiles={},this._coveredTiles={},this._state=new JN,this._isRaster=this._source.type==="raster"||this._source.type==="raster-dem"||this._source.type==="custom"&&this._source._dataType==="raster"}onAdd(e){this.map=e,this._minTileCacheSize=this._minTileCacheSize===void 0&&e?e._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=this._maxTileCacheSize===void 0&&e?e._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const e in this._tiles){const n=this._tiles[e];if(n.state!=="errored"&&(n.state!=="loaded"||!n.bucketsLoaded()))return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const e=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,e&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(e,n){return e.isSymbolTile=this._onlySymbols,this._source.loadTile(e,n)}_unloadTile(e){if(this._source.unloadTile)return this._source.unloadTile(e,()=>{})}_abortTile(e){if(this._source.abortTile)return this._source.abortTile(e,()=>{})}serialize(){return this._source.serialize()}prepare(e){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const n in this._tiles){const i=this._tiles[n];i.upload(e),i.prepare(this.map.style.imageManager,this.map?this.map.painter:null,this._source.scope)}}getIds(){return xt(this._tiles).map(e=>e.tileID).sort(II).map(e=>e.key)}getRenderableIds(e){const n=[];for(const i in this._tiles)this._isIdRenderable(+i,e)&&n.push(this._tiles[i]);return e?n.sort((i,s)=>{const l=i.tileID,u=s.tileID,h=new q(l.canonical.x,l.canonical.y)._rotate(this.transform.angle),f=new q(u.canonical.x,u.canonical.y)._rotate(this.transform.angle);return l.overscaledZ-u.overscaledZ||f.y-h.y||f.x-h.x}).map(i=>i.tileID.key):n.map(i=>i.tileID).sort(II).map(i=>i.key)}hasRenderableParent(e){const n=this.findLoadedParent(e,0);return!!n&&this._isIdRenderable(n.tileID.key)}_isIdRenderable(e,n){return this._tiles[e]&&this._tiles[e].hasData()&&!this._coveredTiles[e]&&(n||!this._tiles[e].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const e in this._tiles)this._tiles[e].state!=="errored"&&this._reloadTile(+e,"reloading")}}_reloadTile(e,n){const i=this._tiles[e];i&&(i.state!=="loading"&&(i.state=n),this._loadTile(i,this._tileLoaded.bind(this,i,e,n)))}_tileLoaded(e,n,i,s){if(s)if(e.state="errored",s.status!==404)this._source.fire(new en(s,{tile:e}));else if(this._source.type==="raster-dem"&&this.usedForTerrain&&this.map.painter.terrain){const l=this.map.painter.terrain;this.update(this.transform,l.getScaledDemTileSize(),!0),l.resetTileLookupCache(this.id)}else this.update(this.transform);else e.timeAdded=mn.now(),i==="expired"&&(e.refreshedUponExpiration=!0),this._setTileReloadTimer(n,e),this._source.type==="raster-dem"&&e.dem&&this._backfillDEM(e),this._state.initializeTileState(e,this.map?this.map.painter:null),this._source.fire(new ct("data",{dataType:"source",tile:e,coord:e.tileID,sourceCacheId:this.id}))}_backfillDEM(e){const n=this.getRenderableIds();for(let s=0;s<n.length;s++){const l=n[s];if(e.neighboringTiles&&e.neighboringTiles[l]){const u=this.getTileByID(l);i(e,u),i(u,e)}}function i(s,l){if(!s.dem||s.dem.borderReady)return;s.needsHillshadePrepare=!0,s.needsDEMTextureUpload=!0;let u=l.tileID.canonical.x-s.tileID.canonical.x;const h=l.tileID.canonical.y-s.tileID.canonical.y,f=Math.pow(2,s.tileID.canonical.z),m=l.tileID.key;u===0&&h===0||Math.abs(h)>1||(Math.abs(u)>1&&(Math.abs(u+f)===1?u+=f:Math.abs(u-f)===1&&(u-=f)),l.dem&&s.dem&&(s.dem.backfillBorder(l.dem,u,h),s.neighboringTiles&&s.neighboringTiles[m]&&(s.neighboringTiles[m].backfilled=!0)))}}getTile(e){return this.getTileByID(e.key)}getTileByID(e){return this._tiles[e]}_retainLoadedChildren(e,n,i,s){for(const l in this._tiles){let u=this._tiles[l];if(s[l]||!u.hasData()||u.tileID.overscaledZ<=n||u.tileID.overscaledZ>i)continue;let h=u.tileID;for(;u&&u.tileID.overscaledZ>n+1;){const m=u.tileID.scaledTo(u.tileID.overscaledZ-1);u=this._tiles[m.key],u&&u.hasData()&&(h=m)}let f=h;for(;f.overscaledZ>n;)if(f=f.scaledTo(f.overscaledZ-1),e[f.key]){s[h.key]=h;break}}}findLoadedParent(e,n){if(e.key in this._loadedParentTiles){const i=this._loadedParentTiles[e.key];return i&&i.tileID.overscaledZ>=n?i:null}for(let i=e.overscaledZ-1;i>=n;i--){const s=e.scaledTo(i),l=this._getLoadedTile(s);if(l)return l}}_getLoadedTile(e){const n=this._tiles[e.key];return n&&n.hasData()?n:this._cache.getByKey(this._source.reparseOverscaled?e.wrapped().key:e.canonical.key)}updateCacheSize(e,n){n=n||this._source.tileSize;const i=Math.ceil(e.width/n)+1,s=Math.ceil(e.height/n)+1,l=Math.floor(i*s*5),u=typeof this._minTileCacheSize=="number"?Math.max(this._minTileCacheSize,l):l,h=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,u):u;this._cache.setMaxSize(h)}handleWrapJump(e){const n=Math.round((e-(this._prevLng===void 0?e:this._prevLng))/360);if(this._prevLng=e,n){const i={};for(const s in this._tiles){const l=this._tiles[s];l.tileID=l.tileID.unwrapTo(l.tileID.wrap+n),i[l.tileID.key]=l}this._tiles=i;for(const s in this._timers)clearTimeout(this._timers[s]),delete this._timers[s];for(const s in this._tiles)this._setTileReloadTimer(+s,this._tiles[s])}}update(e,n,i){if(this.transform=e,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!i)return;let s;this.updateCacheSize(e,n),this.transform.projection.name!=="globe"&&this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?s=e.getVisibleUnwrappedCoordinates(this._source.tileID).map(h=>new Ir(h.canonical.z,h.wrap,h.canonical.z,h.canonical.x,h.canonical.y)):(s=e.coveringTiles({tileSize:n||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!i,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.hasTile&&(s=s.filter(h=>this._source.hasTile(h)))):s=[];const l=this._updateRetainedTiles(s);if(kI(this._source.type)&&s.length!==0){const h={},f={},m=Object.keys(l);for(const v of m){const w=l[v],S=this._tiles[v];if(!S||S.fadeEndTime&&S.fadeEndTime<=mn.now())continue;const E=this.findLoadedParent(w,Math.max(w.overscaledZ-_l.maxOverzooming,this._source.minzoom));E&&(this._addTile(E.tileID),h[E.tileID.key]=E.tileID),f[v]=w}const y=s[s.length-1].overscaledZ;for(const v in this._tiles){const w=this._tiles[v];if(l[v]||!w.hasData())continue;let S=w.tileID;for(;S.overscaledZ>y;){S=S.scaledTo(S.overscaledZ-1);const E=this._tiles[S.key];if(E&&E.hasData()&&f[S.key]){l[v]=w.tileID;break}}}for(const v in h)l[v]||(this._coveredTiles[v]=!0,l[v]=h[v])}for(const h in l)this._tiles[h].clearFadeHold();const u=function(h,f){const m=[];for(const y in h)y in f||m.push(y);return m}(this._tiles,l);for(const h of u){const f=this._tiles[h];f.hasSymbolBuckets&&!f.holdingForFade()?f.setHoldDuration(this.map._fadeDuration):f.hasSymbolBuckets&&!f.symbolFadeFinished()||this._removeTile(+h)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const e in this._tiles)this._tiles[e].holdingForFade()&&this._removeTile(+e)}_updateRetainedTiles(e){const n={};if(e.length===0)return n;const i={},s=e.reduce((m,y)=>Math.min(m,y.overscaledZ),1/0),l=e[0].overscaledZ,u=Math.max(l-_l.maxOverzooming,this._source.minzoom),h=Math.max(l+_l.maxUnderzooming,this._source.minzoom),f={};for(const m of e){const y=this._addTile(m);n[m.key]=m,y.hasData()||s<this._source.maxzoom&&(f[m.key]=m)}this._retainLoadedChildren(f,s,h,n);for(const m of e){let y=this._tiles[m.key];if(y.hasData())continue;if(m.canonical.z>=this._source.maxzoom){const w=m.children(this._source.maxzoom)[0],S=this.getTile(w);if(S&&S.hasData()){n[w.key]=w;continue}}else{const w=m.children(this._source.maxzoom);if(n[w[0].key]&&n[w[1].key]&&n[w[2].key]&&n[w[3].key])continue}let v=y.wasRequested();for(let w=m.overscaledZ-1;w>=u;--w){const S=m.scaledTo(w);if(i[S.key]||(i[S.key]=!0,y=this.getTile(S),!y&&v&&(y=this._addTile(S)),y&&(n[S.key]=S,v=y.wasRequested(),y.hasData())))break}}return n}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const e in this._tiles){const n=[];let i,s=this._tiles[e].tileID;for(;s.overscaledZ>0;){if(s.key in this._loadedParentTiles){i=this._loadedParentTiles[s.key];break}n.push(s.key);const l=s.scaledTo(s.overscaledZ-1);if(i=this._getLoadedTile(l),i)break;s=l}for(const l of n)this._loadedParentTiles[l]=i}}_addTile(e){let n=this._tiles[e.key];if(n)return n;n=this._cache.getAndRemove(e),n&&(this._setTileReloadTimer(e.key,n),n.tileID=e,this._state.initializeTileState(n,this.map?this.map.painter:null),this._cacheTimers[e.key]&&(clearTimeout(this._cacheTimers[e.key]),delete this._cacheTimers[e.key],this._setTileReloadTimer(e.key,n)));const i=!!n;if(!i){const s=this.map?this.map.painter:null;n=new E_(e,this._source.tileSize*e.overscaleFactor(),this.transform.tileZoom,s,this._isRaster),this._loadTile(n,this._tileLoaded.bind(this,n,e.key,n.state))}return n?(n.uses++,this._tiles[e.key]=n,i||this._source.fire(new ct("dataloading",{tile:n,coord:n.tileID,dataType:"source"})),n):null}_setTileReloadTimer(e,n){e in this._timers&&(clearTimeout(this._timers[e]),delete this._timers[e]);const i=n.getExpiryTimeout();i&&(this._timers[e]=setTimeout(()=>{this._reloadTile(e,"expired"),delete this._timers[e]},i))}_removeTile(e){const n=this._tiles[e];n&&(n.uses--,delete this._tiles[e],this._timers[e]&&(clearTimeout(this._timers[e]),delete this._timers[e]),n.uses>0||(n.hasData()&&n.state!=="reloading"?this._cache.add(n.tileID,n,n.getExpiryTimeout()):(n.aborted=!0,this._abortTile(n),this._unloadTile(n))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const e in this._tiles)this._removeTile(+e);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(e,n,i){const s=[],l=this.transform;if(!l)return s;const u=l.projection.name==="globe",h=io(l.center.lng);for(const f in this._tiles){const m=this._tiles[f];if(i&&m.clearQueryDebugViz(),m.holdingForFade())continue;let y;if(u){const v=m.tileID.canonical;if(v.z===0){const w=[Math.abs(ce(h,...T_(v,-1))-h),Math.abs(ce(h,...T_(v,1))-h)];y=[0,2*w.indexOf(Math.min(...w))-1]}else{const w=[Math.abs(ce(h,...T_(v,-1))-h),Math.abs(ce(h,...T_(v,0))-h),Math.abs(ce(h,...T_(v,1))-h)];y=[w.indexOf(Math.min(...w))-1]}}else y=[0];for(const v of y){const w=e.containsTile(m,l,n,v);w&&s.push(w)}}return s}getVisibleCoordinates(e){const n=this.getRenderableIds(e).map(i=>this._tiles[i].tileID);for(const i of n)i.projMatrix=this.transform.calculateProjMatrix(i.toUnwrapped());return n}hasTransition(){if(this._source.hasTransition())return!0;if(kI(this._source.type))for(const e in this._tiles){const n=this._tiles[e];if(n.fadeEndTime!==void 0&&n.fadeEndTime>=mn.now())return!0}return!1}setFeatureState(e,n,i){this._state.updateState(e=e||"_geojsonTileLayer",n,i)}removeFeatureState(e,n,i){this._state.removeFeatureState(e=e||"_geojsonTileLayer",n,i)}getFeatureState(e,n){return this._state.getState(e=e||"_geojsonTileLayer",n)}setDependencies(e,n,i){const s=this._tiles[e];s&&s.setDependencies(n,i)}reloadTilesForDependencies(e,n){for(const i in this._tiles)this._tiles[i].hasDependency(e,n)&&this._reloadTile(+i,"reloading");this._cache.filter(i=>!i.hasDependency(e,n))}_preloadTiles(e,n){if(!this._sourceLoaded){const h=()=>{this._sourceLoaded&&(this._source.off("data",h),this._preloadTiles(e,n))};return void this._source.on("data",h)}const i=new Map,s=Array.isArray(e)?e:[e],l=this.map.painter.terrain,u=this.usedForTerrain&&l?l.getScaledDemTileSize():this._source.tileSize;for(const h of s){const f=h.coveringTiles({tileSize:u,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const m of f)i.set(m.key,m);this.usedForTerrain&&h.updateElevation(!1)}$e(Array.from(i.values()),(h,f)=>{const m=new E_(h,this._source.tileSize*h.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(m,y=>{this._source.type==="raster-dem"&&m.dem&&this._backfillDEM(m),f(y,m)})},n)}}function II(t,e){const n=Math.abs(2*t.wrap)-+(t.wrap<0),i=Math.abs(2*e.wrap)-+(e.wrap<0);return t.overscaledZ-e.overscaledZ||i-n||e.canonical.y-t.canonical.y||e.canonical.x-t.canonical.x}function kI(t){return t==="raster"||t==="image"||t==="video"||t==="custom"}function T_(t,e){const n=1<<t.z;return[t.x/n+e,(t.x+1)/n+e]}_l.maxOverzooming=10,_l.maxUnderzooming=3;const D8=Kn([{name:"a_pos_3f",components:3,type:"Float32"}]),L8=Kn([{name:"a_color_3f",components:3,type:"Float32"}]),O8=Kn([{name:"a_color_4f",components:4,type:"Float32"}]),z8=Kn([{name:"a_uv_2f",components:2,type:"Float32"}]),F8=Kn([{name:"a_normal_3f",components:3,type:"Float32"}]);Kn([{name:"a_normal_matrix0",components:4,type:"Float32"},{name:"a_normal_matrix1",components:4,type:"Float32"},{name:"a_normal_matrix2",components:4,type:"Float32"},{name:"a_normal_matrix3",components:4,type:"Float32"}]);const B8=Kn([{name:"a_pbr",components:4,type:"Uint16"},{name:"a_heightBasedEmissiveStrength",components:3,type:"Float32"}]);class qS{constructor(e=0,n=0,i=0,s=0){if(isNaN(e)||e<0||isNaN(n)||n<0||isNaN(i)||i<0||isNaN(s)||s<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=e,this.bottom=n,this.left=i,this.right=s}interpolate(e,n,i){return n.top!=null&&e.top!=null&&(this.top=nn(e.top,n.top,i)),n.bottom!=null&&e.bottom!=null&&(this.bottom=nn(e.bottom,n.bottom,i)),n.left!=null&&e.left!=null&&(this.left=nn(e.left,n.left,i)),n.right!=null&&e.right!=null&&(this.right=nn(e.right,n.right,i)),this}getCenter(e,n){const i=ce((this.left+e-this.right)/2,0,e),s=ce((this.top+n-this.bottom)/2,0,n);return new q(i,s)}equals(e){return this.top===e.top&&this.bottom===e.bottom&&this.left===e.left&&this.right===e.right}clone(){return new qS(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function PI(t,e){const n=hr(t,3);Me.fromQuat(t,e),pr(t,3,n)}function WS(t,e){const n=uo.identity([]);return uo.rotateZ(n,n,-e),uo.rotateX(n,n,-t),n}function RI(t,e){const n=[t[0],t[1],0],i=[e[0],e[1],0];if(fe.length(n)>=1e-15){const u=fe.normalize([],n);fe.scale(i,u,fe.dot(i,u)),e[0]=i[0],e[1]=i[1]}const s=fe.cross([],e,t);if(fe.len(s)<1e-15)return null;const l=Math.atan2(-s[1],s[0]);return WS(Math.atan2(Math.sqrt(t[0]*t[0]+t[1]*t[1]),-t[2]),l)}class DI{constructor(e,n){this.position=e,this.orientation=n}get position(){return this._position}set position(e){if(e){const n=e instanceof Un?e:new Un(e[0],e[1],e[2]);this._renderWorldCopies&&(n.x=He(n.x,0,1)),this._position=n}else this._position=null}lookAtPoint(e,n){if(this.orientation=null,!this.position)return;const i=this.position,s=this._elevation?this._elevation.getAtPointOrZero(Un.fromLngLat(e)):0,l=Un.fromLngLat(e,s),u=[l.x-i.x,l.y-i.y,l.z-i.z];n||(n=[0,0,1]),n[2]=Math.abs(n[2]),this.orientation=RI(u,n)}setPitchBearing(e,n){this.orientation=WS(Be(e),Be(-n))}}class ax{constructor(e,n){this._transform=Me.identity([]),this.orientation=n,this.position=e}get mercatorPosition(){const e=this.position;return new Un(e[0],e[1],e[2])}get position(){const e=hr(this._transform,3);return[e[0],e[1],e[2]]}set position(e){var n;e&&pr(this._transform,3,[(n=e)[0],n[1],n[2],1])}get orientation(){return this._orientation}set orientation(e){this._orientation=e||uo.identity([]),e&&PI(this._transform,this._orientation)}getPitchBearing(){const e=this.forward(),n=this.right();return{bearing:Math.atan2(-n[1],n[0]),pitch:Math.atan2(Math.sqrt(e[0]*e[0]+e[1]*e[1]),-e[2])}}setPitchBearing(e,n){this._orientation=WS(e,n),PI(this._transform,this._orientation)}forward(){const e=hr(this._transform,2);return[-e[0],-e[1],-e[2]]}up(){const e=hr(this._transform,1);return[-e[0],-e[1],-e[2]]}right(){const e=hr(this._transform,0);return[e[0],e[1],e[2]]}getCameraToWorld(e,n){const i=new Float64Array(16);return Me.invert(i,this.getWorldToCamera(e,n)),i}getCameraToWorldMercator(){return this._transform}getWorldToCameraPosition(e,n,i){const s=this.position;fe.scale(s,s,-e);const l=new Float64Array(16);return Me.fromScaling(l,[i,i,i]),Me.translate(l,l,s),l[10]*=n,l}getWorldToCamera(e,n){const i=new Float64Array(16),s=new Float64Array(4),l=this.position;return uo.conjugate(s,this._orientation),fe.scale(l,l,-e),Me.fromQuat(i,s),Me.translate(i,i,l),i[1]*=-1,i[5]*=-1,i[9]*=-1,i[13]*=-1,i[8]*=n,i[9]*=n,i[10]*=n,i[11]*=n,i}getCameraToClipPerspective(e,n,i,s){const l=new Float64Array(16);return Me.perspective(l,e,n,i,s),l}getCameraToClipOrthographic(e,n,i,s,l,u){const h=new Float64Array(16);return Me.ortho(h,e,n,i,s,l,u),h}getDistanceToElevation(e,n=!1){const i=e===0?0:mr(e,n?Ci(this.position[1]):this.position[1]),s=this.forward();return(i-this.position[2])/s[2]}clone(){return new ax([...this.position],[...this.orientation])}}function LI(t,e){const n=C_(t.projection,t.zoom,t.width,t.height),i=function(l,u,h,f,m){const y=new sn(h.lng-180*Eh,h.lat),v=new sn(h.lng+180*Eh,h.lat),w=l.project(y.lng,y.lat),S=l.project(v.lng,v.lat),E=-Math.atan2(S.y-w.y,S.x-w.x),A=Un.fromLngLat(h);A.y=ce(A.y,-1+Eh,1-Eh);const M=A.toLngLat(),k=l.project(M.lng,M.lat),R=Un.fromLngLat(M);R.x+=Eh;const L=R.toLngLat(),z=l.project(L.lng,L.lat),B=FI(z.x-k.x,z.y-k.y,E),j=Un.fromLngLat(M);j.y+=Eh;const V=j.toLngLat(),Y=l.project(V.lng,V.lat),ne=FI(Y.x-k.x,Y.y-k.y,E),re=Math.abs(B.x)/Math.abs(ne.y),J=Me.identity([]);Me.rotateZ(J,J,-E*(1-(m?0:f)));const ae=Me.identity([]);return Me.scale(ae,ae,[1,1-(1-re)*f,1]),ae[4]=-ne.x/ne.y*f,Me.rotateZ(ae,ae,E),Me.multiply(ae,J,ae),ae}(t.projection,0,t.center,n,e),s=OI(t);return Me.scale(i,i,[s,s,1]),i}function OI(t){const e=t.projection,n=C_(t.projection,t.zoom,t.width,t.height),i=zI(e,t.center),s=zI(e,sn.convert(e.center));return Math.pow(2,i*n+(1-n)*s)}function C_(t,e,n,i,s=1/0){const l=t.range;if(!l)return 0;const u=Math.min(s,Math.max(n,i)),h=Math.log(u/1024)/Math.LN2;return De(l[0]+h,l[1]+h,e)}const Eh=1/4e4;function zI(t,e){const n=ce(e.lat,-xi,xi),i=new sn(e.lng-180*Eh,n),s=new sn(e.lng+180*Eh,n),l=t.project(i.lng,n),u=t.project(s.lng,n),h=Un.fromLngLat(i),f=Un.fromLngLat(s),m=u.x-l.x,y=u.y-l.y,v=f.x-h.x,w=f.y-h.y,S=Math.sqrt((v*v+w*w)/(m*m+y*y));return Math.log(S)/Math.LN2}function FI(t,e,n){const i=Math.cos(n),s=Math.sin(n);return{x:t*i-e*s,y:t*s+e*i}}function df(t,e,n){return e*(Ge/(t.tileSize*Math.pow(2,n-t.tileID.overscaledZ)))}const km={unknown:0,flipRequired:1,flipNotRequired:2},N8=Math.tan(85*Math.PI/180);function lx(t,e,n,i,s,l,u){const h=Me.create();if(n)if(l.name==="globe"){const f=function(m,y){const{x:v,y:w}=m.point,S=i3(v,w,m.worldSize/m._pixelsPerMercatorPixel,0,0);return Me.multiply(S,S,sS(ml(y)))}(s,e);Me.multiply(h,h,f)}else{const f=cm.invert([],u);h[0]=f[0],h[1]=f[1],h[4]=f[2],h[5]=f[3],i||Me.rotateZ(h,h,s.angle)}else Me.multiply(h,s.labelPlaneMatrix,t);return h}function BI(t,e,n,i,s,l,u){const h=lx(t,e,n,i,s,l,u);return l.name==="globe"&&n||(h[2]=h[6]=h[10]=h[14]=0),h}function NI(t,e,n,i,s,l,u){if(n){if(l.name==="globe"){const h=lx(t,e,n,i,s,l,u);return Me.invert(h,h),Me.multiply(h,t,h),h}{const h=Me.clone(t),f=Me.identity([]);return f[0]=u[0],f[1]=u[1],f[4]=u[2],f[5]=u[3],Me.multiply(h,h,f),i||Me.rotateZ(h,h,-s.angle),h}}return s.glCoordMatrix}function vl(t,e,n,i){const s=[t,e,n,1];n?xr.transformMat4(s,s,i):qI(s,s,i);const l=s[3];return s[0]/=l,s[1]/=l,s[2]/=l,s}function jI(t,e){return Math.min(.5+t/e*.5,1.5)}function j8(t,e){const n=t[0]/t[3],i=t[1]/t[3];return n>=-e[0]&&n<=e[0]&&i>=-e[1]&&i<=e[1]}function U8(t,e,n,i,s,l,u,h,f,m){const y=n.transform,v=i?t.textSizeData:t.iconSizeData,w=ru(v,n.transform.zoom),S=y.projection.name==="globe",E=[256/n.width*2+1,256/n.height*2+1],A=i?t.text.dynamicLayoutVertexArray:t.icon.dynamicLayoutVertexArray;A.clear();let M=null;S&&(M=i?t.text.globeExtVertexArray:t.icon.globeExtVertexArray);const k=t.lineVertexArray,R=i?t.text.placedSymbolArray:t.icon.placedSymbolArray,L=n.transform.width/n.transform.height;let z,B=!1;for(let j=0;j<R.length;j++){const V=R.get(j),{numGlyphs:Y,writingMode:ne}=V;if(ne!==Gr.vertical||B||z===Gr.horizontal||(B=!0),z=ne,(V.hidden||ne===Gr.vertical)&&!B){Pm(Y,A);continue}B=!1;const re=new q(V.tileAnchorX,V.tileAnchorY);let{x:J,y:ae,z:le}=y.projection.projectTilePoint(re.x,re.y,m.canonical);if(f){const[yt,mt,lt]=f(re);J+=yt,ae+=mt,le+=lt}const oe=[J,ae,le,1];if(xr.transformMat4(oe,oe,e),!j8(oe,E)){Pm(Y,A);continue}const Ee=oe[3],xe=jI(n.transform.getCameraToCenterDistance(y.projection),Ee),Pe=p_(v,w,V),pe=u?Pe/xe:Pe*xe,Ae=vl(J,ae,le,s);if(Ae[3]<=0){Pm(Y,A);continue}let Le={};const qe=u?null:f,Ve=$I(V,pe,!1,h,e,s,l,t.glyphOffsetArray,k,A,M,Ae,re,Le,L,qe,y.projection,m,u);B=Ve.useVertical,qe&&Ve.needsFlipping&&(Le={}),(Ve.notEnoughRoom||B||Ve.needsFlipping&&$I(V,pe,!0,h,e,s,l,t.glyphOffsetArray,k,A,M,Ae,re,Le,L,qe,y.projection,m,u).notEnoughRoom)&&Pm(Y,A)}i?(t.text.dynamicLayoutVertexBuffer.updateData(A),M&&t.text.globeExtVertexBuffer&&t.text.globeExtVertexBuffer.updateData(M)):(t.icon.dynamicLayoutVertexBuffer.updateData(A),M&&t.icon.globeExtVertexBuffer&&t.icon.globeExtVertexBuffer.updateData(M))}function UI(t,e,n,i,s,l,u,h,f,m,y,v,w,S,E,A){const{lineStartIndex:M,glyphStartIndex:k,segment:R}=h,L=k+h.numGlyphs,z=M+h.lineLength,B=e.getoffsetX(k),j=e.getoffsetX(L-1),V=ux(t*B,n,i,s,l,u,R,M,z,f,m,y,v,w,!0,S,E,A);if(!V)return null;const Y=ux(t*j,n,i,s,l,u,R,M,z,f,m,y,v,w,!0,S,E,A);return Y?{first:V,last:Y}:null}function VI(t,e,n,i){return t===Gr.horizontal&&Math.abs(i)>Math.abs(n)?{useVertical:!0}:t===Gr.vertical?i>0?{needsFlipping:!0}:null:e!==km.unknown&&function(s,l){return s===0||Math.abs(l/s)>N8}(n,i)?e===km.flipRequired?{needsFlipping:!0}:null:n<0?{needsFlipping:!0}:null}function $I(t,e,n,i,s,l,u,h,f,m,y,v,w,S,E,A,M,k,R){const L=e/24,z=t.lineOffsetX*L,B=t.lineOffsetY*L,{lineStartIndex:j,glyphStartIndex:V,numGlyphs:Y,segment:ne,writingMode:re,flipState:J}=t,ae=j+t.lineLength,le=oe=>{if(y){const[pe,Ae,Le]=oe.up,qe=m.length;nx(y,qe+0,pe,Ae,Le),nx(y,qe+1,pe,Ae,Le),nx(y,qe+2,pe,Ae,Le),nx(y,qe+3,pe,Ae,Le)}const[Ee,xe,Pe]=oe.point;Im(m,Ee,xe,Pe,oe.angle)};if(Y>1){const oe=UI(L,h,z,B,n,v,w,t,f,l,S,A,!1,M,k,R);if(!oe)return{notEnoughRoom:!0};if(i&&!n){let[Ee,xe,Pe]=oe.first.point,[pe,Ae,Le]=oe.last.point;[Ee,xe]=vl(Ee,xe,Pe,u),[pe,Ae]=vl(pe,Ae,Le,u);const qe=VI(re,J,(pe-Ee)*E,Ae-xe);if(t.flipState=qe&&qe.needsFlipping?km.flipRequired:km.flipNotRequired,qe)return qe}le(oe.first);for(let Ee=V+1;Ee<V+Y-1;Ee++){const xe=ux(L*h.getoffsetX(Ee),z,B,n,v,w,ne,j,ae,f,l,S,A,!1,!1,M,k,R);if(!xe)return m.length-=4*(Ee-V),{notEnoughRoom:!0};le(xe)}le(oe.last)}else{if(i&&!n){const Ee=vl(w.x,w.y,0,s),xe=j+ne+1,Pe=new q(f.getx(xe),f.gety(xe)),pe=vl(Pe.x,Pe.y,0,s),Ae=pe[3]>0?pe:HI(w,Pe,Ee,1,s,void 0,M,k.canonical),Le=VI(re,J,(Ae[0]-Ee[0])*E,Ae[1]-Ee[1]);if(t.flipState=Le&&Le.needsFlipping?km.flipRequired:km.flipNotRequired,Le)return Le}const oe=ux(L*h.getoffsetX(V),z,B,n,v,w,ne,j,ae,f,l,S,A,!1,!1,M,k,R);if(!oe)return{notEnoughRoom:!0};le(oe)}return{}}function GI(t,e,n,i,s){const{x:l,y:u,z:h}=i.projectTilePoint(t.x,t.y,e);if(!s)return vl(l,u,h,n);const[f,m,y]=s(t);return vl(l+f,u+m,h+y,n)}function HI(t,e,n,i,s,l,u,h){const f=GI(t.sub(e)._unit()._add(t),h,s,u,l);return fe.sub(f,n,f),fe.normalize(f,f),fe.scaleAndAdd(f,n,f,i)}function ux(t,e,n,i,s,l,u,h,f,m,y,v,w,S,E,A,M,k){const R=i?t-e:t+e;let L=R>0?1:-1,z=0;i&&(L*=-1,z=Math.PI),L<0&&(z+=Math.PI);let B=h+u+(L>0?0:1)|0,j=s,V=s,Y=0,ne=0;const re=Math.abs(R),J=[],ae=[];let le=l,oe=le;const Ee=()=>HI(oe,le,V,re-Y+1,y,w,A,M.canonical);for(;Y+ne<=re;){if(B+=L,B<h||B>=f)return null;if(V=j,oe=le,J.push(V),S&&ae.push(oe),le=new q(m.getx(B),m.gety(B)),j=v[B],!j){const mt=GI(le,M.canonical,y,A,w);j=mt[3]>0?v[B]=mt:Ee()}Y+=ne,ne=fe.distance(V,j)}E&&w&&(v[B]&&(j=Ee(),ne=fe.distance(V,j)),v[B]=j);const xe=(re-Y)/ne,Pe=le.sub(oe)._mult(xe)._add(oe),pe=fe.sub([],j,V),Ae=fe.scaleAndAdd([],V,pe,xe);let Le=[0,0,1],qe=pe[0],Ve=pe[1];if(k&&(Le=A.upVector(M.canonical,Pe.x,Pe.y),Le[0]!==0||Le[1]!==0||Le[2]!==1)){const mt=[Le[2],0,-Le[0]],lt=fe.cross([],Le,mt);fe.normalize(mt,mt),fe.normalize(lt,lt),qe=fe.dot(pe,mt),Ve=fe.dot(pe,lt)}if(n){const mt=fe.cross([],Le,pe);fe.normalize(mt,mt),fe.scaleAndAdd(Ae,Ae,mt,n*L)}const yt=z+Math.atan2(Ve,qe);return J.push(Ae),S&&ae.push(Pe),{point:Ae,angle:yt,path:J,tilePath:ae,up:Le}}function Pm(t,e){const n=e.length,i=n+4*t;e.resize(i),e.float32.fill(-1/0,4*n,4*i)}function qI(t,e,n){const i=e[0],s=e[1];return t[0]=n[0]*i+n[4]*s+n[12],t[1]=n[1]*i+n[5]*s+n[13],t[3]=n[3]*i+n[7]*s+n[15],t}const Rm=15,WI=(t,e,n)=>(1-n)*t+n*e,ZI=t=>t*t*t*t*t;class ZS{constructor(e,n,i,s,l,u,h){this.tileSize=512,this._renderWorldCopies=l===void 0||l,this._minZoom=e||0,this._maxZoom=n||22,this._minPitch=i??0,this._maxPitch=s??60,this.setProjection(u),this.setMaxBounds(h),this.width=0,this.height=0,this._center=new sn(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new qS,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._distanceTileDataCache={},this._camera=new ax,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._horizonShift=.1,this._orthographicProjectionAtLowPitch=!1}clone(){const e=new ZS(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return e._elevation=this._elevation,e._centerAltitude=this._centerAltitude,e._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,e.tileSize=this.tileSize,e.mercatorFromTransition=this.mercatorFromTransition,e.width=this.width,e.height=this.height,e.cameraElevationReference=this.cameraElevationReference,e._center=this._center,e._setZoom(this.zoom),e._seaLevelZoom=this._seaLevelZoom,e.angle=this.angle,e._fov=this._fov,e._pitch=this._pitch,e._nearZ=this._nearZ,e._farZ=this._farZ,e._averageElevation=this._averageElevation,e._unmodified=this._unmodified,e._edgeInsets=this._edgeInsets.clone(),e._camera=this._camera.clone(),e._calcMatrices(),e.freezeTileCoverage=this.freezeTileCoverage,e.frustumCorners=this.frustumCorners,e}get elevation(){return this._elevation}set elevation(e){this._elevation!==e&&(this._elevation=e,this._updateCameraOnTerrain(),this._calcMatrices())}updateElevation(e,n=!1){const i=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(this._seaLevelZoom==null||i)&&this._updateCameraOnTerrain(),(e||i)&&this._constrainCamera(n),this._calcMatrices()}getProjection(){return Pt(this.projection,["name","center","parallels"])}setProjection(e){this.projectionOptions=e||{name:"mercator"};const n=this.projection?this.getProjection():void 0;this.projection=Y1(this.projectionOptions);const i=!Se(n,this.getProjection());return i&&this._calcMatrices(),this.mercatorFromTransition=!1,i}setOrthographicProjectionAtLowPitch(e){return this._orthographicProjectionAtLowPitch!==e&&(this._orthographicProjectionAtLowPitch=e,this._calcMatrices(),!0)}setMercatorFromTransition(){const e=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=Y1({name:"mercator"});const n=e!==this.projection.name;return n&&this._calcMatrices(),n}get minZoom(){return this._minZoom}set minZoom(e){this._minZoom!==e&&(this._minZoom=e,this.zoom=Math.max(this.zoom,e))}get maxZoom(){return this._maxZoom}set maxZoom(e){this._maxZoom!==e&&(this._maxZoom=e,this.zoom=Math.min(this.zoom,e))}get minPitch(){return this._minPitch}set minPitch(e){this._minPitch!==e&&(this._minPitch=e,this.pitch=Math.max(this.pitch,e))}get maxPitch(){return this._maxPitch}set maxPitch(e){this._maxPitch!==e&&(this._maxPitch=e,this.pitch=Math.min(this.pitch,e))}get renderWorldCopies(){return this._renderWorldCopies&&this.projection.supportsWorldCopies===!0}set renderWorldCopies(e){e===void 0?e=!0:e===null&&(e=!1),this._renderWorldCopies=e}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const e=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(e))}get cameraWorldSize(){const e=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(e))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return mr(this.center.lat,this.cameraWorldSizeForFog)}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new q(this.width,this.height)}get bearing(){return He(this.rotation,-180,180)}set bearing(e){this.rotation=e}get rotation(){return-this.angle/Math.PI*180}set rotation(e){const n=-e*Math.PI/180;this.angle!==n&&(this._unmodified=!1,this.angle=n,this._calcMatrices(),this.rotationMatrix=cm.create(),cm.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(e){const n=ce(e,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==n&&(this._unmodified=!1,this._pitch=n,this._calcMatrices())}get aspect(){return this.width/this.height}get fov(){return this._fov/Math.PI*180}get fovX(){return this._fov}get fovY(){const e=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/e)}set fov(e){e=Math.max(.01,Math.min(60,e)),this._fov!==e&&(this._unmodified=!1,this._fov=Be(e),this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(e){this._averageElevation=e,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(e){const n=Math.min(Math.max(e,this.minZoom),this.maxZoom);this._zoom!==n&&(this._unmodified=!1,this._setZoom(n),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(e){this._zoom=e,this.scale=this.zoomScale(e),this.tileZoom=Math.floor(e),this.zoomFraction=e-this.tileZoom}_updateCameraOnTerrain(){if(!this._elevation||!this._elevation.isDataAvailableAtPoint(this.locationCoordinate(this.center)))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const e=this._elevation;this._centerAltitude=e.getAtPointOrZero(this.locationCoordinate(this.center)),this._centerAltitudeValidForExaggeration=e.exaggeration(),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){this._centerAltitudeValidForExaggeration!==void 0&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const e=this._elevation,n=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],i=this.horizonLineFromTop();let s=0,l=0;for(let u=0;u<n.length;u++){const h=new q(n[u][0]*this.width,i+n[u][1]*(this.height-i)),f=e.pointCoordinate(h);if(!f)continue;const m=1/Math.hypot(f[0]-this._camera.position[0],f[1]-this._camera.position[1]);s+=f[3]*m,l+=m}return l===0?NaN:s/l}get center(){return this._center}set center(e){e.lat===this._center.lat&&e.lng===this._center.lng||(this._unmodified=!1,this._center=e,this._terrainEnabled()&&(this.cameraElevationReference==="ground"?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(this._seaLevelZoom==null||!this._elevation)return;const e=this._seaLevelZoom,n=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),i=this.pixelsPerMeter/this.worldSize*n,s=this._mercatorZfromZoom(e),l=this._mercatorZfromZoom(this._maxZoom),u=Math.max(s-i,l);this._setZoom(this._zoomFromMercatorZ(u))}get padding(){return this._edgeInsets.toJSON()}set padding(e){this._edgeInsets.equals(e)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,e,1),this._calcMatrices())}computeZoomRelativeTo(e){const n=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,e.toAltitude()));let i;i=e.z<this._camera.position[2]?[n.x,n.y,n.z]:[e.x,e.y,e.z];const s=fe.length(fe.sub([],this._camera.position,i));return ce(this._zoomFromMercatorZ(s),this._minZoom,this._maxZoom)}setFreeCameraOptions(e){if(!this.height||!e.position&&!e.orientation)return;this._updateCameraState();let n=!1;if(e.orientation&&!uo.exactEquals(e.orientation,this._camera.orientation)&&(n=this._setCameraOrientation(e.orientation)),e.position){const i=[e.position.x,e.position.y,e.position.z];fe.exactEquals(i,this._camera.position)||(this._setCameraPosition(i),n=!0)}n&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const e=this._camera.position,n=new DI;return n.position=new Un(e[0],e[1],e[2]),n.orientation=this._camera.orientation,n._elevation=this.elevation,n._renderWorldCopies=this.renderWorldCopies,n}_setCameraOrientation(e){if(!uo.length(e))return!1;uo.normalize(e,e);const n=fe.transformQuat([],[0,0,-1],e),i=fe.transformQuat([],[0,-1,0],e);if(i[2]<0)return!1;const s=RI(n,i);return!!s&&(this._camera.orientation=s,!0)}_setCameraPosition(e){const n=this.zoomScale(this.minZoom)*this.tileSize,i=this.zoomScale(this.maxZoom)*this.tileSize,s=this.cameraToCenterDistance;e[2]=ce(e[2],s/i,s/n),this._camera.position=e}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(e){return this._edgeInsets.equals(e)}interpolatePadding(e,n,i){this._unmodified=!1,this._edgeInsets.interpolate(e,n,i),this._constrain(),this._calcMatrices()}coveringZoomLevel(e){const n=(e.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/e.tileSize));return Math.max(0,n)}getVisibleUnwrappedCoordinates(e){const n=[new uS(0,e)];if(this.renderWorldCopies){const i=this.pointCoordinate(new q(0,0)),s=this.pointCoordinate(new q(this.width,0)),l=this.pointCoordinate(new q(this.width,this.height)),u=this.pointCoordinate(new q(0,this.height)),h=Math.floor(Math.min(i.x,s.x,l.x,u.x)),f=Math.floor(Math.max(i.x,s.x,l.x,u.x)),m=1;for(let y=h-m;y<=f+m;y++)y!==0&&n.push(new uS(y,e))}return n}coveringTiles(e){let n=this.coveringZoomLevel(e);const i=n,s=this.elevation&&this.elevation.exaggeration(),l=s&&!e.isTerrainDEM,u=this.projection.name==="mercator";if(e.minzoom!==void 0&&n<e.minzoom)return[];e.maxzoom!==void 0&&n>e.maxzoom&&(n=e.maxzoom);const h=this.locationCoordinate(this.center),f=this.center.lat,m=1<<n,y=[m*h.x,m*h.y,0],v=this.projection.name==="globe",w=!v,S=hm.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,n,w),E=v?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),A=m*mr(1,this.center.lat),M=this._camera.position[2]/mr(1,this.center.lat),k=[m*E.x,m*E.y,M*(w?1:A)],R=v||s,L=this.cameraToCenterDistance/e.tileSize*(e.roundZoom?1:.502),z=this.pitch<=60&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace?n:0,B=e.isTerrainDEM&&this._elevation?1e4*this._elevation.exaggeration():this._centerAltitude,j=e.isTerrainDEM?-B:this._elevation?this._elevation.getMinElevationBelowMSL():0,V=this.projection.isReprojectedInTileSpace?OI(this):1,Y=pe=>{const Le=new Un(pe.x+25e-6,pe.y,pe.z),qe=new Un(pe.x,pe.y+25e-6,pe.z),Ve=pe.toLngLat(),yt=Le.toLngLat(),mt=qe.toLngLat(),lt=this.locationCoordinate(Ve),ft=this.locationCoordinate(yt),Mt=this.locationCoordinate(mt),Zt=Math.hypot(ft.x-lt.x,ft.y-lt.y),Gt=Math.hypot(Mt.x-lt.x,Mt.y-lt.y);return Math.sqrt(Zt*Gt)*V/25e-6},ne=pe=>{const Ae=B,Le=j;return{aabb:_I(this,m,0,0,0,pe,Le,Ae,this.projection),zoom:0,x:0,y:0,minZ:Le,maxZ:Ae,wrap:pe,fullyVisible:!1}},re=[];let J=[];const ae=n,le=e.reparseOverscaled?i:n,oe=pe=>pe*pe,Ee=oe((M-this._centerAltitude)*A),xe=pe=>{if(!this._elevation||!pe.tileID||!u)return;const Ae=this._elevation.getMinMaxForTile(pe.tileID),Le=pe.aabb;Ae?(Le.min[2]=Ae.min,Le.max[2]=Ae.max,Le.center[2]=(Le.min[2]+Le.max[2])/2):(pe.shouldSplit=Pe(pe),pe.shouldSplit||(Le.min[2]=Le.max[2]=Le.center[2]=this._centerAltitude))},Pe=pe=>{if(pe.zoom<z)return!0;if(pe.zoom===ae)return!1;if(pe.shouldSplit!=null)return pe.shouldSplit;const Ae=pe.aabb.distanceX(k),Le=pe.aabb.distanceY(k);let qe=Ee,Ve=1;if(v){qe=oe(pe.aabb.distanceZ(k));const lt=Math.pow(2,pe.zoom),ft=Ci((pe.y+1)/lt),Mt=Ci(pe.y/lt),Zt=Math.min(Math.max(f,ft),Mt),Gt=C1(Zt)/C1(f);if(Ve=Zt===f?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,Gt/this._mercatorScaleRatio),this.zoom<=a_&&pe.zoom===ae-1&&Gt>=.9)return!0}else if(l&&(qe=oe(pe.aabb.distanceZ(k)*A)),this.projection.isReprojectedInTileSpace&&i<=5){const lt=Math.pow(2,pe.zoom),ft=Y(new Un((pe.x+.5)/lt,(pe.y+.5)/lt));Ve=ft>.85?1:ft}const yt=Ae*Ae+Le*Le+qe,mt=oe((1<<ae-pe.zoom)*L*Ve*((lt,ft)=>{if(ft*oe(.707)<lt)return 1;const Mt=Math.sqrt(ft/lt);return Mt/(1.4144271570014144+(Math.pow(1.1,Mt-1.4144271570014144+1)-1)/(1.1-1)-1)})(Math.max(qe,Ee),yt));return yt<mt};if(this.renderWorldCopies)for(let pe=1;pe<=3;pe++)re.push(ne(-pe)),re.push(ne(pe));for(re.push(ne(0));re.length>0;){const pe=re.pop(),Ae=pe.x,Le=pe.y;let qe=pe.fullyVisible;const Ve=()=>this.projection.name==="globe"&&(pe.y===0||pe.y===(1<<pe.zoom)-1);if(!qe){let yt=R?pe.aabb.intersects(S):pe.aabb.intersectsFlat(S);if(yt===0&&Ve()){const mt=new rc(pe.zoom,Ae,Le);yt=iS(this,m,mt,!0).intersects(S)}if(yt===0)continue;qe=yt===2}if(pe.zoom!==ae&&Pe(pe))for(let yt=0;yt<4;yt++){const mt=(Ae<<1)+yt%2,lt=(Le<<1)+(yt>>1),ft={aabb:u?pe.aabb.quadrant(yt):_I(this,m,pe.zoom+1,mt,lt,pe.wrap,pe.minZ,pe.maxZ,this.projection),zoom:pe.zoom+1,x:mt,y:lt,wrap:pe.wrap,fullyVisible:qe,tileID:void 0,shouldSplit:void 0,minZ:pe.minZ,maxZ:pe.maxZ};l&&!v&&(ft.tileID=new Ir(pe.zoom+1===ae?le:pe.zoom+1,pe.wrap,pe.zoom+1,mt,lt),xe(ft)),re.push(ft)}else{const yt=pe.zoom===ae?le:pe.zoom;if(e.minzoom&&e.minzoom>yt)continue;if(!qe){let Mt=R?pe.aabb.intersectsPrecise(S):pe.aabb.intersectsPreciseFlat(S);if(Mt===0&&Ve()){const Zt=new rc(pe.zoom,Ae,Le);Mt=iS(this,m,Zt,!0).intersectsPrecise(S)}if(Mt===0)continue}const mt=y[0]-(.5+Ae+(pe.wrap<<pe.zoom))*(1<<n-pe.zoom),lt=y[1]-.5-Le,ft=pe.tileID?pe.tileID:new Ir(yt,pe.wrap,pe.zoom,Ae,Le);J.push({tileID:ft,distanceSq:mt*mt+lt*lt})}}if(this.fogCullDistSq){const pe=this.fogCullDistSq,Ae=this.horizonLineFromTop();J=J.filter(Le=>{const qe=[0,0,0,1],Ve=[Ge,Ge,0,1],yt=this.calculateFogTileMatrix(Le.tileID.toUnwrapped());xr.transformMat4(qe,qe,yt),xr.transformMat4(Ve,Ve,yt);const mt=function(Mt,Zt,Gt){let Ut=0;for(let Xt=0;Xt<2;++Xt)Mt[Xt]>0&&(Ut+=(Mt[Xt]-0)*(Mt[Xt]-0)),Zt[Xt]<0&&(Ut+=(0-Zt[Xt])*(0-Zt[Xt]));return Ut}(qe,Ve);if(mt===0)return!0;let lt=!1;const ft=this._elevation;if(ft&&mt>pe&&Ae!==0){const Mt=this.calculateProjMatrix(Le.tileID.toUnwrapped());let Zt;e.isTerrainDEM||(Zt=ft.getMinMaxForTile(Le.tileID)),Zt||(Zt={min:j,max:B});const Gt=function(Xt){const zn=Math.round((Xt+45+360)%360/90)%4;return _t[zn]}(this.rotation),Ut=[Gt[0]*Ge,Gt[1]*Ge,Zt.max];fe.transformMat4(Ut,Ut,Mt),lt=(1-Ut[1])*this.height*.5<Ae}return mt<pe||lt})}return J.sort((pe,Ae)=>pe.distanceSq-Ae.distanceSq).map(pe=>pe.tileID)}resize(e,n){this.width=e,this.height=n,this.pixelsToGLUnits=[2/e,-2/n],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(e){return Math.pow(2,e)}scaleZoom(e){return Math.log(e)/Math.LN2}project(e){const n=ce(e.lat,-xi,xi),i=this.projection.project(e.lng,n);return new q(i.x*this.worldSize,i.y*this.worldSize)}unproject(e){return this.projection.unproject(e.x/this.worldSize,e.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/mr(1,this.center.lat)/this.worldSize}setLocationAtPoint(e,n){let i,s;const l=this.centerPoint;if(this.projection.name==="globe"){const h=this.worldSize;i=(n.x-l.x)/h,s=(n.y-l.y)/h}else{const h=this.pointCoordinate(n),f=this.pointCoordinate(l);i=h.x-f.x,s=h.y-f.y}const u=this.locationCoordinate(e);this.setLocation(new Un(u.x-i,u.y-s))}setLocation(e){this.center=this.coordinateLocation(e),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(e){return this.projection.locationPoint(this,e)}locationPoint3D(e){return this.projection.locationPoint(this,e,!0)}pointLocation(e){return this.coordinateLocation(this.pointCoordinate(e))}pointLocation3D(e){return this.coordinateLocation(this.pointCoordinate3D(e))}locationCoordinate(e,n){const i=n?mr(n,e.lat):void 0,s=this.projection.project(e.lng,e.lat);return new Un(s.x,s.y,i)}coordinateLocation(e){return this.projection.unproject(e.x,e.y)}pointRayIntersection(e,n){const i=n??this._centerAltitude,s=[e.x,e.y,0,1],l=[e.x,e.y,1,1];xr.transformMat4(s,s,this.pixelMatrixInverse),xr.transformMat4(l,l,this.pixelMatrixInverse);const u=l[3];xr.scale(s,s,1/s[3]),xr.scale(l,l,1/u);const h=s[2],f=l[2];return{p0:s,p1:l,t:h===f?0:(i-h)/(f-h)}}screenPointToMercatorRay(e){const n=[e.x,e.y,0,1],i=[e.x,e.y,1,1];return xr.transformMat4(n,n,this.pixelMatrixInverse),xr.transformMat4(i,i,this.pixelMatrixInverse),xr.scale(n,n,1/n[3]),xr.scale(i,i,1/i[3]),n[2]=mr(n[2],this._center.lat)*this.worldSize,i[2]=mr(i[2],this._center.lat)*this.worldSize,xr.scale(n,n,1/this.worldSize),xr.scale(i,i,1/this.worldSize),new w1([n[0],n[1],n[2]],fe.normalize([],fe.sub([],i,n)))}rayIntersectionCoordinate(e){const{p0:n,p1:i,t:s}=e,l=mr(n[2],this._center.lat),u=mr(i[2],this._center.lat);return new Un(nn(n[0],i[0],s)/this.worldSize,nn(n[1],i[1],s)/this.worldSize,nn(l,u,s))}pointCoordinate(e,n=this._centerAltitude){return this.projection.pointCoordinate(this,e.x,e.y,n)}pointCoordinate3D(e){if(!this.elevation)return this.pointCoordinate(e);let n=this.projection.pointCoordinate3D(this,e.x,e.y);if(n)return new Un(n[0],n[1],n[2]);let i=0,s=this.horizonLineFromTop();if(e.y>s)return this.pointCoordinate(e);const l=.02*s,u=e.clone();for(let h=0;h<10&&s-i>l;h++){u.y=nn(i,s,.66);const f=this.projection.pointCoordinate3D(this,u.x,u.y);f?(s=u.y,n=f):i=u.y}return n?new Un(n[0],n[1],n[2]):this.pointCoordinate(e)}isPointAboveHorizon(e){return this.projection.isPointAboveHorizon(this,e)}isPointOnSurface(e){if(e.y<0||e.y>this.height||e.x<0||e.x>this.width)return!1;if(this.elevation||this.zoom>=dh)return!this.isPointAboveHorizon(e);const n=this.pointCoordinate(e);return n.y>=0&&n.y<=1}_coordinatePoint(e,n){const i=n&&this.elevation?this.elevation.getAtPointOrZero(e,this._centerAltitude):this._centerAltitude,s=[e.x*this.worldSize,e.y*this.worldSize,i+e.toAltitude(),1];return xr.transformMat4(s,s,this.pixelMatrix),s[3]>0?new q(s[0]/s[3],s[1]/s[3]):new q(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){const{top:e,left:n}=this._edgeInsets,i=this.height-this._edgeInsets.bottom,s=this.width-this._edgeInsets.right,l=this.pointLocation3D(new q(n,e)),u=this.pointLocation3D(new q(s,e)),h=this.pointLocation3D(new q(s,i)),f=this.pointLocation3D(new q(n,i));let m=Math.min(l.lng,u.lng,h.lng,f.lng),y=Math.max(l.lng,u.lng,h.lng,f.lng),v=Math.min(l.lat,u.lat,h.lat,f.lat),w=Math.max(l.lat,u.lat,h.lat,f.lat);const S=Math.pow(2,-this.zoom)/16*270,E=this.projection.name==="globe"?1:4,A=(M,k,R,L,z)=>{const B=(M+R)/2,j=(k+L)/2,V=new q(B,j),{lng:Y,lat:ne}=this.pointLocation3D(V),re=Math.max(0,m-Y,v-ne,Y-y,ne-w);m=Math.min(m,Y),y=Math.max(y,Y),v=Math.min(v,ne),w=Math.max(w,ne),(z<E||re>S)&&(A(M,k,B,j,z+1),A(B,j,R,L,z+1))};if(A(n,e,s,e,1),A(s,e,s,i,1),A(s,i,n,i,1),A(n,i,n,e,1),this.projection.name==="globe"){const[M,k]=function(R){const L=Me.identity(new Float64Array(16));Me.multiply(L,R.pixelMatrix,R.globeMatrix);const z=[0,Ta,0],B=[0,Ca,0];return fe.transformMat4(z,z,L),fe.transformMat4(B,B,L),[z[0]>0&&z[0]<=R.width&&z[1]>0&&z[1]<=R.height&&!T1(R,new sn(R.center.lat,90)),B[0]>0&&B[0]<=R.width&&B[1]>0&&B[1]<=R.height&&!T1(R,new sn(R.center.lat,-90))]}(this);M?(w=90,y=180,m=-180):k&&(v=-90,y=180,m=-180)}return new li(new sn(m,v),new sn(y,w))}_getBoundsRectangular(e,n){const{top:i,left:s}=this._edgeInsets,l=this.height-this._edgeInsets.bottom,u=this.width-this._edgeInsets.right,h=new q(s,i),f=new q(u,i),m=new q(u,l),y=new q(s,l);let v=this.pointCoordinate(h,e),w=this.pointCoordinate(f,e);const S=this.pointCoordinate(m,n),E=this.pointCoordinate(y,n),A=(M,k)=>(k.y-M.y)/(k.x-M.x);return v.y>1&&w.y>=0?v=new Un((1-E.y)/A(E,v)+E.x,1):v.y<0&&w.y<=1&&(v=new Un(-E.y/A(E,v)+E.x,0)),w.y>1&&v.y>=0?w=new Un((1-S.y)/A(S,w)+S.x,1):w.y<0&&v.y<=1&&(w=new Un(-S.y/A(S,w)+S.x,0)),new li().extend(this.coordinateLocation(v)).extend(this.coordinateLocation(w)).extend(this.coordinateLocation(E)).extend(this.coordinateLocation(S))}_getBoundsRectangularTerrain(){const e=this.elevation;if(!e.visibleDemTiles.length||e.isUsingMockSource())return this._getBoundsRectangular(0,0);const n=e.visibleDemTiles.reduce((i,s)=>{if(s.dem){const l=s.dem.tree;i.min=Math.min(i.min,l.minimums[0]),i.max=Math.max(i.max,l.maximums[0])}return i},{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(n.min*e.exaggeration(),n.max*e.exaggeration())}getBounds(){return this.projection.name==="mercator"||this.projection.name==="equirectangular"?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(e=!0){const n=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))+this.centerOffset.y,i=this.height/2-n*(1-this._horizonShift);return e?Math.max(0,i):i}getMaxBounds(){return this.maxBounds}setMaxBounds(e){this.maxBounds=e,this.minLat=-xi,this.maxLat=xi,this.minLng=-180,this.maxLng=180,e&&(this.minLat=e.getSouth(),this.maxLat=e.getNorth(),this.minLng=e.getWest(),this.maxLng=e.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=io(this.minLng)*this.tileSize,this.worldMaxX=io(this.maxLng)*this.tileSize,this.worldMinY=co(this.maxLat)*this.tileSize,this.worldMaxY=co(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(e,n){return this.projection.createTileMatrix(this,n,e)}calculateDistanceTileData(e){const n=e.key,i=this._distanceTileDataCache;if(i[n])return i[n];const s=e.canonical,l=1/this.height,u=this.cameraWorldSize,h=u/this.zoomScale(s.z),f=(s.x+Math.pow(2,s.z)*e.wrap)*h,m=s.y*h,y=this.point;y.x*=u/this.worldSize,y.y*=u/this.worldSize;const v=this.angle,w=Math.sin(-v),S=-Math.cos(-v);return i[n]={bearing:[w,S],center:[(y.x-f)*l,(y.y-m)*l],scale:h/Ge*l},i[n]}calculateFogTileMatrix(e){const n=e.key,i=this._fogTileMatrixCache;if(i[n])return i[n];const s=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,e);return Me.multiply(s,this.worldToFogMatrix,s),i[n]=new Float32Array(s),i[n]}calculateProjMatrix(e,n=!1){const i=e.key,s=n?this._alignedProjMatrixCache:this._projMatrixCache;if(s[i])return s[i];const l=this.calculatePosMatrix(e,this.worldSize);return Me.multiply(l,this.projection.isReprojectedInTileSpace?this.mercatorMatrix:n?this.alignedProjMatrix:this.projMatrix,l),s[i]=new Float32Array(l),s[i]}calculatePixelsToTileUnitsMatrix(e){const n=e.tileID.key,i=this._pixelsToTileUnitsCache;if(i[n])return i[n];const s=function(l,u){const{scale:h}=l.tileTransform,f=h*Ge/(l.tileSize*Math.pow(2,u.zoom-l.tileID.overscaledZ+l.tileID.canonical.z));return cm.scale(new Float32Array(4),u.inverseAdjustmentMatrix,[f,f])}(e,this);return i[n]=s,i[n]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if(this.projection.name==="globe"){const e=1/this.worldSize,n=Me.fromScaling([],[e,e,e]);return Me.multiply(n,n,this.globeMatrix),n}}recenterOnTerrain(){if(!this._elevation||this.projection.name==="globe")return;const e=this._elevation;this._updateCameraState();const n=mr(1,this._center.lat)*this.worldSize,i=this._computeCameraPosition(n),s=this._camera.forward(),l=mr(1,this._center.lat);i[2]/=l,s[2]/=l,fe.normalize(s,s);const u=e.raycast(i,s,e.exaggeration());if(u){const h=fe.scaleAndAdd([],i,s,u),f=new Un(h[0],h[1],mr(h[2],Ci(h[1]))),m=(f.z+fe.length([f.x-i[0],f.y-i[1],f.z-i[2]*l]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(m),this._centerAltitude=f.toAltitude(),this._center=this.coordinateLocation(f),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(e=!1){if(!this._elevation)return;const n=this._elevation,i=mr(1,this._center.lat)*this.worldSize,s=this._computeCameraPosition(i),l=n.getAtPointOrZero(new Un(...s)),u=this.pixelsPerMeter/this.worldSize*l,h=this._minimumHeightOverTerrain(),f=s[2]-u;if(f<=h)if(f<0||e){const m=this.locationCoordinate(this._center,this._centerAltitude),y=[s[0],s[1],m.z-s[2]],v=fe.length(y);y[2]-=(h-f)/this._pixelsPerMercatorPixel;const w=fe.length(y);if(w===0)return;fe.scale(y,y,v/w*this._pixelsPerMercatorPixel),this._camera.position=[s[0],s[1],m.z*this._pixelsPerMercatorPixel-y[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const e=this.projection.name==="globe"||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||e){const w=this.center;return w.lat=ce(w.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!e)&&(w.lng=ce(w.lng,this.minLng,this.maxLng)),this.center=w,void(this._constraining=!1)}const n=this._unmodified,{x:i,y:s}=this.point;let l=0,u=i,h=s;const f=this.width/2,m=this.height/2,y=this.worldMinY*this.scale,v=this.worldMaxY*this.scale;if(s-m<y&&(h=y+m),s+m>v&&(h=v-m),v-y<this.height&&(l=Math.max(l,this.height/(v-y)),h=(v+y)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const w=this.worldMinX*this.scale,S=this.worldMaxX*this.scale,E=this.worldSize/2-(w+S)/2;u=(i+E+this.worldSize)%this.worldSize-E,u-f<w&&(u=w+f),u+f>S&&(u=S-f),S-w<this.width&&(l=Math.max(l,this.width/(S-w)),u=(S+w)/2)}u===i&&h===s||(this.center=this.unproject(new q(u,h))),l&&(this.zoom+=this.scaleZoom(l)),this._constrainCamera(),this._unmodified=n,this._constraining=!1}_minZoomForBounds(){let e=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(e=Math.max(e,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),e}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const e=this.centerOffset,n=this.pixelsPerMeter;this.projection.name==="globe"&&(this._mercatorScaleRatio=mr(1,this.center.lat)/mr(1,45));const i=C_(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,i),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const s=this.projection.zAxisUnit==="meters"?n:1,l=this._camera.getWorldToCamera(this.worldSize,s);let u;const h=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);if(h[8]=2*-e.x/this.width,h[9]=2*e.y/this.height,this.projection.name!=="globe"&&this._orthographicProjectionAtLowPitch&&this.pitch<Rm){let Y=.5*this.height/Math.tan(this._fov/2)*1*Math.tan(.5*this._fov),ne=Y*this.aspect,re=-ne,J=-Y;ne-=e.x,re-=e.x,Y+=e.y,J+=e.y,u=this._camera.getCameraToClipOrthographic(re,ne,J,Y,this._nearZ,this._farZ),((ae,le,oe,Ee)=>{for(let xe=0;xe<16;xe++)ae[xe]=WI(le[xe],oe[xe],Ee)})(u,u,h,ZI(this.pitch>=Rm?1:this.pitch/Rm))}else u=h;const f=Me.mul([],h,l);let m=Me.mul([],u,l);if(this.projection.isReprojectedInTileSpace){const Y=this.locationCoordinate(this.center),ne=Me.identity([]);Me.translate(ne,ne,[Y.x*this.worldSize,Y.y*this.worldSize,0]),Me.multiply(ne,ne,LI(this)),Me.translate(ne,ne,[-Y.x*this.worldSize,-Y.y*this.worldSize,0]),Me.multiply(m,m,ne),Me.multiply(f,f,ne),this.inverseAdjustmentMatrix=function(re){const J=LI(re,!0);return cm.invert([],[J[0],J[1],J[4],J[5]])}(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];this.mercatorMatrix=Me.scale([],m,[this.worldSize,this.worldSize,this.worldSize/s,1]),this.projMatrix=m,this.invProjMatrix=Me.invert(new Float64Array(16),this.projMatrix);const y=Me.invert([],u);this.frustumCorners=eS.fromInvProjectionMatrix(y,this.horizonLineFromTop(),this.height);const v=new Float32Array(16);Me.identity(v),Me.scale(v,v,[1,-1,1]),Me.rotateX(v,v,this._pitch),Me.rotateZ(v,v,this.angle);const w=Me.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ);this.starsProjMatrix=Me.clone(w);const S=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;w[8]=2*-e.x/this.width,w[9]=2*(e.y+S)/this.height,this.skyboxMatrix=Me.multiply(v,w,v);const E=this.point,A=E.x,M=E.y,k=this.width%2/2,R=this.height%2/2,L=Math.cos(this.angle),z=Math.sin(this.angle),B=A-Math.round(A)+L*k+z*R,j=M-Math.round(M)+L*R+z*k,V=new Float64Array(m);if(Me.translate(V,V,[B>.5?B-1:B,j>.5?j-1:j,0]),this.alignedProjMatrix=V,m=Me.create(),Me.scale(m,m,[this.width/2,-this.height/2,1]),Me.translate(m,m,[1,-1,0]),this.labelPlaneMatrix=m,m=Me.create(),Me.scale(m,m,[1,-1,1]),Me.translate(m,m,[-1,-1,0]),Me.scale(m,m,[2/this.width,2/this.height,1]),this.glCoordMatrix=m,this.pixelMatrix=Me.multiply(new Float64Array(16),this.labelPlaneMatrix,f),this._calcFogMatrices(),this._distanceTileDataCache={},m=Me.invert(new Float64Array(16),this.pixelMatrix),!m)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=m,this.projection.name==="globe"||this.mercatorFromTransition){this.globeMatrix=function(ne){const{x:re,y:J}=ne.point,{lng:ae,lat:le}=ne._center;return i3(re,J,ne.worldSize,ae,le)}(this);const Y=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=fe.transformMat4(Y,Y,l),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=m;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const e=this.cameraWorldSizeForFog,n=this.cameraPixelsPerMeter,i=this._camera.position,s=1/this.height/this._pixelsPerMercatorPixel,l=[e,e,n];fe.scale(l,l,s),fe.scale(i,i,-1),fe.multiply(i,i,l);const u=Me.create();Me.translate(u,u,i),Me.scale(u,u,l),this.mercatorFogMatrix=u,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(e,n,s)}_computeCameraPosition(e){const n=(e=e||this.pixelsPerMeter)/this.pixelsPerMeter,i=this._camera.forward(),s=this.point,l=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*n-e/this.worldSize*this._centerAltitude;return[s.x/this.worldSize-i[0]*l,s.y/this.worldSize-i[1]*l,e/this.worldSize*this._centerAltitude-i[2]*l]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(e){const n=this._maxCameraBoundsDistance()*Math.cos(this._pitch),i=this._camera.position[2],s=e[2];let l=1;this.projection.wrap&&(this.center=this.center.wrap()),s>0&&(l=Math.min((n-i)/s,1)),this._camera.position=fe.scaleAndAdd([],this._camera.position,e,l),this._updateStateFromCamera()}_updateStateFromCamera(){const e=this._camera.position,n=this._camera.forward(),{pitch:i,bearing:s}=this._camera.getPitchBearing(),l=mr(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,u=this._mercatorZfromZoom(this._maxZoom)*Math.cos(Be(this._maxPitch)),h=Math.max((e[2]-l)/Math.cos(i),u),f=this._zoomFromMercatorZ(h);fe.scaleAndAdd(e,e,n,h),this._pitch=ce(i,Be(this.minPitch),Be(this.maxPitch)),this.angle=He(s,-Math.PI,Math.PI),this._setZoom(ce(f,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new Un(e[0],e[1],e[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(e){return Math.pow(2,e)*this.tileSize}_mercatorZfromZoom(e){return this.cameraToCenterDistance/this._worldSizeFromZoom(e)}_minimumHeightOverTerrain(){const e=Math.min((this._seaLevelZoom!=null?this._seaLevelZoom:this._zoom)+4,this._maxZoom);return this._mercatorZfromZoom(e)}_zoomFromMercatorZ(e){return this.scaleZoom(this.cameraToCenterDistance/(e*this.tileSize))}zoomFromMercatorZAdjusted(e){let n=0,i=dh,s=0,l=1/0;for(;i-n>1e-6&&i>n;){const u=n+.5*(i-n),h=this.tileSize*Math.pow(2,u),f=this.getCameraToCenterDistance(this.projection,u,h),m=this.scaleZoom(f/(e*this.tileSize)),y=Math.abs(u-m);y<l&&(l=y,s=u),u<m?n=u:i=u}return s}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(ye("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(e,n){const i=Math.min(e.x,n.x),s=Math.max(e.x,n.x),l=Math.min(e.y,n.y),u=Math.max(e.y,n.y);if(l<this.horizonLineFromTop(!1))return!0;if(this.projection.name!=="mercator")return!1;const h=[new q(i,l),new q(s,u),new q(i,u),new q(s,l)],f=this.renderWorldCopies?-3:0,m=this.renderWorldCopies?4:1;for(const y of h){const v=this.pointRayIntersection(y);if(v.t<0)return!0;const w=this.rayIntersectionCoordinate(v);if(w.x<f||w.y<0||w.x>m||w.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+rt(this.fovAboveCenter)>88||this.anyCornerOffEdge(new q(0,0),new q(this.width,this.height))}zoomDeltaToMovement(e,n){const i=fe.length(fe.sub([],this._camera.position,e)),s=this._zoomFromMercatorZ(i)+n;return i-this._mercatorZfromZoom(s)}getCameraPoint(){if(this.projection.name==="globe"){const e=function([n,i,s],l){const u=[n,i,s,1];xr.transformMat4(u,u,l);const h=u[3]=Math.max(u[3],1e-6);return u[0]/=h,u[1]/=h,u[2]/=h,u}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new q(e[0],e[1])}{const e=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new q(0,e))}}getCameraToCenterDistance(e,n=this.zoom,i=this.worldSize){const s=C_(e,n,this.width,this.height,1024),l=e.pixelSpaceConversion(this.center.lat,i,s);let u=.5/Math.tan(.5*this._fov)*this.height*l;return this._orthographicProjectionAtLowPitch&&this.projection.name!=="globe"&&this.pitch<Rm&&(u=WI(1,u,ZI(this.pitch>=Rm?1:this.pitch/Rm))),u}getWorldToCameraMatrix(){const e=this._camera.getWorldToCamera(this.worldSize,this.projection.zAxisUnit==="meters"?this.pixelsPerMeter:1);return this.projection.name==="globe"&&Me.multiply(e,e,this.globeMatrix),e}}function XI(t,e,n){Me.identity(t),Me.rotateZ(t,t,Be(e[2])),Me.rotateX(t,t,Be(e[0])),Me.rotateY(t,t,Be(e[1])),Me.scale(t,t,n),Me.multiply(t,t,[1,0,0,0,0,0,1,0,0,1,0,0,0,0,0,1])}function cx(t,e,n,i,s,l,u,h){const f=[n[0]-e[0],n[1]-e[1],0],m=[i[0]-e[0],i[1]-e[1],0];if(fe.length(f)<1e-12||fe.length(m)<1e-12)return uo.identity(t);const y=fe.cross([],f,m);fe.normalize(y,y),fe.subtract(m,i,e),f[2]=(l-s)*h,m[2]=(u-s)*h;const v=f;return fe.cross(v,f,m),fe.normalize(v,v),uo.rotationTo(t,y,v)}function KI(t,e,n=!1){const i=ro(e.zoom),s=function(l,u,h){const f=u.worldSize,m=[l[12],l[13],l[14]],y=Ci(m[1]/f),v=Ls(m[0]/f),w=Me.identity([]),S=mr(1,y)*f,E=mr(1,0)*f*ph(y,u.zoom),A=1/aS(f);let M=E*A;if(h){const z=C_(u.projection,u.zoom,u.width,u.height,1024);M=A*u.projection.pixelSpaceConversion(u.center.lat,f,z)}const k=ys(y,v);fe.add(k,k,fe.scale([],fe.normalize([],k),S*M*m[2]));const R=function(z){const B=[z[0],z[1],z[2]];let j=[0,1,0];const V=fe.cross([],j,B);return fe.cross(j,B,V),fe.squaredLength(j)===0&&(j=[0,1,0],fe.cross(V,B,j)),fe.normalize(V,V),fe.normalize(j,j),fe.normalize(B,B),[V[0],V[1],V[2],0,j[0],j[1],j[2],0,B[0],B[1],B[2],0,z[0],z[1],z[2],1]}(k);Me.scale(w,w,[M,M,M*S]),Me.translate(w,w,[-m[0],-m[1],-m[2]]);const L=Me.multiply([],u.globeMatrix,R);return Me.multiply(L,L,w),Me.multiply(L,L,l),L}(t,e,n);if(i>0){const l=function(u,h){const f=h.worldSize,m=mr(1,0)*f*ph(h.center.lat,h.zoom)/aS(f),y=mr(1,h.center.lat)*f,v=Me.identity([]);return Me.rotateY(v,v,Be(h.center.lng)),Me.rotateX(v,v,Be(h.center.lat)),Me.translate(v,v,[0,0,Ds]),Me.scale(v,v,[m,m,m*y]),Me.translate(v,v,[h.point.x-.5*f,h.point.y-.5*f,0]),Me.multiply(v,v,u),Me.multiply(v,h.globeMatrix,v)}(t,e);return function(u,h,f){const m=(E,A,M)=>{const k=fe.length(E),R=fe.length(A),L=nc(E,A,M);return fe.scale(L,L,1/fe.length(L)*nn(k,R,M))},y=m([u[0],u[1],u[2]],[h[0],h[1],h[2]],f),v=m([u[4],u[5],u[6]],[h[4],h[5],h[6]],f),w=m([u[8],u[9],u[10]],[h[8],h[9],h[10]],f),S=nc([u[12],u[13],u[14]],[h[12],h[13],h[14]],f);return[y[0],y[1],y[2],0,v[0],v[1],v[2],0,w[0],w[1],w[2],0,S[0],S[1],S[2],1]}(s,l,i)}return s}const V8=[1,1,1];class YI{constructor(e,n,i,s,l){this.id=e,this.uri=n,this.position=i!=null?new sn(i[0],i[1]):new sn(0,0),this.orientation=s??[0,0,0],this.nodes=l,this.uploaded=!1,this.aabb=new ri([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),this.matrix=[]}_applyTransformations(e,n){if(Me.multiply(e.matrix,n,e.matrix),e.meshes)for(const i of e.meshes){const s=ri.applyTransform(i.aabb,e.matrix);this.aabb.encapsulate(s)}if(e.children)for(const i of e.children)this._applyTransformations(i,e.matrix)}computeBoundsAndApplyParent(){const e=Me.identity([]);for(const n of this.nodes)this._applyTransformations(n,e)}_positionModelOnTerrain(e,n){const i=e.elevation;if(!i)return 0;const s=ri.projectAabbCorners(this.aabb,this.matrix),l=mr(1,this.position.lat)*e.worldSize,u=function(k,R){const L=[0,0,1],z=[{corners:[0,1,3,2],dotProductWithUp:0},{corners:[1,5,2,6],dotProductWithUp:0},{corners:[0,4,1,5],dotProductWithUp:0},{corners:[2,6,3,7],dotProductWithUp:0},{corners:[4,7,5,6],dotProductWithUp:0},{corners:[0,3,4,7],dotProductWithUp:0}];for(const B of z){const j=k[B.corners[0]],V=k[B.corners[1]],Y=k[B.corners[2]],ne=[V[0]-j[0],V[1]-j[1],R*(V[2]-j[2])],re=fe.cross(ne,ne,[Y[0]-j[0],Y[1]-j[1],R*(Y[2]-j[2])]);fe.normalize(re,re),B.dotProductWithUp=fe.dot(re,L)}return z.sort((B,j)=>B.dotProductWithUp-j.dotProductWithUp),z[0].corners}(s,l),h=s[u[0]],f=s[u[1]],m=s[u[2]],y=s[u[3]],v=i.getAtPointOrZero(new Un(h[0]/e.worldSize,h[1]/e.worldSize),0),w=i.getAtPointOrZero(new Un(f[0]/e.worldSize,f[1]/e.worldSize),0),S=i.getAtPointOrZero(new Un(m[0]/e.worldSize,m[1]/e.worldSize),0),E=i.getAtPointOrZero(new Un(y[0]/e.worldSize,y[1]/e.worldSize),0),A=(v+E)/2,M=(w+S)/2;return A>M?w<S?cx(n,f,y,h,w,E,v,l):cx(n,m,h,y,S,v,E,l):v<E?cx(n,h,f,m,v,w,S,l):cx(n,y,m,f,E,S,w,l),Math.max(A,M)}computeModelMatrix(e,n,i,s,l,u,h=!1){const f=e.transform,m=f.zoom,y=f.project(this.position),v=ph(this.position.lat,m),w=1/v;Me.identity(this.matrix),Me.translate(this.matrix,this.matrix,[y.x+s[0]*w,y.y+s[1]*w,s[2]]);let S=1,E=1;const A=f.worldSize;if(h){if(f.projection.name==="mercator"){let L=0;f.elevation&&(L=f.elevation.getAtPointOrZero(new Un(y.x/A,y.y/A),0));const z=xr.transformMat4([],[y.x,y.y,L,1],f.projMatrix)[3]/f.cameraToCenterDistance;S=z,E=z*ph(f.center.lat,m)}else if(f.projection.name==="globe"){const L=KI(this.matrix,f),z=Me.multiply([],f.projMatrix,L),B=[0,0,0,1];xr.transformMat4(B,B,z);const j=B[3]/f.cameraToCenterDistance,V=ro(m),Y=f.projection.pixelsPerMeter(this.position.lat,A)*ph(this.position.lat,m),ne=f.projection.pixelsPerMeter(f.center.lat,A)*ph(f.center.lat,m);S=j/nn(Y,h3(f.center.lat),V),E=j*v/Y,S*=ne,E*=ne}}else S=w;Me.scale(this.matrix,this.matrix,[S,S,E]);const M=[...this.matrix],k=this.orientation,R=[];if(XI(R,[k[0]+n[0],k[1]+n[1],k[2]+n[2]],i),Me.multiply(this.matrix,M,R),l&&f.elevation){let L=0;const z=[];if(u&&f.elevation){L=this._positionModelOnTerrain(f,z);const B=Me.fromQuat([],z),j=Me.multiply([],B,R);Me.multiply(this.matrix,M,j)}else L=f.elevation.getAtPointOrZero(new Un(y.x/A,y.y/A),0);L!==0&&(this.matrix[14]+=L)}}upload(e){if(!this.uploaded){for(const n of this.nodes)XS(n,e);for(const n of this.nodes)hx(n);this.uploaded=!0}}destroy(){for(const e of this.nodes)dx(e)}}function A_(t,e,n=!1){t.uploaded||(t.gfxTexture=new Ai(e,t.image,n?e.gl.R8:e.gl.RGBA,{useMipmap:t.sampler.mipmaps}),t.uploaded=!0,t.image=null)}function $8(t,e,n){t.indexBuffer=e.createIndexBuffer(t.indexArray,!1,!0),t.vertexBuffer=e.createVertexBuffer(t.vertexArray,D8.members,!1,!0),t.normalArray&&(t.normalBuffer=e.createVertexBuffer(t.normalArray,F8.members,!1,!0)),t.texcoordArray&&(t.texcoordBuffer=e.createVertexBuffer(t.texcoordArray,z8.members,!1,!0)),t.colorArray&&(t.colorBuffer=e.createVertexBuffer(t.colorArray,(t.colorArray.bytesPerElement===12?L8:O8).members,!1,!0)),t.featureArray&&(t.pbrBuffer=e.createVertexBuffer(t.featureArray,B8.members,!0)),t.segments=In.simpleSegment(0,0,t.vertexArray.length,t.indexArray.length);const i=t.material;i.pbrMetallicRoughness.baseColorTexture&&A_(i.pbrMetallicRoughness.baseColorTexture,e),i.pbrMetallicRoughness.metallicRoughnessTexture&&A_(i.pbrMetallicRoughness.metallicRoughnessTexture,e),i.normalTexture&&A_(i.normalTexture,e),i.occlusionTexture&&A_(i.occlusionTexture,e,n),i.emissionTexture&&A_(i.emissionTexture,e)}function XS(t,e,n){if(t.meshes)for(const i of t.meshes)$8(i,e,n);if(t.children)for(const i of t.children)XS(i,e,n)}function hx(t){if(t.meshes)for(const e of t.meshes)e.indexArray.destroy(),e.vertexArray.destroy(),e.colorArray&&e.colorArray.destroy(),e.normalArray&&e.normalArray.destroy(),e.texcoordArray&&e.texcoordArray.destroy(),e.featureArray&&e.featureArray.destroy();if(t.children)for(const e of t.children)hx(e)}function dx(t){if(t.meshes)for(const n of t.meshes)n.vertexBuffer&&(n.vertexBuffer.destroy(),n.indexBuffer.destroy(),n.normalBuffer&&n.normalBuffer.destroy(),n.texcoordBuffer&&n.texcoordBuffer.destroy(),n.colorBuffer&&n.colorBuffer.destroy(),n.pbrBuffer&&n.pbrBuffer.destroy(),n.segments.destroy(),n.material&&((e=n.material).pbrMetallicRoughness.baseColorTexture&&e.pbrMetallicRoughness.baseColorTexture.gfxTexture&&e.pbrMetallicRoughness.baseColorTexture.gfxTexture.destroy(),e.pbrMetallicRoughness.metallicRoughnessTexture&&e.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture&&e.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture.destroy(),e.normalTexture&&e.normalTexture.gfxTexture&&e.normalTexture.gfxTexture.destroy(),e.emissionTexture&&e.emissionTexture.gfxTexture&&e.emissionTexture.gfxTexture.destroy(),e.occlusionTexture&&e.occlusionTexture.gfxTexture&&e.occlusionTexture.gfxTexture.destroy()));var e;if(t.children)for(const n of t.children)dx(n)}class QI{constructor(e,n){this.feature=e,this.instancedDataOffset=n,this.instancedDataCount=0}}class JI{constructor(){this.instancedDataArray=new Hp,this.instancesEvaluatedElevation=[],this.features=[],this.idToFeaturesIndex={}}}class ek{constructor(e){this.zoom=e.zoom,this.canonical=e.canonical,this.layers=e.layers,this.layerIds=this.layers.map(n=>n.id),this.projection=e.projection,this.index=e.index,this.stateDependentLayerIds=this.layers.filter(n=>n.isStateDependent()).map(n=>n.id),this.hasPattern=!1,this.instancesPerModel={},this.validForExaggeration=0,this.maxVerticalOffset=0,this.maxScale=0,this.maxHeight=0,this.lookupDim=this.zoom>this.canonical.z?256:this.zoom>15?75:100,this.instanceCount=0,this.terrainElevationMin=0,this.terrainElevationMax=0}populate(e,n,i,s){this.tileToMeter=c_(i);const l=this.layers[0]._featureFilter.needGeometry;this.lookup=new Uint8Array(this.lookupDim*this.lookupDim);for(const{feature:u,id:h,index:f,sourceLayerIndex:m}of e){const y=mh(u,l);if(!this.layers[0]._featureFilter.filter(new Nr(this.zoom),y,i))continue;const v={id:h,sourceLayerIndex:m,index:f,geometry:l?y.geometry:nu(u,i,s),properties:u.properties,type:u.type,patterns:{}},w=this.addFeature(v,v.geometry,y);w&&n.featureIndex.insert(u,v.geometry,f,m,this.index,this.instancesPerModel[w].instancedDataArray.length)}this.lookup=null}update(e,n,i,s){for(const l in this.instancesPerModel){const u=this.instancesPerModel[l];for(const h in e)u.idToFeaturesIndex.hasOwnProperty(h)&&this.evaluate(u.features[u.idToFeaturesIndex[h]],e[h],u,!0)}this.maxHeight=0}isEmpty(){for(const e in this.instancesPerModel)if(this.instancesPerModel[e].instancedDataArray.length!==0)return!1;return!0}uploadPending(){return!this.uploaded}upload(e){const n=Number.MAX_SAFE_INTEGER;if(!this.uploaded)for(const i in this.instancesPerModel){const s=this.instancesPerModel[i];s.instancedDataArray.length<n||s.instancedDataArray.length===0||(s.instancedDataBuffer?s.instancedDataBuffer.updateData(s.instancedDataArray):s.instancedDataBuffer=e.createVertexBuffer(s.instancedDataArray,s.instancedDataArray.members,!0))}this.uploaded=!0}destroy(){for(const e in this.instancesPerModel){const n=this.instancesPerModel[e];n.instancedDataArray.length!==0&&n.instancedDataBuffer&&n.instancedDataBuffer.destroy()}}addFeature(e,n,i){const s=this.layers[0],l=s.layout.get("model-id").evaluate(i,{},this.canonical);if(!l)return ye(`modelId is not evaluated for layer ${s.id} and it is not going to get rendered.`),l;this.instancesPerModel[l]||(this.instancesPerModel[l]=new JI);const u=this.instancesPerModel[l],h=u.instancedDataArray,f=new QI(i,h.length);for(const m of n)for(const y of m){if(y.x<0||y.x>=Ge||y.y<0||y.y>=Ge)continue;const v=(this.lookupDim-1)/Ge,w=this.lookupDim*(y.y*v|0)+y.x*v|0;if(this.lookup){if(this.lookup[w]!==0)continue;this.lookup[w]=1}this.instanceCount++;const S=h.length;h.resize(S+1),u.instancesEvaluatedElevation.push(0),h.float32[16*S]=y.x,h.float32[16*S+1]=y.y}return f.instancedDataCount=u.instancedDataArray.length-f.instancedDataOffset,f.instancedDataCount>0&&(e.id&&(u.idToFeaturesIndex[e.id]=u.features.length),u.features.push(f),this.evaluate(f,{},u,!1)),l}evaluate(e,n,i,s){const l=this.layers[0],u=e.feature,h=this.canonical,f=l.paint.get("model-rotation").evaluate(u,n,h),m=l.paint.get("model-scale").evaluate(u,n,h),y=l.paint.get("model-translation").evaluate(u,n,h),v=l.paint.get("model-color").evaluate(u,n,h);v.a=l.paint.get("model-color-mix-intensity").evaluate(u,n,h);const w=[];this.maxVerticalOffset<y[2]&&(this.maxVerticalOffset=y[2]),this.maxScale=Math.max(Math.max(this.maxScale,m[0]),Math.max(m[1],m[2])),XI(w,f,m);const S=Math.round(100*v.a)+v.b/1.05;for(let E=0;E<e.instancedDataCount;++E){const A=e.instancedDataOffset+E,M=16*A,k=i.instancedDataArray.float32;let R=0;s&&(R=k[M+6]-i.instancesEvaluatedElevation[A]);const L=0|k[M+1];k[M]=(0|k[M])+v.r/1.05,k[M+1]=L+v.g/1.05,k[M+2]=S,k[M+3]=1/(h.z>10?this.tileToMeter:c_(h,L)),k[M+4]=y[0],k[M+5]=y[1],k[M+6]=y[2]+R,k[M+7]=w[0],k[M+8]=w[1],k[M+9]=w[2],k[M+10]=w[4],k[M+11]=w[5],k[M+12]=w[6],k[M+13]=w[8],k[M+14]=w[9],k[M+15]=w[10],i.instancesEvaluatedElevation[A]=y[2]}}}kt(ek,"ModelBucket",{omit:["layers"]}),kt(JI,"PerModelAttributes"),kt(QI,"ModelFeature");const G8=new jr({visibility:new gt(ke.layout_model.visibility),"model-id":new qt(ke.layout_model["model-id"])});var H8={paint:new jr({"model-opacity":new gt(ke.paint_model["model-opacity"]),"model-rotation":new qt(ke.paint_model["model-rotation"]),"model-scale":new qt(ke.paint_model["model-scale"]),"model-translation":new qt(ke.paint_model["model-translation"]),"model-color":new qt(ke.paint_model["model-color"]),"model-color-mix-intensity":new qt(ke.paint_model["model-color-mix-intensity"]),"model-type":new gt(ke.paint_model["model-type"]),"model-cast-shadows":new gt(ke.paint_model["model-cast-shadows"]),"model-receive-shadows":new gt(ke.paint_model["model-receive-shadows"]),"model-ambient-occlusion-intensity":new gt(ke.paint_model["model-ambient-occlusion-intensity"]),"model-emissive-strength":new qt(ke.paint_model["model-emissive-strength"]),"model-roughness":new qt(ke.paint_model["model-roughness"]),"model-height-based-emissive-strength-multiplier":new qt(ke.paint_model["model-height-based-emissive-strength-multiplier"])}),layout:G8};function tk(t){let e=0;if(t.meshes)for(const n of t.meshes)e=Math.max(e,n.aabb.max[2]);if(t.children)for(const n of t.children)e=Math.max(e,tk(n));return e}const nk=["","wall","door","roof","window","lamp","logo"];class rk{constructor(e){this.node=e,this.evaluatedRMEA=[[1,0,0,1],[1,0,0,1],[1,0,0,1],[1,0,0,1],[.4,1,0,1],[1,0,0,1],[1,0,0,1]],this.hiddenByReplacement=!1,this.evaluatedScale=[1,1,1],this.evaluatedColor=[],this.emissionHeightBasedParams=[],this.feature={type:"Point",id:e.id,geometry:[],properties:{height:tk(e)}}}}class ik{constructor(e,n,i,s){this.nodes=e,this.id=n,this.modelTraits|=1,this.uploaded=!1,this.hasPattern=!1,i&&(this.modelTraits|=4),this.zoom=-1,this.terrainExaggeration=1,this.projection={name:"mercator"},this.replacementUpdateTime=0,this.elevationReadFromZ=255,this.brightness=s,this.dirty=!0,this.needsUpload=!1}update(){console.log("Update 3D model bucket")}populate(){console.log("populate 3D model bucket")}uploadPending(){return!this.uploaded||this.needsUpload}upload(e){if(!this.needsUpload)return;const n=this.getNodesInfo();for(const i of n){const s=i.node;this.uploaded?this.updatePbrBuffer(s):XS(s,e,!0)}for(const i of n)hx(i.node);this.uploaded=!0,this.needsUpload=!1}updatePbrBuffer(e){let n=!1;if(!e.meshes)return n;for(const i of e.meshes)i.pbrBuffer&&(i.pbrBuffer.updateData(i.featureArray),n=!0);return n}needsReEvaluation(e,n,i){const s=e.transform.projectionOptions,l=e.style.calculateLightsBrightness(),u=this.brightness!==l;return!!(!this.uploaded||this.dirty||s.name!==this.projection.name||fx(i.paint.get("model-color-mix-intensity").value,u)||fx(i.paint.get("model-roughness").value,u)||fx(i.paint.get("model-emissive-strength").value,u)||fx(i.paint.get("model-height-based-emissive-strength-multiplier").value,u))&&(this.dirty=!1,this.projection=s,this.brightness=l,!0)}evaluateScale(e,n){if(e.transform.zoom===this.zoom)return;this.zoom=e.transform.zoom;const i=this.getNodesInfo(),s=this.id.canonical;for(const l of i){const u=l.feature;l.evaluatedScale=n.paint.get("model-scale").evaluate(u,{},s)}}evaluate(e){const n=this.getNodesInfo();for(const i of n){if(!i.node.meshes)continue;const s=i.feature,l=i.evaluatedColor[2],u=i.evaluatedRMEA[2],h=this.id.canonical;if(i.node.meshes&&i.node.meshes[0].featureData){for(let f=0;f<nk.length;f++){const m=nk[f];m.length&&(s.properties.part=m);const y=e.paint.get("model-color").evaluate(s,{},h),v=e.paint.get("model-color-mix-intensity").evaluate(s,{},h);i.evaluatedColor[f]=[y.r,y.g,y.b,v],i.evaluatedRMEA[f][0]=e.paint.get("model-roughness").evaluate(s,{},h),i.evaluatedRMEA[f][2]=e.paint.get("model-emissive-strength").evaluate(s,{},h),i.evaluatedRMEA[f][3]=y.a,i.emissionHeightBasedParams[f]=e.paint.get("model-height-based-emissive-strength-multiplier").evaluate(s,{},h)}delete s.properties.part,W8(i,l!==i.evaluatedColor[2]||u!==i.evaluatedRMEA[2])}i.evaluatedScale=e.paint.get("model-scale").evaluate(s,{},h),this.updatePbrBuffer(i.node)||(this.needsUpload=!0)}}elevationUpdate(e,n,i){const s=e.findDEMTileFor(i);if((s!==this.terrainTile||n!==this.terrainExaggeration)&&e&&s&&s.dem&&s.tileID.overscaledZ!==this.elevationReadFromZ){this.elevationReadFromZ=s.tileID.overscaledZ;const l=Sm.create(e,this.id,s);if(!l)return;for(const u of this.getNodesInfo()){const h=u.node;if(!h.footprint||!h.footprint.vertices||!h.footprint.vertices.length)continue;const f=h.footprint.vertices;let m=l.getElevationAt(f[0].x,f[0].y,!0,!0);for(let y=1;y<f.length;y++)m=Math.min(m,l.getElevationAt(f[y].x,f[y].y,!0,!0));h.elevation=m}}}getNodesInfo(){if(!this.nodesInfo){this.nodesInfo=[];for(const e of this.nodes)this.nodesInfo.push(new rk(e));this.freeNodes()}return this.nodesInfo}freeNodes(){if(this.nodes){for(const e of this.nodes)dx(e);this.nodes.splice(0,this.nodes.length)}}destroy(){this.freeNodes();const e=this.getNodesInfo();for(const n of e)hx(n.node),dx(n.node)}isEmpty(){return!this.nodes.length}updateReplacement(e,n){if(n.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=n.updateTime;const i=n.getReplacementRegionsForTile(e.toUnwrapped()),s=this.getNodesInfo();for(let l=0;l<this.nodesInfo.length;l++){const u=s[l].node;s[l].hiddenByReplacement=!!u.footprint&&!i.find(h=>h.footprint===u.footprint)}}}function fx(t,e){return!t.isLightConstant&&e}function q8(t,e,n,i,s,l,u,h){let f=(61440&e|(61440&e)>>4)>>8,m=(3840&e|(3840&e)>>4)>>4,y=240&e|(240&e)>>4;n[3]>0&&(f=nn(f,255*n[0],n[3]),m=nn(m,255*n[1],n[3]),y=nn(y,255*n[2],n[3]));const v=f<<8|m,w=y<<8|Math.floor(255*i[3]),S=function(j){const V=ce(j,0,2);return Math.min(Math.round(.5*V*255),255)}(i[2])<<8|15*i[0]<<4|15*i[1],E=ce(s[0],0,1),A=ce(s[1],0,1),M=ce(s[2],0,1),k=ce(s[3],0,1);let R,L,z,B;if(E!==A&&u!==l&&A!==E){const j=u-l;L=1/(j*(A-E)),z=-(l+j*E)/(j*(A-E));const V=ce(s[4],-1,1);B=Math.pow(10,V),R=255*M<<8|255*k}else R=65535,L=0,z=1,B=1;if(t.emplaceBack(v,w,S,R,L,z,B),h){const j=h.length;h.clear();for(let V=0;V<j;V++)h.emplaceBack(v,w,S,R,L,z,B)}}function W8(t,e){const n=t.node;let i=0;for(const s of n.meshes){if(n.lights&&n.lightMeshIndex===i||!s.featureData)continue;s.featureArray=new ih,s.featureArray.reserve(s.featureData.length);let l=e;for(const u of s.featureData){let h;const f=65535&u,m=(15&f)<8?15&f:0,y=u>>16&65535,v=t.evaluatedRMEA[m],w=t.evaluatedColor[m],S=t.emissionHeightBasedParams[m];if(l&&m===2&&n.lights&&(h=new ih,h.resize(10*n.lights.length)),q8(s.featureArray,y,w,v,S,s.aabb.min[2],s.aabb.max[2],h),h&&l){l=!1;const E=n.meshes[n.lightMeshIndex];E.featureArray=h,E.featureArray._trim()}}s.featureArray._trim(),i++}}kt(ik,"Tiled3dModelBucket",{omit:["layers"]}),kt(rk,"Tiled3dModelFeature");class Z8{constructor(){this._updateTime=0,this._sourceIds=[],this._activeRegions=[],this._prevRegions=[]}clear(){this._activeRegions.length>0&&++this._updateTime,this._activeRegions=[],this._prevRegions=[]}get updateTime(){return this._updateTime}getReplacementRegionsForTile(e){const n=ak(new q(0,0),new q(Ge,Ge),e),i=[];for(const s of this._activeRegions){if(s.hiddenByOverlap||!sk(n,s))continue;const l=X8(s.min,s.max,e);i.push({min:l.min,max:l.max,sourceId:this._sourceIds[s.priority],footprint:s.footprint,footprintTileId:s.tileId})}return i}setSources(e){this._setSources(e.map(n=>({getSourceId:()=>n.cache.id,getFootprints:()=>{const i=[];for(const s of n.cache.getVisibleCoordinates()){const l=n.cache.getTile(s).buckets[n.layer];if(l)for(const u of l.getNodesInfo()){const h=u.node;h.footprint&&i.push({footprint:h.footprint,id:s.toUnwrapped()})}}return i}})))}_addSource(e){const n=e.getFootprints();if(n.length!==0){for(const i of n){if(!i.footprint)continue;const s=ak(i.footprint.min,i.footprint.max,i.id);this._activeRegions.push({min:s.min,max:s.max,hiddenByOverlap:!1,priority:this._sourceIds.length,tileId:i.id,footprint:i.footprint})}this._sourceIds.push(e.getSourceId())}}_computeReplacement(){this._activeRegions.sort((n,i)=>n.priority-i.priority||px(n.min,i.min)||px(n.max,i.max));let e=this._activeRegions.length!==this._prevRegions.length;if(!e){let n=0,i=0;for(;!e&&n!==this._activeRegions.length;){const s=this._activeRegions[n],l=this._prevRegions[i];e=s.priority!==l.priority||!ok(s,l),++n,++i}}if(e){++this._updateTime;const n=i=>{const s=this._activeRegions;if(i>=s.length)return i;const l=s[i].priority;for(;i<s.length&&s[i].priority===l;)++i;return i};if(this._sourceIds.length>1){let i=0,s=n(i);for(;i!==s;){let l=i;const u=i;for(;l!==s;){const h=this._activeRegions[l];h.hiddenByOverlap=!1;for(let f=0;f<u;f++){const m=this._activeRegions[f];if(!m.hiddenByOverlap&&sk(h,m)&&(h.hiddenByOverlap=uk(h.footprint,h.tileId,m.footprint,m.tileId),h.hiddenByOverlap))break}++l}i=s,s=n(i)}}}}_setSources(e){[this._prevRegions,this._activeRegions]=[this._activeRegions,[]],this._sourceIds=[];for(let n=e.length-1;n>=0;n--)this._addSource(e[n]);this._computeReplacement()}}function px(t,e){return t.x-e.x||t.y-e.y}function ok(t,e){return px(t.min,e.min)===0&&px(t.max,e.max)===0}function sk(t,e){return!(t.min.x>e.max.x||t.max.x<e.min.x||t.min.y>e.max.y||t.max.y<e.min.y)}function ak(t,e,n){const i=1/Ge,s=1/(1<<n.canonical.z),l=(e.x*i+n.canonical.x)*s+n.wrap,u=(e.y*i+n.canonical.y)*s;return{min:new q((t.x*i+n.canonical.x)*s+n.wrap,(t.y*i+n.canonical.y)*s),max:new q(l,u)}}function X8(t,e,n){const i=1<<n.canonical.z,s=((e.x-n.wrap)*i-n.canonical.x)*Ge,l=(e.y*i-n.canonical.y)*Ge;return{min:new q(((t.x-n.wrap)*i-n.canonical.x)*Ge,(t.y*i-n.canonical.y)*Ge),max:new q(s,l)}}function lk(t,e,n,i,s,l,u){const h=t.indices,f=t.vertices,m=[];for(let y=i;y<i+s;y+=3){const v=e[n[y+0]+l],w=e[n[y+1]+l],S=e[n[y+2]+l],E=Math.min(v.x,w.x,S.x),A=Math.max(v.x,w.x,S.x),M=Math.min(v.y,w.y,S.y),k=Math.max(v.y,w.y,S.y);m.length=0,t.grid.query(new q(E,M),new q(A,k),m);for(let R=0;R<m.length;R++){const L=m[R];if(yS(f[h[3*L+0]],f[h[3*L+1]],f[h[3*L+2]],v,w,S,u))return!0}}return!1}function uk(t,e,n,i){if(!t||!n)return!1;let s=t.vertices;if(!e.canonical.equals(i.canonical)||e.wrap!==i.wrap){if(n.vertices.length<t.vertices.length)return uk(n,i,t,e);const l=e.canonical,u=i.canonical,h=Math.pow(2,u.z-l.z);s=t.vertices.map(f=>new q(f.x*l.x*Ge*h-u.x*Ge,f.y*l.y*Ge*h-u.y*Ge))}return lk(n,s,t.indices,0,t.indices.length,0,0)}const K8=B1.types,Y8=Math.pow(2,13),ck=new q(0,1),Th=2147483648;function M_(t,e,n,i,s,l,u,h){t.emplaceBack((e<<1)+u,(n<<1)+l,(Math.floor(i*Y8)<<1)+s,Math.round(h))}function mx(t,e,n,i,s){t.emplaceBack(e.x,e.y,(n.x<<1)+i,(n.y<<1)+s)}function I_(t,e,n){t.emplaceBack(e.x,e.y,e.z,n[0]*16384,n[1]*16384,n[2]*16384)}class hk{constructor(){this.vertexOffset=0,this.vertexCount=0,this.indexOffset=0,this.indexCount=0}}class dk{constructor(){this.centroidXY=new q(0,0),this.vertexArrayOffset=0,this.vertexCount=0,this.groundVertexArrayOffset=0,this.groundVertexCount=0,this.flags=0,this.footprintSegIdx=-1,this.footprintSegLen=0,this.min=new q(Number.MAX_VALUE,Number.MAX_VALUE),this.max=new q(-Number.MAX_VALUE,-Number.MAX_VALUE)}span(){return new q(this.max.x-this.min.x,this.max.y-this.min.y)}}class fk{constructor(){this.acc=new q(0,0),this.accCount=0,this.centroidDataIndex=0}startRing(e,n){e.min.x===Number.MAX_VALUE&&(e.min.x=e.max.x=n.x,e.min.y=e.max.y=n.y)}appendEdge(e,n,i){this.accCount++,this.acc._add(n);let s=!!this.borders;n.x<e.min.x?(e.min.x=n.x,s=!0):n.x>e.max.x&&(e.max.x=n.x,s=!0),n.y<e.min.y?(e.min.y=n.y,s=!0):n.y>e.max.y&&(e.max.y=n.y,s=!0),((n.x===0||n.x===Ge)&&n.x===i.x)!=((n.y===0||n.y===Ge)&&n.y===i.y)&&this.processBorderOverlap(n,i),s&&this.checkBorderIntersection(n,i)}checkBorderIntersection(e,n){n.x<0!=e.x<0&&this.addBorderIntersection(0,nn(n.y,e.y,(0-n.x)/(e.x-n.x))),n.x>Ge!=e.x>Ge&&this.addBorderIntersection(1,nn(n.y,e.y,(Ge-n.x)/(e.x-n.x))),n.y<0!=e.y<0&&this.addBorderIntersection(2,nn(n.x,e.x,(0-n.y)/(e.y-n.y))),n.y>Ge!=e.y>Ge&&this.addBorderIntersection(3,nn(n.x,e.x,(Ge-n.y)/(e.y-n.y)))}addBorderIntersection(e,n){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const i=this.borders[e];n<i[0]&&(i[0]=n),n>i[1]&&(i[1]=n)}processBorderOverlap(e,n){if(e.x===n.x){if(e.y===n.y)return;const i=e.x===0?0:1;this.addBorderIntersection(i,n.y),this.addBorderIntersection(i,e.y)}else{const i=e.y===0?2:3;this.addBorderIntersection(i,n.x),this.addBorderIntersection(i,e.x)}}centroid(){return this.accCount===0?new q(0,0):new q(Math.floor(Math.max(0,this.acc.x)/this.accCount),Math.floor(Math.max(0,this.acc.y)/this.accCount))}intersectsCount(){return this.borders?this.borders.reduce((e,n)=>e+ +(n[0]!==Number.MAX_VALUE),0):0}}class pk{constructor(e){this.vertexArray=new ql,this.indexArray=new di,this.programConfigurations=new ll(e.layers,e.zoom),this.segments=new In,this.hiddenByLandmarkVertexArray=new Xd}hasData(){return this.vertexArray.length!==0}addData(e,n){const i=e.length;if(i>2){const s=this.segments.prepareSegment(4*i,this.vertexArray,this.indexArray);for(let l=0;l<i;l++){const u=e[l],h=e[l===i-1?0:l+1];if(KS(u,h,n)||yk(u,n)&&yk(h,n))continue;const f=s.vertexLength;mx(this.vertexArray,u,h,1,1),mx(this.vertexArray,u,h,1,0),mx(this.vertexArray,u,h,0,1),mx(this.vertexArray,u,h,0,0),s.vertexLength+=4,this.indexArray.emplaceBack(f,f+1,f+3),this.indexArray.emplaceBack(f,f+3,f+2),s.primitiveLength+=2}}}addPaintPropertiesData(e,n,i,s,l,u){this.hasData()&&this.programConfigurations.populatePaintArrays(this.vertexArray.length,e,n,i,s,l,u)}upload(e){this.hasData()&&(this.vertexBuffer=e.createVertexBuffer(this.vertexArray,kN.members),this.indexBuffer=e.createIndexBuffer(this.indexArray))}uploadPaintProperties(e){this.hasData()&&this.programConfigurations.upload(e)}update(e,n,i,s,l,u){this.hasData()&&this.programConfigurations.updatePaintArrays(e,n,i,s,l,u)}updateHiddenByLandmark(e){if(!this.hasData())return;const n=e.groundVertexCount+e.groundVertexArrayOffset;if(e.groundVertexCount===0)return;const i=e.flags&Th?1:0;for(let s=e.groundVertexArrayOffset;s<n;++s)this.hiddenByLandmarkVertexArray.emplace(s,i);this.needsHiddenByLandmarkUpdate=!0}uploadHiddenByLandmark(e){this.hasData()&&this.needsHiddenByLandmarkUpdate&&(!this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexArray.length>0?this.hiddenByLandmarkVertexBuffer=e.createVertexBuffer(this.hiddenByLandmarkVertexArray,RN.members,!0):this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.updateData(this.hiddenByLandmarkVertexArray),this.needsHiddenByLandmarkUpdate=!1)}destroy(){this.vertexBuffer&&(this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.destroy(),this.segments.destroy(),this.programConfigurations.destroy())}}class k_{constructor(e){this.zoom=e.zoom,this.canonical=e.canonical,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(n=>n.id),this.index=e.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=e.projection,this.activeReplacements=[],this.replacementUpdateTime=0,this.centroidData=[],this.footprintIndices=new di,this.footprintVertices=new Bo,this.footprintSegments=[],this.layoutVertexArray=new ql,this.centroidVertexArray=new Zy,this.indexArray=new di,this.programConfigurations=new ll(e.layers,e.zoom),this.segments=new In,this.stateDependentLayerIds=this.layers.filter(n=>n.isStateDependent()).map(n=>n.id),this.groundEffect=new pk(e)}populate(e,n,i,s){this.features=[],this.hasPattern=ES("fill-extrusion",this.layers,n),this.featuresOnBorder=[],this.borderFeatureIndices=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.tileToMeter=c_(i),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter;for(const{feature:l,id:u,index:h,sourceLayerIndex:f}of e){const m=this.layers[0]._featureFilter.needGeometry,y=mh(l,m);if(!this.layers[0]._featureFilter.filter(new Nr(this.zoom),y,i))continue;const v={id:u,sourceLayerIndex:f,index:h,geometry:m?y.geometry:nu(l,i,s),properties:l.properties,type:l.type,patterns:{}},w=this.layoutVertexArray.length;this.hasPattern?this.features.push(TS("fill-extrusion",this.layers,v,this.zoom,n)):this.addFeature(v,v.geometry,h,i,{},n.availableImages,s,n.brightness),n.featureIndex.insert(l,v.geometry,h,f,this.index,w)}this.sortBorders()}addFeatures(e,n,i,s,l,u){for(const h of this.features){const{geometry:f}=h;this.addFeature(h,f,h.index,n,i,s,l,u)}this.sortBorders()}update(e,n,i,s,l){const u=Object.keys(e).length!==0;if(u&&!this.stateDependentLayers.length)return;const h=u?this.stateDependentLayers:this.layers;this.programConfigurations.updatePaintArrays(e,n,h,i,s,l),this.groundEffect.update(e,n,h,i,s,l)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload||this.groundEffect.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,LN),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=e.createVertexBuffer(this.layoutVertexExtArray,DN.members,!0)),this.groundEffect.upload(e)),this.groundEffect.uploadPaintProperties(e),this.programConfigurations.upload(e),this.uploaded=!0}uploadCentroid(e){this.groundEffect.uploadHiddenByLandmark(e),this.needsCentroidUpdate&&(!this.centroidVertexBuffer&&this.centroidVertexArray.length>0?this.centroidVertexBuffer=e.createVertexBuffer(this.centroidVertexArray,PN.members,!0):this.centroidVertexBuffer&&this.centroidVertexBuffer.updateData(this.centroidVertexArray),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.groundEffect.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(e,n,i,s,l,u,h,f){const m=[new q(0,0),new q(Ge,Ge)],y=h.projection,v=y.name==="globe",w=K8[e.type]==="Polygon",S=new fk;S.centroidDataIndex=this.centroidData.length;const E=new dk;E.vertexArrayOffset=this.layoutVertexArray.length,E.groundVertexArrayOffset=this.groundEffect.vertexArray.length,v&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new th);const A=SS(n,500);for(let L=A.length-1;L>=0;L--){const z=A[L];(z.length===0||(M=z[0]).every(B=>B.x<=0)||M.every(B=>B.x>=Ge)||M.every(B=>B.y<=0)||M.every(B=>B.y>=Ge))&&A.splice(L,1)}var M;let k;if(v)k=wk(A,m,s);else{k=[];for(const L of A)k.push({polygon:L,bounds:m})}const R=w?this.edgeRadius:0;for(const{polygon:L,bounds:z}of k){let B=0,j=0;for(const ne of L)w&&!ne[0].equals(ne[ne.length-1])&&ne.push(ne[0]),j+=w?ne.length-1:ne.length;const V=this.segments.prepareSegment((w?5:4)*j,this.layoutVertexArray,this.indexArray);E.footprintSegIdx<0&&(E.footprintSegIdx=this.footprintSegments.length);const Y=new hk;if(Y.vertexOffset=this.footprintVertices.length,Y.indexOffset=3*this.footprintIndices.length,w){const ne=[],re=[];B=V.vertexLength;for(let ae=0;ae<L.length;ae++){const le=L[ae];le.length&&ae!==0&&re.push(ne.length/2);const oe=[];let Ee,xe;Ee=le[1].sub(le[0])._perp()._unit();for(let Pe=1;Pe<le.length;Pe++){const pe=le[Pe],Ae=le[Pe===le.length-1?1:Pe+1];let{x:Le,y:qe}=pe;if(R===0&&oe.push(pe),R){xe=Ae.sub(pe)._perp()._unit();const Ve=Ee.add(xe)._unit(),yt=R*Math.min(4,1/(Ee.x*Ve.x+Ee.y*Ve.y));Le+=yt*Ve.x,qe+=yt*Ve.y,Ee=xe}M_(this.layoutVertexArray,Le,qe,0,0,1,1,0),V.vertexLength++,this.footprintVertices.emplaceBack(pe.x,pe.y),ne.push(pe.x,pe.y),v&&I_(this.layoutVertexExtArray,y.projectTilePoint(Le,qe,s),y.upVector(s,Le,qe))}R===0&&this.groundEffect.addData(oe,z)}const J=O1(ne,re);for(let ae=0;ae<J.length;ae+=3)this.footprintIndices.emplaceBack(Y.vertexOffset+J[ae+0],Y.vertexOffset+J[ae+1],Y.vertexOffset+J[ae+2]),this.indexArray.emplaceBack(B+J[ae],B+J[ae+2],B+J[ae+1]),V.primitiveLength++;Y.indexCount+=J.length,Y.vertexCount+=this.footprintVertices.length-Y.vertexOffset}for(let ne=0;ne<L.length;ne++){const re=L[ne];S.startRing(E,re[0]);let J=re.length>4&&_k(re[re.length-2],re[0],re[1]),ae=R?Q8(re[re.length-2],re[0],re[1],R):0;const le=[];let oe,Ee,xe;Ee=re[1].sub(re[0])._perp()._unit();let Pe=!0;for(let pe=1,Ae=0;pe<re.length;pe++){let Le=re[pe-1],qe=re[pe];const Ve=re[pe===re.length-1?1:pe+1];if(S.appendEdge(E,qe,Le),KS(qe,Le,z)){R&&(Ee=Ve.sub(qe)._perp()._unit(),Pe=!Pe);continue}const yt=qe.sub(Le)._perp(),mt=yt.x/(Math.abs(yt.x)+Math.abs(yt.y)),lt=yt.y>0?1:0,ft=Le.dist(qe);if(Ae+ft>32768&&(Ae=0),R){xe=Ve.sub(qe)._perp()._unit();let Ut=gk(Le,qe,Ve,mk(Ee,xe),R);isNaN(Ut)&&(Ut=0);const Xt=qe.sub(Le)._unit();Le=Le.add(Xt.mult(ae))._round(),qe=qe.add(Xt.mult(-Ut))._round(),ae=Ut,Ee=xe,le.push(Le),le.push(qe)}const Mt=V.vertexLength,Zt=re.length>4&&_k(Le,qe,Ve);let Gt=vk(Ae,J,Pe);if(M_(this.layoutVertexArray,Le.x,Le.y,mt,lt,0,0,Gt),M_(this.layoutVertexArray,Le.x,Le.y,mt,lt,0,1,Gt),Ae+=ft,Gt=vk(Ae,Zt,!Pe),J=Zt,M_(this.layoutVertexArray,qe.x,qe.y,mt,lt,0,0,Gt),M_(this.layoutVertexArray,qe.x,qe.y,mt,lt,0,1,Gt),V.vertexLength+=4,this.indexArray.emplaceBack(Mt+0,Mt+1,Mt+2),this.indexArray.emplaceBack(Mt+1,Mt+3,Mt+2),V.primitiveLength+=2,R){const Ut=B+(pe===1?re.length-2:pe-2),Xt=pe===1?B:Ut+1;if(this.indexArray.emplaceBack(Mt+1,Ut,Mt+3),this.indexArray.emplaceBack(Ut,Xt,Mt+3),V.primitiveLength+=2,oe===void 0&&(oe=Mt),!KS(Ve,re[pe],z)){const zn=pe===re.length-1?oe:V.vertexLength;this.indexArray.emplaceBack(Mt+2,Mt+3,zn),this.indexArray.emplaceBack(Mt+3,zn+1,zn),this.indexArray.emplaceBack(Mt+3,Xt,zn+1),V.primitiveLength+=3}Pe=!Pe}if(v){const Ut=this.layoutVertexExtArray,Xt=y.projectTilePoint(Le.x,Le.y,s),zn=y.projectTilePoint(qe.x,qe.y,s),Pn=y.upVector(s,Le.x,Le.y),or=y.upVector(s,qe.x,qe.y);I_(Ut,Xt,Pn),I_(Ut,Xt,Pn),I_(Ut,zn,or),I_(Ut,zn,or)}}w&&(B+=re.length-1),R&&this.groundEffect.addData(le,z)}this.footprintSegments.push(Y),++E.footprintSegLen}if(E.vertexCount=this.layoutVertexArray.length-E.vertexArrayOffset,E.groundVertexCount=this.groundEffect.vertexArray.length-E.groundVertexArrayOffset,E.vertexCount!==0){if(E.centroidXY=S.borders?ck:this.encodeCentroid(S,E),this.centroidData.push(E),S.borders){this.featuresOnBorder.push(S);const L=this.featuresOnBorder.length-1;for(let z=0;z<S.borders.length;z++)S.borders[z][0]!==Number.MAX_VALUE&&this.borderFeatureIndices[z].push(L)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,i,l,u,s,f),this.groundEffect.addPaintPropertiesData(e,i,l,u,s,f)}}sortBorders(){for(let e=0;e<this.borderFeatureIndices.length;e++)this.borderFeatureIndices[e].sort((n,i)=>this.featuresOnBorder[n].borders[e][0]-this.featuresOnBorder[i].borders[e][0])}encodeCentroid(e,n){const i=e.centroid(),s=n.span(),l=Math.min(7,Math.round(s.x*this.tileToMeter/10)),u=Math.min(7,Math.round(s.y*this.tileToMeter/10));return new q(ce(i.x,1,Ge-1)<<3|l,ce(i.y,1,Ge-1)<<3|u)}showCentroid(e){const n=this.centroidData[e.centroidDataIndex];n.flags&=Th,n.centroidXY.x=0,n.centroidXY.y=0,this.writeCentroidToBuffer(n)}writeCentroidToBuffer(e){this.groundEffect.updateHiddenByLandmark(e);const n=e.vertexArrayOffset,i=e.vertexCount+e.vertexArrayOffset,s=e.flags&Th?ck:e.centroidXY,l=this.centroidVertexArray.geta_centroid_pos0(n);if(this.centroidVertexArray.geta_centroid_pos1(n)!==s.y||l!==s.x){for(let u=n;u<i;++u)this.centroidVertexArray.emplace(u,s.x,s.y);this.needsCentroidUpdate=!0}}createCentroidsBuffer(){this.centroidVertexArray.resize(this.layoutVertexArray.length),this.groundEffect.hiddenByLandmarkVertexArray.resize(this.groundEffect.vertexArray.length);for(const e of this.centroidData)this.writeCentroidToBuffer(e)}updateReplacement(e,n){if(n.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=n.updateTime;const i=n.getReplacementRegionsForTile(e.toUnwrapped());if(function(l,u){if(l.length!==u.length)return!1;for(let h=0;h<l.length;h++)if(l[h].sourceId!==u[h].sourceId||!ok(l[h],u[h]))return!1;return!0}(this.activeReplacements,i))return;if(this.activeReplacements=i,this.centroidVertexArray.length===0)this.createCentroidsBuffer();else for(const l of this.centroidData)l.flags&=2147483647;const s=[];for(const l of this.activeReplacements){const u=Math.pow(2,l.footprintTileId.canonical.z-e.canonical.z);for(const h of this.centroidData)if(!(h.flags&Th||l.min.x>h.max.x||h.min.x>l.max.x||l.min.y>h.max.y||h.min.y>l.max.y))for(let f=0;f<h.footprintSegLen;f++){const m=this.footprintSegments[h.footprintSegIdx+f];if(s.length=0,J8(this.footprintVertices,m.vertexOffset,m.vertexCount,l.footprintTileId.canonical,e.canonical,s),lk(l.footprint,s,this.footprintIndices.uint16,m.indexOffset,m.indexCount,-m.vertexOffset,-u)){h.flags|=Th;break}}}for(const l of this.centroidData)this.writeCentroidToBuffer(l);this.borderDoneWithNeighborZ=[-1,-1,-1,-1]}}function mk(t,e){const n=t.add(e)._unit();return t.x*n.x+t.y*n.y}function Q8(t,e,n,i){const s=e.sub(t)._perp()._unit(),l=n.sub(e)._perp()._unit();return gk(t,e,n,mk(s,l),i)}function gk(t,e,n,i,s){const l=Math.sqrt(1-i*i);return Math.min(t.dist(e)/3,e.dist(n)/3,s*l/i)}function KS(t,e,n){return t.x<n[0].x&&e.x<n[0].x||t.x>n[1].x&&e.x>n[1].x||t.y<n[0].y&&e.y<n[0].y||t.y>n[1].y&&e.y>n[1].y}function yk(t,e){return t.x<e[0].x||t.x>e[1].x||t.y<e[0].y||t.y>e[1].y}function _k(t,e,n){if(t.x<0||t.x>=Ge||e.x<0||e.x>=Ge||n.x<0||n.x>=Ge)return!1;const i=n.sub(e),s=i.perp(),l=t.sub(e);return(i.x*l.x+i.y*l.y)/Math.sqrt((i.x*i.x+i.y*i.y)*(l.x*l.x+l.y*l.y))>-.866&&s.x*l.x+s.y*l.y<0}function vk(t,e,n){const i=e?2|t:-3&t;return n?1|i:-2&i}function xk(){const t=Math.PI/32,e=Math.tan(t),n=mm;return n*Math.sqrt(1+2*e*e)-n}function wk(t,e,n){const i=1<<n.z,s=Ls(n.x/i),l=Ls((n.x+1)/i),u=Ci(n.y/i),h=Ci((n.y+1)/i);return function(f,m,y,v,w=0,S){const E=[];if(!f.length||!y||!v)return E;const A=(j,V)=>{for(const Y of j)E.push({polygon:Y,bounds:V})},M=Math.ceil(Math.log2(y)),k=Math.ceil(Math.log2(v)),R=M-k,L=[];for(let j=0;j<Math.abs(R);j++)L.push(R>0?0:1);for(let j=0;j<Math.min(M,k);j++)L.push(0),L.push(1);let z=f;if(z=N1(z,m[0].y-w,m[1].y+w,1),z=N1(z,m[0].x-w,m[1].x+w,0),!z.length)return E;const B=[];for(L.length?B.push({polygons:z,bounds:m,depth:0}):A(z,m);B.length;){const j=B.pop(),V=j.depth,Y=L[V],ne=j.bounds[0],re=j.bounds[1],J=Y===0?ne.x:ne.y,ae=Y===0?re.x:re.y,le=S?S(Y,J,ae):.5*(J+ae),oe=N1(j.polygons,J-w,le+w,Y),Ee=N1(j.polygons,le-w,ae+w,Y);if(oe.length){const xe=[ne,new q(Y===0?le:re.x,Y===1?le:re.y)];L.length>V+1?B.push({polygons:oe,bounds:xe,depth:V+1}):A(oe,xe)}if(Ee.length){const xe=[new q(Y===0?le:ne.x,Y===1?le:ne.y),re];L.length>V+1?B.push({polygons:Ee,bounds:xe,depth:V+1}):A(Ee,xe)}}return E}(t,e,Math.ceil((l-s)/11.25),Math.ceil((u-h)/11.25),1,(f,m,y)=>{if(f===0)return .5*(m+y);{const v=Ci((n.y+m/Ge)/i);return(co(.5*(Ci((n.y+y/Ge)/i)+v))*i-n.y)*Ge}})}function J8(t,e,n,i,s,l){const u=Math.pow(2,i.z-s.z);for(let h=0;h<n;h++){let f=t.int16[2*(h+e)+0],m=t.int16[2*(h+e)+1];f=(f+s.x*Ge)*u-i.x*Ge,m=(m+s.y*Ge)*u-i.y*Ge,l.push(new q(f,m))}}kt(k_,"FillExtrusionBucket",{omit:["layers","features"]}),kt(dk,"PartData"),kt(hk,"FootprintSegment"),kt(fk,"BorderCentroidData"),kt(pk,"GroundEffect");const ej=new jr({visibility:new gt(ke["layout_fill-extrusion"].visibility),"fill-extrusion-edge-radius":new gt(ke["layout_fill-extrusion"]["fill-extrusion-edge-radius"])});var tj={paint:new jr({"fill-extrusion-opacity":new gt(ke["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new qt(ke["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new gt(ke["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new gt(ke["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new qt(ke["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new qt(ke["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new qt(ke["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new gt(ke["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new gt(ke["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new gt(ke["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"]),"fill-extrusion-ambient-occlusion-wall-radius":new gt(ke["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-wall-radius"]),"fill-extrusion-ambient-occlusion-ground-radius":new gt(ke["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-radius"]),"fill-extrusion-ambient-occlusion-ground-attenuation":new gt(ke["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-attenuation"]),"fill-extrusion-flood-light-color":new gt(ke["paint_fill-extrusion"]["fill-extrusion-flood-light-color"]),"fill-extrusion-flood-light-intensity":new gt(ke["paint_fill-extrusion"]["fill-extrusion-flood-light-intensity"]),"fill-extrusion-flood-light-wall-radius":new qt(ke["paint_fill-extrusion"]["fill-extrusion-flood-light-wall-radius"]),"fill-extrusion-flood-light-ground-radius":new qt(ke["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-radius"]),"fill-extrusion-flood-light-ground-attenuation":new gt(ke["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-attenuation"]),"fill-extrusion-vertical-scale":new gt(ke["paint_fill-extrusion"]["fill-extrusion-vertical-scale"]),"fill-extrusion-rounded-roof":new gt(ke["paint_fill-extrusion"]["fill-extrusion-rounded-roof"])}),layout:ej};class Dm extends q{constructor(e,n,i){super(e,n),this.z=i}}function P_(t,e){return t.x*e.x+t.y*e.y}function bk(t,e){if(t.length===1){let n=0;const i=e[n++];let s;for(;!s||i.equals(s);)if(s=e[n++],!s)return 1/0;for(;n<e.length;n++){const l=e[n],u=t[0],h=s.sub(i),f=l.sub(i),m=u.sub(i),y=P_(h,h),v=P_(h,f),w=P_(f,f),S=P_(m,h),E=P_(m,f),A=y*w-v*v,M=(w*S-v*E)/A,k=(y*E-v*S)/A,R=i.z*(1-M-k)+s.z*M+l.z*k;if(isFinite(R))return R}return 1/0}{let n=1/0;for(const i of e)n=Math.min(n,i.z);return n}}function Sk(t,e,n,i,s,l,u,h){const f=u*s.getElevationAt(t,e,!0,!0),m=l[0]!==0,y=m?l[1]===0?u*(l[0]/7-450):u*function(v,w,S){const E=Math.floor(w[0]/8),A=Math.floor(w[1]/8),M=10*(w[0]-8*E),k=10*(w[1]-8*A),R=v.getElevationAt(E,A,!0,!0),L=v.getMeterToDEM(S),z=Math.floor(.5*(M*L-1)),B=Math.floor(.5*(k*L-1)),j=v.tileCoordToPixel(E,A),V=2*z+1,Y=2*B+1,ne=function(Ee,xe,Pe,pe,Ae){return[Ee.getElevationAtPixel(xe,Pe,!0),Ee.getElevationAtPixel(xe+Ae,Pe,!0),Ee.getElevationAtPixel(xe,Pe+Ae,!0),Ee.getElevationAtPixel(xe+pe,Pe+Ae,!0)]}(v,j.x-z,j.y-B,V,Y),re=Math.abs(ne[0]-ne[1]),J=Math.abs(ne[2]-ne[3]),ae=Math.abs(ne[0]-ne[2])+Math.abs(ne[1]-ne[3]),le=Math.min(.25,.5*L*(re+J)/V),oe=Math.min(.25,.5*L*ae/Y);return R+Math.max(le*M,oe*k)}(s,l,h):f;return{base:f+(n===0)?-1:n,top:m?Math.max(y+i,f+n+2):f+i}}const nj=new jr({"line-cap":new qt(ke.layout_line["line-cap"]),"line-join":new qt(ke.layout_line["line-join"]),"line-miter-limit":new gt(ke.layout_line["line-miter-limit"]),"line-round-limit":new gt(ke.layout_line["line-round-limit"]),"line-sort-key":new qt(ke.layout_line["line-sort-key"]),visibility:new gt(ke.layout_line.visibility)});var Ek={paint:new jr({"line-opacity":new qt(ke.paint_line["line-opacity"]),"line-color":new qt(ke.paint_line["line-color"]),"line-translate":new gt(ke.paint_line["line-translate"]),"line-translate-anchor":new gt(ke.paint_line["line-translate-anchor"]),"line-width":new qt(ke.paint_line["line-width"]),"line-gap-width":new qt(ke.paint_line["line-gap-width"]),"line-offset":new qt(ke.paint_line["line-offset"]),"line-blur":new qt(ke.paint_line["line-blur"]),"line-dasharray":new qt(ke.paint_line["line-dasharray"]),"line-pattern":new qt(ke.paint_line["line-pattern"]),"line-gradient":new Jc(ke.paint_line["line-gradient"]),"line-trim-offset":new gt(ke.paint_line["line-trim-offset"]),"line-emissive-strength":new gt(ke.paint_line["line-emissive-strength"]),"line-border-width":new qt(ke.paint_line["line-border-width"]),"line-border-color":new qt(ke.paint_line["line-border-color"])}),layout:nj};const Tk=new class extends qt{possiblyEvaluate(t,e){return e=new Nr(Math.floor(e.zoom),{now:e.now,fadeDuration:e.fadeDuration,transition:e.transition}),super.possiblyEvaluate(t,e)}evaluate(t,e,n,i){return e=ge({},e,{zoom:Math.floor(e.zoom)}),super.evaluate(t,e,n,i)}}(Ek.paint.properties["line-width"].specification);function Ck(t,e){return e>0?e+2*t:t}Tk.useIntegerZoom=!0;const rj=new jr({visibility:new gt(ke.layout_background.visibility)});var ij={paint:new jr({"background-color":new gt(ke.paint_background["background-color"]),"background-pattern":new gt(ke.paint_background["background-pattern"]),"background-opacity":new gt(ke.paint_background["background-opacity"]),"background-emissive-strength":new gt(ke.paint_background["background-emissive-strength"])}),layout:rj};const oj=new jr({visibility:new gt(ke.layout_raster.visibility)});var sj={paint:new jr({"raster-opacity":new gt(ke.paint_raster["raster-opacity"]),"raster-color":new Jc(ke.paint_raster["raster-color"]),"raster-color-mix":new gt(ke.paint_raster["raster-color-mix"]),"raster-color-range":new gt(ke.paint_raster["raster-color-range"]),"raster-hue-rotate":new gt(ke.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new gt(ke.paint_raster["raster-brightness-min"]),"raster-brightness-max":new gt(ke.paint_raster["raster-brightness-max"]),"raster-saturation":new gt(ke.paint_raster["raster-saturation"]),"raster-contrast":new gt(ke.paint_raster["raster-contrast"]),"raster-resampling":new gt(ke.paint_raster["raster-resampling"]),"raster-fade-duration":new gt(ke.paint_raster["raster-fade-duration"])}),layout:oj};class aj extends Hn{constructor(e){super(e,{}),this.implementation=e}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}isLayerDraped(){return this.implementation.renderToTile!==void 0}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(e){this.implementation.onAdd&&this.implementation.onAdd(e,e.painter.context.gl)}onRemove(e){this.implementation.onRemove&&this.implementation.onRemove(e,e.painter.context.gl)}}const lj=new jr({visibility:new gt(ke.layout_sky.visibility)});var uj={paint:new jr({"sky-type":new gt(ke.paint_sky["sky-type"]),"sky-atmosphere-sun":new gt(ke.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new gt(ke.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new gt(ke.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new gt(ke.paint_sky["sky-gradient-radius"]),"sky-gradient":new Jc(ke.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new gt(ke.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new gt(ke.paint_sky["sky-atmosphere-color"]),"sky-opacity":new gt(ke.paint_sky["sky-opacity"])}),layout:lj};function YS(t,e,n){const i=[0,0,1],s=uo.identity([]);return uo.rotateY(s,s,n?-Be(t)+Math.PI:Be(t)),uo.rotateX(s,s,-Be(e)),fe.transformQuat(i,i,s),fe.normalize(i,i)}var cj={paint:new jr({})};const hj={circle:class extends Hn{constructor(t,e){super(t,aN,e)}createBucket(t){return new pS(t)}queryRadius(t){const e=t;return ym("circle-radius",this,e)+ym("circle-stroke-width",this,e)+I1(this.paint.get("circle-translate"))}queryIntersectsFeature(t,e,n,i,s,l,u,h){const f=x3(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),l.angle,t.pixelToTileUnitsFactor),m=this.paint.get("circle-radius").evaluate(e,n)+this.paint.get("circle-stroke-width").evaluate(e,n);return w3(t,i,l,u,h,this.paint.get("circle-pitch-alignment")==="map",this.paint.get("circle-pitch-scale")==="map",f,m)}getProgramIds(){return["circle"]}getProgramConfiguration(t){return new al(this,t)}},heatmap:class extends Hn{createBucket(t){return new S3(t)}constructor(t,e){super(t,dN,e),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(t){t==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=k1({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(t){return ym("heatmap-radius",this,t)}queryIntersectsFeature(t,e,n,i,s,l,u,h){const f=this.paint.get("heatmap-radius").evaluate(e,n);return w3(t,i,l,u,h,!0,!0,new q(0,0),f)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}getProgramIds(){return["heatmap","heatmapTexture"]}getProgramConfiguration(t){return new al(this,t)}},hillshade:class extends Hn{constructor(t,e){super(t,pN,e)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}getProgramIds(){return["hillshade","hillshadePrepare"]}},fill:class extends Hn{constructor(t,e){super(t,MN,e)}getProgramIds(){const t=this.paint.get("fill-pattern"),e=t&&t.constantOr(1),n=[e?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&n.push(e&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),n}getProgramConfiguration(t){return new al(this,t)}recalculate(t,e){super.recalculate(t,e);const n=this.paint._values["fill-outline-color"];n.value.kind==="constant"&&n.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(t){return new z1(t)}queryRadius(){return I1(this.paint.get("fill-translate"))}queryIntersectsFeature(t,e,n,i,s,l){return!t.queryGeometry.isAboveHorizon&&m3(v3(t.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),l.angle,t.pixelToTileUnitsFactor),i)}isTileClipped(){return!0}},"fill-extrusion":class extends Hn{constructor(t,e){super(t,tj,e)}createBucket(t){return new k_(t)}queryRadius(){return I1(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}hasShadowPass(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}getProgramConfiguration(t){return new al(this,t)}queryIntersectsFeature(t,e,n,i,s,l,u,h,f){const m=x3(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),l.angle,t.pixelToTileUnitsFactor),y=this.paint.get("fill-extrusion-height").evaluate(e,n),v=this.paint.get("fill-extrusion-base").evaluate(e,n),w=[0,0],S=h&&l.elevation,E=l.elevation?l.elevation.exaggeration():1,A=t.tile.getBucket(this);if(S&&A instanceof k_){const z=A.centroidVertexArray,B=f+1;B<z.length&&(w[0]=z.geta_centroid_pos0(B),w[1]=z.geta_centroid_pos1(B))}if(w[0]===0&&w[1]===1)return!1;l.projection.name==="globe"&&(i=wk([i],[new q(0,0),new q(Ge,Ge)],t.tileID.canonical).map(z=>z.polygon).flat());const M=S?h:null,[k,R]=function(z,B,j,V,Y,ne,re,J,ae,le,oe){return z.projection.name==="globe"?function(Ee,xe,Pe,pe,Ae,Le,qe,Ve,yt,mt,lt){const ft=[],Mt=[],Zt=Ee.projection.upVectorScale(lt,Ee.center.lat,Ee.worldSize).metersToTile,Gt=[0,0,0,1],Ut=[0,0,0,1],Xt=(Pn,or,Rn,Fn)=>{Pn[0]=or,Pn[1]=Rn,Pn[2]=Fn,Pn[3]=1},zn=xk();Pe>0&&(Pe+=zn),pe+=zn;for(const Pn of xe){const or=[],Rn=[];for(const Fn of Pn){const an=Fn.x+Ae.x,An=Fn.y+Ae.y,sr=Ee.projection.projectTilePoint(an,An,lt),Mn=Ee.projection.upVector(lt,Fn.x,Fn.y);let cr=Pe,fi=pe;if(qe){const pi=Sk(an,An,Pe,pe,qe,Ve,yt,mt);cr+=pi.base,fi+=pi.top}Pe!==0?Xt(Gt,sr.x+Mn[0]*Zt*cr,sr.y+Mn[1]*Zt*cr,sr.z+Mn[2]*Zt*cr):Xt(Gt,sr.x,sr.y,sr.z),Xt(Ut,sr.x+Mn[0]*Zt*fi,sr.y+Mn[1]*Zt*fi,sr.z+Mn[2]*Zt*fi),fe.transformMat4(Gt,Gt,Le),fe.transformMat4(Ut,Ut,Le),or.push(new Dm(Gt[0],Gt[1],Gt[2])),Rn.push(new Dm(Ut[0],Ut[1],Ut[2]))}ft.push(or),Mt.push(Rn)}return[ft,Mt]}(z,B,j,V,Y,ne,re,J,ae,le,oe):re?function(Ee,xe,Pe,pe,Ae,Le,qe,Ve,yt){const mt=[],lt=[],ft=[0,0,0,1];for(const Mt of Ee){const Zt=[],Gt=[];for(const Ut of Mt){const Xt=Ut.x+pe.x,zn=Ut.y+pe.y,Pn=Sk(Xt,zn,xe,Pe,Le,qe,Ve,yt);ft[0]=Xt,ft[1]=zn,ft[2]=Pn.base,ft[3]=1,xr.transformMat4(ft,ft,Ae),ft[3]=Math.max(ft[3],1e-5);const or=new Dm(ft[0]/ft[3],ft[1]/ft[3],ft[2]/ft[3]);ft[0]=Xt,ft[1]=zn,ft[2]=Pn.top,ft[3]=1,xr.transformMat4(ft,ft,Ae),ft[3]=Math.max(ft[3],1e-5);const Rn=new Dm(ft[0]/ft[3],ft[1]/ft[3],ft[2]/ft[3]);Zt.push(or),Gt.push(Rn)}mt.push(Zt),lt.push(Gt)}return[mt,lt]}(B,j,V,Y,ne,re,J,ae,le):function(Ee,xe,Pe,pe,Ae){const Le=[],qe=[],Ve=Ae[8]*xe,yt=Ae[9]*xe,mt=Ae[10]*xe,lt=Ae[11]*xe,ft=Ae[8]*Pe,Mt=Ae[9]*Pe,Zt=Ae[10]*Pe,Gt=Ae[11]*Pe;for(const Ut of Ee){const Xt=[],zn=[];for(const Pn of Ut){const or=Pn.x+pe.x,Rn=Pn.y+pe.y,Fn=Ae[0]*or+Ae[4]*Rn+Ae[12],an=Ae[1]*or+Ae[5]*Rn+Ae[13],An=Ae[2]*or+Ae[6]*Rn+Ae[14],sr=Ae[3]*or+Ae[7]*Rn+Ae[15],Mn=Fn+Ve,cr=an+yt,fi=An+mt,pi=Math.max(sr+lt,1e-5),Zr=Fn+ft,zr=an+Mt,Mi=An+Zt,qr=Math.max(sr+Gt,1e-5);Xt.push(new Dm(Mn/pi,cr/pi,fi/pi)),zn.push(new Dm(Zr/qr,zr/qr,Mi/qr))}Le.push(Xt),qe.push(zn)}return[Le,qe]}(B,j,V,Y,ne)}(l,i,v,y,m,u,M,w,E,l.center.lat,t.tileID.canonical),L=t.queryGeometry;return function(z,B,j){let V=1/0;m3(j,B)&&(V=bk(j,B[0]));for(let Y=0;Y<B.length;Y++){const ne=B[Y],re=z[Y];for(let J=0;J<ne.length-1;J++){const ae=ne[J],le=[ae,ne[J+1],re[J+1],re[J],ae];p3(j,le)&&(V=Math.min(V,bk(j,le)))}}return V!==1/0&&V}(k,R,L.isPointQuery()?L.screenBounds:L.screenGeometry)}},line:class extends Hn{constructor(t,e){super(t,Ek,e),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(t){if(t==="line-gradient"){const e=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=e._styleExpression&&e._styleExpression.expression instanceof fy,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(t,e){super.recalculate(t,e),this.paint._values["line-floorwidth"]=Tk.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,t)}createBucket(t){return new ix(t)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getProgramConfiguration(t){return new al(this,t)}queryRadius(t){const e=t,n=Ck(ym("line-width",this,e),ym("line-gap-width",this,e)),i=ym("line-offset",this,e);return n/2+Math.abs(i)+I1(this.paint.get("line-translate"))}queryIntersectsFeature(t,e,n,i,s,l){if(t.queryGeometry.isAboveHorizon)return!1;const u=v3(t.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),l.angle,t.pixelToTileUnitsFactor),h=t.pixelToTileUnitsFactor/2*Ck(this.paint.get("line-width").evaluate(e,n),this.paint.get("line-gap-width").evaluate(e,n)),f=this.paint.get("line-offset").evaluate(e,n);return f&&(i=function(m,y){const v=[],w=new q(0,0);for(let S=0;S<m.length;S++){const E=m[S],A=[];for(let M=0;M<E.length;M++){const k=E[M],R=E[M+1],L=M===0?w:k.sub(E[M-1])._unit()._perp(),z=M===E.length-1?w:R.sub(k)._unit()._perp(),B=L._add(z)._unit();B._mult(1/(B.x*z.x+B.y*z.y)),A.push(B._mult(y)._add(k))}v.push(A)}return v}(i,f*t.pixelToTileUnitsFactor)),function(m,y,v){for(let w=0;w<y.length;w++){const S=y[w];if(m.length>=3){for(let E=0;E<S.length;E++)if(gh(m,S[E]))return!0}if(rN(m,S,v))return!0}return!1}(u,i,h)}isTileClipped(){return!0}},symbol:Q1,background:class extends Hn{constructor(t,e){super(t,ij,e)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}},raster:class extends Hn{constructor(t,e){super(t,sj,e),this._updateColorRamp()}getProgramIds(){return["raster"]}hasColorMap(){return!!this._transitionablePaint._values["raster-color"].value.value}_handleSpecialPaintPropertyUpdate(t){t!=="raster-color"&&t!=="raster-color-range"||this._updateColorRamp()}_updateColorRamp(){if(!this.hasColorMap())return;const t=this._transitionablePaint._values["raster-color"].value.expression,[e,n]=this._transitionablePaint._values["raster-color-range"].value.expression.evaluate({zoom:0});this.colorRamp=k1({expression:t,evaluationKey:"rasterValue",image:this.colorRamp,clips:[{start:e,end:n}]}),this.colorRampTexture=null}},sky:class extends Hn{constructor(t,e){super(t,uj,e),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(t){t==="sky-gradient"?this._updateColorRamp():t!=="sky-atmosphere-sun"&&t!=="sky-atmosphere-halo-color"&&t!=="sky-atmosphere-color"&&t!=="sky-atmosphere-sun-intensity"||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=k1({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(t){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const e=t.style.light.properties.get("position");return this._lightPosition.azimuthal!==e.azimuthal||this._lightPosition.polar!==e.polar}return!1}getCenter(t,e){if(this.paint.get("sky-type")==="atmosphere"){const i=this.paint.get("sky-atmosphere-sun"),s=!i,l=t.style.light,u=l.properties.get("position");return s&&l.properties.get("anchor")==="viewport"&&ye("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),s?YS(u.azimuthal,90-u.polar,e):YS(i[0],90-i[1],e)}const n=this.paint.get("sky-gradient-center");return YS(n[0],90-n[1],e)}isSky(){return!0}markSkyboxValid(t){this._skyboxInvalidated=!1,this._lightPosition=t.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const t=this.paint.get("sky-type");return t==="atmosphere"?["skyboxCapture","skybox"]:t==="gradient"?["skyboxGradient"]:null}},slot:class extends Hn{constructor(t,e){super(t,cj)}},model:class extends Hn{constructor(t,e){super(t,H8,e)}createBucket(t){return new ek(t)}getProgramIds(){return["model"]}is3D(){return!0}hasShadowPass(){return!0}hasLightBeamPass(){return!0}queryRadius(){return 0}_handleOverridablePaintPropertyUpdate(t,e,n){return!(!this.layout||e.isDataDriven()||n.isDataDriven()||t!=="model-color"&&t!=="model-color-mix-intensity"&&t!=="model-rotation"&&t!=="model-scale"&&t!=="model-translation"&&t!=="model-emissive-strength")}}};function gx(t,e){return t.type==="custom"?new aj(t):new hj[t.type](t,e)}function dj(t){const{userImage:e}=t;return!!(e&&e.render&&e.render())&&(t.data.replace(new Uint8Array(e.data.buffer)),!0)}class fj extends Cr{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded={},this.requestors=[],this.patterns={},this.atlasImage={},this.atlasTexture={},this.dirty=!0}createScope(e){this.images[e]={},this.loaded[e]=!1,this.updatedImages[e]={},this.patterns[e]={},this.callbackDispatchedThisFrame[e]={},this.atlasImage[e]=new ui({width:1,height:1})}isLoaded(){for(const e in this.loaded)if(!this.loaded[e])return!1;return!0}setLoaded(e,n){if(this.loaded[n]!==e&&(this.loaded[n]=e,e)){for(const{ids:i,callback:s}of this.requestors)this._notify(i,n,s);this.requestors=[]}}hasImage(e,n){return!!this.getImage(e,n)}getImage(e,n){return this.images[n][e]}addImage(e,n,i){this._validate(e,i)&&(this.images[n][e]=i)}_validate(e,n){let i=!0;return this._validateStretch(n.stretchX,n.data&&n.data.width)||(this.fire(new en(new Error(`Image "${e}" has invalid "stretchX" value`))),i=!1),this._validateStretch(n.stretchY,n.data&&n.data.height)||(this.fire(new en(new Error(`Image "${e}" has invalid "stretchY" value`))),i=!1),this._validateContent(n.content,n)||(this.fire(new en(new Error(`Image "${e}" has invalid "content" value`))),i=!1),i}_validateStretch(e,n){if(!e)return!0;let i=0;for(const s of e){if(s[0]<i||s[1]<s[0]||n<s[1])return!1;i=s[1]}return!0}_validateContent(e,n){return!(e&&(e.length!==4||e[0]<0||n.data.width<e[0]||e[1]<0||n.data.height<e[1]||e[2]<0||n.data.width<e[2]||e[3]<0||n.data.height<e[3]||e[2]<e[0]||e[3]<e[1]))}updateImage(e,n,i){i.version=this.images[n][e].version+1,this.images[n][e]=i,this.updatedImages[n][e]=!0}removeImage(e,n){const i=this.images[n][e];delete this.images[n][e],delete this.patterns[n][e],i.userImage&&i.userImage.onRemove&&i.userImage.onRemove()}listImages(e){return Object.keys(this.images[e])}getImages(e,n,i){let s=!0;const l=!!this.loaded[n];if(!l)for(const u of e)this.images[n][u]||(s=!1);l||s?this._notify(e,n,i):this.requestors.push({ids:e,scope:n,callback:i})}getUpdatedImages(e){return this.updatedImages[e]}_notify(e,n,i){const s={};for(const l of e){this.images[n][l]||this.fire(new ct("styleimagemissing",{id:l}));const u=this.images[n][l];u?s[l]={data:u.data.clone(),pixelRatio:u.pixelRatio,sdf:u.sdf,version:u.version,stretchX:u.stretchX,stretchY:u.stretchY,content:u.content,hasRenderCallback:!!(u.userImage&&u.userImage.render)}:ye(`Image "${l}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}i(null,s)}getPixelSize(e){const{width:n,height:i}=this.atlasImage[e];return{width:n,height:i}}getPattern(e,n){const i=this.patterns[n][e],s=this.getImage(e,n);if(!s)return null;if(i&&i.position.version===s.version)return i.position;if(i)i.position.version=s.version;else{const l={w:s.data.width+2,h:s.data.height+2,x:0,y:0},u=new RS(l,s);this.patterns[n][e]={bin:l,position:u}}return this._updatePatternAtlas(n),this.patterns[n][e].position}bind(e,n){const i=e.gl;let s=this.atlasTexture[n];s?this.dirty&&(s.update(this.atlasImage[n]),this.dirty=!1):(s=new Ai(e,this.atlasImage[n],i.RGBA),this.atlasTexture[n]=s),s.bind(i.LINEAR,i.CLAMP_TO_EDGE)}_updatePatternAtlas(e){const n=[];for(const u in this.patterns[e])n.push(this.patterns[e][u].bin);const{w:i,h:s}=PS(n),l=this.atlasImage[e];l.resize({width:i||1,height:s||1});for(const u in this.patterns[e]){const{bin:h}=this.patterns[e][u],f=h.x+1,m=h.y+1,y=this.images[e][u].data,v=y.width,w=y.height;ui.copy(y,l,{x:0,y:0},{x:f,y:m},{width:v,height:w}),ui.copy(y,l,{x:0,y:w-1},{x:f,y:m-1},{width:v,height:1}),ui.copy(y,l,{x:0,y:0},{x:f,y:m+w},{width:v,height:1}),ui.copy(y,l,{x:v-1,y:0},{x:f-1,y:m},{width:1,height:w}),ui.copy(y,l,{x:0,y:0},{x:f+v,y:m},{width:1,height:w})}this.dirty=!0}beginFrame(){for(const e in this.images)this.callbackDispatchedThisFrame[e]={}}dispatchRenderCallbacks(e,n){for(const i of e){if(this.callbackDispatchedThisFrame[n][i])continue;this.callbackDispatchedThisFrame[n][i]=!0;const s=this.images[n][i];dj(s)&&this.updateImage(i,n,s)}}}const pj=new jr({anchor:new gt(ke.light.anchor),position:new class{constructor(t){this.specification=t}possiblyEvaluate(t,e){return bt(t.expression.evaluate(e))}interpolate(t,e,n){return{x:nn(t.x,e.x,n),y:nn(t.y,e.y,n),z:nn(t.z,e.z,n),azimuthal:nn(t.azimuthal,e.azimuthal,n),polar:nn(t.polar,e.polar,n)}}}(ke.light.position),color:new gt(ke.light.color),intensity:new gt(ke.light.intensity)});class Ak extends Cr{constructor(e,n="flat"){super(),this._transitionable=new Qc(pj),this.setLight(e,n),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(e,n,i={}){this._validate(Yv,e,i)||(this._transitionable.setTransitionOrValue(e),this.id=n)}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}_validate(e,n,i){return(!i||i.validate!==!1)&&ti(this,e.call(Gu,ge({value:n,style:{glyphs:!0,sprite:!0},styleSpec:ke})))}}const mj=new jr({source:new gt(ke.terrain.source),exaggeration:new gt(ke.terrain.exaggeration)});let gj=class extends Cr{constructor(t,e){super(),this._transitionable=new Qc(mj),this.set(t),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=e}get(){return this._transitionable.serialize()}set(t){this._transitionable.setTransitionOrValue(t)}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}};function Mk(t,e,n,i){const s=De(45,65,n),[l,u]=Ik(t,i),h=fe.length(e);let f=1-Math.min(1,Math.exp((h-l)/(u-l)*-6));return f*=f*f,f=Math.min(1,1.00747*f),f*s*t.alpha}function Ik(t,e){const n=.5/Math.tan(.5*e);return[t.range[0]+n,t.range[1]+n]}const yj=new jr({range:new gt(ke.fog.range),color:new gt(ke.fog.color),"high-color":new gt(ke.fog["high-color"]),"space-color":new gt(ke.fog["space-color"]),"horizon-blend":new gt(ke.fog["horizon-blend"]),"star-intensity":new gt(ke.fog["star-intensity"])});class _j extends Cr{constructor(e,n){super(),this._transitionable=new Qc(yj),this.set(e),this._transitioning=this._transitionable.untransitioned(),this._transform=n}get state(){const e=this._transform,n=e.projection.name==="globe",i=ro(e.zoom),s=this.properties.get("range"),l=[.5,3];return{range:n?[nn(l[0],s[0],i),nn(l[1],s[1],i)]:s,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(e,n={}){if(!this._validate(jd,e,n)){for(const i of Object.keys(ke.fog))e&&e[i]===void 0&&(e[i]=ke.fog[i].default);this._transitionable.setTransitionOrValue(e)}}getOpacity(e){if(!this._transform.projection.supportsFog)return 0;const n=this.properties&&this.properties.get("color")||1;return(this._transform.projection.name==="globe"?1:De(45,65,e))*n.a}getOpacityAtLatLng(e,n){return this._transform.projection.supportsFog?function(i,s,l){const u=Un.fromLngLat(s),h=l.elevation?l.elevation.getAtPointOrZero(u):0,f=[u.x,u.y,h];return fe.transformMat4(f,f,l.mercatorFogMatrix),Mk(i,f,l.pitch,l._fov)}(this.state,e,n):0}getFovAdjustedRange(e){return this._transform.projection.supportsFog?Ik(this.state,e):[0,1]}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}_validate(e,n,i){return(!i||i.validate!==!1)&&ti(this,e.call(Gu,ge({value:n,style:{glyphs:!0,sprite:!0},styleSpec:ke})))}}class vj{constructor(e){this._callback=e,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class xj{constructor(){this.tasks={},this.taskQueue=[],On(["process"],this),this.invoker=new vj(this.process),this.nextId=0}add(e,n){const i=this.nextId++,s=function({type:l,isSymbolTile:u,zoom:h}){return h=h||0,l==="message"?0:l!=="maybePrepare"||u?l!=="parseTile"||u?l==="parseTile"&&u?300-h:l==="maybePrepare"&&u?400-h:500:200-h:100-h}(n);if(s===0){Ne();try{e()}finally{}return{cancel:()=>{}}}return this.tasks[i]={fn:e,metadata:n,priority:s,id:i},this.taskQueue.push(i),this.invoker.trigger(),{cancel:()=>{delete this.tasks[i]}}}process(){Ne();try{if(this.taskQueue=this.taskQueue.filter(i=>!!this.tasks[i]),!this.taskQueue.length)return;const e=this.pick();if(e===null)return;const n=this.tasks[e];if(delete this.tasks[e],this.taskQueue.length&&this.invoker.trigger(),!n)return;n.fn()}finally{}}pick(){let e=null,n=1/0;for(let s=0;s<this.taskQueue.length;s++){const l=this.tasks[this.taskQueue[s]];l.priority<n&&(n=l.priority,e=s)}if(e===null)return null;const i=this.taskQueue[e];return this.taskQueue.splice(e,1),i}remove(){this.invoker.remove()}}class kk{constructor(e,n,i){this.target=e,this.parent=n,this.mapId=i,this.callbacks={},this.cancelCallbacks={},On(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.globalScope=Ne()?e:C,this.scheduler=new xj}send(e,n,i,s,l=!1,u){const h=Math.round(1e18*Math.random()).toString(36).substring(0,10);i&&(i.metadata=u,this.callbacks[h]=i);const f=Wt(this.globalScope)?void 0:[];return this.target.postMessage({id:h,type:e,hasCallback:!!i,targetMapId:s,mustQueue:l,sourceMapId:this.mapId,data:_i(n,f)},f),{cancel:()=>{i&&delete this.callbacks[h],this.target.postMessage({id:h,type:"<cancel>",targetMapId:s,sourceMapId:this.mapId})}}}receive(e){const n=e.data,i=n.id;if(i&&(!n.targetMapId||this.mapId===n.targetMapId))if(n.type==="<cancel>"){const s=this.cancelCallbacks[i];delete this.cancelCallbacks[i],s&&s.cancel()}else if(n.mustQueue||Ne()){const s=this.callbacks[i];this.cancelCallbacks[i]=this.scheduler.add(()=>this.processTask(i,n),s&&s.metadata||{type:"message"})}else this.processTask(i,n)}processTask(e,n){if(n.type==="<response>"){const i=this.callbacks[e];delete this.callbacks[e],i&&(n.error?i(il(n.error)):i(null,il(n.data)))}else{const i=Wt(this.globalScope)?void 0:[],s=n.hasCallback?(u,h)=>{delete this.cancelCallbacks[e],this.target.postMessage({id:e,type:"<response>",sourceMapId:this.mapId,error:u?_i(u):null,data:_i(h,i)},i)}:u=>{},l=il(n.data);if(this.parent[n.type])this.parent[n.type](n.sourceMapId,l,s);else if(this.parent.getWorkerSource){const u=n.type.split(".");this.parent.getWorkerSource(n.sourceMapId,u[0],l.source,l.scope)[u[1]](l,s)}else s(new Error(`Could not find function ${n.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}}class ff{constructor(e,n){this.workerPool=e,this.actors=[],this.currentActor=0,this.id=Dn();const i=this.workerPool.acquire(this.id);for(let s=0;s<i.length;s++){const l=new ff.Actor(i[s],n,this.id);l.name=`Worker ${s}`,this.actors.push(l)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(e,n,i){$e(this.actors,(s,l)=>{s.send(e,n,l)},i=i||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(e=>{e.remove()}),this.actors=[],this.workerPool.release(this.id)}}ff.Actor=kk;class Pk extends Cr{constructor(e,n,i){super(),this._options=e,this._transitionable=new Qc(n,i),this._transitionable.setTransitionOrValue(e.properties),this._transitioning=this._transitionable.untransitioned()}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}get(){return this._options.properties=this._transitionable.serialize(),this._options}}const wj=new jr({color:new gt(ke.properties_light_ambient.color),intensity:new gt(ke.properties_light_ambient.intensity)}),bj=new jr({direction:new class{constructor(t){this.specification=t}possiblyEvaluate(t,e){return function([n,i]){const s=bt([1,n,i]);return{x:s.x,y:s.y,z:s.z}}(t.expression.evaluate(e))}interpolate(t,e,n){return{x:nn(t.x,e.x,n),y:nn(t.y,e.y,n),z:nn(t.z,e.z,n)}}}(ke.properties_light_directional.direction),color:new gt(ke.properties_light_directional.color),intensity:new gt(ke.properties_light_directional.intensity),"cast-shadows":new gt(ke.properties_light_directional["cast-shadows"]),"shadow-intensity":new gt(ke.properties_light_directional["shadow-intensity"])});class QS{constructor(e,n,i,s){this.screenBounds=e,this.cameraPoint=n,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=i,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,s)}static createFromScreenPoints(e,n){let i,s;if(e instanceof q||typeof e[0]=="number"){const l=q.convert(e);i=[l],s=n.isPointAboveHorizon(l)}else{const l=q.convert(e[0]),u=q.convert(e[1]);i=[l,u],s=Te(l,u).every(h=>n.isPointAboveHorizon(h))}return new QS(i,n.getCameraPoint(),s,n)}isPointQuery(){return this.screenBounds.length===1}bufferedScreenGeometry(e){return Te(this.screenBounds[0],this.screenBounds.length===1?this.screenBounds[0]:this.screenBounds[1],e)}bufferedCameraGeometry(e){const n=this.screenBounds[0],i=this.screenBounds.length===1?this.screenBounds[0].add(new q(1,1)):this.screenBounds[1],s=Te(n,i,0,!1);return this.cameraPoint.y>i.y&&(this.cameraPoint.x>n.x&&this.cameraPoint.x<i.x?s.splice(3,0,this.cameraPoint):this.cameraPoint.x>=i.x?s[2]=this.cameraPoint:this.cameraPoint.x<=n.x&&(s[3]=this.cameraPoint)),function(l,u){const h=[];for(let f=0;f<l.length;f++){const m=He(f-1,-1,l.length-1),y=He(f+1,-1,l.length-1),v=l[f],w=l[y],S=l[m].sub(v).unit(),E=w.sub(v).unit(),A=E.angleWithSep(S.x,S.y),M=S.add(E).unit().mult(-1*u/Math.sin(A/2));h.push(v.add(M))}return h}(s,e)}bufferedCameraGeometryGlobe(e){const n=this.screenBounds[0],i=this.screenBounds.length===1?this.screenBounds[0].add(new q(1,1)):this.screenBounds[1],s=Te(n,i,e),l=this.cameraPoint.clone();switch(3*((l.y>n.y)+(l.y>i.y))+((l.x>n.x)+(l.x>i.x))){case 0:s[0]=l,s[4]=l.clone();break;case 1:s.splice(1,0,l);break;case 2:s[1]=l;break;case 3:s.splice(4,0,l);break;case 5:s.splice(2,0,l);break;case 6:s[3]=l;break;case 7:s.splice(3,0,l);break;case 8:s[2]=l}return s}containsTile(e,n,i,s=0){const l=e.queryPadding/n._pixelsPerMercatorPixel+1,u=i?this._bufferedCameraMercator(l,n):this._bufferedScreenMercator(l,n);let h=e.tileID.wrap+(u.unwrapped?s:0);const f=u.polygon.map(M=>vI(e.tileTransform,M,h));if(!_3(f,0,0,Ge,Ge))return;h=e.tileID.wrap+(this.screenGeometryMercator.unwrapped?s:0);const m=this.screenGeometryMercator.polygon.map(M=>xI(e.tileTransform,M,h)),y=m.map(M=>new q(M[0],M[1])),v=n.getFreeCameraOptions().position||new Un(0,0,0),w=xI(e.tileTransform,v,h),S=m.map(M=>{const k=fe.sub(M,M,w);return fe.normalize(k,k),new w1(w,k)}),E=df(e,1,n.zoom)*n._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:y,tilespaceRays:S,bufferedTilespaceGeometry:f,bufferedTilespaceBounds:(A=dt(f),A.min.x=ce(A.min.x,0,Ge),A.min.y=ce(A.min.y,0,Ge),A.max.x=ce(A.max.x,0,Ge),A.max.y=ce(A.max.y,0,Ge),A),tile:e,tileID:e.tileID,pixelToTileUnitsFactor:E};var A}_bufferedScreenMercator(e,n){const i=Rk(e);if(this._screenRaycastCache[i])return this._screenRaycastCache[i];{let s;return s=n.projection.name==="globe"?this._projectAndResample(this.bufferedScreenGeometry(e),n):{polygon:this.bufferedScreenGeometry(e).map(l=>n.pointCoordinate3D(l)),unwrapped:!0},this._screenRaycastCache[i]=s,s}}_bufferedCameraMercator(e,n){const i=Rk(e);if(this._cameraRaycastCache[i])return this._cameraRaycastCache[i];{let s;return s=n.projection.name==="globe"?this._projectAndResample(this.bufferedCameraGeometryGlobe(e),n):{polygon:this.bufferedCameraGeometry(e).map(l=>n.pointCoordinate3D(l)),unwrapped:!0},this._cameraRaycastCache[i]=s,s}}_projectAndResample(e,n){const i=function(l,u){const h=Me.multiply([],u.pixelMatrix,u.globeMatrix),f=[0,-Ds,0,1],m=[0,Ds,0,1],y=[0,0,0,1];xr.transformMat4(f,f,h),xr.transformMat4(m,m,h),xr.transformMat4(y,y,h);const v=new q(f[0]/f[3],f[1]/f[3]),w=new q(m[0]/m[3],m[1]/m[3]),S=gh(l,v)&&f[3]<y[3],E=gh(l,w)&&m[3]<y[3];if(!S&&!E)return null;const A=function(V,Y,ne){for(let re=1;re<V.length;re++){const J=R_(Y.pointCoordinate3D(V[re-1]).x),ae=R_(Y.pointCoordinate3D(V[re]).x);if(ne<0){if(J<ae)return{idx:re,t:-J/(ae-1-J)}}else if(ae<J)return{idx:re,t:(1-J)/(ae+1-J)}}return null}(l,u,S?-1:1);if(!A)return null;const{idx:M,t:k}=A;let R=M>1?JS(l.slice(0,M),u):[],L=M<l.length?JS(l.slice(M),u):[];R=R.map(V=>new q(R_(V.x),V.y)),L=L.map(V=>new q(R_(V.x),V.y));const z=[...R];z.length===0&&z.push(L[L.length-1]);const B=nn(z[z.length-1].y,(L.length===0?R[0]:L[0]).y,k);let j;return j=S?[new q(0,B),new q(0,0),new q(1,0),new q(1,B)]:[new q(1,B),new q(1,1),new q(0,1),new q(0,B)],z.push(...j),L.length===0?z.push(R[0]):z.push(...L),{polygon:z.map(V=>new Un(V.x,V.y)),unwrapped:!1}}(e,n);if(i)return i;const s=function(l,u){let h=!1,f=-1/0,m=0;for(let v=0;v<l.length-1;v++)l[v].x>f&&(f=l[v].x,m=v);for(let v=0;v<l.length-1;v++){const w=(m+v)%(l.length-1),S=l[w],E=l[w+1];Math.abs(S.x-E.x)>.5&&(S.x<E.x?(S.x+=1,w===0&&(l[l.length-1].x+=1)):(E.x+=1,w+1===l.length-1&&(l[0].x+=1)),h=!0)}const y=io(u.center.lng);return h&&y<Math.abs(y-1)&&l.forEach(v=>{v.x-=1}),{polygon:l,unwrapped:h}}(JS(e,n).map(l=>new q(R_(l.x),l.y)),n);return{polygon:s.polygon.map(l=>new Un(l.x,l.y)),unwrapped:s.unwrapped}}}function JS(t,e){return d3(t,n=>{const i=e.pointCoordinate3D(n);n.x=i.x,n.y=i.y},1/256)}function R_(t){return t<0?1+t%1:t%1}function Rk(t){return 100*t|0}function eE(t,e,n,i,s){const l=function(u,h){if(u)return s(u);if(h){t.url&&h.tiles&&t.tiles&&delete t.tiles;const f=Pt(ge(h,t),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);h.vector_layers&&(f.vectorLayers=h.vector_layers,f.vectorLayerIds=f.vectorLayers.map(m=>m.id)),f.tiles=e.canonicalizeTileset(f,t.url),s(null,f)}};return t.url?ht(e.transformRequest(e.normalizeSourceURL(t.url,null,n,i),Ie.Source),l):mn.frame(()=>l(null,t))}class yx{constructor(e,n,i){this.bounds=li.convert(this.validateBounds(e)),this.minzoom=n||0,this.maxzoom=i||24}validateBounds(e){return Array.isArray(e)&&e.length===4?[Math.max(-180,e[0]),Math.max(-90,e[1]),Math.min(180,e[2]),Math.min(90,e[3])]:[-180,-90,180,90]}contains(e){const n=Math.pow(2,e.z),i=Math.floor(io(this.bounds.getWest())*n),s=Math.floor(co(this.bounds.getNorth())*n),l=Math.ceil(io(this.bounds.getEast())*n),u=Math.ceil(co(this.bounds.getSouth())*n);return e.x>=i&&e.x<l&&e.y>=s&&e.y<u}}class Dk{constructor(e,n){this.width=e,this.height=n,this.nextRow=0,this.image=new ic({width:e,height:n}),this.positions={},this.uploaded=!1}getDash(e,n){const i=this.getKey(e,n);return this.positions[i]}trim(){const e=this.width,n=this.height=Ln(this.nextRow);this.image.resize({width:e,height:n})}getKey(e,n){return e.join(",")+n}getDashRanges(e,n,i){const s=[];let l=e.length%2==1?-e[e.length-1]*i:0,u=e[0]*i,h=!0;s.push({left:l,right:u,isDash:h,zeroLength:e[0]===0});let f=e[0];for(let m=1;m<e.length;m++){h=!h;const y=e[m];l=f*i,f+=y,u=f*i,s.push({left:l,right:u,isDash:h,zeroLength:y===0})}return s}addRoundDash(e,n,i){const s=n/2;for(let l=-i;l<=i;l++){const u=this.width*(this.nextRow+i+l);let h=0,f=e[h];for(let m=0;m<this.width;m++){m/f.right>1&&(f=e[++h]);const y=Math.abs(m-f.left),v=Math.abs(m-f.right),w=Math.min(y,v);let S;const E=l/i*(s+1);if(f.isDash){const A=s-Math.abs(E);S=Math.sqrt(w*w+A*A)}else S=s-Math.sqrt(w*w+E*E);this.image.data[u+m]=Math.max(0,Math.min(255,S+128))}}}addRegularDash(e,n){for(let f=e.length-1;f>=0;--f){const m=e[f],y=e[f+1];m.zeroLength?e.splice(f,1):y&&y.isDash===m.isDash&&(y.left=m.left,e.splice(f,1))}const i=e[0],s=e[e.length-1];i.isDash===s.isDash&&(i.left=s.left-this.width,s.right=i.right+this.width);const l=this.width*this.nextRow;let u=0,h=e[u];for(let f=0;f<this.width;f++){f/h.right>1&&(h=e[++u]);const m=Math.abs(f-h.left),y=Math.abs(f-h.right),v=Math.min(m,y);this.image.data[l+f]=Math.max(0,Math.min(255,(h.isDash?v:-v)+n+128))}}addDash(e,n){const i=this.getKey(e,n);if(this.positions[i])return this.positions[i];const s=n==="round",l=s?7:0,u=2*l+1;if(this.nextRow+u>this.height)return ye("LineAtlas out of space"),null;e.length===0&&e.push(1);let h=0;for(let y=0;y<e.length;y++)e[y]<0&&(ye("Negative value is found in line dasharray, replacing values with 0"),e[y]=0),h+=e[y];if(h!==0){const y=this.width/h,v=this.getDashRanges(e,this.width,y);s?this.addRoundDash(v,y,l):this.addRegularDash(v,n==="square"?.5*y:0)}const f=this.nextRow+l;this.nextRow+=u;const m={tl:[f,l],br:[h,0]};return this.positions[i]=m,m}}kt(Dk,"LineAtlas");const Lk=1*yl;class Ok{constructor(e){const n={},i=[];for(const h in e){const f=e[h],m=n[h]={};for(const y in f.glyphs){const v=f.glyphs[+y];if(!v||v.bitmap.width===0||v.bitmap.height===0)continue;const w=v.metrics.localGlyph?Lk:1,S={x:0,y:0,w:v.bitmap.width+2*w,h:v.bitmap.height+2*w};i.push(S),m[y]=S}}const{w:s,h:l}=PS(i),u=new ic({width:s||1,height:l||1});for(const h in e){const f=e[h];for(const m in f.glyphs){const y=f.glyphs[+m];if(!y||y.bitmap.width===0||y.bitmap.height===0)continue;const v=n[h][m],w=y.metrics.localGlyph?Lk:1;ic.copy(y.bitmap,u,{x:0,y:0},{x:v.x+w,y:v.y+w},y.bitmap)}}this.image=u,this.positions=n}}kt(Ok,"GlyphAtlas");class Sj{constructor(e){this.tileID=new Ir(e.tileID.overscaledZ,e.tileID.wrap,e.tileID.canonical.z,e.tileID.canonical.x,e.tileID.canonical.y),this.tileZoom=e.tileZoom,this.uid=e.uid,this.zoom=e.zoom,this.canonical=e.tileID.canonical,this.pixelRatio=e.pixelRatio,this.tileSize=e.tileSize,this.source=e.source,this.scope=e.scope,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=e.showCollisionBoxes,this.collectResourceTiming=!!e.collectResourceTiming,this.returnDependencies=!!e.returnDependencies,this.promoteId=e.promoteId,this.enableTerrain=!!e.enableTerrain,this.isSymbolTile=e.isSymbolTile,this.tileTransform=hf(e.tileID.canonical,e.projection),this.projection=e.projection,this.brightness=e.brightness}parse(e,n,i,s,l){this.status="parsing",this.data=e,this.collisionBoxArray=new Kd;const u=new D3(Object.keys(e.layers).sort()),h=new MS(this.tileID,this.promoteId);h.bucketLayerIDs=[];const f={},m=new Dk(256,256),y={featureIndex:h,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:m,availableImages:i,brightness:this.brightness},v=n.familiesBySource[this.source];for(const B in v){const j=e.layers[B];if(!j)continue;let V=!1,Y=!1;for(const J of v[B])J[0].type==="symbol"?V=!0:Y=!0;if(this.isSymbolTile===!0&&!V||this.isSymbolTile===!1&&!Y)continue;j.version===1&&ye(`Vector tile source "${this.source}" layer "${B}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const ne=u.encode(B),re=[];for(let J=0;J<j.length;J++){const ae=j.feature(J),le=h.getId(ae,B);re.push({feature:ae,id:le,index:J,sourceLayerIndex:ne})}for(const J of v[B]){const ae=J[0];this.isSymbolTile!==void 0&&ae.type==="symbol"!==this.isSymbolTile||ae.minzoom&&this.zoom<Math.floor(ae.minzoom)||ae.maxzoom&&this.zoom>=ae.maxzoom||ae.visibility!=="none"&&(tE(J,this.zoom,y.brightness,i),(f[ae.id]=ae.createBucket({index:h.bucketLayerIDs.length,layers:J,zoom:this.zoom,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:ne,sourceID:this.source,enableTerrain:this.enableTerrain,projection:this.projection.spec})).populate(re,y,this.tileID.canonical,this.tileTransform),h.bucketLayerIDs.push(J.map(le=>le.id)))}}let w,S,E,A;m.trim();const M={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},k=()=>{if(w)return l(w);if(S&&E&&A){const B=new Ok(S),j=new Y3(E,A);for(const V in f){const Y=f[V];Y instanceof S_?(tE(Y.layers,this.zoom,y.brightness,i),A6(Y,S,B.positions,E,j.iconPositions,this.showCollisionBoxes,i,this.tileID.canonical,this.tileZoom,this.projection,this.brightness)):Y.hasPattern&&(Y instanceof ix||Y instanceof z1||Y instanceof k_)&&(tE(Y.layers,this.zoom,y.brightness,i),Y.addFeatures(y,this.tileID.canonical,j.patternPositions,i,this.tileTransform,this.brightness))}this.status="done",l(null,{buckets:xt(f).filter(V=>!V.isEmpty()),featureIndex:h,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:B.image,lineAtlas:m,imageAtlas:j,brightness:y.brightness,glyphMap:this.returnDependencies?S:null,iconMap:this.returnDependencies?E:null,glyphPositions:this.returnDependencies?B.positions:null})}},R=bn(y.glyphDependencies,B=>Object.keys(B).map(Number));Object.keys(R).length?s.send("getGlyphs",{uid:this.uid,stacks:R,scope:this.scope},(B,j)=>{w||(w=B,S=j,k())},void 0,!1,M):S={};const L=Object.keys(y.iconDependencies);L.length?s.send("getImages",{icons:L,source:this.source,scope:this.scope,tileID:this.tileID,type:"icons"},(B,j)=>{w||(w=B,E=j,k())},void 0,!1,M):E={};const z=Object.keys(y.patternDependencies);z.length?s.send("getImages",{icons:z,source:this.source,scope:this.scope,tileID:this.tileID,type:"patterns"},(B,j)=>{w||(w=B,A=j,k())},void 0,!1,M):A={},k()}}function tE(t,e,n,i){const s=new Nr(e,{brightness:n});for(const l of t)l.recalculate(s,i)}class zk{constructor(e){this.entries={},this.scheduler=e}request(e,n,i,s){const l=this.entries[e]=this.entries[e]||{callbacks:[]};if(l.result){const[u,h]=l.result;return this.scheduler?this.scheduler.add(()=>{s(u,h)},n):s(u,h),()=>{}}return l.callbacks.push(s),l.cancel||(l.cancel=i((u,h)=>{l.result=[u,h];for(const f of l.callbacks)this.scheduler?this.scheduler.add(()=>{f(u,h)},n):f(u,h);setTimeout(()=>delete this.entries[e],3e3)})),()=>{l.result||(l.callbacks=l.callbacks.filter(u=>u!==s),l.callbacks.length||(l.cancel(),delete this.entries[e]))}}}function Fk(t,e,n){const i=JSON.stringify(t.request);return t.data&&(this.deduped.entries[i]={result:[null,t.data]}),this.deduped.request(i,{type:"parseTile",isSymbolTile:t.isSymbolTile,zoom:t.tileZoom},s=>{const l=at(t.request,(u,h,f,m)=>{u?s(u):h&&s(null,{vectorTile:n?void 0:new CS(new V1(h)),rawData:h,cacheControl:f,expires:m})});return()=>{l.cancel(),s()}},e)}class Bk extends Cr{constructor(e,n,i,s){if(super(),this.id=e,this.dispatcher=i,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,ge(this,Pt(n,["url","scheme","tileSize","promoteId"])),this._options=ge({type:"vector"},n),this._collectResourceTiming=!!n.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(s),this._tileWorkers={},this._deduped=new zk}load(e){this._loaded=!1,this.fire(new ct("dataloading",{dataType:"source"}));const n=Array.isArray(this.map._language)?this.map._language.join():this.map._language,i=this.map._worldview;this._tileJSONRequest=eE(this._options,this.map._requestManager,n,i,(s,l)=>{this._tileJSONRequest=null,this._loaded=!0,s?(n&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${n}`),i&&i.length!==2&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${i}`),this.fire(new en(s))):l&&(ge(this,l),l.bounds&&(this.tileBounds=new yx(l.bounds,this.minzoom,this.maxzoom)),Sc(l.tiles,this.map._requestManager._customAccessToken),this.fire(new ct("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new ct("data",{dataType:"source",sourceDataType:"content"}))),e&&e(s)})}loaded(){return this._loaded}hasTile(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}onAdd(e){this.map=e,this.load()}reload(){this.cancelTileJSONRequest(),this.load(()=>this.map.style._clearSource(this.id))}setTiles(e){return this._options.tiles=e,this.reload(),this}setUrl(e){return this.url=e,this._options.url=e,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return ge({},this._options)}loadTile(e,n){const i=this.map._requestManager.normalizeTileURL(e.tileID.canonical.url(this.tiles,this.scheme)),s={request:this.map._requestManager.transformRequest(i,Ie.Tile),data:void 0,uid:e.uid,tileID:e.tileID,tileZoom:e.tileZoom,zoom:e.tileID.overscaledZ,tileSize:this.tileSize*e.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,pixelRatio:mn.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:e.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0};if(s.request.collectResourceTiming=this._collectResourceTiming,e.actor&&e.state!=="expired")e.state==="loading"?e.reloadCallback=n:e.request=e.actor.send("reloadTile",s,l.bind(this));else if(e.actor=this._tileWorkers[i]=this._tileWorkers[i]||this.dispatcher.getActor(),this.dispatcher.ready)e.request=e.actor.send("loadTile",s,l.bind(this),void 0,!0);else{const u=Fk.call({deduped:this._deduped},s,(h,f)=>{h||!f?l.call(this,h):(s.data={cacheControl:f.cacheControl,expires:f.expires,rawData:f.rawData.slice(0)},e.actor&&e.actor.send("loadTile",s,l.bind(this),void 0,!0))},!0);e.request={cancel:u}}function l(u,h){return delete e.request,e.aborted?n(null):u&&u.status!==404?n(u):(h&&h.resourceTiming&&(e.resourceTiming=h.resourceTiming),this.map._refreshExpiredTiles&&h&&e.setExpiryData(h),e.loadVectorData(h,this.map.painter),Oe(this.dispatcher),n(null),void(e.reloadCallback&&(this.loadTile(e,e.reloadCallback),e.reloadCallback=null)))}}abortTile(e){e.request&&(e.request.cancel(),delete e.request),e.actor&&e.actor.send("abortTile",{uid:e.uid,type:this.type,source:this.id,scope:this.scope})}unloadTile(e){e.unloadVectorData(),e.actor&&e.actor.send("removeTile",{uid:e.uid,type:this.type,source:this.id,scope:this.scope})}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class D_ extends Cr{constructor(e,n,i,s){super(),this.id=e,this.dispatcher=i,this.setEventedParent(s),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=ge({type:"raster"},n),ge(this,Pt(n,["url","scheme","tileSize"]))}load(e){this._loaded=!1,this.fire(new ct("dataloading",{dataType:"source"})),this._tileJSONRequest=eE(this._options,this.map._requestManager,null,null,(n,i)=>{this._tileJSONRequest=null,this._loaded=!0,n?this.fire(new en(n)):i&&(ge(this,i),i.bounds&&(this.tileBounds=new yx(i.bounds,this.minzoom,this.maxzoom)),Sc(i.tiles),this.fire(new ct("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new ct("data",{dataType:"source",sourceDataType:"content"}))),e&&e(n)})}loaded(){return this._loaded}onAdd(e){this.map=e,this.load()}reload(){this.cancelTileJSONRequest(),this.load(()=>this.map.style._clearSource(this.id))}setTiles(e){return this._options.tiles=e,this.reload(),this}setUrl(e){return this.url=e,this._options.url=e,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return ge({},this._options)}hasTile(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}loadTile(e,n){const i=mn.devicePixelRatio>=2,s=this.map._requestManager.normalizeTileURL(e.tileID.canonical.url(this.tiles,this.scheme),i,this.tileSize);e.request=xn(this.map._requestManager.transformRequest(s,Ie.Tile),(l,u,h,f)=>(delete e.request,e.aborted?(e.state="unloaded",n(null)):l?(e.state="errored",n(l)):u?(this.map._refreshExpiredTiles&&e.setExpiryData({cacheControl:h,expires:f}),e.setTexture(u,this.map.painter),e.state="loaded",Oe(this.dispatcher),void n(null)):n(null)))}static loadTileData(e,n,i){e.setTexture(n,i)}static unloadTileData(e,n){e.texture&&n.saveTileTexture(e.texture)}abortTile(e,n){e.request&&(e.request.cancel(),delete e.request),n()}unloadTile(e,n){e.texture&&this.map.painter.saveTileTexture(e.texture),n()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}let nE;function Nk(t,e,n,i,s,l,u,h){const f=[t,n,s,e,i,l,1,1,1],m=[u,h,1],y=gs.adjoint([],f),[v,w,S]=fe.transformMat3(m,m,gs.transpose(y,y));return gs.multiply(f,[v,0,0,0,w,0,0,0,S],f)}class pf extends Cr{constructor(e,n,i,s){super(),this.id=e,this.dispatcher=i,this.coordinates=n.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(s),this.options=n,this._dirty=!1}load(e,n){this._loaded=n||!1,this.fire(new ct("dataloading",{dataType:"source"})),this.url=this.options.url,this._imageRequest=xn(this.map._requestManager.transformRequest(this.url,Ie.Image),(i,s)=>{if(this._imageRequest=null,this._loaded=!0,i)this.fire(new en(i));else if(s){const{HTMLImageElement:l}=C;this.image=s instanceof l?mn.getImageData(s):s,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,e&&(this.coordinates=e),this._finishLoading()}})}loaded(){return this._loaded}updateImage(e){return this.image&&e.url?(this._imageRequest&&e.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=e.url,this.load(e.coordinates,this._loaded),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new ct("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(e){this.map=e,this.load()}onRemove(){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),this.texture&&this.texture.destroy()}setCoordinates(e){this.coordinates=e,this._boundsArray=void 0;const n=e.map(Un.fromLngLat);return this.tileID=function(i){let s=1/0,l=1/0,u=-1/0,h=-1/0;for(const v of i)s=Math.min(s,v.x),l=Math.min(l,v.y),u=Math.max(u,v.x),h=Math.max(h,v.y);const f=Math.max(u-s,h-l),m=Math.max(0,Math.floor(-Math.log(f)/Math.LN2)),y=Math.pow(2,m);return new rc(m,Math.floor((s+u)/2*y),Math.floor((l+h)/2*y))}(n),this.minzoom=this.maxzoom=this.tileID.z,this.fire(new ct("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0}_prepareData(e){for(const f in this.tiles){const m=this.tiles[f];m.state!=="loaded"&&(m.state="loaded",m.texture=this.texture)}if(this._boundsArray)return;const n=hf(this.tileID,this.map.transform.projection),[i,s,l,u]=this.coordinates.map(f=>{const m=n.projection.project(f[0],f[1]);return vI(n,m)._round()});this.perspectiveTransform=function(f,m,y,v,w,S,E,A,M,k){const R=Nk(0,0,f,0,0,m,f,m),L=Nk(y,v,w,S,E,A,M,k);return gs.multiply(L,gs.adjoint(R,R),L),[L[6]/L[8]*f/Ge,L[7]/L[8]*m/Ge]}(this.width,this.height,i.x,i.y,s.x,s.y,u.x,u.y,l.x,l.y);const h=this._boundsArray=new ql;h.emplaceBack(i.x,i.y,0,0),h.emplaceBack(s.x,s.y,Ge,0),h.emplaceBack(u.x,u.y,0,Ge),h.emplaceBack(l.x,l.y,Ge,Ge),this.boundsBuffer&&this.boundsBuffer.destroy(),this.boundsBuffer=e.createVertexBuffer(h,US.members),this.boundsSegments=In.simpleSegment(0,0,4,2)}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const e=this.map.painter.context,n=e.gl;this._dirty&&(this.texture?this.texture.update(this.image):(this.texture=new Ai(e,this.image,n.RGBA),this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE)),this._dirty=!1),this._prepareData(e)}loadTile(e,n){this.tileID&&this.tileID.equals(e.tileID.canonical)?(this.tiles[String(e.tileID.wrap)]=e,e.buckets={},n(null)):(e.state="errored",n(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}class jk{constructor(e,n,i){if(this.triangleCount=n.length/3,this.min=new q(0,0),this.max=new q(0,0),this.xScale=0,this.yScale=0,this.cellsX=0,this.cellsY=0,this.cells=[],this.payload=[],this.triangleCount===0||e.length===0||i===0)return;const s=e.map(y=>y.x),l=e.map(y=>y.y);this.min=new q(Math.min(...s),Math.min(...l)),this.max=new q(Math.max(...s),Math.max(...l));const u=this.max.sub(this.min);u.x=Math.max(u.x,1),u.y=Math.max(u.y,1);const h=Math.max(u.x,u.y)/i;this.cellsX=Math.max(1,Math.ceil(u.x/h)),this.cellsY=Math.max(1,Math.ceil(u.y/h)),this.xScale=this.cellsX/u.x,this.yScale=this.cellsY/u.y;const f=[];for(let y=0;y<this.triangleCount;y++){const v=e[n[3*y+0]].sub(this.min),w=e[n[3*y+1]].sub(this.min),S=e[n[3*y+2]].sub(this.min),E=Ch(Math.floor(Math.min(v.x,w.x,S.x)),this.xScale,this.cellsX),A=Ch(Math.floor(Math.max(v.x,w.x,S.x)),this.xScale,this.cellsX),M=Ch(Math.floor(Math.min(v.y,w.y,S.y)),this.yScale,this.cellsY),k=Ch(Math.floor(Math.max(v.y,w.y,S.y)),this.yScale,this.cellsY),R=new q(0,0),L=new q(0,0),z=new q(0,0),B=new q(0,0);for(let j=M;j<=k;++j){R.y=L.y=j*h,z.y=B.y=(j+1)*h;for(let V=E;V<=A;++V)R.x=z.x=V*h,L.x=B.x=(V+1)*h,(yS(v,w,S,R,L,B)||yS(v,w,S,R,B,z))&&f.push({cellIdx:j*this.cellsX+V,triIdx:y})}}if(f.length===0)return;f.sort((y,v)=>y.cellIdx-v.cellIdx||y.triIdx-v.triIdx);let m=0;for(;m<f.length;){const y=f[m].cellIdx,v={start:this.payload.length,len:0};for(;m<f.length&&f[m].cellIdx===y;)++v.len,this.payload.push(f[m++].triIdx);this.cells[y]=v}}query(e,n,i){if(this.triangleCount===0||this.cells.length===0||e.x>this.max.x||this.min.x>n.x||e.y>this.max.y||this.min.y>n.y)return;this.lookup||(this.lookup=new Uint8Array(Math.ceil(this.triangleCount/8)));for(let f=0;f<this.lookup.length;f++)this.lookup[f]=0;const s=Ch(e.x-this.min.x,this.xScale,this.cellsX),l=Ch(n.x-this.min.x,this.xScale,this.cellsX),u=Ch(e.y-this.min.y,this.yScale,this.cellsY),h=Ch(n.y-this.min.y,this.yScale,this.cellsY);for(let f=u;f<=h;f++)for(let m=s;m<=l;m++){const y=this.cells[f*this.cellsX+m];if(y)for(let v=0;v<y.len;v++){const w=this.payload[y.start+v],S=Math.floor(w/8),E=1<<w%8;if(!(this.lookup[S]&E)&&(this.lookup[S]|=E,i.push(w),i.length===this.triangleCount))return}}}}function Ch(t,e,n){return Math.max(0,Math.min(n-1,Math.floor(t*e)))}kt(jk,"TriangleGridIndex");const Ej=5123,Tj=5126,Cj={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},Uk={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16};function Lm(t,e){if(e.value&&e.value.length)return e.value;const n=t.json.bufferViews[e.bufferView],i=t.buffers[n.buffer];return new Cj[e.componentType](i.arrayBuffer,i.byteOffset+(e.byteOffset||0)+(n.byteOffset||0),e.count*Uk[e.type])}function Aj(t,e,n){const i=t.indices,s=t.attributes,l={};l.indexArray=new di;const u=typeof i=="object"?i:e.json.accessors[i],h=u.count/3;l.indexArray.reserve(h);const f=Lm(e,u);for(let w=0;w<h;w++)l.indexArray.emplaceBack(f[3*w],f[3*w+1],f[3*w+2]);l.indexArray._trim(),l.vertexArray=new Ei;const m=typeof s.POSITION=="object"?s.POSITION:e.json.accessors[s.POSITION];l.vertexArray.reserve(m.count);const y=Lm(e,m);for(let w=0;w<m.count;w++)l.vertexArray.emplaceBack(y[3*w],y[3*w+1],y[3*w+2]);if(l.vertexArray._trim(),l.aabb=new ri(m.min,m.max),l.centroid=function(w,S){const E=[0,0,0],A=w.length;if(A>0){for(let M=0;M<A;M++){const k=3*w[M];E[0]+=S[k],E[1]+=S[k+1],E[2]+=S[k+2]}E[0]/=A,E[1]/=A,E[2]/=A}return E}(f,y),s.COLOR_0!==void 0){const w=typeof s.COLOR_0=="object"?s.COLOR_0:e.json.accessors[s.COLOR_0],S=Uk[w.type];if(w.componentType===Tj){l.colorArray=S===3?new Ei:new Wl,l.colorArray.reserve(w.count);const E=Lm(e,w);if(S===3)for(let A=0;A<w.count;A++)l.colorArray.emplaceBack(E[3*A],E[3*A+1],E[3*A+2]);else for(let A=0;A<w.count;A++)l.colorArray.emplaceBack(E[4*A],E[4*A+1],E[4*A+2],E[4*A+3]);l.colorArray._trim()}else if(w.componentType===Ej&&S===4){l.colorArray=new Wl,l.colorArray.resize(w.count);const E=Lm(e,w),A=1/65535,M=l.colorArray.float32;for(let k=0;k<4*E.length;++k)M[k]=E[k]*A}else ye(`glTF color buffer parsing for accessor ${JSON.stringify(w)} is not supported`)}if(s.NORMAL!==void 0){l.normalArray=new Ei;const w=typeof s.NORMAL=="object"?s.NORMAL:e.json.accessors[s.NORMAL];l.normalArray.reserve(w.count);const S=Lm(e,w);for(let E=0;E<w.count;E++)l.normalArray.emplaceBack(S[3*E],S[3*E+1],S[3*E+2]);l.normalArray._trim()}if(s.TEXCOORD_0!==void 0&&n.length>0){l.texcoordArray=new rh;const w=typeof s.TEXCOORD_0=="object"?s.TEXCOORD_0:e.json.accessors[s.TEXCOORD_0];l.texcoordArray.reserve(w.count);const S=Lm(e,w);for(let E=0;E<w.count;E++)l.texcoordArray.emplaceBack(S[2*E],S[2*E+1]);l.texcoordArray._trim()}const v=t.material;return l.material=function(w,S){const E=w.pbrMetallicRoughness?w.pbrMetallicRoughness:{},A={},M={},k=E.baseColorFactor?new wn(E.baseColorFactor[0],E.baseColorFactor[1],E.baseColorFactor[2],E.baseColorFactor[3]):wn.white;return M.baseColorFactor=k,M.metallicFactor=E.metallicFactor!==void 0?E.metallicFactor:1,M.roughnessFactor=E.roughnessFactor!==void 0?E.roughnessFactor:1,A.emissiveFactor=w.emissiveFactor?[w.emissiveFactor[0],w.emissiveFactor[1],w.emissiveFactor[2]]:[0,0,0],A.alphaMode=w.alphaMode?w.alphaMode:"OPAQUE",A.alphaCutoff=w.alphaCutoff!==void 0?w.alphaCutoff:.5,E.baseColorTexture&&(M.baseColorTexture=S[E.baseColorTexture.index]),E.metallicRoughnessTexture&&(M.metallicRoughnessTexture=S[E.metallicRoughnessTexture.index]),w.normalTexture&&(A.normalTexture=S[w.normalTexture.index]),w.occlusionTexture&&(A.occlusionTexture=S[w.occlusionTexture.index]),w.emissiveTexture&&(A.emissionTexture=S[w.emissiveTexture.index]),A.pbrMetallicRoughness=M,w.defined===void 0&&(A.defined=!0),A}(v!==void 0?e.json.materials[v]:{defined:!1},n),s.CUSTOM_ATTRIBUTE_3!==void 0&&(l.featureData=new Uint32Array(s.CUSTOM_ATTRIBUTE_3.value.buffer)),l}function Vk(t,e,n){const i={};if(i.matrix=t.matrix?t.matrix:Me.identity([]),t.translation&&Me.translate(i.matrix,i.matrix,[t.translation[0],t.translation[1],t.translation[2]]),t.rotation){const s=Me.fromQuat([],[t.rotation[0],t.rotation[1],t.rotation[2],t.rotation[3]]);Me.multiply(i.matrix,i.matrix,s)}if(t.scale&&Me.scale(i.matrix,i.matrix,[t.scale[0],t.scale[1],t.scale[2]]),t.mesh!==void 0&&(i.meshes=n[t.mesh]),t.extras&&(t.extras.id&&(i.id=t.extras.id),t.extras.lights&&(i.lights=function(s){if(!s.length)return[];const l=function(y,v){const w=y.replace(/[^A-Za-z0-9+/]/g,""),S=w.length,E=3*S+1>>2,A=new Uint8Array(E);let M,k,R=0,L=0;for(let B=0;B<S;B++)if(k=3&B,R|=((z=w.charCodeAt(B))>64&&z<91?z-65:z>96&&z<123?z-71:z>47&&z<58?z+4:z===43?62:z===47?63:0)<<6*(3-k),k===3||S-B==1){for(M=0;M<3&&L<E;)A[L]=R>>>(16>>>M&24)&255,M++,L++;R=0}var z;return A}(s),u=[],h=l.length/24,f=new Uint16Array(l.buffer),m=new Float32Array(l.buffer);for(let y=0;y<h;y++){const v=f[2*y*6]/30,w=f[2*y*6+1]/30,S=[m[6*y+1],m[6*y+2],w],E=[m[6*y+3],m[6*y+4],w],A=fe.sub([],E,S),M=fe.length(A);A[2]=-A[0],A[0]=A[1],A[1]=A[2],A[2]=0,fe.scale(A,A,1/M);const k=f[2*y*6+10]/100,R=fe.add([],S,E);fe.scale(R,R,.5),u.push({pos:R,normal:A,width:M,height:v,depth:k,points:[S[0],S[1],E[0],E[1]]})}return u}(t.extras.lights)),i.meshes)){const s=[0,0];for(const l of i.meshes){const u=l.aabb;s[0]+=u.min[0]+u.max[0],s[1]+=u.min[1]+u.max[1]}s[0]=Math.floor(s[0]/i.meshes.length/2),s[1]=Math.floor(s[1]/i.meshes.length/2),i.anchor=s}if(t.children){const s=[];for(const l of t.children)s.push(Vk(e.json.nodes[l],e,n));i.children=s}return i}function Mj(t){if(t.vertices.length===0||t.indices.length===0)return null;const[e,n]=[t.vertices[0].clone(),t.vertices[0].clone()];for(let u=1;u<t.vertices.length;++u){const h=t.vertices[u];e.x=Math.min(e.x,h.x),e.y=Math.min(e.y,h.y),n.x=Math.max(n.x,h.x),n.y=Math.max(n.y,h.y)}const i=Math.ceil(Math.max(n.x-e.x,n.y-e.y)/256),s=Math.max(8,i),l=new jk(t.vertices,t.indices,s);return{vertices:t.vertices,indices:t.indices,grid:l,min:e,max:n}}function Ij(t){if(!t.extras||!t.extras.ground)return null;const e=t.extras.ground;if(!e||!Array.isArray(e)||e.length===0)return null;const n=e[0];if(!n||!Array.isArray(n)||n.length===0)return null;const i=[];for(const u of n){if(!Array.isArray(u)||u.length!==2)continue;const h=u[0],f=u[1];typeof h=="number"&&typeof f=="number"&&i.push(new q(h,f))}if(i.length<3)return null;i.length>1&&i[i.length-1].equals(i[0])&&i.pop();let s=0;for(let u=0;u<i.length;u++){const h=i[u],f=i[(u+1)%i.length],m=i[(u+2)%i.length];s+=(h.x-f.x)*(m.y-f.y)-(m.x-f.x)*(h.y-f.y)}s>0&&i.reverse();const l=O1(i.flatMap(u=>[u.x,u.y]),[]);return l.length===0?null:{vertices:i,indices:l}}function kj(t){const e=[],n=[];let i=0;for(const s of t){i=e.length;const l=s.vertexArray.float32,u=s.indexArray.uint16;for(let h=0;h<s.vertexArray.length;h++)e.push(new q(l[3*h+0],l[3*h+1]));for(let h=0;h<3*s.indexArray.length;h++)n.push(u[h]+i)}if(n.length%3!=0)return null;for(let s=0;s<n.length;s+=3){const l=e[n[s+0]],u=e[n[s+1]],h=e[n[s+2]];(l.x-u.x)*(h.y-u.y)-(h.x-u.x)*(l.y-u.y)>0&&([n[s+1],n[s+2]]=[n[s+2],n[s+1]])}return{vertices:e,indices:n}}function rE(t){const e=function(h){const f=[];for(const m of h.images)f.push(m);return f}(t),n=function(h,f){const m=[],y=C.WebGLRenderingContext,v=h.json.samplers;if(h.json.textures)for(const w of h.json.textures){const S={magFilter:y.LINEAR,minFilter:y.NEAREST,wrapS:y.REPEAT,wrapT:y.REPEAT,mipmaps:!1};w.sampler!==void 0&&(v[w.sampler].magFilter&&(S.magFilter=v[w.sampler].magFilter),v[w.sampler].minFilter&&(S.minFilter=v[w.sampler].minFilter),S.minFilter>=y.NEAREST_MIPMAP_NEAREST&&(S.mipmaps=!0),v[w.sampler].wrapS&&(S.wrapS=v[w.sampler].wrapS),v[w.sampler].wrapT&&(S.wrapT=v[w.sampler].wrapT)),m.push({image:f[w.source],sampler:S,uploaded:!1})}return m}(t,e),i=function(h,f){const m=[];for(const y of h.json.meshes){const v=[];for(const w of y.primitives){const S=Aj(w,h,f);v.push(S)}m.push(v)}return m}(t,n),s=[],l=t.json.scene?t.json.scenes[t.json.scene]:t.json.scenes?t.json.scenes[0]:void 0,u=l?l.nodes:t.json.nodes;for(const h of u)s.push(Vk(t.json.nodes[h],t,i));return function(h,f,m){const y={},v=new Set;for(let w=0;w<h.length;w++){const S=m[f[w]];if(!S.extras)continue;const E=S.extras["mapbox:footprint:version"],A=S.extras["mapbox:footprint:id"];(E||A)&&v.add(w),E==="1.0.0"&&A&&(y[A]=w)}for(let w=0;w<h.length;w++){if(v.has(w))continue;const S=h[w],E=m[f[w]];if(!E.extras)continue;let A=null;S.id in y&&(A=kj(h[y[S.id]].meshes)),A||(A=Ij(E)),A&&(S.footprint=Mj(A))}if(v.size>0){const w=Array.from(v.values()).sort((S,E)=>S-E);for(let S=w.length-1;S>=0;S--)h.splice(w[S],1)}}(s,u,t.json.nodes),s}function Pj(t,e){const n={};n.indexArray=new di,n.indexArray.reserve(4*t.length),n.vertexArray=new Ei,n.vertexArray.reserve(10*t.length),n.colorArray=new Wl,n.vertexArray.reserve(10*t.length);let i=0;for(const u of t){const h=Math.min(10,Math.max(4,1.3*u.height))*e,f=[-u.normal[1],u.normal[0],0],m=Math.min(.29,.1*u.width/u.depth),y=u.width-2*u.depth*e*(m+.01),v=fe.scaleAndAdd([],u.pos,f,y/2),w=fe.scaleAndAdd([],u.pos,f,-y/2),S=[v[0],v[1],v[2]+u.height],E=[w[0],w[1],w[2]+u.height],A=fe.scaleAndAdd([],u.normal,f,m);fe.scale(A,A,h);const M=fe.scaleAndAdd([],u.normal,f,-m);fe.scale(M,M,h),fe.add(A,v,A),fe.add(M,w,M),v[2]+=.1,w[2]+=.1,n.vertexArray.emplaceBack(A[0],A[1],A[2]),n.vertexArray.emplaceBack(M[0],M[1],M[2]),n.vertexArray.emplaceBack(v[0],v[1],v[2]),n.vertexArray.emplaceBack(w[0],w[1],w[2]),n.vertexArray.emplaceBack(S[0],S[1],S[2]),n.vertexArray.emplaceBack(E[0],E[1],E[2]),n.vertexArray.emplaceBack(v[0],v[1],v[2]),n.vertexArray.emplaceBack(w[0],w[1],w[2]),n.vertexArray.emplaceBack(A[0],A[1],A[2]),n.vertexArray.emplaceBack(M[0],M[1],M[2]);const k=y/h/2;n.colorArray.emplaceBack(-k-m,-1,k,.8),n.colorArray.emplaceBack(k+m,-1,k,.8),n.colorArray.emplaceBack(-k,0,k,1.3),n.colorArray.emplaceBack(k,0,k,1.3),n.colorArray.emplaceBack(k+m,-.8,k,.7),n.colorArray.emplaceBack(k+m,-.8,k,.7),n.colorArray.emplaceBack(0,0,k,1.3),n.colorArray.emplaceBack(0,0,k,1.3),n.colorArray.emplaceBack(k+m,-1.2,k,.8),n.colorArray.emplaceBack(k+m,-1.2,k,.8),n.indexArray.emplaceBack(6+i,4+i,8+i),n.indexArray.emplaceBack(7+i,9+i,5+i),n.indexArray.emplaceBack(0+i,1+i,2+i),n.indexArray.emplaceBack(1+i,3+i,2+i),i+=10}const s={defined:!0,emissiveFactor:[0,0,0]},l={};return l.baseColorFactor=wn.white,s.pbrMetallicRoughness=l,n.material=s,n.aabb=new ri([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),n}function Rj(){return Dx.workerClass!=null?new Dx.workerClass:new C.Worker(Dx.workerUrl)}const iE="mapboxgl_preloaded_worker_pool";class Om{constructor(){this.active={}}acquire(e){if(!this.workers)for(this.workers=[];this.workers.length<Om.workerCount;)this.workers.push(new Rj);return this.active[e]=!0,this.workers.slice()}release(e){delete this.active[e],this.numActive()===0&&(this.workers.forEach(n=>{n.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[iE]}numActive(){return Object.keys(this.active).length}}let L_;function O_(){return L_||(L_=new Om),L_}Om.workerCount=2;let z_,oE,sE=null;const Dj=F.LOADERS_URL;function $k(){return Ne()&&self.worker&&self.worker.loadersUrl?self.worker.loadersUrl:oE||Dj}async function Gk(){if(z_&&await z_,typeof mapboxglLoaders>"u"){const e=$k();try{t=e,z_=Ne()?(importScripts(t),new Promise(n=>n())):new Promise((n,i)=>{const s=document.createElement("script");s.src=t,s.onload=n,s.onerror=i,document.head.appendChild(s),s.src=t}),await z_}catch{ye(`Could not load bundle from ${e}.`)}}var t;z_=void 0}async function Hk(t){return await Gk(),mapboxglLoaders.load(t,mapboxglLoaders.GLTFLoader,{gltf:{postProcess:!1,loadBuffers:!0,loadImages:!0}})}const aE={vector:Bk,raster:D_,"raster-dem":class extends D_{constructor(t,e,n,i){super(t,e,n,i),this.type="raster-dem",this.maxzoom=22,this._options=ge({type:"raster-dem"},e),this.encoding=e.encoding||"mapbox"}loadTile(t,e){const n=this.map._requestManager.normalizeTileURL(t.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function i(s,l){s&&(t.state="errored",e(s)),l&&(t.dem=l,t.dem.onDeserialize(),t.needsHillshadePrepare=!0,t.needsDEMTextureUpload=!0,t.state="loaded",e(null))}t.request=xn(this.map._requestManager.transformRequest(n,Ie.Tile),(function(s,l,u,h){if(delete t.request,t.aborted)t.state="unloaded",e(null);else if(s)t.state="errored",e(s);else if(l){this.map._refreshExpiredTiles&&t.setExpiryData({cacheControl:u,expires:h});const m=C.ImageBitmap&&l instanceof C.ImageBitmap&&(nE==null&&(nE=C.OffscreenCanvas&&new C.OffscreenCanvas(1,1).getContext("2d")&&typeof C.createImageBitmap=="function"),nE),y=1-(l.width-((f=l.width)<=1?1:Math.pow(2,Math.floor(Math.log(f)/Math.LN2))))/2;y<1||t.neighboringTiles||(t.neighboringTiles=this._getNeighboringTiles(t.tileID));const v=m?l:mn.getImageData(l,y),w={uid:t.uid,coord:t.tileID,source:this.id,scope:this.scope,rawImageData:v,encoding:this.encoding,padding:y};t.actor&&t.state!=="expired"||(t.actor=this.dispatcher.getActor(),t.actor.send("loadDEMTile",w,i.bind(this),void 0,!0))}var f}).bind(this))}_getNeighboringTiles(t){const e=t.canonical,n=Math.pow(2,e.z),i=(e.x-1+n)%n,s=e.x===0?t.wrap-1:t.wrap,l=(e.x+1+n)%n,u=e.x+1===n?t.wrap+1:t.wrap,h={};return h[new Ir(t.overscaledZ,s,e.z,i,e.y).key]={backfilled:!1},h[new Ir(t.overscaledZ,u,e.z,l,e.y).key]={backfilled:!1},e.y>0&&(h[new Ir(t.overscaledZ,s,e.z,i,e.y-1).key]={backfilled:!1},h[new Ir(t.overscaledZ,t.wrap,e.z,e.x,e.y-1).key]={backfilled:!1},h[new Ir(t.overscaledZ,u,e.z,l,e.y-1).key]={backfilled:!1}),e.y+1<n&&(h[new Ir(t.overscaledZ,s,e.z,i,e.y+1).key]={backfilled:!1},h[new Ir(t.overscaledZ,t.wrap,e.z,e.x,e.y+1).key]={backfilled:!1},h[new Ir(t.overscaledZ,u,e.z,l,e.y+1).key]={backfilled:!1}),h}unloadTile(t){t.demTexture&&this.map.painter.saveTileTexture(t.demTexture),t.fbo&&(t.fbo.destroy(),delete t.fbo),t.dem&&delete t.dem,delete t.neighboringTiles,t.state="unloaded"}},geojson:class extends Cr{constructor(t,e,n,i){super(),this.id=t,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=n.getActor(),this.setEventedParent(i),this._data=e.data,this._options=ge({},e),this._collectResourceTiming=e.collectResourceTiming,e.maxzoom!==void 0&&(this.maxzoom=e.maxzoom),e.type&&(this.type=e.type),e.attribution&&(this.attribution=e.attribution),this.promoteId=e.promoteId;const s=Ge/this.tileSize;this.workerOptions=ge({source:this.id,scope:this.scope,cluster:e.cluster||!1,geojsonVtOptions:{buffer:(e.buffer!==void 0?e.buffer:128)*s,tolerance:(e.tolerance!==void 0?e.tolerance:.375)*s,extent:Ge,maxZoom:this.maxzoom,lineMetrics:e.lineMetrics||!1,generateId:e.generateId||!1},superclusterOptions:{maxZoom:e.clusterMaxZoom!==void 0?e.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,e.clusterMinPoints||2),extent:Ge,radius:(e.clusterRadius!==void 0?e.clusterRadius:50)*s,log:!1,generateId:e.generateId||!1},clusterProperties:e.clusterProperties,filter:e.filter},e.workerOptions)}onAdd(t){this.map=t,this.setData(this._data)}setData(t){return this._data=t,this._updateWorkerData(),this}getClusterExpansionZoom(t,e){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:t,source:this.id,scope:this.scope},e),this}getClusterChildren(t,e){return this.actor.send("geojson.getClusterChildren",{clusterId:t,source:this.id,scope:this.scope},e),this}getClusterLeaves(t,e,n,i){return this.actor.send("geojson.getClusterLeaves",{source:this.id,scope:this.scope,clusterId:t,limit:e,offset:n},i),this}_updateWorkerData(){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new ct("dataloading",{dataType:"source"})),this._loaded=!1;const t=ge({},this.workerOptions);t.scope=this.scope;const e=this._data;typeof e=="string"?(t.request=this.map._requestManager.transformRequest(mn.resolveURL(e),Ie.Source),t.request.collectResourceTiming=this._collectResourceTiming):t.data=JSON.stringify(e),this._pendingLoad=this.actor.send(`${this.type}.loadData`,t,(n,i)=>{if(this._loaded=!0,this._pendingLoad=null,n)this.fire(new en(n));else{const s={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&i&&i.resourceTiming&&i.resourceTiming[this.id]&&(s.resourceTiming=i.resourceTiming[this.id]),this.fire(new ct("data",s)),this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(),this._coalesce=!1)})}loaded(){return this._loaded}loadTile(t,e){const n=t.actor?"reloadTile":"loadTile";t.actor=this.actor;const i={type:this.type,uid:t.uid,tileID:t.tileID,tileZoom:t.tileZoom,zoom:t.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,scope:this.scope,pixelRatio:mn.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,brightness:this.map.style&&this.map.style.getBrightness()||0};t.request=this.actor.send(n,i,(s,l)=>(delete t.request,t.unloadVectorData(),t.aborted?e(null):s?e(s):(t.loadVectorData(l,this.map.painter,n==="reloadTile"),e(null))),void 0,n==="loadTile")}abortTile(t){t.request&&(t.request.cancel(),delete t.request),t.aborted=!0}unloadTile(t){t.unloadVectorData(),this.actor.send("removeTile",{uid:t.uid,type:this.type,source:this.id,scope:this.scope})}onRemove(){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return ge({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends pf{constructor(t,e,n,i){super(t,e,n,i),this.roundZoom=!0,this.type="video",this.options=e}load(){this._loaded=!1;const t=this.options;this.urls=[];for(const e of t.urls)this.urls.push(this.map._requestManager.transformRequest(e,Ie.Source).url);(function(e,n){const i=C.document.createElement("video");i.muted=!0,i.onloadstart=function(){n(null,i)};for(let s=0;s<e.length;s++){const l=C.document.createElement("source");ut(e[s])||(i.crossOrigin="Anonymous"),l.src=e[s],i.appendChild(l)}})(this.urls,(e,n)=>{this._loaded=!0,e?this.fire(new en(e)):n&&(this.video=n,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(t){if(this.video){const e=this.video.seekable;t<e.start(0)||t>e.end(0)?this.fire(new en(new Ct(`sources.${this.id}`,null,`Playback for this video can be set only between the ${e.start(0)} and ${e.end(0)}-second mark.`))):this.video.currentTime=t}}getVideo(){return this.video}onAdd(t){this.map||(this.map=t,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const t=this.map.painter.context,e=t.gl;this.texture?this.video.paused||(this.texture.bind(e.LINEAR,e.CLAMP_TO_EDGE),e.texSubImage2D(e.TEXTURE_2D,0,0,0,e.RGBA,e.UNSIGNED_BYTE,this.video)):(this.texture=new Ai(t,this.video,e.RGBA),this.texture.bind(e.LINEAR,e.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(t)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:pf,model:class extends Cr{constructor(t,e,n,i){super(),this.id=t,this.type="model",this.models=[],this._loaded=!1,this._options=e}async load(){for(const t in this._options.models){const e=this._options.models[t],n=rE(await Hk(e.uri)),i=new YI(t,e.uri,e.position,e.orientation,n);i.computeBoundsAndApplyParent(),this.models.push(i)}this._loaded=!0,this.fire(new ct("data",{dataType:"source",sourceDataType:"metadata"}))}onAdd(t){this.map=t,this.load()}hasTransition(){return!1}loaded(){return this._loaded}getModels(){return this.models}loadTile(t,e){}serialize(){return{type:"model"}}},"batched-model":class extends Cr{constructor(t,e,n,i){super(),this.type="batched-model",this.id=t,this.tileSize=512,this._options=e,this.tiles=this._options.tiles,this.maxzoom=e.maxzoom||19,this.minzoom=e.minzoom||0,this.roundZoom=!0,this.usedInConflation=!0,this.dispatcher=n,this.reparseOverscaled=!1,this.scheme="xyz",this._loaded=!1,this.setEventedParent(i)}onAdd(t){this.map=t,this.load()}load(t){this._loaded=!1,this.fire(new ct("dataloading",{dataType:"source"}));const e=Array.isArray(this.map._language)?this.map._language.join():this.map._language,n=this.map._worldview;this._tileJSONRequest=eE(this._options,this.map._requestManager,e,n,(i,s)=>{this._tileJSONRequest=null,this._loaded=!0,i?(e&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${e}`),n&&n.length!==2&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${n}`),this.fire(new en(i))):s&&(ge(this,s),s.bounds&&(this.tileBounds=new yx(s.bounds,this.minzoom,this.maxzoom)),Sc(s.tiles,this.map._requestManager._customAccessToken),this.fire(new ct("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new ct("data",{dataType:"source",sourceDataType:"content"}))),t&&t(i)})}hasTransition(){return!1}hasTile(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)}loaded(){return this._loaded}loadTile(t,e){const n=this.map._requestManager.normalizeTileURL(t.tileID.canonical.url(this.tiles,this.scheme)),i={request:this.map._requestManager.transformRequest(n,Ie.Tile),data:void 0,uid:t.uid,tileID:t.tileID,tileZoom:t.tileZoom,zoom:t.tileID.overscaledZ,tileSize:this.tileSize*t.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,showCollisionBoxes:this.map.showCollisionBoxes,isSymbolTile:t.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0};if(t.actor&&t.state!=="expired")if(t.state==="loading")t.reloadCallback=e;else{if(t.buckets){const l=Object.values(t.buckets);for(const u of l)u.dirty=!0;return void(t.state="loaded")}t.request=t.actor.send("reloadTile",i,s.bind(this))}else t.actor=this.dispatcher.getActor(),t.request=t.actor.send("loadTile",i,s.bind(this),void 0,!0);function s(l,u){return t.aborted?e(null):l?e(l):(u&&(u.resourceTiming&&(t.resourceTiming=u.resourceTiming),this.map._refreshExpiredTiles&&t.setExpiryData(u),t.buckets={...t.buckets,...u.buckets}),t.state="loaded",void e(null))}}serialize(){return{type:"batched-model"}}},canvas:class extends pf{constructor(t,e,n,i){super(t,e,n,i),e.coordinates?Array.isArray(e.coordinates)&&e.coordinates.length===4&&!e.coordinates.some(s=>!Array.isArray(s)||s.length!==2||s.some(l=>typeof l!="number"))||this.fire(new en(new Ct(`sources.${t}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new en(new Ct(`sources.${t}`,null,'missing required property "coordinates"'))),e.animate&&typeof e.animate!="boolean"&&this.fire(new en(new Ct(`sources.${t}`,null,'optional "animate" property must be a boolean value'))),e.canvas?typeof e.canvas=="string"||e.canvas instanceof C.HTMLCanvasElement||this.fire(new en(new Ct(`sources.${t}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new en(new Ct(`sources.${t}`,null,'missing required property "canvas"'))),this.options=e,this.animate=e.animate===void 0||e.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof C.HTMLCanvasElement?this.options.canvas:C.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new en(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(t){this.map=t,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let t=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,t=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,t=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const e=this.map.painter.context;this.texture?(t||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new Ai(e,this.canvas,e.gl.RGBA,{premultiply:!0}),this._prepareData(e)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const t of[this.canvas.width,this.canvas.height])if(isNaN(t)||t<=0)return!0;return!1}},custom:class extends Cr{constructor(t,e,n,i){super(),this.id=t,this.type="custom",this._dataType="raster",this._dispatcher=n,this._implementation=e,this.setEventedParent(i),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new en(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new en(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new yx(this._implementation.bounds,this.minzoom,this.maxzoom)),e.update=this._update.bind(this),e.clearTiles=this._clearTiles.bind(this),e.coveringTiles=this._coveringTiles.bind(this),ge(this,Pt(e,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return Pt(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new ct("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new ct("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(t){this._map=t,this._loaded=!1,this.fire(new ct("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(t),this.load()}onRemove(t){this._implementation.onRemove&&this._implementation.onRemove(t)}hasTile(t){if(this._implementation.hasTile){const{x:e,y:n,z:i}=t.canonical;return this._implementation.hasTile({x:e,y:n,z:i})}return!this.tileBounds||this.tileBounds.contains(t.canonical)}loadTile(t,e){const{x:n,y:i,z:s}=t.tileID.canonical,l=new C.AbortController;t.request=Promise.resolve(this._implementation.loadTile({x:n,y:i,z:s},{signal:l.signal})).then((function(u){return delete t.request,t.aborted?(t.state="unloaded",e(null)):u===void 0?(t.state="errored",e(null)):u===null?(this.loadTileData(t,{width:this.tileSize,height:this.tileSize,data:null}),t.state="loaded",e(null)):function(h){return h instanceof C.ImageData||h instanceof C.HTMLCanvasElement||h instanceof C.ImageBitmap||h instanceof C.HTMLImageElement}(u)?(this.loadTileData(t,u),t.state="loaded",void e(null)):(t.state="errored",e(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)))}).bind(this)).catch(u=>{u.code!==20&&(t.state="errored",e(u))}),t.request.cancel=()=>l.abort()}loadTileData(t,e){D_.loadTileData(t,e,this._map.painter)}unloadTileData(t){D_.unloadTileData(t,this._map.painter)}unloadTile(t,e){if(this.unloadTileData(t),this._implementation.unloadTile){const{x:n,y:i,z:s}=t.tileID.canonical;this._implementation.unloadTile({x:n,y:i,z:s})}e()}abortTile(t,e){t.request&&t.request.cancel&&(t.request.cancel(),delete t.request),e()}hasTransition(){return!1}_coveringTiles(){return this._map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(t=>({x:t.canonical.x,y:t.canonical.y,z:t.canonical.z}))}_clearTiles(){this._map.style._clearSource(this.id)}_update(){this.fire(new ct("data",{dataType:"source",sourceDataType:"content"}))}}},lE=function(t,e,n,i){const s=new aE[e.type](t,e,n,i);if(s.id!==t)throw new Error(`Expected Source id to be ${t} instead of ${s.id}`);return On(["load","abort","unload","serialize","prepare"],s),s};function Lj(t,e){const n=Me.identity([]);return Me.scale(n,n,[.5*t.width,.5*-t.height,1]),Me.translate(n,n,[1,-1,0]),Me.multiply(n,n,t.calculateProjMatrix(e.toUnwrapped())),Float32Array.from(n)}function Oj(t,e,n,i,s,l,u,h=!1){const f=t.tilesIn(i,u,h);f.sort(qk);const m=[];for(const v of f)m.push({wrappedTileID:v.tile.tileID.wrapped().key,queryResults:v.tile.queryRenderedFeatures(e,n,t._state,v,s,l,Lj(t.transform,v.tile.tileID),h)});const y=function(v){const w={},S={};for(const E of v){const A=E.queryResults,M=E.wrappedTileID,k=S[M]=S[M]||{};for(const R in A){const L=A[R],z=k[R]=k[R]||{},B=w[R]=w[R]||[];for(const j of L)z[j.featureIndex]||(z[j.featureIndex]=!0,B.push(j))}}return w}(m);for(const v in y)y[v].forEach(w=>{const S=w.feature,E=S.layer;E&&E.type!=="background"&&E.type!=="sky"&&E.type!=="slot"&&(S.source=E.source,E["source-layer"]&&(S.sourceLayer=E["source-layer"]),S.state=S.id!==void 0?t.getFeatureState(E["source-layer"],S.id):{})});return y}function zj(t,e){const n=t.getRenderableIds().map(l=>t.getTileByID(l)),i=[],s={};for(let l=0;l<n.length;l++){const u=n[l],h=u.tileID.canonical.key;s[h]||(s[h]=!0,u.querySourceFeatures(i,e))}return i}function qk(t,e){const n=t.tileID,i=e.tileID;return n.overscaledZ-i.overscaledZ||n.canonical.y-i.canonical.y||n.wrap-i.wrap||n.canonical.x-i.canonical.x}var Wk=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function Fj(t,e){const n={};for(const i in t)i!=="ref"&&(n[i]=t[i]);return Wk.forEach(i=>{i in e&&(n[i]=e[i])}),n}function Zk(t){t=t.slice();const e=Object.create(null);for(let n=0;n<t.length;n++)e[t[n].id]=t[n];for(let n=0;n<t.length;n++)"ref"in t[n]&&(t[n]=Fj(t[n],e[t[n].ref]));return t}const wr={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setCamera:"setCamera",setLights:"setLights",setProjection:"setProjection"};function Xk(t,e,n){n.push({command:wr.addSource,args:[t,e[t]]})}function Kk(t,e,n){e.push({command:wr.removeSource,args:[t]}),n[t]=!0}function Bj(t,e,n,i){Kk(t,n,i),Xk(t,e,n)}function Nj(t,e,n){let i;for(i in t[n])if(t[n].hasOwnProperty(i)&&i!=="data"&&!Se(t[n][i],e[n][i]))return!1;for(i in e[n])if(e[n].hasOwnProperty(i)&&i!=="data"&&!Se(t[n][i],e[n][i]))return!1;return!0}function _x(t,e,n,i,s,l){let u;for(u in e=e||{},t=t||{})t.hasOwnProperty(u)&&(Se(t[u],e[u])||n.push({command:l,args:[i,u,e[u],s]}));for(u in e)e.hasOwnProperty(u)&&!t.hasOwnProperty(u)&&(Se(t[u],e[u])||n.push({command:l,args:[i,u,e[u],s]}))}function Yk(t){return t.id}function Qk(t,e){return t[e.id]=e,t}class jj{constructor(e,n){this.reset(e,n)}reset(e,n){this.points=e||[],this._distances=[0];for(let i=1;i<this.points.length;i++)this._distances[i]=this._distances[i-1]+this.points[i].dist(this.points[i-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(n||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(e){if(this.points.length===1)return this.points[0];e=ce(e,0,1);let n=1,i=this._distances[n];const s=e*this.paddedLength+this.padding;for(;i<s&&n<this._distances.length;)i=this._distances[++n];const l=n-1,u=this._distances[l],h=i-u,f=h>0?(s-u)/h:0;return this.points[l].mult(1-f).add(this.points[n].mult(f))}}class Jk{constructor(e,n,i){const s=this.boxCells=[],l=this.circleCells=[];this.xCellCount=Math.ceil(e/i),this.yCellCount=Math.ceil(n/i);for(let u=0;u<this.xCellCount*this.yCellCount;u++)s.push([]),l.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=e,this.height=n,this.xScale=this.xCellCount/e,this.yScale=this.yCellCount/n,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(e,n,i,s,l){this._forEachCell(n,i,s,l,this._insertBoxCell,this.boxUid++),this.boxKeys.push(e),this.bboxes.push(n),this.bboxes.push(i),this.bboxes.push(s),this.bboxes.push(l)}insertCircle(e,n,i,s){this._forEachCell(n-s,i-s,n+s,i+s,this._insertCircleCell,this.circleUid++),this.circleKeys.push(e),this.circles.push(n),this.circles.push(i),this.circles.push(s)}_insertBoxCell(e,n,i,s,l,u){this.boxCells[l].push(u)}_insertCircleCell(e,n,i,s,l,u){this.circleCells[l].push(u)}_query(e,n,i,s,l,u){if(i<0||e>this.width||s<0||n>this.height)return!l&&[];const h=[];if(e<=0&&n<=0&&this.width<=i&&this.height<=s){if(l)return!0;for(let f=0;f<this.boxKeys.length;f++)h.push({key:this.boxKeys[f],x1:this.bboxes[4*f],y1:this.bboxes[4*f+1],x2:this.bboxes[4*f+2],y2:this.bboxes[4*f+3]});for(let f=0;f<this.circleKeys.length;f++){const m=this.circles[3*f],y=this.circles[3*f+1],v=this.circles[3*f+2];h.push({key:this.circleKeys[f],x1:m-v,y1:y-v,x2:m+v,y2:y+v})}return u?h.filter(u):h}return this._forEachCell(e,n,i,s,this._queryCell,h,{hitTest:l,seenUids:{box:{},circle:{}}},u),l?h.length>0:h}_queryCircle(e,n,i,s,l){const u=e-i,h=e+i,f=n-i,m=n+i;if(h<0||u>this.width||m<0||f>this.height)return!s&&[];const y=[];return this._forEachCell(u,f,h,m,this._queryCellCircle,y,{hitTest:s,circle:{x:e,y:n,radius:i},seenUids:{box:{},circle:{}}},l),s?y.length>0:y}query(e,n,i,s,l){return this._query(e,n,i,s,!1,l)}hitTest(e,n,i,s,l){return this._query(e,n,i,s,!0,l)}hitTestCircle(e,n,i,s){return this._queryCircle(e,n,i,!0,s)}_queryCell(e,n,i,s,l,u,h,f){const m=h.seenUids,y=this.boxCells[l];if(y!==null){const w=this.bboxes;for(const S of y)if(!m.box[S]){m.box[S]=!0;const E=4*S;if(e<=w[E+2]&&n<=w[E+3]&&i>=w[E+0]&&s>=w[E+1]&&(!f||f(this.boxKeys[S]))){if(h.hitTest)return u.push(!0),!0;u.push({key:this.boxKeys[S],x1:w[E],y1:w[E+1],x2:w[E+2],y2:w[E+3]})}}}const v=this.circleCells[l];if(v!==null){const w=this.circles;for(const S of v)if(!m.circle[S]){m.circle[S]=!0;const E=3*S;if(this._circleAndRectCollide(w[E],w[E+1],w[E+2],e,n,i,s)&&(!f||f(this.circleKeys[S]))){if(h.hitTest)return u.push(!0),!0;{const A=w[E],M=w[E+1],k=w[E+2];u.push({key:this.circleKeys[S],x1:A-k,y1:M-k,x2:A+k,y2:M+k})}}}}}_queryCellCircle(e,n,i,s,l,u,h,f){const m=h.circle,y=h.seenUids,v=this.boxCells[l];if(v!==null){const S=this.bboxes;for(const E of v)if(!y.box[E]){y.box[E]=!0;const A=4*E;if(this._circleAndRectCollide(m.x,m.y,m.radius,S[A+0],S[A+1],S[A+2],S[A+3])&&(!f||f(this.boxKeys[E])))return u.push(!0),!0}}const w=this.circleCells[l];if(w!==null){const S=this.circles;for(const E of w)if(!y.circle[E]){y.circle[E]=!0;const A=3*E;if(this._circlesCollide(S[A],S[A+1],S[A+2],m.x,m.y,m.radius)&&(!f||f(this.circleKeys[E])))return u.push(!0),!0}}}_forEachCell(e,n,i,s,l,u,h,f){const m=this._convertToXCellCoord(e),y=this._convertToYCellCoord(n),v=this._convertToXCellCoord(i),w=this._convertToYCellCoord(s);for(let S=m;S<=v;S++)for(let E=y;E<=w;E++)if(l.call(this,e,n,i,s,this.xCellCount*E+S,u,h,f))return}_convertToXCellCoord(e){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(e*this.xScale)))}_convertToYCellCoord(e){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(e*this.yScale)))}_circlesCollide(e,n,i,s,l,u){const h=s-e,f=l-n,m=i+u;return m*m>h*h+f*f}_circleAndRectCollide(e,n,i,s,l,u,h){const f=(u-s)/2,m=Math.abs(e-(s+f));if(m>f+i)return!1;const y=(h-l)/2,v=Math.abs(n-(l+y));if(v>y+i)return!1;if(m<=f||v<=y)return!0;const w=m-f,S=v-y;return w*w+S*S<=i*i}}const su=100;class Uj{constructor(e,n,i=new Jk(e.width+200,e.height+200,25),s=new Jk(e.width+200,e.height+200,25)){this.transform=e,this.grid=i,this.ignoredGrid=s,this.pitchfactor=Math.cos(e._pitch)*e.cameraToCenterDistance,this.screenRightBoundary=e.width+su,this.screenBottomBoundary=e.height+su,this.gridRightBoundary=e.width+200,this.gridBottomBoundary=e.height+200,this.fogState=n}placeCollisionBox(e,n,i,s,l,u,h,f){let m=i.projectedAnchorX,y=i.projectedAnchorY,v=i.projectedAnchorZ;const w=i.elevation,S=i.tileID,E=e.getProjection();if(w&&S){const[j,V,Y]=E.upVector(S.canonical,i.tileAnchorX,i.tileAnchorY),ne=E.upVectorScale(S.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;m+=j*w*ne,y+=V*w*ne,v+=Y*w*ne}const A=this.projectAndGetPerspectiveRatio(h,m,y,v,i.tileID,E.name==="globe"||!!w||this.transform.pitch>0,E),M=u*A.perspectiveRatio,k=(i.x1*n+s.x-i.padding)*M+A.point.x,R=(i.y1*n+s.y-i.padding)*M+A.point.y,L=(i.x2*n+s.x+i.padding)*M+A.point.x,z=(i.y2*n+s.y+i.padding)*M+A.point.y,B=A.perspectiveRatio<=.55||A.occluded;return!this.isInsideGrid(k,R,L,z)||!l&&this.grid.hitTest(k,R,L,z,f)||B?{box:[],offscreen:!1,occluded:A.occluded}:{box:[k,R,L,z],offscreen:this.isOffscreen(k,R,L,z),occluded:!1}}placeCollisionCircles(e,n,i,s,l,u,h,f,m,y,v,w,S,E,A){const M=[],k=this.transform.elevation,R=e.getProjection(),L=k?k.getAtTileOffsetFunc(A,this.transform.center.lat,this.transform.worldSize,R):null,z=new q(i.tileAnchorX,i.tileAnchorY);let{x:B,y:j,z:V}=R.projectTilePoint(z.x,z.y,A.canonical);if(L){const[Pe,pe,Ae]=L(z);B+=Pe,j+=pe,V+=Ae}const Y=R.name==="globe",ne=this.projectAndGetPerspectiveRatio(h,B,j,V,A,Y||!!k||this.transform.pitch>0,R),{perspectiveRatio:re}=ne,J=(v?u/re:u*re)/Wi,ae=vl(B,j,V,f),le=ne.signedDistanceFromCamera>0?UI(J,l,i.lineOffsetX*J,i.lineOffsetY*J,!1,ae,z,i,s,f,{},k&&!v?L:null,v&&!!k,R,A,v):null;let oe=!1,Ee=!1,xe=!0;if(le&&!ne.occluded){const Pe=.5*S*re+E,pe=new q(-100,-100),Ae=new q(this.screenRightBoundary,this.screenBottomBoundary),Le=new jj,{first:qe,last:Ve}=le,yt=qe.path.length;let mt=[];for(let Mt=yt-1;Mt>=1;Mt--)mt.push(qe.path[Mt]);for(let Mt=1;Mt<Ve.path.length;Mt++)mt.push(Ve.path[Mt]);const lt=2.5*Pe;m&&(mt=mt.map(([Mt,Zt,Gt],Ut)=>(L&&!Y&&(Gt=L(Ut<yt-1?qe.tilePath[yt-1-Ut]:Ve.tilePath[Ut-yt+2])[2]),vl(Mt,Zt,Gt,m))),mt.some(Mt=>Mt[3]<=0)&&(mt=[]));let ft=[];if(mt.length>0){let Mt=1/0,Zt=-1/0,Gt=1/0,Ut=-1/0;for(const Xt of mt)Mt=Math.min(Mt,Xt[0]),Gt=Math.min(Gt,Xt[1]),Zt=Math.max(Zt,Xt[0]),Ut=Math.max(Ut,Xt[1]);Zt>=pe.x&&Mt<=Ae.x&&Ut>=pe.y&&Gt<=Ae.y&&(ft=[mt.map(Xt=>new q(Xt[0],Xt[1]))],(Mt<pe.x||Zt>Ae.x||Gt<pe.y||Ut>Ae.y)&&(ft=cI(ft,pe.x,pe.y,Ae.x,Ae.y)))}for(const Mt of ft){Le.reset(Mt,.25*Pe);let Zt=0;Zt=Le.length<=.5*Pe?1:Math.ceil(Le.paddedLength/lt)+1;for(let Gt=0;Gt<Zt;Gt++){const Ut=Gt/Math.max(Zt-1,1),Xt=Le.lerp(Ut),zn=Xt.x+su,Pn=Xt.y+su;M.push(zn,Pn,Pe,0);const or=zn-Pe,Rn=Pn-Pe,Fn=zn+Pe,an=Pn+Pe;if(xe=xe&&this.isOffscreen(or,Rn,Fn,an),Ee=Ee||this.isInsideGrid(or,Rn,Fn,an),!n&&this.grid.hitTestCircle(zn,Pn,Pe,w)&&(oe=!0,!y))return{circles:[],offscreen:!1,collisionDetected:oe,occluded:!1}}}}return{circles:!y&&oe||!Ee?[]:M,offscreen:xe,collisionDetected:oe,occluded:ne.occluded}}queryRenderedSymbols(e){if(e.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const n=[];let i=1/0,s=1/0,l=-1/0,u=-1/0;for(const y of e){const v=new q(y.x+su,y.y+su);i=Math.min(i,v.x),s=Math.min(s,v.y),l=Math.max(l,v.x),u=Math.max(u,v.y),n.push(v)}const h=this.grid.query(i,s,l,u).concat(this.ignoredGrid.query(i,s,l,u)),f={},m={};for(const y of h){const v=y.key;f[v.bucketInstanceId]===void 0&&(f[v.bucketInstanceId]={}),f[v.bucketInstanceId][v.featureIndex]||p3(n,[new q(y.x1,y.y1),new q(y.x2,y.y1),new q(y.x2,y.y2),new q(y.x1,y.y2)])&&(f[v.bucketInstanceId][v.featureIndex]=!0,m[v.bucketInstanceId]===void 0&&(m[v.bucketInstanceId]=[]),m[v.bucketInstanceId].push(v.featureIndex))}return m}insertCollisionBox(e,n,i,s,l){(n?this.ignoredGrid:this.grid).insert({bucketInstanceId:i,featureIndex:s,collisionGroupID:l},e[0],e[1],e[2],e[3])}insertCollisionCircles(e,n,i,s,l){const u=n?this.ignoredGrid:this.grid,h={bucketInstanceId:i,featureIndex:s,collisionGroupID:l};for(let f=0;f<e.length;f+=4)u.insertCircle(h,e[f],e[f+1],e[f+2])}projectAndGetPerspectiveRatio(e,n,i,s,l,u,h){const f=[n,i,s,1];let m=!1;s||this.transform.pitch>0?(xr.transformMat4(f,f,e),this.fogState&&l&&h.name!=="globe"&&(m=function(w,S,E,A,M,k){const R=k.calculateFogTileMatrix(M),L=[S,E,A];return fe.transformMat4(L,L,R),Mk(w,L,k.pitch,k._fov)}(this.fogState,n,i,s,l.toUnwrapped(),this.transform)>.9)):qI(f,f,e);const y=f[3];return{point:new q((f[0]/y+1)/2*this.transform.width+su,(-f[1]/y+1)/2*this.transform.height+su),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(h)/y*.5,1.5),signedDistanceFromCamera:y,occluded:u&&f[2]>y||m}}isOffscreen(e,n,i,s){return i<su||e>=this.screenRightBoundary||s<su||n>this.screenBottomBoundary}isInsideGrid(e,n,i,s){return i>=0&&e<this.gridRightBoundary&&s>=0&&n<this.gridBottomBoundary}getViewportMatrix(){const e=Me.identity([]);return Me.translate(e,e,[-100,-100,0]),e}}function uE(t,e,n){const i=e.createTileMatrix(t,t.worldSize,n.toUnwrapped());return Me.multiply(new Float32Array(16),t.projMatrix,i)}function Vj(t,e,n){if(e.projection.name===n.projection.name)return t.projMatrix;const i=n.clone();return i.setProjection(e.projection),uE(i,e.getProjection(),t)}function cE(t,e,n){return e.name===n.projection.name?t.projMatrix:uE(n,e,t)}class eP{constructor(e,n,i,s){this.opacity=e?Math.max(0,Math.min(1,e.opacity+(e.placed?n:-n))):s&&i?1:0,this.placed=i}isHidden(){return this.opacity===0&&!this.placed}}class F_{constructor(e,n,i,s,l,u=!1){this.text=new eP(e?e.text:null,n,i,l),this.icon=new eP(e?e.icon:null,n,s,l),this.clipped=u}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class hE{constructor(e,n,i,s=!1){this.text=e,this.icon=n,this.skipFade=i,this.clipped=s}}class $j{constructor(){this.invProjMatrix=Me.create(),this.viewportMatrix=Me.create(),this.circles=[]}}class Gj{constructor(e,n,i,s,l){this.bucketInstanceId=e,this.featureIndex=n,this.sourceLayerIndex=i,this.bucketIndex=s,this.tileID=l}}class Hj{constructor(e){this.crossSourceCollisions=e,this.maxGroupID=0,this.collisionGroups={}}get(e){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[e]){const n=++this.maxGroupID;this.collisionGroups[e]={ID:n,predicate:i=>i.collisionGroupID===n}}return this.collisionGroups[e]}}function tP(t,e,n,i,s){const{horizontalAlign:l,verticalAlign:u}=G1(t),h=-(l-.5)*e,f=-(u-.5)*n,m=OS(t,i);return new q(h+m[0]*s,f+m[1]*s)}function dE(t,e,n,i,s){const l=new q(t,e);return n&&l._rotate(i?s:-s),l}class qj{constructor(e,n,i,s,l){this.transform=e.clone(),this.projection=e.projection.name,this.collisionIndex=new Uj(this.transform,l),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=n,this.retainedQueryData={},this.collisionGroups=new Hj(i),this.collisionCircleArrays={},this.prevPlacement=s,s&&(s.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(e,n,i,s){const l=i.getBucket(n),u=i.latestFeatureIndex;if(!l||!u||n.id!==l.layerIds[0])return;const h=l.layers[0].layout,f=i.collisionBoxArray,m=Math.pow(2,this.transform.zoom-i.tileID.overscaledZ),y=i.tileSize/Ge,v=i.tileID.toUnwrapped();this.transform.setProjection(l.projection);const w=(S=i.tileID,E=l.getProjection(),A=this.transform,E.name===this.projection?A.calculateProjMatrix(S.toUnwrapped()):uE(A,E,S));var S,E,A;const M=h.get("text-pitch-alignment")==="map",k=h.get("text-rotation-alignment")==="map";n.compileFilter();const R=n.dynamicFilter(),L=n.dynamicFilterNeedsFeature(),z=this.transform.calculatePixelsToTileUnitsMatrix(i),B=BI(w,i.tileID.canonical,M,k,this.transform,l.getProjection(),z);let j=null;if(M){const ne=NI(w,i.tileID.canonical,M,k,this.transform,l.getProjection(),z);j=Me.multiply([],this.transform.labelPlaneMatrix,ne)}let V=null;R&&i.latestFeatureIndex&&(V={unwrappedTileID:v,dynamicFilter:R,dynamicFilterNeedsFeature:L,featureIndex:i.latestFeatureIndex}),this.retainedQueryData[l.bucketInstanceId]=new Gj(l.bucketInstanceId,u,l.sourceLayerIndex,l.index,i.tileID);const Y={bucket:l,layout:h,posMatrix:w,textLabelPlaneMatrix:B,labelToScreenMatrix:j,clippingData:V,scale:m,textPixelRatio:y,holdingForFade:i.holdingForFade(),collisionBoxArray:f,partiallyEvaluatedTextSize:ru(l.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:ru(l.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(l.sourceID)};if(s)for(const ne of l.sortKeyRanges){const{sortKey:re,symbolInstanceStart:J,symbolInstanceEnd:ae}=ne;e.push({sortKey:re,symbolInstanceStart:J,symbolInstanceEnd:ae,parameters:Y})}else e.push({symbolInstanceStart:0,symbolInstanceEnd:l.symbolInstances.length,parameters:Y})}attemptAnchorPlacement(e,n,i,s,l,u,h,f,m,y,v,w,S,E,A,M,k,R){const{textOffset0:L,textOffset1:z,crossTileID:B}=w,j=[L,z],V=tP(e,i,s,j,l),Y=this.collisionIndex.placeCollisionBox(E,l,n,dE(V.x,V.y,u,h,this.transform.angle),v,f,m,y.predicate);if(M){const ne=E.getSymbolInstanceIconSize(R,this.transform.zoom,w.placedIconSymbolIndex);if(this.collisionIndex.placeCollisionBox(E,ne,M,dE(V.x,V.y,u,h,this.transform.angle),v,f,m,y.predicate).box.length===0)return}if(Y.box.length>0){let ne;return this.prevPlacement&&this.prevPlacement.variableOffsets[B]&&this.prevPlacement.placements[B]&&this.prevPlacement.placements[B].text&&(ne=this.prevPlacement.variableOffsets[B].anchor),this.variableOffsets[B]={textOffset:j,width:i,height:s,anchor:e,textScale:l,prevAnchor:ne},this.markUsedJustification(E,e,w,A),E.allowVerticalPlacement&&(this.markUsedOrientation(E,A,w),this.placedOrientations[B]=A),{shift:V,placedGlyphBoxes:Y}}}placeLayerBucketPart(e,n,i,s){const{bucket:l,layout:u,posMatrix:h,textLabelPlaneMatrix:f,labelToScreenMatrix:m,clippingData:y,textPixelRatio:v,holdingForFade:w,collisionBoxArray:S,partiallyEvaluatedTextSize:E,partiallyEvaluatedIconSize:A,collisionGroup:M}=e.parameters,k=u.get("text-optional"),R=u.get("icon-optional"),L=u.get("text-allow-overlap"),z=u.get("icon-allow-overlap"),B=u.get("text-rotation-alignment")==="map",j=u.get("text-pitch-alignment")==="map",V=u.get("symbol-z-order")==="viewport-y";this.transform.setProjection(l.projection);let Y=L&&(z||!l.hasIconData()||R),ne=z&&(L||!l.hasTextData()||k);!l.collisionArrays&&S&&l.deserializeCollisionBoxes(S),i&&s&&l.updateCollisionDebugBuffers(this.transform.zoom,S);const re=(J,ae,le)=>{const{crossTileID:oe,numVerticalGlyphVertices:Ee}=J;if(y){const Rn={zoom:this.transform.zoom,pitch:this.transform.pitch};let Fn=null;if(y.dynamicFilterNeedsFeature){const an=this.retainedQueryData[l.bucketInstanceId];Fn=y.featureIndex.loadFeature({featureIndex:J.featureIndex,bucketIndex:an.bucketIndex,sourceLayerIndex:an.sourceLayerIndex,layoutVertexArrayOffset:0})}if(!(0,y.dynamicFilter)(Rn,Fn,this.retainedQueryData[l.bucketInstanceId].tileID.canonical,new q(J.tileAnchorX,J.tileAnchorY),this.transform.calculateDistanceTileData(y.unwrappedTileID)))return this.placements[oe]=new hE(!1,!1,!1,!0),void n.add(oe)}if(n.has(oe))return;if(w)return void(this.placements[oe]=new hE(!1,!1,!1));let xe=!1,Pe=!1,pe=!0,Ae=!1,Le=!1,qe=null,Ve={box:null,offscreen:null,occluded:null},yt={box:null,offscreen:null,occluded:null},mt=null,lt=null,ft=null,Mt=0,Zt=0,Gt=0;le.textFeatureIndex?Mt=le.textFeatureIndex:J.useRuntimeCollisionCircles&&(Mt=J.featureIndex),le.verticalTextFeatureIndex&&(Zt=le.verticalTextFeatureIndex);const Ut=Rn=>{Rn.tileID=this.retainedQueryData[l.bucketInstanceId].tileID;const Fn=this.transform.elevation;(Fn||Rn.elevation)&&(Rn.elevation=Fn?Fn.getAtTileOffset(Rn.tileID,Rn.tileAnchorX,Rn.tileAnchorY):0)},Xt=le.textBox;if(Xt){Ut(Xt);const Rn=an=>{let An=Gr.horizontal;if(l.allowVerticalPlacement&&!an&&this.prevPlacement){const sr=this.prevPlacement.placedOrientations[oe];sr&&(this.placedOrientations[oe]=sr,An=sr,this.markUsedOrientation(l,An,J))}return An},Fn=(an,An)=>{if(l.allowVerticalPlacement&&Ee>0&&le.verticalTextBox){for(const sr of l.writingModes)if(sr===Gr.vertical?(Ve=An(),yt=Ve):Ve=an(),Ve&&Ve.box&&Ve.box.length)break}else Ve=an()};if(u.get("text-variable-anchor")){let an=u.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[oe]){const Mn=this.prevPlacement.variableOffsets[oe];an.indexOf(Mn.anchor)>0&&(an=an.filter(cr=>cr!==Mn.anchor),an.unshift(Mn.anchor))}const An=(Mn,cr,fi)=>{const pi=l.getSymbolInstanceTextSize(E,J,this.transform.zoom,ae),Zr=(Mn.x2-Mn.x1)*pi+2*Mn.padding,zr=(Mn.y2-Mn.y1)*pi+2*Mn.padding,Mi=J.hasIconTextFit&&!z?cr:null;Mi&&Ut(Mi);let qr={box:[],offscreen:!1,occluded:!1};const Di=L?2*an.length:an.length;for(let fr=0;fr<Di;++fr){const vs=this.attemptAnchorPlacement(an[fr%an.length],Mn,Zr,zr,pi,B,j,v,h,M,fr>=an.length,J,ae,l,fi,Mi,E,A);if(vs&&(qr=vs.placedGlyphBoxes,qr&&qr.box&&qr.box.length)){xe=!0,qe=vs.shift;break}}return qr};Fn(()=>An(Xt,le.iconBox,Gr.horizontal),()=>{const Mn=le.verticalTextBox;return Mn&&Ut(Mn),l.allowVerticalPlacement&&!(Ve&&Ve.box&&Ve.box.length)&&Ee>0&&Mn?An(Mn,le.verticalIconBox,Gr.vertical):{box:null,offscreen:null,occluded:null}}),Ve&&(xe=Ve.box,pe=Ve.offscreen,Ae=Ve.occluded);const sr=Rn(!(!Ve||!Ve.box));if(!xe&&this.prevPlacement){const Mn=this.prevPlacement.variableOffsets[oe];Mn&&(this.variableOffsets[oe]=Mn,this.markUsedJustification(l,Mn.anchor,J,sr))}}else{const an=(An,sr)=>{const Mn=l.getSymbolInstanceTextSize(E,J,this.transform.zoom,ae),cr=this.collisionIndex.placeCollisionBox(l,Mn,An,new q(0,0),L,v,h,M.predicate);return cr&&cr.box&&cr.box.length&&(this.markUsedOrientation(l,sr,J),this.placedOrientations[oe]=sr),cr};Fn(()=>an(Xt,Gr.horizontal),()=>{const An=le.verticalTextBox;return l.allowVerticalPlacement&&Ee>0&&An?(Ut(An),an(An,Gr.vertical)):{box:null,offscreen:null,occluded:null}}),Rn(!!(Ve&&Ve.box&&Ve.box.length))}}if(mt=Ve,xe=mt&&mt.box&&mt.box.length>0,pe=mt&&mt.offscreen,Ae=mt&&mt.occluded,J.useRuntimeCollisionCircles){const Rn=l.text.placedSymbolArray.get(J.centerJustifiedTextSymbolIndex>=0?J.centerJustifiedTextSymbolIndex:J.verticalPlacedTextSymbolIndex),Fn=p_(l.textSizeData,E,Rn),an=u.get("text-padding");lt=this.collisionIndex.placeCollisionCircles(l,L,Rn,l.lineVertexArray,l.glyphOffsetArray,Fn,h,f,m,i,j,M.predicate,J.collisionCircleDiameter*Fn/Wi,an,this.retainedQueryData[l.bucketInstanceId].tileID),xe=L||lt.circles.length>0&&!lt.collisionDetected,pe=pe&&lt.offscreen,Ae=lt.occluded}if(le.iconFeatureIndex&&(Gt=le.iconFeatureIndex),le.iconBox){const Rn=Fn=>{Ut(Fn);const an=J.hasIconTextFit&&qe?dE(qe.x,qe.y,B,j,this.transform.angle):new q(0,0),An=l.getSymbolInstanceIconSize(A,this.transform.zoom,J.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(l,An,Fn,an,z,v,h,M.predicate)};yt&&yt.box&&yt.box.length&&le.verticalIconBox?(ft=Rn(le.verticalIconBox),Pe=ft.box.length>0):(ft=Rn(le.iconBox),Pe=ft.box.length>0),pe=pe&&ft.offscreen,Le=ft.occluded}const zn=k||J.numHorizontalGlyphVertices===0&&Ee===0,Pn=R||J.numIconVertices===0;if(zn||Pn?Pn?zn||(Pe=Pe&&xe):xe=Pe&&xe:Pe=xe=Pe&&xe,xe&&mt&&mt.box&&this.collisionIndex.insertCollisionBox(mt.box,u.get("text-ignore-placement"),l.bucketInstanceId,yt&&yt.box&&Zt?Zt:Mt,M.ID),Pe&&ft&&this.collisionIndex.insertCollisionBox(ft.box,u.get("icon-ignore-placement"),l.bucketInstanceId,Gt,M.ID),lt&&(xe&&this.collisionIndex.insertCollisionCircles(lt.circles,u.get("text-ignore-placement"),l.bucketInstanceId,Mt,M.ID),i)){const Rn=l.bucketInstanceId;let Fn=this.collisionCircleArrays[Rn];Fn===void 0&&(Fn=this.collisionCircleArrays[Rn]=new $j);for(let an=0;an<lt.circles.length;an+=4)Fn.circles.push(lt.circles[an+0]),Fn.circles.push(lt.circles[an+1]),Fn.circles.push(lt.circles[an+2]),Fn.circles.push(lt.collisionDetected?1:0)}const or=l.projection.name!=="globe";Y=Y&&(or||!Ae),ne=ne&&(or||!Le),this.placements[oe]=new hE(xe||Y,Pe||ne,pe||l.justReloaded),n.add(oe)};if(V){const J=l.getSortedSymbolIndexes(this.transform.angle);for(let ae=J.length-1;ae>=0;--ae){const le=J[ae];re(l.symbolInstances.get(le),le,l.collisionArrays[le])}}else for(let J=e.symbolInstanceStart;J<e.symbolInstanceEnd;J++)re(l.symbolInstances.get(J),J,l.collisionArrays[J]);if(i&&l.bucketInstanceId in this.collisionCircleArrays){const J=this.collisionCircleArrays[l.bucketInstanceId];Me.invert(J.invProjMatrix,h),J.viewportMatrix=this.collisionIndex.getViewportMatrix()}l.justReloaded=!1}markUsedJustification(e,n,i,s){const{leftJustifiedTextSymbolIndex:l,centerJustifiedTextSymbolIndex:u,rightJustifiedTextSymbolIndex:h,verticalPlacedTextSymbolIndex:f,crossTileID:m}=i,y=zS(n),v=s===Gr.vertical?f:y==="left"?l:y==="center"?u:y==="right"?h:-1;l>=0&&(e.text.placedSymbolArray.get(l).crossTileID=v>=0&&l!==v?0:m),u>=0&&(e.text.placedSymbolArray.get(u).crossTileID=v>=0&&u!==v?0:m),h>=0&&(e.text.placedSymbolArray.get(h).crossTileID=v>=0&&h!==v?0:m),f>=0&&(e.text.placedSymbolArray.get(f).crossTileID=v>=0&&f!==v?0:m)}markUsedOrientation(e,n,i){const s=n===Gr.horizontal||n===Gr.horizontalOnly?n:0,l=n===Gr.vertical?n:0,{leftJustifiedTextSymbolIndex:u,centerJustifiedTextSymbolIndex:h,rightJustifiedTextSymbolIndex:f,verticalPlacedTextSymbolIndex:m}=i,y=e.text.placedSymbolArray;u>=0&&(y.get(u).placedOrientation=s),h>=0&&(y.get(h).placedOrientation=s),f>=0&&(y.get(f).placedOrientation=s),m>=0&&(y.get(m).placedOrientation=l)}commit(e){this.commitTime=e,this.zoomAtLastRecencyCheck=this.transform.zoom;const n=this.prevPlacement;let i=!1;this.prevZoomAdjustment=n?n.zoomAdjustment(this.transform.zoom):0;const s=n?n.symbolFadeChange(e):1,l=n?n.opacities:{},u=n?n.variableOffsets:{},h=n?n.placedOrientations:{};for(const f in this.placements){const m=this.placements[f],y=l[f];y?(this.opacities[f]=new F_(y,s,m.text,m.icon,null,m.clipped),i=i||m.text!==y.text.placed||m.icon!==y.icon.placed):(this.opacities[f]=new F_(null,s,m.text,m.icon,m.skipFade,m.clipped),i=i||m.text||m.icon)}for(const f in l){const m=l[f];if(!this.opacities[f]){const y=new F_(m,s,!1,!1);y.isHidden()||(this.opacities[f]=y,i=i||m.text.placed||m.icon.placed)}}for(const f in u)this.variableOffsets[f]||!this.opacities[f]||this.opacities[f].isHidden()||(this.variableOffsets[f]=u[f]);for(const f in h)this.placedOrientations[f]||!this.opacities[f]||this.opacities[f].isHidden()||(this.placedOrientations[f]=h[f]);i?this.lastPlacementChangeTime=e:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=n?n.lastPlacementChangeTime:e)}updateLayerOpacities(e,n){const i=new Set;for(const s of n){const l=s.getBucket(e);l&&s.latestFeatureIndex&&e.id===l.layerIds[0]&&this.updateBucketOpacities(l,i,s.collisionBoxArray)}}updateBucketOpacities(e,n,i){e.hasTextData()&&e.text.opacityVertexArray.clear(),e.hasIconData()&&e.icon.opacityVertexArray.clear(),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexArray.clear(),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexArray.clear();const s=e.layers[0].layout,l=!!e.layers[0].dynamicFilter(),u=new F_(null,0,!1,!1,!0),h=s.get("text-allow-overlap"),f=s.get("icon-allow-overlap"),m=s.get("text-variable-anchor"),y=s.get("text-rotation-alignment")==="map",v=s.get("text-pitch-alignment")==="map",w=new F_(null,0,h&&(f||!e.hasIconData()||s.get("icon-optional")),f&&(h||!e.hasTextData()||s.get("text-optional")),!0);!e.collisionArrays&&i&&(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData())&&e.deserializeCollisionBoxes(i);const S=(A,M,k)=>{for(let R=0;R<M/4;R++)A.opacityVertexArray.emplaceBack(k)};let E=0;for(let A=0;A<e.symbolInstances.length;A++){const M=e.symbolInstances.get(A),{numHorizontalGlyphVertices:k,numVerticalGlyphVertices:R,crossTileID:L,numIconVertices:z}=M,B=n.has(L);let j=this.opacities[L];B?j=u:j||(j=w,this.opacities[L]=j),n.add(L);const V=k>0||R>0,Y=z>0,ne=this.placedOrientations[L],re=ne===Gr.vertical,J=ne===Gr.horizontal||ne===Gr.horizontalOnly;if(!V&&!Y||j.isHidden()||E++,V){const ae=nP(j.text);S(e.text,k,re?xx:ae),S(e.text,R,J?xx:ae);const le=j.text.isHidden(),{leftJustifiedTextSymbolIndex:oe,centerJustifiedTextSymbolIndex:Ee,rightJustifiedTextSymbolIndex:xe,verticalPlacedTextSymbolIndex:Pe}=M,pe=e.text.placedSymbolArray,Ae=le||re?1:0;oe>=0&&(pe.get(oe).hidden=Ae),Ee>=0&&(pe.get(Ee).hidden=Ae),xe>=0&&(pe.get(xe).hidden=Ae),Pe>=0&&(pe.get(Pe).hidden=le||J?1:0);const Le=this.variableOffsets[L];Le&&this.markUsedJustification(e,Le.anchor,M,ne);const qe=this.placedOrientations[L];qe&&(this.markUsedJustification(e,"left",M,qe),this.markUsedOrientation(e,qe,M))}if(Y){const ae=nP(j.icon),{placedIconSymbolIndex:le,verticalPlacedIconSymbolIndex:oe}=M,Ee=e.icon.placedSymbolArray,xe=j.icon.isHidden()?1:0;le>=0&&(S(e.icon,z,re?xx:ae),Ee.get(le).hidden=xe),oe>=0&&(S(e.icon,M.numVerticalIconVertices,J?xx:ae),Ee.get(oe).hidden=xe)}if(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData()){const ae=e.collisionArrays[A];if(ae){let le=new q(0,0),oe=!0;if(ae.textBox||ae.verticalTextBox){if(m){const xe=this.variableOffsets[L];xe?(le=tP(xe.anchor,xe.width,xe.height,xe.textOffset,xe.textScale),y&&le._rotate(v?this.transform.angle:-this.transform.angle)):oe=!1}l&&(oe=!j.clipped),ae.textBox&&vx(e.textCollisionBox.collisionVertexArray,j.text.placed,!oe||re,le.x,le.y),ae.verticalTextBox&&vx(e.textCollisionBox.collisionVertexArray,j.text.placed,!oe||J,le.x,le.y)}const Ee=oe&&!!(!J&&ae.verticalIconBox);ae.iconBox&&vx(e.iconCollisionBox.collisionVertexArray,j.icon.placed,Ee,M.hasIconTextFit?le.x:0,M.hasIconTextFit?le.y:0),ae.verticalIconBox&&vx(e.iconCollisionBox.collisionVertexArray,j.icon.placed,!Ee,M.hasIconTextFit?le.x:0,M.hasIconTextFit?le.y:0)}}}if(e.fullyClipped=E===0,e.sortFeatures(this.transform.angle),this.retainedQueryData[e.bucketInstanceId]&&(this.retainedQueryData[e.bucketInstanceId].featureSortOrder=e.featureSortOrder),e.hasTextData()&&e.text.opacityVertexBuffer&&e.text.opacityVertexBuffer.updateData(e.text.opacityVertexArray),e.hasIconData()&&e.icon.opacityVertexBuffer&&e.icon.opacityVertexBuffer.updateData(e.icon.opacityVertexArray),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexBuffer&&e.iconCollisionBox.collisionVertexBuffer.updateData(e.iconCollisionBox.collisionVertexArray),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexBuffer&&e.textCollisionBox.collisionVertexBuffer.updateData(e.textCollisionBox.collisionVertexArray),e.bucketInstanceId in this.collisionCircleArrays){const A=this.collisionCircleArrays[e.bucketInstanceId];e.placementInvProjMatrix=A.invProjMatrix,e.placementViewportMatrix=A.viewportMatrix,e.collisionCircleArray=A.circles,delete this.collisionCircleArrays[e.bucketInstanceId]}}symbolFadeChange(e){return this.fadeDuration===0?1:(e-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(e){return Math.max(0,(this.transform.zoom-e)/1.5)}hasTransitions(e){return this.stale||e-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(e,n){const i=this.zoomAtLastRecencyCheck===n?1-this.zoomAdjustment(n):1;return this.zoomAtLastRecencyCheck=n,this.commitTime+this.fadeDuration*i>e}setStale(){this.stale=!0}}function vx(t,e,n,i,s){t.emplaceBack(e?1:0,n?1:0,i||0,s||0),t.emplaceBack(e?1:0,n?1:0,i||0,s||0),t.emplaceBack(e?1:0,n?1:0,i||0,s||0),t.emplaceBack(e?1:0,n?1:0,i||0,s||0)}const Wj=Math.pow(2,25),Zj=Math.pow(2,24),Xj=Math.pow(2,17),Kj=Math.pow(2,16),Yj=Math.pow(2,9),Qj=Math.pow(2,8),Jj=Math.pow(2,1);function nP(t){if(t.opacity===0&&!t.placed)return 0;if(t.opacity===1&&t.placed)return 4294967295;const e=t.placed?1:0,n=Math.floor(127*t.opacity);return n*Wj+e*Zj+n*Xj+e*Kj+n*Yj+e*Qj+n*Jj+e}const xx=0;class eU{constructor(e){this._sortAcrossTiles=e.layout.get("symbol-z-order")!=="viewport-y"&&e.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs=new Set,this._bucketParts=[]}continuePlacement(e,n,i,s,l){const u=this._bucketParts;for(;this._currentTileIndex<e.length;)if(n.getBucketParts(u,s,e[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,l())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,u.sort((h,f)=>h.sortKey-f.sortKey));this._currentPartIndex<u.length;){const h=u[this._currentPartIndex];if(n.placeLayerBucketPart(h,this._seenCrossTileIDs,i,h.symbolInstanceStart===0),this._currentPartIndex++,l())return!0}return!1}}class tU{constructor(e,n,i,s,l,u,h,f){this.placement=new qj(e,l,u,h,f),this._currentPlacementIndex=n.length-1,this._forceFullPlacement=i,this._showCollisionBoxes=s,this._done=!1}isDone(){return this._done}continuePlacement(e,n,i){const s=mn.now(),l=()=>{const u=mn.now()-s;return!this._forceFullPlacement&&u>2};for(;this._currentPlacementIndex>=0;){const u=n[e[this._currentPlacementIndex]],h=this.placement.collisionIndex.transform.zoom;if(u.type==="symbol"&&(!u.minzoom||u.minzoom<=h)&&(!u.maxzoom||u.maxzoom>h)){if(this._inProgressLayer||(this._inProgressLayer=new eU(u)),this._inProgressLayer.continuePlacement(i[u.source],this.placement,this._showCollisionBoxes,u,l))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(e){return this.placement.commit(e),this.placement}}const rP=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class wx{static from(e){if(!(e instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[n,i]=new Uint8Array(e,0,2);if(n!==219)throw new Error("Data does not appear to be in a KDBush format.");const s=i>>4;if(s!==1)throw new Error(`Got v${s} data when expected v1.`);const l=rP[15&i];if(!l)throw new Error("Unrecognized array type.");const[u]=new Uint16Array(e,2,1),[h]=new Uint32Array(e,4,1);return new wx(h,u,l,e)}constructor(e,n=64,i=Float64Array,s){if(isNaN(e)||e<0)throw new Error(`Unpexpected numItems value: ${e}.`);this.numItems=+e,this.nodeSize=Math.min(Math.max(+n,2),65535),this.ArrayType=i,this.IndexArrayType=e<65536?Uint16Array:Uint32Array;const l=rP.indexOf(this.ArrayType),u=2*e*this.ArrayType.BYTES_PER_ELEMENT,h=e*this.IndexArrayType.BYTES_PER_ELEMENT,f=(8-h%8)%8;if(l<0)throw new Error(`Unexpected typed array class: ${i}.`);s&&s instanceof ArrayBuffer?(this.data=s,this.ids=new this.IndexArrayType(this.data,8,e),this.coords=new this.ArrayType(this.data,8+h+f,2*e),this._pos=2*e,this._finished=!0):(this.data=new ArrayBuffer(8+u+h+f),this.ids=new this.IndexArrayType(this.data,8,e),this.coords=new this.ArrayType(this.data,8+h+f,2*e),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+l]),new Uint16Array(this.data,2,1)[0]=n,new Uint32Array(this.data,4,1)[0]=e)}add(e,n){const i=this._pos>>1;return this.ids[i]=i,this.coords[this._pos++]=e,this.coords[this._pos++]=n,i}finish(){const e=this._pos>>1;if(e!==this.numItems)throw new Error(`Added ${e} items when expected ${this.numItems}.`);return fE(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(e,n,i,s){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:l,coords:u,nodeSize:h}=this,f=[0,l.length-1,0],m=[];for(;f.length;){const y=f.pop()||0,v=f.pop()||0,w=f.pop()||0;if(v-w<=h){for(let M=w;M<=v;M++){const k=u[2*M],R=u[2*M+1];k>=e&&k<=i&&R>=n&&R<=s&&m.push(l[M])}continue}const S=w+v>>1,E=u[2*S],A=u[2*S+1];E>=e&&E<=i&&A>=n&&A<=s&&m.push(l[S]),(y===0?e<=E:n<=A)&&(f.push(w),f.push(S-1),f.push(1-y)),(y===0?i>=E:s>=A)&&(f.push(S+1),f.push(v),f.push(1-y))}return m}within(e,n,i){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:s,coords:l,nodeSize:u}=this,h=[0,s.length-1,0],f=[],m=i*i;for(;h.length;){const y=h.pop()||0,v=h.pop()||0,w=h.pop()||0;if(v-w<=u){for(let M=w;M<=v;M++)oP(l[2*M],l[2*M+1],e,n)<=m&&f.push(s[M]);continue}const S=w+v>>1,E=l[2*S],A=l[2*S+1];oP(E,A,e,n)<=m&&f.push(s[S]),(y===0?e-i<=E:n-i<=A)&&(h.push(w),h.push(S-1),h.push(1-y)),(y===0?e+i>=E:n+i>=A)&&(h.push(S+1),h.push(v),h.push(1-y))}return f}}function fE(t,e,n,i,s,l){if(s-i<=n)return;const u=i+s>>1;iP(t,e,u,i,s,l),fE(t,e,n,i,u-1,1-l),fE(t,e,n,u+1,s,1-l)}function iP(t,e,n,i,s,l){for(;s>i;){if(s-i>600){const m=s-i+1,y=n-i+1,v=Math.log(m),w=.5*Math.exp(2*v/3),S=.5*Math.sqrt(v*w*(m-w)/m)*(y-m/2<0?-1:1);iP(t,e,n,Math.max(i,Math.floor(n-y*w/m+S)),Math.min(s,Math.floor(n+(m-y)*w/m+S)),l)}const u=e[2*n+l];let h=i,f=s;for(B_(t,e,i,n),e[2*s+l]>u&&B_(t,e,i,s);h<f;){for(B_(t,e,h,f),h++,f--;e[2*h+l]<u;)h++;for(;e[2*f+l]>u;)f--}e[2*i+l]===u?B_(t,e,i,f):(f++,B_(t,e,f,s)),f<=n&&(i=f+1),n<=f&&(s=f-1)}}function B_(t,e,n,i){pE(t,n,i),pE(e,2*n,2*i),pE(e,2*n+1,2*i+1)}function pE(t,e,n){const i=t[e];t[e]=t[n],t[n]=i}function oP(t,e,n,i){const s=t-n,l=e-i;return s*s+l*l}const mE=512/Ge/2;class nU{constructor(e,n,i){this.tileID=e,this.bucketInstanceId=i,this.index=new wx(n.length,16,Int32Array),this.keys=[],this.crossTileIDs=[];const s=e.canonical.x*Ge,l=e.canonical.y*Ge;for(let u=0;u<n.length;u++){const{key:h,crossTileID:f,tileAnchorX:m,tileAnchorY:y}=n.get(u),v=Math.floor((s+m)*mE),w=Math.floor((l+y)*mE);this.index.add(v,w),this.keys.push(h),this.crossTileIDs.push(f)}this.index.finish()}findMatches(e,n,i){const s=this.tileID.canonical.z<n.canonical.z?1:Math.pow(2,this.tileID.canonical.z-n.canonical.z),l=mE/Math.pow(2,n.canonical.z-this.tileID.canonical.z),u=n.canonical.x*Ge,h=n.canonical.y*Ge;for(let f=0;f<e.length;f++){const m=e.get(f);if(m.crossTileID)continue;const{key:y,tileAnchorX:v,tileAnchorY:w}=m,S=Math.floor((u+v)*l),E=Math.floor((h+w)*l),A=this.index.range(S-s,E-s,S+s,E+s);for(const M of A){const k=this.crossTileIDs[M];if(this.keys[M]===y&&!i.has(k)){i.add(k),m.crossTileID=k;break}}}}}class rU{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class iU{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(e){const n=Math.round((e-this.lng)/360);if(n!==0)for(const i in this.indexes){const s=this.indexes[i],l={};for(const u in s){const h=s[u];h.tileID=h.tileID.unwrapTo(h.tileID.wrap+n),l[h.tileID.key]=h}this.indexes[i]=l}this.lng=e}addBucket(e,n,i){if(this.indexes[e.overscaledZ]&&this.indexes[e.overscaledZ][e.key]){if(this.indexes[e.overscaledZ][e.key].bucketInstanceId===n.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(e.overscaledZ,this.indexes[e.overscaledZ][e.key])}for(let l=0;l<n.symbolInstances.length;l++)n.symbolInstances.get(l).crossTileID=0;this.usedCrossTileIDs[e.overscaledZ]||(this.usedCrossTileIDs[e.overscaledZ]=new Set);const s=this.usedCrossTileIDs[e.overscaledZ];for(const l in this.indexes){const u=this.indexes[l];if(Number(l)>e.overscaledZ)for(const h in u){const f=u[h];f.tileID.isChildOf(e)&&f.findMatches(n.symbolInstances,e,s)}else{const h=u[e.scaledTo(Number(l)).key];h&&h.findMatches(n.symbolInstances,e,s)}}for(let l=0;l<n.symbolInstances.length;l++){const u=n.symbolInstances.get(l);u.crossTileID||(u.crossTileID=i.generate(),s.add(u.crossTileID))}return this.indexes[e.overscaledZ]===void 0&&(this.indexes[e.overscaledZ]={}),this.indexes[e.overscaledZ][e.key]=new nU(e,n.symbolInstances,n.bucketInstanceId),!0}removeBucketCrossTileIDs(e,n){for(const i of n.crossTileIDs)this.usedCrossTileIDs[e].delete(i)}removeStaleBuckets(e){let n=!1;for(const i in this.indexes){const s=this.indexes[i];for(const l in s)e[s[l].bucketInstanceId]||(this.removeBucketCrossTileIDs(i,s[l]),delete s[l],n=!0)}return n}}class oU{constructor(){this.layerIndexes={},this.crossTileIDs=new rU,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(e,n,i,s){let l=this.layerIndexes[e.id];l===void 0&&(l=this.layerIndexes[e.id]=new iU);let u=!1;const h={};s.name!=="globe"&&l.handleWrapJump(i);for(const f of n){const m=f.getBucket(e);m&&e.id===m.layerIds[0]&&(m.bucketInstanceId||(m.bucketInstanceId=++this.maxBucketInstanceId),l.addBucket(f.tileID,m,this.crossTileIDs)&&(u=!0),h[m.bucketInstanceId]=!0)}return l.removeStaleBuckets(h)&&(u=!0),u}pruneUnusedLayers(e){const n={};e.forEach(i=>{n[i]=!0});for(const i in this.layerIndexes)n[i]||delete this.layerIndexes[i]}}function zm(t,e){return e?`${t}${e}`:t}function sP(t){const e=t.indexOf("");return e>=0?t.slice(0,e):t}function aP(t){const e=t.indexOf("");return e>=0?t.slice(e+1):""}var lP=`
#define EPSILON 0.0000001
#define PI 3.141592653589793
#define EXTENT 8192.0
#define HALF_PI PI/2.0
#define QUARTER_PI PI/4.0
#define RAD_TO_DEG 180.0/PI
#define DEG_TO_RAD PI/180.0
#define GLOBE_RADIUS EXTENT/PI/2.0
vec3 linearTosRGB(vec3 color)
{return pow(color,vec3(1./2.2));}vec3 sRGBToLinear(vec3 srgbIn)
{return pow(srgbIn,vec3(2.2));}vec3 linearProduct(vec3 srgbIn,vec3 k)
{return srgbIn*pow(k,vec3(1./2.2));}
#if __VERSION__ >=300
#define _HANDLE_WIREFRAME_DEPTH gl_FragDepth=gl_FragCoord.z-0.0001;
#else
#define _HANDLE_WIREFRAME_DEPTH
#endif
#ifdef DEBUG_WIREFRAME
#define HANDLE_WIREFRAME_DEBUG \\
gl_FragColor=vec4(0.7,0.0,0.0,0.7); \\
_HANDLE_WIREFRAME_DEPTH;
#else
#define HANDLE_WIREFRAME_DEBUG
#endif`,uP="attribute highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;varying highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",cP=`
#define ELEVATION_SCALE 7.0
#define ELEVATION_OFFSET 450.0
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(
mix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}
#else
vec3 elevationVector(vec2 pos) { return vec3(0,0,1); }
#endif
const float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)
{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}
#ifdef TERRAIN
#ifdef TERRAIN_DEM_FLOAT_FORMAT
uniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;
#else
uniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;
#endif
uniform vec4 u_dem_unpack;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;uniform sampler2D u_depth;uniform vec2 u_depth_size_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float decodeElevation(vec4 v) {return dot(vec4(v.xyz*255.0,-1.0),u_dem_unpack);}float currentElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem,pos).a;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem,pos));
#ifdef TERRAIN_DEM_NEAREST_FILTER
return u_exaggeration*tl;
#endif
float tr=decodeElevation(texture2D(u_dem,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}float prevElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem_prev,pos).a;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem_prev,pos));float tr=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem_prev,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}
#ifdef TERRAIN_VERTEX_MORPHING
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}
#else
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
return currentElevation(apos);}
#endif
highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;float depth=unpack_depth(texture2D(u_depth,(coord.xy+1.0)*0.5));return coord.z > depth+0.0005;}float occlusionFade(vec4 frag) {vec3 coord=frag.xyz/frag.w;vec3 df=vec3(5.0*u_depth_size_inv,0.0);vec2 uv=0.5*coord.xy+0.5;vec4 depth=vec4(
unpack_depth(texture2D(u_depth,uv-df.xz)),unpack_depth(texture2D(u_depth,uv+df.xz)),unpack_depth(texture2D(u_depth,uv-df.zy)),unpack_depth(texture2D(u_depth,uv+df.zy))
);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z-0.001)-depth),0.0,1.0));}vec4 fourSample(vec2 pos,vec2 off) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
float tl=texture2D(u_dem,pos).a;float tr=texture2D(u_dem,pos+vec2(off.x,0.0)).a;float bl=texture2D(u_dem,pos+vec2(0.0,off.y)).a;float br=texture2D(u_dem,pos+off).a;
#else
vec4 demtl=vec4(texture2D(u_dem,pos).xyz*255.0,-1.0);float tl=dot(demtl,u_dem_unpack);vec4 demtr=vec4(texture2D(u_dem,pos+vec2(off.x,0.0)).xyz*255.0,-1.0);float tr=dot(demtr,u_dem_unpack);vec4 dembl=vec4(texture2D(u_dem,pos+vec2(0.0,off.y)).xyz*255.0,-1.0);float bl=dot(dembl,u_dem_unpack);vec4 dembr=vec4(texture2D(u_dem,pos+off).xyz*255.0,-1.0);float br=dot(dembr,u_dem_unpack);
#endif
return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}
#else
float elevation(vec2 pos) { return 0.0; }bool isOccluded(vec4 frag) { return false; }float occlusionFade(vec4 frag) { return 1.0; }
#endif`,hP=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;varying vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}
#endif`,dP=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump float u_fog_temporal_offset;varying vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,opacity);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec3 fog_dither(vec3 color) {
#ifdef FOG_DITHERING
vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);
#else
return color;
#endif
}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}
#endif`,fP=`
#ifdef LIGHTING_3D_MODE
uniform mediump vec3 u_lighting_ambient_color;uniform mediump vec3 u_lighting_directional_dir;uniform mediump vec3 u_lighting_directional_color;uniform mediump vec3 u_ground_radiance;float calculate_ambient_directional_factor(vec3 normal) {float NdotL=dot(normal,u_lighting_directional_dir);const float factor_reduction_max=0.3;float dir_luminance=dot(u_lighting_directional_color,vec3(0.2126,0.7152,0.0722));float directional_factor_min=1.0-factor_reduction_max*min(dir_luminance,1.0);float ambient_directional_factor=mix(directional_factor_min,1.0,min((NdotL+1.0),1.0));const float vertical_factor_min=0.92;float vertical_factor=mix(vertical_factor_min,1.0,asin(clamp(normal.z,-1.0,1.0))/PI+0.5);return vertical_factor*ambient_directional_factor;}vec3 apply_lighting(vec3 color,vec3 normal,float dir_factor) {float ambient_directional_factor=calculate_ambient_directional_factor(normal);vec3 ambient_contrib=ambient_directional_factor*u_lighting_ambient_color;vec3 directional_contrib=u_lighting_directional_color*dir_factor;return linearProduct(color,ambient_contrib+directional_contrib);}vec4 apply_lighting(vec4 color,vec3 normal,float dir_factor) {return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting(vec3 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return apply_lighting(color.rgb,normal,dir_factor);}vec4 apply_lighting(vec4 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting_ground(vec3 color) {return color*u_ground_radiance;}vec4 apply_lighting_ground(vec4 color) {return vec4(apply_lighting_ground(color.rgb),color.a);}float calculate_NdotL(vec3 normal) {const float ext=0.70710678118;return (clamp(dot(normal,u_lighting_directional_dir),-ext,1.0)+ext)/(1.0+ext);}vec4 apply_lighting_with_emission_ground(vec4 color,float emissive_strength) {return mix(apply_lighting_ground(color),color,emissive_strength);}vec3 compute_flood_lighting(vec3 flood_light_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=flood_light_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);float occlusion_ramp=smoothstep(0.0,0.2,1.0-occlusion);return mix(fully_occluded_color,flood_light_color,occlusion_ramp);}vec3 compute_emissive_draped(vec3 unlit_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=unlit_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);return mix(fully_occluded_color,unlit_color,1.0-occlusion);}
#endif//LIGHTING_3D_MODE`,pP=`#ifdef RENDER_SHADOWS
uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_normal_offset;vec3 shadow_normal_offset(vec3 normal) {float tileInMeters=u_shadow_normal_offset[0];vec3 n=vec3(-normal.xy,tileInMeters*normal.z);float dotScale=min(1.0-dot(normal,u_shadow_direction),1.0)*0.5+0.5;return n*dotScale;}vec3 shadow_normal_offset_model(vec3 normal) {float dotScale=min(1.0-dot(normal,u_shadow_direction),1.0)*0.5+0.5;return normal*dotScale;}float shadow_normal_offset_multiplier0() {return u_shadow_normal_offset[1];}float shadow_normal_offset_multiplier1() {return u_shadow_normal_offset[2];}
#endif//RENDER_SHADOWS`,mP=`#ifdef RENDER_SHADOWS
#if defined(NATIVE) && __VERSION__ >=300
#define TEXTURE_GATHER
#endif
#ifdef DEPTH_TEXTURE
uniform highp sampler2D u_shadowmap_0;uniform highp sampler2D u_shadowmap_1;
#else
uniform sampler2D u_shadowmap_0;uniform sampler2D u_shadowmap_1;
#endif
uniform float u_shadow_intensity;uniform float u_texel_size;uniform highp vec3 u_shadow_normal_offset;uniform vec2 u_fade_range;uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_bias;highp float shadow_sample_1(highp vec2 uv,highp float compare) {highp float shadow_depth;
#ifdef DEPTH_TEXTURE
shadow_depth=texture2D(u_shadowmap_1,uv).r;
#else
shadow_depth=unpack_depth(texture2D(u_shadowmap_1,uv))*0.5+0.5;
#endif
return step(shadow_depth,compare);}highp float shadow_sample_0(highp vec2 uv,highp float compare) {highp float shadow_depth;
#ifdef DEPTH_TEXTURE
shadow_depth=texture2D(u_shadowmap_0,uv).r;
#else
shadow_depth=unpack_depth(texture2D(u_shadowmap_0,uv))*0.5+0.5;
#endif
return step(shadow_depth,compare);}highp float shadow_occlusion_1(highp vec4 pos,highp float bias) {highp float compare1=pos.z-bias;highp vec2 texel=pos.xy/u_texel_size-vec2(0.5);highp vec2 f=fract(texel);highp float s=u_texel_size;
#ifdef TEXTURE_GATHER
vec2 uv00=(texel-f+0.5)*s;highp vec4 d00=textureGather(u_shadowmap_1,uv00,0);highp vec4 c00=step(d00,vec4(compare1));highp float o00=c00.a;highp float o10=c00.b;highp float o01=c00.r;highp float o11=c00.g;
#else
highp vec2 uv00=(texel-f+0.5)*s;highp vec2 uv10=uv00+vec2(1.0*s,0.0);highp vec2 uv01=uv00+vec2(0.0,1.0*s);highp vec2 uv11=uv01+vec2(1.0*s,0.0);highp float o00=shadow_sample_1(uv00,compare1);highp float o10=shadow_sample_1(uv10,compare1);highp float o01=shadow_sample_1(uv01,compare1);highp float o11=shadow_sample_1(uv11,compare1);
#endif
highp float value=
(1.0-f.x)*(1.0-f.y)*o00+f.x*(1.0-f.y)*o10+(1.0-f.x)*f.y*o01+f.x*f.y*o11;return clamp(value,0.0,1.0);}highp float shadow_occlusion_0(highp vec4 pos,highp float bias) {highp float compare0=pos.z-bias;highp vec2 texel=pos.xy/u_texel_size-vec2(1.5);highp vec2 f=fract(texel);highp float s=u_texel_size;
#ifdef TEXTURE_GATHER
highp vec2 uv00=(texel-f+0.5)*s;highp vec2 uv10=uv00+vec2(2.0*s,0);highp vec2 uv01=uv00+vec2(0,2.0*s);highp vec2 uv11=uv10+vec2(0,2.0*s);highp vec4 d00=textureGather(u_shadowmap_0,uv00);highp vec4 d10=textureGather(u_shadowmap_0,uv10);highp vec4 d01=textureGather(u_shadowmap_0,uv01);highp vec4 d11=textureGather(u_shadowmap_0,uv11);highp vec4 c00=step(d00,vec4(compare0));highp vec4 c01=step(d01,vec4(compare0));highp vec4 c10=step(d10,vec4(compare0));highp vec4 c11=step(d11,vec4(compare0));highp float o00=c00.a;highp float o10=c00.b;highp float o20=c10.a;highp float o30=c10.b;highp float o01=c00.r;highp float o11=c00.g;highp float o21=c10.r;highp float o31=c10.g;highp float o02=c01.a;highp float o12=c01.b;highp float o22=c11.a;highp float o32=c11.b;highp float o03=c01.r;highp float o13=c01.g;highp float o23=c11.r;highp float o33=c11.g;
#else
highp vec2 uv00=(texel-f+0.5)*s;highp vec2 uv10=uv00+vec2(1.0*s,0);highp vec2 uv20=uv00+vec2(2.0*s,0);highp vec2 uv30=uv00+vec2(3.0*s,0);highp vec2 uv01=uv00+vec2(0.0,1.0*s);highp vec2 uv11=uv01+vec2(1.0*s,0);highp vec2 uv21=uv01+vec2(2.0*s,0);highp vec2 uv31=uv01+vec2(3.0*s,0);highp vec2 uv02=uv01+vec2(0.0,1.0*s);highp vec2 uv12=uv02+vec2(1.0*s,0);highp vec2 uv22=uv02+vec2(2.0*s,0);highp vec2 uv32=uv02+vec2(3.0*s,0);highp vec2 uv03=uv02+vec2(0.0,1.0*s);highp vec2 uv13=uv03+vec2(1.0*s,0);highp vec2 uv23=uv03+vec2(2.0*s,0);highp vec2 uv33=uv03+vec2(3.0*s,0);highp float o00=shadow_sample_0(uv00,compare0);highp float o10=shadow_sample_0(uv10,compare0);highp float o20=shadow_sample_0(uv20,compare0);highp float o30=shadow_sample_0(uv30,compare0);highp float o01=shadow_sample_0(uv01,compare0);highp float o11=shadow_sample_0(uv11,compare0);highp float o21=shadow_sample_0(uv21,compare0);highp float o31=shadow_sample_0(uv31,compare0);highp float o02=shadow_sample_0(uv02,compare0);highp float o12=shadow_sample_0(uv12,compare0);highp float o22=shadow_sample_0(uv22,compare0);highp float o32=shadow_sample_0(uv32,compare0);highp float o03=shadow_sample_0(uv03,compare0);highp float o13=shadow_sample_0(uv13,compare0);highp float o23=shadow_sample_0(uv23,compare0);highp float o33=shadow_sample_0(uv33,compare0);
#endif
highp float value=
(1.0-f.x)*(1.0-f.y)*o00+(1.0-f.y)*(o10+o20)+f.x*(1.0-f.y)*o30+(1.0-f.x)*(o01+o02)+f.x*(o31+o32)+(1.0-f.x)*f.y*o03+f.y*(o13+o23)+f.x*f.y*o33+o11+o21+o12+o22;return clamp(value/9.0,0.0,1.0);}float shadow_occlusion(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth,highp float bias) {light_view_pos0.xyz/=light_view_pos0.w;light_view_pos1.xyz/=light_view_pos1.w;vec4 uv=vec4(light_view_pos0.xy,light_view_pos1.xy);vec4 abs_bounds=abs(uv);if (abs_bounds.x < 1.0 && abs_bounds.y < 1.0) {light_view_pos0.xyz=light_view_pos0.xyz*0.5+0.5;return shadow_occlusion_0(light_view_pos0,bias);}if (abs_bounds.z >=1.0 || abs_bounds.w >=1.0) {return 0.0;}light_view_pos1.xyz=light_view_pos1.xyz*0.5+0.5;float occlusion1=shadow_occlusion_1(light_view_pos1,bias);return mix(occlusion1,0.0,smoothstep(u_fade_range.x,u_fade_range.y,view_depth));}highp float calculate_shadow_bias(float NDotL) {
#ifdef NORMAL_OFFSET
return 0.5*u_shadow_bias.x;
#else
return 0.5*(u_shadow_bias.x+clamp(u_shadow_bias.y*tan(acos(NDotL)),0.0,u_shadow_bias.z));
#endif
}float shadowed_light_factor_normal(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {highp float NDotL=dot(N,u_shadow_direction);if (NDotL < 0.0)
return 0.0;highp float bias=calculate_shadow_bias(NDotL);float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return (1.0-(u_shadow_intensity*occlusion))*NDotL;}float shadowed_light_factor_normal_unbiased(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {highp float NDotL=dot(N,u_shadow_direction);if (NDotL < 0.0)
return 0.0;float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return (1.0-(u_shadow_intensity*occlusion))*NDotL;}float shadowed_light_factor(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return 1.0-(u_shadow_intensity*occlusion);}float shadow_occlusion(float ndotl,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=calculate_shadow_bias(ndotl);return shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);}
#endif`;let gP={},gE={},yE={};const Ah=[];ac(lP,Ah),ac(fP,Ah),ac(cP,Ah),ac(hP,Ah),ac(dP,Ah),ac(pP,Ah),ac(mP,Ah),gP=ir("",cP),gE=ir(dP,hP),yE=ir(mP,pP);const yP=ir(`
#if __VERSION__ >=300
#define varying in
#define gl_FragColor glFragColor
#define texture2D texture
#define textureCube texture
out vec4 glFragColor;
#endif
highp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}
#ifdef INDICATOR_CUTOUT
uniform vec2 u_indicator_cutout_centers;uniform vec4 u_indicator_cutout_params;
#endif
vec4 applyCutout(vec4 color) {
#ifdef INDICATOR_CUTOUT
float holeMinOpacity=u_indicator_cutout_params.x;float holeRadius=max(u_indicator_cutout_params.y,0.0);float holeAspectRatio=u_indicator_cutout_params.z;float fadeStart=u_indicator_cutout_params.w;float distA=distance(vec2(gl_FragCoord.x,gl_FragCoord.y*holeAspectRatio),vec2(u_indicator_cutout_centers[0],u_indicator_cutout_centers[1]*holeAspectRatio));return color*min(smoothstep(fadeStart,holeRadius,distA)+holeMinOpacity,1.0);
#else
return color;
#endif
}`,`
#if __VERSION__ >=300
#define attribute in
#define varying out
#define texture2D texture
#endif
float wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {
#ifndef PROJECTED_POS_ON_VIEWPORT
float tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;
#else
return vec3(0.0);
#endif
}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(
unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);//Normalized device coordinate that is not rendered.`),_P=lP,vP=fP,_E=`
#ifdef GL_ES
precision mediump float;
#else

#if !defined(lowp)
#define lowp
#endif

#if !defined(mediump)
#define mediump
#endif

#if !defined(highp)
#define highp
#endif

#endif`;var xP={background:ir(`uniform vec4 u_color;uniform float u_opacity;
#ifdef LIGHTING_3D_MODE
varying vec4 v_color;
#endif
void main() {vec4 out_color;
#ifdef LIGHTING_3D_MODE
out_color=v_color;
#else
out_color=u_color;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#ifdef LIGHTING_3D_MODE
uniform mediump vec4 u_color;varying vec4 v_color;uniform float u_emissive_strength;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting_with_emission_ground(u_color,u_emissive_strength);
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),backgroundPattern:ir(`uniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform float u_emissive_strength;uniform sampler2D u_image;varying vec2 v_pos;void main() {vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`uniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),circle:ir(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
uniform float u_emissive_strength;void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(
antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)
);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_apply_premultiplied(out_color,v_fog_pos);
#endif
gl_FragColor=out_color*(v_visibility*opacity_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`#define NUM_VISIBILITY_RINGS 2
#define INV_SQRT2 0.70710678
#define ELEVATION_BIAS 0.0001
#define NUM_SAMPLES_PER_RING 16
uniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
vec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {
#if defined(TERRAIN)
return elevation(pos)+ELEVATION_BIAS;
#else
return 0.0;
#endif
}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);
#ifdef PITCH_WITH_MAP
#ifdef PROJECTION_GLOBE_VIEW
return u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );
#else
return u_matrix*( world_center+vec4(sample_offset,0,0) );
#endif
#else
return projected_center+vec4(sample_offset,0,0);
#endif
}float get_sample_step() {
#ifdef PITCH_WITH_MAP
return 2.0*PI/float(NUM_SAMPLES_PER_RING);
#else
return PI/float(NUM_SAMPLES_PER_RING);
#endif
}void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);
#else 
surface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);
#endif
vec4 projected_center=u_matrix*world_center;float view_scale=0.0;
#ifdef PITCH_WITH_MAP
#ifdef SCALE_WITH_MAP
view_scale=1.0;
#else
view_scale=projected_center.w/u_camera_to_center_distance;
#endif
#else
#ifdef SCALE_WITH_MAP
view_scale=u_camera_to_center_distance;
#else
view_scale=projected_center.w;
#endif
#endif
gl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;
#ifdef TERRAIN
float step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;
#ifdef PITCH_WITH_MAP
float cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;
#else
occlusion_world_center=world_center;occlusion_projected_center=projected_center;
#endif
for(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);
#else
visibility=1.0;
#endif
#ifdef PROJECTION_GLOBE_VIEW
visibility=1.0;
#endif
v_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);
#ifdef FOG
v_fog_pos=fog_position(world_center.xyz);
#endif
}`),clippingMask:ir("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:ir(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef FOG
if (u_is_globe==0) {gl_FragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#else
pos=vec3(tilePos+extrude,elevation(tilePos));
#endif
gl_Position=u_matrix*vec4(pos,1);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),heatmapTexture:ir(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,"attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:ir("varying float v_placed;varying float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);gl_FragColor =mix(red,blue,step(0.5,v_placed))*0.5;gl_FragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}",`attribute vec3 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;attribute float a_size_scale;attribute vec2 a_padding;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*elevation(a_anchor_pos),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}`),collisionCircle:ir("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}",`attribute vec2 a_pos_2f;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(
mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}`),debug:ir("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}",`attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;
#endif
varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
gl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);
#else
gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);
#endif
}`),fill:ir(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
uniform float u_emissive_strength;void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
vec4 out_color=color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutline:ir(`varying vec2 v_pos;uniform float u_emissive_strength;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutlinePattern:ir(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_emissive_strength;varying vec2 v_pos;varying vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;varying vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillPattern:ir(`uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;uniform float u_emissive_strength;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillExtrusion:ir(`varying vec4 v_color;
#ifdef RENDER_SHADOWS
varying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;
#endif
uniform lowp float u_opacity;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec2 v_ao;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
varying vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
varying highp vec3 v_normal;
#endif
uniform vec3 u_flood_light_color;uniform highp float u_vertical_scale;uniform float u_flood_light_intensity;uniform vec3 u_ground_shadow_factor;
#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)
varying float v_flood_radius;varying float v_has_floodlight;
#endif
varying float v_height;void main() {
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
vec3 normal=normalize(v_normal);
#endif
float z;vec4 color=v_color;
#ifdef ZERO_ROOF_RADIUS
z=float(normal.z > 0.00001);
#ifdef LIGHTING_3D_MODE
normal=mix(normal,vec3(0.0,0.0,1.0),z);
#else
color=mix(v_color,v_roof_color,z);
#endif
#endif
float h=max(0.0,v_height);float ao_shade=1.0;
#ifdef FAUX_AO
float intensity=u_ao[0];float h_floors=h/(u_ao[1]*u_vertical_scale);float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);ao_shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;
#ifdef ZERO_ROOF_RADIUS
concave*=(1.0-z);
#endif
float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);ao_shade*=mix(1.0,x_shade*x_shade*x_shade,concave);
#ifdef LIGHTING_3D_MODE
#ifdef FLOOD_LIGHT
color.rgb*=mix(ao_shade,1.0,v_has_floodlight);
#else
color.rgb*=ao_shade;
#endif
#else
color.rgb*=ao_shade;
#endif
#endif
#ifdef LIGHTING_3D_MODE
float flood_radiance=0.0;
#ifdef FLOOD_LIGHT
flood_radiance=(1.0-min(h/v_flood_radius,1.0))*u_flood_light_intensity*v_has_floodlight;
#endif
#ifdef RENDER_SHADOWS
#ifdef FLOOD_LIGHT
float ndotl_unclamped=dot(normal,u_shadow_direction);float ndotl=max(0.0,ndotl_unclamped);float occlusion=ndotl_unclamped < 0.0 ? 1.0 : shadow_occlusion(ndotl,v_pos_light_view_0,v_pos_light_view_1,v_depth);vec3 litColor=apply_lighting(color.rgb,normal,(1.0-u_shadow_intensity*occlusion)*ndotl);vec3 floodLitColor=compute_flood_lighting(u_flood_light_color*u_opacity,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=mix(litColor,floodLitColor,flood_radiance);
#else
float shadowed_lighting_factor=shadowed_light_factor_normal(normal,v_pos_light_view_0,v_pos_light_view_1,v_depth);color.rgb=apply_lighting(color.rgb,normal,shadowed_lighting_factor);
#endif
#else
color.rgb=apply_lighting(color.rgb,normal);
#ifdef FLOOD_LIGHT
color.rgb=mix(color.rgb,u_flood_light_color*u_opacity,flood_radiance);
#endif
#endif
color*=u_opacity;
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
#ifdef INDICATOR_CUTOUT
color=applyCutout(color);
#endif
gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
uniform highp float u_vertical_scale;varying vec4 v_color;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
varying vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
varying highp vec3 v_normal;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec2 v_ao;
#endif
#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)
varying float v_flood_radius;varying float v_has_floodlight;
#endif
varying float v_height;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
#pragma mapbox: define highp float flood_light_wall_radius
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize highp float flood_light_wall_radius
base*=u_vertical_scale;height*=u_vertical_scale;vec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
v_normal=normal;
#endif
base=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=0.0;float c_ele;vec3 pos;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);pos=vec3(pos_nx.xy,h);
#else
h=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);h=h-ele;v_height=h;
#ifdef RENDER_SHADOWS
vec3 shd_pos0=pos;vec3 shd_pos1=pos;
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(normal);shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
float NdotL=0.0;float colorvalue=0.0;
#ifndef LIGHTING_3D_MODE
colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);if (normal.y !=0.0) {float r=0.84;r=mix(0.7,0.98,1.0-u_lightintensity);NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#endif
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec2(mix(concave,-concave,start),y_ground);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
#ifdef FLOOD_LIGHT
float is_wall=1.0-float(t > 0.0 && top_up_ny.y > 0.0);v_has_floodlight=float(flood_light_wall_radius > 0.0 && is_wall > 0.0);v_flood_radius=flood_light_wall_radius*u_vertical_scale;
#endif
v_color=color;
#else
v_color=vec4(0.0,0.0,0.0,1.0);v_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_color*=u_opacity;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
float roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color=vec4(0.0,0.0,0.0,1.0);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_roof_color*=u_opacity;
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),fillExtrusionDepth:ir(`varying highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
gl_FragColor=pack_depth(v_depth);
#endif
}`,`uniform mat4 u_matrix;uniform float u_edge_radius;uniform float u_vertical_scale;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
varying highp float v_depth;void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
base*=u_vertical_scale;height*=u_vertical_scale;vec3 pos_nx=floor(a_pos_normal_ed.xyz*0.5);mediump vec3 top_up_ny=a_pos_normal_ed.xyz-2.0*pos_nx;base=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
vec3 pos;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;float ele=elevation(pos_nx.xy);float c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;float h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base);pos=vec3(pos_nx.xy,h);
#else
pos=vec3(pos_nx.xy,t > 0.0 ? height : base);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);v_depth=gl_Position.z/gl_Position.w;}`),fillExtrusionPattern:ir(`uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
varying vec3 v_normal;
#endif
varying vec2 v_pos;varying vec4 v_lighting;uniform lowp float u_opacity;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color,normalize(v_normal))*u_opacity;
#else
out_color=out_color*v_lighting;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color);
#endif
gl_FragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
varying vec2 v_pos;varying vec4 v_lighting;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
varying vec3 v_normal;
#endif
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=z;vec3 p;float c_ele;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);p=vec3(pos_nx.xy,h);
#else
p=vec3(pos_nx.xy,z);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0
? pos_nx.xy
: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_normal=normal;
#else
v_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;
#endif 
#ifdef FOG
v_fog_pos=fog_position(p);
#endif
}`),groundShadow:ir(`#ifdef GL_ES
precision highp float;
#endif
uniform vec3 u_ground_shadow_factor;varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;
#ifdef FOG
varying float v_fog_opacity;
#endif
void main() {float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);vec3 shadow=mix(u_ground_shadow_factor,vec3(1.0),light);
#ifdef FOG
shadow=mix(shadow,vec3(1.0),v_fog_opacity);
#endif
#ifdef INDICATOR_CUTOUT
shadow=mix(shadow,vec3(1.0),1.0-applyCutout(vec4(1.0)).r);
#endif
gl_FragColor=vec4(shadow,1.0);}`,`uniform mat4 u_matrix;uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;attribute vec2 a_pos;varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;
#ifdef FOG
varying float v_fog_opacity;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0.0,1.0);v_pos_light_view_0=u_light_matrix_0*vec4(a_pos,0.0,1.0);v_pos_light_view_1=u_light_matrix_1*vec4(a_pos,0.0,1.0);v_depth=gl_Position.w;
#ifdef FOG
v_fog_opacity=fog(fog_position(a_pos));
#endif
}`),fillExtrusionGroundEffect:ir(`uniform highp float u_ao_pass;uniform highp float u_opacity;uniform highp float u_flood_light_intensity;uniform highp vec3 u_flood_light_color;uniform highp float u_attenuation;uniform sampler2D u_fb;
#ifdef SDF_SUBPASS
varying highp vec2 v_pos;varying highp vec4 v_line_segment;varying highp float v_flood_light_radius_tile;varying highp vec2 v_ao;float line_df(highp vec2 a,highp vec2 b,highp vec2 p) {highp vec2 ba=b-a;highp vec2 pa=p-a;highp float r=clamp(dot(pa,ba)/dot(ba,ba),0.0,1.0);return length(pa-r*ba);}
#ifdef FOG
varying highp float v_fog;
#endif
#endif
void main() {
#ifdef CLEAR_SUBPASS
vec4 color=vec4(1.0);
#ifdef CLEAR_FROM_TEXTURE
color=texelFetch(u_fb,ivec2(gl_FragCoord.xy),0);
#endif
gl_FragColor=color;
#else
#ifdef SDF_SUBPASS
highp float d=line_df(v_line_segment.xy,v_line_segment.zw,v_pos);highp float effect_radius=mix(v_flood_light_radius_tile,v_ao.y,u_ao_pass);d/=effect_radius;d=min(d,1.0);d=1.0-pow(1.0-d,u_attenuation);highp float effect_intensity=mix(u_flood_light_intensity,v_ao.x,u_ao_pass);highp float fog=1.0;
#ifdef FOG
fog=v_fog;
#endif
gl_FragColor=vec4(vec3(0.0),mix(1.0,d,effect_intensity*u_opacity*fog));
#else
vec4 color=mix(vec4(u_flood_light_color,1.0),vec4(vec3(0.0),1.0),u_ao_pass);
#ifdef OVERDRAW_INSPECTOR
color=vec4(1.0);
#endif
gl_FragColor=color;HANDLE_WIREFRAME_DEBUG;
#endif
#endif
}`,`attribute highp vec4 a_pos_end;attribute highp float a_hidden_by_landmark;
#ifdef SDF_SUBPASS
varying highp vec2 v_pos;varying highp vec4 v_line_segment;varying highp float v_flood_light_radius_tile;varying highp vec2 v_ao;
#ifdef FOG
varying highp float v_fog;
#endif
#endif
uniform highp float u_flood_light_intensity;uniform highp mat4 u_matrix;uniform highp float u_ao_pass;uniform highp float u_meter_to_tile;uniform highp vec2 u_ao;
#pragma mapbox: define highp float flood_light_ground_radius
#pragma mapbox: define highp float base
void main() {
#pragma mapbox: initialize highp float flood_light_ground_radius
#pragma mapbox: initialize highp float base
vec2 p=a_pos_end.xy;vec2 q=floor(a_pos_end.zw*0.5);vec2 start_bottom=a_pos_end.zw-q*2.0;float flood_radius_tile=flood_light_ground_radius*u_meter_to_tile;vec2 v=normalize(q-p);float ao_radius=u_ao.y/3.5;float effect_radius=mix(flood_radius_tile,ao_radius,u_ao_pass);vec2 offset_along_edge=v*effect_radius*(0.5-start_bottom.x)*2.0;vec2 extrusion=vec2(-v.y,v.x)*effect_radius*(start_bottom.y-1.0);vec3 pos=vec3(mix(q,p,start_bottom.x),0.0);pos.xy+=offset_along_edge+extrusion;
#ifdef SDF_SUBPASS
v_pos=pos.xy;v_line_segment=vec4(p,q);v_flood_light_radius_tile=flood_radius_tile;v_ao=vec2(u_ao.x,ao_radius);
#ifdef FOG
v_fog=1.0-fog(fog_position(pos));
#endif
#endif
float hidden_by_landmark=0.0;
#ifdef HAS_CENTROID
hidden_by_landmark=a_hidden_by_landmark;
#endif
float isFloodlit=float(flood_light_ground_radius > 0.0 && u_flood_light_intensity > 0.0);float hidden=mix(1.0-isFloodlit,isFloodlit,u_ao_pass);hidden+=float(base > 0.0);hidden+=hidden_by_landmark;gl_Position=mix(u_matrix*vec4(pos,1.0),AWAY,float(hidden > 0.0));}`),hillshadePrepare:ir(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
return texture2D(u_image,coord).a/4.0;
#else
vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;
#endif
}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(
(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)
)/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(
deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:ir(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef LIGHTING_3D_MODE
gl_FragColor=apply_lighting_ground(gl_FragColor);
#endif
#ifdef FOG
gl_FragColor=fog_dither(fog_apply_premultiplied(gl_FragColor,v_fog_pos));
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),line:ir(`uniform lowp float u_device_pixel_ratio;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform sampler2D u_dash_image;varying vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform sampler2D u_gradient_image;
#endif
float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}uniform float u_emissive_strength;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float border_width
#pragma mapbox: define lowp vec4 border_color
float linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float border_width
#pragma mapbox: initialize lowp vec4 border_color
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);
#ifdef RENDER_LINE_DASH
float sdfdist=texture2D(u_dash_image,v_tex).a;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;alpha*=linearstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);
#endif
highp vec4 out_color;
#ifdef RENDER_LINE_GRADIENT
out_color=texture2D(u_gradient_image,v_uv.xy);
#else
out_color=color;
#endif
float trimmed=1.0;
#ifdef RENDER_LINE_TRIM_OFFSET
highp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {if (line_progress <=trim_end && line_progress >=trim_start) {out_color=vec4(0,0,0,0);trimmed=0.0;}}
#endif
#ifdef RENDER_LINE_ALPHA_DISCARD
if (alpha < u_alpha_discard_threshold) {discard;}
#endif
#ifdef RENDER_LINE_BORDER
float edgeBlur=(border_width+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);
#ifdef RENDER_LINE_BORDER_AUTO
float Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}
#else
out_color.rgb=mix(border_color.rgb*border_color.a*trimmed,out_color.rgb,smoothAlpha);
#endif
}
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
out_color*=(alpha*opacity);
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color);
#endif
gl_FragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`
#define EXTRUDE_SCALE 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
attribute highp vec4 a_packed;
#endif
#ifdef RENDER_LINE_DASH
attribute float a_linesofar;
#endif
uniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;varying vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform float u_image_height;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float border_width
#pragma mapbox: define lowp vec4 border_color
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float border_width
#pragma mapbox: initialize lowp vec4 border_color
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
float a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];
#ifdef RENDER_LINE_GRADIENT
highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec4(a_uv_x,a_split_index*texel_height-half_texel_height,a_clip_start,a_clip_end);
#else
v_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);
#endif
#endif
#ifdef RENDER_LINE_DASH
float scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/floorwidth,(-normal.y*height+dash.x+0.5)/u_texsize.y);
#endif
v_width2=vec2(outset,inset);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),linePattern:ir(`uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;vec2 pattern_size=vec2(display_size.x/u_tile_units_to_pixels,display_size.y);float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x=mod(v_linesofar/pattern_size.x*aspect,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));vec4 color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
color=apply_lighting_ground(color);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
color*=(alpha*opacity);
#ifdef INDICATOR_CUTOUT
color=applyCutout(color);
#endif
gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_linesofar;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),raster:ir(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;
#ifdef RASTER_COLOR
uniform sampler2D u_color_ramp;uniform highp vec2 u_colorization_scale;uniform highp vec4 u_colorization_mix;highp vec4 colormap (highp float value) {highp float scaled_value=value*u_colorization_scale.y+u_colorization_scale.x;highp vec2 coords=vec2(scaled_value,0.5);return texture2D(u_color_ramp,coords);}
#endif
void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);vec4 color;
#ifdef RASTER_COLOR
highp vec4 fadedColor=mix(color0,color1,u_fade_t);color=colormap(dot(vec4(fadedColor.rgb,1),u_colorization_mix));color.a*=fadedColor.a;if (color.a > 0.0) {color.rgb/=color.a;}
#else
if (color0.a > 0.0) {color0.rgb/=color0.a;}if (color1.a > 0.0) {color1.rgb/=color1.a;}color=mix(color0,color1,u_fade_t);
#endif
color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(
dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_ground(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply(out_color,v_fog_pos));
#endif
gl_FragColor=vec4(out_color*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {float w=1.0+dot(a_texture_pos,u_perspective_transform);gl_Position=u_matrix*vec4(a_pos*w,0,w);v_pos0=a_texture_pos/8192.0;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),symbolIcon:ir(`uniform sampler2D u_texture;
#ifdef ICON_TRANSITION
uniform float u_icon_transition;
#endif
varying float v_fade_opacity;varying vec2 v_tex_a;
#ifdef ICON_TRANSITION
varying vec2 v_tex_b;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float emissive_strength
lowp float alpha=opacity*v_fade_opacity;vec4 out_color;
#ifdef ICON_TRANSITION
vec4 a=texture2D(u_texture,v_tex_a)*(1.0-u_icon_transition);vec4 b=texture2D(u_texture,v_tex_b)*u_icon_transition;out_color=(a+b)*alpha;
#else
out_color=texture2D(u_texture,v_tex_a)*alpha;
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,emissive_strength);
#endif
gl_FragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
#ifdef ICON_TRANSITION
attribute vec2 a_texb;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform vec3 u_up_vector;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec2 v_tex_a;
#ifdef ICON_TRANSITION
varying vec2 v_tex_b;
#endif
varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float emissive_strength
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjected_point;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetProjected_point=u_matrix*vec4(a_globe_anchor+displacement,1);
#else
offsetProjected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);
#endif
vec2 a=projected_point.xy/projected_point.w;vec2 b=offsetProjected_point.xy/offsetProjected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float out_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change))*projection_transition_fade;float alpha=opacity*out_fade_opacity;float hidden=float(alpha==0.0 || projected_point.w <=0.0 || occlusion_fade==0.0);
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,hidden);
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,hidden);
#endif
v_tex_a=a_tex/u_texsize;
#ifdef ICON_TRANSITION
v_tex_b=a_texb/u_texsize;
#endif
v_fade_opacity=out_fade_opacity;}`),symbolSDF:ir(`#define SDF_PX 8.0
uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;uniform bool u_is_halo;
#if __VERSION__ >=300
flat varying float v_draw_halo;
#endif
varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;bool draw_halo;
#if __VERSION__ >=300
draw_halo=v_draw_halo > 0.0;
#else
draw_halo=u_is_halo;
#endif
if (draw_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);vec4 out_color=color*(alpha*opacity*fade_opacity);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,emissive_strength);
#endif
gl_FragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform bool u_is_halo;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
#if __VERSION__ >=300
flat varying float v_draw_halo;
#endif
varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);
#else
offsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);
#endif
vec2 a=projected_point.xy/projected_point.w;vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float out_fade_opacity=interpolated_fade_opacity*projection_transition_fade;float alpha=opacity*out_fade_opacity;float hidden=float(alpha==0.0 || projected_point.w <=0.0 || occlusion_fade==0.0);
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,hidden);
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,hidden);
#endif
float gamma_scale=gl_Position.w;
#if __VERSION__ >=300
v_draw_halo=(u_is_halo && float(gl_InstanceID)==0.0) ? 1.0 : 0.0;
#endif
v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,out_fade_opacity);}`),symbolTextAndIcon:ir(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_halo;
#if __VERSION__ >=300
flat varying float v_draw_halo;
#endif
varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;bool draw_halo;
#if __VERSION__ >=300
draw_halo=v_draw_halo > 0.0;
#else
draw_halo=u_is_halo;
#endif
if (draw_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);vec4 out_color=color*(alpha*opacity*fade_opacity);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,emissive_strength);
#endif
gl_FragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;uniform bool u_is_halo;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
#if __VERSION__ >=300
flat varying float v_draw_halo;
#endif
varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offset_projected_point=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projected_point.xy/projected_point.w;vec2 b=offset_projected_point.xy/offset_projected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*font_scale);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
float out_fade_opacity=interpolated_fade_opacity*projection_transition_fade;float alpha=opacity*out_fade_opacity;float hidden=float(alpha==0.0 || projected_point.w <=0.0 || occlusion_fade==0.0);
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,hidden);
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,hidden);
#endif
float gamma_scale=gl_Position.w;
#if __VERSION__ >=300
v_draw_halo=(u_is_halo && float(gl_InstanceID)==0.0) ? 1.0 : 0.0;
#endif
v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,out_fade_opacity,is_sdf);}`),terrainRaster:ir(`uniform sampler2D u_image0;varying vec2 v_pos0;
#ifdef FOG
varying float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;
#endif
uniform vec3 u_ground_shadow_factor;void main() {vec4 image_color=texture2D(u_image0,v_pos0);vec4 color;
#ifdef LIGHTING_3D_MODE
const vec3 normal=vec3(0.0,0.0,1.0);
#ifdef RENDER_SHADOWS
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
vec3 unlit_base=image_color.rgb*(1.0-image_color.a);vec3 emissive_base=image_color.rgb*image_color.a;float ndotl=u_shadow_direction.z;float occlusion=ndotl < 0.0 ? 1.0 : shadow_occlusion(v_pos_light_view_0,v_pos_light_view_1,v_depth,0.0);ndotl=max(0.0,ndotl);vec3 lit=apply_lighting(unlit_base,normal,(1.0-(u_shadow_intensity*occlusion))*ndotl);vec3 emissive=compute_emissive_draped(emissive_base,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=lit+emissive;color.a=1.0;
#else
float lighting_factor=shadowed_light_factor_normal_unbiased(normal,v_pos_light_view_0,v_pos_light_view_1,v_depth);color=apply_lighting(image_color,normal,lighting_factor);
#endif
#else
float lighting_factor=calculate_NdotL(normal);color=apply_lighting(image_color,normal,lighting_factor);
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
color.rgb=mix(color.rgb,image_color.rgb,image_color.a);color.a=1.0;
#endif
#endif
#else
color=image_color;
#endif
#ifdef FOG
#ifdef ZERO_EXAGGERATION
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#else
color=fog_dither(fog_apply_from_vert(color,v_fog_opacity));
#endif
#endif
gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`uniform mat4 u_matrix;uniform float u_skirt_height;attribute vec2 a_pos;varying vec2 v_pos0;
#ifdef FOG
varying float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;
#endif
void main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;v_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);
#ifdef FOG
#ifdef ZERO_EXAGGERATION
v_fog_pos=fog_position(decodedPos);
#else
v_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));
#endif
#endif
#ifdef RENDER_SHADOWS
vec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);v_depth=gl_Position.w;
#endif
}`),terrainDepth:ir(`#ifdef GL_ES
precision highp float;
#endif
varying float v_depth;void main() {gl_FragColor=pack_depth(v_depth);}`,"uniform mat4 u_matrix;attribute vec2 a_pos;varying float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}"),skybox:ir(`
varying lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(
cos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=textureCube(u_cubemap,uv).rgb;
#ifdef FOG
sky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);
#endif
sky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);gl_FragColor=vec4(sky_color*u_opacity,u_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,uP),skyboxGradient:ir(`varying highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture2D(u_color_ramp,vec2(progress,0.5));
#ifdef FOG
color.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;
#endif
color*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,uP),skyboxCapture:ir(`
varying highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;
#ifdef GL_ES
precision highp float;
#endif
#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)
#define BETA_M                  vec3(21e-6,21e-6,21e-6)
#define MIE_G                   0.76
#define DENSITY_HEIGHT_SCALE_R  8000.0
#define DENSITY_HEIGHT_SCALE_M  1200.0
#define PLANET_RADIUS           6360e3
#define ATMOSPHERE_RADIUS       6420e3
#define SAMPLE_STEPS            10
#define DENSITY_STEPS           4
float ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;gl_FragColor=vec4(color,1.0);}`,"attribute highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;varying highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:ir(`uniform sampler2D u_image0;varying vec2 v_pos0;
#ifndef FOG
uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;
#endif
void main() {vec4 color;
#ifdef CUSTOM_ANTIALIASING
vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);vec3 dir=normalize(ray_dir);vec3 closest_point=dot(u_globe_pos,dir)*dir;float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture2D(u_image0,v_pos0);
#ifdef LIGHTING_3D_MODE
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
raster=apply_lighting_with_emission_ground(raster,raster.a);color=vec4(raster.rgb*antialias,antialias);
#else
raster=apply_lighting_ground(raster);color=vec4(raster.rgb*antialias,raster.a*antialias);
#endif
#else
color=vec4(raster.rgb*antialias,raster.a*antialias);
#endif
#else
color=texture2D(u_image0,v_pos0);
#ifdef LIGHTING_3D_MODE
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
color=apply_lighting_with_emission_ground(color,color.a);color.a=1.0;
#else
color=apply_lighting_ground(color);
#endif
#endif
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;
#ifdef GLOBE_POLES
attribute vec3 a_globe_pos;attribute vec2 a_uv;
#else
attribute vec2 a_pos;
#endif
varying vec2 v_pos0;float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(QUARTER_PI+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}void main() {
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;vec2 uv=a_uv;
#else
float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);
#endif
v_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;
#ifdef GLOBE_POLES
vec3 up_vector=globe_derived_up_vector;
#else
vec3 up_vector=elevationVector(tile_pos);
#endif
float height=elevation(tile_pos);globe_pos+=up_vector*height;
#ifndef GLOBE_POLES
globe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;
#endif
#ifdef GLOBE_POLES
vec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);
#else
vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);
#endif
gl_Position=u_proj_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
}`),globeAtmosphere:ir(`uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec4 u_color;uniform vec4 u_high_color;uniform vec4 u_space_color;uniform float u_horizon_angle;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;
#ifdef PROJECTION_GLOBE_VIEW
globe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {
#ifdef ALPHA_PASS
gl_FragColor=vec4(0,0,0,0);return;
#else
#ifdef NATIVE
gl_FragColor=vec4(1,1,1,1);
#else
gl_FragColor=vec4(0,0,0,1);
#endif
return;
#endif
}
#endif
highp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?
0.0 : max(acos(dot(dir,horizon_dir)),0.0);float horizon_angle;
#ifdef PROJECTION_GLOBE_VIEW
highp vec3 closest_point=globe_pos_dot_dir*dir;float closest_point_to_center=length(closest_point-u_globe_pos);float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?
PI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);
#else
horizon_angle=horizon_angle_mercator;
#endif
horizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;
#ifdef ALPHA_PASS
float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);gl_FragColor=vec4(1.0,1.0,1.0,a);
#else
vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c=c2;
#ifndef NATIVE
c=dither(c,gl_FragCoord.xy+u_temporal_offset);
#endif
gl_FragColor=vec4(c*t,t);
#endif
}`,`attribute vec3 a_pos;attribute vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(
mix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}`),model:ir(`uniform float u_opacity;uniform vec3 u_lightcolor;uniform vec3 u_lightpos;uniform float u_lightintensity;uniform vec4 u_baseColorFactor;uniform vec4 u_emissiveFactor;uniform float u_metallicFactor;uniform float u_roughnessFactor;varying highp vec3 v_position;varying lowp vec4 v_color_mix;
#ifdef RENDER_SHADOWS
varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth_shadows;
#endif
#pragma mapbox: define-attribute highp vec3 normal_3f
#pragma mapbox: define-attribute highp vec3 color_3f
#pragma mapbox: define-attribute highp vec4 color_4f
#pragma mapbox: define-attribute highp vec2 uv_2f
#pragma mapbox: initialize-attribute highp vec3 normal_3f
#pragma mapbox: initialize-attribute highp vec3 color_3f
#pragma mapbox: initialize-attribute highp vec4 color_4f
#pragma mapbox: initialize-attribute highp vec2 uv_2f
#ifdef HAS_ATTRIBUTE_a_pbr
varying lowp vec4 v_roughness_metallic_emissive_alpha;varying mediump vec4 v_height_based_emission_params;
#endif
#ifdef HAS_TEXTURE_u_baseColorTexture
uniform sampler2D u_baseColorTexture;uniform bool u_baseTextureIsAlpha;uniform bool u_alphaMask;uniform float u_alphaCutoff;
#endif
#ifdef HAS_TEXTURE_u_metallicRoughnessTexture
uniform sampler2D u_metallicRoughnessTexture;
#endif
#ifdef HAS_TEXTURE_u_occlusionTexture
uniform sampler2D u_occlusionTexture;uniform float u_aoIntensity;
#endif
#ifdef HAS_TEXTURE_u_normalTexture
uniform sampler2D u_normalTexture;
#endif
#ifdef HAS_TEXTURE_u_emissionTexture
uniform sampler2D u_emissionTexture;
#endif
#ifdef TERRAIN_FRAGMENT_OCCLUSION
varying highp float v_depth;uniform sampler2D u_depthTexture;uniform vec2 u_inv_depth_size;bool isOccluded() {vec2 coord=gl_FragCoord.xy*u_inv_depth_size;highp float depth=unpack_depth(texture2D(u_depthTexture,coord));return v_depth > depth+0.0005;}
#endif
const float M_PI=3.141592653589793;
#define saturate(_x) clamp(_x,0.,1.)
float calculate_NdotL(vec3 normal,vec3 lightDir) {const float ext=0.70710678118;return (clamp(dot(normal,lightDir),-ext,1.0)+ext)/(1.0+ext);}vec3 getDiffuseShadedColor(vec3 albedo,vec3 normal,vec3 lightDir,vec3 lightColor)
{
#ifdef LIGHTING_3D_MODE
vec3 transformed_normal=vec3(-normal.xy,normal.z);float lighting_factor;
#ifdef RENDER_SHADOWS
lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
lighting_factor=saturate(dot(transformed_normal,u_lighting_directional_dir));
#endif
return apply_lighting(albedo,transformed_normal,lighting_factor);
#else
vec3 n=normal;float colorvalue=((albedo.x*0.2126)+(albedo.y*0.7152))+(albedo.z*0.0722);vec3 c=vec3(0.03,0.03,0.03);float directional=clamp(dot(n,vec3(lightDir)),0.0,1.0);directional=mix(1.0-u_lightintensity,max((1.0-colorvalue)+u_lightintensity,1.0),directional);vec3 c3=c+clamp((albedo*directional)*lightColor,mix(vec3(0.0),vec3(0.3),vec3(1.0)-lightColor),vec3(1.0));return c3;
#endif
}vec4 getBaseColor() {vec4 albedo=u_baseColorFactor;
#ifdef HAS_ATTRIBUTE_a_color_3f
albedo*=vec4(color_3f,1.0);
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
#else
#ifdef HAS_ATTRIBUTE_a_color_4f
albedo*=color_4f;
#endif
#endif
#if defined (HAS_TEXTURE_u_baseColorTexture) && defined (HAS_ATTRIBUTE_a_uv_2f)
vec4 texColor=texture2D(u_baseColorTexture,uv_2f);if(u_alphaMask) {if (texColor.w < u_alphaCutoff) {discard;}}
#ifdef UNPREMULT_TEXTURE_IN_SHADER
if(texColor.w > 0.0) {texColor.rgb/=texColor.w;}texColor.w=1.0;
#endif
texColor.rgb=sRGBToLinear(texColor.rgb);if(u_baseTextureIsAlpha) {if (texColor.w < 0.5) {discard;}albedo*=mix(vec4(texColor.rgb,texColor.a),vec4(texColor.a),float(u_baseTextureIsAlpha));} else {albedo*=texColor;}
#endif
return vec4(mix(albedo.rgb,v_color_mix.rgb,v_color_mix.a),albedo.a);}highp mat3 cotangentFrame(highp vec3 N,highp vec3 p,highp vec2 uv ) {
#ifdef HAS_TEXTURE_u_normalTexture
highp vec3 dp1=vec3(dFdx(p.x),dFdx(p.y),dFdx(p.z));highp vec3 dp2=vec3(dFdy(p.x),dFdy(p.y),dFdy(p.z));highp vec2 duv1=vec2(dFdx(uv.x),dFdx(uv.y));highp vec2 duv2=vec2(dFdy(uv.x),dFdy(uv.y));highp vec3 dp2perp=cross( dp2,N );highp vec3 dp1perp=cross( N,dp1 );highp vec3 T=dp2perp*duv1.x+dp1perp*duv2.x;highp vec3 B=dp2perp*duv1.y+dp1perp*duv2.y;highp float lengthT=dot(T,T);highp float lengthB=dot(B,B);highp float maxLength=max(lengthT,lengthB);highp float invmax=inversesqrt( maxLength );highp mat3 res=mat3( T*invmax,B*invmax,N );return res;
#else
return mat3(1.0);
#endif
}highp vec3 getNormal(){highp vec3 n;
#ifdef HAS_ATTRIBUTE_a_normal_3f
n=normalize(normal_3f);
#else
highp vec3 fdx=vec3(dFdx(v_position.x),dFdx(v_position.y),dFdx(v_position.z));highp vec3 fdy=vec3(dFdy(v_position.x),dFdy(v_position.y),dFdy(v_position.z));n=normalize(cross(fdx,fdy))*-1.0;
#endif
#if defined(HAS_TEXTURE_u_normalTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
vec3 nMap=texture2D( u_normalTexture,uv_2f).xyz;nMap=normalize(2.0*nMap-vec3(1.0));highp vec3 v=normalize(-v_position);highp mat3 TBN=cotangentFrame(n,v,uv_2f);n=normalize(TBN*nMap);
#endif
return n;}struct Material {float perceptualRoughness;float alphaRoughness;float metallic;vec3 f90;vec4 baseColor;vec3 diffuseColor;vec3 specularColor;highp vec3 normal;};Material getPBRMaterial() {Material mat;mat.baseColor=getBaseColor();mat.perceptualRoughness=u_roughnessFactor;mat.metallic=u_metallicFactor;
#ifdef HAS_ATTRIBUTE_a_pbr
mat.perceptualRoughness=v_roughness_metallic_emissive_alpha.x;mat.metallic=v_roughness_metallic_emissive_alpha.y;mat.baseColor.w*=v_roughness_metallic_emissive_alpha.w;
#endif
#if defined(HAS_TEXTURE_u_metallicRoughnessTexture) && defined(HAS_ATTRIBUTE_a_uv_2f) 
vec4 mrSample=texture2D(u_metallicRoughnessTexture,uv_2f);mat.perceptualRoughness*=mrSample.g;mat.metallic*=mrSample.b;
#endif
const float c_minRoughness=0.04;mat.perceptualRoughness=clamp(mat.perceptualRoughness,c_minRoughness,1.0);mat.metallic=saturate(mat.metallic);mat.alphaRoughness=mat.perceptualRoughness*mat.perceptualRoughness;const vec3 f0=vec3(0.04);mat.diffuseColor=mat.baseColor.rgb*(vec3(1.0)-f0);mat.diffuseColor*=1.0-mat.metallic;mat.specularColor=mix(f0,mat.baseColor.rgb,mat.metallic);highp float reflectance=max(max(mat.specularColor.r,mat.specularColor.g),mat.specularColor.b);highp float reflectance90=saturate(reflectance*25.0);mat.f90=vec3(reflectance90);mat.normal=getNormal();return mat;}float V_GGX(float NdotL,float NdotV,float roughness)
{float a2=roughness*roughness;float GGXV=NdotL*sqrt(NdotV*NdotV*(1.0-a2)+a2);float GGXL=NdotV*sqrt(NdotL*NdotL*(1.0-a2)+a2);return 0.5/(GGXV+GGXL);}float V_GGXFast(float NdotL,float NdotV,float roughness) {float a=roughness;float GGXV=NdotL*(NdotV*(1.0-a)+a);float GGXL=NdotV*(NdotL*(1.0-a)+a);return 0.5/(GGXV+GGXL);}vec3 F_Schlick(vec3 specularColor,vec3 f90,float VdotH)
{return specularColor+(f90-specularColor)*pow(clamp(1.0-VdotH,0.0,1.0),5.0);}vec3 F_SchlickFast(vec3 specularColor,float VdotH)
{float x=1.0-VdotH;float x4=x*x*x*x;return specularColor+(1.0-specularColor)*x4*x;}float D_GGX(highp float NdotH,float alphaRoughness)
{highp float a4=alphaRoughness*alphaRoughness;highp float f=(NdotH*a4-NdotH)*NdotH+1.0;return a4/(M_PI*f*f);}vec3 diffuseBurley(Material mat,float LdotH,float NdotL,float NdotV)
{float f90=2.0*LdotH*LdotH*mat.alphaRoughness-0.5;return (mat.diffuseColor/M_PI)*(1.0+f90*pow((1.0-NdotL),5.0))*(1.0+f90*pow((1.0-NdotV),5.0));}vec3 diffuseLambertian(Material mat)
{
#ifdef LIGHTING_3D_MODE
return mat.diffuseColor;
#else
return mat.diffuseColor/M_PI;
#endif
}vec3 EnvBRDFApprox(vec3 specularColor,float roughness,highp float NdotV)
{vec4 c0=vec4(-1,-0.0275,-0.572,0.022);vec4 c1=vec4(1,0.0425,1.04,-0.04);highp vec4 r=roughness*c0+c1;highp float a004=min(r.x*r.x,exp2(-9.28*NdotV))*r.x+r.y;vec2 AB=vec2(-1.04,1.04)*a004+r.zw;return specularColor*AB.x+AB.y;}vec3 computeIndirectLightContribution(Material mat,float NdotV,vec3 normal)
{vec3 env_light=vec3(0.65,0.65,0.65);
#ifdef LIGHTING_3D_MODE
float ambient_factor=calculate_ambient_directional_factor(normal);env_light=u_lighting_ambient_color*ambient_factor;
#endif
vec3 envBRDF=EnvBRDFApprox(mat.specularColor,mat.perceptualRoughness,NdotV);vec3 indirectSpecular= envBRDF*env_light;vec3 indirectDiffuse=mat.diffuseColor*env_light;return indirectSpecular+indirectDiffuse;}vec3 computeLightContribution(Material mat,vec3 lightPosition,vec3 lightColor)
{highp vec3 n=mat.normal;highp vec3 v=normalize(-v_position);highp vec3 l=normalize(lightPosition);highp vec3 h=normalize(v+l);float NdotV=clamp(abs(dot(n,v)),0.001,1.0);float NdotL=saturate(dot(n,l));highp float NdotH=saturate(dot(n,h));float VdotH=saturate(dot(v,h));vec3 f=F_SchlickFast(mat.specularColor,VdotH);float g=V_GGXFast(NdotL,NdotV,mat.alphaRoughness);float d=D_GGX(NdotH,mat.alphaRoughness);vec3 diffuseTerm=(1.0-f)*diffuseLambertian(mat);vec3 specularTerm=f*g*d;vec3 transformed_normal=vec3(-n.xy,n.z);float lighting_factor;
#ifdef RENDER_SHADOWS
lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
lighting_factor=NdotL;
#endif
vec3 directLightColor=(specularTerm+diffuseTerm)*lighting_factor*lightColor;vec3 indirectLightColor=computeIndirectLightContribution(mat,NdotV,transformed_normal);vec3 color=(saturate(directLightColor)+indirectLightColor);float intensityFactor=1.0;
#if !defined(LIGHTING_3D_MODE)
const vec3 luminosityFactor=vec3(0.2126,0.7152,0.0722);float luminance=dot(diffuseTerm,luminosityFactor);intensityFactor=mix((1.0-u_lightintensity),max((1.0-luminance+u_lightintensity),1.0),NdotL);
#endif
color*=intensityFactor;return color;}void main() {
#ifdef TERRAIN_FRAGMENT_OCCLUSION
if (isOccluded()) {discard;}
#endif
vec3 lightDir=u_lightpos;vec3 lightColor=u_lightcolor;
#ifdef LIGHTING_3D_MODE
lightDir=u_lighting_directional_dir;lightDir.xy=-lightDir.xy;lightColor=u_lighting_directional_color;
#endif
vec4 finalColor;
#ifdef DIFFUSE_SHADED
vec3 N=getNormal();vec3 diffuse=getDiffuseShadedColor(getBaseColor().rgb,N,lightDir,lightColor);
#ifdef HAS_TEXTURE_u_occlusionTexture
float ao=(texture2D(u_occlusionTexture,uv_2f).r-1.0)*u_aoIntensity+1.0;diffuse*=ao;
#endif
finalColor=vec4(diffuse,1.0)*u_opacity;
#else
Material mat=getPBRMaterial();vec3 color=computeLightContribution(mat,lightDir,lightColor);
#if defined (HAS_TEXTURE_u_occlusionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
float ao=(texture2D(u_occlusionTexture,uv_2f).x-1.0)*u_aoIntensity+1.0;color*=ao;
#endif
vec4 emissive=u_emissiveFactor;
#if defined(HAS_TEXTURE_u_emissionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
emissive.rgb*=sRGBToLinear(texture2D(u_emissionTexture,uv_2f).rgb);
#endif
color+=emissive.rgb;float opacity=mat.baseColor.w*u_opacity;
#ifdef HAS_ATTRIBUTE_a_pbr
float resEmission=v_roughness_metallic_emissive_alpha.z;resEmission*=v_height_based_emission_params.z+v_height_based_emission_params.w*pow(clamp(v_height_based_emission_params.x,0.0,1.0),v_height_based_emission_params.y);color=mix(color,v_color_mix.rgb,min(1.0,resEmission));
#ifdef HAS_ATTRIBUTE_a_color_4f
float distance=length(vec2(1.3*max(0.0,abs(color_4f.x)-color_4f.z),color_4f.y));distance+= mix(0.5,0.0,clamp(resEmission-1.0,0.0,1.0));opacity*=v_roughness_metallic_emissive_alpha.w*saturate(1.0-distance*distance);
#endif
#endif
color=linearTosRGB(color);color*=opacity;finalColor=vec4(color,opacity);
#endif
#ifdef FOG
finalColor=fog_dither(fog_apply_premultiplied(finalColor,v_fog_pos));
#endif
#ifdef INDICATOR_CUTOUT
finalColor=applyCutout(finalColor);
#endif
gl_FragColor=finalColor;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`attribute vec3 a_pos_3f;
#pragma mapbox: define-attribute highp vec3 normal_3f
#pragma mapbox: define-attribute highp vec2 uv_2f
#pragma mapbox: define-attribute highp vec3 color_3f
#pragma mapbox: define-attribute highp vec4 color_4f
#pragma mapbox: define-attribute-vertex-shader-only highp vec4 pbr
#pragma mapbox: define-attribute-vertex-shader-only highp vec3 heightBasedEmissiveStrength
uniform mat4 u_matrix;uniform mat4 u_lighting_matrix;uniform vec3 u_camera_pos;uniform vec4 u_color_mix;
#ifdef INSTANCED_ARRAYS
attribute vec4 a_normal_matrix0;attribute vec4 a_normal_matrix1;attribute vec4 a_normal_matrix2;attribute vec4 a_normal_matrix3;
#else
uniform highp mat4 u_normal_matrix;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth_shadows;
#endif
varying vec3 v_position;varying lowp vec4 v_color_mix;
#ifdef TERRAIN_FRAGMENT_OCCLUSION
varying highp float v_depth;
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
varying lowp vec4 v_roughness_metallic_emissive_alpha;varying mediump vec4 v_height_based_emission_params;
#endif
void main() {
#pragma mapbox: initialize-attribute highp vec3 normal_3f
#pragma mapbox: initialize-attribute highp vec2 uv_2f
#pragma mapbox: initialize-attribute highp vec3 color_3f
#pragma mapbox: initialize-attribute highp vec4 color_4f
#pragma mapbox: initialize-attribute-custom highp vec4 pbr
#pragma mapbox: initialize-attribute-custom highp vec3 heightBasedEmissiveStrength
highp mat4 normal_matrix;
#ifdef INSTANCED_ARRAYS
normal_matrix=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);
#else
normal_matrix=u_normal_matrix;
#endif
vec3 local_pos;mat3 rs;
#ifdef MODEL_POSITION_ON_GPU
vec3 pos_color=normal_matrix[0].xyz;vec4 translate=normal_matrix[1];vec3 pos_a=floor(pos_color);vec3 rgb=1.05*(pos_color-pos_a);float color_mix=pos_a.z/100.0;v_color_mix=vec4(sRGBToLinear(rgb),color_mix);float meter_to_tile=normal_matrix[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);rs[0].x=normal_matrix[1].w;rs[0].yz=normal_matrix[2].xy;rs[1].xy=normal_matrix[2].zw;rs[1].z=normal_matrix[3].x;rs[2].xyz=normal_matrix[3].yzw;vec4 pos_node=u_lighting_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;local_pos=pos.xyz;gl_Position=u_matrix*pos;pos.z*=meter_to_tile;v_position=pos.xyz-u_camera_pos;
#else
local_pos=a_pos_3f;gl_Position=u_matrix*vec4(a_pos_3f,1);v_position=vec3(u_lighting_matrix*vec4(a_pos_3f,1));v_color_mix=vec4(sRGBToLinear(u_color_mix.rgb),u_color_mix.a);
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
vec4 albedo_c=decode_color(pbr.xy);vec2 e_r_m=unpack_float(pbr.z);vec2 r_m= unpack_float(e_r_m.y*16.0);r_m.r=r_m.r*16.0;v_color_mix=vec4(albedo_c.rgb,1.0);v_roughness_metallic_emissive_alpha=vec4(vec3(r_m,e_r_m.x)/255.0,albedo_c.a);v_roughness_metallic_emissive_alpha.z*=2.0;float heightBasedRelativeIntepolation=a_pos_3f.z*heightBasedEmissiveStrength.x+heightBasedEmissiveStrength.y;v_height_based_emission_params.x=heightBasedRelativeIntepolation;v_height_based_emission_params.y=heightBasedEmissiveStrength.z;vec2 emissionMultiplierValues=unpack_float(pbr.w)/256.0;v_height_based_emission_params.z=emissionMultiplierValues.x;v_height_based_emission_params.w=emissionMultiplierValues.y-emissionMultiplierValues.x;
#endif
#ifdef FOG
v_fog_pos=fog_position(local_pos);
#endif
#ifdef TERRAIN_FRAGMENT_OCCLUSION
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef HAS_ATTRIBUTE_a_normal_3f
#ifdef MODEL_POSITION_ON_GPU
float x_squared_scale=dot(rs[0],rs[0]);float y_squared_scale=dot(rs[1],rs[1]);float z_squared_scale=dot(rs[2],rs[2]);vec3 squared_scale=vec3(x_squared_scale,y_squared_scale,z_squared_scale);normal_3f=rs*((u_lighting_matrix*vec4(normal_3f,0.0)).xyz/squared_scale);normal_3f=normalize(normal_3f);
#else
normal_3f=vec3(normal_matrix*vec4(normal_3f,0));
#endif
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
#ifdef HAS_ATTRIBUTE_a_color_4f
v_roughness_metallic_emissive_alpha.w=clamp(color_4f.a*v_roughness_metallic_emissive_alpha.w*(v_roughness_metallic_emissive_alpha.z-1.0),0.0,1.0);
#endif
#endif
#ifdef RENDER_SHADOWS
vec3 shadow_pos=local_pos;
#ifdef NORMAL_OFFSET
#ifdef HAS_ATTRIBUTE_a_normal_3f
#ifdef MODEL_POSITION_ON_GPU
vec3 offset=shadow_normal_offset(vec3(-normal_3f.xy,normal_3f.z));shadow_pos+=offset*shadow_normal_offset_multiplier0();
#else
vec3 offset=shadow_normal_offset_model(normalize(normal_3f));shadow_pos+=offset*shadow_normal_offset_multiplier0();
#endif
#endif
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shadow_pos,1);v_pos_light_view_1=u_light_matrix_1*vec4(shadow_pos,1);v_depth_shadows=gl_Position.w;
#endif
}`),modelDepth:ir(`varying highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
gl_FragColor=pack_depth(v_depth);
#endif
}`,`attribute vec3 a_pos_3f;uniform mat4 u_matrix;varying highp float v_depth;
#ifdef MODEL_POSITION_ON_GPU
#ifdef INSTANCED_ARRAYS
attribute vec4 a_instance0;attribute vec4 a_instance1;attribute vec4 a_instance2;attribute vec4 a_instance3;
#else
uniform highp mat4 u_instance;
#endif
uniform highp mat4 u_node_matrix;
#endif
void main() {
#ifdef MODEL_POSITION_ON_GPU
highp mat4 instance;
#ifdef INSTANCED_ARRAYS
instance=mat4(a_instance0,a_instance1,a_instance2,a_instance3);
#else
instance=u_instance;
#endif
vec3 pos_color=instance[0].xyz;vec4 translate=instance[1];vec3 pos_a=floor(pos_color);float meter_to_tile=instance[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);mat3 rs;rs[0].x=instance[1].w;rs[0].yz=instance[2].xy;rs[1].xy=instance[2].zw;rs[1].z=instance[3].x;rs[2].xyz=instance[3].yzw;vec4 pos_node=u_node_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;gl_Position=u_matrix*pos;
#else
gl_Position=u_matrix*vec4(a_pos_3f,1);
#endif
v_depth=gl_Position.z/gl_Position.w;}`),stars:ir(`varying highp vec2 v_uv;varying mediump float v_intensity;float shapeCircle(in vec2 uv)
{float beginFade=0.6;float lengthFromCenter=length(v_uv);return 1.0-clamp((lengthFromCenter-beginFade)/(1.0-beginFade),0.0,1.0);}void main() {float alpha=shapeCircle(v_uv);vec3 color=vec3(1.0,1.0,1.0);alpha*=v_intensity;gl_FragColor=vec4(color*alpha,alpha);HANDLE_WIREFRAME_DEBUG;}`,`
attribute vec3 a_pos_3f;attribute vec2 a_uv;attribute float a_size_scale;attribute float a_fade_opacity;uniform mat4 u_matrix;uniform vec3 u_up;uniform vec3 u_right;uniform float u_intensity_multiplier;varying highp vec2 v_uv;varying mediump float v_intensity;void main() {v_uv=a_uv;v_intensity=a_fade_opacity*u_intensity_multiplier;vec3 pos=a_pos_3f;pos+=a_uv.x*u_right*a_size_scale;pos+=a_uv.y*u_up*a_size_scale;gl_Position=u_matrix*vec4(pos,1.0);}`)};function ac(t,e){const n=t.replace(/\s*\/\/[^\n]*\n/g,`
`).split(`
`);for(let i of n)if(i=i.trim(),i[0]==="#"&&i.includes("if")&&!i.includes("endif")){i=i.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const s=i.split(" ");for(const l of s)e.includes(l)||e.push(l)}}function ir(t,e){const n=/#pragma mapbox: ([\w\-]+) ([\w]+) ([\w]+) ([\w]+)/g;let i=e.match(/attribute(\S*) (highp |mediump |lowp )?([\w]+) ([\w]+)/g);i&&(i=i.filter((u,h)=>i.indexOf(u)===h));const s={},l=[...Ah];return ac(t,l),ac(e,l),{fragmentSource:t=t.replace(n,(u,h,f,m,y)=>(s[y]=!0,h==="define"?`
#ifndef HAS_UNIFORM_u_${y}
varying ${f} ${m} ${y};
#else
uniform ${f} ${m} u_${y};
#endif
`:h==="initialize"?`
#ifdef HAS_UNIFORM_u_${y}
    ${f} ${m} ${y} = u_${y};
#endif
`:h==="define-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${y}
    varying ${f} ${m} ${y};
#endif
`:h==="initialize-attribute"?"":void 0)),vertexSource:e=e.replace(n,(u,h,f,m,y)=>{const v=m==="float"?"vec2":m,w=y.match(/color/)?"color":v;return h==="define-attribute-vertex-shader-only"?`
#ifdef HAS_ATTRIBUTE_a_${y}
attribute ${f} ${m} a_${y};
#endif
`:s[y]?h==="define"?`
#ifndef HAS_UNIFORM_u_${y}
uniform lowp float u_${y}_t;
attribute ${f} ${v} a_${y};
varying ${f} ${m} ${y};
#else
uniform ${f} ${m} u_${y};
#endif
`:h==="initialize"?w==="vec4"?`
#ifndef HAS_UNIFORM_u_${y}
    ${y} = a_${y};
#else
    ${f} ${m} ${y} = u_${y};
#endif
`:`
#ifndef HAS_UNIFORM_u_${y}
    ${y} = unpack_mix_${w}(a_${y}, u_${y}_t);
#else
    ${f} ${m} ${y} = u_${y};
#endif
`:h==="define-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${y}
    attribute ${f} ${m} a_${y};
    varying ${f} ${m} ${y};
#endif
`:h==="initialize-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${y}
    ${y} = a_${y};
#endif
`:void 0:h==="define"?`
#ifndef HAS_UNIFORM_u_${y}
uniform lowp float u_${y}_t;
attribute ${f} ${v} a_${y};
#else
uniform ${f} ${m} u_${y};
#endif
`:h==="define-instanced"?w==="mat4"?`
#ifdef INSTANCED_ARRAYS
attribute vec4 a_${y}0;
attribute vec4 a_${y}1;
attribute vec4 a_${y}2;
attribute vec4 a_${y}3;
#else
uniform ${f} ${m} u_${y};
#endif
`:`
#ifdef INSTANCED_ARRAYS
attribute ${f} ${v} a_${y};
#else
uniform ${f} ${m} u_${y};
#endif
`:h==="initialize-attribute-custom"?`
#ifdef HAS_ATTRIBUTE_a_${y}
    ${f} ${m} ${y} = a_${y};
#endif
`:w==="vec4"?`
#ifndef HAS_UNIFORM_u_${y}
    ${f} ${m} ${y} = a_${y};
#else
    ${f} ${m} ${y} = u_${y};
#endif
`:`
#ifndef HAS_UNIFORM_u_${y}
    ${f} ${m} ${y} = unpack_mix_${w}(a_${y}, u_${y}_t);
#else
    ${f} ${m} ${y} = u_${y};
#endif
`}),staticAttributes:i,usedDefines:l}}class sU{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(e,n,i,s,l,u,h){this.context=e;let f=this.boundPaintVertexBuffers.length!==s.length;for(let y=0;!f&&y<s.length;y++)this.boundPaintVertexBuffers[y]!==s[y]&&(f=!0);let m=this.boundDynamicVertexBuffers.length!==h.length;for(let y=0;!m&&y<h.length;y++)this.boundDynamicVertexBuffers[y]!==h[y]&&(m=!0);if(!e.extVertexArrayObject||!this.vao||this.boundProgram!==n||this.boundLayoutVertexBuffer!==i||f||m||this.boundIndexBuffer!==l||this.boundVertexOffset!==u)this.freshBind(n,i,s,l,u,h);else{e.bindVertexArrayOES.set(this.vao);for(const y of h)y&&y.bind();l&&l.dynamicDraw&&l.bind()}}freshBind(e,n,i,s,l,u){let h;const f=e.numAttributes,m=this.context,y=m.gl;if(m.extVertexArrayObject)this.vao&&this.destroy(),this.vao=m.extVertexArrayObject.createVertexArrayOES(),m.bindVertexArrayOES.set(this.vao),h=0,this.boundProgram=e,this.boundLayoutVertexBuffer=n,this.boundPaintVertexBuffers=i,this.boundIndexBuffer=s,this.boundVertexOffset=l,this.boundDynamicVertexBuffers=u;else{h=m.currentNumAttributes||0;for(let v=f;v<h;v++)y.disableVertexAttribArray(v)}n.enableAttributes(y,e),n.bind(),n.setVertexAttribPointers(y,e,l);for(const v of i)v.enableAttributes(y,e),v.bind(),v.setVertexAttribPointers(y,e,l);for(const v of u)v&&(v.enableAttributes(y,e),v.bind(),v.setVertexAttribPointers(y,e,l));s&&s.bind(),m.currentNumAttributes=f}destroy(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)}}function aU(t,e){const n=Math.pow(2,e.canonical.z),i=e.canonical.y;return[new Un(0,i/n).toLngLat().lat,new Un(0,(i+1)/n).toLngLat().lat]}function lU(t,e,n,i,s,l,u){const h=t.context,f=h.gl,m=n.fbo;if(!m)return;t.prepareDrawTile();const y=t.useProgram("hillshade");h.activeTexture.set(f.TEXTURE0),f.bindTexture(f.TEXTURE_2D,m.colorAttachment.get());const v=((A,M,k,R)=>{const L=k.paint.get("hillshade-shadow-color"),z=k.paint.get("hillshade-highlight-color"),B=k.paint.get("hillshade-accent-color");let j=k.paint.get("hillshade-illumination-direction")*(Math.PI/180);k.paint.get("hillshade-illumination-anchor")==="viewport"&&(j-=A.transform.angle);const V=!A.options.moving;return{u_matrix:R||A.transform.calculateProjMatrix(M.tileID.toUnwrapped(),V),u_image:0,u_latrange:aU(0,M.tileID),u_light:[k.paint.get("hillshade-exaggeration"),j],u_shadow:L,u_highlight:z,u_accent:B}})(t,n,i,t.terrain?e.projMatrix:null);t.uploadCommonUniforms(h,y,e.toUnwrapped());const{tileBoundsBuffer:w,tileBoundsIndexBuffer:S,tileBoundsSegments:E}=t.getTileBoundsBuffers(n);y.draw(t,f.TRIANGLES,s,l,u,Vn.disabled,v,i.id,w,S,E)}function wP(t,e,n){if(!e.needsDEMTextureUpload)return;const i=t.context,s=i.gl;i.pixelStoreUnpackPremultiplyAlpha.set(!1),e.demTexture=e.demTexture||t.getTileTexture(n.stride);const l=n.getPixels();e.demTexture?e.demTexture.update(l,{premultiply:!1}):e.demTexture=new Ai(i,l,s.RGBA,{premultiply:!1}),e.needsDEMTextureUpload=!1}function uU(t,e,n,i,s,l){const u=t.context,h=u.gl;if(!e.dem)return;const f=e.dem;if(u.activeTexture.set(h.TEXTURE1),wP(t,e,f),!e.demTexture)return;e.demTexture.bind(h.NEAREST,h.CLAMP_TO_EDGE);const m=f.dim;u.activeTexture.set(h.TEXTURE0);let y=e.fbo;if(!y){const E=new Ai(u,{width:m,height:m,data:null},h.RGBA);E.bind(h.LINEAR,h.CLAMP_TO_EDGE),y=e.fbo=u.createFramebuffer(m,m,!0,"renderbuffer"),y.colorAttachment.set(E.texture)}u.bindFramebuffer.set(y.framebuffer),u.viewport.set([0,0,m,m]);const{tileBoundsBuffer:v,tileBoundsIndexBuffer:w,tileBoundsSegments:S}=t.getMercatorTileBoundsBuffers();t.useProgram("hillshadePrepare").draw(t,h.TRIANGLES,i,s,l,Vn.disabled,((E,A)=>{const M=A.stride,k=Me.create();return Me.ortho(k,0,Ge,-Ge,0,0,1),Me.translate(k,k,[0,-Ge,0]),{u_matrix:k,u_image:1,u_dimension:[M,M],u_zoom:E.overscaledZ,u_unpack:A.unpackVector}})(e.tileID,f),n.id,v,w,S),e.needsHillshadePrepare=!1}const bP=t=>({u_matrix:new gn(t),u_image0:new Sn(t),u_skirt_height:new pt(t),u_ground_shadow_factor:new fn(t)}),SP=(t,e,n)=>({u_matrix:t,u_image0:0,u_skirt_height:e,u_ground_shadow_factor:n}),EP=(t,e,n,i,s,l,u,h,f,m,y,v,w,S,E)=>({u_proj_matrix:Float32Array.from(t),u_globe_matrix:e,u_normalize_matrix:Float32Array.from(i),u_merc_matrix:n,u_zoom_transition:s,u_merc_center:l,u_image0:0,u_frustum_tl:u,u_frustum_tr:h,u_frustum_br:f,u_frustum_bl:m,u_globe_pos:y,u_globe_radius:v,u_viewport:w,u_grid_matrix:E?Float32Array.from(E):new Float32Array(9),u_skirt_height:S}),Os={BaseColor:5,MetallicRoughness:6,Normal:7,Occlusion:8,Emission:9,ShadowMap0:10},Fm=2048;class cU{constructor(e){this.painter=e,this._enabled=!1,this._shadowLayerCount=0,this._cascades=[],this._depthMode=new _n(e.context.gl.LEQUAL,_n.ReadWrite,[0,1]),this._uniformValues={u_light_matrix_0:new Float32Array(16),u_light_matrix_1:new Float32Array(16),u_shadow_intensity:0,u_fade_range:[0,0],u_shadow_normal_offset:[1,1,1],u_texel_size:1,u_shadow_direction:[0,0,1],u_shadow_bias:[36e-5,.0012,.012],u_shadowmap_0:0,u_shadowmap_1:0},this.useNormalOffset=!1}destroy(){for(const e of this._cascades)e.texture.destroy(),e.framebuffer.destroy();this._cascades=[]}updateShadowParameters(e,n){const i=this.painter;if(this._enabled=!1,this._shadowLayerCount=0,!i.context.isWebGL2||!n||!n.properties)return;const s=n.properties.get("shadow-intensity");if(n.properties.get("cast-shadows")!==!0||s<=0||(this._shadowLayerCount=i.style.order.reduce((S,E)=>{const A=i.style._layers[E];return S+(A.hasShadowPass()&&!A.isHidden(e.zoom)?1:0)},0),this._enabled=this._shadowLayerCount>0,!this._enabled))return;const l=i.context,u=Fm,h=Fm;if(this._cascades.length===0)for(let S=0;S<2;++S){const E=i._shadowMapDebug,A=l.gl,M=l.createFramebuffer(u,h,E,"texture"),k=new Ai(l,{width:u,height:h,data:null},A.DEPTH_COMPONENT);if(M.depthAttachment.set(k.texture),E){const R=new Ai(l,{width:u,height:h,data:null},A.RGBA);M.colorAttachment.set(R.texture)}this._cascades.push({framebuffer:M,texture:k,matrix:[],far:0,boundingSphereRadius:0,frustum:new hm})}const f=function(S,E){const A=E.properties.get("direction"),M=St(A.x,A.y,A.z);M[2]=ce(M[2],0,75);const k=bt([M[0],M[1],M[2]]);return fe.fromValues(k.x,k.y,k.z)}(0,n);let m=0;if(e.elevation){const S=e.elevation,E=[1e4,-1e4];S.visibleDemTiles.filter(A=>A.dem).forEach(A=>{const M=A.dem.tree;E[0]=Math.min(E[0],M.minimums[0]),E[1]=Math.max(E[1],M.maximums[0])}),E[0]!==1e4&&(m=(E[1]-E[0])*S.exaggeration())}const y=1.5*e.cameraToCenterDistance,v=3*y,w=new Float64Array(16);for(let S=0;S<2;++S){const E=this._cascades[S];let A=e.height/50,M=1;S===0?M=y:(A=y,M=v);const[k,R]=hU(e,f,A,M,Fm,m);E.matrix=k,E.boundingSphereRadius=R,Me.invert(w,E.matrix),E.frustum=hm.fromInvProjectionMatrix(w,1,0,!0),E.far=M}this._uniformValues.u_fade_range=[.75*this._cascades[1].far,this._cascades[1].far],this._uniformValues.u_shadow_intensity=s,this._uniformValues.u_shadow_direction=[f[0],f[1],f[2]],this._uniformValues.u_texel_size=.00048828125,this._uniformValues.u_shadowmap_0=Os.ShadowMap0,this._uniformValues.u_shadowmap_1=Os.ShadowMap0+1}get enabled(){return this._enabled}set enabled(e){this._enabled=e}drawShadowPass(e,n){if(!this._enabled)return;const i=this.painter,s=i.context;s.viewport.set([0,0,Fm,Fm]);for(let l=0;l<2;++l){i.currentShadowCascade=l,s.bindFramebuffer.set(this._cascades[l].framebuffer.framebuffer),s.clear({color:wn.white,depth:1});for(const u of e.order){const h=e._layers[u];if(!h.hasShadowPass()||h.isHidden(i.transform.zoom))continue;const f=e._getLayerSourceCache(h),m=f?n[f.id]:void 0;(h.type==="model"||m&&m.length)&&i.renderLayer(i,f,h,m)}}i.currentShadowCascade=0}drawGroundShadows(){if(!this._enabled)return;const e=this.painter,n=e.style,i=e.context,s=n.directionalLight,l=n.ambientLight;if(!s||!l)return;const u=e.useProgram("groundShadow"),h=e.transform.coveringTiles({tileSize:512,renderWorldCopies:!0}),f=vE(s,l),m=new _n(i.gl.LEQUAL,_n.ReadOnly,e.depthRangeFor3D);for(const y of h){const v=y.toUnwrapped();this.setupShadows(v,u),e.uploadCommonUniforms(i,u,v);const w={u_matrix:e.transform.calculateProjMatrix(v),u_ground_shadow_factor:f};u.draw(e,i.gl.TRIANGLES,m,Nn.disabled,ur.multiply,Vn.disabled,w,"ground_shadow",e.tileExtentBuffer,e.quadTriangleIndexBuffer,e.tileExtentSegments,{},e.transform.zoom,null,null)}}getShadowPassColorMode(){return this.painter._shadowMapDebug?ur.unblended:ur.disabled}getShadowPassDepthMode(){return this._depthMode}getShadowCastingLayerCount(){return this._shadowLayerCount}calculateShadowPassMatrixFromTile(e){const n=this.painter.transform,i=n.calculatePosMatrix(e,n.worldSize);return Me.multiply(i,this._cascades[this.painter.currentShadowCascade].matrix,i),Float32Array.from(i)}calculateShadowPassMatrixFromMatrix(e){return Me.multiply(e,this._cascades[this.painter.currentShadowCascade].matrix,e),Float32Array.from(e)}setupShadows(e,n,i,s=0){if(!this._enabled)return;const l=this.painter.transform,u=this.painter.context,h=u.gl,f=this._uniformValues,m=new Float64Array(16),y=l.calculatePosMatrix(e,l.worldSize);for(let v=0;v<2;v++)Me.multiply(m,this._cascades[v].matrix,y),f[v===0?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(m),u.activeTexture.set(h.TEXTURE0+Os.ShadowMap0+v),this._cascades[v].texture.bind(h.NEAREST,h.CLAMP_TO_EDGE);if(this.useNormalOffset=!!i,this.useNormalOffset){const v=c_(e.canonical),w=2/l.tileSize*Ge/Fm,S=w*this._cascades[0].boundingSphereRadius,E=w*this._cascades[1].boundingSphereRadius,A=(i==="vector-tile"?1:3)/Math.pow(2,s-e.canonical.z-(1-l.zoom+Math.floor(l.zoom)));f.u_shadow_normal_offset=[v,S*A,E*A],f.u_shadow_bias=[6e-5,.0012,.012]}else f.u_shadow_bias=[36e-5,.0012,.012];n.setShadowUniformValues(u,f)}setupShadowsFromMatrix(e,n,i=!1){if(!this._enabled)return;const s=this.painter.context,l=s.gl,u=this._uniformValues,h=new Float64Array(16);for(let f=0;f<2;f++)Me.multiply(h,this._cascades[f].matrix,e),u[f===0?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(h),s.activeTexture.set(l.TEXTURE0+Os.ShadowMap0+f),this._cascades[f].texture.bind(l.NEAREST,l.CLAMP_TO_EDGE);this.useNormalOffset=i,i?(u.u_shadow_normal_offset=[1,5,5],u.u_shadow_bias=[6e-5,.0012,.012]):u.u_shadow_bias=[36e-5,.0012,.012],n.setShadowUniformValues(s,u)}getShadowUniformValues(){return this._uniformValues}getCurrentCascadeFrustum(){return this._cascades[this.painter.currentShadowCascade].frustum}}function vE(t,e){const n=t.properties.get("color"),i=t.properties.get("intensity"),s=t.properties.get("direction"),l=[s.x,s.y,s.z],u=e.properties.get("color"),h=e.properties.get("intensity"),f=Math.max(fe.dot([0,0,1],l),0),m=[0,0,0];fe.scale(m,u.toArray01Linear().slice(0,3),h);const y=[0,0,0];return fe.scale(y,n.toArray01Linear().slice(0,3),f*i),dr([m[0]>0?m[0]/(m[0]+y[0]):0,m[1]>0?m[1]/(m[1]+y[1]):0,m[2]>0?m[2]/(m[2]+y[2]):0])}function hU(t,e,n,i,s,l){const u=t.zoom,h=t.scale,f=t.worldSize,m=1/f,y=t.aspect,v=Math.sqrt(1+y*y)*Math.tan(.5*t.fovX),w=v*v,S=i-n,E=i+n;let A,M;w>S/E?(A=i,M=i*v):(A=.5*E*(1+w),M=.5*Math.sqrt(S*S+2*(i*i+n*n)*w+E*E*w*w));const k=t.projection.pixelsPerMeter(t.center.lat,f),R=t._camera.getCameraToWorldMercator(),L=[0,0,-A*m];fe.transformMat4(L,L,R);let z=M*m;const B=t._edgeInsets;if(!(B.left===0&&B.top===0&&B.right===0&&B.bottom===0||B.left===B.right&&B.top===B.bottom)){const qe=t._camera.getWorldToCamera(t.worldSize,t.projection.zAxisUnit==="meters"?k:1),Ve=t._camera.getCameraToClipPerspective(t._fov,t.width/t.height,n,i);Ve[8]=2*-t.centerOffset.x/t.width,Ve[9]=2*t.centerOffset.y/t.height;const yt=new Float64Array(16);Me.mul(yt,Ve,qe);const mt=new Float64Array(16);Me.invert(mt,yt);const lt=hm.fromInvProjectionMatrix(mt,f,u,!0);for(const ft of lt.points){const Mt=((j=ft)[0]/=h,j[1]/=h,j[2]=mr(j[2],t._center.lat),j);z=Math.max(z,fe.len(fe.subtract([],L,Mt)))}}var j;z*=s/(s-1);const V=Math.acos(e[2]),Y=Math.atan2(-e[0],-e[1]),ne=new ax;ne.position=L,ne.setPitchBearing(V,Y);const re=ne.getWorldToCamera(f,k),J=z*f,ae=Math.min(t._mercatorZfromZoom(17)*f*-2,-2*J),le=ne.getCameraToClipOrthographic(-J,J,-J,J,ae,(J+l*k)/e[2]),oe=new Float64Array(16);Me.multiply(oe,le,re);const Ee=fe.fromValues(Math.floor(1e6*L[0])/1e6*f,Math.floor(1e6*L[1])/1e6*f,0),xe=.5*s,Pe=[0,0,0];fe.transformMat4(Pe,Ee,oe),fe.scale(Pe,Pe,xe);const pe=[Math.floor(Pe[0]),Math.floor(Pe[1]),Math.floor(Pe[2])],Ae=[0,0,0];fe.sub(Ae,Pe,pe),fe.scale(Ae,Ae,-1/xe);const Le=new Float64Array(16);return Me.identity(Le),Me.translate(Le,Le,Ae),Me.multiply(oe,Le,oe),[oe,J]}function TP(t,e){return t!=null&&e!=null&&!(!t.hasData()||!e.hasData())&&t.demTexture!=null&&e.demTexture!=null&&t.tileID.key!==e.tileID.key}const Bm=new class{constructor(){this.operations={}}newMorphing(t,e,n,i,s){if(t in this.operations){const l=this.operations[t];l.to.tileID.key!==n.tileID.key&&(l.queued=n)}else this.operations[t]={startTime:i,phase:0,duration:s,from:e,to:n,queued:null}}getMorphValuesForProxy(t){if(!(t in this.operations))return null;const e=this.operations[t];return{from:e.from,to:e.to,phase:e.phase}}update(t){for(const e in this.operations){const n=this.operations[e];for(n.phase=(t-n.startTime)/n.duration;n.phase>=1||!this._validOp(n);)if(!this._nextOp(n,t)){delete this.operations[e];break}}}_nextOp(t,e){return!!t.queued&&(t.from=t.to,t.to=t.queued,t.queued=null,t.phase=0,t.startTime=e,!0)}_validOp(t){return t.from.hasData()&&t.to.hasData()}},CP={0:null,1:"TERRAIN_VERTEX_MORPHING"};function AP(t,e,n){if(e===0)return 0;const i=e<1&&n===514?.25/e:1;return 6*Math.pow(1.5,22-t)*Math.max(e,1)*i}function dU(t,e){const n=1<<t.z;return!e&&(t.x===0||t.x===n-1)||t.y===0||t.y===n-1}const xE=t=>({u_matrix:t});function MP(t,e,n,i,s){if(s>0){const l=mn.now(),u=(l-t.timeAdded)/s,h=e?(l-e.timeAdded)/s:-1,f=n.getSource(),m=i.coveringZoomLevel({tileSize:f.tileSize,roundZoom:f.roundZoom}),y=!e||Math.abs(e.tileID.overscaledZ-m)>Math.abs(t.tileID.overscaledZ-m),v=y&&t.refreshedUponExpiration?1:ce(y?u:1-h,0,1);return t.refreshedUponExpiration&&u>=1&&(t.refreshedUponExpiration=!1),e?{opacity:1,mix:1-v}:{opacity:v,mix:0}}return{opacity:1,mix:0}}class fU extends _l{constructor(e){const n={type:"raster-dem",maxzoom:e.transform.maxZoom},i=new ff(O_(),null),s=lE("mock-dem",n,i,e.style);super("mock-dem",s,!1),s.setEventedParent(this),this._sourceLoaded=!0}_loadTile(e,n){e.state="loaded",n(null)}}class pU extends _l{constructor(e){const n=lE("proxy",{type:"geojson",maxzoom:e.transform.maxZoom},new ff(O_(),null),e.style);super("proxy",n,!1),n.setEventedParent(this),this.map=this.getSource().map=e,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(e,n,i){if(e.freezeTileCoverage)return;this.transform=e;const s=e.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((l,u)=>{if(l[u.key]="",!this._tiles[u.key]){const h=new E_(u,this._source.tileSize*u.overscaleFactor(),e.tileZoom);h.state="loaded",this._tiles[u.key]=h}return l},{});for(const l in this._tiles)l in s||(this.freeFBO(l),this._tiles[l].unloadVectorData(),delete this._tiles[l])}freeFBO(e){const n=this.proxyCachedFBO[e];if(n!==void 0){const i=Object.values(n);this.renderCachePool.push(...i),delete this.proxyCachedFBO[e]}}deallocRenderCache(){this.renderCache.forEach(e=>e.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class IP extends Ir{constructor(e,n,i){super(e.overscaledZ,e.wrap,e.canonical.z,e.canonical.x,e.canonical.y),this.proxyTileKey=n,this.projMatrix=i}}class mU extends n6{constructor(e,n){super(),this.painter=e,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[i,s,l]=function(f){const m=new Bo,y=new di,v=131;m.reserve(17161),y.reserve(33800);const w=Ge/128,S=Ge+w/2,E=S+w;for(let M=-w;M<E;M+=w)for(let k=-w;k<E;k+=w){const R=k<0||k>S||M<0||M>S?24575:0,L=ce(Math.round(k),0,Ge),z=ce(Math.round(M),0,Ge);m.emplaceBack(L+R,z)}const A=(M,k)=>{const R=k*v+M;y.emplaceBack(R+1,R,R+v),y.emplaceBack(R+v,R+v+1,R+1)};for(let M=1;M<129;M++)for(let k=1;k<129;k++)A(k,M);return[0,129].forEach(M=>{for(let k=0;k<130;k++)A(k,M),A(M,k)}),[m,y,32768]}(),u=e.context;this.gridBuffer=u.createVertexBuffer(i,hh.members),this.gridIndexBuffer=u.createIndexBuffer(s),this.gridSegments=In.simpleSegment(0,0,i.length,s.length),this.gridNoSkirtSegments=In.simpleSegment(0,0,i.length,l),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new pU(n.map),this.orthoMatrix=Me.create(),Me.ortho(this.orthoMatrix,this.painter.transform.projection.name==="globe"?.015:0,Ge,0,Ge,0,1);const h=u.gl;this._overlapStencilMode=new Nn({func:h.GEQUAL,mask:255},0,255,h.KEEP,h.KEEP,h.REPLACE),this._previousZoom=e.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=n,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new fU(n.map),this._pendingGroundEffectLayers=[]}set style(e){e.on("data",this._onStyleDataEvent.bind(this)),e.on("neworder",this._checkRenderCacheEfficiency.bind(this)),this._style=e,this._checkRenderCacheEfficiency(),this._style.map.on("moveend",()=>{this._clearLineLayersFromRenderCache()})}update(e,n,i){if(e&&e.terrain){this._style!==e&&(this.style=e),this.enabled=!0;const s=e.terrain.properties;this.sourceCache=e.terrain.drapeRenderMode===0?this._mockSourceCache:e._getSourceCache(s.get("source")),this._exaggeration=s.get("exaggeration");const l=()=>{this.sourceCache.used&&ye(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.
This leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const u=this.getScaledDemTileSize();this.sourceCache.update(n,u,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,l(),this._initializing=!0),l(),n.updateElevation(!0,i),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(n),this._emptyDEMTextureDirty=!0}else this._disable()}resetTileLookupCache(e){this._findCoveringTileCache[e]={}}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_checkRenderCacheEfficiency(){const e=this.renderCacheEfficiency(this._style);this._style.map._optimizeForTerrain||e.efficiency!==100&&ye(`Terrain render cache efficiency is not optimal (${e.efficiency}%) and performance
                may be affected negatively, consider placing all background, fill and line layers before layer
                with id '${e.firstUndrapedLayer}' or create a map using optimizeForTerrain: true option.`)}_onStyleDataEvent(e){e.coord&&e.dataType==="source"?this._clearRenderCacheForTile(e.sourceCacheId,e.coord):e.dataType==="style"&&(this.invalidateRenderCache=!0)}_disable(){if(this.enabled&&(this.enabled=!1,this._sharedDepthStencil=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const e in this._style._sourceCaches)this._style._sourceCaches[e].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this._emptyDepthBufferTexture&&this._emptyDepthBufferTexture.destroy(),this.pool.forEach(e=>e.fb.destroy()),this.pool=[],this._depthFBO&&(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0),this.framebufferCopyTexture&&this.framebufferCopyTexture.destroy()}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this._exaggeration}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const e=2*this.proxySourceCache.getSource().tileSize;return[e,e]}set useVertexMorphing(e){this._useVertexMorphing=e}updateTileBinding(e){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const n=this.proxySourceCache,i=this.painter.transform;this._initializing&&(this._initializing=i._centerAltitude===0&&this.getAtPointOrZero(Un.fromLngLat(i.center),-1)===-1,this._emptyDEMTextureDirty=!this._initializing);const s=this.proxyCoords=n.getIds().map(f=>{const m=n.getTileByID(f).tileID;return m.projMatrix=i.calculateProjMatrix(m.toUnwrapped()),m});(function(f,m){const y=m.transform.pointCoordinate(m.transform.getCameraPoint()),v=new q(y.x,y.y);f.sort((w,S)=>{if(S.overscaledZ-w.overscaledZ)return S.overscaledZ-w.overscaledZ;const E=new q(w.canonical.x+(1<<w.canonical.z)*w.wrap,w.canonical.y),A=new q(S.canonical.x+(1<<S.canonical.z)*S.wrap,S.canonical.y),M=v.mult(1<<w.canonical.z);return M.x-=.5,M.y-=.5,M.distSqr(E)-M.distSqr(A)})})(s,this.painter),this._previousZoom=i.zoom;const l=this.proxyToSource||{};this.proxyToSource={},s.forEach(f=>{this.proxyToSource[f.key]={}}),this.terrainTileForTile={};const u=this._style._sourceCaches;for(const f in u){const m=u[f];if(!m.used||(m!==this.sourceCache&&this.resetTileLookupCache(m.id),this._setupProxiedCoordsForOrtho(m,e[f],l),m.usedForTerrain))continue;const y=e[f];m.getSource().reparseOverscaled&&this._assignTerrainTiles(y)}this.proxiedCoords[n.id]=s.map(f=>new IP(f,f.key,this.orthoMatrix)),this._assignTerrainTiles(s),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(l),this.renderingToTexture=!1,this._updateTimestamp=mn.now();const h={};this._visibleDemTiles=[];for(const f of this.proxyCoords){const m=this.terrainTileForTile[f.key];if(!m)continue;const y=m.tileID.key;y in h||(this._visibleDemTiles.push(m),h[y]=y)}}_assignTerrainTiles(e){this._initializing||e.forEach(n=>{if(this.terrainTileForTile[n.key])return;const i=this._findTileCoveringTileID(n,this.sourceCache);i&&(this.terrainTileForTile[n.key]=i)})}_prepareDEMTextures(){const e=this.painter.context,n=e.gl;for(const i in this.terrainTileForTile){const s=this.terrainTileForTile[i],l=s.dem;!l||s.demTexture&&!s.needsDEMTextureUpload||(e.activeTexture.set(n.TEXTURE1),wP(this.painter,s,l))}}_prepareDemTileUniforms(e,n,i,s){if(!n||n.demTexture==null)return!1;const l=e.tileID.canonical,u=Math.pow(2,n.tileID.canonical.z-l.z),h=s||"";return i[`u_dem_tl${h}`]=[l.x*u%1,l.y*u%1],i[`u_dem_scale${h}`]=u,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}get emptyDepthBufferTexture(){const e=this.painter.context,n=e.gl;if(!this._emptyDepthBufferTexture){const i=new ui({width:1,height:1},Uint8Array.of(255,255,255,255));this._emptyDepthBufferTexture=new Ai(e,i,n.RGBA,{premultiply:!1})}return this._emptyDepthBufferTexture}_getLoadedAreaMinimum(){let e=0;const n=this._visibleDemTiles.reduce((i,s)=>{if(!s.dem)return i;const l=s.dem.tree.minimums[0];return l>0&&e++,i+l},0);return e?n/e:0}_updateEmptyDEMTexture(){const e=this.painter.context,n=e.gl;e.activeTexture.set(n.TEXTURE2);const i=this._getLoadedAreaMinimum(),s=new ui({width:1,height:1},new Uint8Array(bm.pack(i,this.sourceCache.getSource().encoding)));this._emptyDEMTextureDirty=!1;let l=this._emptyDEMTexture;return l?l.update(s,{premultiply:!1}):l=this._emptyDEMTexture=new Ai(e,s,n.RGBA,{premultiply:!1}),l}setupElevationDraw(e,n,i){const s=this.painter.context,l=s.gl,u=(h=this.sourceCache.getSource().encoding,{u_dem:2,u_dem_prev:4,u_dem_unpack:bm.getUnpackVector(h),u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_exaggeration:0});var h;u.u_dem_size=this.sourceCache.getSource().tileSize,u.u_exaggeration=this.exaggeration();let f=null,m=null,y=1;if(i&&i.morphing&&this._useVertexMorphing){const v=i.morphing.srcDemTile,w=i.morphing.dstDemTile;y=i.morphing.phase,v&&w&&(this._prepareDemTileUniforms(e,v,u,"_prev")&&(m=v),this._prepareDemTileUniforms(e,w,u)&&(f=w))}if(m&&f?(s.activeTexture.set(l.TEXTURE2),f.demTexture.bind(l.NEAREST,l.CLAMP_TO_EDGE),s.activeTexture.set(l.TEXTURE4),m.demTexture.bind(l.NEAREST,l.CLAMP_TO_EDGE),u.u_dem_lerp=y):(f=this.terrainTileForTile[e.tileID.key],s.activeTexture.set(l.TEXTURE2),(this._prepareDemTileUniforms(e,f,u)?f.demTexture:this.emptyDEMTexture).bind(l.NEAREST,l.CLAMP_TO_EDGE)),s.activeTexture.set(l.TEXTURE3),i&&i.useDepthForOcclusion?(this._depthTexture&&this._depthTexture.bind(l.NEAREST,l.CLAMP_TO_EDGE),this._depthFBO&&(u.u_depth_size_inv=[1/this._depthFBO.width,1/this._depthFBO.height])):(this.emptyDepthBufferTexture.bind(l.NEAREST,l.CLAMP_TO_EDGE),u.u_depth_size_inv=[1,1]),i&&i.useMeterToDem&&f){const v=(1<<f.tileID.canonical.z)*mr(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;u.u_meter_to_dem=v}if(i&&i.labelPlaneMatrixInv&&(u.u_label_plane_matrix_inv=i.labelPlaneMatrixInv),n.setTerrainUniformValues(s,u),this.painter.transform.projection.name==="globe"){const v=this.globeUniformValues(this.painter.transform,e.tileID.canonical,i&&i.useDenormalizedUpVectorScale);n.setGlobeUniformValues(s,v)}}globeUniformValues(e,n,i){const s=e.projection;return{u_tile_tl_up:s.upVector(n,0,0),u_tile_tr_up:s.upVector(n,Ge,0),u_tile_br_up:s.upVector(n,Ge,Ge),u_tile_bl_up:s.upVector(n,0,Ge),u_tile_up_scale:i?b1(1):s.upVectorScale(n,e.center.lat,e.worldSize).metersToTile}}renderToBackBuffer(e){const n=this.painter,i=this.painter.context;e.length!==0&&(i.bindFramebuffer.set(null),i.viewport.set([0,0,n.width,n.height]),n.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(s,l,u,h,f){if(s.transform.projection.name==="globe")(function(m,y,v,w,S){const E=m.context,A=E.gl;let M,k;const R=m.transform,L=o3(m,E,R),z=le=>{if(k===le)return;const oe=[CP[le],"PROJECTION_GLOBE_VIEW"];L&&oe.push("CUSTOM_ANTIALIASING"),M=m.useProgram("globeRaster",null,oe),k=le},B=m.colorModeForRenderPass(),j=new _n(A.LEQUAL,_n.ReadWrite,m.depthRangeFor3D);Bm.update(S);const V=function(le){const oe=le.pixelsPerMeter,Ee=oe/mr(1,le.center.lat),xe=Me.identity(new Float64Array(16));return Me.translate(xe,xe,[le.point.x,le.point.y,0]),Me.scale(xe,xe,[Ee,Ee,oe]),Float32Array.from(xe)}(R),Y=[io(R.center.lng),co(R.center.lat)],ne=m.globeSharedBuffers,re=[R.width*mn.devicePixelRatio,R.height*mn.devicePixelRatio],J=Float32Array.from(R.globeMatrix),ae={useDenormalizedUpVectorScale:!0};{const le=m.transform,oe=AP(le.zoom,y.exaggeration(),y.sourceCache._source.tileSize);k=-1;const Ee=A.TRIANGLES;for(const xe of w){const Pe=v.getTile(xe),pe=Nn.disabled,Ae=y.prevTerrainTileForTile[xe.key],Le=y.terrainTileForTile[xe.key];TP(Ae,Le)&&Bm.newMorphing(xe.key,Ae,Le,S,250),E.activeTexture.set(A.TEXTURE0),Pe.texture.bind(A.LINEAR,A.CLAMP_TO_EDGE);const qe=Bm.getMorphValuesForProxy(xe.key),Ve=qe?1:0;qe&&os(ae,{morphing:{srcDemTile:qe.from,dstDemTile:qe.to,phase:zt(qe.phase)}});const yt=S1(xe.canonical),mt=WB(yt.getCenter().lat),lt=qB(xe.canonical,yt,mt,le.worldSize/le._pixelsPerMercatorPixel),ft=pm(ml(xe.canonical)),Mt=EP(le.projMatrix,J,V,ft,ro(le.zoom),Y,le.frustumCorners.TL,le.frustumCorners.TR,le.frustumCorners.BR,le.frustumCorners.BL,le.globeCenterInViewSpace,le.globeRadius,re,oe,lt);if(z(Ve),M&&(y.setupElevationDraw(Pe,M,ae),m.uploadCommonUniforms(E,M,xe.toUnwrapped()),ne)){const[Zt,Gt,Ut]=ne.getGridBuffers(mt,oe!==0);M.draw(m,Ee,j,pe,B,Vn.backCCW,Mt,"globe_raster",Zt,Gt,Ut)}}}if(ne){const le=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];L&&le.push("CUSTOM_ANTIALIASING"),M=m.useProgram("globeRaster",null,le);for(const oe of w){const{x:Ee,y:xe,z:Pe}=oe.canonical,pe=xe===0,Ae=xe===(1<<Pe)-1,[Le,qe,Ve,yt]=ne.getPoleBuffers(Pe);if(yt&&(pe||Ae)){const mt=v.getTile(oe);E.activeTexture.set(A.TEXTURE0),mt.texture.bind(A.LINEAR,A.CLAMP_TO_EDGE);let lt=HB(Pe,Ee,R);const ft=pm(ml(oe.canonical)),Mt=(Zt,Gt)=>Zt.draw(m,A.TRIANGLES,j,Nn.disabled,B,Vn.disabled,EP(R.projMatrix,lt,lt,ft,0,Y,R.frustumCorners.TL,R.frustumCorners.TR,R.frustumCorners.BR,R.frustumCorners.BL,R.globeCenterInViewSpace,R.globeRadius,re,0),"globe_pole_raster",Gt,Ve,yt);y.setupElevationDraw(mt,M,ae),m.uploadCommonUniforms(E,M,oe.toUnwrapped()),pe&&Mt(M,Le),Ae&&(lt=Me.scale(Me.create(),lt,[1,-1,1]),Mt(M,qe))}}}})(s,l,u,h,f);else{const m=s.context,y=m.gl;let v,w;const S=s.shadowRenderer,E=z=>{w!==z&&(v=s.useProgram("terrainRaster",null,[CP[z]]),w=z)},A=s.colorModeForRenderPass(),M=new _n(y.LEQUAL,_n.ReadWrite,s.depthRangeFor3D);Bm.update(f);const k=s.transform,R=AP(k.zoom,l.exaggeration(),l.sourceCache._source.tileSize);let L=[0,0,0];if(S){const z=s.style.directionalLight,B=s.style.ambientLight;z&&B&&(L=vE(z,B))}{w=-1;const z=y.TRIANGLES,[B,j]=[l.gridIndexBuffer,l.gridSegments];for(const V of h){const Y=u.getTile(V),ne=Nn.disabled,re=l.prevTerrainTileForTile[V.key],J=l.terrainTileForTile[V.key];TP(re,J)&&Bm.newMorphing(V.key,re,J,f,250),m.activeTexture.set(y.TEXTURE0),Y.texture.bind(y.LINEAR,y.CLAMP_TO_EDGE,y.LINEAR_MIPMAP_NEAREST);const ae=Bm.getMorphValuesForProxy(V.key),le=ae?1:0;let oe;ae&&(oe={morphing:{srcDemTile:ae.from,dstDemTile:ae.to,phase:zt(ae.phase)}});const Ee=SP(V.projMatrix,dU(V.canonical,k.renderWorldCopies)?R/10:R,L);if(E(le),!v)continue;l.setupElevationDraw(Y,v,oe);const xe=V.toUnwrapped();S&&S.setupShadows(xe,v),s.uploadCommonUniforms(m,v,xe),v.draw(s,z,M,ne,A,Vn.backCCW,Ee,"terrain_raster",l.gridBuffer,B,j)}}}}(n,this,this.proxySourceCache,e,this._updateTimestamp),this.renderingToTexture=!0,n.gpuTimingDeferredRenderEnd(),e.splice(0,e.length))}renderBatch(e){if(this._drapedRenderBatches.length===0)return e+1;this.renderingToTexture=!0;const n=this.painter,i=this.painter.context,s=this.proxySourceCache,l=this.proxiedCoords[s.id],u=this._drapedRenderBatches.shift(),h=n.style.order,f=[];let m=0;for(const y of l){const v=s.getTileByID(y.proxyTileKey),w=s.proxyCachedFBO[y.key]?s.proxyCachedFBO[y.key][e]:void 0,S=w!==void 0?s.renderCache[w]:this.pool[m++],E=w!==void 0;if(v.texture=S.tex,E&&!S.dirty){f.push(v.tileID);continue}let A;i.bindFramebuffer.set(S.fb.framebuffer),this.renderedToTile=!1,S.dirty&&(i.clear({color:wn.transparent,stencil:0}),S.dirty=!1);for(let M=u.start;M<=u.end;++M){const k=n.style._layers[h[M]];if(k.isHidden(n.transform.zoom))continue;const R=n.style._getLayerSourceCache(k),L=R?this.proxyToSource[y.key][R.id]:[y];if(!L)continue;const z=L;i.viewport.set([0,0,S.fb.width,S.fb.height]),A!==(R?R.id:null)&&(this._setupStencil(S,L,k,R),A=R?R.id:null),n.renderLayer(n,R,k,z)}if(this._drapedRenderBatches.length===0)for(const M of this._pendingGroundEffectLayers){const k=n.style._layers[h[M]];if(k.isHidden(n.transform.zoom))continue;const R=n.style._getLayerSourceCache(k),L=R?this.proxyToSource[y.key][R.id]:[y];if(!L)continue;const z=L;i.viewport.set([0,0,S.fb.width,S.fb.height]),A!==(R?R.id:null)&&(this._setupStencil(S,L,k,R),A=R?R.id:null),n.renderLayer(n,R,k,z)}this.renderedToTile?(S.dirty=!0,f.push(v.tileID)):E||--m,m===5&&(m=0,this.renderToBackBuffer(f))}return this.renderToBackBuffer(f),this.renderingToTexture=!1,i.bindFramebuffer.set(null),i.viewport.set([0,0,n.width,n.height]),u.end+1}postRender(){}renderCacheEfficiency(e){const n=e.order.length;if(n===0)return{efficiency:100};let i,s=0,l=0,u=!1;for(let h=0;h<n;++h){const f=e._layers[e.order[h]];this._style.isLayerDraped(f)?(u&&++s,++l):u||(u=!0,i=f.id)}return l===0?{efficiency:100}:{efficiency:100*(1-s/l),firstUndrapedLayer:i}}getMinElevationBelowMSL(){let e=0;return this._visibleDemTiles.filter(n=>n.dem).forEach(n=>{e=Math.min(e,n.dem.tree.minimums[0])}),e===0?e:(e-30)*this._exaggeration}raycast(e,n,i){if(!this._visibleDemTiles)return null;const s=this._visibleDemTiles.filter(l=>l.dem).map(l=>{const u=l.tileID,h=1<<u.overscaledZ,{x:f,y:m}=u.canonical,y=f/h,v=(f+1)/h,w=m/h,S=(m+1)/h;return{minx:y,miny:w,maxx:v,maxy:S,t:l.dem.tree.raycastRoot(y,w,v,S,e,n,i),tile:l}});s.sort((l,u)=>(l.t!==null?l.t:Number.MAX_VALUE)-(u.t!==null?u.t:Number.MAX_VALUE));for(const l of s){if(l.t==null)return null;const u=l.tile.dem.tree.raycast(l.minx,l.miny,l.maxx,l.maxy,e,n,i);if(u!=null)return u}return null}_createFBO(){const e=this.painter.context,n=e.gl,i=this.drapeBufferSize;e.activeTexture.set(n.TEXTURE0);const s=new Ai(e,{width:i[0],height:i[1],data:null},n.RGBA);s.bind(n.LINEAR,n.CLAMP_TO_EDGE);const l=e.createFramebuffer(i[0],i[1],!0,null);return l.colorAttachment.set(s.texture),l.depthAttachment=new k8(e,l.framebuffer),this._sharedDepthStencil===void 0?(this._sharedDepthStencil=e.createRenderbuffer(e.gl.DEPTH_STENCIL,i[0],i[1]),this._stencilRef=0,l.depthAttachment.set(this._sharedDepthStencil),e.clear({stencil:0})):l.depthAttachment.set(this._sharedDepthStencil),e.extTextureFilterAnisotropic&&!e.extTextureFilterAnisotropicForceOff&&n.texParameterf(n.TEXTURE_2D,e.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,e.extTextureFilterAnisotropicMax),{fb:l,tex:s,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._style.light&&this._style.light.hasTransition())return!0;for(const e in this._style._sourceCaches)if(this._style._sourceCaches[e].hasTransition())return!0;return this._style.order.some(e=>{const n=this._style._layers[e],i=n.isHidden(this.painter.transform.zoom);return n.type==="custom"?!i&&n.shouldRedrape():!i&&n.hasTransition()})}_clearLineLayersFromRenderCache(){let e=!1;for(const i of this._style._getSources())if(i instanceof Bk){e=!0;break}if(!e)return;const n={};for(let i=0;i<this._style.order.length;++i){const s=this._style._layers[this._style.order[i]],l=this._style._getLayerSourceCache(s);if(l&&!n[l.id]&&!s.isHidden(this.painter.transform.zoom)&&s.type==="line"&&s.widthExpression()instanceof Ld){n[l.id]=!0;for(const u of this.proxyCoords){const h=this.proxyToSource[u.key][l.id];if(h)for(const f of h)this._clearRenderCacheForTile(l.id,f)}}}}_clearRasterLayersFromRenderCache(){let e=!1;for(const i in this._style._sourceCaches)if(this._style._sourceCaches[i]._source instanceof D_){e=!0;break}if(!e)return;const n={};for(let i=0;i<this._style.order.length;++i){const s=this._style._layers[this._style.order[i]],l=this._style._getLayerSourceCache(s);if(!l||n[l.id]||s.isHidden(this.painter.transform.zoom)||s.type!=="raster")continue;const u=s.paint.get("raster-fade-duration");for(const h of this.proxyCoords){const f=this.proxyToSource[h.key][l.id];if(f)for(const m of f){const y=MP(l.getTile(m),l.findLoadedParent(m,0),l,this.painter.transform,u);(y.opacity!==1||y.mix!==0)&&this._clearRenderCacheForTile(l.id,m)}}}}_setupDrapedRenderBatches(){const e=this._style.order,n=e.length;if(n===0)return;const i=[];this._pendingGroundEffectLayers=[];let s,l=0,u=this._style._layers[e[l]];for(;!this._style.isLayerDraped(u)&&u.isHidden(this.painter.transform.zoom)&&++l<n;)u=this._style._layers[e[l]];for(;l<n;++l){const h=this._style._layers[e[l]];h.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(h)?s===void 0&&(s=l):(h.type==="fill-extrusion"&&this._pendingGroundEffectLayers.push(l),s!==void 0&&(i.push({start:s,end:l-1}),s=void 0)))}if(s!==void 0&&i.push({start:s,end:l-1}),i.length!==0){const h=i[i.length-1];this._pendingGroundEffectLayers.every(m=>m>h.end)||ye("fill-extrusion with flood lighting and/or ground ambient occlusion should be moved to be on top of all draped layers.")}this._drapedRenderBatches=i}_setupRenderCache(e){const n=this.proxySourceCache;if(this._shouldDisableRenderCache()||this.invalidateRenderCache){if(this.invalidateRenderCache=!1,n.renderCache.length>n.renderCachePool.length){const u=Object.values(n.proxyCachedFBO);n.proxyCachedFBO={};for(let h=0;h<u.length;++h){const f=Object.values(u[h]);n.renderCachePool.push(...f)}}return}this._clearRasterLayersFromRenderCache();const i=this.proxyCoords,s=this._tilesDirty;for(let u=i.length-1;u>=0;u--){const h=i[u];if(n.getTileByID(h.key),n.proxyCachedFBO[h.key]!==void 0){const f=e[h.key],m=this.proxyToSource[h.key];let y=0;for(const v in m){const w=m[v],S=f[v];if(!S||S.length!==w.length||w.some((E,A)=>E!==S[A]||s[v]&&s[v].hasOwnProperty(E.key))){y=-1;break}++y}for(const v in n.proxyCachedFBO[h.key])n.renderCache[n.proxyCachedFBO[h.key][v]].dirty=y<0||y!==Object.values(f).length}}const l=[...this._drapedRenderBatches];l.sort((u,h)=>h.end-h.start-(u.end-u.start));for(const u of l)for(const h of i){if(n.proxyCachedFBO[h.key])continue;let f=n.renderCachePool.pop();f===void 0&&n.renderCache.length<50&&(f=n.renderCache.length,n.renderCache.push(this._createFBO())),f!==void 0&&(n.proxyCachedFBO[h.key]={},n.proxyCachedFBO[h.key][u.start]=f,n.renderCache[f].dirty=!0)}this._tilesDirty={}}_setupStencil(e,n,i,s){if(!s||!this._sourceTilesOverlap[s.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const l=this.painter.context,u=l.gl;if(n.length<=1)return void(this._overlapStencilType=!1);let h;if(i.isTileClipped())h=n.length,this._overlapStencilMode.test={func:u.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(n[0].overscaledZ>n[n.length-1].overscaledZ))return void(this._overlapStencilType=!1);h=1,this._overlapStencilMode.test={func:u.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+h>255&&(l.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=h,this._overlapStencilMode.ref=this._stencilRef,i.isTileClipped()&&this._renderTileClippingMasks(n,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return this._overlapStencilType==="Clip"||this._overlapStencilType==="Mask"}stencilModeForRTTOverlap(e){return this.renderingToTexture&&this._overlapStencilType?(this._overlapStencilType==="Clip"&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[e.key]),this._overlapStencilMode):Nn.disabled}_renderTileClippingMasks(e,n){const i=this.painter,s=this.painter.context,l=s.gl;i._tileClippingMaskIDs={},s.setColorMode(ur.disabled),s.setDepthMode(_n.disabled);const u=i.useProgram("clippingMask");for(const h of e){const f=i._tileClippingMaskIDs[h.key]=--n;u.draw(i,l.TRIANGLES,_n.disabled,new Nn({func:l.ALWAYS,mask:0},f,255,l.KEEP,l.KEEP,l.REPLACE),ur.disabled,Vn.disabled,xE(h.projMatrix),"$clipping",i.tileExtentBuffer,i.quadTriangleIndexBuffer,i.tileExtentSegments)}}pointCoordinate(e){const n=this.painter.transform;if(e.x<0||e.x>n.width||e.y<0||e.y>n.height)return null;const i=[e.x,e.y,1,1];xr.transformMat4(i,i,n.pixelMatrixInverse),xr.scale(i,i,1/i[3]),i[0]/=n.worldSize,i[1]/=n.worldSize;const s=n._camera.position,l=mr(1,n.center.lat),u=[s[0],s[1],s[2]/l,0],h=fe.subtract([],i.slice(0,3),u);fe.normalize(h,h);const f=this.raycast(u,h,this._exaggeration);return f!==null&&f?(fe.scaleAndAdd(u,u,h,f),u[3]=u[2],u[2]*=l,u):null}drawDepth(){const e=this.painter,n=e.context,i=this.proxySourceCache,s=Math.ceil(e.width),l=Math.ceil(e.height);if(!this._depthFBO||this._depthFBO.width===s&&this._depthFBO.height===l||(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0),!this._depthFBO){const u=n.gl,h=n.createFramebuffer(s,l,!0,"renderbuffer");n.activeTexture.set(u.TEXTURE0);const f=new Ai(n,{width:s,height:l,data:null},u.RGBA);f.bind(u.NEAREST,u.CLAMP_TO_EDGE),h.colorAttachment.set(f.texture);const m=n.createRenderbuffer(n.gl.DEPTH_COMPONENT16,s,l);h.depthAttachment.set(m),this._depthFBO=h,this._depthTexture=f}n.bindFramebuffer.set(this._depthFBO.framebuffer),n.viewport.set([0,0,s,l]),function(u,h,f,m){if(u.transform.projection.name==="globe")return;const y=u.context,v=y.gl;y.clear({depth:1});const w=u.useProgram("terrainDepth"),S=new _n(v.LESS,_n.ReadWrite,u.depthRangeFor3D);for(const E of m){const A=f.getTile(E),M=SP(E.projMatrix,0,[0,0,0]);h.setupElevationDraw(A,w),w.draw(u,v.TRIANGLES,S,Nn.disabled,ur.unblended,Vn.backCCW,M,"terrain_depth",h.gridBuffer,h.gridIndexBuffer,h.gridNoSkirtSegments)}}(e,this,i,this.proxyCoords)}_setupProxiedCoordsForOrtho(e,n,i){if(e.getSource()instanceof pf)return this._setupProxiedCoordsForImageSource(e,n,i);this._findCoveringTileCache[e.id]=this._findCoveringTileCache[e.id]||{};const s=this.proxiedCoords[e.id]=[],l=this.proxyCoords;for(let h=0;h<l.length;h++){const f=l[h],m=this._findTileCoveringTileID(f,e);if(m){const y=this._createProxiedId(f,m,i[f.key]&&i[f.key][e.id]);s.push(y),this.proxyToSource[f.key][e.id]=[y]}}let u=!1;for(let h=0;h<n.length;h++){const f=e.getTile(n[h]);if(!f||!f.hasData())continue;const m=this._findTileCoveringTileID(f.tileID,this.proxySourceCache);if(m&&m.tileID.canonical.z!==f.tileID.canonical.z){const y=this.proxyToSource[m.tileID.key][e.id],v=this._createProxiedId(m.tileID,f,i[m.tileID.key]&&i[m.tileID.key][e.id]);y?y.splice(y.length-1,0,v):this.proxyToSource[m.tileID.key][e.id]=[v],s.push(v),u=!0}}this._sourceTilesOverlap[e.id]=u}_setupProxiedCoordsForImageSource(e,n,i){if(!e.getSource().loaded())return;const s=this.proxiedCoords[e.id]=[],l=this.proxyCoords,u=e.getSource(),h=new q(u.tileID.x,u.tileID.y)._div(1<<u.tileID.z),f=u.coordinates.map(Un.fromLngLat).reduce((y,v)=>(y.min.x=Math.min(y.min.x,v.x-h.x),y.min.y=Math.min(y.min.y,v.y-h.y),y.max.x=Math.max(y.max.x,v.x-h.x),y.max.y=Math.max(y.max.y,v.y-h.y),y),{min:new q(Number.MAX_VALUE,Number.MAX_VALUE),max:new q(-Number.MAX_VALUE,-Number.MAX_VALUE)}),m=(y,v)=>{const w=y.wrap+y.canonical.x/(1<<y.canonical.z),S=y.canonical.y/(1<<y.canonical.z),E=Ge/(1<<y.canonical.z),A=v.wrap+v.canonical.x/(1<<v.canonical.z),M=v.canonical.y/(1<<v.canonical.z);return w+E<A+f.min.x||w>A+f.max.x||S+E<M+f.min.y||S>M+f.max.y};for(let y=0;y<l.length;y++){const v=l[y];for(let w=0;w<n.length;w++){const S=e.getTile(n[w]);if(!S||!S.hasData()||m(v,S.tileID))continue;const E=this._createProxiedId(v,S,i[v.key]&&i[v.key][e.id]),A=this.proxyToSource[v.key][e.id];A?A.push(E):this.proxyToSource[v.key][e.id]=[E],s.push(E)}}}_createProxiedId(e,n,i){let s=this.orthoMatrix;if(i){const l=i.find(u=>u.key===n.tileID.key);if(l)return l}if(n.tileID.key!==e.key){const l=e.canonical.z-n.tileID.canonical.z;let u,h,f;s=Me.create();const m=n.tileID.wrap-e.wrap<<e.overscaledZ;l>0?(u=Ge>>l,h=u*((n.tileID.canonical.x<<l)-e.canonical.x+m),f=u*((n.tileID.canonical.y<<l)-e.canonical.y)):(u=Ge<<-l,h=Ge*(n.tileID.canonical.x-(e.canonical.x+m<<-l)),f=Ge*(n.tileID.canonical.y-(e.canonical.y<<-l))),Me.ortho(s,0,u,0,u,0,1),Me.translate(s,s,[h,f,0])}return new IP(n.tileID,e.key,s)}_findTileCoveringTileID(e,n){let i=n.getTile(e);if(i&&i.hasData())return i;const s=this._findCoveringTileCache[n.id],l=s[e.key];if(i=l?n.getTileByID(l):null,i&&i.hasData()||l===null)return i;let u=i?i.tileID:e,h=u.overscaledZ;const f=n.getSource().minzoom,m=[];if(!l){const v=n.getSource().maxzoom;if(e.canonical.z>=v){const w=e.canonical.z-v;n.getSource().reparseOverscaled?(h=Math.max(e.canonical.z+2,n.transform.tileZoom),u=new Ir(h,e.wrap,v,e.canonical.x>>w,e.canonical.y>>w)):w!==0&&(h=v,u=new Ir(h,e.wrap,v,e.canonical.x>>w,e.canonical.y>>w))}u.key!==e.key&&(m.push(u.key),i=n.getTile(u))}const y=v=>{m.forEach(w=>{s[w]=v}),m.length=0};for(h-=1;h>=f&&(!i||!i.hasData());h--){i&&y(i.tileID.key);const v=u.calculateScaledKey(h);if(i=n.getTileByID(v),i&&i.hasData())break;const w=s[v];if(w===null)break;w===void 0?m.push(v):i=n.getTileByID(w)}return y(i?i.tileID.key:null),i&&i.hasData()?i:null}findDEMTileFor(e){return this.enabled?this._findTileCoveringTileID(e,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(e,n){let i=this._tilesDirty[e];i||(i=this._tilesDirty[e]={}),i[n.key]=!0}}function gU(t,e,n){const i=function(h,f,m){const y=fe.dot(f,h),v=fe.dot(m,[.2126,.7152,.0722]),w=(E,A,M)=>(1-M)*E+M*A,S=w(1-.3*Math.min(v,1),1,Math.min(y+1,1));return w(.92,1,Math.asin(ce(f[2],-1,1))/Math.PI+.5)*S}(t,[0,0,1],e),s=[0,0,0];fe.scale(s,n.slice(0,3),i);const l=[0,0,0];fe.scale(l,e.slice(0,3),t[2]);const u=[0,0,0];return fe.add(u,s,l),dr(u)}const yU=["fill","fillOutline","fillPattern","line","linePattern","background","backgroundPattern","hillshade","raster"],_U=["stars","fillExtrusion","fillExtrusionGroundEffect","model","symbolSDF","symbolIcon","symbolTextAndIcon"];class kP{static cacheKey(e,n,i,s){let l=`${n}${s?s.cacheKey:""}`;for(const u of i)e.usedDefines.includes(u)&&(l+=`/${u}`);return l}constructor(e,n,i,s,l,u){const h=e.gl;this.program=h.createProgram(),this.configuration=s,this.name=n,this.fixedDefines=[...u];const f=function(k){const R=[];for(let L=0;L<k.length;L++){if(k[L]===null)continue;const z=k[L].split(" ");R.push(z.pop())}return R}(i.staticAttributes),m=s?s.getBinderAttributes():[],y=f.concat(m);let v=s?s.defines():[];v=v.concat(u.map(k=>`#define ${k}`));const w=e.isWebGL2?`#version 300 es
`:"",S=w+v.concat(e.extStandardDerivatives&&w.length===0?`#extension GL_OES_standard_derivatives : enable
`.concat(_E):_E,_E,_P,vP,yP.fragmentSource,gE.fragmentSource,yE.fragmentSource,i.fragmentSource).join(`
`),E=w+v.concat(`
#ifdef GL_ES
precision highp float;
#else

#if !defined(lowp)
#define lowp
#endif

#if !defined(mediump)
#define mediump
#endif

#if !defined(highp)
#define highp
#endif

#endif`,_P,vP,yP.vertexSource,gE.vertexSource,yE.vertexSource,gP.vertexSource,i.vertexSource).join(`
`),A=h.createShader(h.FRAGMENT_SHADER);if(h.isContextLost())return void(this.failedToCreate=!0);h.shaderSource(A,S),h.compileShader(A),h.attachShader(this.program,A);const M=h.createShader(h.VERTEX_SHADER);if(h.isContextLost())this.failedToCreate=!0;else{h.shaderSource(M,E),h.compileShader(M),h.attachShader(this.program,M),this.attributes={},this.numAttributes=y.length;for(let k=0;k<this.numAttributes;k++)if(y[k]){const R=y[k].startsWith("a_")?y[k]:`a_${y[k]}`;h.bindAttribLocation(this.program,k,R),this.attributes[R]=k}h.linkProgram(this.program),h.deleteShader(M),h.deleteShader(A),this.fixedUniforms=l(e),this.binderUniforms=s?s.getUniforms(e):[],u.includes("TERRAIN")&&(this.terrainUniforms=(k=>({u_dem:new Sn(k),u_dem_prev:new Sn(k),u_dem_unpack:new Ko(k),u_dem_tl:new En(k),u_dem_scale:new pt(k),u_dem_tl_prev:new En(k),u_dem_scale_prev:new pt(k),u_dem_size:new pt(k),u_dem_lerp:new pt(k),u_exaggeration:new pt(k),u_depth:new Sn(k),u_depth_size_inv:new En(k),u_meter_to_dem:new pt(k),u_label_plane_matrix_inv:new gn(k)}))(e)),u.includes("GLOBE")&&(this.globeUniforms=(k=>({u_tile_tl_up:new fn(k),u_tile_tr_up:new fn(k),u_tile_br_up:new fn(k),u_tile_bl_up:new fn(k),u_tile_up_scale:new pt(k)}))(e)),u.includes("FOG")&&(this.fogUniforms=(k=>({u_fog_matrix:new gn(k),u_fog_range:new En(k),u_fog_color:new Ko(k),u_fog_horizon_blend:new pt(k),u_fog_temporal_offset:new pt(k),u_frustum_tl:new fn(k),u_frustum_tr:new fn(k),u_frustum_br:new fn(k),u_frustum_bl:new fn(k),u_globe_pos:new fn(k),u_globe_radius:new pt(k),u_globe_transition:new pt(k),u_is_globe:new Sn(k),u_viewport:new En(k)}))(e)),u.includes("LIGHTING_3D_MODE")&&(this.lightsUniforms=(k=>({u_lighting_ambient_color:new fn(k),u_lighting_directional_dir:new fn(k),u_lighting_directional_color:new fn(k),u_ground_radiance:new fn(k)}))(e)),u.includes("RENDER_SHADOWS")&&(this.shadowUniforms=(k=>({u_light_matrix_0:new gn(k),u_light_matrix_1:new gn(k),u_fade_range:new En(k),u_shadow_normal_offset:new fn(k),u_shadow_intensity:new pt(k),u_texel_size:new pt(k),u_shadow_direction:new fn(k),u_shadow_bias:new fn(k),u_shadowmap_0:new Sn(k),u_shadowmap_1:new Sn(k)}))(e))}}setTerrainUniformValues(e,n){if(!this.terrainUniforms)return;const i=this.terrainUniforms;if(!this.failedToCreate){e.program.set(this.program);for(const s in n)i[s]&&i[s].set(this.program,s,n[s])}}setGlobeUniformValues(e,n){if(!this.globeUniforms)return;const i=this.globeUniforms;if(!this.failedToCreate){e.program.set(this.program);for(const s in n)i[s]&&i[s].set(this.program,s,n[s])}}setFogUniformValues(e,n){if(!this.fogUniforms)return;const i=this.fogUniforms;if(!this.failedToCreate){e.program.set(this.program);for(const s in n)i[s].set(this.program,s,n[s])}}setLightsUniformValues(e,n){if(!this.lightsUniforms)return;const i=this.lightsUniforms;if(!this.failedToCreate){e.program.set(this.program);for(const s in n)i[s].set(this.program,s,n[s])}}setShadowUniformValues(e,n){if(this.failedToCreate||!this.shadowUniforms)return;const i=this.shadowUniforms;e.program.set(this.program);for(const s in n)i[s].set(this.program,s,n[s])}_drawDebugWireframe(e,n,i,s,l,u,h,f,m){const y=e.options.wireframe;if(y.terrain===!1&&y.layers2D===!1&&y.layers3D===!1)return;const v=e.context;if(!v.isWebGL2||!(()=>!(!y.terrain||this.name!=="terrainRaster"&&this.name!=="globeRaster")||!(!y.layers2D||e._terrain&&e._terrain.renderingToTexture||!yU.includes(this.name))||!(!y.layers3D||!_U.includes(this.name)))())return;const w=v.gl,S=e.wireframeDebugCache.getLinesFromTrianglesBuffer(e.frameCounter,l,v);if(!S)return;const E=[...this.fixedDefines];E.push("DEBUG_WIREFRAME");const A=e.useProgram(this.name,this.configuration,E);v.program.set(A.program);const M=(k,R,L)=>{if(R[k]&&L[k])for(const z in R[k])L[k][z]&&L[k][z].set(L.program,z,R[k][z].current)};m&&m.setUniforms(A.program,v,A.binderUniforms,h,{zoom:f}),M("fixedUniforms",this,A),M("terrainUniforms",this,A),M("globeUniforms",this,A),M("fogUniforms",this,A),M("lightsUniforms",this,A),M("shadowUniforms",this,A),S.bind(),v.setColorMode(new ur([w.ONE,w.ONE_MINUS_SRC_ALPHA,w.ZERO,w.ONE],wn.transparent,[!0,!0,!0,!1])),v.setDepthMode(new _n(n.func===w.LESS?w.LEQUAL:n.func,_n.ReadOnly,n.range)),v.setStencilMode(Nn.disabled),w.drawElements(w.LINES,3*u.primitiveLength*2,w.UNSIGNED_SHORT,3*u.primitiveOffset*2*2),l.bind(),v.program.set(this.program),v.setDepthMode(n),v.setStencilMode(i),v.setColorMode(s)}draw(e,n,i,s,l,u,h,f,m,y,v,w,S,E,A,M){const k=e.context,R=k.gl;if(this.failedToCreate)return;k.program.set(this.program),k.setDepthMode(i),k.setStencilMode(s),k.setColorMode(l),k.setCullFace(u);for(const z of Object.keys(this.fixedUniforms))this.fixedUniforms[z].set(this.program,z,h[z]);E&&E.setUniforms(this.program,k,this.binderUniforms,w,{zoom:S});const L={[R.LINES]:2,[R.TRIANGLES]:3,[R.LINE_STRIP]:1}[n];for(const z of v.get()){const B=z.vaos||(z.vaos={});(B[f]||(B[f]=new sU)).bind(k,this,m,E?E.getPaintVertexBuffers():[],y,z.vertexOffset,A||[]),k.isWebGL2&&M&&M>1?R.drawElementsInstanced(n,z.primitiveLength*L,R.UNSIGNED_SHORT,z.primitiveOffset*L*2,M):R.drawElements(n,z.primitiveLength*L,R.UNSIGNED_SHORT,z.primitiveOffset*L*2),n===R.TRIANGLES&&this._drawDebugWireframe(e,i,s,l,y,z,w,S,E)}}}function PP(t,e){const n=Math.pow(2,e.tileID.overscaledZ),i=e.tileSize*Math.pow(2,t.transform.tileZoom)/n,s=i*(e.tileID.canonical.x+e.tileID.wrap*n),l=i*e.tileID.canonical.y;return{u_image:0,u_texsize:e.imageAtlasTexture.size,u_tile_units_to_pixels:1/df(e,1,t.transform.tileZoom),u_pixel_coord_upper:[s>>16,l>>16],u_pixel_coord_lower:[65535&s,65535&l]}}const vU=Me.create(),RP=(t,e,n,i,s,l,u,h,f,m,y,v,w,S,E)=>{const A=e.style.light,M=A.properties.get("position"),k=[M.x,M.y,M.z],R=gs.create();A.properties.get("anchor")==="viewport"&&(gs.fromRotation(R,-e.transform.angle),fe.transformMat3(k,k,R));const L=A.properties.get("color"),z=e.transform,B={u_matrix:t,u_lightpos:k,u_lightintensity:A.properties.get("intensity"),u_lightcolor:[L.r,L.g,L.b],u_vertical_gradient:+n,u_opacity:i,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:vU,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_ao:s,u_edge_radius:l,u_flood_light_color:v,u_vertical_scale:w,u_flood_light_intensity:S,u_ground_shadow_factor:E};return z.projection.name==="globe"&&(B.u_tile_id=[u.canonical.x,u.canonical.y,1<<u.canonical.z],B.u_zoom_transition=f,B.u_inv_rot_matrix=y,B.u_merc_center=m,B.u_up_dir=z.projection.upVector(new rc(0,0,0),m[0]*Ge,m[1]*Ge),B.u_height_lift=h),B},xU=(t,e,n)=>({u_matrix:t,u_edge_radius:e,u_vertical_scale:n}),wU=(t,e,n,i,s,l,u,h,f,m,y,v,w,S)=>{const E=RP(t,e,n,i,s,l,u,f,m,y,v,w,S,1,[0,0,0]),A={u_height_factor:-Math.pow(2,u.overscaledZ)/h.tileSize/8};return ge(E,PP(e,h),A)},bU=(t,e,n,i,s,l,u,h,f)=>({u_matrix:e,u_opacity:n,u_ao_pass:i?1:0,u_meter_to_tile:s,u_ao:l,u_flood_light_intensity:u,u_flood_light_color:h,u_attenuation:f,u_fb:0}),DP=(t,e)=>({u_matrix:t,u_emissive_strength:e}),LP=(t,e,n,i)=>ge(DP(t,e),PP(n,i)),SU=(t,e,n)=>({u_matrix:t,u_world:n,u_emissive_strength:e}),EU=(t,e,n,i,s)=>ge(LP(t,e,n,i),{u_world:s}),TU=Me.create(),CU=(t,e,n,i,s,l)=>{const u=t.transform,h=u.projection.name==="globe";let f;if(l.paint.get("circle-pitch-alignment")==="map")if(h){const y=r3(u.zoom,e.canonical)*u._pixelsPerMercatorPixel;f=Float32Array.from([y,0,0,y])}else f=u.calculatePixelsToTileUnitsMatrix(n);else f=new Float32Array([u.pixelsToGLUnits[0],0,0,u.pixelsToGLUnits[1]]);const m={u_camera_to_center_distance:u.cameraToCenterDistance,u_matrix:t.translatePosMatrix(e.projMatrix,n,l.paint.get("circle-translate"),l.paint.get("circle-translate-anchor")),u_device_pixel_ratio:mn.devicePixelRatio,u_extrude_scale:f,u_inv_rot_matrix:TU,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0],u_emissive_strength:l.paint.get("circle-emissive-strength")};if(h){m.u_inv_rot_matrix=i,m.u_merc_center=s,m.u_tile_id=[e.canonical.x,e.canonical.y,1<<e.canonical.z],m.u_zoom_transition=ro(u.zoom);const y=s[0]*Ge,v=s[1]*Ge;m.u_up_dir=u.projection.upVector(new rc(0,0,0),y,v)}return m},AU=t=>{const e=[];return t.paint.get("circle-pitch-alignment")==="map"&&e.push("PITCH_WITH_MAP"),t.paint.get("circle-pitch-scale")==="map"&&e.push("SCALE_WITH_MAP"),e},MU=(t,e,n,i)=>{const s=Ge/n.tileSize;return{u_matrix:t,u_camera_to_center_distance:e.getCameraToCenterDistance(i),u_extrude_scale:[e.pixelsToGLUnits[0]/s,e.pixelsToGLUnits[1]/s]}},OP=(t,e,n=1)=>({u_matrix:t,u_color:e,u_overlay:0,u_overlay_scale:n}),IU=Me.create(),kU=(t,e,n,i,s,l,u)=>{const h=t.transform,f=h.projection.name==="globe",m=f?r3(h.zoom,e.canonical)*h._pixelsPerMercatorPixel:df(n,1,l),y={u_matrix:e.projMatrix,u_extrude_scale:m,u_intensity:u,u_inv_rot_matrix:IU,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(f){y.u_inv_rot_matrix=i,y.u_merc_center=s,y.u_tile_id=[e.canonical.x,e.canonical.y,1<<e.canonical.z],y.u_zoom_transition=ro(h.zoom);const v=s[0]*Ge,w=s[1]*Ge;y.u_up_dir=h.projection.upVector(new rc(0,0,0),v,w)}return y},PU=(t,e,n,i,s,l,u)=>{const h=t.transform,f=h.calculatePixelsToTileUnitsMatrix(e);return{u_matrix:FP(t,e,n,i),u_pixels_to_tile_units:f,u_device_pixel_ratio:l,u_units_to_pixels:[1/h.pixelsToGLUnits[0],1/h.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:s,u_texsize:BP(n)?e.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:zP(e,t.transform),u_alpha_discard_threshold:0,u_trim_offset:u,u_emissive_strength:n.paint.get("line-emissive-strength")}},RU=(t,e,n,i,s)=>{const l=t.transform;return{u_matrix:FP(t,e,n,i),u_texsize:e.imageAtlasTexture.size,u_pixels_to_tile_units:l.calculatePixelsToTileUnitsMatrix(e),u_device_pixel_ratio:s,u_image:0,u_tile_units_to_pixels:zP(e,l),u_units_to_pixels:[1/l.pixelsToGLUnits[0],1/l.pixelsToGLUnits[1]],u_alpha_discard_threshold:0}};function zP(t,e){return 1/df(t,1,e.tileZoom)}function FP(t,e,n,i){return t.translatePosMatrix(i||e.tileID.projMatrix,e,n.paint.get("line-translate"),n.paint.get("line-translate-anchor"))}function BP(t){const e=t.paint.get("line-dasharray").value;return e.value||e.kind!=="constant"}const DU=(t,e,n,i,s,l,u,h,f)=>{return{u_matrix:t,u_tl_parent:e,u_scale_parent:n,u_fade_t:i.mix,u_opacity:i.opacity*s.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:s.paint.get("raster-brightness-min"),u_brightness_high:s.paint.get("raster-brightness-max"),u_saturation_factor:(y=s.paint.get("raster-saturation"),y>0?1-1/(1.001-y):-y),u_contrast_factor:(m=s.paint.get("raster-contrast"),m>0?1/(1-m):1+m),u_spin_weights:LU(s.paint.get("raster-hue-rotate")),u_perspective_transform:l,u_colorization_mix:h,u_colorization_scale:OU(f),u_color_ramp:u};var m,y};function LU(t){t*=Math.PI/180;const e=Math.sin(t),n=Math.cos(t);return[(2*n+1)/3,(-Math.sqrt(3)*e-n+1)/3,(Math.sqrt(3)*e-n+1)/3]}function OU([t,e]){return t===e?[t,e]:[-t/(e-t),1/(e-t)]}const NP=Me.create(),jP=(t,e,n,i,s,l,u,h,f,m,y,v,w,S,E,A,M)=>{const k=s.transform,R={u_is_size_zoom_constant:+(t==="constant"||t==="source"),u_is_size_feature_constant:+(t==="constant"||t==="camera"),u_size_t:e?e.uSizeT:0,u_size:e?e.uSize:0,u_camera_to_center_distance:k.getCameraToCenterDistance(A),u_rotate_symbol:+n,u_aspect_ratio:k.width/k.height,u_fade_change:s.options.fadeDuration?s.symbolFadeChange:1,u_matrix:l,u_label_plane_matrix:u,u_coord_matrix:h,u_is_text:+f,u_pitch_with_map:+i,u_texsize:m,u_texture:0,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:NP,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:NP,u_up_vector:[0,-1,0],u_icon_transition:M||0};return A.name==="globe"&&(R.u_tile_id=[y.canonical.x,y.canonical.y,1<<y.canonical.z],R.u_zoom_transition=v,R.u_inv_rot_matrix=S,R.u_merc_center=w,R.u_camera_forward=k._camera.forward(),R.u_ecef_origin=function(L,z){const B=[0,0,0],j=pm(ml(z.canonical));return fe.transformMat4(B,B,j),fe.transformMat4(B,B,L),B}(k.globeMatrix,y.toUnwrapped()),R.u_tile_matrix=Float32Array.from(k.globeMatrix),R.u_up_vector=E),R},UP=(t,e,n,i,s,l,u,h,f,m,y,v,w,S,E,A,M)=>ge(jP(t,e,n,i,s,l,u,h,f,m,v,w,S,E,A,M),{u_gamma_scale:i?s.transform.getCameraToCenterDistance(M)*Math.cos(s.terrain?0:s.transform._pitch):1,u_device_pixel_ratio:mn.devicePixelRatio,u_is_halo:+y,undefined:void 0}),zU=(t,e,n,i,s,l,u,h,f,m,y,v,w,S,E,A)=>ge(UP(t,e,n,i,s,l,u,h,!0,f,!0,y,v,w,S,E,A),{u_texsize_icon:m,u_texture_icon:1}),FU=(t,e,n,i)=>({u_matrix:t,u_emissive_strength:e,u_opacity:n,u_color:i}),BU=(t,e,n,i,s,l,u)=>ge(function(h,f,m,y){const v=m.imageManager.getPattern(h.toString(),f),{width:w,height:S}=m.imageManager.getPixelSize(f),E=Math.pow(2,y.tileID.overscaledZ),A=y.tileSize*Math.pow(2,m.transform.tileZoom)/E,M=A*(y.tileID.canonical.x+y.tileID.wrap*E),k=A*y.tileID.canonical.y;return{u_image:0,u_pattern_tl:v.tl,u_pattern_br:v.br,u_texsize:[w,S],u_pattern_size:v.displaySize,u_tile_units_to_pixels:1/df(y,1,m.transform.tileZoom),u_pixel_coord_upper:[M>>16,k>>16],u_pixel_coord_lower:[65535&M,65535&k]}}(s,l,i,u),{u_matrix:t,u_emissive_strength:e,u_opacity:n}),wE=(t,e,n,i,s,l,u,h,f,m,y,v=[0,0,0])=>{const w=i.style.light,S=w.properties.get("position"),E=[-S.x,-S.y,S.z],A=gs.create();w.properties.get("anchor")==="viewport"&&(gs.fromRotation(A,-i.transform.angle),fe.transformMat3(E,E,A));const M=m.alphaMode==="MASK",k=w.properties.get("color"),R=y.paint.get("model-ambient-occlusion-intensity"),L=y.paint.get("model-color").constantOr(wn.white),z=y.paint.get("model-color-mix-intensity").constantOr(0);return{u_matrix:t,u_lighting_matrix:e,u_normal_matrix:n,u_lightpos:E,u_lightintensity:w.properties.get("intensity"),u_lightcolor:[k.r,k.g,k.b],u_camera_pos:v,u_opacity:s,u_baseTextureIsAlpha:0,u_alphaMask:+M,u_alphaCutoff:m.alphaCutoff,u_baseColorFactor:[l.r,l.g,l.b,l.a],u_emissiveFactor:[u[0],u[1],u[2],1],u_metallicFactor:h,u_roughnessFactor:f,u_baseColorTexture:Os.BaseColor,u_metallicRoughnessTexture:Os.MetallicRoughness,u_normalTexture:Os.Normal,u_occlusionTexture:Os.Occlusion,u_emissionTexture:Os.Emission,u_color_mix:[L.r,L.g,L.b,z],u_aoIntensity:R}},VP=new Float32Array(16),$P=(t,e=VP,n=VP)=>({u_matrix:t,u_instance:e,u_node_matrix:n}),NU={fillExtrusion:t=>({u_matrix:new gn(t),u_lightpos:new fn(t),u_lightintensity:new pt(t),u_lightcolor:new fn(t),u_vertical_gradient:new pt(t),u_opacity:new pt(t),u_edge_radius:new pt(t),u_ao:new En(t),u_tile_id:new fn(t),u_zoom_transition:new pt(t),u_inv_rot_matrix:new gn(t),u_merc_center:new En(t),u_up_dir:new fn(t),u_height_lift:new pt(t),u_flood_light_color:new fn(t),u_vertical_scale:new pt(t),u_flood_light_intensity:new pt(t),u_ground_shadow_factor:new fn(t)}),fillExtrusionDepth:t=>({u_matrix:new gn(t),u_edge_radius:new pt(t),u_vertical_scale:new pt(t)}),fillExtrusionPattern:t=>({u_matrix:new gn(t),u_lightpos:new fn(t),u_lightintensity:new pt(t),u_lightcolor:new fn(t),u_vertical_gradient:new pt(t),u_height_factor:new pt(t),u_edge_radius:new pt(t),u_ao:new En(t),u_tile_id:new fn(t),u_zoom_transition:new pt(t),u_inv_rot_matrix:new gn(t),u_merc_center:new En(t),u_up_dir:new fn(t),u_height_lift:new pt(t),u_image:new Sn(t),u_texsize:new En(t),u_pixel_coord_upper:new En(t),u_pixel_coord_lower:new En(t),u_tile_units_to_pixels:new pt(t),u_opacity:new pt(t)}),fillExtrusionGroundEffect:t=>({u_matrix:new gn(t),u_opacity:new pt(t),u_ao_pass:new pt(t),u_meter_to_tile:new pt(t),u_ao:new En(t),u_flood_light_intensity:new pt(t),u_flood_light_color:new fn(t),u_attenuation:new pt(t),u_fb:new Sn(t)}),fill:t=>({u_matrix:new gn(t),u_emissive_strength:new pt(t)}),fillPattern:t=>({u_matrix:new gn(t),u_emissive_strength:new pt(t),u_image:new Sn(t),u_texsize:new En(t),u_pixel_coord_upper:new En(t),u_pixel_coord_lower:new En(t),u_tile_units_to_pixels:new pt(t)}),fillOutline:t=>({u_matrix:new gn(t),u_emissive_strength:new pt(t),u_world:new En(t)}),fillOutlinePattern:t=>({u_matrix:new gn(t),u_emissive_strength:new pt(t),u_world:new En(t),u_image:new Sn(t),u_texsize:new En(t),u_pixel_coord_upper:new En(t),u_pixel_coord_lower:new En(t),u_tile_units_to_pixels:new pt(t)}),circle:t=>({u_camera_to_center_distance:new pt(t),u_extrude_scale:new _a(t),u_device_pixel_ratio:new pt(t),u_matrix:new gn(t),u_inv_rot_matrix:new gn(t),u_merc_center:new En(t),u_tile_id:new fn(t),u_zoom_transition:new pt(t),u_up_dir:new fn(t),u_emissive_strength:new pt(t)}),collisionBox:t=>({u_matrix:new gn(t),u_camera_to_center_distance:new pt(t),u_extrude_scale:new En(t)}),collisionCircle:t=>({u_matrix:new gn(t),u_inv_matrix:new gn(t),u_camera_to_center_distance:new pt(t),u_viewport_size:new En(t)}),debug:t=>({u_color:new Yu(t),u_matrix:new gn(t),u_overlay:new Sn(t),u_overlay_scale:new pt(t)}),clippingMask:t=>({u_matrix:new gn(t)}),heatmap:t=>({u_extrude_scale:new pt(t),u_intensity:new pt(t),u_matrix:new gn(t),u_inv_rot_matrix:new gn(t),u_merc_center:new En(t),u_tile_id:new fn(t),u_zoom_transition:new pt(t),u_up_dir:new fn(t)}),heatmapTexture:t=>({u_image:new Sn(t),u_color_ramp:new Sn(t),u_opacity:new pt(t)}),hillshade:t=>({u_matrix:new gn(t),u_image:new Sn(t),u_latrange:new En(t),u_light:new En(t),u_shadow:new Yu(t),u_highlight:new Yu(t),u_accent:new Yu(t)}),hillshadePrepare:t=>({u_matrix:new gn(t),u_image:new Sn(t),u_dimension:new En(t),u_zoom:new pt(t),u_unpack:new Ko(t)}),line:t=>({u_matrix:new gn(t),u_pixels_to_tile_units:new _a(t),u_device_pixel_ratio:new pt(t),u_units_to_pixels:new En(t),u_dash_image:new Sn(t),u_gradient_image:new Sn(t),u_image_height:new pt(t),u_texsize:new En(t),u_tile_units_to_pixels:new pt(t),u_alpha_discard_threshold:new pt(t),u_trim_offset:new En(t),u_emissive_strength:new pt(t)}),linePattern:t=>({u_matrix:new gn(t),u_texsize:new En(t),u_pixels_to_tile_units:new _a(t),u_device_pixel_ratio:new pt(t),u_image:new Sn(t),u_units_to_pixels:new En(t),u_tile_units_to_pixels:new pt(t),u_alpha_discard_threshold:new pt(t)}),raster:t=>({u_matrix:new gn(t),u_tl_parent:new En(t),u_scale_parent:new pt(t),u_fade_t:new pt(t),u_opacity:new pt(t),u_image0:new Sn(t),u_image1:new Sn(t),u_brightness_low:new pt(t),u_brightness_high:new pt(t),u_saturation_factor:new pt(t),u_contrast_factor:new pt(t),u_spin_weights:new fn(t),u_perspective_transform:new En(t),u_colorization_mix:new Ko(t),u_colorization_scale:new En(t),u_color_ramp:new Sn(t)}),symbolIcon:t=>({u_is_size_zoom_constant:new Sn(t),u_is_size_feature_constant:new Sn(t),u_size_t:new pt(t),u_size:new pt(t),u_camera_to_center_distance:new pt(t),u_rotate_symbol:new Sn(t),u_aspect_ratio:new pt(t),u_fade_change:new pt(t),u_matrix:new gn(t),u_label_plane_matrix:new gn(t),u_coord_matrix:new gn(t),u_is_text:new Sn(t),u_pitch_with_map:new Sn(t),u_texsize:new En(t),u_tile_id:new fn(t),u_zoom_transition:new pt(t),u_inv_rot_matrix:new gn(t),u_merc_center:new En(t),u_camera_forward:new fn(t),u_tile_matrix:new gn(t),u_up_vector:new fn(t),u_ecef_origin:new fn(t),u_texture:new Sn(t),u_icon_transition:new pt(t)}),symbolSDF:t=>({u_is_size_zoom_constant:new Sn(t),u_is_size_feature_constant:new Sn(t),u_size_t:new pt(t),u_size:new pt(t),u_camera_to_center_distance:new pt(t),u_rotate_symbol:new Sn(t),u_aspect_ratio:new pt(t),u_fade_change:new pt(t),u_matrix:new gn(t),u_label_plane_matrix:new gn(t),u_coord_matrix:new gn(t),u_is_text:new Sn(t),u_pitch_with_map:new Sn(t),u_texsize:new En(t),u_texture:new Sn(t),u_gamma_scale:new pt(t),u_device_pixel_ratio:new pt(t),u_tile_id:new fn(t),u_zoom_transition:new pt(t),u_inv_rot_matrix:new gn(t),u_merc_center:new En(t),u_camera_forward:new fn(t),u_tile_matrix:new gn(t),u_up_vector:new fn(t),u_ecef_origin:new fn(t),u_is_halo:new Sn(t)}),symbolTextAndIcon:t=>({u_is_size_zoom_constant:new Sn(t),u_is_size_feature_constant:new Sn(t),u_size_t:new pt(t),u_size:new pt(t),u_camera_to_center_distance:new pt(t),u_rotate_symbol:new Sn(t),u_aspect_ratio:new pt(t),u_fade_change:new pt(t),u_matrix:new gn(t),u_label_plane_matrix:new gn(t),u_coord_matrix:new gn(t),u_is_text:new Sn(t),u_pitch_with_map:new Sn(t),u_texsize:new En(t),u_texsize_icon:new En(t),u_texture:new Sn(t),u_texture_icon:new Sn(t),u_gamma_scale:new pt(t),u_device_pixel_ratio:new pt(t),u_is_halo:new Sn(t)}),background:t=>({u_matrix:new gn(t),u_emissive_strength:new pt(t),u_opacity:new pt(t),u_color:new Yu(t)}),backgroundPattern:t=>({u_matrix:new gn(t),u_emissive_strength:new pt(t),u_opacity:new pt(t),u_image:new Sn(t),u_pattern_tl:new En(t),u_pattern_br:new En(t),u_texsize:new En(t),u_pattern_size:new En(t),u_pixel_coord_upper:new En(t),u_pixel_coord_lower:new En(t),u_tile_units_to_pixels:new pt(t)}),terrainRaster:bP,terrainDepth:bP,skybox:t=>({u_matrix:new gn(t),u_sun_direction:new fn(t),u_cubemap:new Sn(t),u_opacity:new pt(t),u_temporal_offset:new pt(t)}),skyboxGradient:t=>({u_matrix:new gn(t),u_color_ramp:new Sn(t),u_center_direction:new fn(t),u_radius:new pt(t),u_opacity:new pt(t),u_temporal_offset:new pt(t)}),skyboxCapture:t=>({u_matrix_3f:new to(t),u_sun_direction:new fn(t),u_sun_intensity:new pt(t),u_color_tint_r:new Ko(t),u_color_tint_m:new Ko(t),u_luminance:new pt(t)}),globeRaster:t=>({u_proj_matrix:new gn(t),u_globe_matrix:new gn(t),u_normalize_matrix:new gn(t),u_merc_matrix:new gn(t),u_zoom_transition:new pt(t),u_merc_center:new En(t),u_image0:new Sn(t),u_grid_matrix:new to(t),u_skirt_height:new pt(t),u_frustum_tl:new fn(t),u_frustum_tr:new fn(t),u_frustum_br:new fn(t),u_frustum_bl:new fn(t),u_globe_pos:new fn(t),u_globe_radius:new pt(t),u_viewport:new En(t)}),globeAtmosphere:t=>({u_frustum_tl:new fn(t),u_frustum_tr:new fn(t),u_frustum_br:new fn(t),u_frustum_bl:new fn(t),u_horizon:new pt(t),u_transition:new pt(t),u_fadeout_range:new pt(t),u_color:new Ko(t),u_high_color:new Ko(t),u_space_color:new Ko(t),u_temporal_offset:new pt(t),u_horizon_angle:new pt(t)}),model:t=>({u_matrix:new gn(t),u_lighting_matrix:new gn(t),u_normal_matrix:new gn(t),u_lightpos:new fn(t),u_lightintensity:new pt(t),u_lightcolor:new fn(t),u_camera_pos:new fn(t),u_opacity:new pt(t),u_baseColorFactor:new Ko(t),u_emissiveFactor:new Ko(t),u_metallicFactor:new pt(t),u_roughnessFactor:new pt(t),u_baseTextureIsAlpha:new Sn(t),u_alphaMask:new Sn(t),u_alphaCutoff:new pt(t),u_baseColorTexture:new Sn(t),u_metallicRoughnessTexture:new Sn(t),u_normalTexture:new Sn(t),u_occlusionTexture:new Sn(t),u_emissionTexture:new Sn(t),u_color_mix:new Ko(t),u_aoIntensity:new pt(t)}),modelDepth:t=>({u_matrix:new gn(t),u_instance:new gn(t),u_node_matrix:new gn(t)}),groundShadow:t=>({u_matrix:new gn(t),u_ground_shadow_factor:new fn(t)}),stars:t=>({u_matrix:new gn(t),u_up:new fn(t),u_right:new fn(t),u_intensity_multiplier:new pt(t)})};let bx;function GP(t,e,n,i,s,l,u){const h=t.context,f=h.gl,m=t.transform,y=t.useProgram("collisionBox"),v=[];let w=0,S=0;for(let z=0;z<i.length;z++){const B=i[z],j=e.getTile(B),V=j.getBucket(n);if(!V)continue;const Y=Vj(B,V,m);let ne=Y;s[0]===0&&s[1]===0||(ne=t.translatePosMatrix(Y,j,s,l));const re=u?V.textCollisionBox:V.iconCollisionBox,J=V.collisionCircleArray;if(J.length>0){const ae=Me.create(),le=ne;Me.mul(ae,V.placementInvProjMatrix,m.glCoordMatrix),Me.mul(ae,ae,V.placementViewportMatrix),v.push({circleArray:J,circleOffset:S,transform:le,invTransform:ae,projection:V.getProjection()}),w+=J.length/4,S=w}re&&(t.terrain&&t.terrain.setupElevationDraw(j,y),y.draw(t,f.LINES,_n.disabled,Nn.disabled,t.colorModeForRenderPass(),Vn.disabled,MU(ne,m,j,V.getProjection()),n.id,re.layoutVertexBuffer,re.indexBuffer,re.segments,null,m.zoom,null,[re.collisionVertexBuffer,re.collisionVertexBufferExt]))}if(!u||!v.length)return;const E=t.useProgram("collisionCircle"),A=new Gy;A.resize(4*w),A._trim();let M=0;for(const z of v)for(let B=0;B<z.circleArray.length/4;B++){const j=4*B,V=z.circleArray[j+0],Y=z.circleArray[j+1],ne=z.circleArray[j+2],re=z.circleArray[j+3];A.emplace(M++,V,Y,ne,re,0),A.emplace(M++,V,Y,ne,re,1),A.emplace(M++,V,Y,ne,re,2),A.emplace(M++,V,Y,ne,re,3)}(!bx||bx.length<2*w)&&(bx=function(z){const B=2*z,j=new di;j.resize(B),j._trim();for(let V=0;V<B;V++){const Y=6*V;j.uint16[Y+0]=4*V+0,j.uint16[Y+1]=4*V+1,j.uint16[Y+2]=4*V+2,j.uint16[Y+3]=4*V+2,j.uint16[Y+4]=4*V+3,j.uint16[Y+5]=4*V+0}return j}(w));const k=h.createIndexBuffer(bx,!0),R=h.createVertexBuffer(A,c6.members,!0);for(const z of v){const B={u_matrix:z.transform,u_inv_matrix:z.invTransform,u_camera_to_center_distance:(L=m).getCameraToCenterDistance(z.projection),u_viewport_size:[L.width,L.height]};E.draw(t,f.TRIANGLES,_n.disabled,Nn.disabled,t.colorModeForRenderPass(),Vn.disabled,B,n.id,R,k,In.simpleSegment(0,2*z.circleOffset,z.circleArray.length,z.circleArray.length/2),null,m.zoom)}var L;R.destroy(),k.destroy()}const HP=Me.create();function jU({width:t,height:e,anchor:n,textOffset:i,textScale:s},l){const{horizontalAlign:u,verticalAlign:h}=G1(n),f=-(u-.5)*t,m=-(h-.5)*e,y=OS(n,i);return new q((f/s+y[0])*l,(m/s+y[1])*l)}function UU(t,e,n,i,s,l,u,h,f,m,y){const v=t.text.placedSymbolArray,w=t.text.dynamicLayoutVertexArray,S=t.icon.dynamicLayoutVertexArray,E={},A=t.getProjection(),M=cE(h,A,l),k=l.elevation,R=A.upVectorScale(h.canonical,l.center.lat,l.worldSize).metersToTile;w.clear();for(let L=0;L<v.length;L++){const z=v.get(L),{tileAnchorX:B,tileAnchorY:j,numGlyphs:V}=z,Y=z.hidden||!z.crossTileID||t.allowVerticalPlacement&&!z.placedOrientation?null:i[z.crossTileID];if(Y){let ne=0,re=0,J=0;if(k){const Le=k?k.getAtTileOffset(h,B,j):0,[qe,Ve,yt]=A.upVector(h.canonical,B,j);ne=Le*qe*R,re=Le*Ve*R,J=Le*yt*R}let[ae,le,oe,Ee]=vl(z.projectedAnchorX+ne,z.projectedAnchorY+re,z.projectedAnchorZ+J,n?M:u);const xe=jI(l.getCameraToCenterDistance(A),Ee);let Pe=s.evaluateSizeForFeature(t.textSizeData,m,z)*xe/Wi;n&&(Pe*=t.tilePixelRatio/f);const pe=jU(Y,Pe);n?({x:ae,y:le,z:oe}=A.projectTilePoint(B+pe.x,j+pe.y,h.canonical),[ae,le,oe]=vl(ae+ne,le+re,oe+J,u)):(e&&pe._rotate(-l.angle),ae+=pe.x,le+=pe.y,oe=0);const Ae=t.allowVerticalPlacement&&z.placedOrientation===Gr.vertical?Math.PI/2:0;for(let Le=0;Le<V;Le++)Im(w,ae,le,oe,Ae);y&&z.associatedIconIndex>=0&&(E[z.associatedIconIndex]={x:ae,y:le,z:oe,angle:Ae})}else Pm(V,w)}if(y){S.clear();const L=t.icon.placedSymbolArray;for(let z=0;z<L.length;z++){const B=L.get(z),{numGlyphs:j}=B,V=E[z];if(B.hidden||!V)Pm(j,S);else{const{x:Y,y:ne,z:re,angle:J}=V;for(let ae=0;ae<j;ae++)Im(S,Y,ne,re,J)}}t.icon.dynamicLayoutVertexBuffer.updateData(S)}t.text.dynamicLayoutVertexBuffer.updateData(w)}function VU(t,e,n){return n.iconsInText&&e?"symbolTextAndIcon":t?"symbolSDF":"symbolIcon"}function qP(t,e,n,i,s,l,u,h,f,m,y,v){const w=t.context,S=w.gl,E=t.transform,A=h==="map",M=f==="map",k=A&&n.layout.get("symbol-placement")!=="point",R=A&&!M&&!k,L=n.layout.get("symbol-sort-key").constantOr(1)!==void 0;let z=!1;const B=t.depthModeForSublayer(0,_n.ReadOnly),j=[io(E.center.lng),co(E.center.lat)],V=n.layout.get("text-variable-anchor"),Y=E.projection.name==="globe",ne=[],re=[0,-1,0];let J=re;!Y&&!E.mercatorFromTransition||A||(J=function(ae){const le=ae._camera.getWorldToCamera(ae.worldSize,1),oe=Me.multiply([],le,ae.globeMatrix);Me.invert(oe,oe);const Ee=[0,0,0],xe=[0,1,0,0];return xr.transformMat4(xe,xe,oe),Ee[0]=xe[0],Ee[1]=xe[1],Ee[2]=xe[2],fe.normalize(Ee,Ee),Ee}(E));for(const ae of i){const le=e.getTile(ae),oe=le.getBucket(n);if(!oe||oe.projection.name==="mercator"&&Y)continue;const Ee=s?oe.text:oe.icon;if(!Ee||oe.fullyClipped||!Ee.segments.get().length)continue;const xe=Ee.programConfigurations.get(n.id),Pe=s||oe.sdfIcons,pe=s?oe.textSizeData:oe.iconSizeData,Ae=M||E.pitch!==0,Le=ru(pe,E.zoom);let qe,Ve,yt,mt,lt=[0,0],ft=null;if(s)Ve=le.glyphAtlasTexture,yt=S.LINEAR,qe=le.glyphAtlasTexture.size,oe.iconsInText&&(lt=le.imageAtlasTexture.size,ft=le.imageAtlasTexture,mt=Ae||t.options.rotating||t.options.zooming||pe.kind==="composite"||pe.kind==="camera"?S.LINEAR:S.NEAREST);else{const qr=n.layout.get("icon-size").constantOr(0)!==1||oe.iconsNeedLinear;Ve=le.imageAtlasTexture,yt=Pe||t.options.rotating||t.options.zooming||qr||Ae?S.LINEAR:S.NEAREST,qe=le.imageAtlasTexture.size}const Mt=oe.projection.name==="globe",Zt=Mt?J:re,Gt=Mt?ro(E.zoom):0,Ut=cE(ae,oe.getProjection(),E),Xt=E.calculatePixelsToTileUnitsMatrix(le),zn=lx(Ut,le.tileID.canonical,M,A,E,oe.getProjection(),Xt),Pn=t.terrain&&M&&k?Me.invert(Me.create(),zn):HP,or=NI(Ut,le.tileID.canonical,M,A,E,oe.getProjection(),Xt),Rn=V&&oe.hasTextData(),Fn=oe.hasIconTextFit()&&Rn&&oe.hasIconData();if(k){const qr=E.elevation,Di=qr?qr.getAtTileOffsetFunc(ae,E.center.lat,E.worldSize,oe.getProjection()):null,fr=BI(Ut,le.tileID.canonical,M,A,E,oe.getProjection(),Xt);U8(oe,Ut,t,s,fr,or,M,m,Di,ae)}const an=k||s&&V||Fn,An=t.translatePosMatrix(Ut,le,l,u),sr=an?HP:zn,Mn=t.translatePosMatrix(or,le,l,u,!0),cr=oe.getProjection().createInversionMatrix(E,ae.canonical),fi=n.paint.get("icon-image-cross-fade").constantOr(0),pi=[];t.terrainRenderModeElevated()&&M&&pi.push("PITCH_WITH_MAP_TERRAIN"),Mt&&pi.push("PROJECTION_GLOBE_VIEW"),an&&pi.push("PROJECTED_POS_ON_VIEWPORT"),fi>0&&pi.push("ICON_TRANSITION");const Zr=Pe&&n.paint.get(s?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let zr;zr=Pe?oe.iconsInText?zU(pe.kind,Le,R,M,t,An,sr,Mn,qe,lt,ae,Gt,j,cr,Zt,oe.getProjection()):UP(pe.kind,Le,R,M,t,An,sr,Mn,s,qe,!0,ae,Gt,j,cr,Zt,oe.getProjection()):jP(pe.kind,Le,R,M,t,An,sr,Mn,s,qe,ae,Gt,j,cr,Zt,oe.getProjection(),fi);const Mi={program:t.useProgram(VU(Pe,s,oe),xe,pi),buffers:Ee,uniformValues:zr,atlasTexture:Ve,atlasTextureIcon:ft,atlasInterpolation:yt,atlasInterpolationIcon:mt,isSDF:Pe,hasHalo:Zr,tile:le,labelPlaneMatrixInv:Pn};if(L&&oe.canOverlap){z=!0;const qr=Ee.segments.get();for(const Di of qr)ne.push({segments:new In([Di]),sortKey:Di.sortKey,state:Mi})}else ne.push({segments:Ee.segments,sortKey:0,state:Mi})}z&&ne.sort((ae,le)=>ae.sortKey-le.sortKey);for(const ae of ne){const le=ae.state;if(t.terrain&&t.terrain.setupElevationDraw(le.tile,le.program,{useDepthForOcclusion:!Y,labelPlaneMatrixInv:le.labelPlaneMatrixInv}),w.activeTexture.set(S.TEXTURE0),le.atlasTexture.bind(le.atlasInterpolation,S.CLAMP_TO_EDGE),le.atlasTextureIcon&&(w.activeTexture.set(S.TEXTURE1),le.atlasTextureIcon&&le.atlasTextureIcon.bind(le.atlasInterpolationIcon,S.CLAMP_TO_EDGE)),t.uploadCommonLightUniforms(t.context,le.program),w.isWebGL2&&le.hasHalo){const oe=le.uniformValues;oe.u_is_halo=1,bE(le.buffers,ae.segments,n,t,le.program,B,y,v,oe,2),oe.u_is_halo=0}else{if(le.isSDF){const oe=le.uniformValues;le.hasHalo&&(oe.u_is_halo=1,bE(le.buffers,ae.segments,n,t,le.program,B,y,v,oe,1)),oe.u_is_halo=0}bE(le.buffers,ae.segments,n,t,le.program,B,y,v,le.uniformValues,1)}}}function bE(t,e,n,i,s,l,u,h,f,m){const y=[t.dynamicLayoutVertexBuffer,t.opacityVertexBuffer,t.iconTransitioningVertexBuffer,t.globeExtVertexBuffer];s.draw(i,i.context.gl.TRIANGLES,l,u,h,Vn.disabled,f,n.id,t.layoutVertexBuffer,t.indexBuffer,e,n.paint,i.transform.zoom,t.programConfigurations.get(n.id),y,m)}function WP(t,e,n,i,s,l,u){const h=t.context.gl,f=n.paint.get("fill-pattern"),m=f&&f.constantOr(1);let y,v,w,S,E;u?(v=m&&!n.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",y=h.LINES):(v=m?"fillPattern":"fill",y=h.TRIANGLES);for(const A of i){const M=e.getTile(A);if(m&&!M.patternsLoaded())continue;const k=M.getBucket(n);if(!k)continue;t.prepareDrawTile();const R=k.programConfigurations.get(n.id),L=t.useProgram(v,R);m&&(t.context.activeTexture.set(h.TEXTURE0),M.imageAtlasTexture.bind(h.LINEAR,h.CLAMP_TO_EDGE),R.updatePaintBuffers());const z=f.constantOr(null);if(z&&M.imageAtlas){const V=M.imageAtlas.patternPositions[z.toString()];V&&R.setConstantPatternPositions(V)}const B=t.translatePosMatrix(A.projMatrix,M,n.paint.get("fill-translate"),n.paint.get("fill-translate-anchor")),j=n.paint.get("fill-emissive-strength");if(u){S=k.indexBuffer2,E=k.segments2;const V=t.terrain&&t.terrain.renderingToTexture?t.terrain.drapeBufferSize:[h.drawingBufferWidth,h.drawingBufferHeight];w=v==="fillOutlinePattern"&&m?EU(B,j,t,M,V):SU(B,j,V)}else S=k.indexBuffer,E=k.segments,w=m?LP(B,j,t,M):DP(B,j);t.uploadCommonUniforms(t.context,L,A.toUnwrapped()),L.draw(t,y,s,t.stencilModeForClipping(A),l,Vn.disabled,w,n.id,k.layoutVertexBuffer,S,E,n.paint,t.transform.zoom,R,void 0)}}function Sx(t,e,n,i,s,l,u,h){const f=t.context,m=f.gl,y=t.transform,v=n.paint.get("fill-extrusion-pattern"),w=v.constantOr(1),S=n.paint.get("fill-extrusion-opacity"),E=t.style.enable3dLights(),A=n.paint.get(E&&!w?"fill-extrusion-ambient-occlusion-wall-radius":"fill-extrusion-ambient-occlusion-radius"),M=[n.paint.get("fill-extrusion-ambient-occlusion-intensity"),A],k=n.layout.get("fill-extrusion-edge-radius"),R=k>0&&!n.paint.get("fill-extrusion-rounded-roof"),L=R?0:k,z=y.projection.name==="globe"?xk():0,B=y.projection.name==="globe",j=B?ro(y.zoom):0,V=[io(y.center.lng),co(y.center.lat)],Y=n.paint.get("fill-extrusion-flood-light-color").toArray01().slice(0,3),ne=n.paint.get("fill-extrusion-flood-light-intensity"),re=n.paint.get("fill-extrusion-vertical-scale"),J=[];B&&J.push("PROJECTION_GLOBE_VIEW"),M[0]>0&&J.push("FAUX_AO"),R&&J.push("ZERO_ROOF_RADIUS"),h&&J.push("HAS_CENTROID"),ne>0&&J.push("FLOOD_LIGHT");const ae=t.renderPass==="shadow",le=t.shadowRenderer,oe=ae&&!!le;t.shadowRenderer&&(t.shadowRenderer.useNormalOffset=!0);let Ee=[0,0,0];if(le){const xe=t.style.directionalLight,Pe=t.style.ambientLight;xe&&Pe&&(Ee=vE(xe,Pe))}for(const xe of i){const Pe=e.getTile(xe),pe=Pe.getBucket(n);if(!pe||pe.projection.name!==y.projection.name)continue;const Ae=pe.programConfigurations.get(n.id),Le=t.useProgram(oe?"fillExtrusionDepth":w?"fillExtrusionPattern":"fillExtrusion",Ae,J);if(t.terrain){const lt=t.terrain;t.style.terrainSetForDrapingOnly(),lt.setupElevationDraw(Pe,Le,{useMeterToDem:!0})}if(!pe.centroidVertexBuffer){const lt=Le.attributes.a_centroid_pos;lt!==void 0&&m.vertexAttrib2f(lt,0,0)}!ae&&le&&le.setupShadows(Pe.tileID.toUnwrapped(),Le,"vector-tile",Pe.tileID.overscaledZ),w&&(t.context.activeTexture.set(m.TEXTURE0),Pe.imageAtlasTexture.bind(m.LINEAR,m.CLAMP_TO_EDGE),Ae.updatePaintBuffers());const qe=v.constantOr(null);if(qe&&Pe.imageAtlas){const lt=Pe.imageAtlas.patternPositions[qe.toString()];lt&&Ae.setConstantPatternPositions(lt)}const Ve=n.paint.get("fill-extrusion-vertical-gradient");let yt;if(ae&&le){const lt=le.calculateShadowPassMatrixFromTile(Pe.tileID.toUnwrapped());yt=xU(lt,L,re)}else{const lt=t.translatePosMatrix(xe.projMatrix,Pe,n.paint.get("fill-extrusion-translate"),n.paint.get("fill-extrusion-translate-anchor")),ft=y.projection.createInversionMatrix(y,xe.canonical);yt=w?wU(lt,t,Ve,S,M,L,xe,Pe,z,j,V,ft,Y,re):RP(lt,t,Ve,S,M,L,xe,z,j,V,ft,Y,re,ne,Ee)}t.uploadCommonUniforms(f,Le,xe.toUnwrapped());const mt=[];(t.terrain||h)&&mt.push(pe.centroidVertexBuffer),B&&mt.push(pe.layoutVertexExtBuffer),Le.draw(t,f.gl.TRIANGLES,s,l,u,Vn.backCCW,yt,n.id,pe.layoutVertexBuffer,pe.indexBuffer,pe.segments,n.paint,t.transform.zoom,Ae,mt)}t.shadowRenderer&&(t.shadowRenderer.useNormalOffset=!1)}function Nm(t,e,n,i,s,l,u,h,f,m,y,v,w,S,E,A,M,k){const R=t.context,L=R.gl,z=t.transform,B=[];m==="clear"?(B.push("CLEAR_SUBPASS"),k&&(B.push("CLEAR_FROM_TEXTURE"),R.activeTexture.set(L.TEXTURE0),k.bind(L.LINEAR,L.CLAMP_TO_EDGE))):m==="sdf"&&B.push("SDF_SUBPASS"),M&&B.push("HAS_CENTROID");for(const j of i){const V=e.getTile(j),Y=V.getBucket(n);if(!Y||Y.projection.name!==z.projection.name||!Y.groundEffect)continue;const ne=Y.groundEffect,re=ne.programConfigurations.get(n.id),J=t.useProgram("fillExtrusionGroundEffect",re,B),ae=t.translatePosMatrix(j.projMatrix,V,n.paint.get("fill-extrusion-translate"),n.paint.get("fill-extrusion-translate-anchor")),le=1/Y.tileToMeter,oe=bU(0,ae,y,f,le,[v,w*le],S,E,A),Ee=[];M&&Ee.push(Y.groundEffect.hiddenByLandmarkVertexBuffer),t.uploadCommonUniforms(R,J,j.toUnwrapped()),J.draw(t,R.gl.TRIANGLES,s,l,u,h,oe,n.id,ne.vertexBuffer,ne.indexBuffer,ne.segments,n.paint,t.transform.zoom,re,Ee)}}function $U(t,e,n,i,s,l,u){i.centroidVertexArray.length===0&&i.createCentroidsBuffer();const h=l?l.findDEMTileFor(n):null;if(!(h&&h.dem||u))return;const f=[R=>{let L=R.canonical.x-1,z=R.wrap;return L<0&&(L=(1<<R.canonical.z)-1,z--),new Ir(R.overscaledZ,z,R.canonical.z,L,R.canonical.y)},R=>{let L=R.canonical.x+1,z=R.wrap;return L===1<<R.canonical.z&&(L=0,z++),new Ir(R.overscaledZ,z,R.canonical.z,L,R.canonical.y)},R=>new Ir(R.overscaledZ,R.wrap,R.canonical.z,R.canonical.x,(R.canonical.y===0?1<<R.canonical.z:R.canonical.y)-1),R=>new Ir(R.overscaledZ,R.wrap,R.canonical.z,R.canonical.x,R.canonical.y===(1<<R.canonical.z)-1?0:R.canonical.y+1)],m=R=>{const L=e.getSource().minzoom,z=j=>{const V=e.getTileByID(j);if(V&&V.hasData())return V.getBucket(s)},B=[0,-1,1];for(const j of B){if(R.overscaledZ+j<L)continue;const V=z(R.calculateScaledKey(R.overscaledZ+j));if(V)return V}},y=[0,0,0],v=(R,L)=>(y[0]=Math.min(R.min.y,L.min.y),y[1]=Math.max(R.max.y,L.max.y),y[2]=Ge-L.min.x>R.max.x?L.min.x-Ge:R.max.x,y),w=(R,L)=>(y[0]=Math.min(R.min.x,L.min.x),y[1]=Math.max(R.max.x,L.max.x),y[2]=Ge-L.min.y>R.max.y?L.min.y-Ge:R.max.y,y),S=[(R,L)=>v(R,L),(R,L)=>v(L,R),(R,L)=>w(R,L),(R,L)=>w(L,R)],E=(R,L,z,B,j,V,Y)=>{if(!l)return 0;const ne=[[V?z:R,V?R:z,0],[V?z:L,V?L:z,0]],re=Y<0?Ge+Y:Y,J=[V?re:(R+L)/2,V?(R+L)/2:re,0];return z===0&&Y<0||z!==0&&Y>0?l.getForTilePoints(j,[J],!0,B):ne.push(J),l.getForTilePoints(n,ne,!0,h),Math.max(ne[0][2],ne[1][2],J[2])/l.exaggeration()};for(let R=0;R<4;R++){const L=i.borderFeatureIndices[R];if(L.length===0)continue;const z=f[R](n),B=m(z);if(!(B&&B instanceof k_)||i.borderDoneWithNeighborZ[R]===B.canonical.z)continue;B.centroidVertexArray.length===0&&B.createCentroidsBuffer();const j=l?l.findDEMTileFor(z):null;if(!(j&&j.dem||u))continue;const V=(R<2?1:5)-R,Y=B.borderDoneWithNeighborZ[V]!==i.canonical.z,ne=B.borderFeatureIndices[V];let re=0;if(i.canonical.z!==B.canonical.z){for(const J of L)i.showCentroid(i.featuresOnBorder[J]);if(Y)for(const J of ne)B.showCentroid(B.featuresOnBorder[J]);i.borderDoneWithNeighborZ[R]=B.canonical.z,B.borderDoneWithNeighborZ[V]=i.canonical.z}for(const J of L){const ae=i.featuresOnBorder[J],le=i.centroidData[ae.centroidDataIndex],oe=ae.borders[R];let Ee;for(;re<ne.length;){Ee=B.featuresOnBorder[ne[re]];const xe=Ee.borders[V];if(xe[1]>oe[0]+3||xe[0]>oe[0]-3)break;B.showCentroid(Ee),re++}if(Ee&&re<ne.length){const xe=re;let Pe=0;for(;!(Ee.borders[V][0]>oe[1]-3)&&(Pe++,++re!==ne.length);)Ee=B.featuresOnBorder[ne[re]];if(Ee=B.featuresOnBorder[ne[xe]],Pe>1){const Le=Ee.borders[V];Math.abs(oe[0]-Le[0])<3&&Math.abs(oe[1]-Le[1])<3&&(Pe=1,re=xe+1)}else if(Pe===0){i.showCentroid(ae);continue}const pe=B.centroidData[Ee.centroidDataIndex];u&&Pe===1&&(((M=le).flags|(k=pe).flags)&Th?(M.flags|=Th,k.flags|=Th):(M.flags&=2147483647,k.flags&=2147483647));let Ae=new q(0,0);if(Pe>1)re=xe;else if(j&&j.dem&&!(ae.intersectsCount()>1||Ee.intersectsCount()>1)){const Le=S[R](le,pe),qe=R%2?Ge-1:0;A=E(Le[0],Math.min(Ge-1,Le[1]),qe,j,z,R<2,Le[2]),Ae=new q(Math.ceil(7*(A+450)),0)}le.centroidXY=pe.centroidXY=Ae,i.writeCentroidToBuffer(le),B.writeCentroidToBuffer(pe)}else i.showCentroid(ae)}i.borderDoneWithNeighborZ[R]=B.canonical.z,B.borderDoneWithNeighborZ[V]=i.canonical.z}var A,M,k;(i.needsCentroidUpdate||!i.centroidVertexBuffer&&i.centroidVertexArray.length!==0)&&i.uploadCentroid(t)}const GU=new wn(1,0,0,1),HU=new wn(0,1,0,1),qU=new wn(0,0,1,1),WU=new wn(1,0,1,1),ZU=new wn(0,1,1,1);function XU(t,e,n){const i=t.context,s=t.transform,l=i.gl,u=s.projection.name==="globe",h=u?["PROJECTION_GLOBE_VIEW"]:null;let f=n.projMatrix;if(u&&ro(s.zoom)>0){const re=sS(e3(n.canonical,s));f=Me.multiply(new Float32Array(16),s.globeMatrix,re),Me.multiply(f,s.projMatrix,f)}const m=t.useProgram("debug",null,h),y=e.getTileByID(n.key);t.terrain&&t.terrain.setupElevationDraw(y,m);const v=_n.disabled,w=Nn.disabled,S=t.colorModeForRenderPass(),E="$debug";i.activeTexture.set(l.TEXTURE0),t.emptyTexture.bind(l.LINEAR,l.CLAMP_TO_EDGE),u?y._makeGlobeTileDebugBuffers(t.context,s):y._makeDebugTileBoundsBuffers(t.context,s.projection);const A=y._tileDebugBuffer||t.debugBuffer,M=y._tileDebugIndexBuffer||t.debugIndexBuffer,k=y._tileDebugSegments||t.debugSegments;m.draw(t,l.LINE_STRIP,v,w,S,Vn.disabled,OP(f,wn.red),E,A,M,k,null,null,null,[y._globeTileDebugBorderBuffer]);const R=y.latestRawTileData,L=Math.floor((R&&R.byteLength||0)/1024),z=e.getTile(n).tileSize,B=512/Math.min(z,512)*(n.overscaledZ/s.zoom)*.5;let j=n.canonical.toString();n.overscaledZ!==n.canonical.z&&(j+=` => ${n.overscaledZ}`),j+=` ${L}kb`,function(re,J){re.initDebugOverlayCanvas();const ae=re.debugOverlayCanvas,le=re.context.gl,oe=re.debugOverlayCanvas.getContext("2d");oe.clearRect(0,0,ae.width,ae.height),oe.shadowColor="white",oe.shadowBlur=2,oe.lineWidth=1.5,oe.strokeStyle="white",oe.textBaseline="top",oe.font="bold 36px Open Sans, sans-serif",oe.fillText(J,5,5),oe.strokeText(J,5,5),re.debugOverlayTexture.update(ae),re.debugOverlayTexture.bind(le.LINEAR,le.CLAMP_TO_EDGE)}(t,j);const V=y._tileDebugTextBuffer||t.debugBuffer,Y=y._tileDebugTextIndexBuffer||t.quadTriangleIndexBuffer,ne=y._tileDebugTextSegments||t.debugSegments;m.draw(t,l.TRIANGLES,v,w,ur.alphaBlended,Vn.disabled,OP(f,wn.transparent,B),E,V,Y,ne,null,null,null,[y._globeTileDebugTextBuffer])}function ZP(t,e,n,i){Ex(t,0,e+n/2,t.transform.width,n,i)}function XP(t,e,n,i){Ex(t,e-n/2,0,n,t.transform.height,i)}function Ex(t,e,n,i,s,l){const u=t.context,h=u.gl;h.enable(h.SCISSOR_TEST),h.scissor(e*mn.devicePixelRatio,n*mn.devicePixelRatio,i*mn.devicePixelRatio,s*mn.devicePixelRatio),u.clear({color:l}),h.disable(h.SCISSOR_TEST)}const KU=Kn([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:YU}=KU;function Mh(t,e,n,i){t.emplaceBack(e,n,i)}class KP{constructor(e){this.vertexArray=new Ei,this.indices=new di,Mh(this.vertexArray,-1,-1,1),Mh(this.vertexArray,1,-1,1),Mh(this.vertexArray,-1,1,1),Mh(this.vertexArray,1,1,1),Mh(this.vertexArray,-1,-1,-1),Mh(this.vertexArray,1,-1,-1),Mh(this.vertexArray,-1,1,-1),Mh(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=e.createVertexBuffer(this.vertexArray,YU),this.indexBuffer=e.createIndexBuffer(this.indices),this.segment=In.simpleSegment(0,0,36,12)}}function jm(t,e,n,i,s,l){const u=t.context.gl,h=e.paint.get("sky-atmosphere-color"),f=e.paint.get("sky-atmosphere-halo-color"),m=e.paint.get("sky-atmosphere-sun-intensity"),y=((v,w,S,E,A)=>({u_matrix_3f:v,u_sun_direction:w,u_sun_intensity:S,u_color_tint_r:[E.r,E.g,E.b,E.a],u_color_tint_m:[A.r,A.g,A.b,A.a],u_luminance:5e-5}))(gs.fromMat4(gs.create(),i),s,m,h,f);u.framebufferTexture2D(u.FRAMEBUFFER,u.COLOR_ATTACHMENT0,u.TEXTURE_CUBE_MAP_POSITIVE_X+l,e.skyboxTexture,0),n.draw(t,u.TRIANGLES,_n.disabled,Nn.disabled,ur.unblended,Vn.frontCW,y,"skyboxCapture",e.skyboxGeometry.vertexBuffer,e.skyboxGeometry.indexBuffer,e.skyboxGeometry.segment)}const QU=Kn([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class JU{constructor(e){const n=new nh;n.emplaceBack(-1,1,1,0,0),n.emplaceBack(1,1,1,1,0),n.emplaceBack(1,-1,1,1,1),n.emplaceBack(-1,-1,1,0,1);const i=new di;i.emplaceBack(0,1,2),i.emplaceBack(2,3,0),this.vertexBuffer=e.createVertexBuffer(n,QU.members),this.indexBuffer=e.createIndexBuffer(i),this.segments=In.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const eV=Kn([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_size_scale",components:1},{type:"Float32",name:"a_fade_opacity",components:1}]);class tV{constructor(){this.colorModeAlphaBlendedWriteRGB=new ur([1,sx,1,sx],wn.transparent,[!0,!0,!0,!1]),this.colorModeWriteAlpha=new ur([1,0,1,0],wn.transparent,[!1,!1,!1,!0])}update(e){const n=e.context;if(!this.atmosphereBuffer){this.atmosphereBuffer=new JU(n);const i=100,s=100,l=function(y){const v=Vc(30),w=[];for(let S=0;S<16e3;++S){const E=2*Math.PI*v(),A=Math.acos(1-2*v())-.5*Math.PI;w.push(fe.fromValues(Math.cos(A)*Math.cos(E),Math.cos(A)*Math.sin(E),Math.sin(A)))}return w}(),u=Vc(300),h=new Zd,f=new di;let m=0;for(let y=0;y<l.length;++y){const v=fe.scale([],l[y],200),w=1+.01*i*(1*u()-.5),S=1+.01*s*(1*u()-.5);h.emplaceBack(v[0],v[1],v[2],-1,-1,w,S),h.emplaceBack(v[0],v[1],v[2],1,-1,w,S),h.emplaceBack(v[0],v[1],v[2],1,1,w,S),h.emplaceBack(v[0],v[1],v[2],-1,1,w,S),f.emplaceBack(m+0,m+1,m+2),f.emplaceBack(m+0,m+2,m+3),m+=4}this.starsVx=n.createVertexBuffer(h,eV.members),this.starsIdx=n.createIndexBuffer(f),this.starsSegments=In.simpleSegment(0,0,h.length,f.length)}}destroy(){this.atmosphereBuffer&&this.atmosphereBuffer.destroy(),this.starsVx&&this.starsVx.destroy(),this.starsIdx&&this.starsIdx.destroy()}drawAtmosphereGlow(e,n){const i=e.context,s=i.gl,l=e.transform,u=new _n(s.LEQUAL,_n.ReadOnly,[0,1]),h=ro(l.zoom),f=n.properties.get("color").toArray01(),m=n.properties.get("high-color").toArray01(),y=n.properties.get("space-color").toArray01PremultipliedAlpha(),v=5e-4,w=ce((n.properties.get("horizon-blend")-0)/1*.2495+v,5e-4,.25),S=o3(e,i,l)&&w===v?l.worldSize/(2*Math.PI*1.025)-1:l.globeRadius,E=e.frameCounter/1e3%1,A=fe.length(l.globeCenterInViewSpace),M=Math.sqrt(Math.pow(A,2)-Math.pow(S,2)),k=Math.acos(M/A),R=L=>{const z=l.projection.name==="globe"?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"];L&&z.push("ALPHA_PASS");const B=e.useProgram("globeAtmosphere",null,z),j=((Y,ne,re,J,ae,le,oe,Ee,xe,Pe,pe,Ae)=>({u_frustum_tl:Y,u_frustum_tr:ne,u_frustum_br:re,u_frustum_bl:J,u_horizon:ae,u_transition:le,u_fadeout_range:oe,u_color:Ee,u_high_color:xe,u_space_color:Pe,u_temporal_offset:pe,u_horizon_angle:Ae}))(l.frustumCorners.TL,l.frustumCorners.TR,l.frustumCorners.BR,l.frustumCorners.BL,l.frustumCorners.horizon,h,w,f,m,y,E,k);e.uploadCommonUniforms(i,B);const V=this.atmosphereBuffer;V&&B.draw(e,s.TRIANGLES,u,Nn.disabled,L?this.colorModeWriteAlpha:this.colorModeAlphaBlendedWriteRGB,Vn.backCW,j,L?"atmosphere_glow_alpha":"atmosphere_glow",V.vertexBuffer,V.indexBuffer,V.segments)};R(!1),R(!0)}drawStars(e,n){const i=ce(n.properties.get("star-intensity"),0,1);if(i===0)return;const s=e.context,l=s.gl,u=e.transform,h=e.useProgram("stars"),f=uo.identity([]);uo.rotateX(f,f,-u._pitch),uo.rotateZ(f,f,-u.angle),uo.rotateX(f,f,Be(u._center.lat)),uo.rotateY(f,f,-Be(u._center.lng));const m=Me.fromQuat(new Float32Array(16),f),y=Me.multiply([],u.starsProjMatrix,m),v=gs.fromMat4([],m),w=gs.invert([],v),S=[0,1,0];fe.transformMat3(S,S,w),fe.scale(S,S,.2);const E=[1,0,0];fe.transformMat3(E,E,w),fe.scale(E,E,.2);const A=((M,k,R,L)=>({u_matrix:Float32Array.from(M),u_up:k,u_right:R,u_intensity_multiplier:L}))(y,S,E,i);e.uploadCommonUniforms(s,h),this.starsVx&&this.starsIdx&&h.draw(e,l.TRIANGLES,_n.disabled,Nn.disabled,this.colorModeAlphaBlendedWriteRGB,Vn.disabled,A,"atmosphere_stars",this.starsVx,this.starsIdx,this.starsSegments)}}function YP(t,e){const n=[...t],i=e.cameraWorldSizeForFog/e.worldSize,s=Me.identity([]);return Me.scale(s,s,[i,i,1]),Me.multiply(n,s,n),Me.multiply(n,e.worldToFogMatrix,n),n}function SE(t,e,n,i){const s=n.material,l=s.pbrMetallicRoughness,u=i.context;if(l.baseColorTexture){t.push("HAS_TEXTURE_u_baseColorTexture"),u.activeTexture.set(u.gl.TEXTURE0+Os.BaseColor);const h=l.baseColorTexture.sampler;l.baseColorTexture.gfxTexture&&l.baseColorTexture.gfxTexture.bindExtraParam(h.minFilter,h.magFilter,h.wrapS,h.wrapT)}if(l.metallicRoughnessTexture){t.push("HAS_TEXTURE_u_metallicRoughnessTexture"),u.activeTexture.set(u.gl.TEXTURE0+Os.MetallicRoughness);const h=l.metallicRoughnessTexture.sampler;l.metallicRoughnessTexture.gfxTexture&&l.metallicRoughnessTexture.gfxTexture.bindExtraParam(h.minFilter,h.magFilter,h.wrapS,h.wrapT)}if(s.normalTexture){t.push("HAS_TEXTURE_u_normalTexture"),u.activeTexture.set(u.gl.TEXTURE0+Os.Normal);const h=s.normalTexture.sampler;s.normalTexture.gfxTexture&&s.normalTexture.gfxTexture.bindExtraParam(h.minFilter,h.magFilter,h.wrapS,h.wrapT)}if(s.occlusionTexture){t.push("HAS_TEXTURE_u_occlusionTexture"),u.activeTexture.set(u.gl.TEXTURE0+Os.Occlusion);const h=s.occlusionTexture.sampler;s.occlusionTexture.gfxTexture&&s.occlusionTexture.gfxTexture.bindExtraParam(h.minFilter,h.magFilter,h.wrapS,h.wrapT)}if(s.emissionTexture){t.push("HAS_TEXTURE_u_emissionTexture"),u.activeTexture.set(u.gl.TEXTURE0+Os.Emission);const h=s.emissionTexture.sampler;s.emissionTexture.gfxTexture&&s.emissionTexture.gfxTexture.bindExtraParam(h.minFilter,h.magFilter,h.wrapS,h.wrapT)}n.texcoordBuffer&&(t.push("HAS_ATTRIBUTE_a_uv_2f"),e.push(n.texcoordBuffer)),n.colorBuffer&&(t.push(n.colorBuffer.itemSize===12?"HAS_ATTRIBUTE_a_color_3f":"HAS_ATTRIBUTE_a_color_4f"),e.push(n.colorBuffer)),n.normalBuffer&&(t.push("HAS_ATTRIBUTE_a_normal_3f"),e.push(n.normalBuffer)),n.pbrBuffer&&(t.push("HAS_ATTRIBUTE_a_pbr"),t.push("HAS_ATTRIBUTE_a_heightBasedEmissiveStrength"),e.push(n.pbrBuffer)),s.alphaMode!=="OPAQUE"&&s.alphaMode!=="MASK"||t.push("UNPREMULT_TEXTURE_IN_SHADER"),s.defined||t.push("DIFFUSE_SHADED"),t.push("USE_STANDARD_DERIVATIVES")}function Tx(t,e,n,i,s,l){const u=n.paint.get("model-opacity"),h=e.context,f=new _n(e.context.gl.LEQUAL,_n.ReadWrite,e.depthRangeFor3D),m=t.mesh,y=m.material,v=y.pbrMetallicRoughness;let w;w=e.transform.projection.zAxisUnit==="pixels"?[...t.nodeModelMatrix]:Me.multiply([],i.zScaleMatrix,t.nodeModelMatrix),Me.multiply(w,i.negCameraPosMatrix,w);const S=Me.invert([],w);Me.transpose(S,S);const E=wE(new Float32Array(t.worldViewProjection),new Float32Array(w),new Float32Array(S),e,u,v.baseColorFactor,y.emissiveFactor,v.metallicFactor,v.roughnessFactor,y,n),A=[],M=[];SE(A,M,m,e);const k=e.shadowRenderer;k&&(k.useNormalOffset=!1);const R=e.useProgram("model",null,A);let L=null;if(e.style.fog){const z=YP(t.nodeModelMatrix,e.transform);A.push("FOG","FOG_DITHERING"),L=new Float32Array(z)}e.uploadCommonUniforms(h,R,null,L),e.renderPass!=="shadow"&&k&&k.setupShadowsFromMatrix(t.nodeModelMatrix,R),R.draw(e,h.gl.TRIANGLES,f,s,l,Vn.backCCW,E,n.id,m.vertexBuffer,m.indexBuffer,m.segments,n.paint,e.transform.zoom,void 0,M)}function QP(t,e,n,i,s,l,u){let h;h=t.projection.name==="globe"?KI(n,t):[...n],Me.multiply(h,h,e.matrix);const f=Me.multiply([],i,h);if(e.meshes)for(const m of e.meshes){if(m.material.alphaMode!=="BLEND"){u.push({mesh:m,depth:0,modelIndex:s,worldViewProjection:f,nodeModelMatrix:h});continue}const y=fe.transformMat4([],m.centroid,f);y[2]>0&&l.push({mesh:m,depth:y[2],modelIndex:s,worldViewProjection:f,nodeModelMatrix:h})}if(e.children)for(const m of e.children)QP(t,m,n,i,s,l,u)}function EE(t,e,n,i){const s=n.shadowRenderer;if(!s)return;const l=s.getShadowPassDepthMode(),u=s.getShadowPassColorMode(),h=s.calculateShadowPassMatrixFromMatrix(e),f=$P(h);n.useProgram("modelDepth",null,["DEPTH_TEXTURE"]).draw(n,n.context.gl.TRIANGLES,l,Nn.disabled,u,Vn.backCCW,f,i.id,t.vertexBuffer,t.indexBuffer,t.segments,i.paint,n.transform.zoom,void 0,void 0)}function nV(t,e,n){let i,s,l,u=t.terrain?t.terrain.exaggeration():0;if(t.terrain&&u>0){const h=t.terrain,f=h.findDEMTileFor(n);f&&f.dem?i=Sm.create(h,n,f):u=0}if(u===0&&(e.terrainElevationMin=0,e.terrainElevationMax=0),u!==e.validForExaggeration||!(u===0||i&&i._demTile&&i._demTile.tileID===e.validForDEMTile)){for(const h in e.instancesPerModel){const f=e.instancesPerModel[h];for(let m=0;m<f.instancedDataArray.length;++m){const y=(i?u*i.getElevationAt(0|f.instancedDataArray.float32[16*m],0|f.instancedDataArray.float32[16*m+1],!0,!0):0)+f.instancesEvaluatedElevation[m];f.instancedDataArray.float32[16*m+6]=y,s=s?Math.min(e.terrainElevationMin,y):y,l=l?Math.max(e.terrainElevationMax,y):y}}e.terrainElevationMin=s||0,e.terrainElevationMax=l||0,e.validForExaggeration=u,e.validForDEMTile=i&&i._demTile?i._demTile.tileID:void 0,e.uploaded=!1,e.upload(t.context)}}const lc={shadowUniformsInitialized:!1,tileMatrix:new Float64Array(16),shadowTileMatrix:new Float32Array(16),aabb:new ri([0,0,0],[Ge,Ge,0])};function JP(t,e,n,i,s,l,u){const h=t.context,f=t.renderPass==="shadow",m=t.shadowRenderer,y=f&&m?m.getShadowPassDepthMode():new _n(h.gl.LEQUAL,_n.ReadWrite,t.depthRangeFor3D),v=f&&m?m.getShadowPassColorMode():t.colorModeForRenderPass();if(n.meshes)for(const w of n.meshes){const S=["MODEL_POSITION_ON_GPU"],E=[];let A,M;if(f&&m)A=t.useProgram("modelDepth",null,S),M=$P(u.shadowTileMatrix,u.shadowTileMatrix,Float32Array.from(n.matrix));else{SE(S,E,w,t),A=t.useProgram("model",null,S);const R=w.material,L=R.pbrMetallicRoughness;M=wE(l.projMatrix,Float32Array.from(n.matrix),new Float32Array(16),t,e.paint.get("model-opacity"),L.baseColorFactor,R.emissiveFactor,L.metallicFactor,L.roughnessFactor,R,e,s),m&&(u.shadowUniformsInitialized?A.setShadowUniformValues(h,m.getShadowUniformValues()):(m.setupShadows(l.toUnwrapped(),A,"model-tile",l.overscaledZ),u.shadowUniformsInitialized=!0))}t.uploadCommonUniforms(h,A,l.toUnwrapped());const k=f?"u_instance":"u_normal_matrix";for(let R=0;R<i.instancedDataArray.length;++R)M[k]=new Float32Array(i.instancedDataArray.arrayBuffer,64*R,16),A.draw(t,h.gl.TRIANGLES,y,Nn.disabled,v,Vn.disabled,M,e.id,w.vertexBuffer,w.indexBuffer,w.segments,e.paint,t.transform.zoom,void 0,E)}if(n.children)for(const w of n.children)JP(t,e,w,i,s,l,u)}const rV=[1,-1,1];function iV(t,e,n,i,s,l,u,h){if(n.renderPass==="opaque")return;const f=t.node,m=n.context,y=n.renderPass==="light-beam",v=[...l];for(let w=0;w<f.meshes.length;++w){const S=f.meshes[w],E=w===f.lightMeshIndex;if(E){if(!y&&!n.terrain&&n.shadowRenderer){n.currentLayer<n.firstLightBeamLayer&&(n.firstLightBeamLayer=n.currentLayer);continue}}else if(y)continue;const A=[],M=[];SE(A,M,S,n),4&e||A.push("DIFFUSE_SHADED");const k=t.evaluatedScale;let R=0;n.terrain&&f.elevation&&(R=f.elevation*n.terrain.exaggeration()),Me.translate(v,v,[(f.anchor?f.anchor[0]:0)*(k[0]-1),(f.anchor?f.anchor[1]:0)*(k[1]-1),R]),k!==V8&&Me.scale(v,v,k),Me.multiply(v,v,f.matrix);const L=n.renderPass==="shadow";if(L)return void EE(S,v,n,i);let z=null;if(n.style.fog){const oe=YP(v,n.transform);A.push("FOG","FOG_DITHERING"),z=new Float32Array(oe)}const B=n.useProgram("model",null,A),j=Me.multiply([],u,v);Me.multiply(j,h,j);const V=Me.invert([],j);Me.transpose(V,V),Me.scale(V,V,rV);const Y=Me.multiply([],n.transform.projMatrix,v),ne=n.shadowRenderer;!L&&ne&&(ne.useNormalOffset=!!S.normalBuffer,ne.setupShadowsFromMatrix(v,B,ne.useNormalOffset)),n.uploadCommonUniforms(m,B,s.toUnwrapped(),z);const re=S.material,J=re.pbrMetallicRoughness;J.metallicFactor=.9,J.roughnessFactor=.5;const ae=wE(new Float32Array(Y),new Float32Array(j),new Float32Array(V),n,i.paint.get("model-opacity"),J.baseColorFactor,re.emissiveFactor,J.metallicFactor,J.roughnessFactor,re,i),le=new _n(m.gl.LEQUAL,E?_n.ReadOnly:_n.ReadWrite,n.depthRangeFor3D);B.draw(n,m.gl.TRIANGLES,le,Nn.disabled,n.colorModeForRenderPass(),Vn.backCCW,ae,i.id,S.vertexBuffer,S.indexBuffer,S.segments,i.paint,n.transform.zoom,void 0,M)}}function oV(t,e,n,i){if(!n.modelManager)return!0;const s=n.modelManager;if(!n.shadowRenderer)return!0;const l=n.shadowRenderer,u=e.aabb;let h=!0,f=t.maxHeight;if(f===0){let y=0;for(const v in t.instancesPerModel){const w=s.getModel(v,i);w?y=Math.max(y,Math.max(Math.max(w.aabb.max[0],w.aabb.max[1]),w.aabb.max[2])):h=!1}f=t.maxScale*y*1.41+t.maxVerticalOffset,h&&(t.maxHeight=f)}u.max[2]=f,u.min[2]+=t.terrainElevationMin,u.max[2]+=t.terrainElevationMax,fe.transformMat4(u.min,u.min,e.tileMatrix),fe.transformMat4(u.max,u.max,e.tileMatrix);const m=u.intersects(l.getCurrentCascadeFrustum());return n.currentShadowCascade===0&&(t.isInsideFirstShadowMapFrustum=m===2),m===0}class sV{}class aV{constructor(){this._storage=new Map}getLinesFromTrianglesBuffer(e,n,i){if(!i.isWebGL2)return;{const w=this._storage.get(n.id);if(w)return w.lastUsedFrameIdx=e,w.buf}const s=i.gl,l=i.gl,u=l.getBufferParameter(s.ELEMENT_ARRAY_BUFFER,s.BUFFER_SIZE),h=new ArrayBuffer(u),f=new Int16Array(h);l.getBufferSubData(s.ELEMENT_ARRAY_BUFFER,0,new Int16Array(h));const m=new sl;for(let w=0;w<u/2;w+=3){const S=f[w],E=f[w+1],A=f[w+2];m.emplaceBack(S,E),m.emplaceBack(E,A),m.emplaceBack(A,S)}const y=i.bindVertexArrayOES.current,v=new sV;return v.buf=new Sh(i,m),v.lastUsedFrameIdx=e,this._storage.set(n.id,v),i.bindVertexArrayOES.set(y),v.buf}update(e){for(const[n,i]of this._storage)e-i.lastUsedFrameIdx>30&&(i.buf.destroy(),this._storage.delete(n))}destroy(){for(const[e,n]of this._storage)n.buf.destroy(),this._storage.delete(e)}}const eR={symbol:function(t,e,n,i,s){if(t.renderPass!=="translucent")return;const l=Nn.disabled,u=t.colorModeForRenderPass();n.layout.get("text-variable-anchor")&&function(h,f,m,y,v,w,S){const E=f.transform,A=v==="map",M=w==="map";for(const k of h){const R=y.getTile(k),L=R.getBucket(m);if(!L||!L.text||!L.text.segments.get().length)continue;const z=ru(L.textSizeData,E.zoom),B=cE(k,L.getProjection(),E),j=E.calculatePixelsToTileUnitsMatrix(R),V=lx(B,R.tileID.canonical,M,A,E,L.getProjection(),j),Y=L.hasIconTextFit()&&L.hasIconData();if(z){const ne=Math.pow(2,E.zoom-R.tileID.overscaledZ);UU(L,A,M,S,h6,E,V,k,ne,z,Y)}}}(i,t,n,e,n.layout.get("text-rotation-alignment"),n.layout.get("text-pitch-alignment"),s),n.paint.get("icon-opacity").constantOr(1)!==0&&qP(t,e,n,i,!1,n.paint.get("icon-translate"),n.paint.get("icon-translate-anchor"),n.layout.get("icon-rotation-alignment"),n.layout.get("icon-pitch-alignment"),n.layout.get("icon-keep-upright"),l,u),n.paint.get("text-opacity").constantOr(1)!==0&&qP(t,e,n,i,!0,n.paint.get("text-translate"),n.paint.get("text-translate-anchor"),n.layout.get("text-rotation-alignment"),n.layout.get("text-pitch-alignment"),n.layout.get("text-keep-upright"),l,u),e.map.showCollisionBoxes&&(GP(t,e,n,i,n.paint.get("text-translate"),n.paint.get("text-translate-anchor"),!0),GP(t,e,n,i,n.paint.get("icon-translate"),n.paint.get("icon-translate-anchor"),!1))},circle:function(t,e,n,i){if(t.renderPass!=="translucent")return;const s=n.paint.get("circle-opacity"),l=n.paint.get("circle-stroke-width"),u=n.paint.get("circle-stroke-opacity"),h=n.layout.get("circle-sort-key").constantOr(1)!==void 0,f=n.paint.get("circle-emissive-strength");if(s.constantOr(1)===0&&(l.constantOr(1)===0||u.constantOr(1)===0))return;const m=t.context,y=m.gl,v=t.transform,w=t.depthModeForSublayer(0,_n.ReadOnly),S=Nn.disabled,E=t.colorModeForDrapableLayerRenderPass(f),A=v.projection.name==="globe",M=[io(v.center.lng),co(v.center.lat)],k=[];for(let L=0;L<i.length;L++){const z=i[L],B=e.getTile(z),j=B.getBucket(n);if(!j||j.projection.name!==v.projection.name)continue;const V=j.programConfigurations.get(n.id),Y=AU(n);A&&Y.push("PROJECTION_GLOBE_VIEW");const ne=t.useProgram("circle",V,Y),re=j.layoutVertexBuffer,J=j.globeExtVertexBuffer,ae=j.indexBuffer,le=v.projection.createInversionMatrix(v,z.canonical),oe={programConfiguration:V,program:ne,layoutVertexBuffer:re,globeExtVertexBuffer:J,indexBuffer:ae,uniformValues:CU(t,z,B,le,M,n),tile:B};if(h){const Ee=j.segments.get();for(const xe of Ee)k.push({segments:new In([xe]),sortKey:xe.sortKey,state:oe})}else k.push({segments:j.segments,sortKey:0,state:oe})}h&&k.sort((L,z)=>L.sortKey-z.sortKey);const R={useDepthForOcclusion:!A};for(const L of k){const{programConfiguration:z,program:B,layoutVertexBuffer:j,globeExtVertexBuffer:V,indexBuffer:Y,uniformValues:ne,tile:re}=L.state,J=L.segments;t.terrain&&t.terrain.setupElevationDraw(re,B,R),t.uploadCommonUniforms(m,B,re.tileID.toUnwrapped()),B.draw(t,y.TRIANGLES,w,S,E,Vn.disabled,ne,n.id,j,Y,J,n.paint,v.zoom,z,[V])}},heatmap:function(t,e,n,i){if(n.paint.get("heatmap-opacity")!==0)if(t.renderPass==="offscreen"){const s=t.context,l=s.gl,u=Nn.disabled,h=new ur([l.ONE,l.ONE,l.ONE,l.ONE],wn.transparent,[!0,!0,!0,!0]);(function(S,E,A,M){const k=S.gl,R=E.width*M,L=E.height*M;S.activeTexture.set(k.TEXTURE1),S.viewport.set([0,0,R,L]);let z=A.heatmapFbo;if(!z||z&&(z.width!==R||z.height!==L)){z&&z.destroy();const B=k.createTexture();k.bindTexture(k.TEXTURE_2D,B),k.texParameteri(k.TEXTURE_2D,k.TEXTURE_WRAP_S,k.CLAMP_TO_EDGE),k.texParameteri(k.TEXTURE_2D,k.TEXTURE_WRAP_T,k.CLAMP_TO_EDGE),k.texParameteri(k.TEXTURE_2D,k.TEXTURE_MIN_FILTER,k.LINEAR),k.texParameteri(k.TEXTURE_2D,k.TEXTURE_MAG_FILTER,k.LINEAR),z=A.heatmapFbo=S.createFramebuffer(R,L,!0,null),function(j,V,Y,ne,re,J){const ae=j.gl;ae.texImage2D(ae.TEXTURE_2D,0,j.isWebGL2&&j.extRenderToTextureHalfFloat?ae.RGBA16F:ae.RGBA,re,J,0,ae.RGBA,j.extRenderToTextureHalfFloat?j.isWebGL2?ae.HALF_FLOAT:j.extTextureHalfFloat.HALF_FLOAT_OES:ae.UNSIGNED_BYTE,null),ne.colorAttachment.set(Y)}(S,0,B,z,R,L)}else k.bindTexture(k.TEXTURE_2D,z.colorAttachment.get()),S.bindFramebuffer.set(z.framebuffer)})(s,t,n,t.transform.projection.name==="globe"?.5:.25),s.clear({color:wn.transparent});const f=t.transform,m=f.projection.name==="globe",y=m?["PROJECTION_GLOBE_VIEW"]:null,v=m?Vn.frontCCW:Vn.disabled,w=[io(f.center.lng),co(f.center.lat)];for(let S=0;S<i.length;S++){const E=i[S];if(e.hasRenderableParent(E))continue;const A=e.getTile(E),M=A.getBucket(n);if(!M||M.projection.name!==f.projection.name)continue;const k=M.programConfigurations.get(n.id),R=t.useProgram("heatmap",k,y),{zoom:L}=t.transform;t.terrain&&t.terrain.setupElevationDraw(A,R),t.uploadCommonUniforms(s,R,E.toUnwrapped());const z=f.projection.createInversionMatrix(f,E.canonical);R.draw(t,l.TRIANGLES,_n.disabled,u,h,v,kU(t,E,A,z,w,L,n.paint.get("heatmap-intensity")),n.id,M.layoutVertexBuffer,M.indexBuffer,M.segments,n.paint,t.transform.zoom,k,m?[M.globeExtVertexBuffer]:null)}s.viewport.set([0,0,t.width,t.height])}else t.renderPass==="translucent"&&(t.context.setColorMode(t.colorModeForRenderPass()),function(s,l){const u=s.context,h=u.gl,f=l.heatmapFbo;if(!f)return;u.activeTexture.set(h.TEXTURE0),h.bindTexture(h.TEXTURE_2D,f.colorAttachment.get()),u.activeTexture.set(h.TEXTURE1);let m=l.colorRampTexture;m||(m=l.colorRampTexture=new Ai(u,l.colorRamp,h.RGBA)),m.bind(h.LINEAR,h.CLAMP_TO_EDGE),s.useProgram("heatmapTexture").draw(s,h.TRIANGLES,_n.disabled,Nn.disabled,s.colorModeForRenderPass(),Vn.disabled,((y,v,w,S)=>({u_image:0,u_color_ramp:1,u_opacity:v.paint.get("heatmap-opacity")}))(0,l),l.id,s.viewportBuffer,s.quadTriangleIndexBuffer,s.viewportSegments,l.paint,s.transform.zoom)}(t,n))},line:function(t,e,n,i){if(t.renderPass!=="translucent")return;const s=n.paint.get("line-opacity"),l=n.paint.get("line-width");if(s.constantOr(1)===0||l.constantOr(1)===0)return;const u=n.paint.get("line-emissive-strength"),h=t.depthModeForSublayer(0,_n.ReadOnly),f=t.colorModeForDrapableLayerRenderPass(u),m=t.terrain&&t.terrain.renderingToTexture?1:mn.devicePixelRatio,y=n.paint.get("line-dasharray"),v=y.constantOr(1),w=n.layout.get("line-cap"),S=n.paint.get("line-pattern"),E=S.constantOr(1),A=n.paint.get("line-gradient"),M=E?"linePattern":"line",k=t.context,R=k.gl,L=(B=>{const j=[];BP(B)&&j.push("RENDER_LINE_DASH"),B.paint.get("line-gradient")&&j.push("RENDER_LINE_GRADIENT");const V=B.paint.get("line-trim-offset");V[0]===0&&V[1]===0||j.push("RENDER_LINE_TRIM_OFFSET");const Y=B.paint.get("line-pattern").constantOr(1),ne=B.paint.get("line-opacity").constantOr(1)!==1;return!Y&&ne&&j.push("RENDER_LINE_ALPHA_DISCARD"),B.paint.get("line-border-width").constantOr(0)>0&&j.push("RENDER_LINE_BORDER"),B.paint.get("line-border-color").constantOr(wn.transparent).a===0&&j.push("RENDER_LINE_BORDER_AUTO"),j})(n);let z=L.includes("RENDER_LINE_ALPHA_DISCARD");t.terrain&&t.terrain.clipOrMaskOverlapStencilType()&&(z=!1);for(const B of i){const j=e.getTile(B);if(E&&!j.patternsLoaded())continue;const V=j.getBucket(n);if(!V)continue;t.prepareDrawTile();const Y=V.programConfigurations.get(n.id),ne=t.useProgram(M,Y,L),re=S.constantOr(null);if(re&&j.imageAtlas){const pe=j.imageAtlas.patternPositions[re.toString()];pe&&Y.setConstantPatternPositions(pe)}const J=y.constantOr(null),ae=w.constantOr(null);if(!E&&J&&ae&&j.lineAtlas){const pe=j.lineAtlas.getDash(J,ae);pe&&Y.setConstantPatternPositions(pe)}let[le,oe]=n.paint.get("line-trim-offset");(ae==="round"||ae==="square")&&le!==oe&&(le===0&&(le-=1),oe===1&&(oe+=1));const Ee=t.terrain?B.projMatrix:null,xe=E?RU(t,j,n,Ee,m):PU(t,j,n,Ee,V.lineClipsArray.length,m,[le,oe]);if(A){const pe=V.gradients[n.id];let Ae=pe.texture;if(n.gradientVersion!==pe.version){let Le=256;if(n.stepInterpolant){const qe=e.getSource().maxzoom,Ve=B.canonical.z===qe?Math.ceil(1<<t.transform.maxZoom-B.canonical.z):1;Le=ce(Ln(V.maxLineLength/Ge*1024*Ve),256,k.maxTextureSize)}pe.gradient=k1({expression:n.gradientExpression(),evaluationKey:"lineProgress",resolution:Le,image:pe.gradient||void 0,clips:V.lineClipsArray}),pe.texture?pe.texture.update(pe.gradient):pe.texture=new Ai(k,pe.gradient,R.RGBA),pe.version=n.gradientVersion,Ae=pe.texture}k.activeTexture.set(R.TEXTURE1),Ae.bind(n.stepInterpolant?R.NEAREST:R.LINEAR,R.CLAMP_TO_EDGE)}v&&(k.activeTexture.set(R.TEXTURE0),j.lineAtlasTexture.bind(R.LINEAR,R.REPEAT),Y.updatePaintBuffers()),E&&(k.activeTexture.set(R.TEXTURE0),j.imageAtlasTexture.bind(R.LINEAR,R.CLAMP_TO_EDGE),Y.updatePaintBuffers()),t.uploadCommonUniforms(k,ne,B.toUnwrapped());const Pe=pe=>{ne.draw(t,R.TRIANGLES,h,pe,f,Vn.disabled,xe,n.id,V.layoutVertexBuffer,V.indexBuffer,V.segments,n.paint,t.transform.zoom,Y,[V.layoutVertexBuffer2])};if(z){const pe=t.stencilModeForClipping(B).ref;pe===0&&t.terrain&&k.clear({stencil:0});const Ae={func:R.EQUAL,mask:255};xe.u_alpha_discard_threshold=.8,Pe(new Nn(Ae,pe,255,R.KEEP,R.KEEP,R.INVERT)),xe.u_alpha_discard_threshold=0,Pe(new Nn(Ae,pe,255,R.KEEP,R.KEEP,R.KEEP))}else Pe(t.stencilModeForClipping(B))}z&&(t.resetStencilClippingMasks(),t.terrain&&k.clear({stencil:0}))},fill:function(t,e,n,i){const s=n.paint.get("fill-color"),l=n.paint.get("fill-opacity");if(l.constantOr(1)===0)return;const u=n.paint.get("fill-emissive-strength"),h=t.colorModeForDrapableLayerRenderPass(u),f=n.paint.get("fill-pattern"),m=t.opaquePassEnabledForLayer()&&!f.constantOr(1)&&s.constantOr(wn.transparent).a===1&&l.constantOr(0)===1?"opaque":"translucent";if(t.renderPass===m){const y=t.depthModeForSublayer(1,t.renderPass==="opaque"?_n.ReadWrite:_n.ReadOnly);WP(t,e,n,i,y,h,!1)}if(t.renderPass==="translucent"&&n.paint.get("fill-antialias")){const y=t.depthModeForSublayer(n.getPaintProperty("fill-outline-color")?2:0,_n.ReadOnly);WP(t,e,n,i,y,h,!0)}},"fill-extrusion":function(t,e,n,i){const s=n.paint.get("fill-extrusion-opacity"),l=t.context,u=l.gl,h=t.terrain,f=h&&h.renderingToTexture;if(s===0)return;const m=t.conflationActive&&t.layerUsedInConflation(n,e.getSource());if(m&&function(y,v,w,S){for(const E of S){const A=v.getTile(E).getBucket(w);A&&(A.updateReplacement(E,y.replacementSource),A.uploadCentroid(y.context))}}(t,e,n,i),h||m)for(const y of i){const v=e.getTile(y).getBucket(n);v&&$U(t.context,e,y,v,n,h,m)}if(t.renderPass==="shadow"&&t.shadowRenderer){const y=t.shadowRenderer,v=y.getShadowPassDepthMode(),w=y.getShadowPassColorMode();Sx(t,e,n,i,v,Nn.disabled,w,m)}else if(t.renderPass==="translucent"){const y=!n.paint.get("fill-extrusion-pattern").constantOr(1);if(!f){const w=new _n(t.context.gl.LEQUAL,_n.ReadWrite,t.depthRangeFor3D);if(s===1&&y){const S=t.colorModeForRenderPass();Sx(t,e,n,i,w,Nn.disabled,S,m)}else Sx(t,e,n,i,w,Nn.disabled,ur.disabled,m),Sx(t,e,n,i,w,t.stencilModeFor3D(),t.colorModeForRenderPass(),m),t.resetStencilClippingMasks()}const v=t.style.enable3dLights();if(t.context.isWebGL2&&v&&y&&(!h&&t.transform.projection.name!=="globe"||f)){const w=n.paint.get("fill-extrusion-opacity"),S=n.paint.get("fill-extrusion-ambient-occlusion-intensity"),E=n.paint.get("fill-extrusion-ambient-occlusion-ground-radius"),A=n.paint.get("fill-extrusion-flood-light-intensity"),M=n.paint.get("fill-extrusion-flood-light-color").toArray01().slice(0,3),k=S>0&&E>0,R=A>0,L=(B,j,V)=>(1-V)*B+V*j,z=B=>{const j=t.depthModeForSublayer(1,_n.ReadOnly,u.LEQUAL,!0),V=n.paint.get(B?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),Y=L(.1,3,V),ne=t._showOverdrawInspector;{const re=new Nn({func:u.ALWAYS,mask:255},255,255,u.KEEP,u.KEEP,u.REPLACE),J=new ur([u.ONE,u.ONE,u.ONE,u.ONE],wn.transparent,[!1,!1,!1,!0],u.MIN);Nm(t,e,n,i,j,re,J,Vn.disabled,B,"sdf",w,S,E,A,M,Y,m)}{const re=new Nn({func:u.EQUAL,mask:255},255,255,u.KEEP,u.DECR,u.DECR),J=new ur([u.ONE_MINUS_DST_ALPHA,u.DST_ALPHA,u.ONE,u.ONE],wn.transparent,[!0,!0,!0,!0]);Nm(t,e,n,i,j,re,ne?t.colorModeForRenderPass():J,Vn.disabled,B,"color",w,S,E,A,M,Y,m)}};if(f){const B=(j,V)=>{const Y=t.depthModeForSublayer(1,_n.ReadOnly,u.LEQUAL,!1),ne=n.paint.get(j?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),re=L(.1,3,ne);{const J=new ur([u.ONE,u.ONE,u.ONE,u.ONE],wn.transparent,[!1,!1,!1,!0]);Nm(t,e,n,i,Y,Nn.disabled,J,Vn.disabled,j,"clear",w,S,E,A,M,re,m)}{const J=new Nn({func:u.ALWAYS,mask:255},255,255,u.KEEP,u.KEEP,u.REPLACE),ae=new ur([u.ONE,u.ONE,u.ONE,u.ONE],wn.transparent,[!1,!1,!1,!0],u.MIN);Nm(t,e,n,i,Y,J,ae,Vn.disabled,j,"sdf",w,S,E,A,M,re,m)}{const J=j?u.ZERO:u.ONE_MINUS_DST_ALPHA,ae=new Nn({func:u.EQUAL,mask:255},255,255,u.KEEP,u.DECR,u.DECR),le=new ur([J,u.DST_ALPHA,u.ONE_MINUS_DST_ALPHA,u.ZERO],wn.transparent,[!0,!0,!0,!0]);Nm(t,e,n,i,Y,ae,le,Vn.disabled,j,"color",w,S,E,A,M,re,m)}{const J=new ur([u.ONE,u.ONE,u.ONE,j?u.ZERO:u.ONE],wn.transparent,[!1,!1,!1,!0],j?u.FUNC_ADD:u.MAX);Nm(t,e,n,i,Y,Nn.disabled,J,Vn.disabled,j,"clear",w,S,E,A,M,re,m,V)}};if(k||R){let j;if(t.prepareDrawTile(),h){const V=h.drapeBufferSize[0],Y=h.drapeBufferSize[1];j=h.framebufferCopyTexture,j&&(!j||j.size[0]===V&&j.size[1]===Y)||(j&&j.destroy(),j=h.framebufferCopyTexture=new Ai(l,new ui({width:V,height:Y}),u.RGBA)),j.bind(u.LINEAR,u.CLAMP_TO_EDGE),u.copyTexImage2D(u.TEXTURE_2D,0,u.RGBA,0,0,V,Y,0)}k&&B(!0,j),R&&B(!1,j)}}else k&&z(!0),R&&z(!1)}}},hillshade:function(t,e,n,i){if(t.renderPass!=="offscreen"&&t.renderPass!=="translucent")return;const s=t.context,l=t.depthModeForSublayer(0,_n.ReadOnly),u=t.colorModeForRenderPass(),h=t.terrain&&t.terrain.renderingToTexture,[f,m]=t.renderPass!=="translucent"||h?[{},i]:t.stencilConfigForOverlap(i);for(const y of m){const v=e.getTile(y);if(v.needsHillshadePrepare&&t.renderPass==="offscreen")uU(t,v,n,l,Nn.disabled,u);else if(t.renderPass==="translucent"){const w=h&&t.terrain?t.terrain.stencilModeForRTTOverlap(y):f[y.overscaledZ];lU(t,y,v,n,l,w,u)}}s.viewport.set([0,0,t.width,t.height]),t.resetStencilClippingMasks()},raster:function(t,e,n,i,s,l){if(t.renderPass!=="translucent"||n.paint.get("raster-opacity")===0||!i.length)return;const u=t.context,h=u.gl,f=e.getSource(),m=function(k,R,L){const z=[];let B,j;if(k.paint.get("raster-color")){z.push("RASTER_COLOR"),B=k.paint.get("raster-color-mix"),j=k.paint.get("raster-color-range"),R.activeTexture.set(L.TEXTURE2);let V=k.colorRampTexture;V||(V=k.colorRampTexture=new Ai(R,k.colorRamp,L.RGBA)),V.bind(L.LINEAR,L.CLAMP_TO_EDGE)}return{mix:B,range:j,defines:z}}(n,u,h),y=t.useProgram("raster",null,m.defines),v=t.colorModeForDrapableLayerRenderPass(),w=t.terrain&&t.terrain.renderingToTexture,[S,E]=f instanceof pf||w?[{},i]:t.stencilConfigForOverlap(i),A=E[E.length-1].overscaledZ,M=!t.options.moving;for(const k of E){const R=w?_n.disabled:t.depthModeForSublayer(k.overscaledZ-A,n.paint.get("raster-opacity")===1?_n.ReadWrite:_n.ReadOnly,h.LESS),L=k.toUnwrapped(),z=e.getTile(k);if(w&&(!z||!z.hasData()))continue;const B=w?k.projMatrix:t.transform.calculateProjMatrix(L,M),j=t.terrain&&w?t.terrain.stencilModeForRTTOverlap(k):S[k.overscaledZ],V=l?0:n.paint.get("raster-fade-duration");z.registerFadeDuration(V);const Y=e.findLoadedParent(k,0),ne=MP(z,Y,e,t.transform,V);let re,J;t.terrain&&t.terrain.prepareDrawTile();const ae=n.paint.get("raster-resampling")==="nearest"?h.NEAREST:h.LINEAR;u.activeTexture.set(h.TEXTURE0),z.texture.bind(ae,h.CLAMP_TO_EDGE),u.activeTexture.set(h.TEXTURE1),Y?(Y.texture.bind(ae,h.CLAMP_TO_EDGE),re=Math.pow(2,Y.tileID.overscaledZ-z.tileID.overscaledZ),J=[z.tileID.canonical.x*re%1,z.tileID.canonical.y*re%1]):z.texture.bind(ae,h.CLAMP_TO_EDGE),z.texture.useMipmap&&u.extTextureFilterAnisotropic&&t.transform.pitch>20&&h.texParameterf(h.TEXTURE_2D,u.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,u.extTextureFilterAnisotropicMax);const le=DU(B,J||[0,0],re||1,ne,n,f instanceof pf?f.perspectiveTransform:[0,0],2,m.mix||[0,0,0,0],m.range||[0,0]);if(t.uploadCommonUniforms(u,y,L),f instanceof pf)f.boundsBuffer&&f.boundsSegments&&y.draw(t,h.TRIANGLES,R,Nn.disabled,v,Vn.disabled,le,n.id,f.boundsBuffer,t.quadTriangleIndexBuffer,f.boundsSegments);else{const{tileBoundsBuffer:oe,tileBoundsIndexBuffer:Ee,tileBoundsSegments:xe}=t.getTileBoundsBuffers(z);y.draw(t,h.TRIANGLES,R,j,v,Vn.disabled,le,n.id,oe,Ee,xe)}}t.resetStencilClippingMasks()},background:function(t,e,n,i){const s=n.paint.get("background-color"),l=n.paint.get("background-opacity"),u=n.paint.get("background-emissive-strength");if(l===0)return;const h=t.context,f=h.gl,m=t.transform,y=m.tileSize,v=n.paint.get("background-pattern");if(t.isPatternMissing(v,n.scope))return;const w=!v&&s.a===1&&l===1&&t.opaquePassEnabledForLayer()?"opaque":"translucent";if(t.renderPass!==w)return;const S=Nn.disabled,E=t.depthModeForSublayer(0,w==="opaque"?_n.ReadWrite:_n.ReadOnly),A=t.colorModeForDrapableLayerRenderPass(u),M=t.useProgram(v?"backgroundPattern":"background");let k,R=i;R||(k=t.getBackgroundTiles(),R=Object.values(k).map(L=>L.tileID)),v&&(h.activeTexture.set(f.TEXTURE0),t.imageManager.bind(t.context,n.scope));for(const L of R){const z=L.toUnwrapped(),B=i?L.projMatrix:t.transform.calculateProjMatrix(z);t.prepareDrawTile();const j=e?e.getTile(L):k?k[L.key]:new E_(L,y,m.zoom,t),V=v?BU(B,u,l,t,v,n.scope,{tileID:L,tileSize:y}):FU(B,u,l,s);t.uploadCommonUniforms(h,M,z);const{tileBoundsBuffer:Y,tileBoundsIndexBuffer:ne,tileBoundsSegments:re}=t.getTileBoundsBuffers(j);M.draw(t,f.TRIANGLES,E,S,A,Vn.disabled,V,n.id,Y,ne,re)}},sky:function(t,e,n){const i=t._atmosphere?ro(t.transform.zoom):1,s=n.paint.get("sky-opacity")*i;if(s===0)return;const l=t.context,u=n.paint.get("sky-type"),h=new _n(l.gl.LEQUAL,_n.ReadOnly,[0,1]),f=t.frameCounter/1e3%1;u==="atmosphere"?t.renderPass==="offscreen"?n.needsSkyboxCapture(t)&&(function(m,y,v,w){const S=m.context,E=S.gl;let A=y.skyboxFbo;if(!A){A=y.skyboxFbo=S.createFramebuffer(32,32,!0,null),y.skyboxGeometry=new KP(S),y.skyboxTexture=S.gl.createTexture(),E.bindTexture(E.TEXTURE_CUBE_MAP,y.skyboxTexture),E.texParameteri(E.TEXTURE_CUBE_MAP,E.TEXTURE_WRAP_S,E.CLAMP_TO_EDGE),E.texParameteri(E.TEXTURE_CUBE_MAP,E.TEXTURE_WRAP_T,E.CLAMP_TO_EDGE),E.texParameteri(E.TEXTURE_CUBE_MAP,E.TEXTURE_MIN_FILTER,E.LINEAR),E.texParameteri(E.TEXTURE_CUBE_MAP,E.TEXTURE_MAG_FILTER,E.LINEAR);for(let L=0;L<6;++L)E.texImage2D(E.TEXTURE_CUBE_MAP_POSITIVE_X+L,0,E.RGBA,32,32,0,E.RGBA,E.UNSIGNED_BYTE,null)}S.bindFramebuffer.set(A.framebuffer),S.viewport.set([0,0,32,32]);const M=y.getCenter(m,!0),k=m.useProgram("skyboxCapture"),R=new Float64Array(16);Me.identity(R),Me.rotateY(R,R,.5*-Math.PI),jm(m,y,k,R,M,0),Me.identity(R),Me.rotateY(R,R,.5*Math.PI),jm(m,y,k,R,M,1),Me.identity(R),Me.rotateX(R,R,.5*-Math.PI),jm(m,y,k,R,M,2),Me.identity(R),Me.rotateX(R,R,.5*Math.PI),jm(m,y,k,R,M,3),Me.identity(R),jm(m,y,k,R,M,4),Me.identity(R),Me.rotateY(R,R,Math.PI),jm(m,y,k,R,M,5),S.viewport.set([0,0,m.width,m.height])}(t,n),n.markSkyboxValid(t)):t.renderPass==="sky"&&function(m,y,v,w,S){const E=m.context,A=E.gl,M=m.transform,k=m.useProgram("skybox");E.activeTexture.set(A.TEXTURE0),A.bindTexture(A.TEXTURE_CUBE_MAP,y.skyboxTexture);const R=((L,z,B,j,V)=>({u_matrix:L,u_sun_direction:z,u_cubemap:0,u_opacity:j,u_temporal_offset:V}))(M.skyboxMatrix,y.getCenter(m,!1),0,w,S);m.uploadCommonUniforms(E,k),k.draw(m,A.TRIANGLES,v,Nn.disabled,m.colorModeForRenderPass(),Vn.backCW,R,"skybox",y.skyboxGeometry.vertexBuffer,y.skyboxGeometry.indexBuffer,y.skyboxGeometry.segment)}(t,n,h,s,f):u==="gradient"&&t.renderPass==="sky"&&function(m,y,v,w,S){const E=m.context,A=E.gl,M=m.transform,k=m.useProgram("skyboxGradient");y.skyboxGeometry||(y.skyboxGeometry=new KP(E)),E.activeTexture.set(A.TEXTURE0);let R=y.colorRampTexture;R||(R=y.colorRampTexture=new Ai(E,y.colorRamp,A.RGBA)),R.bind(A.LINEAR,A.CLAMP_TO_EDGE);const L=((z,B,j,V,Y)=>({u_matrix:z,u_color_ramp:0,u_center_direction:B,u_radius:Be(j),u_opacity:V,u_temporal_offset:Y}))(M.skyboxMatrix,y.getCenter(m,!1),y.paint.get("sky-gradient-radius"),w,S);m.uploadCommonUniforms(E,k),k.draw(m,A.TRIANGLES,v,Nn.disabled,m.colorModeForRenderPass(),Vn.backCW,L,"skyboxGradient",y.skyboxGeometry.vertexBuffer,y.skyboxGeometry.indexBuffer,y.skyboxGeometry.segment)}(t,n,h,s,f)},debug:function(t,e,n){for(let i=0;i<n.length;i++)XU(t,e,n[i])},custom:function(t,e,n,i){const s=t.context,l=n.implementation;if(!t.transform.projection.unsupportedLayers||!t.transform.projection.unsupportedLayers.includes("custom")||t.terrain&&(t.terrain.renderingToTexture||t.renderPass==="offscreen")&&n.isLayerDraped()){if(t.renderPass==="offscreen"){const u=l.prerender;if(u){if(t.setCustomLayerDefaults(),s.setColorMode(t.colorModeForRenderPass()),t.transform.projection.name==="globe"){const h=t.transform.pointMerc;u.call(l,s.gl,t.transform.customLayerMatrix(),t.transform.getProjection(),t.transform.globeToMercatorMatrix(),ro(t.transform.zoom),[h.x,h.y],t.transform.pixelsPerMeterRatio)}else u.call(l,s.gl,t.transform.customLayerMatrix());s.setDirty(),t.setBaseState()}}else if(t.renderPass==="translucent"){if(t.terrain&&t.terrain.renderingToTexture){const h=l.renderToTile;if(h){const f=i[0].canonical,m=new Un(f.x+i[0].wrap*(1<<f.z),f.y,f.z);s.setDepthMode(_n.disabled),s.setStencilMode(Nn.disabled),s.setColorMode(t.colorModeForRenderPass()),t.setCustomLayerDefaults(),h.call(l,s.gl,m),s.setDirty(),t.setBaseState()}return}t.setCustomLayerDefaults(),s.setColorMode(t.colorModeForRenderPass()),s.setStencilMode(Nn.disabled);const u=l.renderingMode==="3d"?new _n(t.context.gl.LEQUAL,_n.ReadWrite,t.depthRangeFor3D):t.depthModeForSublayer(0,_n.ReadOnly);if(s.setDepthMode(u),t.transform.projection.name==="globe"){const h=t.transform.pointMerc;l.render(s.gl,t.transform.customLayerMatrix(),t.transform.getProjection(),t.transform.globeToMercatorMatrix(),ro(t.transform.zoom),[h.x,h.y],t.transform.pixelsPerMeterRatio)}else l.render(s.gl,t.transform.customLayerMatrix());s.setDirty(),t.setBaseState(),s.bindFramebuffer.set(null)}}else ye("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")},model:function(t,e,n,i){if(t.renderPass==="opaque")return;const s=n.paint.get("model-opacity");if(s===0)return;const l=n.paint.get("model-cast-shadows");if(t.renderPass==="shadow"&&!l)return;const u=t.shadowRenderer,h=n.paint.get("model-receive-shadows");u&&(u.useNormalOffset=!0,h||(u.enabled=!1));const f=()=>{u&&(u.useNormalOffset=!0,h||(u.enabled=!0))},m=e.getSource();if(t.renderPass==="light-beam"&&m.type!=="batched-model"||!m.loaded())return;if(m.type==="vector"||m.type==="geojson")return function(k,R,L,z){const B=k.transform;if(B.projection.name!=="mercator")return void ye(`Drawing 3D models for ${B.projection.name} projection is not yet implemented`);const j=B.getFreeCameraOptions().position,V=[j.x,j.y,j.z-B.pixelsPerMeter/B.worldSize*B._centerAltitude],Y=k.transform._camera.forward(),ne=[0,0,0],re=[0,0,0];if(!k.modelManager)return;const J=k.modelManager;if(!L._unevaluatedLayout._values.hasOwnProperty("model-id"))return;const ae=L._unevaluatedLayout._values["model-id"],le={...L.layout.get("model-id").parameters};for(const oe of z){const Ee=R.getTile(oe).getBucket(L);if(!Ee||Ee.projection.name!==B.projection.name)continue;let xe=Ee.zoom;re[0]=oe.wrap+(oe.canonical.x+(k.transform.bearing<0?.75:.25))/(1<<oe.canonical.z),re[1]=(oe.canonical.y+(Math.abs(k.transform.bearing)<90?.75:.25))/(1<<oe.canonical.z),fe.sub(ne,re,V);const Pe=Math.max(0,fe.dot(ne,Y));xe=k.transform._zoomFromMercatorZ(Pe),k.transform.pitch>30&&xe<k.transform.zoom&&Ee.instanceCount>400&&(xe-=.5),le.zoom=xe;const pe=ae.possiblyEvaluate(le);if(nV(k,Ee,oe),lc.shadowUniformsInitialized=!1,k.renderPass==="shadow"&&k.shadowRenderer){const Le=k.shadowRenderer;if(k.currentShadowCascade===1&&Ee.isInsideFirstShadowMapFrustum)continue;const qe=B.calculatePosMatrix(oe.toUnwrapped(),B.worldSize);if(lc.tileMatrix.set(qe),lc.shadowTileMatrix=Float32Array.from(Le.calculateShadowPassMatrixFromMatrix(qe)),lc.aabb.min.fill(0),lc.aabb.max[0]=lc.aabb.max[1]=Ge,lc.aabb.max[2]=0,oV(Ee,lc,k,L.scope))continue}let Ae=fe.scale([],V,1<<oe.canonical.z);Ae=[(Ae[0]-oe.canonical.x-oe.wrap*(1<<oe.canonical.z))*Ge,(Ae[1]-oe.canonical.y)*Ge,Ae[2]*Ge];for(let Le in Ee.instancesPerModel){const qe=Ee.instancesPerModel[Le];qe.features.length>0&&(Le=pe.evaluate(qe.features[0].feature,{}));const Ve=J.getModel(Le,L.scope);if(Ve)for(const yt of Ve.nodes)JP(k,L,yt,qe,Ae,oe,lc)}}}(t,e,n,i),void f();if(m.type==="batched-model")return function(k,R,L,z){const B=k.transform;if(B.projection.name!=="mercator")return void ye(`Drawing 3D landmark models for ${B.projection.name} projection is not yet implemented`);const j=k.transform.getFreeCameraOptions().position,V=fe.scale([],[j.x,j.y,j.z],k.transform.worldSize);fe.negate(V,V);const Y=Me.identity([]),ne=ph(B.center.lat,B.zoom),re=Me.fromScaling([],[1,1,1/ne]);Me.translate(Y,Y,V),function(J,ae,le,oe){const Ee=J.terrain?J.terrain.exaggeration():0,xe=J.transform.zoom;for(const Pe of oe){const pe=ae.getTile(Pe).getBucket(le);pe&&(J.conflationActive&&pe.updateReplacement(Pe,J.replacementSource),pe.evaluateScale(J,le),J.terrain&&Ee>0&&pe.elevationUpdate(J.terrain,Ee,Pe),pe.needsReEvaluation(J,xe,le)&&pe.evaluate(le))}}(k,R,L,z);for(const J of z){const ae=R.getTile(J).getBucket(L);if(!ae||!ae.uploaded)continue;const le=B.calculatePosMatrix(J.toUnwrapped(),B.worldSize),oe=ae.getNodesInfo();for(const Ee of oe)Ee.hiddenByReplacement||Ee.node.meshes&&iV(Ee,ae.modelTraits,k,L,J,le,re,Y)}}(t,e,n,i),void f();const y=m.getModels(),v=[],w=t.transform.getFreeCameraOptions().position,S=fe.scale([],[w.x,w.y,w.z],t.transform.worldSize);fe.negate(S,S);const E=[],A=[];let M=0;for(const k of y){const R=n.paint.get("model-rotation").constantOr(null),L=n.paint.get("model-scale").constantOr(null),z=n.paint.get("model-translation").constantOr(null);k.computeModelMatrix(t,R,L,z,!0,!0,!1);const B=Me.identity([]),j=ph(k.position.lat,t.transform.zoom),V=Me.fromScaling([],[1,1,1/j]);Me.translate(B,B,S),v.push({zScaleMatrix:V,negCameraPosMatrix:B});for(const Y of k.nodes)QP(t.transform,Y,k.matrix,t.transform.projMatrix,M,E,A);M++}if(E.sort((k,R)=>R.depth-k.depth),t.renderPass!=="shadow"){if(s===1)for(const k of A)Tx(k,t,n,v[k.modelIndex],Nn.disabled,t.colorModeForRenderPass());else{for(const k of A)Tx(k,t,n,v[k.modelIndex],Nn.disabled,ur.disabled);for(const k of A)Tx(k,t,n,v[k.modelIndex],t.stencilModeFor3D(),t.colorModeForRenderPass());t.resetStencilClippingMasks()}for(const k of E)Tx(k,t,n,v[k.modelIndex],Nn.disabled,t.colorModeForRenderPass());f()}else{for(const k of A)EE(k.mesh,k.nodeModelMatrix,t,n);for(const k of E)EE(k.mesh,k.nodeModelMatrix,t,n);f()}}},tR={modelUpload:function(t,e,n){const i=e.getSource();if(!i.loaded())return;if(i.type==="vector"||i.type==="geojson")return void(t.modelManager&&t.modelManager.upload(t,n));if(i.type==="batched-model")return;const s=i.getModels();for(const l of s)l.upload(t.context)}};class lV{constructor(e,n,i=!1){this.context=new R8(e,i),this.transform=n,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.setup(),this.numSublayers=_l.maxUnderzooming+_l.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={},this.conflationActive=!1,this.replacementSource=new Z8,this._shadowRenderer=new cU(this),this._wireframeDebugCache=new aV}updateTerrain(e,n){const i=!!e&&!!e.terrain&&this.transform.projection.supportsTerrain;if(!(i||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new mU(this,e));const s=this._terrain;this.transform.elevation=i?s:null,s.update(e,this.transform,n)}_updateFog(e){const n=e.fog;if(!n||this.transform.projection.name==="globe"||n.getOpacity(this.transform.pitch)<1||n.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[i,s]=n.getFovAdjustedRange(this.transform._fov);if(i>s)return void(this.transform.fogCullDistSq=null);const l=i+.78*(s-i);this.transform.fogCullDistSq=l*l}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled?this._terrain:null}get shadowRenderer(){return this._shadowRenderer&&this._shadowRenderer.enabled?this._shadowRenderer:null}get wireframeDebugCache(){return this._wireframeDebugCache}resize(e,n){if(this.width=e*mn.devicePixelRatio,this.height=n*mn.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const i of this.style.order)this.style._layers[i].resize()}setup(){const e=this.context,n=new Bo;n.emplaceBack(0,0),n.emplaceBack(Ge,0),n.emplaceBack(0,Ge),n.emplaceBack(Ge,Ge),this.tileExtentBuffer=e.createVertexBuffer(n,hh.members),this.tileExtentSegments=In.simpleSegment(0,0,4,2);const i=new Bo;i.emplaceBack(0,0),i.emplaceBack(Ge,0),i.emplaceBack(0,Ge),i.emplaceBack(Ge,Ge),this.debugBuffer=e.createVertexBuffer(i,hh.members),this.debugSegments=In.simpleSegment(0,0,4,5);const s=new Bo;s.emplaceBack(-1,-1),s.emplaceBack(1,-1),s.emplaceBack(-1,1),s.emplaceBack(1,1),this.viewportBuffer=e.createVertexBuffer(s,hh.members),this.viewportSegments=In.simpleSegment(0,0,4,2);const l=new ql;l.emplaceBack(0,0,0,0),l.emplaceBack(Ge,0,Ge,0),l.emplaceBack(0,Ge,0,Ge),l.emplaceBack(Ge,Ge,Ge,Ge),this.mercatorBoundsBuffer=e.createVertexBuffer(l,US.members),this.mercatorBoundsSegments=In.simpleSegment(0,0,4,2);const u=new di;u.emplaceBack(0,1,2),u.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=e.createIndexBuffer(u);const h=new Ku;for(const m of[0,1,3,2,0])h.emplaceBack(m);this.debugIndexBuffer=e.createIndexBuffer(h),this.emptyTexture=new Ai(e,new ui({width:1,height:1},Uint8Array.of(0,0,0,0)),e.gl.RGBA),this.identityMat=Me.create();const f=this.context.gl;this.stencilClearMode=new Nn({func:f.ALWAYS,mask:0},0,255,f.ZERO,f.ZERO,f.ZERO),this.loadTimeStamps.push(C.performance.now())}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(e){return e._makeTileBoundsBuffers(this.context,this.transform.projection),e._tileBoundsBuffer?{tileBoundsBuffer:e._tileBoundsBuffer,tileBoundsIndexBuffer:e._tileBoundsIndexBuffer,tileBoundsSegments:e._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const e=this.context.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.useProgram("clippingMask").draw(this,e.TRIANGLES,_n.disabled,this.stencilClearMode,ur.disabled,Vn.disabled,xE(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(e,n,i){if(!n||this.currentStencilSource===n.id||!e.isTileClipped()||!i||i.length===0)return;if(this._tileClippingMaskIDs&&!this.terrain){let h=!1;for(const f of i)if(this._tileClippingMaskIDs[f.key]===void 0){h=!0;break}if(!h)return}this.currentStencilSource=n.id;const s=this.context,l=s.gl;this.nextStencilID+i.length>256&&this.clearStencil(),s.setColorMode(ur.disabled),s.setDepthMode(_n.disabled);const u=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const h of i){const f=n.getTile(h),m=this._tileClippingMaskIDs[h.key]=this.nextStencilID++,{tileBoundsBuffer:y,tileBoundsIndexBuffer:v,tileBoundsSegments:w}=this.getTileBoundsBuffers(f);u.draw(this,l.TRIANGLES,_n.disabled,new Nn({func:l.ALWAYS,mask:0},m,255,l.KEEP,l.KEEP,l.REPLACE),ur.disabled,Vn.disabled,xE(h.projMatrix),"$clipping",y,v,w)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const e=this.nextStencilID++,n=this.context.gl;return new Nn({func:n.NOTEQUAL,mask:255},e,255,n.KEEP,n.KEEP,n.REPLACE)}stencilModeForClipping(e){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(e);const n=this.context.gl;return new Nn({func:n.EQUAL,mask:255},this._tileClippingMaskIDs[e.key],0,n.KEEP,n.KEEP,n.REPLACE)}stencilConfigForOverlap(e){const n=this.context.gl,i=e.sort((u,h)=>h.overscaledZ-u.overscaledZ),s=i[i.length-1].overscaledZ,l=i[0].overscaledZ-s+1;if(l>1){this.currentStencilSource=void 0,this.nextStencilID+l>256&&this.clearStencil();const u={};for(let h=0;h<l;h++)u[h+s]=new Nn({func:n.GEQUAL,mask:255},h+this.nextStencilID,255,n.KEEP,n.KEEP,n.REPLACE);return this.nextStencilID+=l,[u,i]}return[{[s]:Nn.disabled},i]}colorModeForRenderPass(){const e=this.context.gl;return this._showOverdrawInspector?new ur([e.CONSTANT_COLOR,e.ONE,e.CONSTANT_COLOR,e.ONE],new wn(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?ur.unblended:ur.alphaBlended}colorModeForDrapableLayerRenderPass(e){const n=this.context.gl;return(()=>this.style&&this.style.enable3dLights()&&this.terrain&&this.terrain.renderingToTexture&&this.style.map._optimizeForTerrain)()&&this.renderPass==="translucent"?new ur([n.ONE,n.ONE_MINUS_SRC_ALPHA,n.CONSTANT_ALPHA,n.ONE_MINUS_SRC_ALPHA],new wn(0,0,0,e===void 0?0:e),[!0,!0,!0,!0]):this.colorModeForRenderPass()}depthModeForSublayer(e,n,i,s=!1){if(!this.opaquePassEnabledForLayer()&&!s)return _n.disabled;const l=1-((1+this.currentLayer)*this.numSublayers+e)*this.depthEpsilon;return new _n(i||this.context.gl.LEQUAL,n,[l,l])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(e,n){this._wireframeDebugCache.update(this.frameCounter),this.style=e,this.options=n;const i=this.style._layers,s=this.style.order,l=s.map(M=>i[M]),u=this.style._sourceCaches;this.imageManager=e.imageManager,this.modelManager=e.modelManager,this.symbolFadeChange=e.placement.symbolFadeChange(mn.now()),this.imageManager.beginFrame();let h=0,f=!1;for(const M in u){const k=u[M];k.used&&(k.prepare(this.context),k.getSource().usedInConflation&&++h)}const m={},y={},v={};for(const M in u){const k=u[M];m[M]=k.getVisibleCoordinates(),y[M]=m[M].slice().reverse(),v[M]=k.getVisibleCoordinates(!0).reverse()}if(h){const M=R=>{const L=this.style._getLayerSourceCache(R);return L&&L.used?L.getSource():null},k=[];for(const R of l)this.layerUsedInConflation(R,M(R))&&k.push(R);if(k&&k.length>1){const R=[];for(const L of k){const z=this.style._getLayerSourceCache(L);z&&z.used&&z.getSource().usedInConflation&&R.push({layer:L.id,cache:z})}this.replacementSource.setSources(R),f=!0}}f||this.replacementSource.clear(),this.conflationActive=f,this.opaquePassCutoff=1/0;for(let M=0;M<l.length;M++)if(l[M].is3D()){this.opaquePassCutoff=M;break}this.terrain&&(this.terrain.updateTileBinding(v),this.opaquePassCutoff=0),this._shadowRenderer&&this._shadowRenderer.updateShadowParameters(this.transform,this.style.directionalLight),this.transform.projection.name!=="globe"||this.globeSharedBuffers||(this.globeSharedBuffers=new KB(this.context));for(const M of l){if(M.isHidden(this.transform.zoom))continue;const k=e._getLayerSourceCache(M);this.uploadLayer(this,M,k)}if(this.style.fog&&this.transform.projection.supportsFog?(this._atmosphere||(this._atmosphere=new tV),this._atmosphere.update(this)):this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0),!Gf.has(this.context.gl))return;this.renderPass="offscreen";for(const M of l){const k=e._getLayerSourceCache(M);if(!M.hasOffscreenPass()||M.isHidden(this.transform.zoom))continue;const R=k?y[k.id]:void 0;(M.type==="custom"||M.isSky()||R&&R.length)&&this.renderLayer(this,k,M,R)}this.depthRangeFor3D=[0,1-(l.length+2)*this.numSublayers*this.depthEpsilon];const w=this.terrain;w&&(this.style.hasSymbolLayers()||this.style.hasCircleLayers())&&w.drawDepth(),this._shadowRenderer&&(this.renderPass="shadow",this._shadowRenderer.drawShadowPass(this.style,y)),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]);const S=(()=>{if(n.showOverdrawInspector)return wn.black;if(this.style.fog&&this.transform.projection.supportsFog){const M=this.style.fog.properties.get("space-color").toArray01();return new wn(...M)}return wn.transparent})();if(this.context.clear({color:S,depth:1}),this.clearStencil(),this._showOverdrawInspector=n.showOverdrawInspector,this.renderPass="opaque",this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&this._atmosphere.drawStars(this,this.style.fog),!this.terrain)for(this.currentLayer=s.length-1;this.currentLayer>=0;this.currentLayer--){const M=l[this.currentLayer],k=e._getLayerSourceCache(M);if(M.isSky())continue;const R=k?y[k.id]:void 0;this._renderTileClippingMasks(M,k,R),this.renderLayer(this,k,M,R)}if(this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&this._atmosphere.drawAtmosphereGlow(this,this.style.fog),this.renderPass="sky",(!this._atmosphere||ro(this.transform.zoom)>0)&&(this.transform.projection.name==="globe"||this.transform.isHorizonVisible()))for(this.currentLayer=0;this.currentLayer<s.length;this.currentLayer++){const M=l[this.currentLayer],k=e._getLayerSourceCache(M);M.isSky()&&this.renderLayer(this,k,M,k?y[k.id]:void 0)}this.renderPass="translucent",this.currentLayer=0,this.firstLightBeamLayer=Number.MAX_SAFE_INTEGER;let E=0;const A=this.shadowRenderer;for(A&&(E=A.getShadowCastingLayerCount());this.currentLayer<s.length;){const M=l[this.currentLayer],k=e._getLayerSourceCache(M);if(M.isSky()){++this.currentLayer;continue}if(w&&this.style.isLayerDraped(M)){if(M.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=w.renderBatch(this.currentLayer);continue}const R=k?(M.type==="symbol"?v:y)[k.id]:void 0;if(this._renderTileClippingMasks(M,k,k?m[k.id]:void 0),this.renderLayer(this,k,M,R),!w&&A&&E>0&&M.hasShadowPass()&&--E==0&&(A.drawGroundShadows(),this.firstLightBeamLayer<=this.currentLayer)){const L=this.currentLayer;for(this.renderPass="light-beam",this.currentLayer=this.firstLightBeamLayer;this.currentLayer<=L;this.currentLayer++){const z=l[this.currentLayer];if(!z.hasLightBeamPass())continue;const B=e._getLayerSourceCache(z);this.renderLayer(this,B,z,B?y[B.id]:void 0)}this.currentLayer=L,this.renderPass="translucent"}++this.currentLayer}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let M=null;l.forEach(k=>{const R=e._getLayerSourceCache(k);R&&!k.isHidden(this.transform.zoom)&&(!M||M.getSource().maxzoom<R.getSource().maxzoom)&&(M=R)}),M&&this.options.showTileBoundaries&&eR.debug(this,M,M.getVisibleCoordinates())}this.options.showPadding&&function(M){const k=M.transform.padding;ZP(M,M.transform.height-(k.top||0),3,GU),ZP(M,k.bottom||0,3,HU),XP(M,k.left||0,3,qU),XP(M,M.transform.width-(k.right||0),3,WU);const R=M.transform.centerPoint;(function(L,z,B,j){Ex(L,z-1,B-10,2,20,j),Ex(L,z-10,B-1,20,2,j)})(M,R.x,M.transform.height-R.y,ZU)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(C.performance.now()),this.saveCanvasCopy()),f||(this.conflationActive=!1)}uploadLayer(e,n,i){this.gpuTimingStart(n),(!e.transform.projection.unsupportedLayers||!e.transform.projection.unsupportedLayers.includes(n.type)||e.terrain&&n.type==="custom")&&tR[`${n.type}Upload`]&&tR[`${n.type}Upload`](e,i,n.scope),this.gpuTimingEnd()}renderLayer(e,n,i,s){i.isHidden(this.transform.zoom)||(i.type==="background"||i.type==="sky"||i.type==="custom"||i.type==="model"||s&&s.length)&&(this.id=i.id,this.gpuTimingStart(i),(!e.transform.projection.unsupportedLayers||!e.transform.projection.unsupportedLayers.includes(i.type)||e.terrain&&i.type==="custom")&&eR[i.type](e,n,i,s,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(e){if(!this.options.gpuTiming)return;const n=this.context.extTimerQuery;let i=this.gpuTimers[e.id];i||(i=this.gpuTimers[e.id]={calls:0,cpuTime:0,query:n.createQueryEXT()}),i.calls++,n.beginQueryEXT(n.TIME_ELAPSED_EXT,i.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const e=this.context.extTimerQuery,n=e.createQueryEXT();this.deferredRenderGpuTimeQueries.push(n),e.beginQueryEXT(e.TIME_ELAPSED_EXT,n)}}gpuTimingDeferredRenderEnd(){if(!this.options.gpuTimingDeferredRender)return;const e=this.context.extTimerQuery;e.endQueryEXT(e.TIME_ELAPSED_EXT)}gpuTimingEnd(){if(!this.options.gpuTiming)return;const e=this.context.extTimerQuery;e.endQueryEXT(e.TIME_ELAPSED_EXT)}collectGpuTimers(){const e=this.gpuTimers;return this.gpuTimers={},e}collectDeferredRenderGpuQueries(){const e=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],e}queryGpuTimers(e){const n={};for(const i in e){const s=e[i],l=this.context.extTimerQuery,u=l.getQueryObjectEXT(s.query,l.QUERY_RESULT_EXT)/1e6;l.deleteQueryEXT(s.query),n[i]=u}return n}queryGpuTimeDeferredRender(e){if(!this.options.gpuTimingDeferredRender)return 0;const n=this.context.extTimerQuery;let i=0;for(const s of e)i+=n.getQueryObjectEXT(s,n.QUERY_RESULT_EXT)/1e6,n.deleteQueryEXT(s);return i}translatePosMatrix(e,n,i,s,l){if(!i[0]&&!i[1])return e;const u=l?s==="map"?this.transform.angle:0:s==="viewport"?-this.transform.angle:0;if(u){const m=Math.sin(u),y=Math.cos(u);i=[i[0]*y-i[1]*m,i[0]*m+i[1]*y]}const h=[l?i[0]:df(n,i[0],this.transform.zoom),l?i[1]:df(n,i[1],this.transform.zoom),0],f=new Float32Array(16);return Me.translate(f,e,h),f}saveTileTexture(e){const n=this._tileTextures[e.size[0]];n?n.push(e):this._tileTextures[e.size[0]]=[e]}getTileTexture(e){const n=this._tileTextures[e];return n&&n.length>0?n.pop():null}isPatternMissing(e,n){return e===null||e!==void 0&&!this.imageManager.getPattern(e.toString(),n)}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture}currentGlobalDefines(e){const n=this.terrain&&this.terrain.renderingToTexture,i=this.terrain&&this.terrain.exaggeration()===0,s=this.style&&this.style.fog,l=[];return this.style&&this.style.enable3dLights()&&(e==="globeRaster"||e==="terrainRaster"?this.style.map._optimizeForTerrain&&(l.push("LIGHTING_3D_MODE"),l.push("LIGHTING_3D_ALPHA_EMISSIVENESS")):n&&this.style.map._optimizeForTerrain||l.push("LIGHTING_3D_MODE")),this.renderPass==="shadow"?this._shadowMapDebug||l.push("DEPTH_TEXTURE"):this.shadowRenderer&&(this.shadowRenderer.useNormalOffset?l.push("RENDER_SHADOWS","DEPTH_TEXTURE","NORMAL_OFFSET"):l.push("RENDER_SHADOWS","DEPTH_TEXTURE")),this.terrainRenderModeElevated()&&l.push("TERRAIN"),this.transform.projection.name==="globe"&&l.push("GLOBE"),i&&l.push("ZERO_EXAGGERATION"),s&&!n&&s.getOpacity(this.transform.pitch)!==0&&l.push("FOG","FOG_DITHERING"),n&&l.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&l.push("OVERDRAW_INSPECTOR"),l}useProgram(e,n,i){this.cache=this.cache||{};const s=i||[],l=this.currentGlobalDefines(e).concat(s),u=kP.cacheKey(xP[e],e,l,n);return this.cache[u]||(this.cache[u]=new kP(this.context,e,xP[e],n,NU[e],l)),this.cache[u]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const e=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(e.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=C.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new Ai(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this._terrain&&this._terrain.destroy(),this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this._wireframeDebugCache.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}uploadCommonLightUniforms(e,n){if(this.style.enable3dLights()){const i=this.style.directionalLight,s=this.style.ambientLight;if(i&&s){const l=((u,h)=>{const f=u.properties.get("direction"),m=u.properties.get("color").toArray01(),y=u.properties.get("intensity"),v=h.properties.get("color").toArray01(),w=h.properties.get("intensity"),S=[f.x,f.y,f.z],E=nr(v,w),A=nr(m,y);return{u_lighting_ambient_color:E,u_lighting_directional_dir:S,u_lighting_directional_color:A,u_ground_radiance:gU(S,A,E)}})(i,s);n.setLightsUniformValues(e,l)}}}uploadCommonUniforms(e,n,i,s){if(this.uploadCommonLightUniforms(e,n),this.terrain&&this.terrain.renderingToTexture)return;const l=this.style.fog;if(l){const u=l.getOpacity(this.transform.pitch),h=((f,m,y,v,w,S,E,A,M,k,R,L)=>{const z=f.transform,B=m.properties.get("color").toArray01();B[3]=v;const j=f.frameCounter/1e3%1;return{u_fog_matrix:y?z.calculateFogTileMatrix(y):L||f.identityMat,u_fog_range:m.getFovAdjustedRange(z._fov),u_fog_color:B,u_fog_horizon_blend:m.properties.get("horizon-blend"),u_fog_temporal_offset:j,u_frustum_tl:w,u_frustum_tr:S,u_frustum_br:E,u_frustum_bl:A,u_globe_pos:M,u_globe_radius:k,u_viewport:R,u_globe_transition:ro(z.zoom),u_is_globe:+(z.projection.name==="globe")}})(this,l,i,u,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*mn.devicePixelRatio,this.transform.height*mn.devicePixelRatio],s);n.setFogUniformValues(e,h)}}setTileLoadedFlag(e){this.tileLoaded=e}saveCanvasCopy(){const e=this.canvasCopy();e&&(this.frameCopies.push(e),this.tileLoaded=!1)}canvasCopy(){const e=this.context.gl,n=e.createTexture();return e.bindTexture(e.TEXTURE_2D,n),e.copyTexImage2D(e.TEXTURE_2D,0,e.RGBA,0,0,e.drawingBufferWidth,e.drawingBufferHeight,0),n}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const e=this.style&&this.style.fog;return!!e&&e.getOpacity(this.transform.pitch)!==0}getBackgroundTiles(){const e=this._backgroundTiles,n=this._backgroundTiles={},i=this.transform.coveringTiles({tileSize:512});for(const s of i)n[s.key]=e[s.key]||new E_(s,512,this.transform.tileZoom,this);return n}clearBackgroundTiles(){this._backgroundTiles={}}layerUsedInConflation(e,n){return!(!e.is3D()||e.minzoom&&e.minzoom>this.transform.zoom||e.sourceLayer!=="building"&&(!n||n.type!=="batched-model"))}}class uV extends Cr{constructor(e){super(),this.requestManager=e,this.models={"":{}},this.loaded={}}async loadModel(e,n){const i=rE(await Hk(n)),s=new YI(e,n,void 0,void 0,i);return s.computeBoundsAndApplyParent(),s}async load(e,n){this.models[n]||(this.models[n]={}),this.loaded[n]=!1;for(const i in e){const s=e[i],l=await this.loadModel(i,s);this.models[n][i]=l}this.loaded[n]=!0,this.fire(new ct("data",{dataType:"style"}))}isLoaded(){for(const e in this.loaded)if(!this.loaded[e])return!1;return!0}hasModel(e,n){return!!this.getModel(e,n)}getModel(e,n){return this.models[n]||(this.models[n]={}),this.models[n][e]}async addModel(e,n,i){this.models[i]||(this.models[i]={}),this.hasModel(e,i)&&this.removeModel(e,i),this.load({[e]:this.requestManager.normalizeModelURL(n)},i)}addModels(e,n){const i={};for(const s in e)i[s]=this.requestManager.normalizeModelURL(e[s]);this.load(i,n)}removeModel(e,n){this.models[n]||(this.models[n]={});const i=this.models[n][e];delete this.models[n][e],i.destroy()}listModels(e){return this.models[e]||(this.models[e]={}),Object.keys(this.models[e])}upload(e,n){this.models[n]||(this.models[n]={});for(const i in this.models[n])this.models[n][i].upload(e.context)}}const N_=(t,e)=>ti(t,e&&e.filter(n=>n.identifier!=="source.canvas")),cV=Pt(wr,["addLayer","removeLayer","setLights","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setProjection","setCamera"]),hV=Pt(wr,["setCenter","setZoom","setBearing","setPitch"]),nR={version:8,layers:[],sources:{}},dV={fill:!0,line:!0,background:!0,hillshade:!0,raster:!0};class xl extends Cr{constructor(e,n={}){super(),this.map=e,this.imports=[],this.scope=n.scope||"",this.importDepth=n.importDepth||0,this.importsCache=n.importsCache||new Map,this.resolvedImports=n.resolvedImports||new Set,this.parentCamera=n.camera,this._ownOrder=[],this._ownLayers={},this._ownSourceCaches={},this.dispatcher=n.dispatcher?n.dispatcher:new ff(O_(),this),n.imageManager?this.imageManager=n.imageManager:(this.imageManager=new fj,this.imageManager.setEventedParent(this)),this.imageManager.createScope(this.scope),this.glyphManager=n.glyphManager?n.glyphManager:new Tm(e._requestManager,n.localFontFamily?2:n.localIdeographFontFamily?1:0,n.localFontFamily||n.localIdeographFontFamily),n.modelManager?this.modelManager=n.modelManager:(this.modelManager=new uV(e._requestManager),this.modelManager.setEventedParent(this)),this.crossTileSymbolIndex=new oU,this._layers={},this._num3DLayers=0,this._numSymbolLayers=0,this._numCircleLayers=0,this._serializedLayers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._availableImages=[],this._order=[],this._drapedFirstOrder=[],this._markersNeedUpdate=!1,this.options=n.config||new Map,this._configDependentLayers=new Set,this._resetUpdates(),this.dispatcher.broadcast("setReferrer",Qe());const i=this;this._rtlTextPluginCallback=xl.registerForPluginStateChange(s=>{i.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:s.pluginStatus,pluginURL:s.pluginURL},(l,u)=>{if(By(l),u&&u.every(h=>h))for(const h in i._sourceCaches){const f=i._sourceCaches[h],m=f.getSource().type;m!=="vector"&&m!=="geojson"||f.reload()}})}),this.on("data",s=>{if(s.dataType!=="source"||s.sourceDataType!=="metadata")return;const l=this.getSource(s.sourceId);if(l&&l.vectorLayerIds)for(const u in this._layers){const h=this._layers[u];h.source===l.id&&this._validateLayer(h)}})}loadURL(e,n={}){this.fire(new ct("dataloading",{dataType:"style"}));const i=typeof n.validate=="boolean"?n.validate:!Wn(e);e=this.map._requestManager.normalizeStyleURL(e,n.accessToken),this.resolvedImports.add(e);const s=this.importsCache.get(e);if(s)return this._load(s,i);const l=this.map._requestManager.transformRequest(e,Ie.Style);this._request=ht(l,(u,h)=>{if(this._request=null,u)this.fire(new en(u));else if(h)return this.importsCache.set(e,h),this._load(h,i)})}loadJSON(e,n={}){this.fire(new ct("dataloading",{dataType:"style"})),this._request=mn.frame(()=>{this._request=null,this._load(e,n.validate!==!1)})}loadEmpty(){this.fire(new ct("dataloading",{dataType:"style"})),this._load(nR,!1)}_updateLayerCount(e,n){const i=n?1:-1;e.is3D()&&(this._num3DLayers+=i),e.type==="circle"&&(this._numCircleLayers+=i),e.type==="symbol"&&(this._numSymbolLayers+=i)}_loadImports(e,n){const i=()=>{this._mergeLayers(),this._mergeSources();for(const{style:l,id:u}of this.imports){for(const[h,f]of l.options.entries())this.options.set(zm(h,u),f);l.stylesheet.camera!=null&&(this.stylesheet.camera=l.stylesheet.camera),l.stylesheet.projection!=null&&(this.stylesheet.projection=l.stylesheet.projection),l.stylesheet.light!=null&&(this.light=l.light),l.ambientLight!=null&&(this.ambientLight=l.ambientLight),l.directionalLight!=null&&(this.directionalLight=l.directionalLight),l.terrain!=null&&(this.terrain=l.terrain),l.fog!=null&&(this.fog=l.fog)}this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._ownOrder),scope:this.scope,options:this.options}),this.fire(new ct("data",{dataType:"style"})),this.fire(new ct("style.load"))};if(this.importDepth>=4)return ye("Style doesn't support nesting deeper than 5"),i();const s=[];for(const l of e){const u=this.scope?zm(l.id,this.scope):l.id,h=new Map,f=l.config;if(f)for(const w of Object.keys(f)){const S=Ar(f[w]);S.result==="success"&&h.set(w,S.value.expression)}const m=new xl(this.map,{scope:u,importDepth:this.importDepth+1,importsCache:this.importsCache,resolvedImports:new Set(this.resolvedImports),dispatcher:this.dispatcher,imageManager:this.imageManager,glyphManager:this.glyphManager,modelManager:this.modelManager,camera:this.stylesheet.camera,config:h});m.setEventedParent(this.map,{style:m});const y=new Promise(w=>m.on("style.load",w));if(s.push(y),this.resolvedImports.has(l.url)){m.loadEmpty();continue}const v=l.data||this.importsCache.get(l.url);v?m.loadJSON(v,{validate:n}):l.url?m.loadURL(l.url,{validate:n}):m.loadEmpty(),this.imports.push({id:l.id,style:m,config:l.config})}Promise.all(s).then(i)}_load(e,n){const i=e.schema;if(this.importDepth===0&&(e.fragment||i)){const h=ge({},nR,{imports:[{id:"basemap",data:e,url:""}]});return void this._load(h,n)}if(i)for(const h of Object.keys(i)){if(this.options.has(h))continue;const f=Ar(i[h].default);f.result==="success"&&this.options.set(h,f.value.expression)}if(n&&N_(this,Gu(e)))return;this._loaded=!0,this.stylesheet=te(e),this._updateMapProjection();for(const h in e.sources){const f=zm(h,this.scope);this.addSource(f,e.sources[h],{validate:!1})}this._changed=!1,e.sprite?this._loadSprite(e.sprite):(this.imageManager.setLoaded(!0,this.scope),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0})),this.glyphManager.setURL(e.glyphs,this.scope);const s=Zk(this.stylesheet.layers);this._ownOrder=s.map(h=>zm(h.id,this.scope)),this._ownLayers={},this._serializedLayers={};for(const h of s){const f=gx(h,this.options);f.id=zm(f.id,this.scope),f.scope=this.scope,f.isConfigDependent&&this._configDependentLayers.add(f.id),f.source&&(f.source=zm(f.source,this.scope)),f.setEventedParent(this,{layer:{id:f.id}}),this._layers[f.id]=f,this._ownLayers[f.id]=f,this._serializedLayers[f.id]=f.serialize(),this._updateLayerCount(f,!0)}if(this.stylesheet.light&&console.log("The `light` root property is deprecated, prefer using `lights` with `flat` light type instead."),this.stylesheet.lights)if(this.stylesheet.lights.length===1&&this.stylesheet.lights[0].type==="flat"){const h=this.stylesheet.lights[0];this.light=new Ak(h.properties,h.id)}else this.setLights(this.stylesheet.lights);this.light||(this.light=new Ak(this.stylesheet.light)),this.stylesheet.models&&this.modelManager.addModels(this.stylesheet.models,this.scope);const l=this.stylesheet.terrain;l&&!this.terrainSetForDrapingOnly()&&this._createTerrain(l,1),this.stylesheet.fog&&this._createFog(this.stylesheet.fog);const u=this.stylesheet.camera=this.stylesheet.camera||this.parentCamera||{"camera-projection":"perspective"};this.map.setCamera(u),this._mergeLayers(),this._mergeSources(),this.fire(new ct("data",{dataType:"style"})),e.imports?this._loadImports(e.imports,n):(this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._ownOrder),scope:this.scope,options:this.options}),this.fire(new ct("style.load")))}_mergeSources(){const e={},n={},i={};(function s(l){for(const u of l.imports)s(u.style);for(const u in l._sourceCaches)e[u]=l._sourceCaches[u];for(const u in l._otherSourceCaches)n[u]=l._otherSourceCaches[u];for(const u in l._symbolSourceCaches)i[u]=l._symbolSourceCaches[u]})(this),this._sourceCaches=e,this._otherSourceCaches=n,this._symbolSourceCaches=i}_mergeLayers(){const e={},n=[],i={};(function l(u){for(const h of u.imports)l(h.style);for(const h of u._ownOrder){const f=u._ownLayers[h];if(f.type==="slot"){const m=sP(h);if(e[m])continue;e[m]=[]}f.slot&&e[f.slot]?e[f.slot].push(f):n.push(f)}})(this),this._order=[];const s=(l=[])=>{for(const u of l)if(u.type==="slot"){const h=sP(u.id);e[h]&&s(e[h])}else this._order.push(u.id),i[u.id]=u};s(n),this._layers=i,this._updateDrapeFirstLayers()}terrainSetForDrapingOnly(){return!!this.terrain&&this.terrain.drapeRenderMode===0}setProjection(e){e?this.stylesheet.projection=e:delete this.stylesheet.projection,this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?this.getTerrain()||this.stylesheet.terrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null))}_updateMapProjection(){this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.stylesheet.projection)}_loadSprite(e){this._spriteRequest=function(n,i,s){let l,u,h;const f=mn.devicePixelRatio>1?"@2x":"";let m=ht(i.transformRequest(i.normalizeSpriteURL(n,f,".json"),Ie.SpriteJSON),(w,S)=>{m=null,h||(h=w,l=S,v())}),y=xn(i.transformRequest(i.normalizeSpriteURL(n,f,".png"),Ie.SpriteImage),(w,S)=>{y=null,h||(h=w,u=S,v())});function v(){if(h)s(h);else if(l&&u){const w=mn.getImageData(u),S={};for(const E in l){const{width:A,height:M,x:k,y:R,sdf:L,pixelRatio:z,stretchX:B,stretchY:j,content:V}=l[E],Y=new ui({width:A,height:M});ui.copy(w,Y,{x:k,y:R},{x:0,y:0},{width:A,height:M}),S[E]={data:Y,pixelRatio:z,sdf:L,stretchX:B,stretchY:j,content:V}}s(null,S)}}return{cancel(){m&&(m.cancel(),m=null),y&&(y.cancel(),y=null)}}}(e,this.map._requestManager,(n,i)=>{if(this._spriteRequest=null,n)this.fire(new en(n));else if(i)for(const s in i)this.imageManager.addImage(s,this.scope,i[s]);this.imageManager.setLoaded(!0,this.scope),this._availableImages=this.imageManager.listImages(this.scope),this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages}),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0}),this.fire(new ct("data",{dataType:"style"}))})}_validateLayer(e){const n=this.getSource(e.source);if(!n)return;const i=e.sourceLayer;i&&(n.type==="geojson"||n.vectorLayerIds&&n.vectorLayerIds.indexOf(i)===-1)&&this.fire(new en(new Error(`Source layer "${i}" does not exist on source "${n.id}" as specified by style layer "${e.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const e in this._sourceCaches)if(!this._sourceCaches[e].loaded())return!1;if(!this.imageManager.isLoaded()||this.stylesheet.models&&!this.modelManager.isLoaded())return!1;for(const{style:e}of this.imports)if(!e.loaded())return!1;return!0}_serializeLayers(e){const n=[];for(const i of e){const s=this._layers[i];s&&s.type!=="custom"&&n.push(s.serialize())}return n}hasTransitions(){if(this.light&&this.light.hasTransition()||this.fog&&this.fog.hasTransition())return!0;for(const e in this._sourceCaches)if(this._sourceCaches[e].hasTransition())return!0;for(const e in this._layers)if(this._layers[e].hasTransition())return!0;return!1}get order(){return this.map._optimizeForTerrain&&this.terrain?this._drapedFirstOrder:this._order}isLayerDraped(e){return!!this.terrain&&(typeof e.isLayerDraped=="function"?e.isLayerDraped():dV[e.type])}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}update(e){if(!this._loaded)return;e.brightness!==this._brightness&&(this._brightness=e.brightness,this.dispatcher.broadcast("setBrightness",e.brightness));const n=this._changed;if(this._changed){const s=Object.keys(this._updatedLayers),l=Object.keys(this._removedLayers);if(s.length||l.length){const u={};for(const h of s){const f=aP(h);(u[f]=u[f]||{updatedIds:[],removedIds:[]}).updatedIds.push(h)}for(const h of l){const f=aP(h);(u[f]=u[f]||{updatedIds:[],removedIds:[]}).removedIds.push(h)}for(const[h,{updatedIds:f,removedIds:m}]of Object.entries(u))this.getFragmentById(h)._updateWorkerLayers(f,m)}for(const u in this._updatedSources){const h=this._updatedSources[u];h==="reload"?this._reloadSource(u):h==="clear"&&this._clearSource(u)}this._updateTilesForChangedImages();for(const u in this._updatedPaintProps)this._layers[u].updateTransitions(e);this.light.updateTransitions(e),this.fog&&this.fog.updateTransitions(e),this._resetUpdates()}const i={};for(const s in this._sourceCaches){const l=this._sourceCaches[s];i[s]=l.used,l.used=!1}for(const s of this._order){const l=this._layers[s];if(l.recalculate(e,this._availableImages),!l.isHidden(e.zoom)){const h=this._getLayerSourceCache(l);h&&(h.used=!0)}const u=this.map.painter;if(u){const h=l.getProgramIds();if(!h)continue;const f=l.getProgramConfiguration(e.zoom);for(const m of h)u.useProgram(m,f)}}for(const s in i){const l=this._sourceCaches[s];i[s]!==l.used&&l.getSource().fire(new ct("data",{sourceDataType:"visibility",dataType:"source",sourceId:l.getSource().id}))}this.light.recalculate(e),this.terrain&&this.terrain.recalculate(e),this.fog&&this.fog.recalculate(e),this.z=e.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),n&&this.fire(new ct("data",{dataType:"style"}))}_updateTilesForChangedImages(){const e=Object.keys(this._changedImages);if(e.length){for(const n in this._sourceCaches)this._sourceCaches[n].reloadTilesForDependencies(["icons","patterns"],e);this._changedImages={}}}_updateWorkerLayers(e,n){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(e),scope:this.scope,removedIds:n,options:this.options})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}}setState(e){if(this._checkLoaded(),N_(this,Gu(e)))return!1;(e=te(e)).layers=Zk(e.layers);const n=function(s,l){if(!s)return[{command:wr.setStyle,args:[l]}];let u=[];try{if(!Se(s.version,l.version))return[{command:wr.setStyle,args:[l]}];Se(s.center,l.center)||u.push({command:wr.setCenter,args:[l.center]}),Se(s.zoom,l.zoom)||u.push({command:wr.setZoom,args:[l.zoom]}),Se(s.bearing,l.bearing)||u.push({command:wr.setBearing,args:[l.bearing]}),Se(s.pitch,l.pitch)||u.push({command:wr.setPitch,args:[l.pitch]}),Se(s.sprite,l.sprite)||u.push({command:wr.setSprite,args:[l.sprite]}),Se(s.glyphs,l.glyphs)||u.push({command:wr.setGlyphs,args:[l.glyphs]}),Se(s.transition,l.transition)||u.push({command:wr.setTransition,args:[l.transition]}),Se(s.light,l.light)||u.push({command:wr.setLight,args:[l.light]}),Se(s.fog,l.fog)||u.push({command:wr.setFog,args:[l.fog]}),Se(s.projection,l.projection)||u.push({command:wr.setProjection,args:[l.projection]}),Se(s.lights,l.lights)||u.push({command:wr.setLights,args:[l.lights]}),Se(s.camera,l.camera)||u.push({command:wr.setCamera,args:[l.camera]});const h={},f=[];(function(v,w,S,E){let A;for(A in w=w||{},v=v||{})v.hasOwnProperty(A)&&(w.hasOwnProperty(A)||Kk(A,S,E));for(A in w){if(!w.hasOwnProperty(A))continue;const M=w[A];v.hasOwnProperty(A)?Se(v[A],M)||(v[A].type==="geojson"&&M.type==="geojson"&&Nj(v,w,A)?S.push({command:wr.setGeoJSONSourceData,args:[A,M.data]}):Bj(A,w,S,E)):Xk(A,w,S)}})(s.sources,l.sources,f,h);const m=[];s.layers&&s.layers.forEach(v=>{v.source&&h[v.source]?u.push({command:wr.removeLayer,args:[v.id]}):m.push(v)});let y=s.terrain;y&&h[y.source]&&(u.push({command:wr.setTerrain,args:[void 0]}),y=void 0),u=u.concat(f),Se(y,l.terrain)||u.push({command:wr.setTerrain,args:[l.terrain]}),function(v,w,S){w=w||[];const E=(v=v||[]).map(Yk),A=w.map(Yk),M=v.reduce(Qk,{}),k=w.reduce(Qk,{}),R=E.slice(),L=Object.create(null);let z,B,j,V,Y,ne,re;for(z=0,B=0;z<E.length;z++)j=E[z],k.hasOwnProperty(j)?B++:(S.push({command:wr.removeLayer,args:[j]}),R.splice(R.indexOf(j,B),1));for(z=0,B=0;z<A.length;z++)j=A[A.length-1-z],R[R.length-1-z]!==j&&(M.hasOwnProperty(j)?(S.push({command:wr.removeLayer,args:[j]}),R.splice(R.lastIndexOf(j,R.length-B),1)):B++,ne=R[R.length-z],S.push({command:wr.addLayer,args:[k[j],ne]}),R.splice(R.length-z,0,j),L[j]=!0);for(z=0;z<A.length;z++)if(j=A[z],V=M[j],Y=k[j],!L[j]&&!Se(V,Y))if(Se(V.source,Y.source)&&Se(V["source-layer"],Y["source-layer"])&&Se(V.type,Y.type)){for(re in _x(V.layout,Y.layout,S,j,null,wr.setLayoutProperty),_x(V.paint,Y.paint,S,j,null,wr.setPaintProperty),Se(V.filter,Y.filter)||S.push({command:wr.setFilter,args:[j,Y.filter]}),Se(V.minzoom,Y.minzoom)&&Se(V.maxzoom,Y.maxzoom)||S.push({command:wr.setLayerZoomRange,args:[j,Y.minzoom,Y.maxzoom]}),V)V.hasOwnProperty(re)&&re!=="layout"&&re!=="paint"&&re!=="filter"&&re!=="metadata"&&re!=="minzoom"&&re!=="maxzoom"&&(re.indexOf("paint.")===0?_x(V[re],Y[re],S,j,re.slice(6),wr.setPaintProperty):Se(V[re],Y[re])||S.push({command:wr.setLayerProperty,args:[j,re,Y[re]]}));for(re in Y)Y.hasOwnProperty(re)&&!V.hasOwnProperty(re)&&re!=="layout"&&re!=="paint"&&re!=="filter"&&re!=="metadata"&&re!=="minzoom"&&re!=="maxzoom"&&(re.indexOf("paint.")===0?_x(V[re],Y[re],S,j,re.slice(6),wr.setPaintProperty):Se(V[re],Y[re])||S.push({command:wr.setLayerProperty,args:[j,re,Y[re]]}))}else S.push({command:wr.removeLayer,args:[j]}),ne=R[R.lastIndexOf(j)+1],S.push({command:wr.addLayer,args:[Y,ne]})}(m,l.layers,u)}catch(h){console.warn("Unable to compute style diff:",h),u=[{command:wr.setStyle,args:[l]}]}return u}(this.serialize(),e).filter(s=>!(s.command in hV));if(n.length===0)return!1;const i=n.filter(s=>!(s.command in cV));if(i.length>0)throw new Error(`Unimplemented: ${i.map(s=>s.command).join(", ")}.`);return n.forEach(s=>{s.command!=="setTransition"&&s.command!=="setProjection"&&this[s.command].apply(this,s.args)}),this.stylesheet=e,this._updateMapProjection(),!0}addImage(e,n){return this.getImage(e)?this.fire(new en(new Error("An image with this name already exists."))):(this.imageManager.addImage(e,this.scope,n),this._afterImageUpdated(e),this)}updateImage(e,n){this.imageManager.updateImage(e,this.scope,n)}getImage(e){return this.imageManager.getImage(e,this.scope)}removeImage(e){return this.getImage(e)?(this.imageManager.removeImage(e,this.scope),this._afterImageUpdated(e),this):this.fire(new en(new Error("No image with this name exists.")))}_afterImageUpdated(e){this._availableImages=this.imageManager.listImages(this.scope),this._changedImages[e]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages}),this.fire(new ct("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addModel(e,n,i={}){return this._checkLoaded(),this._validate(Qv,`models.${e}`,n,null,i)||(this.modelManager.addModel(e,n,this.scope),this._changed=!0),this}hasModel(e){return this.modelManager.hasModel(e,this.scope)}removeModel(e){return this.hasModel(e)?(this.modelManager.removeModel(e,this.scope),this):this.fire(new en(new Error("No model with this ID exists.")))}listModels(){return this._checkLoaded(),this.modelManager.listModels(this.scope)}addSource(e,n,i={}){if(this._checkLoaded(),this.getSource(e)!==void 0)throw new Error("There is already a source with this ID");if(!n.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(n).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(n.type)>=0&&this._validate(Zc,`sources.${e}`,n,null,i))return;this.map&&this.map._collectResourceTiming&&(n.collectResourceTiming=!0);const s=lE(e,n,this.dispatcher,this);s.scope=this.scope,s.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(e),source:s.serialize(),sourceId:e}));const l=u=>{const h=(u?"symbol:":"other:")+e,f=this._ownSourceCaches[e]=this._sourceCaches[h]=new _l(h,s,u);(u?this._symbolSourceCaches:this._otherSourceCaches)[e]=f,f.style=this,f.onAdd(this.map)};l(!1),n.type!=="vector"&&n.type!=="geojson"||l(!0),s.onAdd&&s.onAdd(this.map),this._changed=!0}removeSource(e){this._checkLoaded();const n=this.getSource(e);if(!n)throw new Error("There is no source with this ID");for(const s in this._layers)if(this._layers[s].source===e)return this.fire(new en(new Error(`Source "${e}" cannot be removed while layer "${s}" is using it.`)));if(this.terrain&&this.terrain.get().source===e)return this.fire(new en(new Error(`Source "${e}" cannot be removed while terrain is using it.`)));const i=this._getSourceCaches(e);for(const s of i)delete this._sourceCaches[s.id],delete this._updatedSources[s.id],s.fire(new ct("data",{sourceDataType:"metadata",dataType:"source",sourceId:s.getSource().id})),s.setEventedParent(null),s.clearTiles();return delete this._otherSourceCaches[e],delete this._symbolSourceCaches[e],n.setEventedParent(null),n.onRemove&&n.onRemove(this.map),this._changed=!0,this}setGeoJSONSourceData(e,n){this._checkLoaded(),this.getSource(e).setData(n),this._changed=!0}getSource(e){const n=this._getSourceCache(e);return n&&n.getSource()}getOwnSource(e){const n=this._getOwnSourceCache(e);return n&&n.getSource()}_getSources(){const e=[];for(const n in this._otherSourceCaches){const i=this._getSourceCache(n);i&&e.push(i.getSource())}return e}setLights(e){if(this._checkLoaded(),delete this.ambientLight,delete this.directionalLight,e){for(const i of e){if(this._validate(Nd,"lights",i))return;const s=this._getTransitionParameters({duration:0});switch(i.type){case"ambient":this.ambientLight=new Pk(i,wj,this.options),this.ambientLight.updateTransitions(s);break;case"directional":this.directionalLight=new Pk(i,bj,this.options),this.directionalLight.updateTransitions(s)}}const n=new Nr(this.z||0,{now:mn.now(),transition:this.getTransition()});this.ambientLight&&this.ambientLight.recalculate(n),this.directionalLight&&this.directionalLight.recalculate(n),this._brightness=this.calculateLightsBrightness(),this.dispatcher.broadcast("setBrightness",this._brightness)}}calculateLightsBrightness(){const e=this.directionalLight,n=this.ambientLight;if(!e||!n)return;const i=v=>.2126*(v[0]<=.03928?v[0]/12.92:Math.pow((v[0]+.055)/1.055,2.4))+.7152*(v[1]<=.03928?v[1]/12.92:Math.pow((v[1]+.055)/1.055,2.4))+.0722*(v[2]<=.03928?v[2]/12.92:Math.pow((v[2]+.055)/1.055,2.4)),s=e.properties.get("color").toArray01(),l=e.properties.get("intensity"),u=e.properties.get("direction"),h=1-St(u.x,u.y,u.z)[2]/90,f=i(s)*l*h,m=n.properties.get("color").toArray01(),y=n.properties.get("intensity");return(f+i(m)*y)/2}getBrightness(){return this._brightness}getLights(){if(!this.enable3dLights())return null;const e=[];return this.directionalLight&&e.push(this.directionalLight.get()),this.ambientLight&&e.push(this.ambientLight.get()),e}enable3dLights(){return!!this.ambientLight&&!!this.directionalLight}getFragmentById(e){if(!e)return this;const n=this.imports.find(({id:i})=>i===e);if(!n)throw new Error(`Style import not found: ${e}`);return n.style}setConfigProperty(e,n,i){const s=Ar(i);if(s.result==="success"){const l=s.value.expression,u=this.getFragmentById(e);u.options.set(n,l);for(const h of u._configDependentLayers){const f=this.getLayer(h);f&&this._updateLayer(f)}this._changed=!0}else N_(this,s.value)}addLayer(e,n,i={}){this._checkLoaded();const s=e.id;if(this._ownLayers[s])return void this.fire(new en(new Error(`Layer with id "${s}" already exists on this map`)));let l;if(e.type==="custom"){if(N_(this,function(f){const m=[],y=f.id;return y===void 0&&m.push({message:`layers.${y}: missing required property "id"`}),f.render===void 0&&m.push({message:`layers.${y}: missing required method "render"`}),f.renderingMode&&f.renderingMode!=="2d"&&f.renderingMode!=="3d"&&m.push({message:`layers.${y}: property "renderingMode" must be either "2d" or "3d"`}),m}(e)))return;l=gx(e,this.options)}else{if(typeof e.source=="object"&&(this.addSource(s,e.source),e=ge(e=te(e),{source:s})),this._validate(Ud,`layers.${s}`,e,{arrayIndex:-1},i))return;l=gx(e,this.options),this._validateLayer(l),l.setEventedParent(this,{layer:{id:s}}),this._serializedLayers[l.id]=l.serialize(),this._updateLayerCount(l,!0)}l.isConfigDependent&&this._configDependentLayers.add(l.id);const u=n?this._ownOrder.indexOf(n):this._ownOrder.length;if(n&&u===-1)return void this.fire(new en(new Error(`Layer with id "${n}" does not exist on this map.`)));this._ownOrder.splice(u,0,s),this._layerOrderChanged=!0,this._ownLayers[s]=l;const h=this._getLayerSourceCache(l);if(this._removedLayers[s]&&l.source&&h&&l.type!=="custom"){const f=this._removedLayers[s];delete this._removedLayers[s],f.type!==l.type?this._updatedSources[l.source]="clear":(this._updatedSources[l.source]="reload",h.pause())}this._updateLayer(l),l.onAdd&&l.onAdd(this.map),this._mergeLayers()}moveLayer(e,n){if(this._checkLoaded(),this._changed=!0,!this._ownLayers[e])return void this.fire(new en(new Error(`The layer '${e}' does not exist in the map's style and cannot be moved.`)));if(e===n)return;const i=this._ownOrder.indexOf(e);this._ownOrder.splice(i,1);const s=n?this._ownOrder.indexOf(n):this._ownOrder.length;n&&s===-1?this.fire(new en(new Error(`Layer with id "${n}" does not exist on this map.`))):(this._ownOrder.splice(s,0,e),this._layerOrderChanged=!0,this._mergeLayers())}removeLayer(e){this._checkLoaded();const n=this._ownLayers[e];if(!n)return void this.fire(new en(new Error(`The layer '${e}' does not exist in the map's style and cannot be removed.`)));n.setEventedParent(null),this._updateLayerCount(n,!1);const i=this._ownOrder.indexOf(e);this._ownOrder.splice(i,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[e]=n,delete this._ownLayers[e],delete this._serializedLayers[e],delete this._updatedLayers[e],delete this._updatedPaintProps[e],this._configDependentLayers.delete(e),n.onRemove&&n.onRemove(this.map),this._mergeLayers()}getLayer(e){return this._layers[e]}getOwnLayer(e){return this._ownLayers[e]}hasLayer(e){return e in this._layers}hasLayerType(e){for(const n in this._layers)if(this._layers[n].type===e)return!0;return!1}setLayerZoomRange(e,n,i){this._checkLoaded();const s=this.getLayer(e);s?s.minzoom===n&&s.maxzoom===i||(n!=null&&(s.minzoom=n),i!=null&&(s.maxzoom=i),this._updateLayer(s)):this.fire(new en(new Error(`The layer '${e}' does not exist in the map's style and cannot have zoom extent.`)))}setFilter(e,n,i={}){this._checkLoaded();const s=this.getLayer(e);if(s){if(!Se(s.filter,n))return n==null?(s.filter=void 0,void this._updateLayer(s)):void(this._validate(nl,`layers.${s.id}.filter`,n,{layerType:s.type},i)||(s.filter=te(n),this._updateLayer(s)))}else this.fire(new en(new Error(`The layer '${e}' does not exist in the map's style and cannot be filtered.`)))}getFilter(e){const n=this.getLayer(e);return n&&te(n.filter)}setLayoutProperty(e,n,i,s={}){this._checkLoaded();const l=this.getLayer(e);l?Se(l.getLayoutProperty(n),i)||(l.setLayoutProperty(n,i,s),l.isConfigDependent&&this._configDependentLayers.add(l.id),this._updateLayer(l)):this.fire(new en(new Error(`The layer '${e}' does not exist in the map's style and cannot be styled.`)))}getLayoutProperty(e,n){const i=this.getLayer(e);if(i)return i.getLayoutProperty(n);this.fire(new en(new Error(`The layer '${e}' does not exist in the map's style.`)))}setPaintProperty(e,n,i,s={}){this._checkLoaded();const l=this.getLayer(e);if(!l)return void this.fire(new en(new Error(`The layer '${e}' does not exist in the map's style and cannot be styled.`)));if(Se(l.getPaintProperty(n),i))return;const u=l.setPaintProperty(n,i,s);l.isConfigDependent&&this._configDependentLayers.add(l.id),u&&this._updateLayer(l),this._changed=!0,this._updatedPaintProps[e]=!0}getPaintProperty(e,n){const i=this.getLayer(e);return i&&i.getPaintProperty(n)}setFeatureState(e,n){this._checkLoaded();const i=e.source,s=e.sourceLayer,l=this.getSource(i);if(!l)return void this.fire(new en(new Error(`The source '${i}' does not exist in the map's style.`)));const u=l.type;if(u==="geojson"&&s)return void this.fire(new en(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if(u==="vector"&&!s)return void this.fire(new en(new Error("The sourceLayer parameter must be provided for vector source types.")));e.id===void 0&&this.fire(new en(new Error("The feature id parameter must be provided.")));const h=this._getSourceCaches(i);for(const f of h)f.setFeatureState(s,e.id,n)}removeFeatureState(e,n){this._checkLoaded();const i=e.source,s=this.getSource(i);if(!s)return void this.fire(new en(new Error(`The source '${i}' does not exist in the map's style.`)));const l=s.type,u=l==="vector"?e.sourceLayer:void 0;if(l==="vector"&&!u)return void this.fire(new en(new Error("The sourceLayer parameter must be provided for vector source types.")));if(n&&typeof e.id!="string"&&typeof e.id!="number")return void this.fire(new en(new Error("A feature id is required to remove its specific state property.")));const h=this._getSourceCaches(i);for(const f of h)f.removeFeatureState(u,e.id,n)}getFeatureState(e){this._checkLoaded();const n=e.source,i=e.sourceLayer,s=this.getSource(n);if(s){if(s.type!=="vector"||i)return e.id===void 0&&this.fire(new en(new Error("The feature id parameter must be provided."))),this._getSourceCaches(n)[0].getFeatureState(i,e.id);this.fire(new en(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new en(new Error(`The source '${n}' does not exist in the map's style.`)))}getTransition(){return ge({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){this._checkLoaded();const e={};for(const n in this._sourceCaches){const i=this._sourceCaches[n].getSource();e[i.id]||(e[i.id]=i.serialize())}return et({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,imports:this.stylesheet.imports,light:this.stylesheet.light,terrain:this.getTerrain()||void 0,fog:this.stylesheet.fog,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:e,layers:this._serializeLayers(this._ownOrder)},n=>n!==void 0)}_updateLayer(e){this._updatedLayers[e.id]=!0;const n=this._getLayerSourceCache(e);e.source&&!this._updatedSources[e.source]&&n&&n.getSource().type!=="raster"&&(this._updatedSources[e.source]="reload",n.pause()),this._changed=!0,e.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(e){const n=u=>this._layers[u].type==="fill-extrusion",i={},s=[];for(let u=this._order.length-1;u>=0;u--){const h=this._order[u];if(n(h)){i[h]=u;for(const f of e){const m=f[h];if(m)for(const y of m)s.push(y)}}}s.sort((u,h)=>h.intersectionZ-u.intersectionZ);const l=[];for(let u=this._order.length-1;u>=0;u--){const h=this._order[u];if(n(h))for(let f=s.length-1;f>=0;f--){const m=s[f].feature;if(i[m.layer.id]<u)break;l.push(m),s.pop()}else for(const f of e){const m=f[h];if(m)for(const y of m)l.push(y.feature)}}return l}queryRenderedFeatures(e,n,i){n&&n.filter&&this._validate(nl,"queryRenderedFeatures.filter",n.filter,null,n);const s={};if(n&&n.layers){if(!Array.isArray(n.layers))return this.fire(new en(new Error("parameters.layers must be an Array."))),[];for(const f of n.layers){const m=this._layers[f];if(!m)return this.fire(new en(new Error(`The layer '${f}' does not exist in the map's style and cannot be queried for features.`))),[];s[m.source]=!0}}const l=[];n.availableImages=this._availableImages;const u=n&&n.layers?n.layers.some(f=>{const m=this.getLayer(f);return m&&m.is3D()}):this.has3DLayers(),h=QS.createFromScreenPoints(e,i);for(const f in this._sourceCaches){const m=this._sourceCaches[f].getSource().id;n.layers&&!s[m]||l.push(Oj(this._sourceCaches[f],this._layers,this._serializedLayers,h,n,i,u,!!this.map._showQueryGeometry))}return this.placement&&l.push(function(f,m,y,v,w,S,E){const A={},M=S.queryRenderedSymbols(v),k=[];for(const R of Object.keys(M).map(Number))k.push(E[R]);k.sort(qk);for(const R of k){const L=R.featureIndex.lookupSymbolFeatures(M[R.bucketInstanceId],m,R.bucketIndex,R.sourceLayerIndex,w.filter,w.layers,w.availableImages,f);for(const z in L){const B=A[z]=A[z]||[],j=L[z];j.sort((V,Y)=>{const ne=R.featureSortOrder;if(ne){const re=ne.indexOf(V.featureIndex);return ne.indexOf(Y.featureIndex)-re}return Y.featureIndex-V.featureIndex});for(const V of j)B.push(V)}}for(const R in A)A[R].forEach(L=>{const z=L.feature,B=y(f[R]);if(!B)return;const j=B.getFeatureState(z.layer["source-layer"],z.id);z.source=z.layer.source,z.layer["source-layer"]&&(z.sourceLayer=z.layer["source-layer"]),z.state=j});return A}(this._layers,this._serializedLayers,this._getLayerSourceCache.bind(this),h.screenGeometry,n,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(l)}querySourceFeatures(e,n){n&&n.filter&&this._validate(nl,"querySourceFeatures.filter",n.filter,null,n);const i=this._getSourceCaches(e);let s=[];for(const l of i)s=s.concat(zj(l,n));return s}addSourceType(e,n,i){return xl.getSourceType(e)?i(new Error(`A source type called "${e}" already exists.`)):(xl.setSourceType(e,n),n.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:e,url:n.workerSourceURL},i):i(null,null))}getFlatLight(){return this.light.getLight()}setFlatLight(e,n,i={}){this._checkLoaded();const s=this.light.getLight();let l=!1;for(const h in e)if(!Se(e[h],s[h])){l=!0;break}if(!l)return;const u=this._getTransitionParameters({duration:300,delay:0});this.light.setLight(e,n,i),this.light.updateTransitions(u)}getTerrain(){return this.terrain&&this.terrain.drapeRenderMode===1?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}setTerrain(e,n=1){if(this._checkLoaded(),!e)return delete this.terrain,delete this.stylesheet.terrain,this.dispatcher.broadcast("enableTerrain",!1),this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);let i=e;if(n===1){if(typeof i.source=="object"){const s="terrain-dem-src";this.addSource(s,i.source),i=te(i),i=ge(i,{source:s})}if(this._validate(fa,"terrain",i))return}if(!this.terrain||this.terrain&&n!==this.terrain.drapeRenderMode){if(!i)return;this._createTerrain(i,n)}else{const s=this.terrain,l=s.get();for(const u of Object.keys(ke.terrain))!i.hasOwnProperty(u)&&ke.terrain[u].default&&(i[u]=ke.terrain[u].default);for(const u in e)if(!Se(e[u],l[u])){s.set(e),this.stylesheet.terrain=e;const h=this._getTransitionParameters({duration:0});s.updateTransitions(h);break}}this._updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(e){const n=this.fog=new _j(e,this.map.transform);this.stylesheet.fog=e;const i=this._getTransitionParameters({duration:0});n.updateTransitions(i)}_updateMarkersOpacity(){this.map._markers.length!==0&&this.map._requestDomTask(()=>{for(const e of this.map._markers)e._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(e){if(this._checkLoaded(),!e)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const n=this.fog,i=n.get();Object.keys(e).length===0&&n.set(e);for(const s in e)if(!Se(e[s],i[s])){n.set(e),this.stylesheet.fog=e;const l=this._getTransitionParameters({duration:0});n.updateTransitions(l);break}}else this._createFog(e);this._markersNeedUpdate=!0}_getTransitionParameters(e){return{now:mn.now(),transition:ge(e,this.stylesheet.transition)}}_updateDrapeFirstLayers(){if(!this.map._optimizeForTerrain||!this.terrain)return;const e=[],n=[];for(const i in this._layers){const s=this._layers[i];this.isLayerDraped(s)?e.push(s.id):n.push(s.id)}this._drapedFirstOrder=[],this._drapedFirstOrder.push(...e),this._drapedFirstOrder.push(...n)}_createTerrain(e,n){const i=this.terrain=new gj(e,n);this.stylesheet.terrain=e,this.dispatcher.broadcast("enableTerrain",!this.terrainSetForDrapingOnly()),this._updateDrapeFirstLayers(),this._force3DLayerUpdate();const s=this._getTransitionParameters({duration:0});i.updateTransitions(s)}_force3DLayerUpdate(){for(const e in this._layers){const n=this._layers[e];n.type==="fill-extrusion"&&this._updateLayer(n)}}_forceSymbolLayerUpdate(){for(const e in this._layers){const n=this._layers[e];n.type==="symbol"&&this._updateLayer(n)}}_validate(e,n,i,s,l={}){return(!l||l.validate!==!1)&&N_(this,e.call(Gu,ge({key:n,style:this.serialize(),value:i,styleSpec:ke},s)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),Op.off("pluginStateChange",this._rtlTextPluginCallback);for(const{style:e}of this.imports)e._remove();this._mergeLayers(),this._mergeSources();for(const e in this._layers)this._layers[e].setEventedParent(null);for(const e in this._sourceCaches)this._sourceCaches[e].clearTiles(),this._sourceCaches[e].setEventedParent(null);this.modelManager&&this.modelManager.setEventedParent(null),this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()}_clearSource(e){const n=this._getSourceCaches(e);for(const i of n)i.clearTiles()}_reloadSource(e){const n=this._getSourceCaches(e);for(const i of n)i.resume(),i.reload()}_reloadSources(){for(const e of this._getSources())e.reload&&e.reload()}_updateSources(e){for(const n in this._sourceCaches)this._sourceCaches[n].update(e)}_generateCollisionBoxes(){for(const e in this._sourceCaches){const n=this._sourceCaches[e];n.resume(),n.reload()}}_updatePlacement(e,n,i,s,l=!1){let u=!1,h=!1;const f={};for(const m of this._order){const y=this._layers[m];if(y.type!=="symbol")continue;if(!f[y.source]){const w=this._getLayerSourceCache(y);if(!w)continue;f[y.source]=w.getRenderableIds(!0).map(S=>w.getTileByID(S)).sort((S,E)=>E.tileID.overscaledZ-S.tileID.overscaledZ||(S.tileID.isLessThan(E.tileID)?-1:1))}const v=this.crossTileSymbolIndex.addLayer(y,f[y.source],e.center.lng,e.projection);u=u||v}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),l=l||this._layerOrderChanged||i===0,this._layerOrderChanged&&this.fire(new ct("neworder")),(l||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(mn.now(),e.zoom))&&(this.pauseablePlacement=new tU(e,this._order,l,n,i,s,this.placement,this.fog&&e.projection.supportsFog?this.fog.state:null),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,f),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(mn.now()),h=!0),u&&this.pauseablePlacement.placement.setStale()),h||u)for(const m of this._order){const y=this._layers[m];y.type==="symbol"&&this.placement.updateLayerOpacities(y,f[y.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(mn.now())}_releaseSymbolFadeTiles(){for(const e in this._sourceCaches)this._sourceCaches[e].releaseSymbolFadeTiles()}getImages(e,n,i){this.imageManager.getImages(n.icons,n.scope,i),this._updateTilesForChangedImages();const s=l=>{l&&l.setDependencies(n.tileID.key,n.type,n.icons)};s(this._otherSourceCaches[n.source]),s(this._symbolSourceCaches[n.source])}getGlyphs(e,n,i){this.glyphManager.getGlyphs(n.stacks,n.scope,i)}getResource(e,n,i){return tt(n,i)}_getSourceCache(e){return this._otherSourceCaches[e]}_getOwnSourceCache(e){return this._ownSourceCaches[e]}_getLayerSourceCache(e){return e.type==="symbol"?this._symbolSourceCaches[e.source]:this._otherSourceCaches[e.source]}_getSourceCaches(e){const n=[];return this._otherSourceCaches[e]&&n.push(this._otherSourceCaches[e]),this._symbolSourceCaches[e]&&n.push(this._symbolSourceCaches[e]),n}_isSourceCacheLoaded(e){const n=this._getSourceCaches(e);return n.length===0?(this.fire(new en(new Error(`There is no source with ID '${e}'`))),!1):n.every(i=>i.loaded())}has3DLayers(){return this._num3DLayers>0}hasSymbolLayers(){return this._numSymbolLayers>0}hasCircleLayers(){return this._numCircleLayers>0}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}function rR(t,e){let n=!1,i=null;const s=()=>{i=null,n&&(t(),i=setTimeout(s,e),n=!1)};return()=>(n=!0,i||s(),i)}xl.getSourceType=function(t){return aE[t]},xl.setSourceType=function(t,e){aE[t]=e},xl.registerForPluginStateChange=function(t){return t({pluginStatus:Fo,pluginURL:ol}),Op.on("pluginStateChange",t),t};class fV{constructor(e){this._hashName=e&&encodeURIComponent(e),On(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=rR(this._updateHashUnthrottled.bind(this),300)}addTo(e){return this._map=e,C.addEventListener("hashchange",this._onHashChange,!1),e.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),C.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const e=this._map;if(!e)return"";const n=iR(e);if(this._hashName){const i=this._hashName;let s=!1;const l=C.location.hash.slice(1).split("&").map(u=>{const h=u.split("=")[0];return h===i?(s=!0,`${h}=${n}`):u}).filter(u=>u);return s||l.push(`${i}=${n}`),`#${l.join("&")}`}return`#${n}`}_getCurrentHash(){const e=C.location.hash.replace("#","");if(this._hashName){let n;return e.split("&").map(i=>i.split("=")).forEach(i=>{i[0]===this._hashName&&(n=i)}),(n&&n[1]||"").split("/")}return e.split("/")}_onHashChange(){const e=this._map;if(!e)return!1;const n=this._getCurrentHash();if(n.length>=3&&!n.some(i=>isNaN(i))){const i=e.dragRotate.isEnabled()&&e.touchZoomRotate.isEnabled()?+(n[3]||0):e.getBearing();return e.jumpTo({center:[+n[2],+n[1]],zoom:+n[0],bearing:i,pitch:+(n[4]||0)}),!0}return!1}_updateHashUnthrottled(){const e=C.location.href.replace(/(#.+)?$/,this.getHashString());C.history.replaceState(C.history.state,null,e)}}function iR(t,e){const n=t.getCenter(),i=Math.round(100*t.getZoom())/100,s=Math.ceil((i*Math.LN2+Math.log(512/360/.5))/Math.LN10),l=Math.pow(10,s),u=Math.round(n.lng*l)/l,h=Math.round(n.lat*l)/l,f=t.getBearing(),m=t.getPitch();let y=e?`/${u}/${h}/${i}`:`${i}/${h}/${u}`;return(f||m)&&(y+="/"+Math.round(10*f)/10),m&&(y+=`/${Math.round(m)}`),y}const Cx={linearity:.3,easing:we(0,0,.3,1)},pV=ge({deceleration:2500,maxSpeed:1400},Cx),mV=ge({deceleration:20,maxSpeed:1400},Cx),gV=ge({deceleration:1e3,maxSpeed:360},Cx),yV=ge({deceleration:1e3,maxSpeed:90},Cx);class _V{constructor(e){this._map=e,this.clear()}clear(){this._inertiaBuffer=[]}record(e){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:mn.now(),settings:e})}_drainInertiaBuffer(){const e=this._inertiaBuffer,n=mn.now();for(;e.length>0&&n-e[0].time>160;)e.shift()}_onMoveEnd(e){if(this._map._prefersReducedMotion()||(this._drainInertiaBuffer(),this._inertiaBuffer.length<2))return;const n={zoom:0,bearing:0,pitch:0,pan:new q(0,0),pinchAround:void 0,around:void 0};for(const{settings:l}of this._inertiaBuffer)n.zoom+=l.zoomDelta||0,n.bearing+=l.bearingDelta||0,n.pitch+=l.pitchDelta||0,l.panDelta&&n.pan._add(l.panDelta),l.around&&(n.around=l.around),l.pinchAround&&(n.pinchAround=l.pinchAround);const i=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,s={};if(n.pan.mag()){const l=Mx(n.pan.mag(),i,ge({},pV,e||{}));s.offset=n.pan.mult(l.amount/n.pan.mag()),s.center=this._map.transform.center,Ax(s,l)}if(n.zoom){const l=Mx(n.zoom,i,mV);s.zoom=this._map.transform.zoom+l.amount,Ax(s,l)}if(n.bearing){const l=Mx(n.bearing,i,gV);s.bearing=this._map.transform.bearing+ce(l.amount,-179,179),Ax(s,l)}if(n.pitch){const l=Mx(n.pitch,i,yV);s.pitch=this._map.transform.pitch+l.amount,Ax(s,l)}if(s.zoom||s.bearing){const l=n.pinchAround===void 0?n.around:n.pinchAround;s.around=l?this._map.unproject(l):this._map.getCenter()}return this.clear(),s.noMoveStart=!0,s}}function Ax(t,e){(!t.duration||t.duration<e.duration)&&(t.duration=e.duration,t.easing=e.easing)}function Mx(t,e,n){const{maxSpeed:i,linearity:s,deceleration:l}=n,u=ce(t*s/(e/1e3),-i,i),h=Math.abs(u)/(l*s);return{easing:n.easing,duration:1e3*h,amount:u*(h/2)}}class Ys extends ct{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,n,i,s={}){const l=Eu(n.getCanvasContainer(),i);super(e,ge({point:l,lngLat:n.unproject(l),originalEvent:i},s)),this._defaultPrevented=!1,this.target=n}}class Ix extends ct{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,n,i){const s=e==="touchend"?i.changedTouches:i.touches,l=ad(n.getCanvasContainer(),s),u=l.map(f=>n.unproject(f)),h=l.reduce((f,m,y,v)=>f.add(m.div(v.length)),new q(0,0));super(e,{points:l,point:h,lngLats:u,lngLat:n.unproject(h),originalEvent:i}),this._defaultPrevented=!1}}class vV extends ct{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,n,i){super(e,{originalEvent:i}),this._defaultPrevented=!1}}class xV{constructor(e,n){this._map=e,this._clickTolerance=n.clickTolerance}reset(){this._mousedownPos=void 0}wheel(e){return this._firePreventable(new vV(e.type,this._map,e))}mousedown(e,n){return this._mousedownPos=n,this._firePreventable(new Ys(e.type,this._map,e))}mouseup(e){this._map.fire(new Ys(e.type,this._map,e))}preclick(e){const n=ge({},e);n.type="preclick",this._map.fire(new Ys(n.type,this._map,n))}click(e,n){this._mousedownPos&&this._mousedownPos.dist(n)>=this._clickTolerance||(this.preclick(e),this._map.fire(new Ys(e.type,this._map,e)))}dblclick(e){return this._firePreventable(new Ys(e.type,this._map,e))}mouseover(e){this._map.fire(new Ys(e.type,this._map,e))}mouseout(e){this._map.fire(new Ys(e.type,this._map,e))}touchstart(e){return this._firePreventable(new Ix(e.type,this._map,e))}touchmove(e){this._map.fire(new Ix(e.type,this._map,e))}touchend(e){this._map.fire(new Ix(e.type,this._map,e))}touchcancel(e){this._map.fire(new Ix(e.type,this._map,e))}_firePreventable(e){if(this._map.fire(e),e.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class wV{constructor(e){this._map=e}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(e){this._map.fire(new Ys(e.type,this._map,e))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Ys("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(e){this._delayContextMenu?this._contextMenuEvent=e:this._map.fire(new Ys(e.type,this._map,e)),this._map.listens("contextmenu")&&e.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class bV{constructor(e,n){this._map=e,this._el=e.getCanvasContainer(),this._container=e.getContainer(),this._clickTolerance=n.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(e,n){this.isEnabled()&&e.shiftKey&&e.button===0&&(Hf(),this._startPos=this._lastPos=n,this._active=!0)}mousemoveWindow(e,n){if(!this._active)return;const i=n,s=this._startPos,l=this._lastPos;if(!s||!l||l.equals(i)||!this._box&&i.dist(s)<this._clickTolerance)return;this._lastPos=i,this._box||(this._box=lr("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",e));const u=Math.min(s.x,i.x),h=Math.max(s.x,i.x),f=Math.min(s.y,i.y),m=Math.max(s.y,i.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${u}px,${f}px)`,this._box.style.width=h-u+"px",this._box.style.height=m-f+"px")})}mouseupWindow(e,n){if(!this._active)return;const i=this._startPos,s=n;if(i&&e.button===0){if(this.reset(),Wf(),i.x!==s.x||i.y!==s.y)return this._map.fire(new ct("boxzoomend",{originalEvent:e})),{cameraAnimation:l=>l.fitScreenCoordinates(i,s,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",e)}}keydown(e){this._active&&e.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",e))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),Lr(),delete this._startPos,delete this._lastPos}_fireEvent(e,n){return this._map.fire(new ct(e,{originalEvent:n}))}}function TE(t,e){const n={};for(let i=0;i<t.length;i++)n[t[i].identifier]=e[i];return n}class SV{constructor(e){this.reset(),this.numTouches=e.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(e,n,i){(this.centroid||i.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===0&&(this.startTime=e.timeStamp),i.length===this.numTouches&&(this.centroid=function(s){const l=new q(0,0);for(const u of s)l._add(u);return l.div(s.length)}(n),this.touches=TE(i,n)))}touchmove(e,n,i){if(this.aborted||!this.centroid)return;const s=TE(i,n);for(const l in this.touches){const u=s[l];(!u||u.dist(this.touches[l])>30)&&(this.aborted=!0)}}touchend(e,n,i){if((!this.centroid||e.timeStamp-this.startTime>500)&&(this.aborted=!0),i.length===0){const s=!this.aborted&&this.centroid;if(this.reset(),s)return s}}}class CE{constructor(e){this.singleTap=new SV(e),this.numTaps=e.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(e,n,i){this.singleTap.touchstart(e,n,i)}touchmove(e,n,i){this.singleTap.touchmove(e,n,i)}touchend(e,n,i){const s=this.singleTap.touchend(e,n,i);if(s){const l=e.timeStamp-this.lastTime<500,u=!this.lastTap||this.lastTap.dist(s)<30;if(l&&u||this.reset(),this.count++,this.lastTime=e.timeStamp,this.lastTap=s,this.count===this.numTaps)return this.reset(),s}}}class EV{constructor(){this._zoomIn=new CE({numTouches:1,numTaps:2}),this._zoomOut=new CE({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(e,n,i){this._zoomIn.touchstart(e,n,i),this._zoomOut.touchstart(e,n,i)}touchmove(e,n,i){this._zoomIn.touchmove(e,n,i),this._zoomOut.touchmove(e,n,i)}touchend(e,n,i){const s=this._zoomIn.touchend(e,n,i),l=this._zoomOut.touchend(e,n,i);return s?(this._active=!0,e.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:u=>u.easeTo({duration:300,zoom:u.getZoom()+1,around:u.unproject(s)},{originalEvent:e})}):l?(this._active=!0,e.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:u=>u.easeTo({duration:300,zoom:u.getZoom()-1,around:u.unproject(l)},{originalEvent:e})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const TV={0:1,2:2};class AE{constructor(e){this.reset(),this._clickTolerance=e.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(e,n){return!1}_move(e,n){return{}}mousedown(e,n){if(this._lastPoint)return;const i=Yg(e);this._correctButton(e,i)&&(this._lastPoint=n,this._eventButton=i)}mousemoveWindow(e,n){const i=this._lastPoint;if(i){if(e.preventDefault(),this._eventButton!=null&&function(s,l){const u=TV[l];return s.buttons===void 0||(s.buttons&u)!==u}(e,this._eventButton))this.reset();else if(this._moved||!(n.dist(i)<this._clickTolerance))return this._moved=!0,this._lastPoint=n,this._move(i,n)}}mouseupWindow(e){this._lastPoint&&Yg(e)===this._eventButton&&(this._moved&&Wf(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class CV extends AE{mousedown(e,n){super.mousedown(e,n),this._lastPoint&&(this._active=!0)}_correctButton(e,n){return n===0&&!e.ctrlKey}_move(e,n){return{around:n,panDelta:n.sub(e)}}}class oR extends AE{_correctButton(e,n){return n===0&&e.ctrlKey||n===2}_move(e,n){const i=.8*(n.x-e.x);if(i)return this._active=!0,{bearingDelta:i}}contextmenu(e){e.preventDefault()}}class sR extends AE{_correctButton(e,n){return n===0&&e.ctrlKey||n===2}_move(e,n){const i=-.5*(n.y-e.y);if(i)return this._active=!0,{pitchDelta:i}}contextmenu(e){e.preventDefault()}}class AV{constructor(e,n){this._map=e,this._el=e.getCanvasContainer(),this._minTouches=1,this._clickTolerance=n.clickTolerance||1,this.reset(),On(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new q(0,0)}touchstart(e,n,i){return this._calculateTransform(e,n,i)}touchmove(e,n,i){if(this._active&&!(i.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(i.length===1&&!cn())return void this._showTouchPanBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return e.cancelable&&e.preventDefault(),this._calculateTransform(e,n,i)}}touchend(e,n,i){this._calculateTransform(e,n,i),this._active&&i.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(e,n,i){i.length>0&&(this._active=!0);const s=TE(i,n),l=new q(0,0),u=new q(0,0);let h=0;for(const m in s){const y=s[m],v=this._touches[m];v&&(l._add(y),u._add(y.sub(v)),h++,s[m]=y)}if(this._touches=s,h<this._minTouches||!u.mag())return;const f=u.div(h);return this._sum._add(f),this._sum.mag()<this._clickTolerance?void 0:{around:l.div(h),panDelta:f}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=lr("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","null")},500)}}class ME{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(e){}_move(e,n,i){return{}}touchstart(e,n,i){this._firstTwoTouches||i.length<2||(this._firstTwoTouches=[i[0].identifier,i[1].identifier],this._start([n[0],n[1]]))}touchmove(e,n,i){const s=this._firstTwoTouches;if(!s)return;e.preventDefault();const[l,u]=s,h=kx(i,n,l),f=kx(i,n,u);if(!h||!f)return;const m=this._aroundCenter?null:h.add(f).div(2);return this._move([h,f],m,e)}touchend(e,n,i){if(!this._firstTwoTouches)return;const[s,l]=this._firstTwoTouches,u=kx(i,n,s),h=kx(i,n,l);u&&h||(this._active&&Wf(),this.reset())}touchcancel(){this.reset()}enable(e){this._enabled=!0,this._aroundCenter=!!e&&e.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function kx(t,e,n){for(let i=0;i<t.length;i++)if(t[i].identifier===n)return e[i]}function aR(t,e){return Math.log(t/e)/Math.LN2}class MV extends ME{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(e){this._startDistance=this._distance=e[0].dist(e[1])}_move(e,n){const i=this._distance;if(this._distance=e[0].dist(e[1]),this._active||!(Math.abs(aR(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:aR(this._distance,i),pinchAround:n}}}function lR(t,e){return 180*t.angleWith(e)/Math.PI}class IV extends ME{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(e){this._startVector=this._vector=e[0].sub(e[1]),this._minDiameter=e[0].dist(e[1])}_move(e,n){const i=this._vector;if(this._vector=e[0].sub(e[1]),i&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:lR(this._vector,i),pinchAround:n}}_isBelowThreshold(e){this._minDiameter=Math.min(this._minDiameter,e.mag());const n=25/(Math.PI*this._minDiameter)*360,i=this._startVector;if(!i)return!1;const s=lR(e,i);return Math.abs(s)<n}}function IE(t){return Math.abs(t.y)>Math.abs(t.x)}class kV extends ME{constructor(e){super(),this._map=e}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(e){this._lastPoints=e,IE(e[0].sub(e[1]))&&(this._valid=!1)}_move(e,n,i){const s=this._lastPoints;if(!s)return;const l=e[0].sub(s[0]),u=e[1].sub(s[1]);return this._map._cooperativeGestures&&!cn()&&i.touches.length<3||(this._valid=this.gestureBeginsVertically(l,u,i.timeStamp),!this._valid)?void 0:(this._lastPoints=e,this._active=!0,{pitchDelta:(l.y+u.y)/2*-.5})}gestureBeginsVertically(e,n,i){if(this._valid!==void 0)return this._valid;const s=e.mag()>=2,l=n.mag()>=2;if(!s&&!l)return;if(!s||!l)return this._firstMove==null&&(this._firstMove=i),i-this._firstMove<100&&void 0;const u=e.y>0==n.y>0;return IE(e)&&IE(n)&&u}}const PV={panStep:100,bearingStep:15,pitchStep:10};class RV{constructor(){const e=PV;this._panStep=e.panStep,this._bearingStep=e.bearingStep,this._pitchStep=e.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(e){if(e.altKey||e.ctrlKey||e.metaKey)return;let n=0,i=0,s=0,l=0,u=0;switch(e.keyCode){case 61:case 107:case 171:case 187:n=1;break;case 189:case 109:case 173:n=-1;break;case 37:e.shiftKey?i=-1:(e.preventDefault(),l=-1);break;case 39:e.shiftKey?i=1:(e.preventDefault(),l=1);break;case 38:e.shiftKey?s=1:(e.preventDefault(),u=-1);break;case 40:e.shiftKey?s=-1:(e.preventDefault(),u=1);break;default:return}return this._rotationDisabled&&(i=0,s=0),{cameraAnimation:h=>{const f=h.getZoom();h.easeTo({duration:300,easeId:"keyboardHandler",easing:DV,zoom:n?Math.round(f)+n*(e.shiftKey?2:1):f,bearing:h.getBearing()+i*this._bearingStep,pitch:h.getPitch()+s*this._pitchStep,offset:[-l*this._panStep,-u*this._panStep],center:h.getCenter()},{originalEvent:e})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function DV(t){return t*(2-t)}const uR=4.000244140625;class LV{constructor(e,n){this._map=e,this._el=e.getCanvasContainer(),this._handler=n,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,On(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(e){this._defaultZoomRate=e}setWheelZoomRate(e){this._wheelZoomRate=e}isEnabled(){return!!this._enabled}isActive(){return this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(e){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!e&&e.around==="center",this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(e){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(e.ctrlKey||e.metaKey||this.isZooming()||cn()))return void this._showBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let n=e.deltaMode===C.WheelEvent.DOM_DELTA_LINE?40*e.deltaY:e.deltaY;const i=mn.now(),s=i-(this._lastWheelEventTime||0);this._lastWheelEventTime=i,n!==0&&n%uR==0?this._type="wheel":n!==0&&Math.abs(n)<4?this._type="trackpad":s>400?(this._type=null,this._lastValue=n,this._timeout=setTimeout(this._onTimeout,40,e)):this._type||(this._type=Math.abs(s*n)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,n+=this._lastValue)),e.shiftKey&&n&&(n/=4),this._type&&(this._lastWheelEvent=e,this._delta-=n,this._active||this._start(e)),e.preventDefault()}_onTimeout(e){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(e)}_start(e){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const n=Eu(this._el,e);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:n,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const e=this._map.transform;this._type==="wheel"&&e.projection.wrap&&(e._center.lng>=180||e._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const n=()=>e._terrainEnabled()&&this._aroundCoord?e.computeZoomRelativeTo(this._aroundCoord):e.zoom;if(this._delta!==0){const f=this._type==="wheel"&&Math.abs(this._delta)>uR?this._wheelZoomRate:this._defaultZoomRate;let m=2/(1+Math.exp(-Math.abs(this._delta*f)));this._delta<0&&m!==0&&(m=1/m);const y=n(),v=Math.pow(2,y),w=typeof this._targetZoom=="number"?e.zoomScale(this._targetZoom):v;this._targetZoom=Math.min(e.maxZoom,Math.max(e.minZoom,e.scaleZoom(w*m))),this._type==="wheel"&&(this._startZoom=y,this._easing=this._smoothOutEasing(200)),this._delta=0}const i=typeof this._targetZoom=="number"?this._targetZoom:n(),s=this._startZoom,l=this._easing;let u,h=!1;if(this._type==="wheel"&&s&&l){const f=Math.min((mn.now()-this._lastWheelEventTime)/200,1);u=nn(s,i,l(f)),f<1?this._frameId||(this._frameId=!0):h=!0}else u=i,h=!0;return this._active=!0,h&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!h,zoomDelta:u-n(),around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(e){let n=Q;if(this._prevEase){const i=this._prevEase,s=(mn.now()-i.start)/i.duration,l=i.easing(s+.01)-i.easing(s),u=.27/Math.sqrt(l*l+1e-4)*.01;n=we(u,Math.sqrt(.0729-u*u),.25,1)}return this._prevEase={start:mn.now(),duration:e,easing:n},n}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=lr("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(C.navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","null")},200)}}class OV{constructor(e,n){this._clickZoom=e,this._tapZoom=n}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class zV{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(e,n){return e.preventDefault(),{cameraAnimation:i=>{i.easeTo({duration:300,zoom:i.getZoom()+(e.shiftKey?-1:1),around:i.unproject(n)},{originalEvent:e})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class FV{constructor(){this._tap=new CE({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(e,n,i){this._swipePoint||(this._tapTime&&e.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?i.length>0&&(this._swipePoint=n[0],this._swipeTouch=i[0].identifier):this._tap.touchstart(e,n,i))}touchmove(e,n,i){if(this._tapTime){if(this._swipePoint){if(i[0].identifier!==this._swipeTouch)return;const s=n[0],l=s.y-this._swipePoint.y;return this._swipePoint=s,e.preventDefault(),this._active=!0,{zoomDelta:l/128}}}else this._tap.touchmove(e,n,i)}touchend(e,n,i){this._tapTime?this._swipePoint&&i.length===0&&this.reset():this._tap.touchend(e,n,i)&&(this._tapTime=e.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class BV{constructor(e,n,i){this._el=e,this._mousePan=n,this._touchPan=i}enable(e){this._inertiaOptions=e||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class NV{constructor(e,n,i){this._pitchWithRotate=e.pitchWithRotate,this._mouseRotate=n,this._mousePitch=i}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class jV{constructor(e,n,i,s){this._el=e,this._touchZoom=n,this._touchRotate=i,this._tapDragZoom=s,this._rotationDisabled=!1,this._enabled=!0}enable(e){this._touchZoom.enable(e),this._rotationDisabled||this._touchRotate.enable(e),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const Px=t=>t.zoom||t.drag||t.pitch||t.rotate;class UV extends ct{}class VV{constructor(){this.constants=[1,1,.01],this.radius=0}setup(e,n){const i=fe.sub([],n,e);this.radius=fe.length(i[2]<0?fe.div([],i,this.constants):[i[0],i[1],0])}projectRay(e){fe.div(e,e,this.constants),fe.normalize(e,e),fe.mul(e,e,this.constants);const n=fe.scale([],e,this.radius);if(n[2]>0){const i=fe.scale([],[0,0,1],fe.dot(n,[0,0,1])),s=fe.scale([],fe.normalize([],[n[0],n[1],0]),this.radius),l=fe.add([],n,fe.scale([],fe.sub([],fe.add([],s,i),n),2));n[0]=l[0],n[1]=l[1]}return n}}function Rx(t){return t.panDelta&&t.panDelta.mag()||t.zoomDelta||t.bearingDelta||t.pitchDelta}class $V{constructor(e,n){this._map=e,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new _V(e),this._bearingSnap=n.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new VV,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(n),On(["handleEvent","handleWindowEvent"],this);const i=this._el;this._listeners=[[i,"touchstart",{passive:!0}],[i,"touchmove",{passive:!1}],[i,"touchend",void 0],[i,"touchcancel",void 0],[i,"mousedown",void 0],[i,"mousemove",void 0],[i,"mouseup",void 0],[C.document,"mousemove",{capture:!0}],[C.document,"mouseup",void 0],[i,"mouseover",void 0],[i,"mouseout",void 0],[i,"dblclick",void 0],[i,"click",void 0],[i,"keydown",{capture:!1}],[i,"keyup",void 0],[i,"wheel",{passive:!1}],[i,"contextmenu",void 0],[C,"blur",void 0]];for(const[s,l,u]of this._listeners)s.addEventListener(l,s===C.document?this.handleWindowEvent:this.handleEvent,u)}destroy(){for(const[e,n,i]of this._listeners)e.removeEventListener(n,e===C.document?this.handleWindowEvent:this.handleEvent,i)}_addDefaultHandlers(e){const n=this._map,i=n.getCanvasContainer();this._add("mapEvent",new xV(n,e));const s=n.boxZoom=new bV(n,e);this._add("boxZoom",s);const l=new EV,u=new zV;n.doubleClickZoom=new OV(u,l),this._add("tapZoom",l),this._add("clickZoom",u);const h=new FV;this._add("tapDragZoom",h);const f=n.touchPitch=new kV(n);this._add("touchPitch",f);const m=new oR(e),y=new sR(e);n.dragRotate=new NV(e,m,y),this._add("mouseRotate",m,["mousePitch"]),this._add("mousePitch",y,["mouseRotate"]);const v=new CV(e),w=new AV(n,e);n.dragPan=new BV(i,v,w),this._add("mousePan",v),this._add("touchPan",w,["touchZoom","touchRotate"]);const S=new IV,E=new MV;n.touchZoomRotate=new jV(i,E,S,h),this._add("touchRotate",S,["touchPan","touchZoom"]),this._add("touchZoom",E,["touchPan","touchRotate"]),this._add("blockableMapEvent",new wV(n));const A=n.scrollZoom=new LV(n,this);this._add("scrollZoom",A,["mousePan"]);const M=n.keyboard=new RV;this._add("keyboard",M);for(const k of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])e.interactive&&e[k]&&n[k].enable(e[k])}_add(e,n,i){this._handlers.push({handlerName:e,handler:n,allowed:i}),this._handlersById[e]=n}stop(e){if(!this._updatingCamera){for(const{handler:n}of this._handlers)n.reset();this._inertia.clear(),this._fireEvents({},{},e),this._changes=[]}}isActive(){for(const{handler:e}of this._handlers)if(e.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Px(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(e,n,i){for(const s in e)if(s!==i&&(!n||n.indexOf(s)<0))return!0;return!1}handleWindowEvent(e){this.handleEvent(e,`${e.type}Window`)}_getMapTouches(e){const n=[];for(const i of e)this._el.contains(i.target)&&n.push(i);return n}handleEvent(e,n){this._updatingCamera=!0;const i=e.type==="renderFrame",s=i?void 0:e,l={needsRenderFrame:!1},u={},h={},f=e.touches?this._getMapTouches(e.touches):void 0,m=f?ad(this._el,f):i?void 0:Eu(this._el,e);for(const{handlerName:w,handler:S,allowed:E}of this._handlers){if(!S.isEnabled())continue;let A;this._blockedByActive(h,E,w)?S.reset():S[n||e.type]&&(A=S[n||e.type](e,m,f),this.mergeHandlerResult(l,u,A,w,s),A&&A.needsRenderFrame&&this._triggerRenderFrame()),(A||S.isActive())&&(h[w]=S)}const y={};for(const w in this._previousActiveHandlers)h[w]||(y[w]=s);this._previousActiveHandlers=h,(Object.keys(y).length||Rx(l))&&(this._changes.push([l,u,y]),this._triggerRenderFrame()),(Object.keys(h).length||Rx(l))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:v}=l;v&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],v(this._map))}mergeHandlerResult(e,n,i,s,l){if(!i)return;ge(e,i);const u={handlerName:s,originalEvent:i.originalEvent||l};i.zoomDelta!==void 0&&(n.zoom=u),i.panDelta!==void 0&&(n.drag=u),i.pitchDelta!==void 0&&(n.pitch=u),i.bearingDelta!==void 0&&(n.rotate=u)}_applyChanges(){const e={},n={},i={};for(const[s,l,u]of this._changes)s.panDelta&&(e.panDelta=(e.panDelta||new q(0,0))._add(s.panDelta)),s.zoomDelta&&(e.zoomDelta=(e.zoomDelta||0)+s.zoomDelta),s.bearingDelta&&(e.bearingDelta=(e.bearingDelta||0)+s.bearingDelta),s.pitchDelta&&(e.pitchDelta=(e.pitchDelta||0)+s.pitchDelta),s.around!==void 0&&(e.around=s.around),s.aroundCoord!==void 0&&(e.aroundCoord=s.aroundCoord),s.pinchAround!==void 0&&(e.pinchAround=s.pinchAround),s.noInertia&&(e.noInertia=s.noInertia),ge(n,l),ge(i,u);this._updateMapTransform(e,n,i),this._changes=[]}_updateMapTransform(e,n,i){const s=this._map,l=s.transform,u=R=>[R.x,R.y,R.z];if((R=>{const L=this._eventsInProgress.drag;return L&&!this._handlersById[L.handlerName].isActive()})()&&!Rx(e)){const R=l.zoom;l.cameraElevationReference="sea",l.recenterOnTerrain(),l.cameraElevationReference="ground",R!==l.zoom&&this._map._update(!0)}if(l._isCameraConstrained&&s._stop(!0),!Rx(e))return void this._fireEvents(n,i,!0);let{panDelta:h,zoomDelta:f,bearingDelta:m,pitchDelta:y,around:v,aroundCoord:w,pinchAround:S}=e;l._isCameraConstrained&&(f>0&&(f=0),l._isCameraConstrained=!1),S!==void 0&&(v=S),(f||(R=>n[R]&&!this._eventsInProgress[R])("drag"))&&v&&(this._dragOrigin=u(l.pointCoordinate3D(v)),this._trackingEllipsoid.setup(l._camera.position,this._dragOrigin)),l.cameraElevationReference="sea",s._stop(!0),v=v||s.transform.centerPoint,m&&(l.bearing+=m),y&&(l.pitch+=y),l._updateCameraState();const E=[0,0,0];if(h)if(l.projection.name==="mercator"){const R=this._trackingEllipsoid.projectRay(l.screenPointToMercatorRay(v).dir),L=this._trackingEllipsoid.projectRay(l.screenPointToMercatorRay(v.sub(h)).dir);E[0]=L[0]-R[0],E[1]=L[1]-R[1]}else{const R=l.pointCoordinate(v);if(l.projection.name==="globe"){h=h.rotate(-l.angle);const L=l._pixelsPerMercatorPixel/l.worldSize;E[0]=-h.x*cS(Ci(R.y))*L,E[1]=-h.y*cS(l.center.lat)*L}else{const L=l.pointCoordinate(v.sub(h));R&&L&&(E[0]=L.x-R.x,E[1]=L.y-R.y)}}const A=l.zoom,M=[0,0,0];if(f){const R=u(w||l.pointCoordinate3D(v)),L={dir:fe.normalize([],fe.sub([],R,l._camera.position))};if(L.dir[2]<0){const z=l.zoomDeltaToMovement(R,f);fe.scale(M,L.dir,z)}}const k=fe.add(E,E,M);l._translateCameraConstrained(k),f&&Math.abs(l.zoom-A)>1e-4&&l.recenterOnTerrain(),l.cameraElevationReference="ground",this._map._update(),e.noInertia||this._inertia.record(e),this._fireEvents(n,i,!0)}_fireEvents(e,n,i){const s=Px(this._eventsInProgress),l=Px(e),u={};for(const y in e){const{originalEvent:v}=e[y];this._eventsInProgress[y]||(u[`${y}start`]=v),this._eventsInProgress[y]=e[y]}!s&&l&&this._fireEvent("movestart",l.originalEvent);for(const y in u)this._fireEvent(y,u[y]);l&&this._fireEvent("move",l.originalEvent);for(const y in e){const{originalEvent:v}=e[y];this._fireEvent(y,v)}const h={};let f;for(const y in this._eventsInProgress){const{handlerName:v,originalEvent:w}=this._eventsInProgress[y];this._handlersById[v].isActive()||(delete this._eventsInProgress[y],f=n[v]||w,h[`${y}end`]=f)}for(const y in h)this._fireEvent(y,h[y]);const m=Px(this._eventsInProgress);if(i&&(s||l)&&!m){this._updatingCamera=!0;const y=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),v=w=>w!==0&&-this._bearingSnap<w&&w<this._bearingSnap;y?(v(y.bearing||this._map.getBearing())&&(y.bearing=0),this._map.easeTo(y,{originalEvent:f})):(this._map.fire(new ct("moveend",{originalEvent:f})),v(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(e,n){this._map.fire(new ct(e,n?{originalEvent:n}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(e=>{this._frameId=void 0,this.handleEvent(new UV("renderFrame",{timeStamp:e})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const cR="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class GV extends Cr{constructor(e,n){super(),this._moving=!1,this._zooming=!1,this.transform=e,this._bearingSnap=n.bearingSnap,this._respectPrefersReducedMotion=n.respectPrefersReducedMotion!==!1,On(["_renderFrameCallback"],this)}getCenter(){return new sn(this.transform.center.lng,this.transform.center.lat)}setCenter(e,n){return this.jumpTo({center:e},n)}panBy(e,n,i){return e=q.convert(e).mult(-1),this.panTo(this.transform.center,ge({offset:e},n),i)}panTo(e,n,i){return this.easeTo(ge({center:e},n),i)}getZoom(){return this.transform.zoom}setZoom(e,n){return this.jumpTo({zoom:e},n),this}zoomTo(e,n,i){return this.easeTo(ge({zoom:e},n),i)}zoomIn(e,n){return this.zoomTo(this.getZoom()+1,e,n),this}zoomOut(e,n){return this.zoomTo(this.getZoom()-1,e,n),this}getBearing(){return this.transform.bearing}setBearing(e,n){return this.jumpTo({bearing:e},n),this}getPadding(){return this.transform.padding}setPadding(e,n){return this.jumpTo({padding:e},n),this}rotateTo(e,n,i){return this.easeTo(ge({bearing:e},n),i)}resetNorth(e,n){return this.rotateTo(0,ge({duration:1e3},e),n),this}resetNorthPitch(e,n){return this.easeTo(ge({bearing:0,pitch:0,duration:1e3},e),n),this}snapToNorth(e,n){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(e,n):this}getPitch(){return this.transform.pitch}setPitch(e,n){return this.jumpTo({pitch:e},n),this}cameraForBounds(e,n){e=li.convert(e);const i=n&&n.bearing||0,s=n&&n.pitch||0,l=e.getNorthWest(),u=e.getSouthEast();return this._cameraForBounds(this.transform,l,u,i,s,n)}_extendCameraOptions(e){const n={top:0,bottom:0,right:0,left:0};if(typeof(e=ge({padding:n,offset:[0,0],maxZoom:this.transform.maxZoom},e)).padding=="number"){const i=e.padding;e.padding={top:i,bottom:i,right:i,left:i}}return e.padding=ge(n,e.padding),e}_minimumAABBFrustumDistance(e,n){const i=n.max[0]-n.min[0],s=n.max[1]-n.min[1];return i/s>e.aspect?i/(2*Math.tan(.5*e.fovX)*e.aspect):s/(2*Math.tan(.5*e.fovY)*e.aspect)}_cameraForBoundsOnGlobe(e,n,i,s,l,u){const h=e.clone(),f=this._extendCameraOptions(u);h.bearing=s,h.pitch=l;const m=sn.convert(n),y=sn.convert(i),v=.5*(m.lat+y.lat),w=.5*(m.lng+y.lng),S=ys(v,w),E=fe.normalize([],S),A=fe.normalize([],fe.cross([],E,[0,1,0])),M=fe.cross([],A,E),k=[A[0],A[1],A[2],0,M[0],M[1],M[2],0,E[0],E[1],E[2],0,0,0,0,1],R=[S,ys(m.lat,m.lng),ys(y.lat,m.lng),ys(y.lat,y.lng),ys(m.lat,y.lng),ys(v,m.lng),ys(v,y.lng),ys(m.lat,w),ys(y.lat,w)];let L=ri.fromPoints(R.map(Ae=>[fe.dot(A,Ae),fe.dot(M,Ae),fe.dot(E,Ae)]));const z=fe.transformMat4([],L.center,k);fe.squaredLength(z)===0&&fe.set(z,0,0,1),fe.normalize(z,z),fe.scale(z,z,Ds),h.center=function([Ae,Le,qe]){const Ve=Math.hypot(Ae,Le,qe),yt=Math.atan2(Ae,qe),mt=.5*Math.PI-Math.acos(-Le/Ve);return new sn(rt(yt),rt(mt))}(z);const B=h.getWorldToCameraMatrix(),j=Me.invert(new Float64Array(16),B);L=ri.applyTransform(L,Me.multiply([],B,k)),fe.transformMat4(z,z,B);const V=.5*(L.max[2]-L.min[2]),Y=this._minimumAABBFrustumDistance(h,L),ne=fe.scale([],[0,0,1],V),re=fe.add(ne,z,ne),J=Y+(h.pitch===0?0:fe.distance(z,re)),ae=h.globeCenterInViewSpace,le=fe.sub([],z,[ae[0],ae[1],ae[2]]);fe.normalize(le,le),fe.scale(le,le,J);const oe=fe.add([],z,le);fe.transformMat4(oe,oe,j);const Ee=mm/Ds,xe=fe.length(oe),Pe=mr(Math.max(xe*Ee-mm,Number.EPSILON),0),pe=Math.min(h.zoomFromMercatorZAdjusted(Pe),f.maxZoom);return pe>.5*(a_+dh)?(h.setProjection({name:"mercator"}),h.zoom=pe,this._cameraForBounds(h,n,i,s,l,u)):{center:h.center,zoom:pe,bearing:s,pitch:l}}queryTerrainElevation(e,n){const i=this.transform.elevation;return i?(n=ge({},{exaggerated:!0},n),i.getAtPoint(Un.fromLngLat(e),null,n.exaggerated)):null}_cameraForBounds(e,n,i,s,l,u){if(e.projection.name==="globe")return this._cameraForBoundsOnGlobe(e,n,i,s,l,u);const h=e.clone(),f=this._extendCameraOptions(u),m=h.padding;h.bearing=s,h.pitch=l;const y=sn.convert(n),v=sn.convert(i),w=new sn(y.lng,v.lat),S=new sn(v.lng,y.lat),E=h.project(y),A=h.project(v),M=this.queryTerrainElevation(y),k=this.queryTerrainElevation(v),R=this.queryTerrainElevation(w),L=this.queryTerrainElevation(S),z=[[E.x,E.y,Math.min(M||0,k||0,R||0,L||0)],[A.x,A.y,Math.max(M||0,k||0,R||0,L||0)]];let B=ri.fromPoints(z);const j=h.getWorldToCameraMatrix(),V=Me.invert(new Float64Array(16),j);B=ri.applyTransform(B,j);const Y=fe.sub([],B.max,B.min),ne=m.left||0,re=m.right||0,J=m.bottom||0,ae=m.top||0,{left:le,right:oe,top:Ee,bottom:xe}=f.padding,Pe=.5*(ne+re),pe=.5*(ae+J),Ae=Math.min(h.scaleZoom(h.scale*Math.min((h.width-(ne+re+le+oe))/Y[0],(h.height-(J+ae+xe+Ee))/Y[1])),f.maxZoom),Le=h.scale/h.zoomScale(Ae);B=new ri([B.min[0]-(le+Pe)*Le,B.min[1]-(xe+pe)*Le,B.min[2]],[B.max[0]+(oe+Pe)*Le,B.max[1]+(Ee+pe)*Le,B.max[2]]);const qe=.5*Y[2],Ve=this._minimumAABBFrustumDistance(h,B),yt=[0,0,1,0];xr.transformMat4(yt,yt,j),xr.normalize(yt,yt);const mt=fe.scale([],yt,Ve+qe),lt=fe.add([],B.center,mt),ft=(typeof f.offset.x=="number"&&typeof f.offset.y=="number"?new q(f.offset.x,f.offset.y):q.convert(f.offset)).rotate(-Be(s));B.center[0]-=ft.x*Le,B.center[1]+=ft.y*Le,fe.transformMat4(B.center,B.center,V),fe.transformMat4(lt,lt,V);const Mt=[B.center[0],B.center[1],lt[2]*h.pixelsPerMeter];fe.scale(Mt,Mt,1/h.worldSize);const Zt=Ls(Mt[0]),Gt=Ci(Mt[1]),Ut=Math.min(h._zoomFromMercatorZ(Mt[2]),f.maxZoom),Xt=new sn(Zt,Gt);return h.mercatorFromTransition&&Ut<.5*(a_+dh)?(h.setProjection({name:"globe"}),h.zoom=Ut,this._cameraForBounds(h,n,i,s,l,u)):{center:Xt,zoom:Ut,bearing:s,pitch:l}}fitBounds(e,n,i){const s=this.cameraForBounds(e,n);return this._fitInternal(s,n,i)}fitScreenCoordinates(e,n,i,s,l){const u=q.convert(e),h=q.convert(n),f=new q(Math.min(u.x,h.x),Math.min(u.y,h.y)),m=new q(Math.max(u.x,h.x),Math.max(u.y,h.y));if(this.transform.projection.name==="mercator"&&this.transform.anyCornerOffEdge(u,h))return this;const y=this.transform.pointLocation3D(f),v=this.transform.pointLocation3D(m),w=this.transform.pointLocation3D(new q(f.x,m.y)),S=this.transform.pointLocation3D(new q(m.x,f.y)),E=[Math.min(y.lng,v.lng,w.lng,S.lng),Math.min(y.lat,v.lat,w.lat,S.lat)],A=[Math.max(y.lng,v.lng,w.lng,S.lng),Math.max(y.lat,v.lat,w.lat,S.lat)],M=s&&s.pitch?s.pitch:this.getPitch(),k=this._cameraForBounds(this.transform,E,A,i,M,s);return this._fitInternal(k,s,l)}_fitInternal(e,n,i){return e?(delete(n=ge(e,n)).padding,n.linear?this.easeTo(n,i):this.flyTo(n,i)):this}jumpTo(e,n){this.stop();const i=e.preloadOnly?this.transform.clone():this.transform;let s=!1,l=!1,u=!1;return"zoom"in e&&i.zoom!==+e.zoom&&(s=!0,i.zoom=+e.zoom),e.center!==void 0&&(i.center=sn.convert(e.center)),"bearing"in e&&i.bearing!==+e.bearing&&(l=!0,i.bearing=+e.bearing),"pitch"in e&&i.pitch!==+e.pitch&&(u=!0,i.pitch=+e.pitch),e.padding==null||i.isPaddingEqual(e.padding)||(i.padding=e.padding),e.preloadOnly?(this._preloadTiles(i),this):(this.fire(new ct("movestart",n)).fire(new ct("move",n)),s&&this.fire(new ct("zoomstart",n)).fire(new ct("zoom",n)).fire(new ct("zoomend",n)),l&&this.fire(new ct("rotatestart",n)).fire(new ct("rotate",n)).fire(new ct("rotateend",n)),u&&this.fire(new ct("pitchstart",n)).fire(new ct("pitch",n)).fire(new ct("pitchend",n)),this.fire(new ct("moveend",n)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||ye(cR),this.transform.getFreeCameraOptions()}setFreeCameraOptions(e,n){const i=this.transform;if(!i.projection.supportsFreeCamera)return ye(cR),this;this.stop();const s=i.zoom,l=i.pitch,u=i.bearing;i.setFreeCameraOptions(e);const h=s!==i.zoom,f=l!==i.pitch,m=u!==i.bearing;return this.fire(new ct("movestart",n)).fire(new ct("move",n)),h&&this.fire(new ct("zoomstart",n)).fire(new ct("zoom",n)).fire(new ct("zoomend",n)),m&&this.fire(new ct("rotatestart",n)).fire(new ct("rotate",n)).fire(new ct("rotateend",n)),f&&this.fire(new ct("pitchstart",n)).fire(new ct("pitch",n)).fire(new ct("pitchend",n)),this.fire(new ct("moveend",n)),this}easeTo(e,n){this._stop(!1,e.easeId),((e=ge({offset:[0,0],duration:500,easing:Q},e)).animate===!1||this._prefersReducedMotion(e))&&(e.duration=0);const i=this.transform,s=this.getZoom(),l=this.getBearing(),u=this.getPitch(),h=this.getPadding(),f="zoom"in e?+e.zoom:s,m="bearing"in e?this._normalizeBearing(e.bearing,l):l,y="pitch"in e?+e.pitch:u,v="padding"in e?e.padding:i.padding,w=q.convert(e.offset);let S,E,A;if(i.projection.name==="globe"){const ne=Un.fromLngLat(i.center),re=w.rotate(-i.angle);ne.x+=re.x/i.worldSize,ne.y+=re.y/i.worldSize;const J=ne.toLngLat(),ae=sn.convert(e.center||J);this._normalizeCenter(ae),S=i.centerPoint.add(re),E=new q(ne.x,ne.y).mult(i.worldSize),A=new q(io(ae.lng),co(ae.lat)).mult(i.worldSize).sub(E)}else{S=i.centerPoint.add(w);const ne=i.pointLocation(S),re=sn.convert(e.center||ne);this._normalizeCenter(re),E=i.project(ne),A=i.project(re).sub(E)}const M=i.zoomScale(f-s);let k,R;e.around&&(k=sn.convert(e.around),R=i.locationPoint(k));const L=this._zooming||f!==s,z=this._rotating||l!==m,B=this._pitching||y!==u,j=!i.isPaddingEqual(v),V=ne=>re=>{if(L&&(ne.zoom=nn(s,f,re)),z&&(ne.bearing=nn(l,m,re)),B&&(ne.pitch=nn(u,y,re)),j&&(ne.interpolatePadding(h,v,re),S=ne.centerPoint.add(w)),k)ne.setLocationAtPoint(k,R);else{const J=ne.zoomScale(ne.zoom-s),ae=f>s?Math.min(2,M):Math.max(.5,M),le=Math.pow(ae,1-re),oe=ne.unproject(E.add(A.mult(re*le)).mult(J));ne.setLocationAtPoint(ne.renderWorldCopies?oe.wrap():oe,S)}return e.preloadOnly||this._fireMoveEvents(n),ne};if(e.preloadOnly){const ne=this._emulate(V,e.duration,i);return this._preloadTiles(ne),this}const Y={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=L,this._rotating=z,this._pitching=B,this._padding=j,this._easeId=e.easeId,this._prepareEase(n,e.noMoveStart,Y),this._ease(V(i),ne=>{i.recenterOnTerrain(),this._afterEase(n,ne)},e),this}_prepareEase(e,n,i={}){this._moving=!0,this.transform.cameraElevationReference="sea",n||i.moving||this.fire(new ct("movestart",e)),this._zooming&&!i.zooming&&this.fire(new ct("zoomstart",e)),this._rotating&&!i.rotating&&this.fire(new ct("rotatestart",e)),this._pitching&&!i.pitching&&this.fire(new ct("pitchstart",e))}_fireMoveEvents(e){this.fire(new ct("move",e)),this._zooming&&this.fire(new ct("zoom",e)),this._rotating&&this.fire(new ct("rotate",e)),this._pitching&&this.fire(new ct("pitch",e))}_afterEase(e,n){if(this._easeId&&n&&this._easeId===n)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const i=this._zooming,s=this._rotating,l=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,i&&this.fire(new ct("zoomend",e)),s&&this.fire(new ct("rotateend",e)),l&&this.fire(new ct("pitchend",e)),this.fire(new ct("moveend",e))}flyTo(e,n){if(this._prefersReducedMotion(e)){const Ae=Pt(e,["center","zoom","bearing","pitch","around"]);return this.jumpTo(Ae,n)}this.stop(),e=ge({offset:[0,0],speed:1.2,curve:1.42,easing:Q},e);const i=this.transform,s=this.getZoom(),l=this.getBearing(),u=this.getPitch(),h=this.getPadding(),f="zoom"in e?ce(+e.zoom,i.minZoom,i.maxZoom):s,m="bearing"in e?this._normalizeBearing(e.bearing,l):l,y="pitch"in e?+e.pitch:u,v="padding"in e?e.padding:i.padding,w=i.zoomScale(f-s),S=q.convert(e.offset);let E=i.centerPoint.add(S);const A=i.pointLocation(E),M=sn.convert(e.center||A);this._normalizeCenter(M);const k=i.project(A),R=i.project(M).sub(k);let L=e.curve;const z=Math.max(i.width,i.height),B=z/w,j=R.mag();if("minZoom"in e){const Ae=ce(Math.min(e.minZoom,s,f),i.minZoom,i.maxZoom),Le=z/i.zoomScale(Ae-s);L=Math.sqrt(Le/j*2)}const V=L*L;function Y(Ae){const Le=(B*B-z*z+(Ae?-1:1)*V*V*j*j)/(2*(Ae?B:z)*V*j);return Math.log(Math.sqrt(Le*Le+1)-Le)}function ne(Ae){return(Math.exp(Ae)-Math.exp(-Ae))/2}function re(Ae){return(Math.exp(Ae)+Math.exp(-Ae))/2}const J=Y(0);let ae=function(Ae){return re(J)/re(J+L*Ae)},le=function(Ae){return z*((re(J)*(ne(Le=J+L*Ae)/re(Le))-ne(J))/V)/j;var Le},oe=(Y(1)-J)/L;if(Math.abs(j)<1e-6||!isFinite(oe)){if(Math.abs(z-B)<1e-6)return this.easeTo(e,n);const Ae=B<z?-1:1;oe=Math.abs(Math.log(B/z))/L,le=function(){return 0},ae=function(Le){return Math.exp(Ae*L*Le)}}e.duration="duration"in e?+e.duration:1e3*oe/("screenSpeed"in e?+e.screenSpeed/L:+e.speed),e.maxDuration&&e.duration>e.maxDuration&&(e.duration=0);const Ee=l!==m,xe=y!==u,Pe=!i.isPaddingEqual(v),pe=Ae=>Le=>{const qe=Le*oe,Ve=1/ae(qe);Ae.zoom=Le===1?f:s+Ae.scaleZoom(Ve),Ee&&(Ae.bearing=nn(l,m,Le)),xe&&(Ae.pitch=nn(u,y,Le)),Pe&&(Ae.interpolatePadding(h,v,Le),E=Ae.centerPoint.add(S));const yt=Le===1?M:Ae.unproject(k.add(R.mult(le(qe))).mult(Ve));return Ae.setLocationAtPoint(Ae.renderWorldCopies?yt.wrap():yt,E),Ae._updateCameraOnTerrain(),e.preloadOnly||this._fireMoveEvents(n),Ae};if(e.preloadOnly){const Ae=this._emulate(pe,e.duration,i);return this._preloadTiles(Ae),this}return this._zooming=!0,this._rotating=Ee,this._pitching=xe,this._padding=Pe,this._prepareEase(n,!1),this._ease(pe(i),()=>this._afterEase(n),e),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(e,n){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const i=this._onEaseEnd;this._onEaseEnd=void 0,i.call(this,n)}if(!e){const i=this.handlers;i&&i.stop(!1)}return this}_ease(e,n,i){i.animate===!1||i.duration===0?(e(1),n()):(this._easeStart=mn.now(),this._easeOptions=i,this._onEaseFrame=e,this._onEaseEnd=n,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const e=Math.min((mn.now()-this._easeStart)/this._easeOptions.duration,1),n=this._onEaseFrame;n&&n(this._easeOptions.easing(e)),e<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(e,n){e=He(e,-180,180);const i=Math.abs(e-n);return Math.abs(e-360-n)<i&&(e-=360),Math.abs(e+360-n)<i&&(e+=360),e}_normalizeCenter(e){const n=this.transform;if(!n.renderWorldCopies||n.maxBounds)return;const i=e.lng-n.center.lng;e.lng+=i>180?-360:i<-180?360:0}_prefersReducedMotion(e){return this._respectPrefersReducedMotion&&mn.prefersReducedMotion&&!(e&&e.essential)}_emulate(e,n,i){const s=Math.ceil(15*n/1e3),l=[],u=e(i.clone());for(let h=0;h<=s;h++){const f=u(h/s);l.push(f.clone())}return l}}class hR{constructor(e={}){this.options=e,On(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(e){const n=this.options&&this.options.compact;return this._map=e,this._container=lr("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=lr("button","mapboxgl-ctrl-attrib-button",this._container),lr("span","mapboxgl-ctrl-icon",this._compactButton).setAttribute("aria-hidden","true"),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=lr("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),n&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),n===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_setElementTitle(e,n){const i=this._map._getUIString(`AttributionControl.${n}`);e.setAttribute("aria-label",i),e.removeAttribute("title"),e.firstElementChild&&e.firstElementChild.setAttribute("title",i)}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let e=this._editLink;e||(e=this._editLink=this._container.querySelector(".mapbox-improve-map"));const n=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||F.ACCESS_TOKEN}];if(e){const i=n.reduce((s,l,u)=>(l.value&&(s+=`${l.key}=${l.value}${u<n.length-1?"&":""}`),s),"?");e.href=`${F.FEEDBACK_URL}/${i}#${iR(this._map,!0)}`,e.rel="noopener nofollow",this._setElementTitle(e,"MapFeedback")}}_updateData(e){!e||e.sourceDataType!=="metadata"&&e.sourceDataType!=="visibility"&&e.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let e=[];if(this._map.style.stylesheet){const s=this._map.style.stylesheet;this.styleOwner=s.owner,this.styleId=s.id}const n=this._map.style._sourceCaches;for(const s in n){const l=n[s];if(l.used){const u=l.getSource();u.attribution&&e.indexOf(u.attribution)<0&&e.push(u.attribution)}}e.sort((s,l)=>s.length-l.length),e=e.filter((s,l)=>{for(let u=l+1;u<e.length;u++)if(e[u].indexOf(s)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?e=[...this.options.customAttribution,...e]:e.unshift(this.options.customAttribution));const i=e.join(" | ");i!==this._attribHTML&&(this._attribHTML=i,e.length?(this._innerContainer.innerHTML=i,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class dR{constructor(){On(["_updateLogo","_updateCompact"],this)}onAdd(e){this._map=e,this._container=lr("div","mapboxgl-ctrl");const n=lr("a","mapboxgl-ctrl-logo");return n.target="_blank",n.rel="noopener nofollow",n.href="https://www.mapbox.com/",n.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),n.setAttribute("rel","noopener nofollow"),this._container.appendChild(n),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(e){e&&e.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const e=this._map.style._sourceCaches;if(Object.entries(e).length===0)return!0;for(const n in e){const i=e[n].getSource();if(i.hasOwnProperty("mapbox_logo")&&!i.mapbox_logo)return!1}return!0}_updateCompact(){const e=this._container.children;if(e.length){const n=e[0];this._map.getCanvasContainer().offsetWidth<250?n.classList.add("mapboxgl-compact"):n.classList.remove("mapboxgl-compact")}}}class fR{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(e){const n=++this._id;return this._queue.push({callback:e,id:n,cancelled:!1}),n}remove(e){const n=this._currentlyRunning,i=n?this._queue.concat(n):this._queue;for(const s of i)if(s.id===e)return void(s.cancelled=!0)}run(e=0){const n=this._currentlyRunning=this._queue;this._queue=[];for(const i of n)if(!i.cancelled&&(i.callback(e),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}function pR(t,e,n){if(t=new sn(t.lng,t.lat),e){const i=new sn(t.lng-360,t.lat),s=new sn(t.lng+360,t.lat),l=360*Math.ceil(Math.abs(t.lng-n.center.lng)/360),u=n.locationPoint(t).distSqr(e),h=e.x<0||e.y<0||e.x>n.width||e.y>n.height;n.locationPoint(i).distSqr(e)<u&&(h||Math.abs(i.lng-n.center.lng)<l)?t=i:n.locationPoint(s).distSqr(e)<u&&(h||Math.abs(s.lng-n.center.lng)<l)&&(t=s)}for(;Math.abs(t.lng-n.center.lng)>180;){const i=n.locationPoint(t);if(i.x>=0&&i.y>=0&&i.x<=n.width&&i.y<=n.height)break;t.lng>n.center.lng?t.lng-=360:t.lng+=360}return t}const kE={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class PE extends Cr{constructor(e,n){if(super(),(e instanceof C.HTMLElement||n)&&(e=ge({element:e},n)),On(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=e&&e.anchor||"center",this._color=e&&e.color||"#3FB1CE",this._scale=e&&e.scale||1,this._draggable=e&&e.draggable||!1,this._clickTolerance=e&&e.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=e&&e.rotation||0,this._rotationAlignment=e&&e.rotationAlignment||"auto",this._pitchAlignment=e&&e.pitchAlignment&&e.pitchAlignment||"auto",this._updateMoving=()=>this._update(!0),this._occludedOpacity=e&&e.occludedOpacity||.2,e&&e.element)this._element=e.element,this._offset=q.convert(e&&e.offset||[0,0]);else{this._defaultMarker=!0,this._element=lr("div");const l=41,u=27,h=sa("svg",{display:"block",height:l*this._scale+"px",width:u*this._scale+"px",viewBox:`0 0 ${u} ${l}`},this._element),f=sa("radialGradient",{id:"shadowGradient"},sa("defs",{},h));sa("stop",{offset:"10%","stop-opacity":.4},f),sa("stop",{offset:"100%","stop-opacity":.05},f),sa("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},h),sa("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},h),sa("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},h),sa("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},h),this._offset=q.convert(e&&e.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",l=>{l.preventDefault()}),this._element.addEventListener("mousedown",l=>{l.preventDefault()});const i=this._element.classList;for(const l in kE)i.remove(`mapboxgl-marker-anchor-${l}`);i.add(`mapboxgl-marker-anchor-${this._anchor}`);const s=e&&e.className?e.className.trim().split(/\s+/):[];i.add(...s),this._popup=null}addTo(e){return e===this._map||(this.remove(),this._map=e,e.getCanvasContainer().appendChild(this._element),e.on("move",this._updateMoving),e.on("moveend",this._update),e.on("remove",this._clearFadeTimer),e._addMarker(this),this.setDraggable(this._draggable),this._update(),e.on("click",this._onMapClick)),this}remove(){const e=this._map;return e&&(e.off("click",this._onMapClick),e.off("move",this._updateMoving),e.off("moveend",this._update),e.off("mousedown",this._addDragHandler),e.off("touchstart",this._addDragHandler),e.off("mouseup",this._onUp),e.off("touchend",this._onUp),e.off("mousemove",this._onMove),e.off("touchmove",this._onMove),e.off("remove",this._clearFadeTimer),e._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(e){return this._lngLat=sn.convert(e),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(e){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),e){if(!("offset"in e.options)){const s=Math.sqrt(Math.pow(13.5,2)/2);e.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[s,-1*(38.1-13.5+s)],"bottom-right":[-s,-1*(38.1-13.5+s)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=e,e._marker=this,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(e){const n=e.code,i=e.charCode||e.keyCode;n!=="Space"&&n!=="Enter"&&i!==32&&i!==13||this.togglePopup()}_onMapClick(e){const n=e.originalEvent.target,i=this._element;this._popup&&(n===i||i.contains(n))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const e=this._popup;return e?(e.isOpen()?(e.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(e.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const e=this._map,n=this._pos;if(!e||!n)return!1;const i=e.unproject(n),s=e.getFreeCameraOptions();if(!s.position)return!1;const l=s.position.toLngLat();return l.distanceTo(i)<.9*l.distanceTo(this._lngLat)}_evaluateOpacity(){const e=this._map;if(!e)return;const n=this._pos;if(!n||n.x<0||n.x>e.transform.width||n.y<0||n.y>e.transform.height)return void this._clearFadeTimer();const i=e.unproject(n);let s;e._showingGlobe()&&T1(e.transform,this._lngLat)?s=0:(s=1-e._queryFogOpacity(i),e.transform._terrainEnabled()&&e.getTerrain()&&this._behindTerrain()&&(s*=this._occludedOpacity)),this._element.style.opacity=`${s}`,this._element.style.pointerEvents=s>0?"auto":"none",this._popup&&this._popup._setOpacity(s),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const e=this._pos;if(!e||!this._map)return;const n=this._offset.mult(this._scale);this._element.style.transform=`
            translate(${e.x}px,${e.y}px)
            ${kE[this._anchor]}
            ${this._calculateXYTransform()} ${this._calculateZTransform()}
            translate(${n.x}px,${n.y}px)
        `}_calculateXYTransform(){const e=this._pos,n=this._map,i=this.getPitchAlignment();if(!n||!e||i!=="map")return"";if(!n._showingGlobe()){const f=n.getPitch();return f?`rotateX(${f}deg)`:""}const s=rt(a3(n.transform,this._lngLat)),l=e.sub(s3(n.transform)),u=Math.abs(l.x)+Math.abs(l.y);if(u===0)return"";const h=s/u;return`rotateX(${-l.y*h}deg) rotateY(${l.x*h}deg)`}_calculateZTransform(){const e=this._pos,n=this._map;if(!n||!e)return"";let i=0;const s=this.getRotationAlignment();if(s==="map")if(n._showingGlobe()){const l=n.project(new sn(this._lngLat.lng,this._lngLat.lat+.001)),u=n.project(new sn(this._lngLat.lng,this._lngLat.lat-.001)).sub(l);i=rt(Math.atan2(u.y,u.x))-90}else i=-n.getBearing();else if(s==="horizon"){const l=De(4,6,n.getZoom()),u=s3(n.transform);u.y+=l*n.transform.height;const h=e.sub(u),f=rt(Math.atan2(h.y,h.x));i=(f>90?f-270:f+90)*(1-l)}return i+=this._rotation,i?`rotateZ(${i}deg)`:""}_update(e){C.cancelAnimationFrame(this._updateFrameId);const n=this._map;n&&(n.transform.renderWorldCopies&&(this._lngLat=pR(this._lngLat,this._pos,n.transform)),this._pos=n.project(this._lngLat),e===!0?this._updateFrameId=C.requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),n._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(n._showingGlobe()||n.getTerrain()||n.getFog())&&!this._fadeTimer&&(this._fadeTimer=setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(e){return this._offset=q.convert(e),this._update(),this}addClassName(e){return this._element.classList.add(e),this}removeClassName(e){return this._element.classList.remove(e),this}toggleClassName(e){return this._element.classList.toggle(e)}_onMove(e){const n=this._map;if(!n)return;const i=this._pointerdownPos,s=this._positionDelta;if(i&&s){if(!this._isDragging){const l=this._clickTolerance||n._clickTolerance;if(e.point.dist(i)<l)return;this._isDragging=!0}this._pos=e.point.sub(s),this._lngLat=n.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new ct("dragstart"))),this.fire(new ct("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const e=this._map;e&&(e.off("mousemove",this._onMove),e.off("touchmove",this._onMove)),this._state==="active"&&this.fire(new ct("dragend")),this._state="inactive"}_addDragHandler(e){const n=this._map,i=this._pos;n&&i&&this._element.contains(e.originalEvent.target)&&(e.preventDefault(),this._positionDelta=e.point.sub(i),this._pointerdownPos=e.point,this._state="pending",n.on("mousemove",this._onMove),n.on("touchmove",this._onMove),n.once("mouseup",this._onUp),n.once("touchend",this._onUp))}setDraggable(e){this._draggable=!!e;const n=this._map;return n&&(e?(n.on("mousedown",this._addDragHandler),n.on("touchstart",this._addDragHandler)):(n.off("mousedown",this._addDragHandler),n.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(e){return this._rotation=e||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(e){return this._rotationAlignment=e||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment==="auto"||this._rotationAlignment==="horizon"&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(e){return this._pitchAlignment=e||"auto",this._update(),this}getPitchAlignment(){return this._pitchAlignment==="auto"?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(e){return this._occludedOpacity=e||.2,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const HV={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},qV=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function mR(t=new q(0,0),e="bottom"){if(typeof t=="number"){const n=Math.round(Math.sqrt(.5*Math.pow(t,2)));switch(e){case"top":return new q(0,t);case"top-left":return new q(n,n);case"top-right":return new q(-n,n);case"bottom":return new q(0,-t);case"bottom-left":return new q(n,-n);case"bottom-right":return new q(-n,-n);case"left":return new q(t,0);case"right":return new q(-t,0)}return new q(0,0)}return t instanceof q||Array.isArray(t)?q.convert(t):q.convert(t[e]||[0,0])}class WV{constructor(e){this.jumpTo(e)}getValue(e){if(e<=this._startTime)return this._start;if(e>=this._endTime)return this._end;const n=zt((e-this._startTime)/(this._endTime-this._startTime));return this._start*(1-n)+this._end*n}isEasing(e){return e>=this._startTime&&e<=this._endTime}jumpTo(e){this._startTime=-1/0,this._endTime=-1/0,this._start=e,this._end=e}easeTo(e,n,i){this._start=this.getValue(n),this._end=e,this._startTime=n,this._endTime=n+i}}const ZV={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use  + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"},XV={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,antialias:!1,useWebGL2:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,optimizeForTerrain:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,respectPrefersReducedMotion:!0,crossSourceCollisions:!0,collectResourceTiming:!1,testMode:!1},KV={showCompass:!0,showZoom:!0,visualizePitch:!1};class YV{constructor(e,n,i=!1){this._clickTolerance=10,this.element=n,this.mouseRotate=new oR({clickTolerance:e.dragRotate._mouseRotate._clickTolerance}),this.map=e,i&&(this.mousePitch=new sR({clickTolerance:e.dragRotate._mousePitch._clickTolerance})),On(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),n.addEventListener("mousedown",this.mousedown),n.addEventListener("touchstart",this.touchstart,{passive:!1}),n.addEventListener("touchmove",this.touchmove),n.addEventListener("touchend",this.touchend),n.addEventListener("touchcancel",this.reset)}down(e,n){this.mouseRotate.mousedown(e,n),this.mousePitch&&this.mousePitch.mousedown(e,n),Hf()}move(e,n){const i=this.map,s=this.mouseRotate.mousemoveWindow(e,n),l=s&&s.bearingDelta;if(l&&i.setBearing(i.getBearing()+l),this.mousePitch){const u=this.mousePitch.mousemoveWindow(e,n),h=u&&u.pitchDelta;h&&i.setPitch(i.getPitch()+h)}}off(){const e=this.element;e.removeEventListener("mousedown",this.mousedown),e.removeEventListener("touchstart",this.touchstart,{passive:!1}),e.removeEventListener("touchmove",this.touchmove),e.removeEventListener("touchend",this.touchend),e.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){Lr(),C.removeEventListener("mousemove",this.mousemove),C.removeEventListener("mouseup",this.mouseup)}mousedown(e){this.down(ge({},e,{ctrlKey:!0,preventDefault:()=>e.preventDefault()}),Eu(this.element,e)),C.addEventListener("mousemove",this.mousemove),C.addEventListener("mouseup",this.mouseup)}mousemove(e){this.move(e,Eu(this.element,e))}mouseup(e){this.mouseRotate.mouseupWindow(e),this.mousePitch&&this.mousePitch.mouseupWindow(e),this.offTemp()}touchstart(e){e.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=ad(this.element,e.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>e.preventDefault()},this._startPos))}touchmove(e){e.targetTouches.length!==1?this.reset():(this._lastPos=ad(this.element,e.targetTouches)[0],this.move({preventDefault:()=>e.preventDefault()},this._lastPos))}touchend(e){e.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}const QV={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},JV={maxWidth:100,unit:"metric"},e7={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"},Dx={version:P,supported:Dv,setRTLTextPlugin:function(t,e,n=!1){if(Fo===qu||Fo===$d||Fo===Gd)throw new Error("setRTLTextPlugin cannot be called multiple times.");ol=mn.resolveURL(t),Fo=qu,Dp=e,Lp(),n||Ny()},getRTLTextPluginStatus:zp,Map:class extends GV{constructor(t){if(Hs.mark(vu.create),(t=ge({},XV,t)).minZoom!=null&&t.maxZoom!=null&&t.minZoom>t.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(t.minPitch!=null&&t.maxPitch!=null&&t.minPitch>t.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(t.minPitch!=null&&t.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(t.maxPitch!=null&&t.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(t.antialias&&function(e){const n=e.navigator?e.navigator.userAgent:null;return!!Wt(e)&&n&&(n.match("Version/15.4")||n.match("Version/15.5")||n.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))}(C)&&(t.antialias=!1,ye("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new ZS(t.minZoom,t.maxZoom,t.minPitch,t.maxPitch,t.renderWorldCopies),t),this._interactive=t.interactive,this._minTileCacheSize=t.minTileCacheSize,this._maxTileCacheSize=t.maxTileCacheSize,this._failIfMajorPerformanceCaveat=t.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=t.preserveDrawingBuffer,this._antialias=t.antialias,this._useWebGL2=t.useWebGL2,this._trackResize=t.trackResize,this._bearingSnap=t.bearingSnap,this._refreshExpiredTiles=t.refreshExpiredTiles,this._fadeDuration=t.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=t.crossSourceCollisions,this._collectResourceTiming=t.collectResourceTiming,this._optimizeForTerrain=t.optimizeForTerrain,this._language=this._parseLanguage(t.language),this._worldview=t.worldview,this._renderTaskQueue=new fR,this._domRenderTaskQueue=new fR,this._controls=[],this._markers=[],this._popups=[],this._mapId=Dn(),this._locale=ge({},ZV,t.locale),this._clickTolerance=t.clickTolerance,this._cooperativeGestures=t.cooperativeGestures,this._performanceMetricsCollection=t.performanceMetricsCollection,this._containerWidth=0,this._containerHeight=0,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new WV(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._requestManager=new qn(t.transformRequest,t.accessToken,t.testMode),this._silenceAuthErrors=!!t.testMode,typeof t.container=="string"){if(this._container=C.document.getElementById(t.container),!this._container)throw new Error(`Container '${t.container.toString()}' not found.`)}else{if(!(t.container instanceof C.HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=t.container}if(this._container.childNodes.length>0&&ye("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),t.maxBounds&&this.setMaxBounds(t.maxBounds),On(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");if(this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),C!==void 0&&(this._fullscreenchangeEvent="onfullscreenchange"in C.document?"fullscreenchange":"webkitfullscreenchange",C.addEventListener("online",this._onWindowOnline,!1),C.addEventListener("resize",this._onWindowResize,!1),C.addEventListener("orientationchange",this._onWindowResize,!1),C.addEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),C.addEventListener("visibilitychange",this._onVisibilityChange,!1)),this.handlers=new $V(this,t),this._localFontFamily=t.localFontFamily,this._localIdeographFontFamily=t.localIdeographFontFamily,(t.style||!t.testMode)&&this.setStyle(t.style||F.DEFAULT_STYLE,{localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),t.projection&&this.setProjection(t.projection),t.hash&&(this._hash=new fV(typeof t.hash=="string"&&t.hash||void 0).addTo(this)),!this._hash||!this._hash._onHashChange()){this.jumpTo({center:t.center,zoom:t.zoom,bearing:t.bearing,pitch:t.pitch});const e=t.bounds;e&&(this.resize(),this.fitBounds(e,ge({},t.fitBoundsOptions,{duration:0})))}this.resize(),t.attributionControl&&this.addControl(new hR({customAttribution:t.customAttribution})),this._logoControl=new dR,this.addControl(this._logoControl,t.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",e=>{this._update(e.dataType==="style"),this.fire(new ct(`${e.dataType}data`,e))}),this.on("dataloading",e=>{this.fire(new ct(`${e.dataType}dataloading`,e))})}_getMapId(){return this._mapId}addControl(t,e){if(e===void 0&&(e=t.getDefaultPosition?t.getDefaultPosition():"top-right"),!t||!t.onAdd)return this.fire(new en(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const n=t.onAdd(this);this._controls.push(t);const i=this._controlPositions[e];return e.indexOf("bottom")!==-1?i.insertBefore(n,i.firstChild):i.appendChild(n),this}removeControl(t){if(!t||!t.onRemove)return this.fire(new en(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const e=this._controls.indexOf(t);return e>-1&&this._controls.splice(e,1),t.onRemove(this),this}hasControl(t){return this._controls.indexOf(t)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(t){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const e=!this._moving;return e&&this.fire(new ct("movestart",t)).fire(new ct("move",t)),this.fire(new ct("resize",t)),e&&this.fire(new ct("moveend",t)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(t){return this.transform.setMaxBounds(li.convert(t)),this._update()}setMinZoom(t){if((t=t??-2)>=-2&&t<=this.transform.maxZoom)return this.transform.minZoom=t,this._update(),this.getZoom()<t?this.setZoom(t):this.fire(new ct("zoomstart")).fire(new ct("zoom")).fire(new ct("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(t){if((t=t??22)>=this.transform.minZoom)return this.transform.maxZoom=t,this._update(),this.getZoom()>t?this.setZoom(t):this.fire(new ct("zoomstart")).fire(new ct("zoom")).fire(new ct("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(t){if((t=t??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(t>=0&&t<=this.transform.maxPitch)return this.transform.minPitch=t,this._update(),this.getPitch()<t?this.setPitch(t):this.fire(new ct("pitchstart")).fire(new ct("pitch")).fire(new ct("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(t){if((t=t??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(t>=this.transform.minPitch)return this.transform.maxPitch=t,this._update(),this.getPitch()>t?this.setPitch(t):this.fire(new ct("pitchstart")).fire(new ct("pitch")).fire(new ct("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(t){return this.transform.renderWorldCopies=t,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(t){return t==="auto"?C.navigator.language:Array.isArray(t)?t.length===0?void 0:t.map(e=>e==="auto"?C.navigator.language:e):t}setLanguage(t){const e=this._parseLanguage(t);if(!this.style||e===this._language)return this;this._language=e,this.style._reloadSources();for(const n of this._controls)n._setLanguage&&n._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(t){return this.style&&t!==this._worldview?(this._worldview=t,this.style._reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return this.transform.projection.name==="globe"}setProjection(t){return this._lazyInitEmptyStyle(),t?typeof t=="string"&&(t={name:t}):t=null,this._useExplicitProjection=!!t,this._prioritizeAndUpdateProjection(t,this.style.stylesheet?this.style.stylesheet.projection:null)}_updateProjectionTransition(){if(this.getProjection().name!=="globe")return;const t=this.transform,e=t.projection.name;let n;e==="globe"&&t.zoom>=dh?(t.setMercatorFromTransition(),n=!0):e==="mercator"&&t.zoom<dh&&(t.setProjection({name:"globe"}),n=!0),n&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(t,e){return this._updateProjection(t||e||{name:"mercator"})}_updateProjection(t){let e;if(e=t.name==="globe"&&this.transform.zoom>=dh?this.transform.setMercatorFromTransition():this.transform.setProjection(t),this.style.applyProjectionUpdate(),e){this.painter.clearBackgroundTiles();for(const n in this.style._sourceCaches)this.style._sourceCaches[n].clearTiles();this._update(!0),this._forceMarkerAndPopupUpdate(!0)}return this}project(t){return this.transform.locationPoint3D(sn.convert(t))}unproject(t){return this.transform.pointLocation3D(q.convert(t))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(t,e,n){if(t==="mouseenter"||t==="mouseover"){let i=!1;const s=u=>{const h=e.filter(m=>this.getLayer(m)),f=h.length?this.queryRenderedFeatures(u.point,{layers:h}):[];f.length?i||(i=!0,n.call(this,new Ys(t,this,u.originalEvent,{features:f}))):i=!1},l=()=>{i=!1};return{layers:new Set(e),listener:n,delegates:{mousemove:s,mouseout:l}}}if(t==="mouseleave"||t==="mouseout"){let i=!1;const s=u=>{const h=e.filter(f=>this.getLayer(f));(h.length?this.queryRenderedFeatures(u.point,{layers:h}):[]).length?i=!0:i&&(i=!1,n.call(this,new Ys(t,this,u.originalEvent)))},l=u=>{i&&(i=!1,n.call(this,new Ys(t,this,u.originalEvent)))};return{layers:new Set(e),listener:n,delegates:{mousemove:s,mouseout:l}}}{const i=s=>{const l=e.filter(h=>this.getLayer(h)),u=l.length?this.queryRenderedFeatures(s.point,{layers:l}):[];u.length&&(s.features=u,n.call(this,s),delete s.features)};return{layers:new Set(e),listener:n,delegates:{[t]:i}}}}on(t,e,n){if(n===void 0)return super.on(t,e);Array.isArray(e)||(e=[e]);const i=this._createDelegatedListener(t,e,n);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[t]=this._delegatedListeners[t]||[],this._delegatedListeners[t].push(i);for(const s in i.delegates)this.on(s,i.delegates[s]);return this}once(t,e,n){if(n===void 0)return super.once(t,e);Array.isArray(e)||(e=[e]);const i=this._createDelegatedListener(t,e,n);for(const s in i.delegates)this.once(s,i.delegates[s]);return this}off(t,e,n){if(n===void 0)return super.off(t,e);e=new Set(Array.isArray(e)?e:[e]);const i=(l,u)=>{if(l.size!==u.size)return!1;for(const h of l)if(!u.has(h))return!1;return!0},s=this._delegatedListeners?this._delegatedListeners[t]:void 0;return s&&(l=>{for(let u=0;u<l.length;u++){const h=l[u];if(h.listener===n&&i(h.layers,e)){for(const f in h.delegates)this.off(f,h.delegates[f]);return l.splice(u,1),this}}})(s),this}queryRenderedFeatures(t,e){return this.style?(e!==void 0||t===void 0||t instanceof q||Array.isArray(t)||(e=t,t=void 0),this.style.queryRenderedFeatures(t=t||[[0,0],[this.transform.width,this.transform.height]],e=e||{},this.transform)):[]}querySourceFeatures(t,e){return this.style.querySourceFeatures(t,e)}isPointOnSurface(t){const{name:e}=this.transform.projection;return e!=="globe"&&e!=="mercator"&&ye(`${e} projection does not support isPointOnSurface, this API may behave unexpectedly.`),this.transform.isPointOnSurface(q.convert(t))}setStyle(t,e){return(e=ge({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},e)).diff!==!1&&e.localIdeographFontFamily===this._localIdeographFontFamily&&e.localFontFamily===this._localFontFamily&&this.style&&t?(this._diffStyle(t,e),this):(this._localIdeographFontFamily=e.localIdeographFontFamily,this._localFontFamily=e.localFontFamily,this._updateStyle(t,e))}_getUIString(t){const e=this._locale[t];if(e==null)throw new Error(`Missing UI string '${t}'`);return e}_updateStyle(t,e){return this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),t&&(this.style=new xl(this,e||{}),this.style.setEventedParent(this,{style:this.style}),typeof t=="string"?this.style.loadURL(t):this.style.loadJSON(t)),this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new xl(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(t,e){if(typeof t=="string"){const n=this._requestManager.normalizeStyleURL(t),i=this._requestManager.transformRequest(n,Ie.Style);ht(i,(s,l)=>{s?this.fire(new en(s)):l&&this._updateDiff(l,e)})}else typeof t=="object"&&this._updateDiff(t,e)}_updateDiff(t,e){try{this.style.setState(t)&&this._update(!0)}catch(n){ye(`Unable to perform style diff: ${n.message||n.error||n}.  Rebuilding the style from scratch.`),this._updateStyle(t,e)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(ye("There is no style added to the map."),!1)}addSource(t,e){return this._lazyInitEmptyStyle(),this.style.addSource(t,e),this._update(!0)}isSourceLoaded(t){return!!this.style&&this.style._isSourceCacheLoaded(t)}areTilesLoaded(){const t=this.style&&this.style._sourceCaches;for(const e in t){const n=t[e]._tiles;for(const i in n){const s=n[i];if(s.state!=="loaded"&&s.state!=="errored")return!1}}return!0}addSourceType(t,e,n){this._lazyInitEmptyStyle(),this.style.addSourceType(t,e,n)}removeSource(t){return this.style.removeSource(t),this._updateTerrain(),this._update(!0)}getSource(t){return this.style.getOwnSource(t)}addImage(t,e,{pixelRatio:n=1,sdf:i=!1,stretchX:s,stretchY:l,content:u}={}){if(this._lazyInitEmptyStyle(),e instanceof C.HTMLImageElement||C.ImageBitmap&&e instanceof C.ImageBitmap){const{width:h,height:f,data:m}=mn.getImageData(e);this.style.addImage(t,{data:new ui({width:h,height:f},m),pixelRatio:n,stretchX:s,stretchY:l,content:u,sdf:i,version:0})}else if(e.width===void 0||e.height===void 0)this.fire(new en(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:h,height:f}=e,m=e;this.style.addImage(t,{data:new ui({width:h,height:f},new Uint8Array(m.data)),pixelRatio:n,stretchX:s,stretchY:l,content:u,sdf:i,version:0,userImage:m}),m.onAdd&&m.onAdd(this,t)}}updateImage(t,e){const n=this.style.getImage(t);if(!n)return void this.fire(new en(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const i=e instanceof C.HTMLImageElement||C.ImageBitmap&&e instanceof C.ImageBitmap?mn.getImageData(e):e,{width:s,height:l}=i;s!==void 0&&l!==void 0?s===n.data.width&&l===n.data.height?(n.data.replace(i.data,!(e instanceof C.HTMLImageElement||C.ImageBitmap&&e instanceof C.ImageBitmap)),this.style.updateImage(t,n)):this.fire(new en(new Error(`The width and height of the updated image (${s}, ${l})
                must be that same as the previous version of the image
                (${n.data.width}, ${n.data.height})`))):this.fire(new en(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")))}hasImage(t){return t?!!this.style.getImage(t):(this.fire(new en(new Error("Missing required image id"))),!1)}removeImage(t){this.style.removeImage(t)}loadImage(t,e){xn(this._requestManager.transformRequest(t,Ie.Image),(n,i)=>{e(n,i instanceof C.HTMLImageElement?mn.getImageData(i):i)})}listImages(){return this.style.listImages()}addModel(t,e){this._lazyInitEmptyStyle(),this.style.addModel(t,e)}hasModel(t){return t?this.style.hasModel(t):(this.fire(new en(new Error("Missing required model id"))),!1)}removeModel(t){this.style.removeModel(t)}listModels(){return this.style.listModels()}addLayer(t,e){return this._lazyInitEmptyStyle(),this.style.addLayer(t,e),this._update(!0)}moveLayer(t,e){return this.style.moveLayer(t,e),this._update(!0)}removeLayer(t){return this.style.removeLayer(t),this._update(!0)}setLights(t){if(this._lazyInitEmptyStyle(),t&&t.length===1&&t[0].type==="flat"){const e=t[0];e.properties?this.style.setFlatLight(e.properties,e.id,{}):this.style.setFlatLight({},"flat")}else this.style.setLights(t),this.painter.terrain&&(this.painter.terrain.invalidateRenderCache=!0);return this._update(!0)}getLights(){const t=this.style.getLights()||[];return t.length===0&&t.push({id:this.style.light.id,type:"flat",properties:this.style.getFlatLight()}),t}getLayer(t){return this.style.getOwnLayer(t)}setLayerZoomRange(t,e,n){return this.style.setLayerZoomRange(t,e,n),this._update(!0)}setFilter(t,e,n={}){return this.style.setFilter(t,e,n),this._update(!0)}getFilter(t){return this.style.getFilter(t)}setPaintProperty(t,e,n,i={}){return this.style.setPaintProperty(t,e,n,i),this._update(!0)}getPaintProperty(t,e){return this.style.getPaintProperty(t,e)}setLayoutProperty(t,e,n,i={}){return this.style.setLayoutProperty(t,e,n,i),this._update(!0)}getLayoutProperty(t,e){return this.style.getLayoutProperty(t,e)}setConfigProperty(t,e,n){return this.style.setConfigProperty(t,e,n),this._update(!0)}setLight(t,e={}){return console.log("The `map.setLight` function is deprecated, prefer using `map.setLights` with `flat` light type instead."),this.setLights([{id:"flat",type:"flat",properties:t}])}getLight(){return console.log("The `map.getLight` function is deprecated, prefer using `map.getLights` instead."),this.style.getFlatLight()}setTerrain(t){return this._lazyInitEmptyStyle(),!t&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(t),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(t){return this._lazyInitEmptyStyle(),this.style.setFog(t),this._update(!0)}getFog(){return this.style?this.style.getFog():null}setCamera(t){return this.style.stylesheet.camera=t,this._update(this.transform.setOrthographicProjectionAtLowPitch(t["camera-projection"]==="orthographic"))}getCamera(){return this.style.stylesheet.camera}_queryFogOpacity(t){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(sn.convert(t),this.transform):0}setFeatureState(t,e){return this.style.setFeatureState(t,e),this._update()}removeFeatureState(t,e){return this.style.removeFeatureState(t,e),this._update()}getFeatureState(t){return this.style.getFeatureState(t)}_updateContainerDimensions(){if(!this._container)return;const t=this._container.getBoundingClientRect().width||400,e=this._container.getBoundingClientRect().height||300;let n,i,s,l=this._container;for(;l&&(!i||!s);){const u=C.getComputedStyle(l).transform;u&&u!=="none"&&(n=u.match(/matrix.*\((.+)\)/)[1].split(", "),n[0]&&n[0]!=="0"&&n[0]!=="1"&&(i=n[0]),n[3]&&n[3]!=="0"&&n[3]!=="1"&&(s=n[3])),l=l.parentElement}this._containerWidth=i?Math.abs(t/i):t,this._containerHeight=s?Math.abs(e/s):e}_detectMissingCSS(){C.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&ye("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const t=this._container;t.classList.add("mapboxgl-map"),(this._missingCSSCanary=lr("div","mapboxgl-canary",t)).style.visibility="hidden",this._detectMissingCSS();const e=this._canvasContainer=lr("div","mapboxgl-canvas-container",t);this._interactive&&e.classList.add("mapboxgl-interactive"),this._canvas=lr("canvas","mapboxgl-canvas",e),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const n=this._controlContainer=lr("div","mapboxgl-control-container",t),i=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(s=>{i[s]=lr("div",`mapboxgl-ctrl-${s}`,n)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(t,e){const n=mn.devicePixelRatio||1;this._canvas.width=n*Math.ceil(t),this._canvas.height=n*Math.ceil(e),this._canvas.style.width=`${t}px`,this._canvas.style.height=`${e}px`}_addMarker(t){this._markers.push(t)}_removeMarker(t){const e=this._markers.indexOf(t);e!==-1&&this._markers.splice(e,1)}_addPopup(t){this._popups.push(t)}_removePopup(t){const e=this._popups.indexOf(t);e!==-1&&this._popups.splice(e,1)}_setupPainter(){const t=ge({},Dv.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),e=this._useWebGL2&&this._canvas.getContext("webgl2",t),n=e||this._canvas.getContext("webgl",t)||this._canvas.getContext("experimental-webgl",t);n?(this._useWebGL2&&!e&&ye("Failed to create WebGL 2 context. Using WebGL 1."),Xg(n,!0),this.painter=new lV(n,this.transform,!!e),this.on("data",i=>{i.dataType==="source"&&this.painter.setTileLoadedFlag(!0)}),U.testSupport(n)):this.fire(new en(new Error("Failed to initialize WebGL")))}_contextLost(t){t.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new ct("webglcontextlost",{originalEvent:t}))}_contextRestored(t){this._setupPainter(),this.resize(),this._update(),this.fire(new ct("webglcontextrestored",{originalEvent:t}))}_onMapScroll(t){if(t.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(t){return this.style?(this._styleDirty=this._styleDirty||t,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(t){return this._update(),this._renderTaskQueue.add(t)}_cancelRenderFrame(t){this._renderTaskQueue.remove(t)}_requestDomTask(t){!this.loaded()||this.loaded()&&!this.isMoving()?t():this._domRenderTaskQueue.add(t)}_render(t){let e;const n=this.painter.context.extTimerQuery,i=mn.now();if(this.listens("gpu-timing-frame")&&(e=n.createQueryEXT(),n.beginQueryEXT(n.TIME_ELAPSED_EXT,e)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],C.performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],C.performance.now())),this._renderTaskQueue.run(t),this._domRenderTaskQueue.run(t),this._removed)return;this._updateProjectionTransition();const s=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const h=this.transform.zoom,f=this.transform.pitch,m=mn.now(),y=new Nr(h,{now:m,fadeDuration:s,pitch:f,transition:this.style.getTransition()});this.style.ambientLight&&this.style.ambientLight.recalculate(y),this.style.directionalLight&&this.style.directionalLight.recalculate(y);const v=this.style.calculateLightsBrightness();v!==void 0&&(y.brightness=v||0),this.style.update(y)}this.style&&this.style.fog&&this.style.fog.hasTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let l=!1;if(this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),l=this._updateAverageElevation(i),this.style._updateSources(this.transform),this._forceMarkerAndPopupUpdate()):l=this._updateAverageElevation(i),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,s,this._crossSourceCollisions),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,wireframe:{terrain:this.showTerrainWireframe,layers2D:this.showLayers2DWireframe,layers3D:this.showLayers3DWireframe},showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:s,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new ct("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new ct("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),e){const h=mn.now()-i;n.endQueryEXT(n.TIME_ELAPSED_EXT,e),setTimeout(()=>{const f=n.getQueryObjectEXT(e,n.QUERY_RESULT_EXT)/1e6;n.deleteQueryEXT(e),this.fire(new ct("gpu-timing-frame",{cpuTime:h,gpuTime:f})),C.performance.mark("frame-gpu",{startTime:i,detail:{gpuTime:f}})},50)}if(this.listens("gpu-timing-layer")){const h=this.painter.collectGpuTimers();setTimeout(()=>{const f=this.painter.queryGpuTimers(h);this.fire(new ct("gpu-timing-layer",{layerTimes:f}))},50)}if(this.listens("gpu-timing-deferred-render")){const h=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{const f=this.painter.queryGpuTimeDeferredRender(h);this.fire(new ct("gpu-timing-deferred-render",{gpuTime:f}))},50)}const u=this._sourcesDirty||this._styleDirty||this._placementDirty||l;if(u||this._repaint)this.triggerRepaint();else{const h=!this.isMoving()&&this.loaded();if(h&&(l=this._updateAverageElevation(i,!0)),l)this.triggerRepaint();else if(this._triggerFrame(!1),h&&(this.fire(new ct("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const f=this._calculateSpeedIndex();this.fire(new ct("speedindexcompleted",{speedIndex:f})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||u||(this._fullyLoaded=!0,Hs.mark(vu.fullLoad),this._performanceMetricsCollection&&Ol(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(t){for(const e of this._markers)t&&!this.getRenderWorldCopies()&&(e._lngLat=e._lngLat.wrap()),e._update();for(const e of this._popups)!t||this.getRenderWorldCopies()||e._trackPointer||(e._lngLat=e._lngLat.wrap()),e._update()}_updateAverageElevation(t,e=!1){const n=i=>(this.transform.averageElevation=i,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return this.transform.averageElevation!==0&&n(0);if((e||t-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(t)){const i=this.transform.averageElevation;let s=this.transform.sampleAverageElevation(),l=!1;this.transform.elevation&&(l=this.transform.elevation.exaggeration()!==this._averageElevationExaggeration,this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(s)?s=0:this._averageElevationLastSampledAt=t;const u=Math.abs(i-s);if(u>1){if(this._isInitialLoad||l)return this._averageElevation.jumpTo(s),n(s);this._averageElevation.easeTo(s,t,300)}else if(u>1e-4)return this._averageElevation.jumpTo(s),n(s)}return!!this._averageElevation.isEasing(t)&&n(this._averageElevation.getValue(t))}_authenticate(){$f(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,t=>{if(t&&(t.message===Ot||t.status===401)){const e=this.painter.context.gl;Xg(e,!1),this._logoControl instanceof dR&&this._logoControl._updateLogo(),e&&e.clear(e.DEPTH_BUFFER_BIT|e.COLOR_BUFFER_BIT|e.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new en(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),oi(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_updateTerrain(){const t=this._isDragging();this.painter.updateTerrain(this.style,t)}_calculateSpeedIndex(){const t=this.painter.canvasCopy(),e=this.painter.getCanvasCopiesAndTimestamps();e.timeStamps.push(performance.now());const n=this.painter.context.gl,i=n.createFramebuffer();function s(l){n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,l,0);const u=new Uint8Array(n.drawingBufferWidth*n.drawingBufferHeight*4);return n.readPixels(0,0,n.drawingBufferWidth,n.drawingBufferHeight,n.RGBA,n.UNSIGNED_BYTE,u),u}return n.bindFramebuffer(n.FRAMEBUFFER,i),this._canvasPixelComparison(s(t),e.canvasCopies.map(s),e.timeStamps)}_canvasPixelComparison(t,e,n){let i=n[1]-n[0];const s=t.length/4;for(let l=0;l<e.length;l++){const u=e[l];let h=0;for(let f=0;f<u.length;f+=4)u[f]===t[f]&&u[f+1]===t[f+1]&&u[f+2]===t[f+2]&&u[f+3]===t[f+3]&&(h+=1);i+=(n[l+2]-n[l+1])*(1-h/s)}return i}remove(){this._hash&&this._hash.remove();for(const e of this._controls)e.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),C!==void 0&&(C.removeEventListener("resize",this._onWindowResize,!1),C.removeEventListener("orientationchange",this._onWindowResize,!1),C.removeEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),C.removeEventListener("online",this._onWindowOnline,!1),C.removeEventListener("visibilitychange",this._onVisibilityChange,!1));const t=this.painter.context.gl.getExtension("WEBGL_lose_context");t&&t.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),Gf.delete(this.painter.context.gl),this._removed=!0,this.fire(new ct("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(t){this._renderNextFrame=this._renderNextFrame||t,this.style&&!this._frame&&(this._frame=mn.frame(e=>{const n=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,n&&this._render(e)}))}_preloadTiles(t){return $e(this.style?Object.values(this.style._sourceCaches):[],(e,n)=>e._preloadTiles(t,n),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(t){this._trackResize&&this.resize({originalEvent:t})._update()}_onVisibilityChange(){C.document.visibilityState==="hidden"&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(t){this._showTileBoundaries!==t&&(this._showTileBoundaries=t,this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(t){this._showTerrainWireframe!==t&&(this._showTerrainWireframe=t,this._update())}get showLayers2DWireframe(){return!!this._showLayers2DWireframe}set showLayers2DWireframe(t){this._showLayers2DWireframe!==t&&(this._showLayers2DWireframe=t,this._update())}get showLayers3DWireframe(){return!!this._showLayers3DWireframe}set showLayers3DWireframe(t){this._showLayers3DWireframe!==t&&(this._showLayers3DWireframe=t,this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(t){this._speedIndexTiming!==t&&(this._speedIndexTiming=t,this._update())}get showPadding(){return!!this._showPadding}set showPadding(t){this._showPadding!==t&&(this._showPadding=t,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(t){this._showCollisionBoxes!==t&&(this._showCollisionBoxes=t,t?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(t){this._showOverdrawInspector!==t&&(this._showOverdrawInspector=t,this._update())}get repaint(){return!!this._repaint}set repaint(t){this._repaint!==t&&(this._repaint=t,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(t){this._vertices=t,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(t){this._showTileAABBs!==t&&(this._showTileAABBs=t,t&&this._update())}_setCacheLimits(t,e){(function(n,i){be=n,Ke=i})(t,e)}get version(){return P}},NavigationControl:class{constructor(t){this.options=ge({},KV,t),this._container=lr("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",e=>e.preventDefault()),this.options.showZoom&&(On(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",e=>{this._map&&this._map.zoomIn({},{originalEvent:e})}),lr("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",e=>{this._map&&this._map.zoomOut({},{originalEvent:e})}),lr("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(On(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",e=>{const n=this._map;n&&(this.options.visualizePitch?n.resetNorthPitch({},{originalEvent:e}):n.resetNorth({},{originalEvent:e}))}),this._compassIcon=lr("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const t=this._map;if(!t)return;const e=t.getZoom(),n=e===t.getMaxZoom(),i=e===t.getMinZoom();this._zoomInButton.disabled=n,this._zoomOutButton.disabled=i,this._zoomInButton.setAttribute("aria-disabled",n.toString()),this._zoomOutButton.setAttribute("aria-disabled",i.toString())}_rotateCompassArrow(){const t=this._map;if(!t)return;const e=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(t.transform.pitch*(Math.PI/180)),.5)}) rotateX(${t.transform.pitch}deg) rotateZ(${t.transform.angle*(180/Math.PI)}deg)`:`rotate(${t.transform.angle*(180/Math.PI)}deg)`;t._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=e)})}onAdd(t){return this._map=t,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),t.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&t.on("pitch",this._rotateCompassArrow),t.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new YV(t,this._compass,this.options.visualizePitch)),this._container}onRemove(){const t=this._map;t&&(this._container.remove(),this.options.showZoom&&t.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&t.off("pitch",this._rotateCompassArrow),t.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(t,e){const n=lr("button",t,this._container);return n.type="button",n.addEventListener("click",e),n}_setButtonTitle(t,e){if(!this._map)return;const n=this._map._getUIString(`NavigationControl.${e}`);t.setAttribute("aria-label",n),t.firstElementChild&&t.firstElementChild.setAttribute("title",n)}},GeolocateControl:class extends Cr{constructor(t){super(),this.options=ge({geolocation:C.navigator.geolocation},QV,t),On(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=rR(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(t){return this._map=t,this._container=lr("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(t){const e=(n=!!this.options.geolocation)=>{this._supportsGeolocation=n,t(n)};this._supportsGeolocation!==void 0?t(this._supportsGeolocation):C.navigator.permissions!==void 0?C.navigator.permissions.query({name:"geolocation"}).then(n=>e(n.state!=="denied")).catch(()=>e()):e()}_isOutOfMapMaxBounds(t){const e=this._map.getMaxBounds(),n=t.coords;return!!e&&(n.longitude<e.getWest()||n.longitude>e.getEast()||n.latitude<e.getSouth()||n.latitude>e.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(t){if(this._map){if(this._isOutOfMapMaxBounds(t))return this._setErrorState(),this.fire(new ct("outofmaxbounds",t)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=t,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(t),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(t),this.options.showUserLocation&&this._userLocationDotMarker.removeClassName("mapboxgl-user-location-dot-stale"),this.fire(new ct("geolocate",t)),this._finish()}}_updateCamera(t){const e=new sn(t.coords.longitude,t.coords.latitude),n=t.coords.accuracy,i=ge({bearing:this._map.getBearing()},this.options.fitBoundsOptions);this._map.fitBounds(e.toBounds(n),i,{geolocateSource:!0})}_updateMarker(t){if(t){const e=new sn(t.coords.longitude,t.coords.latitude);this._accuracyCircleMarker.setLngLat(e).addTo(this._map),this._userLocationDotMarker.setLngLat(e).addTo(this._map),this._accuracy=t.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const t=this._map.transform,e=mr(1,t._center.lat)*t.worldSize,n=Math.ceil(2*this._accuracy*e);this._circleElement.style.width=`${n}px`,this._circleElement.style.height=`${n}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&typeof this._heading=="number"?(this._userLocationDotMarker.setRotation(this._heading),this._userLocationDotMarker.addClassName("mapboxgl-user-location-show-heading")):(this._userLocationDotMarker.removeClassName("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(t){if(this._map){if(this.options.trackUserLocation)if(t.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const e=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",e),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",e),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(t.code===3&&this._noTimeout)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._userLocationDotMarker.addClassName("mapboxgl-user-location-dot-stale"),this.fire(new ct("error",t)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(t){if(this._map!==void 0){if(this._container.addEventListener("contextmenu",e=>e.preventDefault()),this._geolocateButton=lr("button","mapboxgl-ctrl-geolocate",this._container),lr("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",t===!1){ye("Geolocation support is not available so the GeolocateControl will be disabled.");const e=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",e),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",e)}else{const e=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",e),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",e)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=lr("div","mapboxgl-user-location"),this._dotElement.appendChild(lr("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(lr("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new PE({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=lr("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new PE({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",e=>{e.geolocateSource||this._watchState!=="ACTIVE_LOCK"||e.originalEvent&&e.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new ct("trackuserlocationend")))})}}_onDeviceOrientation(t){this._userLocationDotMarker&&(t.webkitCompassHeading?this._heading=t.webkitCompassHeading:t.absolute===!0&&(this._heading=-1*t.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return ye("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new ct("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new ct("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new ct("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let t;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(t={maximumAge:6e5,timeout:0},this._noTimeout=!0):(t=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,t),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const t=()=>{C.addEventListener("ondeviceorientationabsolute"in C?"deviceorientationabsolute":"deviceorientation",this._onDeviceOrientation)};C.DeviceMotionEvent!==void 0&&typeof C.DeviceMotionEvent.requestPermission=="function"?DeviceOrientationEvent.requestPermission().then(e=>{e==="granted"&&t()}).catch(console.error):t()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),C.removeEventListener("deviceorientation",this._onDeviceOrientation),C.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:hR,ScaleControl:class{constructor(t){this.options=ge({},JV,t),this._isNumberFormatSupported=function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"short",unit:"meter"}),!0}catch{return!1}}(),On(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const t=this.options.maxWidth||100,e=this._map,n=e._containerHeight/2,i=e._containerWidth/2-t/2,s=e.unproject([i,n]),l=e.unproject([i+t,n]),u=s.distanceTo(l);if(this.options.unit==="imperial"){const h=3.2808*u;h>5280?this._setScale(t,h/5280,"mile"):this._setScale(t,h,"foot")}else this.options.unit==="nautical"?this._setScale(t,u/1852,"nautical-mile"):u>=1e3?this._setScale(t,u/1e3,"kilometer"):this._setScale(t,u,"meter")}_setScale(t,e,n){this._map._requestDomTask(()=>{const i=function(l){const u=Math.pow(10,`${Math.floor(l)}`.length-1);let h=l/u;return h=h>=10?10:h>=5?5:h>=3?3:h>=2?2:h>=1?1:function(f){const m=Math.pow(10,Math.ceil(-Math.log(f)/Math.LN10));return Math.round(f*m)/m}(h),u*h}(e),s=i/e;this._container.innerHTML=this._isNumberFormatSupported&&n!=="nautical-mile"?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"short",unit:n}).format(i):`${i}&nbsp;${e7[n]}`,this._container.style.width=t*s+"px"})}onAdd(t){return this._map=t,this._language=t.getLanguage(),this._container=lr("div","mapboxgl-ctrl mapboxgl-ctrl-scale",t.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(t){this._language=t,this._update()}setUnit(t){this.options.unit=t,this._update()}},FullscreenControl:class{constructor(t){this._fullscreen=!1,t&&t.container&&(t.container instanceof C.HTMLElement?this._container=t.container:ye("Full screen control 'container' must be a DOM element.")),On(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in C.document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in C.document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(t){return this._map=t,this._container||(this._container=this._map.getContainer()),this._controlContainer=lr("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",ye("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,C.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!C.document.fullscreenEnabled&&!C.document.webkitFullscreenEnabled)}_setupUI(){const t=this._fullscreenButton=lr("button","mapboxgl-ctrl-fullscreen",this._controlContainer);lr("span","mapboxgl-ctrl-icon",t).setAttribute("aria-hidden","true"),t.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),C.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const t=this._getTitle();this._fullscreenButton.setAttribute("aria-label",t),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",t)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(C.document.fullscreenElement||C.document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?C.document.exitFullscreen?C.document.exitFullscreen():C.document.webkitCancelFullScreen&&C.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends Cr{constructor(t){super(),this.options=ge(Object.create(HV),t),On(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(t&&t.className?t.className.trim().split(/\s+/):[])}addTo(t){return this._map&&this.remove(),this._map=t,this.options.closeOnClick&&t.on("preclick",this._onClose),this.options.closeOnMove&&t.on("move",this._onClose),t.on("remove",this.remove),this._update(),t._addPopup(this),this._focusFirstElement(),this._trackPointer?(t.on("mousemove",this._onMouseEvent),t.on("mouseup",this._onMouseEvent),t._canvasContainer.classList.add("mapboxgl-track-pointer")):t.on("move",this._update),this.fire(new ct("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const t=this._map;return t&&(t.off("move",this._update),t.off("move",this._onClose),t.off("preclick",this._onClose),t.off("click",this._onClose),t.off("remove",this.remove),t.off("mousemove",this._onMouseEvent),t.off("mouseup",this._onMouseEvent),t.off("drag",this._onMouseEvent),t._canvasContainer&&t._canvasContainer.classList.remove("mapboxgl-track-pointer"),t._removePopup(this),this._map=void 0),this.fire(new ct("close")),this}getLngLat(){return this._lngLat}setLngLat(t){this._lngLat=sn.convert(t),this._pos=null,this._trackPointer=!1,this._update();const e=this._map;return e&&(e.on("move",this._update),e.off("mousemove",this._onMouseEvent),e._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const t=this._map;return t&&(t.off("move",this._update),t.on("mousemove",this._onMouseEvent),t.on("drag",this._onMouseEvent),t._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(t){return this.setDOMContent(C.document.createTextNode(t))}setHTML(t){const e=C.document.createDocumentFragment(),n=C.document.createElement("body");let i;for(n.innerHTML=t;i=n.firstChild,i;)e.appendChild(i);return this.setDOMContent(e)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(t){return this.options.maxWidth=t,this._update(),this}setDOMContent(t){let e=this._content;if(e)for(;e.hasChildNodes();)e.firstChild&&e.removeChild(e.firstChild);else e=this._content=lr("div","mapboxgl-popup-content",this._container||void 0);if(e.appendChild(t),this.options.closeButton){const n=this._closeButton=lr("button","mapboxgl-popup-close-button",e);n.type="button",n.setAttribute("aria-label","Close popup"),n.setAttribute("aria-hidden","true"),n.innerHTML="&#215;",n.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(t){return this._classList.add(t),this._updateClassList(),this}removeClassName(t){return this._classList.delete(t),this._updateClassList(),this}setOffset(t){return this.options.offset=t,this._update(),this}toggleClassName(t){let e;return this._classList.delete(t)?e=!1:(this._classList.add(t),e=!0),this._updateClassList(),e}_onMouseEvent(t){this._update(t.point)}_getAnchor(t){if(this.options.anchor)return this.options.anchor;const e=this._map,n=this._container,i=this._pos;if(!e||!n||!i)return"bottom";const s=n.offsetWidth,l=n.offsetHeight,u=i.x<s/2,h=i.x>e.transform.width-s/2;if(i.y+t<l)return u?"top-left":h?"top-right":"top";if(i.y>e.transform.height-l){if(u)return"bottom-left";if(h)return"bottom-right"}return u?"left":h?"right":"bottom"}_updateClassList(){const t=this._container;if(!t)return;const e=[...this._classList];e.push("mapboxgl-popup"),this._anchor&&e.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&e.push("mapboxgl-popup-track-pointer"),t.className=e.join(" ")}_update(t){const e=this._map,n=this._content;if(!e||!this._lngLat&&!this._trackPointer||!n)return;let i=this._container;if(i||(i=this._container=lr("div","mapboxgl-popup",e.getContainer()),this._tip=lr("div","mapboxgl-popup-tip",i),i.appendChild(n)),this.options.maxWidth&&i.style.maxWidth!==this.options.maxWidth&&(i.style.maxWidth=this.options.maxWidth),e.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=pR(this._lngLat,this._pos,e.transform)),!this._trackPointer||t){const s=this._pos=this._trackPointer&&t?t:e.project(this._lngLat),l=mR(this.options.offset),u=this._anchor=this._getAnchor(l.y),h=mR(this.options.offset,u),f=s.add(h).round();e._requestDomTask(()=>{this._container&&u&&(this._container.style.transform=`${kE[u]} translate(${f.x}px,${f.y}px)`)})}if(!this._marker&&e._showingGlobe()){const s=T1(e.transform,this._lngLat)?0:1;this._setOpacity(s)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const t=this._container.querySelector(qV);t&&t.focus()}_onClose(){this.remove()}_setOpacity(t){this._container&&(this._container.style.opacity=`${t}`),this._content&&(this._content.style.pointerEvents=t?"auto":"none")}},Marker:PE,Style:xl,LngLat:sn,LngLatBounds:li,Point:q,MercatorCoordinate:Un,FreeCameraOptions:DI,Evented:Cr,config:F,prewarm:function(){O_().acquire(iE)},clearPrewarmedResources:function(){const t=L_;t&&(t.isPreloaded()&&t.numActive()===1?(t.release(iE),L_=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return F.ACCESS_TOKEN},set accessToken(t){F.ACCESS_TOKEN=t},get baseApiUrl(){return F.API_URL},set baseApiUrl(t){F.API_URL=t},get workerCount(){return Om.workerCount},set workerCount(t){Om.workerCount=t},get maxParallelImageRequests(){return F.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(t){F.MAX_PARALLEL_IMAGE_REQUESTS=t},clearStorage(t){(function(e){if(!Ht())return;const n=C.caches.delete(Xe);e&&n.catch(e).then(()=>e())})(t)},workerUrl:"",workerClass:null,get loadersUrl(){return $k()},set loadersUrl(t){(function(e){oE=mn.resolveURL(e),sE||(sE=new ff(O_(),new Cr)),sE.broadcast("setLoadersUrl",oE)})(t)},setNow:mn.setNow,restoreNow:mn.restoreNow};T.Actor=kk,T.DEMData=bm,T.EXTENT=Ge,T.Event=ct,T.FeatureIndex=MS,T.KDBush=wx,T.OverscaledTileID=Ir,T.Point=q,T.Tiled3dModelBucket=ik,T.VectorTileFeature=B1,T.VectorTileWorkerSource=class extends Cr{constructor(t,e,n,i,s,l){super(),this.actor=t,this.layerIndex=e,this.availableImages=n,this.loadVectorData=s||Fk,this.loading={},this.loaded={},this.deduped=new zk(t.scheduler),this.isSpriteLoaded=i,this.scheduler=t.scheduler,this.brightness=l}loadTile(t,e){const n=t.uid,i=t&&t.request,s=i&&i.collectResourceTiming,l=this.loading[n]=new Sj(t);l.abort=this.loadVectorData(t,(u,h)=>{const f=!this.loading[n];if(delete this.loading[n],f||u||!h)return l.status="done",f||(this.loaded[n]=l),e(u);const m=h.rawData,y={};h.expires&&(y.expires=h.expires),h.cacheControl&&(y.cacheControl=h.cacheControl),l.vectorTile=h.vectorTile||new CS(new V1(m));const v=()=>{l.parse(l.vectorTile,this.layerIndex,this.availableImages,this.actor,(w,S)=>{if(w||!S)return e(w);const E={};if(s){const A=Rv(i);A.length>0&&(E.resourceTiming=JSON.parse(JSON.stringify(A)))}e(null,ge({rawTileData:m.slice(0)},S,y,E))})};this.isSpriteLoaded?v():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(v,{type:"parseTile",isSymbolTile:t.isSymbolTile,zoom:t.tileZoom}):v()}),this.loaded=this.loaded||{},this.loaded[n]=l})}reloadTile(t,e){const n=this.loaded,i=t.uid,s=this;if(n&&n[i]){const l=n[i];l.showCollisionBoxes=t.showCollisionBoxes,l.enableTerrain=!!t.enableTerrain,l.projection=t.projection,l.brightness=t.brightness,l.tileTransform=hf(t.tileID.canonical,t.projection);const u=(h,f)=>{const m=l.reloadCallback;m&&(delete l.reloadCallback,l.parse(l.vectorTile,s.layerIndex,this.availableImages,s.actor,m)),e(h,f)};l.status==="parsing"?l.reloadCallback=u:l.status==="done"&&(l.vectorTile?l.parse(l.vectorTile,this.layerIndex,this.availableImages,this.actor,u):u())}}abortTile(t,e){const n=t.uid,i=this.loading[n];i&&(i.abort&&i.abort(),delete this.loading[n]),e()}removeTile(t,e){const n=this.loaded,i=t.uid;n&&n[i]&&delete n[i],e()}},T.convertB3dm=function(t,e){const n=rE(t);for(const i of n)i.lights&&(i.meshes.push(Pj(i.lights,e)),i.lightMeshIndex=i.meshes.length-1);return n},T.createExpression=Ar,T.createStyleLayer=gx,T.enforceCacheSizeLimit=function(t){$t(),nt&&nt.then(e=>{e.keys().then(n=>{for(let i=0;i<n.length-t;i++)e.delete(n[i])})})},T.exported=Dx,T.extend=ge,T.getArrayBuffer=at,T.getDefaultExportFromCjs=ee,T.getJSON=ht,T.getPerformanceMeasurement=Rv,T.getProjection=Y1,T.load3DTile=async function(t){return await Gk(),mapboxglLoaders.parse(t,mapboxglLoaders.Tiles3DLoader,{worker:!1,gltf:{decompressMeshes:!0,postProcess:!1,loadBuffers:!0,loadImages:!0}})},T.pbf=L3,T.plugin=xo,T.pointGeometry=he,T.refProperties=Wk,T.tileToMeter=c_,T.values=xt,T.vectorTile=F1,T.window=C}),_(["./shared"],function(T){function C(et){if(typeof et=="number"||typeof et=="boolean"||typeof et=="string"||et==null)return JSON.stringify(et);if(Array.isArray(et)){let ue="[";for(const ye of et)ue+=`${C(ye)},`;return`${ue}]`}let te="{";for(const ue of Object.keys(et).sort())te+=`${ue}:${C(et[ue])},`;return`${te}}`}function P(et){let te="";for(const ue of T.refProperties)te+=`/${C(et[ue])}`;return te}class O{constructor(te){this.keyCache={},te&&this.replace(te)}replace(te,ue){this._layerConfigs={},this._layers={},this.update(te,[],ue)}update(te,ue,ye){this._options=ye;for(const Je of te)this._layerConfigs[Je.id]=Je,(this._layers[Je.id]=T.createStyleLayer(Je,this._options)).compileFilter(),this.keyCache[Je.id]&&delete this.keyCache[Je.id];for(const Je of ue)delete this.keyCache[Je],delete this._layerConfigs[Je],delete this._layers[Je];this.familiesBySource={};const We=function(Je,bt){const St={};for(let wt=0;wt<Je.length;wt++){const Rt=bt&&bt[Je[wt].id]||P(Je[wt]);bt&&(bt[Je[wt].id]=Rt);let Wt=St[Rt];Wt||(Wt=St[Rt]=[]),Wt.push(Je[wt])}const Ne=[];for(const wt in St)Ne.push(St[wt]);return Ne}(T.values(this._layerConfigs),this.keyCache);for(const Je of We){const bt=Je.map(cn=>this._layers[cn.id]),St=bt[0];if(St.visibility==="none")continue;const Ne=St.source||"";let wt=this.familiesBySource[Ne];wt||(wt=this.familiesBySource[Ne]={});const Rt=St.sourceLayer||"_geojsonTileLayer";let Wt=wt[Rt];Wt||(Wt=wt[Rt]=[]),Wt.push(bt)}}}class F{loadTile(te,ue){const{uid:ye,encoding:We,rawImageData:Je,padding:bt,buildQuadTree:St}=te,Ne=T.window.ImageBitmap&&Je instanceof T.window.ImageBitmap?this.getImageData(Je,bt):Je;ue(null,new T.DEMData(ye,Ne,We,bt<1,St))}getImageData(te,ue){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(te.width,te.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=te.width,this.offscreenCanvas.height=te.height,this.offscreenCanvasContext.drawImage(te,0,0,te.width,te.height);const ye=this.offscreenCanvasContext.getImageData(-ue,-ue,te.width+2*ue,te.height+2*ue);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),ye}}function U(et,te){if(et.length!==0){Z(et[0],te);for(var ue=1;ue<et.length;ue++)Z(et[ue],!te)}}function Z(et,te){for(var ue=0,ye=0,We=0,Je=et.length,bt=Je-1;We<Je;bt=We++){var St=(et[We][0]-et[bt][0])*(et[bt][1]+et[We][1]),Ne=ue+St;ye+=Math.abs(ue)>=Math.abs(St)?ue-Ne+St:St-Ne+ue,ue=Ne}ue+ye>=0!=!!te&&et.reverse()}var $=T.getDefaultExportFromCjs(function et(te,ue){var ye,We=te&&te.type;if(We==="FeatureCollection")for(ye=0;ye<te.features.length;ye++)et(te.features[ye],ue);else if(We==="GeometryCollection")for(ye=0;ye<te.geometries.length;ye++)et(te.geometries[ye],ue);else if(We==="Feature")et(te.geometry,ue);else if(We==="Polygon")U(te.coordinates,ue);else if(We==="MultiPolygon")for(ye=0;ye<te.coordinates.length;ye++)U(te.coordinates[ye],ue);return te});const K=T.VectorTileFeature.prototype.toGeoJSON;var ie={exports:{}},H=T.pointGeometry,G=T.vectorTile.VectorTileFeature,ee=W;function W(et,te){this.options=te||{},this.features=et,this.length=et.length}function me(et,te){this.id=typeof et.id=="number"?et.id:void 0,this.type=et.type,this.rawGeometry=et.type===1?[et.geometry]:et.geometry,this.properties=et.tags,this.extent=te||4096}W.prototype.feature=function(et){return new me(this.features[et],this.options.extent)},me.prototype.loadGeometry=function(){var et=this.rawGeometry;this.geometry=[];for(var te=0;te<et.length;te++){for(var ue=et[te],ye=[],We=0;We<ue.length;We++)ye.push(new H(ue[We][0],ue[We][1]));this.geometry.push(ye)}return this.geometry},me.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var et=this.geometry,te=1/0,ue=-1/0,ye=1/0,We=-1/0,Je=0;Je<et.length;Je++)for(var bt=et[Je],St=0;St<bt.length;St++){var Ne=bt[St];te=Math.min(te,Ne.x),ue=Math.max(ue,Ne.x),ye=Math.min(ye,Ne.y),We=Math.max(We,Ne.y)}return[te,ye,ue,We]},me.prototype.toGeoJSON=G.prototype.toGeoJSON;var de=T.pbf,he=ee;function se(et){var te=new de;return function(ue,ye){for(var We in ue.layers)ye.writeMessage(3,q,ue.layers[We])}(et,te),te.finish()}function q(et,te){var ue;te.writeVarintField(15,et.version||1),te.writeStringField(1,et.name||""),te.writeVarintField(5,et.extent||4096);var ye={keys:[],values:[],keycache:{},valuecache:{}};for(ue=0;ue<et.length;ue++)ye.feature=et.feature(ue),te.writeMessage(2,Se,ye);var We=ye.keys;for(ue=0;ue<We.length;ue++)te.writeStringField(3,We[ue]);var Je=ye.values;for(ue=0;ue<Je.length;ue++)te.writeMessage(4,_t,Je[ue])}function Se(et,te){var ue=et.feature;ue.id!==void 0&&te.writeVarintField(1,ue.id),te.writeMessage(2,ze,et),te.writeVarintField(3,ue.type),te.writeMessage(4,rt,ue)}function ze(et,te){var ue=et.feature,ye=et.keys,We=et.values,Je=et.keycache,bt=et.valuecache;for(var St in ue.properties){var Ne=ue.properties[St],wt=Je[St];if(Ne!==null){wt===void 0&&(ye.push(St),Je[St]=wt=ye.length-1),te.writeVarint(wt);var Rt=typeof Ne;Rt!=="string"&&Rt!=="boolean"&&Rt!=="number"&&(Ne=JSON.stringify(Ne));var Wt=Rt+":"+Ne,cn=bt[Wt];cn===void 0&&(We.push(Ne),bt[Wt]=cn=We.length-1),te.writeVarint(cn)}}}function Ue(et,te){return(te<<3)+(7&et)}function Be(et){return et<<1^et>>31}function rt(et,te){for(var ue=et.loadGeometry(),ye=et.type,We=0,Je=0,bt=ue.length,St=0;St<bt;St++){var Ne=ue[St],wt=1;ye===1&&(wt=Ne.length),te.writeVarint(Ue(1,wt));for(var Rt=ye===3?Ne.length-1:Ne.length,Wt=0;Wt<Rt;Wt++){Wt===1&&ye!==1&&te.writeVarint(Ue(2,Rt-1));var cn=Ne[Wt].x-We,Yn=Ne[Wt].y-Je;te.writeVarint(Be(cn)),te.writeVarint(Be(Yn)),We+=cn,Je+=Yn}ye===3&&te.writeVarint(Ue(7,1))}}function _t(et,te){var ue=typeof et;ue==="string"?te.writeStringField(1,et):ue==="boolean"?te.writeBooleanField(7,et):ue==="number"&&(et%1!=0?te.writeDoubleField(3,et):et<0?te.writeSVarintField(6,et):te.writeVarintField(5,et))}ie.exports=se,ie.exports.fromVectorTileJs=se,ie.exports.fromGeojsonVt=function(et,te){te=te||{};var ue={};for(var ye in et)ue[ye]=new he(et[ye].features,te),ue[ye].name=ye,ue[ye].version=te.version,ue[ye].extent=te.extent;return se({layers:ue})},ie.exports.GeoJSONWrapper=he;var zt=T.getDefaultExportFromCjs(ie.exports);const dt={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:et=>et},Te=Math.fround||(we=new Float32Array(1),et=>(we[0]=+et,we[0]));var we;const Q=3,ce=5,De=6;class He{constructor(te){this.options=Object.assign(Object.create(dt),te),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(te){const{log:ue,minZoom:ye,maxZoom:We}=this.options;ue&&console.time("total time");const Je=`prepare ${te.length} points`;ue&&console.time(Je),this.points=te;const bt=[];for(let Ne=0;Ne<te.length;Ne++){const wt=te[Ne];if(!wt.geometry)continue;const[Rt,Wt]=wt.geometry.coordinates,cn=Te(ge(Rt)),Yn=Te(Pt(Wt));bt.push(cn,Yn,1/0,Ne,-1,1),this.options.reduce&&bt.push(0)}let St=this.trees[We+1]=this._createTree(bt);ue&&console.timeEnd(Je);for(let Ne=We;Ne>=ye;Ne--){const wt=+Date.now();St=this.trees[Ne]=this._createTree(this._cluster(St,Ne)),ue&&console.log("z%d: %d clusters in %dms",Ne,St.numItems,+Date.now()-wt)}return ue&&console.timeEnd("total time"),this}getClusters(te,ue){let ye=((te[0]+180)%360+360)%360-180;const We=Math.max(-90,Math.min(90,te[1]));let Je=te[2]===180?180:((te[2]+180)%360+360)%360-180;const bt=Math.max(-90,Math.min(90,te[3]));if(te[2]-te[0]>=360)ye=-180,Je=180;else if(ye>Je){const Wt=this.getClusters([ye,We,180,bt],ue),cn=this.getClusters([-180,We,Je,bt],ue);return Wt.concat(cn)}const St=this.trees[this._limitZoom(ue)],Ne=St.range(ge(ye),Pt(bt),ge(Je),Pt(We)),wt=St.data,Rt=[];for(const Wt of Ne){const cn=this.stride*Wt;Rt.push(wt[cn+ce]>1?$e(wt,cn,this.clusterProps):this.points[wt[cn+Q]])}return Rt}getChildren(te){const ue=this._getOriginId(te),ye=this._getOriginZoom(te),We="No cluster with the specified id.",Je=this.trees[ye];if(!Je)throw new Error(We);const bt=Je.data;if(ue*this.stride>=bt.length)throw new Error(We);const St=this.options.radius/(this.options.extent*Math.pow(2,ye-1)),Ne=Je.within(bt[ue*this.stride],bt[ue*this.stride+1],St),wt=[];for(const Rt of Ne){const Wt=Rt*this.stride;bt[Wt+4]===te&&wt.push(bt[Wt+ce]>1?$e(bt,Wt,this.clusterProps):this.points[bt[Wt+Q]])}if(wt.length===0)throw new Error(We);return wt}getLeaves(te,ue,ye){const We=[];return this._appendLeaves(We,te,ue=ue||10,ye=ye||0,0),We}getTile(te,ue,ye){const We=this.trees[this._limitZoom(te)],Je=Math.pow(2,te),{extent:bt,radius:St}=this.options,Ne=St/bt,wt=(ye-Ne)/Je,Rt=(ye+1+Ne)/Je,Wt={features:[]};return this._addTileFeatures(We.range((ue-Ne)/Je,wt,(ue+1+Ne)/Je,Rt),We.data,ue,ye,Je,Wt),ue===0&&this._addTileFeatures(We.range(1-Ne/Je,wt,1,Rt),We.data,Je,ye,Je,Wt),ue===Je-1&&this._addTileFeatures(We.range(0,wt,Ne/Je,Rt),We.data,-1,ye,Je,Wt),Wt.features.length?Wt:null}getClusterExpansionZoom(te){let ue=this._getOriginZoom(te)-1;for(;ue<=this.options.maxZoom;){const ye=this.getChildren(te);if(ue++,ye.length!==1)break;te=ye[0].properties.cluster_id}return ue}_appendLeaves(te,ue,ye,We,Je){const bt=this.getChildren(ue);for(const St of bt){const Ne=St.properties;if(Ne&&Ne.cluster?Je+Ne.point_count<=We?Je+=Ne.point_count:Je=this._appendLeaves(te,Ne.cluster_id,ye,We,Je):Je<We?Je++:te.push(St),te.length===ye)break}return Je}_createTree(te){const ue=new T.KDBush(te.length/this.stride|0,this.options.nodeSize,Float32Array);for(let ye=0;ye<te.length;ye+=this.stride)ue.add(te[ye],te[ye+1]);return ue.finish(),ue.data=te,ue}_addTileFeatures(te,ue,ye,We,Je,bt){for(const St of te){const Ne=St*this.stride,wt=ue[Ne+ce]>1;let Rt,Wt,cn;if(wt)Rt=xt(ue,Ne,this.clusterProps),Wt=ue[Ne],cn=ue[Ne+1];else{const pr=this.points[ue[Ne+Q]];Rt=pr.properties;const[nr,dr]=pr.geometry.coordinates;Wt=ge(nr),cn=Pt(dr)}const Yn={type:1,geometry:[[Math.round(this.options.extent*(Wt*Je-ye)),Math.round(this.options.extent*(cn*Je-We))]],tags:Rt};let hr;hr=wt||this.options.generateId?ue[Ne+Q]:this.points[ue[Ne+Q]].id,hr!==void 0&&(Yn.id=hr),bt.features.push(Yn)}}_limitZoom(te){return Math.max(this.options.minZoom,Math.min(Math.floor(+te),this.options.maxZoom+1))}_cluster(te,ue){const{radius:ye,extent:We,reduce:Je,minPoints:bt}=this.options,St=ye/(We*Math.pow(2,ue)),Ne=te.data,wt=[],Rt=this.stride;for(let Wt=0;Wt<Ne.length;Wt+=Rt){if(Ne[Wt+2]<=ue)continue;Ne[Wt+2]=ue;const cn=Ne[Wt],Yn=Ne[Wt+1],hr=te.within(Ne[Wt],Ne[Wt+1],St),pr=Ne[Wt+ce];let nr=pr;for(const dr of hr){const Xe=dr*Rt;Ne[Xe+2]>ue&&(nr+=Ne[Xe+ce])}if(nr>pr&&nr>=bt){let dr,Xe=cn*pr,be=Yn*pr,Ke=-1;const nt=((Wt/Rt|0)<<5)+(ue+1)+this.points.length;for(const Vt of hr){const Ht=Vt*Rt;if(Ne[Ht+2]<=ue)continue;Ne[Ht+2]=ue;const $t=Ne[Ht+ce];Xe+=Ne[Ht]*$t,be+=Ne[Ht+1]*$t,Ne[Ht+4]=nt,Je&&(dr||(dr=this._map(Ne,Wt,!0),Ke=this.clusterProps.length,this.clusterProps.push(dr)),Je(dr,this._map(Ne,Ht)))}Ne[Wt+4]=nt,wt.push(Xe/nr,be/nr,1/0,nt,-1,nr),Je&&wt.push(Ke)}else{for(let dr=0;dr<Rt;dr++)wt.push(Ne[Wt+dr]);if(nr>1)for(const dr of hr){const Xe=dr*Rt;if(!(Ne[Xe+2]<=ue)){Ne[Xe+2]=ue;for(let be=0;be<Rt;be++)wt.push(Ne[Xe+be])}}}}return wt}_getOriginId(te){return te-this.points.length>>5}_getOriginZoom(te){return(te-this.points.length)%32}_map(te,ue,ye){if(te[ue+ce]>1){const bt=this.clusterProps[te[ue+De]];return ye?Object.assign({},bt):bt}const We=this.points[te[ue+Q]].properties,Je=this.options.map(We);return ye&&Je===We?Object.assign({},Je):Je}}function $e(et,te,ue){return{type:"Feature",id:et[te+Q],properties:xt(et,te,ue),geometry:{type:"Point",coordinates:[(ye=et[te],360*(ye-.5)),ot(et[te+1])]}};var ye}function xt(et,te,ue){const ye=et[te+ce],We=ye>=1e4?`${Math.round(ye/1e3)}k`:ye>=1e3?Math.round(ye/100)/10+"k":ye,Je=et[te+De],bt=Je===-1?{}:Object.assign({},ue[Je]);return Object.assign(bt,{cluster:!0,cluster_id:et[te+Q],point_count:ye,point_count_abbreviated:We})}function ge(et){return et/360+.5}function Pt(et){const te=Math.sin(et*Math.PI/180),ue=.5-.25*Math.log((1+te)/(1-te))/Math.PI;return ue<0?0:ue>1?1:ue}function ot(et){const te=(180-360*et)*Math.PI/180;return 360*Math.atan(Math.exp(te))/Math.PI-90}var Dn={exports:{}};Dn.exports=function(){function et(Oe,Ie,je,Qe){for(var tt,ht=Qe,at=je-Ie>>1,ut=je-Ie,Et=Oe[Ie],it=Oe[Ie+1],Yt=Oe[je],xn=Oe[je+1],Ot=Ie+3;Ot<je;Ot+=3){var qn=te(Oe[Ot],Oe[Ot+1],Et,it,Yt,xn);if(qn>ht)tt=Ot,ht=qn;else if(qn===ht){var Wn=Math.abs(Ot-at);Wn<ut&&(tt=Ot,ut=Wn)}}ht>Qe&&(tt-Ie>3&&et(Oe,Ie,tt,Qe),Oe[tt+2]=ht,je-tt>3&&et(Oe,tt,je,Qe))}function te(Oe,Ie,je,Qe,tt,ht){var at=tt-je,ut=ht-Qe;if(at!==0||ut!==0){var Et=((Oe-je)*at+(Ie-Qe)*ut)/(at*at+ut*ut);Et>1?(je=tt,Qe=ht):Et>0&&(je+=at*Et,Qe+=ut*Et)}return(at=Oe-je)*at+(ut=Ie-Qe)*ut}function ue(Oe,Ie,je,Qe){var tt={id:Oe===void 0?null:Oe,type:Ie,geometry:je,tags:Qe,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(ht){var at=ht.geometry,ut=ht.type;if(ut==="Point"||ut==="MultiPoint"||ut==="LineString")ye(ht,at);else if(ut==="Polygon"||ut==="MultiLineString")for(var Et=0;Et<at.length;Et++)ye(ht,at[Et]);else if(ut==="MultiPolygon")for(Et=0;Et<at.length;Et++)for(var it=0;it<at[Et].length;it++)ye(ht,at[Et][it])}(tt),tt}function ye(Oe,Ie){for(var je=0;je<Ie.length;je+=3)Oe.minX=Math.min(Oe.minX,Ie[je]),Oe.minY=Math.min(Oe.minY,Ie[je+1]),Oe.maxX=Math.max(Oe.maxX,Ie[je]),Oe.maxY=Math.max(Oe.maxY,Ie[je+1])}function We(Oe,Ie,je,Qe){if(Ie.geometry){var tt=Ie.geometry.coordinates,ht=Ie.geometry.type,at=Math.pow(je.tolerance/((1<<je.maxZoom)*je.extent),2),ut=[],Et=Ie.id;if(je.promoteId?Et=Ie.properties[je.promoteId]:je.generateId&&(Et=Qe||0),ht==="Point")Je(tt,ut);else if(ht==="MultiPoint")for(var it=0;it<tt.length;it++)Je(tt[it],ut);else if(ht==="LineString")bt(tt,ut,at,!1);else if(ht==="MultiLineString"){if(je.lineMetrics){for(it=0;it<tt.length;it++)bt(tt[it],ut=[],at,!1),Oe.push(ue(Et,"LineString",ut,Ie.properties));return}St(tt,ut,at,!1)}else if(ht==="Polygon")St(tt,ut,at,!0);else{if(ht!=="MultiPolygon"){if(ht==="GeometryCollection"){for(it=0;it<Ie.geometry.geometries.length;it++)We(Oe,{id:Et,geometry:Ie.geometry.geometries[it],properties:Ie.properties},je,Qe);return}throw new Error("Input data is not a valid GeoJSON object.")}for(it=0;it<tt.length;it++){var Yt=[];St(tt[it],Yt,at,!0),ut.push(Yt)}}Oe.push(ue(Et,ht,ut,Ie.properties))}}function Je(Oe,Ie){Ie.push(Ne(Oe[0])),Ie.push(wt(Oe[1])),Ie.push(0)}function bt(Oe,Ie,je,Qe){for(var tt,ht,at=0,ut=0;ut<Oe.length;ut++){var Et=Ne(Oe[ut][0]),it=wt(Oe[ut][1]);Ie.push(Et),Ie.push(it),Ie.push(0),ut>0&&(at+=Qe?(tt*it-Et*ht)/2:Math.sqrt(Math.pow(Et-tt,2)+Math.pow(it-ht,2))),tt=Et,ht=it}var Yt=Ie.length-3;Ie[2]=1,et(Ie,0,Yt,je),Ie[Yt+2]=1,Ie.size=Math.abs(at),Ie.start=0,Ie.end=Ie.size}function St(Oe,Ie,je,Qe){for(var tt=0;tt<Oe.length;tt++){var ht=[];bt(Oe[tt],ht,je,Qe),Ie.push(ht)}}function Ne(Oe){return Oe/360+.5}function wt(Oe){var Ie=Math.sin(Oe*Math.PI/180),je=.5-.25*Math.log((1+Ie)/(1-Ie))/Math.PI;return je<0?0:je>1?1:je}function Rt(Oe,Ie,je,Qe,tt,ht,at,ut){if(Qe/=Ie,ht>=(je/=Ie)&&at<Qe)return Oe;if(at<je||ht>=Qe)return null;for(var Et=[],it=0;it<Oe.length;it++){var Yt=Oe[it],xn=Yt.geometry,Ot=Yt.type,qn=tt===0?Yt.minX:Yt.minY,Wn=tt===0?Yt.maxX:Yt.maxY;if(qn>=je&&Wn<Qe)Et.push(Yt);else if(!(Wn<je||qn>=Qe)){var pn=[];if(Ot==="Point"||Ot==="MultiPoint")Wt(xn,pn,je,Qe,tt);else if(Ot==="LineString")cn(xn,pn,je,Qe,tt,!1,ut.lineMetrics);else if(Ot==="MultiLineString")hr(xn,pn,je,Qe,tt,!1);else if(Ot==="Polygon")hr(xn,pn,je,Qe,tt,!0);else if(Ot==="MultiPolygon")for(var rr=0;rr<xn.length;rr++){var Rr=[];hr(xn[rr],Rr,je,Qe,tt,!0),Rr.length&&pn.push(Rr)}if(pn.length){if(ut.lineMetrics&&Ot==="LineString"){for(rr=0;rr<pn.length;rr++)Et.push(ue(Yt.id,Ot,pn[rr],Yt.tags));continue}Ot!=="LineString"&&Ot!=="MultiLineString"||(pn.length===1?(Ot="LineString",pn=pn[0]):Ot="MultiLineString"),Ot!=="Point"&&Ot!=="MultiPoint"||(Ot=pn.length===3?"Point":"MultiPoint"),Et.push(ue(Yt.id,Ot,pn,Yt.tags))}}}return Et.length?Et:null}function Wt(Oe,Ie,je,Qe,tt){for(var ht=0;ht<Oe.length;ht+=3){var at=Oe[ht+tt];at>=je&&at<=Qe&&(Ie.push(Oe[ht]),Ie.push(Oe[ht+1]),Ie.push(Oe[ht+2]))}}function cn(Oe,Ie,je,Qe,tt,ht,at){for(var ut,Et,it=Yn(Oe),Yt=tt===0?nr:dr,xn=Oe.start,Ot=0;Ot<Oe.length-3;Ot+=3){var qn=Oe[Ot],Wn=Oe[Ot+1],pn=Oe[Ot+2],rr=Oe[Ot+3],Rr=Oe[Ot+4],Yr=tt===0?qn:Wn,ar=tt===0?rr:Rr,Dr=!1;at&&(ut=Math.sqrt(Math.pow(qn-rr,2)+Math.pow(Wn-Rr,2))),Yr<je?ar>je&&(Et=Yt(it,qn,Wn,rr,Rr,je),at&&(it.start=xn+ut*Et)):Yr>Qe?ar<Qe&&(Et=Yt(it,qn,Wn,rr,Rr,Qe),at&&(it.start=xn+ut*Et)):pr(it,qn,Wn,pn),ar<je&&Yr>=je&&(Et=Yt(it,qn,Wn,rr,Rr,je),Dr=!0),ar>Qe&&Yr<=Qe&&(Et=Yt(it,qn,Wn,rr,Rr,Qe),Dr=!0),!ht&&Dr&&(at&&(it.end=xn+ut*Et),Ie.push(it),it=Yn(Oe)),at&&(xn+=ut)}var Qr=Oe.length-3;qn=Oe[Qr],Wn=Oe[Qr+1],pn=Oe[Qr+2],(Yr=tt===0?qn:Wn)>=je&&Yr<=Qe&&pr(it,qn,Wn,pn),Qr=it.length-3,ht&&Qr>=3&&(it[Qr]!==it[0]||it[Qr+1]!==it[1])&&pr(it,it[0],it[1],it[2]),it.length&&Ie.push(it)}function Yn(Oe){var Ie=[];return Ie.size=Oe.size,Ie.start=Oe.start,Ie.end=Oe.end,Ie}function hr(Oe,Ie,je,Qe,tt,ht){for(var at=0;at<Oe.length;at++)cn(Oe[at],Ie,je,Qe,tt,ht,!1)}function pr(Oe,Ie,je,Qe){Oe.push(Ie),Oe.push(je),Oe.push(Qe)}function nr(Oe,Ie,je,Qe,tt,ht){var at=(ht-Ie)/(Qe-Ie);return Oe.push(ht),Oe.push(je+(tt-je)*at),Oe.push(1),at}function dr(Oe,Ie,je,Qe,tt,ht){var at=(ht-je)/(tt-je);return Oe.push(Ie+(Qe-Ie)*at),Oe.push(ht),Oe.push(1),at}function Xe(Oe,Ie){for(var je=[],Qe=0;Qe<Oe.length;Qe++){var tt,ht=Oe[Qe],at=ht.type;if(at==="Point"||at==="MultiPoint"||at==="LineString")tt=be(ht.geometry,Ie);else if(at==="MultiLineString"||at==="Polygon"){tt=[];for(var ut=0;ut<ht.geometry.length;ut++)tt.push(be(ht.geometry[ut],Ie))}else if(at==="MultiPolygon")for(tt=[],ut=0;ut<ht.geometry.length;ut++){for(var Et=[],it=0;it<ht.geometry[ut].length;it++)Et.push(be(ht.geometry[ut][it],Ie));tt.push(Et)}je.push(ue(ht.id,at,tt,ht.tags))}return je}function be(Oe,Ie){var je=[];je.size=Oe.size,Oe.start!==void 0&&(je.start=Oe.start,je.end=Oe.end);for(var Qe=0;Qe<Oe.length;Qe+=3)je.push(Oe[Qe]+Ie,Oe[Qe+1],Oe[Qe+2]);return je}function Ke(Oe,Ie){if(Oe.transformed)return Oe;var je,Qe,tt,ht=1<<Oe.z,at=Oe.x,ut=Oe.y;for(je=0;je<Oe.features.length;je++){var Et=Oe.features[je],it=Et.geometry,Yt=Et.type;if(Et.geometry=[],Yt===1)for(Qe=0;Qe<it.length;Qe+=2)Et.geometry.push(nt(it[Qe],it[Qe+1],Ie,ht,at,ut));else for(Qe=0;Qe<it.length;Qe++){var xn=[];for(tt=0;tt<it[Qe].length;tt+=2)xn.push(nt(it[Qe][tt],it[Qe][tt+1],Ie,ht,at,ut));Et.geometry.push(xn)}}return Oe.transformed=!0,Oe}function nt(Oe,Ie,je,Qe,tt,ht){return[Math.round(je*(Oe*Qe-tt)),Math.round(je*(Ie*Qe-ht))]}function Vt(Oe,Ie,je,Qe,tt){for(var ht=Ie===tt.maxZoom?0:tt.tolerance/((1<<Ie)*tt.extent),at={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:je,y:Qe,z:Ie,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},ut=0;ut<Oe.length;ut++){at.numFeatures++,Ht(at,Oe[ut],ht,tt);var Et=Oe[ut].minX,it=Oe[ut].minY,Yt=Oe[ut].maxX,xn=Oe[ut].maxY;Et<at.minX&&(at.minX=Et),it<at.minY&&(at.minY=it),Yt>at.maxX&&(at.maxX=Yt),xn>at.maxY&&(at.maxY=xn)}return at}function Ht(Oe,Ie,je,Qe){var tt=Ie.geometry,ht=Ie.type,at=[];if(ht==="Point"||ht==="MultiPoint")for(var ut=0;ut<tt.length;ut+=3)at.push(tt[ut]),at.push(tt[ut+1]),Oe.numPoints++,Oe.numSimplified++;else if(ht==="LineString")$t(at,tt,Oe,je,!1,!1);else if(ht==="MultiLineString"||ht==="Polygon")for(ut=0;ut<tt.length;ut++)$t(at,tt[ut],Oe,je,ht==="Polygon",ut===0);else if(ht==="MultiPolygon")for(var Et=0;Et<tt.length;Et++){var it=tt[Et];for(ut=0;ut<it.length;ut++)$t(at,it[ut],Oe,je,!0,ut===0)}if(at.length){var Yt=Ie.tags||null;if(ht==="LineString"&&Qe.lineMetrics){for(var xn in Yt={},Ie.tags)Yt[xn]=Ie.tags[xn];Yt.mapbox_clip_start=tt.start/tt.size,Yt.mapbox_clip_end=tt.end/tt.size}var Ot={geometry:at,type:ht==="Polygon"||ht==="MultiPolygon"?3:ht==="LineString"||ht==="MultiLineString"?2:1,tags:Yt};Ie.id!==null&&(Ot.id=Ie.id),Oe.features.push(Ot)}}function $t(Oe,Ie,je,Qe,tt,ht){var at=Qe*Qe;if(Qe>0&&Ie.size<(tt?at:Qe))je.numPoints+=Ie.length/3;else{for(var ut=[],Et=0;Et<Ie.length;Et+=3)(Qe===0||Ie[Et+2]>at)&&(je.numSimplified++,ut.push(Ie[Et]),ut.push(Ie[Et+1])),je.numPoints++;tt&&function(it,Yt){for(var xn=0,Ot=0,qn=it.length,Wn=qn-2;Ot<qn;Wn=Ot,Ot+=2)xn+=(it[Ot]-it[Wn])*(it[Ot+1]+it[Wn+1]);if(xn>0===Yt)for(Ot=0,qn=it.length;Ot<qn/2;Ot+=2){var pn=it[Ot],rr=it[Ot+1];it[Ot]=it[qn-2-Ot],it[Ot+1]=it[qn-1-Ot],it[qn-2-Ot]=pn,it[qn-1-Ot]=rr}}(ut,ht),Oe.push(ut)}}function jt(Oe,Ie){var je=(Ie=this.options=function(tt,ht){for(var at in ht)tt[at]=ht[at];return tt}(Object.create(this.options),Ie)).debug;if(je&&console.time("preprocess data"),Ie.maxZoom<0||Ie.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(Ie.promoteId&&Ie.generateId)throw new Error("promoteId and generateId cannot be used together.");var Qe=function(tt,ht){var at=[];if(tt.type==="FeatureCollection")for(var ut=0;ut<tt.features.length;ut++)We(at,tt.features[ut],ht,ut);else We(at,tt.type==="Feature"?tt:{geometry:tt},ht);return at}(Oe,Ie);this.tiles={},this.tileCoords=[],je&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",Ie.indexMaxZoom,Ie.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(Qe=function(tt,ht){var at=ht.buffer/ht.extent,ut=tt,Et=Rt(tt,1,-1-at,at,0,-1,2,ht),it=Rt(tt,1,1-at,2+at,0,-1,2,ht);return(Et||it)&&(ut=Rt(tt,1,-at,1+at,0,-1,2,ht)||[],Et&&(ut=Xe(Et,1).concat(ut)),it&&(ut=ut.concat(Xe(it,-1)))),ut}(Qe,Ie)).length&&this.splitTile(Qe,0,0,0),je&&(Qe.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function Lt(Oe,Ie,je){return 32*((1<<Oe)*je+Ie)+Oe}return jt.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},jt.prototype.splitTile=function(Oe,Ie,je,Qe,tt,ht,at){for(var ut=[Oe,Ie,je,Qe],Et=this.options,it=Et.debug;ut.length;){Qe=ut.pop(),je=ut.pop(),Ie=ut.pop(),Oe=ut.pop();var Yt=1<<Ie,xn=Lt(Ie,je,Qe),Ot=this.tiles[xn];if(!Ot&&(it>1&&console.time("creation"),Ot=this.tiles[xn]=Vt(Oe,Ie,je,Qe,Et),this.tileCoords.push({z:Ie,x:je,y:Qe}),it)){it>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",Ie,je,Qe,Ot.numFeatures,Ot.numPoints,Ot.numSimplified),console.timeEnd("creation"));var qn="z"+Ie;this.stats[qn]=(this.stats[qn]||0)+1,this.total++}if(Ot.source=Oe,tt){if(Ie===Et.maxZoom||Ie===tt)continue;var Wn=1<<tt-Ie;if(je!==Math.floor(ht/Wn)||Qe!==Math.floor(at/Wn))continue}else if(Ie===Et.indexMaxZoom||Ot.numPoints<=Et.indexMaxPoints)continue;if(Ot.source=null,Oe.length!==0){it>1&&console.time("clipping");var pn,rr,Rr,Yr,ar,Dr,Qr=.5*Et.buffer/Et.extent,Po=.5-Qr,oa=.5+Qr,Ho=1+Qr;pn=rr=Rr=Yr=null,ar=Rt(Oe,Yt,je-Qr,je+oa,0,Ot.minX,Ot.maxX,Et),Dr=Rt(Oe,Yt,je+Po,je+Ho,0,Ot.minX,Ot.maxX,Et),Oe=null,ar&&(pn=Rt(ar,Yt,Qe-Qr,Qe+oa,1,Ot.minY,Ot.maxY,Et),rr=Rt(ar,Yt,Qe+Po,Qe+Ho,1,Ot.minY,Ot.maxY,Et),ar=null),Dr&&(Rr=Rt(Dr,Yt,Qe-Qr,Qe+oa,1,Ot.minY,Ot.maxY,Et),Yr=Rt(Dr,Yt,Qe+Po,Qe+Ho,1,Ot.minY,Ot.maxY,Et),Dr=null),it>1&&console.timeEnd("clipping"),ut.push(pn||[],Ie+1,2*je,2*Qe),ut.push(rr||[],Ie+1,2*je,2*Qe+1),ut.push(Rr||[],Ie+1,2*je+1,2*Qe),ut.push(Yr||[],Ie+1,2*je+1,2*Qe+1)}}},jt.prototype.getTile=function(Oe,Ie,je){var Qe=this.options,tt=Qe.extent,ht=Qe.debug;if(Oe<0||Oe>24)return null;var at=1<<Oe,ut=Lt(Oe,Ie=(Ie%at+at)%at,je);if(this.tiles[ut])return Ke(this.tiles[ut],tt);ht>1&&console.log("drilling down to z%d-%d-%d",Oe,Ie,je);for(var Et,it=Oe,Yt=Ie,xn=je;!Et&&it>0;)it--,Yt=Math.floor(Yt/2),xn=Math.floor(xn/2),Et=this.tiles[Lt(it,Yt,xn)];return Et&&Et.source?(ht>1&&console.log("found parent tile z%d-%d-%d",it,Yt,xn),ht>1&&console.time("drilling down"),this.splitTile(Et.source,it,Yt,xn,Oe,Ie,je),ht>1&&console.timeEnd("drilling down"),this.tiles[ut]?Ke(this.tiles[ut],tt):null):null},function(Oe,Ie){return new jt(Oe,Ie)}}();var $n=T.getDefaultExportFromCjs(Dn.exports);function Ln(et,te){const ue=et.tileID.canonical;if(!this._geoJSONIndex)return te(null,null);const ye=this._geoJSONIndex.getTile(ue.z,ue.x,ue.y);if(!ye)return te(null,null);const We=new class{constructor(bt){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=T.EXTENT,this.length=bt.length,this._features=bt}feature(bt){return new class{constructor(St){this._feature=St,this.extent=T.EXTENT,this.type=St.type,this.properties=St.tags,"id"in St&&!isNaN(St.id)&&(this.id=parseInt(St.id,10))}loadGeometry(){if(this._feature.type===1){const St=[];for(const Ne of this._feature.geometry)St.push([new T.Point(Ne[0],Ne[1])]);return St}{const St=[];for(const Ne of this._feature.geometry){const wt=[];for(const Rt of Ne)wt.push(new T.Point(Rt[0],Rt[1]));St.push(wt)}return St}}toGeoJSON(St,Ne,wt){return K.call(this,St,Ne,wt)}}(this._features[bt])}}(ye.features);let Je=zt(We);Je.byteOffset===0&&Je.byteLength===Je.buffer.byteLength||(Je=new Uint8Array(Je)),te(null,{vectorTile:We,rawData:Je.buffer})}class vn extends T.VectorTileWorkerSource{constructor(te,ue,ye,We,Je,bt){super(te,ue,ye,We,Ln,bt),Je&&(this.loadGeoJSON=Je)}loadData(te,ue){const ye=te&&te.request,We=ye&&ye.collectResourceTiming;this.loadGeoJSON(te,(Je,bt)=>{if(Je||!bt)return ue(Je);if(typeof bt!="object")return ue(new Error(`Input data given to '${te.source}' is not a valid GeoJSON object.`));{$(bt,!0);try{if(te.filter){const Ne=T.createExpression(te.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(Ne.result==="error")throw new Error(Ne.value.map(Rt=>`${Rt.key}: ${Rt.message}`).join(", "));bt={type:"FeatureCollection",features:bt.features.filter(Rt=>Ne.value.evaluate({zoom:0},Rt))}}this._geoJSONIndex=te.cluster?new He(function({superclusterOptions:Ne,clusterProperties:wt}){if(!wt||!Ne)return Ne;const Rt={},Wt={},cn={accumulated:null,zoom:0},Yn={properties:null},hr=Object.keys(wt);for(const pr of hr){const[nr,dr]=wt[pr],Xe=T.createExpression(dr),be=T.createExpression(typeof nr=="string"?[nr,["accumulated"],["get",pr]]:nr);Rt[pr]=Xe.value,Wt[pr]=be.value}return Ne.map=pr=>{Yn.properties=pr;const nr={};for(const dr of hr)nr[dr]=Rt[dr].evaluate(cn,Yn);return nr},Ne.reduce=(pr,nr)=>{Yn.properties=nr;for(const dr of hr)cn.accumulated=pr[dr],pr[dr]=Wt[dr].evaluate(cn,Yn)},Ne}(te)).load(bt.features):$n(bt,te.geojsonVtOptions)}catch(Ne){return ue(Ne)}this.loaded={};const St={};if(We){const Ne=T.getPerformanceMeasurement(ye);Ne&&(St.resourceTiming={},St.resourceTiming[te.source]=JSON.parse(JSON.stringify(Ne)))}ue(null,St)}})}reloadTile(te,ue){const ye=this.loaded;return ye&&ye[te.uid]?super.reloadTile(te,ue):this.loadTile(te,ue)}loadGeoJSON(te,ue){if(te.request)T.getJSON(te.request,ue);else{if(typeof te.data!="string")return ue(new Error(`Input data given to '${te.source}' is not a valid GeoJSON object.`));try{return ue(null,JSON.parse(te.data))}catch{return ue(new Error(`Input data given to '${te.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(te,ue){try{ue(null,this._geoJSONIndex.getClusterExpansionZoom(te.clusterId))}catch(ye){ue(ye)}}getClusterChildren(te,ue){try{ue(null,this._geoJSONIndex.getChildren(te.clusterId))}catch(ye){ue(ye)}}getClusterLeaves(te,ue){try{ue(null,this._geoJSONIndex.getLeaves(te.clusterId,te.limit,te.offset))}catch(ye){ue(ye)}}}class On{constructor(te,ue){this.tileID=new T.OverscaledTileID(te.tileID.overscaledZ,te.tileID.wrap,te.tileID.canonical.z,te.tileID.canonical.x,te.tileID.canonical.y),this.tileZoom=te.tileZoom,this.uid=te.uid,this.zoom=te.zoom,this.canonical=te.tileID.canonical,this.pixelRatio=te.pixelRatio,this.tileSize=te.tileSize,this.source=te.source,this.overscaling=this.tileID.overscaleFactor(),this.enableTerrain=!!te.enableTerrain,this.projection=te.projection,this.brightness=ue}async parse(te,ue,ye,We){this.status="parsing";const Je=new T.OverscaledTileID(ye.tileID.overscaledZ,ye.tileID.wrap,ye.tileID.canonical.z,ye.tileID.canonical.x,ye.tileID.canonical.y),bt={},St=ue.familiesBySource[ye.source],Ne=new T.FeatureIndex(Je,ye.promoteId);Ne.bucketLayerIDs=[];const wt=await T.load3DTile(te),Rt=T.convertB3dm(wt.gltf,1/T.tileToMeter(ye.tileID.canonical)),Wt=wt.gltf.json.extensionsUsed&&wt.gltf.json.extensionsUsed.includes("MAPBOX_mesh_features");for(const cn in St)for(const Yn of St[cn]){const hr=Yn[0],pr=wt.gltf.json.extensionsUsed,nr=new T.Tiled3dModelBucket(Rt,Je,pr&&pr.includes("MAPBOX_mesh_features"),this.brightness);Wt||(nr.needsUpload=!0),bt[hr.id]=nr}this.status="done",We(null,{buckets:bt,featureIndex:Ne})}}class Br{constructor(te,ue,ye,We,Je,bt){this.actor=te,this.layerIndex=ue,this.brightness=bt,this.loading={},this.loaded={}}loadTile(te,ue){const ye=te.uid,We=this.loading[ye]=new On(te,this.brightness);T.getArrayBuffer(te.request,(Je,bt)=>{const St=!this.loading[ye];return delete this.loading[ye],St||Je?(We.status="done",St||(this.loaded[ye]=We),ue(Je)):bt&&bt.byteLength!==0?(We.parse(bt,this.layerIndex,te,ue),this.loaded=this.loaded||{},void(this.loaded[ye]=We)):(We.status="done",this.loaded[ye]=We,ue())})}reloadTile(te,ue){const ye=this.loaded,We=te.uid;if(ye&&ye[We]){const Je=ye[We];Je.enableTerrain=!!te.enableTerrain,Je.projection=te.projection,Je.brightness=te.brightness;const bt=(St,Ne)=>{Je.reloadCallback&&(delete Je.reloadCallback,this.loadTile(te,ue)),ue(St,Ne)};Je.status==="parsing"?Je.reloadCallback=bt:Je.status==="done"&&this.loadTile(te,ue)}}abortTile(te,ue){const ye=te.uid;this.loading[ye]&&delete this.loading[ye],ue()}removeTile(te,ue){const ye=this.loaded,We=te.uid;ye&&ye[We]&&delete ye[We],ue()}}class bn{constructor(te){this.self=te,this.actor=new T.Actor(te,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.projections={},this.defaultProjection=T.getProjection({name:"mercator"}),this.workerSourceTypes={vector:T.VectorTileWorkerSource,geojson:vn,"batched-model":Br},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(ue,ye)=>{if(this.workerSourceTypes[ue])throw new Error(`Worker source with name "${ue}" already registered.`);this.workerSourceTypes[ue]=ye},this.self.registerRTLTextPlugin=ue=>{if(T.plugin.isParsed())throw new Error("RTL text plugin already registered.");T.plugin.applyArabicShaping=ue.applyArabicShaping,T.plugin.processBidirectionalText=ue.processBidirectionalText,T.plugin.processStyledBidirectionalText=ue.processStyledBidirectionalText}}clearCaches(te,ue,ye){delete this.layerIndexes[te],delete this.availableImages[te],delete this.workerSources[te],delete this.demWorkerSources[te],ye()}checkIfReady(te,ue,ye){ye()}setReferrer(te,ue){this.referrer=ue}spriteLoaded(te,ue){this.isSpriteLoaded[te]||(this.isSpriteLoaded[te]={}),this.isSpriteLoaded[te][ue.scope]=ue.isLoaded;for(const ye in this.workerSources[te]){const We=this.workerSources[te][ye];for(const Je in We)We[Je]instanceof T.VectorTileWorkerSource&&(We[Je].isSpriteLoaded=ue.isLoaded,We[Je].fire(new T.Event("isSpriteLoaded")))}}setImages(te,ue,ye){const{scope:We,images:Je}=ue;this.availableImages[te]||(this.availableImages[te]={}),this.availableImages[te][We]=Je;for(const bt in this.workerSources[te]){const St=this.workerSources[te][bt];for(const Ne in St)St[Ne].availableImages=Je}ye()}enableTerrain(te,ue,ye){this.terrain=ue,ye()}setProjection(te,ue){this.projections[te]=T.getProjection(ue)}setBrightness(te,ue,ye){this.brightness=ue,ye()}setLayers(te,ue,ye){this.getLayerIndex(te,ue.scope).replace(ue.layers,ue.options),ye()}updateLayers(te,ue,ye){this.getLayerIndex(te,ue.scope).update(ue.layers,ue.removedIds,ue.options),ye()}loadTile(te,ue,ye){const We=this.enableTerrain?T.extend({enableTerrain:this.terrain},ue):ue;We.projection=this.projections[te]||this.defaultProjection,this.getWorkerSource(te,ue.type,ue.source,ue.scope).loadTile(We,ye)}loadDEMTile(te,ue,ye){const We=this.enableTerrain?T.extend({buildQuadTree:this.terrain},ue):ue;this.getDEMWorkerSource(te,ue.source,ue.scope).loadTile(We,ye)}reloadTile(te,ue,ye){const We=this.enableTerrain?T.extend({enableTerrain:this.terrain},ue):ue;We.projection=this.projections[te]||this.defaultProjection,this.getWorkerSource(te,ue.type,ue.source,ue.scope).reloadTile(We,ye)}abortTile(te,ue,ye){this.getWorkerSource(te,ue.type,ue.source,ue.scope).abortTile(ue,ye)}removeTile(te,ue,ye){this.getWorkerSource(te,ue.type,ue.source,ue.scope).removeTile(ue,ye)}removeSource(te,ue,ye){if(!this.workerSources[te]||!this.workerSources[te][ue.type]||!this.workerSources[te][ue.type][ue.source])return;const We=this.workerSources[te][ue.type][ue.source];delete this.workerSources[te][ue.type][ue.source],We.removeSource!==void 0?We.removeSource(ue,ye):ye()}loadWorkerSource(te,ue,ye){try{this.self.importScripts(ue.url),ye()}catch(We){ye(We.toString())}}syncRTLPluginState(te,ue,ye){try{T.plugin.setState(ue);const We=T.plugin.getPluginURL();if(T.plugin.isLoaded()&&!T.plugin.isParsed()&&We!=null){this.self.importScripts(We);const Je=T.plugin.isParsed();ye(Je?void 0:new Error(`RTL Text Plugin failed to import scripts from ${We}`),Je)}}catch(We){ye(We.toString())}}setLoadersUrl(te,ue){this.loadersUrl=ue}getAvailableImages(te,ue){this.availableImages[te]||(this.availableImages[te]={});let ye=this.availableImages[te][ue];return ye||(ye=[]),ye}getLayerIndex(te,ue){this.layerIndexes[te]||(this.layerIndexes[te]={});let ye=this.layerIndexes[te][ue];return ye||(ye=this.layerIndexes[te][ue]=new O),ye}getWorkerSource(te,ue,ye,We){if(this.workerSources[te]||(this.workerSources[te]={}),this.workerSources[te][ue]||(this.workerSources[te][ue]={}),this.isSpriteLoaded[te]||(this.isSpriteLoaded[te]={}),!this.workerSources[te][ue][ye]){const Je={send:(bt,St,Ne,wt,Rt,Wt)=>{this.actor.send(bt,St,Ne,te,Rt,Wt)},scheduler:this.actor.scheduler};this.workerSources[te][ue][ye]=new this.workerSourceTypes[ue](Je,this.getLayerIndex(te,We),this.getAvailableImages(te,We),this.isSpriteLoaded[te][We],void 0,this.brightness)}return this.workerSources[te][ue][ye]}getDEMWorkerSource(te,ue,ye){return this.demWorkerSources[te]||(this.demWorkerSources[te]={}),this.demWorkerSources[te][ye]||(this.demWorkerSources[te][ye]={}),this.demWorkerSources[te][ye][ue]||(this.demWorkerSources[te][ye][ue]=new F),this.demWorkerSources[te][ye][ue]}enforceCacheSizeLimit(te,ue){T.enforceCacheSizeLimit(ue)}getWorkerPerformanceMetrics(te,ue,ye){ye(void 0,void 0)}}return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new bn(self)),bn}),_(["./shared"],function(T){return T.exported});var x=p;return x})})(AB);var hJ=AB.exports;const Kw=Yb(hJ),GM=({color:r=dn.primary,icon:o,onClick:a})=>ci("div",{onClick:()=>{a&&a()},style:{position:"relative",bottom:"24px"},children:[ci("div",{style:{position:"absolute",top:"10px",left:"12px"},children:[o,!o&&st(Yi.Safe,{size:"20px",color:dn.white})]}),ci("svg",{width:"44",height:"67",viewBox:"0 0 44 67",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[st("circle",{cx:"22",cy:"20",r:"20",fill:r}),st("path",{d:"M22 67L2.94744 26.5L41.0526 26.5L22 67Z",fill:r})]})]}),dJ=({onClick:r})=>st(GM,{color:dn.caution,icon:st(Yi.Caution,{size:"20px",color:dn.white}),onClick:r}),fJ=({onClick:r})=>st(GM,{color:dn.threat,icon:st(Yi.Threat,{size:"20px",color:dn.white}),onClick:r}),IB=async({queryKey:r})=>{const[,{latitude:o,longitude:a}]=r;return(await Sv.fromLatLng(o.toString(),a.toString())).results[0].formatted_address},pJ="/assets/example-img-70ab6d08.png",mJ="/assets/monitor-cctv-c27767fd.svg",gJ="/assets/monitor-police-bce732a4.svg",yJ="/assets/monitor-summary-552df535.svg",_J="/assets/monitor-user-1e4dd32e.svg",vJ="/assets/police-card-007431d5.png";function xJ(r){const o=["","","","","","",""],a=String(r.getMonth()+1).padStart(2,"0"),c=String(r.getDate()).padStart(2,"0"),p=r.getFullYear(),_=String(r.getHours()).padStart(2,"0"),x=String(r.getMinutes()).padStart(2,"0"),T=o[r.getDay()];return`${a}/${c}/${p} (${T}) ${_}:${x}`}const wJ=r=>{switch(r){case tr.SAFE:return dn.secondary;case tr.CAUTION:return dn.cautionText;case tr.THREAT:return dn.threat;default:return dn.black}},bJ=r=>{switch(r){case tr.SAFE:return dn.primary;case tr.CAUTION:return dn.cautionLightBg;case tr.THREAT:return dn.threatBg;default:return dn.deselected}},Kb=({safety:r,text:o})=>st(Xi,{justifyContent:"center",alignItems:"center",style:{backgroundColor:bJ(r),borderRadius:"5px",padding:"4px 8px"},children:st(Vo,{size:"10px",font:Ml.Medium,color:wJ(r),children:o})}),SJ=({selectedThreat:r,setSelectedThreat:o})=>ci(qg,{backgroundColor:"#F7F7F7",style:{padding:"8px",position:"absolute",top:"10px",right:"10px",width:"400px",height:"calc(100vh - 20px)",borderRadius:"20px",justifyContent:"start",overflow:"scroll"},children:[st(Xi,{justifyContent:"center",style:{padding:"10px 0"},children:st(Vo,{size:"12px",children:xJ(new Date)})}),r?st(EJ,{threat:r,onBack:()=>o(null)}):ci(Xi,{gap:"10px",children:[st("img",{src:yJ,width:"100%"}),st("img",{src:mJ,width:"100%"}),st("img",{src:_J,width:"100%"}),st("img",{src:gJ,width:"100%"})]}),st(du,{height:"50px"})]}),EJ=({threat:r,onBack:o})=>{const{data:a}=fM([Pv.GET_ADDRESS,{latitude:r.location.latitude,longitude:r.location.longitude}],IB),c=r.kind==="",[p,_]=_e.useState(!1);return ci(Xi,{flexDirection:"column",style:{backgroundColor:"white",padding:"20px",width:"calc(100% - 40px)",borderRadius:"15px"},gap:"10px",children:[st(Xi,{children:st(mu,{onClick:o,children:st(Yi.RightArrow,{})})}),ci(Xi,{alignItems:"center",gap:"10px",children:[c?st(Fg,{diameter:"30px",backgroundColor:dn.threat,children:st(Yi.Threat,{size:"20px",color:dn.white})}):st(Fg,{diameter:"30px",backgroundColor:dn.caution,children:st(Yi.Caution,{size:"20px",color:dn.white})}),st(Vo,{color:c?dn.threat:dn.caution,font:Ml.Bold,size:"14px",children:" "})]}),st(Sw,{title:"",children:st(Vo,{size:"14px",children:a})}),st(Sw,{title:" ",children:ci(Xi,{gap:"5px",children:[st(Kb,{safety:tr.NONE,text:""}),st(Kb,{safety:tr.NONE,text:""})]})}),st(Sw,{title:" ",children:st(Xi,{style:{padding:"5px",borderRadius:"10px",backgroundColor:c?dn.threat:dn.caution,overflow:"hidden"},children:st("img",{src:pJ,style:{borderRadius:"5px",width:"100%",height:"100%",objectFit:"cover"}})})}),st(Sw,{title:"",children:st(Vo,{size:"14px",children:"           ....           ...  "})}),st(Xi,{children:st(mu,{backgroundColor:dn.police,borderRadius:"20px",onClick:()=>{setTimeout(()=>{_(!0)},200)},children:st(Vo,{size:"12px",font:Ml.Bold,color:dn.white,style:{padding:"6px 20px"},children:p?" .":"   "})})}),st(Xi,{flexDirection:"column",children:st("img",{src:vJ,width:"100%"})})]})},Sw=({title:r,children:o})=>ci(Xi,{flexDirection:"column",gap:"5px",children:[st(Vo,{font:Ml.Bold,size:"14px",children:r}),o]}),TJ=({open:r,onDismiss:o,threat:a})=>{const{data:c}=fM([Pv.GET_ADDRESS,{latitude:a.location.latitude,longitude:a.location.longitude}],IB);return st(CB,{open:r,onDismiss:o,children:st(qg,{children:ci(TM,{children:[st(du,{height:"8px"}),st(Vo,{size:"12px",color:dn.secondaryText,children:a.detectedAt.toLocaleString("ko-KR")}),st(du,{height:"4px"}),st(Vo,{size:"20px",font:Ml.Bold,children:c}),st(du,{height:"8px"}),ci(Xi,{gap:"8px",children:[st(Kb,{safety:a.kind===""?tr.THREAT:tr.CAUTION,text:a.kind===""?" ":"   "}),st(Kb,{safety:a.kind===""?tr.THREAT:tr.CAUTION,text:a.kind})]}),st(du,{height:"20px"})]})})})};Kw.accessToken="pk.eyJ1IjoiY2Fyb25hMjEiLCJhIjoiY2xsYzNrcmF5MGJyZjNxcW1mNWZsZW9ndSJ9.J4ziCDlgJHdTO-oc6QifMw";const CJ=Tr.div`
  position: absolute;
  height: 100vh;
  width: 100vw;

  top: 0;
  left: 0;
`,HM=_e.forwardRef(({threats:r},o)=>{const a=_e.useRef(null),c=_e.useRef(null),[p,_]=_e.useState(126.8443),[x,T]=_e.useState(35.228),[C,P]=_e.useState(16.52),[O]=CM(AM),[F,U]=_e.useState(!1),[Z,$]=_e.useState(null),[K,ie]=_e.useState([]),H=W=>{$(W),U(!0)};_e.useEffect(()=>{console.log("mark current location"),(()=>{if(!O)return;const me=document.createElement("div");g0(me).render(st(Yi.MyLocation,{})),new Kw.Marker(me).setLngLat({lon:O.coords.longitude,lat:O.coords.latitude}).addTo(c.current)})()},[O]),_e.useEffect(()=>{if(K.forEach(me=>{me.marker.remove()}),!c.current){console.error("map.current is null");return}const W=[];r.forEach(me=>{const de=me.location;if(console.log(de),!de){console.error("Invalid point");return}const he=document.createElement("div");switch(me.kind){case"":g0(he).render(st(dJ,{onClick:()=>{H(me)}}));break;case"":g0(he).render(st(fJ,{onClick:()=>{H(me)}}));break;default:g0(he).render(st(GM,{onClick:()=>{H(me)}}));break}if(!c.current){console.error("map.current is null",me.id);return}const se=new Kw.Marker(he).setLngLat({lon:de.longitude,lat:de.latitude}).addTo(c.current);W.push({id:me.id,marker:se})}),ie(W)},[r,O]),_e.useEffect(()=>{if(console.log("second useEffect"),!c.current&&a.current&&(c.current=new Kw.Map({container:a.current,style:"mapbox://styles/mapbox/standard-beta",center:[p,x],zoom:C,antialias:!0}),c.current)){const W=c.current;W.on("move",()=>{_(parseFloat(W.getCenter().lng.toFixed(4))),T(parseFloat(W.getCenter().lat.toFixed(4))),P(parseFloat(W.getZoom().toFixed(2)))})}},[]);const G=(W,me)=>{c.current&&c.current.flyTo({center:[W,me],essential:!0})},ee=()=>{console.log(O),O&&G(O.coords.longitude,O.coords.latitude)};return _e.useImperativeHandle(o,()=>({moveToCurrentLocation:ee})),ci(yA,{children:[st(CJ,{ref:a}),window.innerWidth<768?Z&&st(TJ,{threat:Z,open:F,onDismiss:()=>U(!1)}):st(SJ,{selectedThreat:Z,setSelectedThreat:$})]})});HM.displayName="Mapviewer";const AJ=r=>{switch(r){case tr.SAFE:return dn.background;case tr.CAUTION:return dn.cautionBg;case tr.THREAT:return dn.threat;default:return dn.secondaryText}},MJ=Tr(mu)`
  background-color: ${({safety:r})=>AJ(r)};
  color: ${({safety:r})=>r===tr.SAFE?dn.secondary:dn.white};

  height: 40px;
  border-radius: 20px;

  padding: 0 20px;
`,IJ=({safety:r})=>{const o=(()=>{switch(console.log(r),r){case tr.SAFE:return" !";case tr.CAUTION:return"   .";case tr.THREAT:return" !";default:return" ."}})(),a=(()=>{switch(r){case tr.SAFE:return st(Yi.Safe,{});case tr.CAUTION:return st(Yi.Caution,{});case tr.THREAT:return st(Yi.Threat,{});default:return"Safe"}})();return st(MJ,{safety:r,children:ci(Xi,{gap:"3px",children:[a,st(Vo,{size:"15px",children:o})]})})},kJ=r=>{switch(r){case tr.SAFE:return dn.primary;case tr.CAUTION:return dn.caution;case tr.THREAT:return dn.threat;default:return dn.secondaryText}},PJ=({safety:r,onClick:o})=>st(mu,{onClick:o,children:st(Fg,{diameter:"40px",backgroundColor:dn.white,children:st(Yi.Location,{color:kJ(r)})})}),HO=r=>r.kind===""?tr.THREAT:r.kind==="person"?tr.SAFE:tr.CAUTION,qO=[tr.NONE,tr.SAFE,tr.CAUTION,tr.THREAT],RJ=(r,o)=>qO.indexOf(o)-qO.indexOf(r),c0=[{id:1,location:{longitude:126.84096217263814,latitude:35.228096665528106},kind:"",count:3,acc:[.5,.6,.7],detectedAt:new Date("2023-09-01T14:58:58.000Z")},{id:1,location:{longitude:126.84157217263814,latitude:35.2283966655281},kind:"",count:3,acc:[.5,.6,.7],detectedAt:new Date("2023-09-01T14:58:58.000Z")}],DJ=({})=>{const[r,o]=_e.useState(tr.SAFE),a=_e.useRef(null);fM([Pv.GET_ALL_THREATS],yX,{refetchInterval:5e3}),_e.useEffect(()=>{if(!c0)return;const p=c0.reduce((_,x)=>RJ(_,HO(x))>0?HO(x):_,tr.SAFE);o(p)},[c0]);const c=()=>{var p;console.log("handle vector button click"),(p=a.current)==null||p.moveToCurrentLocation()};return ci(qg,{style:{height:"100vh",position:"relative",overflow:"hidden"},backgroundColor:"#F5F5F5",children:[c0&&st(HM,{threats:c0,ref:a}),r===tr.THREAT&&ci(yA,{children:[st(zJ,{}),st(FJ,{})]}),st(LJ,{children:st(IJ,{safety:r})}),ci(OJ,{children:[st(PJ,{safety:r,onClick:c}),location&&st(cJ,{safety:r})]})]})},LJ=Tr(Xi)`
  position: absolute;
  top: 15px;
  left: 15px;

  z-index: 1;
`,OJ=Tr(Xi)`
  position: absolute;
  bottom: 44px;
  left: calc(50% - 88px);
  gap: 16px;

  z-index: 1;
`,zJ=Tr.div`
  position: absolute;
  top: 0;
  left: 0;
  width: calc(50% - 88px);
  height: 100vh;
  background: linear-gradient(
    90deg,
    rgba(217, 77, 33, 15%) 0%,
    rgba(217, 77, 33, 0) 100%
  );

  z-index: 1;
`,FJ=Tr.div`
  position: absolute;
  top: 0;
  right: 0;
  width: calc(50% - 88px);
  height: 100vh;
  background: linear-gradient(
    270deg,
    rgba(217, 77, 33, 15%) 0%,
    rgba(217, 77, 33, 0) 100%
  );

  z-index: 1;
`,BJ=({})=>st(qg,{}),WO=[{id:1,location:{longitude:126.84096217263814,latitude:35.228096665528106},kind:"",count:3,acc:[.5,.6,.7],detectedAt:new Date("2023-09-01T14:58:58.000Z")},{id:1,location:{longitude:126.84157217263814,latitude:35.2283966655281},kind:"",count:3,acc:[.5,.6,.7],detectedAt:new Date("2023-09-01T14:58:58.000Z")}],NJ=({})=>{_e.useState(tr.SAFE);const r=_e.useRef(null);return ci(qg,{children:[" ",WO&&st(HM,{threats:WO,ref:r})]})};var Yw=(r=>(r.HOME="/",r.LOGIN="/login",r.REGISTER="/register",r.MONITOR="/monitor",r))(Yw||{});const jJ=Sq(BC(ci(y0,{element:st(QW,{}),children:[st(y0,{path:Yw.HOME,element:st(DJ,{})}),st(y0,{path:Yw.LOGIN,element:st(BJ,{})}),st(y0,{path:Yw.MONITOR,element:st(NJ,{})})]})));function UJ(){return st(_q,{router:jJ})}const VJ=new L9;Sv.setApiKey("AIzaSyD8DkdXbvru5QvtpEEoVGBoy4HUjwM7bvQ");Sv.setLanguage("ko");Sv.setRegion("kr");Sv.setLocationType("ROOFTOP");PC.createRoot(document.getElementById("root")).render(st(QG,{client:VJ,children:st(UJ,{})}));
